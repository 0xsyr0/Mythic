(this.webpackJsonpmythic=this.webpackJsonpmythic||[]).push([[0],{385:function(e,t,n){},386:function(e,t,n){},596:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(316),i=n(10),c=n(0),o=n.n(c),l=n(20),s=n.n(l),d=(n(385),n(15)),u=n(8),j=(n(386),n(3)),b=n(661),p=n(602),m=n(171),h=n(103),O=n(347),f=n(346),x=n(705),g=n(7),v=Object(g.a)({root:{"& input:valid + fieldset":{borderColor:"grey",borderWidth:1},"& input:invalid + fieldset":{borderColor:"red",borderWidth:2},"& input:valid:focus + fieldset":{borderLeftWidth:6,padding:"4px !important"}}})(x.a),y=function(e){Object(O.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onChange=function(t){var n=e.props.name,a=t.target.value,r=!!e.props.validate&&e.props.validate(a);e.props.onChange(n,a,r)},e.checkError=function(){return!!e.props.validate&&e.props.validate(e.props.value)},e}return Object(h.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{style:{width:this.props.width?this.props.width+"rem":"100%"},children:Object(a.jsx)(v,{fullWidth:!0,placeholder:this.props.placeholder,value:this.props.value,onChange:this.onChange,label:this.props.name,variant:"outlined",required:!!this.props.requiredValue&&this.props.requiredValue,InputLabelProps:this.props.inputLabelProps,multiline:!!this.props.multiline&&this.props.multiline,error:this.checkError(),type:void 0===this.props.type?"text":this.props.type,InputProps:this.props.InputProps,helperText:this.checkError()?this.props.errorText:this.props.helperText,style:{marginBottom:this.props.marginBottom?this.props.marginBottom:"10px"}})})}}]),n}(o.a.Component),k=n.p+"static/media/mythic.7189479f.svg",_=n(36),w=n(9),C=Object(w.makeVar)({}),S=Object(w.makeVar)(!1);null!==localStorage.getItem("access_token")&&C({loggedIn:!0,access_token:localStorage.getItem("access_token"),refresh_token:localStorage.getItem("refresh_token"),user:JSON.parse(localStorage.getItem("user"))});var I=n(28);function q(e){var t=Object(w.useReactiveVar)(C),n=Object(I.c)().enqueueSnackbar,r=o.a.useState(""),c=Object(u.a)(r,2),l=c[0],s=c[1],d=o.a.useState(""),j=Object(u.a)(d,2),b=j[0],m=j[1],h=function(e){if(e.preventDefault(),""!==l&&""!==b){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,password:b})};fetch("/auth",t).then((function(e){e.json().then((function(e){"access_token"in e?function(e){localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),localStorage.setItem("user",JSON.stringify(e.user)),C(Object(i.a)({loggedIn:!0},e))}(e):(n("Invalid Username or Password",{variant:"warning",autoHideDuration:2e3}),console.log("Error",e))})).catch((function(e){n("Error getting JSON from server",{variant:"warning",autoHideDuration:2e3}),console.log("Error trying to get json response",e.toString())}))})).catch((function(e){n("Error talking to server",{variant:"warning",autoHideDuration:2e3}),console.log("There was an error!",e.toString())}))}else n("Username and Password required",{variant:"warning"})};return Object(a.jsx)("div",{style:{justifyContent:"center",display:"flex"},children:t.loggedIn?Object(a.jsx)(_.a,{to:function(){var t=e.location.state;return t&&t.from?t.from.pathname:"/"}()}):Object(a.jsxs)("div",{children:[Object(a.jsx)("img",{src:k,height:"400px",alt:"Mythic logo"}),Object(a.jsxs)("form",{onSubmit:h,children:[Object(a.jsx)(y,{name:"username",value:l,onChange:function(e,t,n){s(t)},width:30}),Object(a.jsx)(y,{name:"password",type:"password",value:b,onChange:function(e,t,n){m(t)},width:30}),Object(a.jsx)(p.a,{type:"submit",color:"primary",onClick:h,variant:"contained",style:{marginRight:"10px"},children:"Login"}),Object(a.jsx)(p.a,{color:"primary",variant:"contained",children:"Register"})]})]})})}var T=n(29),P=n(14),D=n(670),M=n(672),E=n(663),$=n(673),N=n(671),B=n(662),A=n(190),F=n(664),z=n(699),L=n(660),R=n(352),H=n(72),W=n(182),U=n.n(W),V=n(181),Q=n.n(V),G=n(101),J=n.n(G),Y=n(183),K=n.n(Y);function Z(e){return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:Object(a.jsx)(p.a,{startIcon:Object(a.jsx)(J.a,{}),color:"secondary",variant:"contained",children:"Delete"})}),Object(a.jsx)(E.a,{children:Object(a.jsx)(F.a,{checked:e.active,onChange:function(t){var n=t.target.name,a=e.id;e.onChanged({id:a,name:n})},inputProps:{"aria-label":"primary checkbox"},name:"active"})}),Object(a.jsx)(E.a,{children:e.token_type}),Object(a.jsx)(E.a,{children:e.token_value})]},"apitokenRow"+e.id)}var X=n(668),ee=n(666),te=n(667),ne=n(665);function ae(e){var t=o.a.useState(e.username?e.username:""),n=Object(u.a)(t,2),r=n[0],i=n[1],c=o.a.useState(""),l=Object(u.a)(c,2),s=l[0],d=l[1],j=o.a.useState(""),b=Object(u.a)(j,2),m=b[0],h=b[1];return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(ne.a,{id:"form-dialog-title",children:e.title}),Object(a.jsxs)(ee.a,{dividers:!0,children:[Object(a.jsx)(te.a,{children:"Use this dialog to update some information about an operator."}),Object(a.jsx)(y,{autoFocus:!0,placeholder:e.username,value:r,onChange:function(e,t,n){i(t)},margin:"dense",id:"username",name:"username"}),Object(a.jsx)(y,{margin:"dense",id:"passwordOld",onChange:function(e,t,n){d(t)},name:"old password",type:"password"}),Object(a.jsx)(y,{margin:"dense",id:"passwordNew",onChange:function(e,t,n){h(t)},name:"new password",type:"password"})]}),Object(a.jsxs)(X.a,{children:[Object(a.jsx)(p.a,{onClick:e.handleClose,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{onClick:function(){e.onAccept(e.id,r,s,m)},color:"primary",children:"Update"})]})]})}function re(e){return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(ne.a,{id:"form-dialog-title",children:"Delete Operator"}),Object(a.jsxs)(ee.a,{dividers:!0,children:[Object(a.jsx)(te.a,{children:"This deletes an operator and prevents them from permanently logging in again. If you want a temporary solution, disable the operator instead."}),Object(a.jsxs)(te.a,{children:['Are you sure you want to delete operator "',e.username,'"?']})]}),Object(a.jsxs)(X.a,{children:[Object(a.jsx)(p.a,{onClick:e.handleClose,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{onClick:function(){e.onAccept(e.id)},color:"secondary",children:"Delete"})]})]})}var ie=n(669);function ce(e){var t=o.a.useRef(null);return o.a.useEffect((function(){if(e.open){var n=t.current;null!==n&&n.focus()}}),[e.open]),Object(a.jsx)(ie.a,{open:e.open,onClose:e.onClose,scroll:"paper",maxWidth:e.maxWidth,fullWidth:e.fullWidth,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:e.innerDialog})}function oe(e,t){try{if(null===e)return"N/A";var n=new Date(e);return t?e+" UTC":n.toDateString()+" "+n.toTimeString().substring(0,8)}catch(a){console.log("warning","Failed to get local time converted: "+a.toString())}}function le(e){var t=o.a.useState(!1),n=Object(u.a)(t,2),r=n[0],l=n[1],s=o.a.useState(!1),d=Object(u.a)(s,2),j=d[0],b=d[1],m=o.a.useState(!1),h=Object(u.a)(m,2),O=h[0],f=h[1],x=Object(w.useReactiveVar)(C),g=function(e,t){};return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(B.a,{children:[Object(a.jsxs)(E.a,{children:[Object(a.jsx)(p.a,{size:"small",onClick:function(){f(!0)},startIcon:Object(a.jsx)(J.a,{}),color:"secondary",variant:"contained",children:"Delete"}),Object(a.jsx)(ce,{open:O,onClose:function(){f(!1)},innerDialog:Object(a.jsx)(re,Object(i.a)({onAccept:function(t){e.onDeleteOperator(t),f(!1)}},e))})]}),Object(a.jsx)(E.a,{children:e.username}),Object(a.jsxs)(E.a,{children:[Object(a.jsx)(p.a,{size:"small",onClick:function(){b(!0)},color:"primary",variant:"contained",children:"Update"}),Object(a.jsx)(ce,{open:j,onClose:function(){b(!1)},innerDialog:Object(a.jsx)(ae,Object(i.a)({onAccept:function(e,t,n,a){console.log("settingsoperator onAccept",e,t,n,a)},handleClose:function(){b(!1)},title:"Update Operator"},e))})]}),Object(a.jsx)(E.a,{children:Object(a.jsx)(F.a,{checked:e.view_utc_time,onChange:function(t){var n=e.id;e.onViewUTCChanged(n,!e[t.target.name])},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"view_utc_time"})}),Object(a.jsx)(E.a,{children:Object(a.jsx)(F.a,{checked:e.active,onChange:function(t){var n=e.id;e.onActiveChanged(n,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"active"})}),Object(a.jsx)(E.a,{children:oe(e.last_login,x.user.view_utc_time)}),Object(a.jsx)(E.a,{children:oe(e.creation_time,x.user.view_utc_time)}),Object(a.jsx)(E.a,{children:Object(a.jsx)(F.a,{checked:e.admin,onChange:function(t){var n=e.id;e.onAdminChanged(n,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"admin"})}),Object(a.jsx)(E.a,{children:Object(a.jsx)(R.a,{"aria-label":"expand row",size:"small",onClick:function(){return l(!r)},children:r?Object(a.jsx)(Q.a,{className:"mythicElement"}):Object(a.jsx)(U.a,{className:"mythicElement"})})})]},e.id),Object(a.jsx)(B.a,{children:Object(a.jsx)(E.a,{style:{paddingBottom:0,paddingTop:0},colSpan:9,children:Object(a.jsx)(L.a,{in:r,timeout:"auto",unmountOnExit:!0,children:Object(a.jsxs)(z.a,{margin:1,children:[Object(a.jsx)(H.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"API Tokens"}),Object(a.jsx)(p.a,{size:"small",style:{float:"right"},startIcon:Object(a.jsx)(K.a,{}),color:"primary",variant:"contained",children:"New"}),Object(a.jsxs)(D.a,{size:"small","aria-label":"tokens",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{style:{width:"7rem"},children:"Delete"}),Object(a.jsx)(E.a,{style:{width:"5rem"},children:"Active"}),Object(a.jsx)(E.a,{style:{width:"5rem"},children:"Type"}),Object(a.jsx)(E.a,{children:"Token"})]})}),Object(a.jsx)(M.a,{children:e.apitokens.map((function(e){return Object(c.createElement)(Z,Object(i.a)(Object(i.a)({},e),{},{onChanged:g,key:"token"+e.id}))}))})]})]})})})})]})}function se(e){var t=o.a.useState(!1),n=Object(u.a)(t,2),r=n[0],c=n[1],l=Object(I.c)().enqueueSnackbar;return Object(a.jsxs)($.a,{component:A.a,className:"mythicElement",children:[Object(a.jsx)(H.a,{variant:"h3",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Settings"}),Object(a.jsx)(p.a,{size:"small",onClick:function(){c(!0)},style:{float:"right"},startIcon:Object(a.jsx)(K.a,{}),color:"primary",variant:"contained",children:"New Operator"}),Object(a.jsx)(ce,{open:r,onClose:function(){c(!1)},innerDialog:Object(a.jsx)(ae,Object(i.a)({title:"New Operator",onAccept:function(t,n,a,r){a!==r?l("Passwords don't match",{variant:"error"}):0===r.length?l("Password must not be empty",{variant:"error"}):0===n.length?l("Username must not be empty",{variant:"error"}):(e.onNewOperator(n,r),c(!1))},handleClose:function(){c(!1)}},e))}),Object(a.jsxs)(D.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Delete Account"}),Object(a.jsx)(E.a,{children:"Username"}),Object(a.jsx)(E.a,{children:"Modify"}),Object(a.jsx)(E.a,{children:"Use UTC Timestamps"}),Object(a.jsx)(E.a,{children:"Account Active"}),Object(a.jsx)(E.a,{children:"Last Login"}),Object(a.jsx)(E.a,{children:"Account Creation Date"}),Object(a.jsx)(E.a,{children:"Admin Status"}),Object(a.jsx)(E.a,{children:"More..."})]})}),Object(a.jsx)(M.a,{children:e.operator.map((function(t){return Object(a.jsx)(le,Object(i.a)({onViewUTCChanged:e.onViewUTCChanged,onAdminChanged:e.onAdminChanged,onActiveChanged:e.onActiveChanged,onDeleteOperator:e.onDeleteOperator},t),"operator"+t.id)}))})]})]})}var de=n(674);function ue(){var e=Object(P.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    active\n    creation_time\n    deleted\n    error\n    id\n    last_login\n    status\n    username\n    view_utc_time\n  }\n}\n"]);return ue=function(){return e},e}function je(){var e=Object(P.a)(["\nmutation SettingsDeleteOperatorMutation($id: Int!) {\n  update_operator(where: {id: {_eq: $id}}, _set: {deleted: true}) {\n    returning {\n      id\n    }\n  }\n}\n"]);return je=function(){return e},e}function be(){var e=Object(P.a)(["\nmutation SettingsUpdateOperatorActiveMutation($id: Int!, $active: Boolean) {\n  update_operator(where: {id: {_eq: $id}}, _set: {active: $active}) {\n    returning {\n      id\n      active\n    }\n  }\n}\n"]);return be=function(){return e},e}function pe(){var e=Object(P.a)(["\nmutation SettingsUpdateOperatorAdminMutation($id: Int!, $admin: Boolean) {\n  update_operator(where: {id: {_eq: $id}}, _set: {admin: $admin}) {\n    returning {\n      id\n      admin\n    }\n  }\n}\n"]);return pe=function(){return e},e}function me(){var e=Object(P.a)(["\nmutation SettingsUpdateOperatorViewUTCTime($id: Int!, $view_utc_time: Boolean) {\n  update_operator(where: {id: {_eq: $id}}, _set: {view_utc_time: $view_utc_time}) {\n    returning {\n      id\n      view_utc_time\n    }\n  }\n}\n"]);return me=function(){return e},e}function he(){var e=Object(P.a)(["\nquery GetOperators {\n  operator(where: {deleted: {_eq: false}}, order_by: {username: asc}) {\n    active\n    admin\n    creation_time\n    deleted\n    id\n    last_login\n    username\n    view_utc_time\n    apitokens {\n      token_value\n      token_type\n      active\n      id\n    }\n  }\n}\n"]);return he=function(){return e},e}var Oe=Object(w.gql)(he()),fe=Object(w.gql)(me()),xe=Object(w.gql)(pe()),ge=Object(w.gql)(be()),ve=Object(w.gql)(je()),ye=Object(w.gql)(ue());function ke(e){var t=Object(w.useReactiveVar)(C),n=Object(I.c)().enqueueSnackbar,r=Object(w.useQuery)(Oe),c=r.loading,o=r.error,l=r.data,s=Object(w.useMutation)(fe,{update:function(e,n){var a=n.data;if(a.update_operator.returning[0].id===t.user.id){var r=C();r.user.view_utc_time=a.update_operator.returning[0].view_utc_time,C(r)}}}),d=Object(u.a)(s,1)[0],j=Object(w.useMutation)(ve,{update:function(e,t){var n=t.data,a=e.readQuery({query:Oe}),r=n.update_operator.returning[0],i=a.operator.filter((function(e){return e.id!==r.id}));e.writeQuery({query:Oe,data:{operator:i}})}}),b=Object(u.a)(j,1)[0],p=Object(w.useMutation)(xe),m=Object(u.a)(p,1)[0],h=Object(w.useMutation)(ge),O=Object(u.a)(h,1)[0],f=Object(w.useMutation)(ye,{update:function(e,t){var a=t.data;if("success"===a.createOperator.status){var r=e.readQuery({query:Oe}),i=a.createOperator;e.writeQuery({query:Oe,data:{operator:[i].concat(Object(T.a)(r.operator))}})}else n(a.createOperator.error,{variant:"error"})}}),x=Object(u.a)(f,1)[0];return c?Object(a.jsx)(de.a,{}):o?(console.error(o),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsx)("div",{style:{height:"calc(94vh)",marginTop:"10px"},children:Object(a.jsx)(se,Object(i.a)({onViewUTCChanged:function(e,t){d({variables:{id:e,view_utc_time:t}})},onAdminChanged:function(e,t){m({variables:{id:e,admin:t}})},onActiveChanged:function(e,t){O({variables:{id:e,active:t}})},onNewOperator:function(e,t){x({variables:{username:e,password:t}})},onDeleteOperator:function(e){b({variables:{id:e}})}},l))})}function _e(e){return Object(c.useEffect)((function(){C({loggedIn:!1,accessToken:null,refreshToken:null,user:{}}),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),S(!1)})),Object(a.jsx)(_.a,{to:"/login"})}var we=n(676),Ce=n(677),Se=n(678),Ie=n(679),qe=n(675);function Te(){var e=Object(P.a)(["\nquery GetPayloadDetails($payload_name: String!) {\n  payloadtype(where: {ptype: {_eq: $payload_name}}) {\n    buildparameters {\n      description\n      name\n      id\n      parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n"]);return Te=function(){return e},e}var Pe=Object(w.gql)(Te());function De(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],i=n[1],l=Object(w.useQuery)(Pe,{variables:{payload_name:e.payload_name},onCompleted:function(e){console.log(e),i(e.payloadtype[0].buildparameters)}}),s=l.loading,d=l.error;return s?Object(a.jsx)(de.a,{}):d?(console.error(d),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ne.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(a.jsxs)(ee.a,{dividers:!0,children:[Object(a.jsx)(te.a,{children:"These are the build parameters associated with this payload"}),Object(a.jsxs)(D.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Parameter"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsx)(M.a,{children:r.map((function(e){return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:e.description}),Object(a.jsxs)(E.a,{children:["Scripting/Building Name:",Object(a.jsx)("br",{}),e.name,Object(a.jsx)("br",{}),"Parameter Type:",Object(a.jsx)("br",{}),e.parameter_type,Object(a.jsx)("br",{}),"Default Parameter:",Object(a.jsx)("br",{}),e.parameter,Object(a.jsx)("br",{}),"Required value?",Object(a.jsx)("br",{}),e.required?"Yes":"No",Object(a.jsx)("br",{}),"Verifier Regex:",Object(a.jsx)("br",{}),e.verifier_regex,Object(a.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(a.jsx)(X.a,{children:Object(a.jsx)(p.a,{onClick:e.handleClose,color:"primary",children:"Close"})})]})}var Me=Object(b.a)((function(e){return{root:{width:"100%",display:"flex",margin:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),Ee=Object(g.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(qe.a);function $e(e){var t=Me(),n=o.a.useState(!1),r=Object(u.a)(n,2),c=r[0],l=r[1],s=new Date,d=(s.getTime()+6e4*s.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(a.jsxs)(we.a,{className:t.root,elevation:5,style:{maxWidth:"99%"},children:[Object(a.jsx)("div",{children:Object(a.jsx)(Ee,{overlap:"circle",classes:{badge:t[d]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(a.jsx)(Ce.a,{className:t.media,component:"img",style:{width:"100px",padding:"10px"},src:e.ptype+".svg"})})}),Object(a.jsxs)("div",{children:[Object(a.jsx)(H.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.ptype}),Object(a.jsxs)(Se.a,{style:{textAlign:"left"},children:[Object(a.jsxs)(H.a,{variant:"body1",component:"p",children:[Object(a.jsx)("b",{children:"Author:"})," ",e.author]}),Object(a.jsxs)(H.a,{variant:"body1",component:"p",children:[Object(a.jsx)("b",{children:"Supported Operating Systems:"})," ",e.supported_os]}),Object(a.jsx)(H.a,{variant:"body2",component:"p",children:e.note})]}),Object(a.jsxs)(Ie.a,{children:[Object(a.jsx)(p.a,{size:"small",color:"primary",href:"/docs/agents/"+e.ptype,target:"_blank",children:"Docs"}),Object(a.jsx)(p.a,{size:"small",color:"primary",children:"Commands"}),Object(a.jsx)(p.a,{onClick:function(){l(!0)},color:"primary",variant:"contained",children:"Building"}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"lg",open:c,onClose:function(){l(!1)},innerDialog:Object(a.jsx)(De,Object(i.a)(Object(i.a)({},e),{},{payload_name:e.ptype}))})]})]})]})}function Ne(){var e=Object(P.a)(["\n subscription getPayloadTypesSubscription {\n  payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n    author\n    container_running\n    id\n    last_heartbeat\n    note\n    ptype\n    supported_os\n    wrapper\n  }\n}\n "]);return Ne=function(){return e},e}var Be=Object(w.gql)(Ne());function Ae(e){var t=Object(w.useSubscription)(Be),n=t.loading,r=t.error,c=t.data;return n?Object(a.jsx)(de.a,{}):r?(console.error(r),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsx)("div",{style:{maxHeight:"calc(95vh)",maxWidth:"100%"},children:c.payloadtype.map((function(e){return Object(a.jsx)($e,Object(i.a)({},e),e.id)}))})}var Fe=n(706),ze=n(682),Le=n(703),Re=n(680),He=n(656),We=n(658),Ue=n(702);function Ve(e){return Object(a.jsxs)("div",{children:[Object(a.jsx)(p.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(a.jsx)(p.a,{variant:"contained",color:"primary",onClick:e.finished,children:e.last?"Create Payload":"Next"})]})}function Qe(){var e=Object(P.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    id\n    supported_os\n  }\n}\n "]);return Qe=function(){return e},e}var Ge=Object(w.gql)(Qe());function Je(e){var t=o.a.useState(""),n=Object(u.a)(t,2),r=n[0],i=n[1],c=Object(w.useQuery)(Ge),l=c.loading,s=c.error,d=c.data;if(l)return Object(a.jsx)("div",{children:Object(a.jsx)(Re.a,{})});if(s)return console.error(s),Object(a.jsx)("div",{children:"Error!"});return Object(a.jsxs)("div",{children:[Object(a.jsx)(H.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(a.jsx)("br",{}),Object(a.jsxs)(He.a,{children:[Object(a.jsx)(Ue.a,{native:!0,value:r,onChange:function(e){return i(e.target.value)},children:function(){var e=d.payloadtype.reduce((function(e,t){var n=t.supported_os.split(",").filter((function(t,n){return e.includes(n)?t:[].concat(Object(T.a)(t),[n])}),[]);return[].concat(Object(T.a)(e),Object(T.a)(n))}),[]).sort();return""===r&&i(e[0]),e}().map((function(e){return Object(a.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(a.jsx)(We.a,{children:"Target Operating System"})]}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(Ve,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){e.finished(r)}})]})}function Ye(e){var t=o.a.useState(""),n=Object(u.a)(t,2),r=n[0],i=n[1],c=function(){if(e.default_value){var t=e.default_value.split("\n");return null===r&&i(t[0]),t}var n=e.parameter.split("\n");return null===r&&i(n[0]),n},l=function(t){i(t.target.value),e.onChange(e.name,t.target.value,!1)},s=function(t,n,a){i(n),e.onChange(e.name,n,a)},d=function(t){return(e.required&&""!==e.verifier_regex||""!==e.verifier_regex&&""!==t)&&!RegExp(e.verifier_regex).test(t)};return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:e.description}),Object(a.jsx)(E.a,{children:function(){switch(e.parameter_type){case"ChooseOne":return Object(a.jsx)(He.a,{children:Object(a.jsx)(Ue.a,{native:!0,value:r,onChange:l,children:c().map((function(e,t){return Object(a.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"String":return Object(a.jsx)(y,{required:e.required,placeholder:e.default_value,value:r,multiline:!0,onChange:s,display:"inline-block",validate:d,errorText:"Must match: "+e.verifier_regex});default:return null}}()})]},"buildparam"+e.id)}function Ke(e){return Object(a.jsxs)($.a,{component:A.a,className:"mythicElement",children:[Object(a.jsx)(H.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(a.jsxs)(D.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Build Parameter"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsx)(M.a,{children:e.buildParameters.map((function(t){return Object(a.jsx)(Ye,Object(i.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}function Ze(){var e=Object(P.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    note\n    buildparameters {\n      id\n      name\n      description\n      parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "]);return Ze=function(){return e},e}var Xe=Object(w.gql)(Ze());function et(e){var t=o.a.useState(""),n=Object(u.a)(t,2),r=n[0],c=n[1],l=o.a.useState([]),s=Object(u.a)(l,2),d=s[0],j=s[1],b=Object(w.useQuery)(Xe,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(e){if(e.payloadtype.length>0){c(e.payloadtype[0].ptype);var t=e.payloadtype.reduce((function(t,n){return n.ptype===e.payloadtype[0].ptype?n.buildparameters.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{error:e.required})})):t}),[]);j(t)}}}),p=b.loading,m=b.error,h=b.data;if(p)return Object(a.jsx)("div",{children:Object(a.jsx)(Re.a,{})});if(m)return console.error(m),Object(a.jsx)("div",{children:"Error!"});return Object(a.jsxs)("div",{children:[Object(a.jsx)(H.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(a.jsx)(Ue.a,{native:!0,value:r,onChange:function(e){c(e.target.value);var t=h.payloadtype.reduce((function(t,n){return n.ptype===e.target.value?n.buildparameters.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{error:e.required})})):t}),[]);j(t)},children:h.payloadtype.map((function(e){return Object(a.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(a.jsx)("br",{}),Object(a.jsx)(Ke,{onChange:function(e,t,n){var a=d.map((function(a){return a.name===e?Object(i.a)(Object(i.a)({},a),{},{value:t,error:n}):a}));j(a)},buildParameters:d}),Object(a.jsx)(Ve,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=d.map((function(e){return{name:e.name,value:e.value}}));e.finished({payload_type:r,parameters:t})}})]})}function tt(){var e=Object(P.a)(["\nquery getCommands($payloadType: String!) {\n  command(where: {payloadtype: {ptype: {_eq: $payloadType}}}, order_by: {cmd: asc}) {\n    cmd\n    id\n  }\n}\n "]);return tt=function(){return e},e}var nt=Object(w.gql)(tt());function at(e){var t=o.a.useState([]),n=Object(u.a)(t,2),r=n[0],i=n[1],c=Object(w.useQuery)(nt,{variables:{payloadType:e.buildOptions.payload_type}}),l=c.loading,s=c.error,d=c.data;if(l)return Object(a.jsx)("div",{children:Object(a.jsx)(Re.a,{})});if(s)return console.error(s),Object(a.jsx)("div",{children:"Error!"});return Object(a.jsxs)("div",{children:[Object(a.jsx)(H.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Select Commands"})," ",Object(a.jsx)("br",{}),Object(a.jsxs)(He.a,{children:[Object(a.jsx)(Ue.a,{multiple:!0,native:!0,value:r,inputProps:{size:20},onChange:function(e){for(var t=e.target.options,n=[],a=0,r=t.length;a<r;a+=1)t[a].selected&&n.push(t[a].value);i(n)},children:d.command.map((function(e){return Object(a.jsx)("option",{value:e.cmd,children:e.cmd},"step3"+e.cmd)}))}),Object(a.jsx)(We.a,{children:"Select Commands"})]}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(Ve,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){e.finished(r)}})]})}function rt(e){var t=function(t,n,a){e.onChange(e.name,t,n,a)};return Object(a.jsx)($.a,{component:A.a,className:"mythicElement",children:Object(a.jsxs)(D.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{style:{width:"30%"},children:"Parameter"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsx)(M.a,{children:e.c2profileparameters.map((function(e){return Object(a.jsx)(Ye,Object(i.a)({onChange:t},e),"c2paramtablerow"+e.id)}))})]})})}var it=n(681);function ct(){var e=Object(P.a)(["\nquery getPayloadTypesC2ProfilesQuery($payloadType: String!) {\n  c2profile(where: {payloadtypec2profiles: {payloadtype: {ptype: {_eq: $payloadType}}}, deleted: {_eq: false}}) {\n    name\n    is_p2p\n    description\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n  }\n}\n "]);return ct=function(){return e},e}var ot=Object(w.gql)(ct());function lt(e){var t=o.a.useState([]),n=Object(u.a)(t,2),r=n[0],c=n[1],l=Object(I.c)().enqueueSnackbar,s=Object(w.useQuery)(ot,{variables:{payloadType:e.buildOptions.payload_type},onCompleted:function(e){var t=e.c2profile.map((function(e){var t=e.c2profileparameters.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{error:e.required})}));return Object(i.a)(Object(i.a)({},e),{},{selected:!1,c2profileparameters:t})}));c(t)}}),d=s.loading,j=s.error;if(d)return Object(a.jsx)("div",{children:Object(a.jsx)(Re.a,{})});if(j)return console.error(j),Object(a.jsx)("div",{children:"Error!"});var b=function(e,t,n,a){var o=r.map((function(r){if(r.name===e){var c=r.c2profileparameters.map((function(e){return e.name===t?Object(i.a)(Object(i.a)({},e),{},{error:a,value:n}):e}));return Object(i.a)(Object(i.a)({},r),{},{c2profileparameters:c})}return r}));c(o)};return Object(a.jsxs)("div",{children:[Object(a.jsx)(H.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Select C2 Profiles"}),r.map((function(e){return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(it.a,{value:"top",control:Object(a.jsx)(F.a,{checked:e.selected,onChange:function(t){return function(e,t){var n=r.map((function(e){return t.name===e.name?Object(i.a)(Object(i.a)({},e),{},{selected:!e.selected}):e}));c(n)}(0,e)},inputProps:{"aria-label":"primary checkbox"},name:"active"}),label:e.name,labelPlacement:"top",style:{display:"inline"}},"step4c2switch"+e.id),Object(a.jsx)(H.a,{variant:"body1",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:e.description},"step4desc"+e.id),e.selected?Object(a.jsx)(rt,Object(i.a)(Object(i.a)({},e),{},{onChange:b}),"step4table"+e.id):null]})})),Object(a.jsx)("br",{}),Object(a.jsx)(Ve,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=!0;r.forEach((function(e){e.selected&&e.c2profileparameters.forEach((function(n){n.error&&(t=!1,l(e.name+"'s parameter "+n.name+" is invalid",{variant:"warning",autoHideDuration:2e3}))}))})),t&&e.finished(r)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]})}var st=n(141),dt=n.n(st),ut=n(124),jt=n.n(ut),bt=n(322),pt=n.n(bt),mt=n(84);function ht(){var e=Object(P.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]);return ht=function(){return e},e}var Ot=Object(w.gql)(ht()),ft=Object(b.a)((function(e){return{root:Object(d.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),xt=o.a.forwardRef((function(e,t){var n=Object(c.useContext)(mt.a),r=ft(n),i=Object(I.c)().closeSnackbar,o=Object(c.useState)(!1),l=Object(u.a)(o,2),s=l[0],b=l[1];return Object(a.jsx)(I.a,{ref:t,className:r.root,children:Object(a.jsxs)(we.a,{style:{backgroundColor:n.successColor},children:[Object(a.jsxs)(Ie.a,{classes:{root:r.actionRoot},children:[Object(a.jsx)(H.a,{variant:"subtitle2",className:r.typography,children:"Payload successfuly built!"}),Object(a.jsxs)("div",{className:r.icons,children:[Object(a.jsx)(R.a,{"aria-label":"Show more",className:Object(j.a)(r.expand,Object(d.a)({},r.expandOpen,s)),onClick:function(){b(!s)},children:Object(a.jsx)(jt.a,{})}),Object(a.jsx)(R.a,{className:r.expand,onClick:function(){i(e.id)},children:Object(a.jsx)(dt.a,{})})]})]}),Object(a.jsx)(L.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(a.jsxs)(A.a,{className:r.collapse,children:[Object(a.jsx)(H.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(a.jsxs)(p.a,{size:"small",className:r.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(a.jsx)(pt.a,{className:r.checkIcon}),"Download now"]})]})})]})})}));function gt(e){var t=Object(I.c)(),n=t.enqueueSnackbar,r=t.closeSnackbar,i=o.a.useState(null),l=Object(u.a)(i,2),s=l[0],d=l[1],j=Object(w.useSubscription)(Ot,{variables:{fromNow:s}}),b=j.loading,m=j.error,h=j.data,O=function(e){return Object(a.jsx)(o.a.Fragment,{children:Object(a.jsx)(p.a,{onClick:function(){r(e)},variant:"outlined",children:"'Dismiss'"})})};return Object(c.useEffect)((function(){d((new Date).toISOString())}),[]),Object(c.useEffect)((function(){!b&&!m&&h&&h.payload.length>0?"success"===h.payload[0].build_phase?n(h.payload[0].build_message,{persist:!0,content:function(e){return Object(a.jsx)(xt,{id:e,file_id:h.payload[0].filemetum.agent_file_id})}}):"building"===h.payload[0].build_phase?n("Building payload ".concat(h.payload[0].uuid,"..."),{variant:"info",autoHideDuration:5e3}):n(h.payload[0].build_message,{variant:"error",persist:!0,action:O}):m&&(console.log(m),n("Mythic encountered an error",{variant:"error"}))}),[b,h,n]),null}function vt(){var e=Object(P.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "]);return vt=function(){return e},e}var yt=Object(w.gql)(vt());function kt(e){var t=Object(I.c)().enqueueSnackbar,n=Object(w.useMutation)(yt,{update:function(e,n){var a=n.data;"success"===a.createPayload.status?t("Submitted payload to build pipeline",{variant:"info"}):t(a.createPayload.error,{variant:"error"})}}),r=Object(u.a)(n,1)[0];return Object(a.jsxs)("div",{children:[Object(a.jsx)(H.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(a.jsx)("br",{}),Object(a.jsx)(Ve,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),n=e.buildOptions[3].reduce((function(e,t){if(t.selected){var n=t.c2profileparameters.reduce((function(e,t){return Object(i.a)(Object(i.a)({},e),{},Object(d.a)({},t.name,t.value))}),{});return[].concat(Object(T.a)(e),[{c2_profile:t.name,c2_profile_parameters:n}])}return e}),[]),a={os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:"my payload.js",commands:e.buildOptions[2],build_parameters:t,c2_profiles:n};r({variables:{payload:JSON.stringify(a)}}).catch((function(e){console.log(e)}))}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(gt,{fromNow:!0})]})}function _t(e){var t=o.a.useState({}),n=Object(u.a)(t,2),r=n[0],c=n[1],l=o.a.useState(0),s=Object(u.a)(l,2),j=s[0],b=s[1],p=function(e){c(Object(i.a)(Object(i.a)({},r),{},Object(d.a)({},j,e))),O()},m=function(){f()},h=["Select Target OS","Payload Type","Select Commands","Select C2 Profiles","Build"],O=function(){b((function(e){return e+1}))},f=function(){b((function(e){return e-1}))};return Object(a.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(a.jsx)(Fe.a,{activeStep:j,alternativeLabel:!0,children:h.map((function(e,t){return Object(a.jsx)(ze.a,{children:Object(a.jsx)(Le.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(a.jsx)(Je,{buildOptions:r,finished:p,canceled:m,first:!0,last:!1});case 1:return Object(a.jsx)(et,{buildOptions:r[0],finished:p,canceled:m,first:!1,last:!1});case 2:return Object(a.jsx)(at,{buildOptions:r[1],finished:p,canceled:m,first:!1,last:!1});case 3:return Object(a.jsx)(lt,{buildOptions:r[1],finished:p,canceled:m,first:!1,last:!1});case 4:return Object(a.jsx)(kt,{buildOptions:r,canceled:m,first:!1,last:!0});default:return"Unknown step"}}(j)]})}var wt=n(323),Ct=n.n(wt),St=n(686),It=n(348),qt=n(603),Tt=n(684),Pt=n(683),Dt=n(710),Mt=n(685),Et=Object(b.a)((function(e){return{root:{width:"100%",maxWidth:"36ch",backgroundColor:e.palette.background.paper},inline:{display:"inline"}}}));function $t(e){var t=Et(),n=Object(c.useContext)(mt.a),r=o.a.useState(null),i=Object(u.a)(r,2),l=i[0],s=i[1],d=Object(w.useReactiveVar)(C),j=function(){s(null)},b=function(){return"warning"===e.level&&!e.resolved},p=function(){return"warning"===e.level&&e.resolved},m=function(){e.onUpdateResolution(e.id,!e.resolved),j()};return Object(a.jsxs)(qt.a,{alignItems:"flex-start",style:{backgroundColor:p()?n.successColor:b()?n.errorColor:""},children:[Object(a.jsx)(Pt.a,{children:Object(a.jsx)(Dt.a,{children:e.operator?e.operator.username[0]:"M"})}),Object(a.jsx)(Tt.a,{primary:Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(H.a,{component:"span",variant:"body1",className:t.inline,color:"textPrimary",style:{fontWeight:"bold"},children:e.operator?e.operator.username:"Mythic"}),Object(a.jsx)(H.a,{component:"span",variant:"caption",className:t.inline,color:"textSecondary",style:{marginLeft:"10px"},children:oe(e.timestamp,d.user.view_utc_time)})]}),secondary:Object(a.jsx)(o.a.Fragment,{children:Object(a.jsx)(H.a,{component:"span",variant:"body1",className:t.inline,color:"textPrimary",style:{overflowWrap:"break-word"},children:e.message})})}),Object(a.jsxs)(Mt.a,{children:[Object(a.jsx)(R.a,{"aria-controls":"eventmenu"+e.id,"aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},children:Object(a.jsx)(Ct.a,{})}),Object(a.jsxs)(It.a,{elevation:5,id:"eventmenu"+e.id,anchorEl:l,keepMounted:!0,open:Boolean(l),onClose:j,children:[p()?Object(a.jsx)(St.a,{onClick:m,children:"Unresolve"}):b()?Object(a.jsx)(St.a,{onClick:m,children:"Resolve"}):Object(a.jsx)(St.a,{onClick:function(){e.onUpdateLevel(e.id),j()},children:"Make Warning"}),Object(a.jsxs)(St.a,{onClick:function(){e.onUpdateDeleted(e.id),j()},children:[Object(a.jsx)(J.a,{}),"Delete"]})]})]})]})}var Nt=n(184),Bt=n.n(Nt),At=n(600);function Ft(e){var t=Object(c.useRef)(null),n=Object(c.useContext)(mt.a),r=o.a.useState(""),l=Object(u.a)(r,2),s=l[0],d=l[1],j=function(t){t.preventDefault(),s&&s.length>0&&(e.onSubmitMessage("info",s),d(""))};return Object(c.useEffect)((function(){t.current.scrollIntoView(),e.subscribeToMoreMessages()}),[]),Object(c.useEffect)((function(){t.current.scrollIntoView({behavior:"smooth"})}),[e.operationeventlog]),Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(H.a,{variant:"h4",style:{textAlign:"left"},children:"Operational Event Messages"}),Object(a.jsxs)(A.a,{elevation:5,style:{position:"relative",height:"calc(90vh)",backgroundColor:n.body},children:[Object(a.jsxs)(At.a,{style:{height:"calc(84vh)",overflow:"auto",maxWidth:"100%"},dense:!0,children:[e.operationeventlog.map((function(t){return Object(a.jsx)($t,Object(i.a)({onDeleteOperator:e.onDeleteOperator,onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,onUpdateDeleted:e.onUpdateDeleted},t),"event"+t.id)})),Object(a.jsx)("div",{ref:t})]}),Object(a.jsx)("div",{style:{padding:"0",margin:"0",position:"absolute",bottom:0,width:"100%"},children:Object(a.jsx)("form",{onSubmit:j,children:Object(a.jsx)(x.a,{InputProps:{endAdornment:Object(a.jsx)(R.a,{color:"primary",variant:"contained",onClick:j,children:Object(a.jsx)(Bt.a,{})})},fullWidth:!0,size:"small",style:{padding:0,margin:0},variant:"outlined",value:s,onChange:function(e){e.preventDefault(),d(e.target.value)},label:"Type Message..."})})})]})]})}function zt(){var e=Object(P.a)(["\nsubscription OperationEventLogSubscription($operation_id: Int!) {\n  operationeventlog(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}}, limit: 1, order_by: {timestamp: desc}) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    operator {\n      username\n    }\n  }\n}\n "]);return zt=function(){return e},e}function Lt(){var e=Object(P.a)(["\nmutation UpdateDeletedOperationEventLog($id: Int!) {\n  update_operationeventlog(where:{id: {_eq: $id}}, _set: {deleted: true}) {\n    returning{\n        id\n        deleted\n    }\n  }\n}\n "]);return Lt=function(){return e},e}function Rt(){var e=Object(P.a)(['\nmutation UpdateLevelOperationEventLog($id: Int!) {\n  update_operationeventlog(where:{id: {_eq: $id}}, _set: {level: "warning"}) {\n    returning{\n        id\n        level\n    }\n  }\n}\n ']);return Rt=function(){return e},e}function Ht(){var e=Object(P.a)(["\nmutation UpdateResolutionOperationEventLog($id: Int!, $resolved: Boolean!) {\n  update_operationeventlog(where:{id: {_eq: $id}}, _set: {resolved: $resolved}) {\n    returning{\n        id\n        resolved\n    }\n  }\n}\n "]);return Ht=function(){return e},e}function Wt(){var e=Object(P.a)(["\nmutation CreateOperationEventLog($operation_id: Int!, $message: String!, $level: String!, $operator_id: Int!) {\n  insert_operationeventlog_one(object:{level: $level, message: $message, operation_id: $operation_id, operator_id: $operator_id}) {\n    id\n  }\n}\n "]);return Wt=function(){return e},e}function Ut(){var e=Object(P.a)(["\nquery GetOperationEventLogs($operation_id: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {timestamp: asc}) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    operator {\n      username\n    }\n  }\n}\n "]);return Ut=function(){return e},e}var Vt=Object(w.gql)(Ut()),Qt=Object(w.gql)(Wt()),Gt=Object(w.gql)(Ht()),Jt=Object(w.gql)(Rt()),Yt=Object(w.gql)(Lt()),Kt=Object(w.gql)(zt());function Zt(e){var t=Object(w.useReactiveVar)(C),n=Object(w.useQuery)(Vt,{variables:{operation_id:t.user.current_operation_id}}),r=n.loading,c=n.error,o=n.data,l=n.subscribeToMore,s=Object(w.useMutation)(Qt),d=Object(u.a)(s,1)[0],j=Object(w.useMutation)(Gt),b=Object(u.a)(j,1)[0],p=Object(w.useMutation)(Jt),m=Object(u.a)(p,1)[0],h=Object(w.useMutation)(Yt,{update:function(e,n){var a=n.data,r=e.readQuery({query:Vt,variables:{operation_id:t.user.current_operation_id}}),i=a.update_operationeventlog.returning[0],c=r.operationeventlog.filter((function(e){return e.id!==i.id}));e.writeQuery({query:Vt,variables:{operation_id:t.user.current_operation_id},data:{operationeventlog:c}})}}),O=Object(u.a)(h,1)[0];return r?Object(a.jsx)(de.a,{}):c?(console.error(c),null):Object(a.jsx)(Ft,Object(i.a)(Object(i.a)({onSubmitMessage:function(e,n){d({variables:{operation_id:t.user.current_operation_id,level:e,message:n,operator_id:t.user.id}})}},o),{},{subscribeToMoreMessages:function(){return l({document:Kt,variables:{operation_id:t.user.current_operation_id},updateQuery:function(e,t){var n=t.subscriptionData;return n.data?e.operationeventlog.find((function(e){return e.id===n.data.operationeventlog[0].id}))?e:Object.assign({},e,{operationeventlog:[].concat(Object(T.a)(e.operationeventlog),[n.data.operationeventlog[0]])}):e}})},onUpdateResolution:function(e,t){b({variables:{id:e,resolved:t}})},onUpdateLevel:function(e){m({variables:{id:e}})},onUpdateDeleted:function(e){O({variables:{id:e}})}}))}function Xt(){var e=Object(P.a)(["\nquery GetPayloadDetails($payload_id: Int!, $operation_id: Int!) {\n  payload(where: {id: {_eq: $payload_id}, operation_id: {_eq: $operation_id}}) {\n    uuid\n    payloadcommands {\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    filemetum {\n      filename\n      agent_file_id\n      id\n      md5\n      sha1\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        description\n      }\n    }\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n      }\n      c2profile {\n        name\n      }\n    }\n  }\n}\n"]);return Xt=function(){return e},e}var en=Object(w.gql)(Xt());function tn(e){var t=Object(w.useReactiveVar)(C),n=o.a.useState([]),r=Object(u.a)(n,2),c=r[0],l=r[1],s=o.a.useState([]),j=Object(u.a)(s,2),b=j[0],p=j[1],m=o.a.useState([]),h=Object(u.a)(m,2),O=h[0],f=h[1],x=Object(w.useQuery)(en,{variables:{payload_id:e.payload_id,operation_id:t.user.current_operation_id},onCompleted:function(e){var t=e.payload[0].payloadcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));l(t);var n=e.payload[0].buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));p(n);var a=e.payload[0].c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(i.a)(Object(i.a)({},e),{},Object(d.a)({},t.c2profile.name,[].concat(Object(T.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value}]))):Object(i.a)(Object(i.a)({},e),{},Object(d.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value}]))}),{}),r=Object.keys(a).reduce((function(e,t){return[].concat(Object(T.a)(e),[{c2_profile:t,parameters:a[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);f(r)}}),g=x.loading,v=x.error,y=x.data;return g?Object(a.jsx)(de.a,{}):v?(console.error(v),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(H.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"Payload Information"}),Object(a.jsxs)(D.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Payload Info"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsxs)(M.a,{children:[Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"UUID"}),Object(a.jsx)(E.a,{children:y.payload[0].uuid})]}),y.payload[0].filemetum?Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Filename"}),Object(a.jsx)(E.a,{children:y.payload[0].filemetum.filename})]},"filename"):null,Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Download URL"}),Object(a.jsx)(E.a,{children:window.location.origin+"/direct/download/"+y.payload[0].filemetum.agent_file_id})]}),Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"SHA1"}),Object(a.jsx)(E.a,{children:y.payload[0].filemetum.sha1})]}),Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"MD5"}),Object(a.jsx)(E.a,{children:y.payload[0].filemetum.md5})]})]})]}),Object(a.jsx)(H.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"Loaded Commands"}),Object(a.jsxs)(D.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Command Name"}),Object(a.jsx)(E.a,{children:"Mythic Version"}),Object(a.jsx)(E.a,{children:"Loaded Version"})]})}),Object(a.jsx)(M.a,{children:c.map((function(t){return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:t.cmd}),Object(a.jsx)(E.a,{children:t.mythic}),Object(a.jsx)(E.a,{children:t.payload})]},t.cmd+e.payload_id)}))})]}),Object(a.jsx)(H.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"Build Parameters"}),Object(a.jsxs)(D.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Parameter"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsx)(M.a,{children:b.map((function(t,n){return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:t.description}),Object(a.jsx)(E.a,{children:t.value})]},"buildprop"+n+"for"+e.payload_id)}))})]}),O.map((function(t){return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(H.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:t.c2_profile}),Object(a.jsxs)(D.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Parameter"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsx)(M.a,{children:t.parameters.map((function(n,r){return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:n.description}),Object(a.jsx)(E.a,{children:n.value})]},"c2frag"+e.payload_id+t.c2_profile+r)}))})]})]},"c2frag"+e.payload_id+t.c2_profile)}))]})}var nn=n(185),an=n.n(nn),rn=n(186),cn=n.n(rn);function on(e){var t,n=o.a.useState(!1),r=Object(u.a)(n,2),c=r[0],l=r[1],s=o.a.useState(!1),j=Object(u.a)(s,2),b=(j[0],j[1]),m=o.a.useState(!1),h=Object(u.a)(m,2),O=(h[0],h[1]),f=Object(w.useReactiveVar)(C);return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:Object(a.jsx)(R.a,{size:"small",onClick:function(){O(!0)},color:"secondary",variant:"contained",children:Object(a.jsx)(J.a,{})})}),Object(a.jsx)(E.a,{children:oe(e.creation_time,f.user.view_utc_time)}),Object(a.jsx)(E.a,{children:Object(a.jsx)(p.a,{size:"small",onClick:function(){b(!0)},color:"primary",variant:"contained",children:"Actions"})}),Object(a.jsx)(E.a,{children:Object(a.jsx)(F.a,{checked:e.callback_alert,onChange:function(t){var n=e.id;e.onAlertChanged(n,!e[t.target.name])},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"callback_alert"})}),Object(a.jsx)(E.a,{children:"success"===e.build_phase?Object(a.jsx)(R.a,{variant:"contained",target:"_blank",color:"primary",href:window.location.origin+"/direct/download/"+e.filemetum.agent_file_id,download:!0,children:Object(a.jsx)(an.a,{})}):"building"===e.build_phase?Object(a.jsx)(Re.a,{size:20,thickness:4}):Object(a.jsx)(cn.a,{})}),Object(a.jsx)(E.a,{children:e.filemetum.filename}),Object(a.jsx)(E.a,{children:e.tag}),Object(a.jsx)(E.a,{children:e.payloadtype.ptype}),Object(a.jsx)(E.a,{children:Object(a.jsx)(R.a,(t={size:"small","aria-label":"expand row"},Object(d.a)(t,"size","small"),Object(d.a)(t,"onClick",(function(){return l(!c)})),Object(d.a)(t,"children",c?Object(a.jsx)(Q.a,{className:"mythicElement"}):Object(a.jsx)(U.a,{className:"mythicElement"})),t))})]},e.id),Object(a.jsx)(B.a,{children:Object(a.jsx)(E.a,{style:{paddingBottom:0,paddingTop:0},colSpan:9,children:Object(a.jsx)(L.a,{in:c,timeout:"auto",unmountOnExit:!0,children:Object(a.jsx)(z.a,{margin:1,children:Object(a.jsx)(tn,Object(i.a)(Object(i.a)({},e),{},{payload_id:e.id}))})})})})]})}function ln(e){return Object(a.jsxs)($.a,{component:A.a,className:"mythicElement",children:[Object(a.jsx)(H.a,{variant:"h3",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Payloads"}),Object(a.jsxs)(D.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{style:{width:"2rem"},children:" Delete"}),Object(a.jsx)(E.a,{style:{width:"12rem"},children:"Timestamp"}),Object(a.jsx)(E.a,{style:{width:"4rem"},children:"Modify"}),Object(a.jsx)(E.a,{style:{width:"6rem"},children:"Alert on New"}),Object(a.jsx)(E.a,{style:{width:"4rem"},children:"Download"}),Object(a.jsx)(E.a,{children:"File"}),Object(a.jsx)(E.a,{children:"Description"}),Object(a.jsx)(E.a,{style:{width:"8rem"},children:"Payload Type"}),Object(a.jsx)(E.a,{style:{width:"4rem"},children:"More..."})]})}),Object(a.jsx)(M.a,{children:e.payload.map((function(t){return Object(a.jsx)(on,Object(i.a)({onDeletePayload:e.onDeletePayload,onUpdateCallbackAlert:e.onUpdateCallbackAlert},t),"payload"+t.id)}))})]})]})}function sn(){var e=Object(P.a)(["\nmutation PayloadsCallbackAlertMutation($id: Int!, $callback_alert: Boolean!) {\n  update_payload(where: {id: {_eq: $id}}, _set: {callback_alert: $callback_alert}) {\n    returning {\n      id\n      callback_alert\n    }\n  }\n}\n"]);return sn=function(){return e},e}function dn(){var e=Object(P.a)(["\nmutation PayloadsDeletePayloadMutation($id: Int!) {\n  update_payload(where: {id: {_eq: $id}}, _set: {deleted: true}) {\n    returning {\n      id\n    }\n  }\n}\n"]);return dn=function(){return e},e}function un(){var e=Object(P.a)(["\nquery GetPayloadsQuery($operation_id: Int!) {\n  payload(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}}) {\n    auto_generated\n    build_message\n    build_phase\n    callback_alert\n    creation_time\n    id\n    operator {\n      id\n      username\n    }\n    uuid\n    tag\n    payloadtype {\n      id\n      ptype\n    }\n    filemetum {\n      agent_file_id\n      filename\n      id\n    }\n  }\n}\n\n"]);return un=function(){return e},e}var jn=Object(w.gql)(un()),bn=Object(w.gql)(dn()),pn=Object(w.gql)(sn());function mn(e){var t=Object(w.useReactiveVar)(C),n=Object(w.useQuery)(jn,{variables:{operation_id:t.user.current_operation_id}}),r=n.loading,c=n.error,o=n.data,l=Object(w.useMutation)(bn,{update:function(e,n){var a=n.data,r=e.readQuery({query:jn,variables:{operation_id:t.user.current_operation_id}}),i=a.payload.returning[0],c=r.payload.filter((function(e){return e.id!==i.id}));e.writeQuery({query:jn,data:{payload:c},variables:{operation_id:t.current_operation_id}})}}),s=Object(u.a)(l,1)[0],d=Object(w.useMutation)(pn,{update:function(e,t){t.data}}),j=Object(u.a)(d,1)[0];return r?Object(a.jsx)(de.a,{}):c?(console.error(c),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsx)("div",{style:{height:"calc(94vh)",marginTop:"10px"},children:Object(a.jsx)(ln,Object(i.a)({onDeletePayload:function(e){s({variables:{id:e}})},onUpdateCallbackAlert:function(e,t){j({variables:{id:e,callback_alert:t}})}},o))})}var hn=n(687),On=n(189),fn=Object(b.a)((function(e){return{root:{width:"99%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:On.a[500]}}}));function xn(){var e=fn(),t=o.a.useState(!1),n=Object(u.a)(t,2),r=n[0],i=n[1];return Object(a.jsxs)(we.a,{className:e.root,elevation:5,children:[Object(a.jsx)(hn.a,{avatar:Object(a.jsx)(Dt.a,{"aria-label":"recipe",className:e.avatar,children:"S"}),title:"Mythic Quick Start",subheader:"Creating Payloads and Getting Callbacks"}),Object(a.jsx)(Se.a,{children:Object(a.jsx)(H.a,{variant:"body2",color:"textSecondary",component:"p",children:"This sections walks through how to generate a payload, download the payload, get a callback, and interact with it."})}),Object(a.jsx)(Ie.a,{disableSpacing:!0,children:Object(a.jsx)(R.a,{className:Object(j.a)(e.expand,Object(d.a)({},e.expandOpen,r)),onClick:function(){i(!r)},"aria-expanded":r,"aria-label":"show more",children:Object(a.jsx)(jt.a,{})})}),Object(a.jsx)(L.a,{in:r,timeout:"auto",unmountOnExit:!0,children:Object(a.jsxs)(Se.a,{children:[Object(a.jsx)(H.a,{paragraph:!0,children:"Method:"}),Object(a.jsx)(H.a,{paragraph:!0,children:"Heat 1/2 cup of the broth in a pot until simmering, add saffron and set aside for 10 minutes."})]})})]})}function gn(){return Object(a.jsx)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:Object(a.jsx)(xn,{})})}var vn=n(4);function yn(e){var t=e.component,n=Object(vn.a)(e,["component"]),r=Object(w.useReactiveVar)(C);return Object(a.jsx)(_.b,Object(i.a)(Object(i.a)({},n),{},{render:function(e){return r.loggedIn?o.a.createElement(t,e):Object(a.jsx)(_.a,{to:{pathname:"/new/login",state:{from:e.location}}})}}))}function kn(){var e=Object(P.a)(["\nquery GetPC2Details($payload_name: String!) {\n  c2profile(where: {name: {_eq: $payload_name}}) {\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      name\n      parameter_type\n      id\n      randomize\n      required\n      verifier_regex\n    }\n  }\n}\n"]);return kn=function(){return e},e}var _n=Object(w.gql)(kn());function wn(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],i=n[1],l=Object(w.useQuery)(_n,{variables:{payload_name:e.payload_name},onCompleted:function(e){i(e.c2profile[0].c2profileparameters)}}),s=l.loading,d=l.error;return s?Object(a.jsx)(de.a,{}):d?(console.error(d),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ne.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(a.jsxs)(ee.a,{dividers:!0,children:[Object(a.jsx)(te.a,{children:"These are the build parameters associated with this payload"}),Object(a.jsxs)(D.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Parameter"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsx)(M.a,{children:r.map((function(e){return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:e.description}),Object(a.jsxs)(E.a,{children:["Scripting/Building Name:",Object(a.jsx)("br",{}),e.name,Object(a.jsx)("br",{}),"Parameter Type:",Object(a.jsx)("br",{}),e.parameter_type,Object(a.jsx)("br",{}),"Default Parameter:",Object(a.jsx)("br",{}),e.default_value,Object(a.jsx)("br",{}),"Required value?",Object(a.jsx)("br",{}),e.required?"Yes":"No",Object(a.jsx)("br",{}),"Verifier Regex:",Object(a.jsx)("br",{}),e.verifier_regex,Object(a.jsx)("br",{}),"Randomize value?: ",Object(a.jsx)("br",{}),e.randomize?"Yes":"No",Object(a.jsx)("br",{}),"Random Format String: ",Object(a.jsx)("br",{}),e.format_string,Object(a.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(a.jsx)(X.a,{children:Object(a.jsx)(p.a,{onClick:e.onClose,color:"primary",children:"Close"})})]})}var Cn=n(142),Sn=n.n(Cn),In=n(688),qn=n(187),Tn=n.n(qn),Pn=n(659),Dn=n(598),Mn=n(604),En=n(657),$n=n(125),Nn=n.n($n);function Bn(){var e=Object(P.a)(["\nquery getProfileOutput($id: Int!) {\n  getProfileOutput(id: $id) {\n    status\n    error\n    output\n  }\n}\n"]);return Bn=function(){return e},e}var An=Object(w.gql)(Bn());function Fn(e){var t=Object(w.useQuery)(An,{variables:{id:e.profile_id},onCompleted:function(e){},fetchPolicy:"network-only"}),n=t.loading,r=t.error,i=t.data;return n?Object(a.jsx)(de.a,{}):r?(console.error(r),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ne.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(a.jsxs)(ee.a,{dividers:!0,children:[Object(a.jsx)(te.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(a.jsx)(y,{multiline:!0,onChange:function(){},value:i.getProfileOutput.output})]}),Object(a.jsx)(X.a,{children:Object(a.jsx)(p.a,{onClick:e.onClose,color:"primary",children:"Close"})})]})}function zn(){var e=Object(P.a)(["\nquery getProfileConfigOutput($id: Int!, $filename: String!) {\n  downloadContainerFile(id: $id, filename: $filename) {\n    status\n    error\n    filename\n    data\n  }\n}\n"]);return zn=function(){return e},e}var Ln=Object(w.gql)(zn());function Rn(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],i=n[1],l=Object(w.useQuery)(Ln,{variables:{id:e.profile_id,filename:"config.json"},onCompleted:function(e){"error"===e.downloadContainerFile.status?i("Errored trying to read file from container\n"+e.downloadContainerFile.error):i(atob(e.downloadContainerFile.data))},fetchPolicy:"network-only"}),s=l.loading,d=l.error;if(s)return Object(a.jsx)(de.a,{});if(d)return console.error(d),Object(a.jsx)("div",{children:"Error!"});return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ne.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Configuration"]}),Object(a.jsx)(ee.a,{dividers:!0,children:Object(a.jsx)(y,{multiline:!0,onChange:function(e,t,n){i(t)},value:r})}),Object(a.jsxs)(X.a,{children:[Object(a.jsx)(p.a,{onClick:e.onClose,color:"primary",children:"Close"}),Object(a.jsx)(p.a,{onClick:function(){e.onConfigSubmit(btoa(r)),e.onClose()},color:"secondary",children:"Submit"})]})]})}function Hn(e){return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ne.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(a.jsxs)(ee.a,{dividers:!0,children:[Object(a.jsx)(te.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(a.jsx)(y,{multiline:!0,value:e.output,onChange:function(){}})]}),Object(a.jsx)(X.a,{children:Object(a.jsx)(p.a,{onClick:e.onClose,color:"primary",children:"Close"})})]})}function Wn(){var e=Object(P.a)(["\nmutation setProfileConfiguration($id: Int!, $file_path: String!, $data: String!) {\n  uploadContainerFile(id: $id, file_path: $file_path, data: $data) {\n    status\n    error\n    filename\n  }\n}\n"]);return Wn=function(){return e},e}function Un(){var e=Object(P.a)(["\nmutation StartStopProfile($id: Int!, $action: String) {\n  startStopProfile(id: $id, action: $action) {\n    status\n    error\n    output\n  }\n}\n"]);return Un=function(){return e},e}var Vn=Object(b.a)((function(e){return{root:{width:"100%",display:"flex",margin:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),Qn=Object(g.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(qe.a),Gn=Object(w.gql)(Un()),Jn=Object(w.gql)(Wn());function Yn(e){var t=Vn(),n=new Date,r=(n.getTime()+6e4*n.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning",c=o.a.useState(!1),l=Object(u.a)(c,2),s=l[0],d=l[1],j=o.a.useState(!1),b=Object(u.a)(j,2),m=b[0],h=b[1],O=o.a.useRef(null),f=Object(I.c)().enqueueSnackbar,x=function(e){O.current&&O.current.contains(e.target)||h(!1)},g=Object(w.useMutation)(Gn,{update:function(e,t){t.data},onError:function(e){f(e.message,{variant:"error"}),console.log(e)},onCompleted:function(e){N(e.startStopProfile.output),L(!0)}}),v=Object(u.a)(g,1)[0],y=function(){e.running?f("Submitting stop task...",{variant:"info"}):f("Submitting start task...",{variant:"info"}),v({variables:{id:e.id,action:e.running?"stop":"start"}})},k=o.a.useState(!1),_=Object(u.a)(k,2),C=_[0],S=_[1],q=o.a.useState(!1),T=Object(u.a)(q,2),P=T[0],D=T[1],M=o.a.useState(""),E=Object(u.a)(M,2),$=E[0],N=E[1],B=o.a.useState(!1),F=Object(u.a)(B,2),z=F[0],L=F[1],R=Object(w.useMutation)(Jn,{update:function(e,t){t.data},onError:function(e){f(e.message,{variant:"error"}),console.log(e)},onCompleted:function(e){"success"===e.uploadContainerFile.status?f("Updated file",{variant:"success"}):f("Error updating: "+e.uploadContainerFile.error,{variant:"error"})}}),W=Object(u.a)(R,1)[0];return Object(a.jsxs)(we.a,{className:t.root,elevation:5,style:{maxWidth:"99%"},children:[Object(a.jsx)("div",{children:Object(a.jsx)(Qn,{overlap:"circle",classes:{badge:t[r]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.is_p2p?Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(Nn.a,{fontSize:"large"}),Object(a.jsx)(Nn.a,{fontSize:"large"})]}):Object(a.jsx)(Sn.a,{fontSize:"large"})})}),Object(a.jsxs)("div",{children:[Object(a.jsx)(H.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.name}),Object(a.jsxs)(Se.a,{style:{textAlign:"left"},children:[Object(a.jsxs)(H.a,{variant:"body1",component:"p",children:[Object(a.jsx)("b",{children:"Author:"})," ",e.author]}),Object(a.jsxs)(H.a,{variant:"body1",component:"p",children:[Object(a.jsx)("b",{children:"Supported Agents:"})," ",e.payloadtypec2profiles.map((function(e){return e.payloadtype.ptype+" "}))]}),Object(a.jsx)(H.a,{variant:"body2",component:"p",children:e.description}),Object(a.jsx)(H.a,{variant:"body2",component:"p",children:e.translation_container?Object(a.jsxs)(H.a,{variant:"body1",component:"p",children:[Object(a.jsx)("b",{children:"Translation Container:"})," ",e.translation_container]}):null})]}),Object(a.jsxs)(Ie.a,{children:[Object(a.jsx)(p.a,{size:"small",color:"primary",href:"/docs/c2-profiles/"+e.name.toLowerCase(),target:"_blank",children:"Docs"}),Object(a.jsx)(p.a,{size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Build Info"}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"lg",open:s,onClose:function(){d(!1)},innerDialog:Object(a.jsx)(wn,Object(i.a)(Object(i.a)({},e),{},{onClose:function(){d(!1)},payload_name:e.name}))}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"lg",open:z,onClose:function(){L(!1)},innerDialog:Object(a.jsx)(Hn,{output:$,onClose:function(){L(!1)},payload_name:e.name})}),Object(a.jsxs)(In.a,{variant:"contained",color:e.running?"primary":"secondary",ref:O,"aria-label":"split button",children:[e.running?Object(a.jsx)(p.a,{size:"small",onClick:y,children:"Stop Profile"}):Object(a.jsx)(p.a,{size:"small",onClick:y,children:"Start Profile"}),Object(a.jsx)(p.a,{size:"small","aria-controls":m?"split-button-menu":void 0,"aria-expanded":m?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:function(){h((function(e){return!e}))},children:Object(a.jsx)(Tn.a,{})})]}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"lg",open:C,onClose:function(){S(!1)},innerDialog:Object(a.jsx)(Fn,Object(i.a)(Object(i.a)({},e),{},{payload_name:e.name,onClose:function(){S(!1)},profile_id:e.id}))}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"lg",open:P,onClose:function(){D(!1)},innerDialog:Object(a.jsx)(Rn,Object(i.a)(Object(i.a)({},e),{},{onConfigSubmit:function(t){W({variables:{id:e.id,file_path:"config.json",data:t}})},payload_name:e.name,onClose:function(){D(!1)},profile_id:e.id}))}),Object(a.jsx)(Mn.a,{open:m,anchorEl:O.current,role:void 0,transition:!0,disablePortal:!0,children:function(t){var n=t.TransitionProps,r=t.placement;return Object(a.jsx)(Dn.a,Object(i.a)(Object(i.a)({},n),{},{style:{transformOrigin:"bottom"===r?"center top":"center bottom"},children:Object(a.jsx)(A.a,{children:Object(a.jsx)(Pn.a,{onClickAway:x,children:Object(a.jsxs)(En.a,{id:"split-button-menu",children:[Object(a.jsx)(St.a,{onClick:function(){D(!0)},children:"View Config"},"dropdownprofile"+e.id+"menu1"),e.running?Object(a.jsx)(St.a,{onClick:function(){S(!0)},children:"View Stdout/Stderr"},"dropdownprofile"+e.id+"menu2"):null]})})})}))}})]})]})]})}function Kn(){var e=Object(P.a)(["\n subscription getPayloadTypesSubscription {\n    c2profile(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n    author\n    id\n    container_running\n    description\n    is_p2p\n    last_heartbeat\n    name\n    running\n    translation_container\n    mythic_encrypts\n    payloadtypec2profiles(order_by: {payloadtype: {ptype: asc}}) {\n      payloadtype {\n        ptype\n      }\n    }\n  }\n}\n "]);return Kn=function(){return e},e}var Zn=Object(w.gql)(Kn());function Xn(e){var t=Object(w.useSubscription)(Zn),n=t.loading,r=t.error,c=t.data;return n?Object(a.jsx)(de.a,{}):r?(console.error(r),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsx)("div",{style:{maxHeight:"calc(95vh)",maxWidth:"100%"},children:c.c2profile.map((function(e){return Object(a.jsx)(Yn,Object(i.a)({},e),"c2prof"+e.id)}))})}var ea=n(711),ta=n(704);function na(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function aa(e,t){return"desc"===e?function(e,n){return na(e,n,t)}:function(e,n){return-na(e,n,t)}}function ra(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))}function ia(e){var t=e.classes,n=e.onSelectAllClick,r=e.order,i=e.orderBy,c=e.numSelected,o=e.onRequestSort;return Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{padding:"checkbox",children:Object(a.jsx)(ta.a,{indeterminate:c>0&&c<e.rowCount,checked:e.rowCount>0&&c===e.rowCount,onChange:n,inputProps:{"aria-label":"select all desserts"}})}),e.headCells.map((function(e){return Object(a.jsx)(E.a,{align:"left",padding:e.disablePadding?"none":"default",sortDirection:i===e.id&&r,children:Object(a.jsxs)(ea.a,{active:i===e.id,direction:i===e.id?r:"asc",onClick:(n=e.id,function(e){o(e,n)}),children:[e.label,i===e.id?Object(a.jsx)("span",{className:t.visuallyHidden,children:"desc"===r?"sorted descending":"sorted ascending"}):null]})},e.id);var n}))]})})}function ca(e){var t="enhanced-table-checkbox-".concat(e.index);return Object(a.jsxs)(B.a,{hover:!0,onClick:function(t){return e.handleClick(t,e.id)},role:"checkbox","aria-checked":e.isItemSelected,tabIndex:-1,selected:e.isItemSelected,children:[Object(a.jsx)(E.a,{padding:"checkbox",children:Object(a.jsx)(ta.a,{checked:e.isItemSelected,inputProps:{"aria-labelledby":t}})}),e.children]},e.id)}var oa=n(326),la=n.n(oa),sa=n(325),da=n.n(sa),ua=n(221),ja=n(224),ba=n.n(ja);function pa(e){var t=Object(c.useRef)(null);return Object(c.useEffect)((function(){Oa(e.callbackgraphedges,t)}),[]),Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ne.a,{id:"form-dialog-title",children:["Callback ",e.id," (",e.agent_callback_id,")'s Egress Path"]}),Object(a.jsx)(ee.a,{dividers:!0,children:Object(a.jsx)(o.a.Fragment,{children:Object(a.jsx)("svg",{ref:t,id:"nodeTree",width:"550",height:"600"})})}),Object(a.jsx)(X.a,{children:Object(a.jsx)(p.a,{onClick:e.onClose,color:"primary",children:"Close"})})]})}var ma="stroke: #333; fill: none; stroke-width: 1.5px;",ha="stroke: blue; fill: blue; stroke-width: 1.5px;",Oa=function(e,t){var n=new ba.a.graphlib.Graph({compound:!0}).setGraph({rankdir:"LR"}).setDefaultEdgeLabel((function(){return{}}));e.forEach((function(e){if(e.destination.id===e.source.id)return n.setNode(e.source.id,{label:e.source.id,style:"fill: #afa"}),n.setNode("Mythic",{label:"Mythic",style:"fill: #afa"}),void(null===e.end_timestamp?n.setEdge(e.source.id,"Mythic",{label:e.c2profile.name,style:ma,arrowheadStyle:ha}):n.setEdge(e.source.id,"Mythic",{label:e.c2profile.name,style:"stroke: #f66; stroke-width: 3px; stroke-dasharray: 5, 5; fill:none",arrowheadStyle:"fill: #f66"}));n.setNode(e.destination.id,{label:e.destination.id,style:"fill: #afa"}),n.setNode(e.source.id,{label:e.source.id,style:"fill: #afa"}),1===e.direction&&n.setEdge(e.source.id,e.destination.id,{label:e.c2profile.name,style:ma,arrowheadStyle:ha})}));var a=new ba.a.render,r=ua.select(t.current),i=r.append("g");a(i,n);var c=(r.attr("width")-n.graph().width)/2;i.attr("transform","translate("+c+", 20)"),r.attr("height",n.graph().height+40)};function fa(e){Object(w.useReactiveVar)(C);var t=o.a.useRef(null),n=o.a.useState(""),r=Object(u.a)(n,2),l=r[0],s=r[1],d=o.a.useState(!1),j=Object(u.a)(d,2),b=j[0],m=j[1],h=o.a.useState(!1),O=Object(u.a)(h,2),f=O[0],x=O[1],g=function(e){s(function(e){var t=new Date,n=t.getTime()+6e4*t.getTimezoneOffset()-new Date(e).getTime(),a=Math.trunc(n/1e3%60),r=Math.trunc(n/6e4%60),i=Math.trunc(n/36e5%24),c=Math.trunc(n/864e5%365),o="";return 0!==c&&(o+=c+"d"),0!==i&&(o+=i+"h"),0!==r&&(o+=r+"m"),o+(a+"s")}(e))};!function(e,t){var n=Object(c.useRef)();Object(c.useEffect)((function(){n.current=e})),Object(c.useEffect)((function(){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}),[t])}((function(){g(e.last_checkin)}));return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ca,{id:e.id,handleClick:e.handleClick,isItemSelected:e.isItemSelected(e.id),children:[Object(a.jsx)(E.a,{children:Object(a.jsxs)(In.a,{variant:"contained",color:e.locked?"secondary":"primary",ref:t,"aria-label":"split button",children:[Object(a.jsxs)(p.a,{size:"small",onClick:function(t){var n;t.stopPropagation(),n="interact",e.onOpenTab({tabType:n,tabID:e.id+n,callbackID:e.id})},children:[e.locked?Object(a.jsx)(da.a,{}):Object(a.jsx)(la.a,{})," ",e.id]}),Object(a.jsx)(p.a,{style:{padding:0},size:"small","aria-controls":b?"split-button-menu":void 0,"aria-expanded":b?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),m((function(e){return!e}))},children:Object(a.jsx)(Tn.a,{})})]})}),Object(a.jsx)(E.a,{children:e.ip}),Object(a.jsx)(E.a,{children:e.host}),Object(a.jsx)(E.a,{children:e.user}),Object(a.jsx)(E.a,{children:e.domain}),Object(a.jsxs)(E.a,{children:[e.os,"(",e.architecture,")"]}),Object(a.jsx)(E.a,{children:e.pid}),Object(a.jsx)(E.a,{children:l}),Object(a.jsx)(E.a,{children:e.description}),Object(a.jsx)(E.a,{children:e.payload.payloadtype.ptype}),Object(a.jsx)(E.a,{children:e.callbackgraphedges.filter((function(e){return!e.c2profile.is_p2p})).length>0?Object(a.jsx)(Sn.a,{onClick:function(e){e.stopPropagation(),x(!0)}}):Object(a.jsx)(Nn.a,{onClick:function(e){e.stopPropagation(),x(!0)}})})]}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"sm",open:f,onClose:function(){x(!1)},innerDialog:Object(a.jsx)(pa,Object(i.a)({onClose:function(){x(!1)}},e))})]})}var xa=n(16),ga=n(689),va=n(605),ya=n(327),ka=n.n(ya),_a=Object(b.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(xa.e)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}})),wa=function(e){var t=_a(),n=e.numSelected;return Object(a.jsx)(ga.a,{className:Object(j.a)(t.root,Object(d.a)({},t.highlight,n>1)),children:n>1?Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(H.a,{className:t.title,color:"inherit",variant:"subtitle1",component:"div",children:[n," selected"]}),Object(a.jsx)(va.a,{title:"Hide Selected",children:Object(a.jsx)(R.a,{"aria-label":"hide",children:Object(a.jsx)(ka.a,{})})})]}):Object(a.jsx)(o.a.Fragment,{children:Object(a.jsx)(H.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left"},children:"Active Callbacks"})})})},Ca=Object(b.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Sa(e){var t=Ca(),n=o.a.useState("asc"),r=Object(u.a)(n,2),c=r[0],l=r[1],s=o.a.useState("interact"),d=Object(u.a)(s,2),j=d[0],b=d[1],p=o.a.useState([]),m=Object(u.a)(p,2),h=m[0],O=m[1],f=function(e,t){var n=h.indexOf(t),a=[];-1===n?a=a.concat(h,t):0===n?a=a.concat(h.slice(1)):n===h.length-1?a=a.concat(h.slice(0,-1)):n>0&&(a=a.concat(h.slice(0,n),h.slice(n+1))),O(a)},x=function(e){return-1!==h.indexOf(e)};return Object(a.jsx)("div",{children:Object(a.jsxs)($.a,{component:A.a,className:"mythicElement",style:{maxWidth:"100%",overflow:"auto",height:"calc("+e.topHeight+"vh)"},children:[Object(a.jsx)(wa,{numSelected:h.length}),Object(a.jsxs)(D.a,{size:"small",children:[Object(a.jsx)(ia,{numSelected:h.length,rowCount:e.callbacks.length,classes:t,headCells:[{id:"id",numeric:!0,disablePadding:!1,label:"Interact"},{id:"ip",numeric:!1,disablePadding:!1,label:"IP"},{id:"host",numeric:!1,disablePadding:!1,label:"Host"},{id:"user",numeric:!1,disablePadding:!1,label:"User"},{id:"domain",numeric:!1,disablePadding:!1,label:"Domain"},{id:"os",numeric:!1,disablePadding:!1,label:"OS"},{id:"pid",numeric:!0,disablePadding:!1,label:"PID"},{id:"last_checkin",numeric:!0,disablePadding:!1,label:"Last Checkin"},{id:"description",numeric:!1,disablePadding:!1,label:"Description"},{id:"payload",numeric:!1,disablePadding:!1,label:"Payload"},{id:"c2",numeric:!1,disablePadding:!0,label:"C2"}],onSelectAllClick:function(t){if(t.target.checked){var n=e.callbacks.map((function(e){return e.id}));O(n)}else O([])},onRequestSort:function(e,t){l(j===t&&"asc"===c?"desc":"asc"),b(t)},orderBy:j,order:c}),Object(a.jsx)(M.a,{children:ra(e.callbacks,aa(c,j)).map((function(t,n){return Object(a.jsx)(fa,Object(i.a)({handleClick:f,isItemSelected:x,onOpenTab:e.onOpenTab},t),"callback"+t.id)}))})]})]})})}var Ia=n(695),qa=n(700),Ta=n(690);function Pa(e){var t=e.children,n=e.value,r=e.index,c=(e.maxHeight,e.tabInfo,Object(vn.a)(e,["children","value","index","maxHeight","tabInfo"]));return Object(a.jsx)("div",Object(i.a)(Object(i.a)({role:"tabpanel",hidden:n!==r,id:"scrollable-auto-tabpanel-".concat(r),"aria-labelledby":"scrollable-auto-tab-".concat(r)},c),{},{children:n===r?Object(a.jsx)(o.a.Fragment,{children:t}):null}))}function Da(e){var t=e.label,n=e.index,r=(e.fullWidth,e.maxHeight,e.onCloseTab),c=(e.selectionFollowsFocus,e.textColor,e.indicator,e.tabInfo),o=Object(vn.a)(e,["label","index","fullWidth","maxHeight","onCloseTab","selectionFollowsFocus","textColor","indicator","tabInfo"]);return Object(a.jsx)(Ta.a,Object(i.a)(Object(i.a)({label:Object(a.jsxs)("span",{children:[t,Object(a.jsx)(R.a,Object(i.a)(Object(i.a)({component:"div",size:"small",onClick:function(e){e.stopPropagation(),console.log(c),r({tabID:c.tabID})}},o),{},{children:Object(a.jsx)(dt.a,{})}))]})},function(e){return{id:"scrollable-auto-tab-".concat(e),"aria-controls":"scrollable-auto-tabpanel-".concat(e)}}(n)),o))}var Ma=n(701);var Ea=n(712),$a=n(692),Na=n(691),Ba=n(694),Aa=n(693),Fa=n(329),za=n.n(Fa),La=n(330),Ra=n.n(La),Ha=n(331),Wa=n.n(Ha),Ua=n(328),Va=n.n(Ua);function Qa(){var e=Object(P.a)(["\nquery getResponsesQuery($task_id: Int!) {\n  response(where: {task_id: {_eq: $task_id}}) {\n    id\n    response\n  }\n}"]);return Qa=function(){return e},e}function Ga(e){for(var t=e.toString(),n="",a=0;a<t.length;a+=2)n+=String.fromCharCode(parseInt(t.substr(a,2),16));return n}var Ja=Object(w.gql)(Qa());function Ya(e){var t=Object(w.useQuery)(Ja,{variables:{task_id:e.task_id}}),n=t.loading,r=t.error,i=t.data;return n?Object(a.jsx)(de.a,{}):r?(console.error(r),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsx)("div",{style:{overflow:"auto",width:"100%"},children:i.response.map((function(e){return Object(a.jsx)("pre",{children:Ga(e.response.substring(2))},"resp"+e.id)}))})}var Ka=n(332),Za=n.n(Ka);function Xa(){var e=Object(P.a)(["\nquery getCommentQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"]);return Xa=function(){return e},e}function er(){var e=Object(P.a)(["\nmutation updateComment ($task_id: Int!, $comment: String, $commentOperator_id: Int) {\n  update_task_by_pk(pk_columns: {id: $task_id}, _set: {comment: $comment, comment_operator_id: $commentOperator_id}) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"]);return er=function(){return e},e}var tr=Object(w.gql)(er()),nr=Object(w.gql)(Xa());function ar(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],i=n[1],l=Object(w.useReactiveVar)(C),s=Object(w.useQuery)(nr,{variables:{task_id:e.task_id},onCompleted:function(e){i(e.task_by_pk.comment)},fetchPolicy:"network-only"}),d=s.loading,j=s.error,b=Object(w.useMutation)(tr,{update:function(e,t){t.data}}),m=Object(u.a)(b,1)[0];if(d)return Object(a.jsx)(de.a,{});if(j)return console.error(j),Object(a.jsx)("div",{children:"Error!"});return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(ne.a,{id:"form-dialog-title",children:"Edit Task Comment"}),Object(a.jsx)(ee.a,{dividers:!0,children:Object(a.jsx)(y,{multiline:!0,onChange:function(e,t,n){i(t)},value:r})}),Object(a.jsxs)(X.a,{children:[Object(a.jsx)(p.a,{onClick:e.onClose,color:"primary",children:"Close"}),Object(a.jsx)(p.a,{onClick:function(){m({variables:{task_id:e.task_id,comment:r,commentOperator_id:l.user.id}}),e.onClose()},color:"secondary",children:"Submit"})]})]})}var rr=Object(b.a)((function(e){return{root:{width:"99%",marginTop:"3px",marginBottom:"2px",marginLeft:"3px",marginRight:"0px"},heading:{fontSize:e.typography.pxToRem(15)},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},icon:{verticalAlign:"bottom",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block"},helper:{borderLeft:"2px solid ".concat(e.palette.divider),padding:e.spacing(1,2)},link:{color:e.palette.primary.main,textDecoration:"none","&:hover":{textDecoration:"underline"}}}}));function ir(e){var t=Object(w.useReactiveVar)(C),n=Object(I.c)().enqueueSnackbar,r=(o.a.useRef(null),o.a.useState("")),i=Object(u.a)(r,2),l=(i[0],i[1],o.a.useState(!1)),s=Object(u.a)(l,2),d=s[0],j=s[1],b=o.a.useState(!1),m=Object(u.a)(b,2),h=m[0],O=(m[1],o.a.useState(0)),f=Object(u.a)(O,2),x=f[0],g=f[1],v=o.a.useState(!1),y=Object(u.a)(v,2),k=y[0],_=y[1],S=rr(),q=Object(c.useRef)(e.task.responses);Object(c.useEffect)((function(){h?g(0):e.task.responses.length>q.current.length&&g(e.task.responses.length-q.current.length)}),[e.task.responses,h]);return Object(a.jsx)(A.a,{className:S.root,elevation:5,children:Object(a.jsxs)(Ea.a,{TransitionProps:{unmountOnExit:!0},onChange:function(e,t){t&&g(0)},children:[Object(a.jsx)(Na.a,{expandIcon:Object(a.jsx)(jt.a,{}),"aria-controls":"panel1c-content",id:"panel1c-header",children:Object(a.jsxs)("div",{style:{display:"block"},children:[d?Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(H.a,{className:S.secondaryHeading,children:e.task.commentOperator.username}),Object(a.jsx)(H.a,{className:S.heading,children:e.task.comment})]}):null,Object(a.jsx)("div",{className:S.column,children:Object(a.jsx)(qe.a,{badgeContent:x,color:"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:"error"===e.task.status?Object(a.jsx)(p.a,{size:"small",color:"secondary",style:{padding:"0"},children:"Error"}):e.task.completed?Object(a.jsx)(p.a,{size:"small",color:"primary",style:{padding:"0"},children:"Completed"}):Object(a.jsx)(p.a,{size:"small",color:"primary",style:{padding:"0"},children:e.task.status})})}),""!=e.task.comment?Object(a.jsx)("div",{className:S.column,children:Object(a.jsx)(R.a,{size:"small",color:"primary",style:{padding:"0"},onClick:function(e){e.stopPropagation(),j(!d)},children:Object(a.jsx)(Va.a,{})})}):null,Object(a.jsx)("div",{className:S.column,children:Object(a.jsx)(H.a,{className:S.heading,children:e.task.command.cmd})}),Object(a.jsx)("div",{className:S.column,children:Object(a.jsx)(H.a,{className:S.secondaryHeading,children:e.task.original_params})})]})}),Object(a.jsx)($a.a,{className:S.details,children:Object(a.jsx)(Ya,{task_id:e.task.id})}),Object(a.jsx)(Aa.a,{}),Object(a.jsxs)(Ba.a,{style:{padding:"0px",width:"100%"},children:[Object(a.jsx)("div",{className:S.column,children:Object(a.jsxs)(H.a,{className:S.secondaryHeading,children:["Task: ",e.task.id,", ",e.task.operator.username,", ",oe(e.task.timestamp,t.user.view_utc_time)]})}),Object(a.jsxs)("div",{className:S.column,children:[Object(a.jsx)(R.a,{size:"small",color:"primary",children:Object(a.jsx)(an.a,{})}),Object(a.jsx)(R.a,{size:"small",color:"primary",href:"/task/"+e.task.id,target:"_blank",children:Object(a.jsx)(za.a,{})}),Object(a.jsx)(R.a,{size:"small",color:"primary",children:Object(a.jsx)(Ra.a,{})}),Object(a.jsx)(R.a,{size:"small",color:"primary",onClick:function(){(function(e){try{var t=document.createElement("textarea");return t.value=e,t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(n){return console.log("warning","Failed to copy to clipboard: "+n.toString()),!1}})(e.task.original_params)?n("Copied text!",{variant:"success"}):n("Failed to copy text",{variant:"error"})},children:Object(a.jsx)(Wa.a,{})}),Object(a.jsx)(R.a,{size:"small",color:"primary",onClick:function(){_(!0)},children:Object(a.jsx)(Za.a,{})}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"md",open:k,onClose:function(){_(!1)},innerDialog:Object(a.jsx)(ar,{task_id:e.task.id,onClose:function(){_(!1)}})})]})]})]})})}function cr(e){var t=o.a.useState(""),n=Object(u.a)(t,2),r=n[0],i=n[1],c=o.a.useState({name:""}),l=Object(u.a)(c,2),s=l[0],d=l[1],j=function(){if(e.default_value){var t=e.default_value.split("\n");return null===r&&i(t[0]),t}var n=e.parameter.split("\n");return null===r&&i(n[0]),n},b=function(t){i(t.target.value),e.onChange(e.name,t.target.value,!1)},m=function(t,n,a){i(n),e.onChange(e.name,n,a)},h=function(t,n){i(n),e.onChange(t,n)},O=function(t){d({name:t.target.files[0].name,file:t.target.files[0]}),e.onChange(e.name,t.target.files[0])},f=function(t){return(e.required&&""!==e.verifier_regex||""!==e.verifier_regex&&""!==t)&&!RegExp(e.verifier_regex).test(t)};return Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:e.description}),Object(a.jsx)(E.a,{children:function(){switch(e.type){case"ChooseOne":return Object(a.jsx)(He.a,{children:Object(a.jsx)(Ue.a,{native:!0,value:r,onChange:b,children:j().map((function(e,t){return Object(a.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"String":return Object(a.jsx)(y,{required:e.required,placeholder:e.default_value,value:r,multiline:!0,onChange:m,display:"inline-block",validate:f,errorText:"Must match: "+e.verifier_regex});case"Boolean":return Object(a.jsx)(F.a,{checked:r,onChange:h});case"File":return Object(a.jsxs)(p.a,{variant:"contained",component:"label",children:[""===s.name?"Select File":s.name,Object(a.jsx)("input",{onChange:O,type:"file",hidden:!0})," "]});default:return null}}()})]},"buildparam"+e.id)}function or(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],l=n[1];Object(c.useEffect)((function(){var t=e.command.commandparameters.map((function(e){switch(e.type){case"String":case"Boolean":case"Number":return Object(i.a)(Object(i.a)({},e),{},{value:e.default_value});case"Array":return e.default_value.length>0?Object(i.a)(Object(i.a)({},e),{},{value:JSON.parse(e.default_value)}):Object(i.a)(Object(i.a)({},e),{},{value:[]});case"Choice":return Object(i.a)(Object(i.a)({},e),{},{choices:e.choices.split("\n"),value:e.default_value});case"ChoiceMultiple":return e.devault_value.length>0?Object(i.a)(Object(i.a)({},e),{},{choices:e.choices.split("\n"),value:JSON.parse(e.default_value)}):Object(i.a)(Object(i.a)({},e),{},{choices:e.choices.split("\n"),value:[]});case"File":return Object(i.a)(Object(i.a)({},e),{},{value:{}});default:return Object(i.a)({},e)}}));l(t)}),[]);var s=function(e,t,n){var a=r.map((function(n){return n.name==e?Object(i.a)(Object(i.a)({},n),{},{value:t}):Object(i.a)({},n)}));l(a)};return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsxs)(ne.a,{id:"form-dialog-title",children:[e.command.cmd,"'s Parameters"]}),Object(a.jsxs)(ee.a,{dividers:!0,children:[Object(a.jsxs)(H.a,{component:"div",children:[Object(a.jsx)("b",{children:"Help"})," ",Object(a.jsx)("pre",{style:{margin:0},children:e.command.help_cmd}),Object(a.jsx)("b",{children:"Description"})," ",Object(a.jsx)("pre",{style:{margin:0},children:e.command.description}),Object(a.jsx)("b",{children:"Requires Admin?"})," ",e.command.needs_admin?"True":"False"]}),Object(a.jsx)($.a,{component:A.a,className:"mythicElement",children:Object(a.jsxs)(D.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(a.jsx)(N.a,{children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(E.a,{children:"Parameter"}),Object(a.jsx)(E.a,{children:"Value"})]})}),Object(a.jsx)(M.a,{children:r.map((function(e){return Object(a.jsx)(cr,Object(i.a)({onChange:s},e),"taskparameterrow"+e.id)}))})]})})]}),Object(a.jsxs)(X.a,{children:[Object(a.jsx)(p.a,{onClick:e.onClose,color:"primary",children:"Close"}),Object(a.jsx)(p.a,{onClick:function(){e.onSubmit(e.command.cmd,r)},color:"secondary",children:"Submit"})]})]})}function lr(){var e=Object(P.a)(["\nsubscription getNewUpdatedTaskingSubscription($callback_id: Int!) {\n  task(where: {callback_id: {_eq: $callback_id}}, limit: 1, order_by: {timestamp: desc}) {\n        comment\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        status\n        timestamp\n        command {\n          cmd\n        }\n        responses {\n          id\n        }\n  }\n}\n "]);return lr=function(){return e},e}function sr(){var e=Object(P.a)(["\nquery getTasking($callback_id: Int!){\n    task(where: {callback_id: {_eq: $callback_id}}, order_by: {id: asc}) {\n        comment\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        status\n        timestamp\n        command {\n          cmd\n        }\n        responses {\n          id\n        }\n  }\n}\n "]);return sr=function(){return e},e}function dr(){var e=Object(P.a)(["\nmutation createTasking($callback_id: Int!, $command: String!, $params: String!) {\n  createTask(callback_id: $callback_id, command: $command, params: $params) {\n    status\n    id\n    error\n  }\n}\n"]);return dr=function(){return e},e}function ur(){var e=Object(P.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}}) {\n    id\n    command {\n      cmd\n      help_cmd\n      description\n      id\n      needs_admin\n      commandparameters {\n        choices\n        default_value\n        description\n        id\n        name\n        required\n        type\n      }\n    }\n  }\n}\n"]);return ur=function(){return e},e}function jr(e){return Object(a.jsx)(Da,Object(i.a)({label:"Callback: "+e.tabInfo.callbackID},e))}var br=Object(w.gql)(ur()),pr=Object(w.gql)(dr()),mr=Object(w.gql)(sr()),hr=Object(w.gql)(lr());function Or(e){var t=Object(I.c)().enqueueSnackbar,n=o.a.useState(""),r=Object(u.a)(n,2),l=r[0],s=r[1],d=o.a.useState(""),j=Object(u.a)(d,2),b=j[0],p=j[1],m=o.a.useState([]),h=Object(u.a)(m,2),O=h[0],f=h[1],g=o.a.useState([]),v=Object(u.a)(g,2),y=v[0],k=v[1],_=o.a.useState(!1),C=Object(u.a)(_,2),S=C[0],q=C[1],P=o.a.useState({}),D=Object(u.a)(P,2),M=D[0],E=D[1],$=Object(w.useMutation)(pr,{update:function(e,n){var a=n.data;console.log(a),"error"===a.createTask.status?t(a.createTask.error,{variant:"error"}):t("task created",{variant:"success"})}}),N=Object(u.a)($,1)[0],B=Object(w.useQuery)(br,{variables:{callback_id:e.tabInfo.callbackID},onCompleted:function(e){var t=e.loadedcommands.map((function(e){return e.command}));t.sort((function(e,t){return-t.cmd.localeCompare(e.cmd)})),f(t)}}),A=B.loading,F=B.error,z=Object(w.useLazyQuery)(mr,{onCompleted:function(n){Q({document:hr,variables:{callback_id:e.tabInfo.callbackID},updateQuery:function(e,t){var n=t.subscriptionData;return console.log("got subscription data",n),n.data?0===n.data.task.length||e.task.find((function(e){return e.id===n.data.task[0].id}))?e:Object.assign({},e,{task:[].concat(Object(T.a)(e.task),[n.data.task[0]])}):e},onError:function(e){console.log(e),t("Task Subscription errored",{variant:"error"})}})}}),L=Object(u.a)(z,2),H=L[0],W=L[1],U=W.loading,V=W.data,Q=W.subscribeToMore,G=Object(c.useRef)(null);if(Object(c.useEffect)((function(){H({variables:{callback_id:e.tabInfo.callbackID}})}),[]),Object(c.useEffect)((function(){V&&G.current&&G.current.scrollIntoView({behavior:"smooth"})}),[V]),A)return Object(a.jsx)(de.a,{});if(F)return console.error(F),Object(a.jsx)("div",{children:"Error!"});var J=function(n){n.preventDefault(),n.stopPropagation();var a=l.split(" ")[0],r=O.find((function(e){return e.cmd===a}));console.log(r);var c=l.substring(a.length).trim();if(void 0!==r){if(0===r.commandparameters.length)Y({callback_id:e.tabInfo.callbackID,command:a,params:c});else{if(r.commandparameters.find((function(e){return"File"===e.parameter_type}))||0===c.length)return E(Object(i.a)(Object(i.a)({},r),{},{typedParameters:l})),void q(!0);Y({callback_id:e.tabInfo.callbackID,command:a,params:c})}s("")}else t("Unknown command",{variant:"warning"})},Y=function(e){var t=e.callback_id,n=e.command,a=e.params;N({variables:{callback_id:t,command:n,params:a}})},K=function(e,t){if(void 0===t){if("change"===e.type)s(e.target.value);else{if("click"!==e.type)return;s(e.target.innerText)}0===e.target.value.length?k([]):0===y.length&&k(O.map((function(e){return e.cmd})))}else s(t)},Z=function(e){if("ArrowUp"===e.code||"ArrowDown"===e.code){if(0===y.length&&V){var t=V.task.map((function(e){return e.command?e.command.cmd+" "+e.original_params:e.original_params})).reduce((function(e,t){return e.includes(t)?e:[].concat(Object(T.a)(e),[t])}),[]);k(t)}}else if("Tab"===e.key){if(""!==b)s(b+" "),p(""),e.preventDefault(),e.stopPropagation()}};return Object(a.jsxs)(Pa,Object(i.a)(Object(i.a)({},e),{},{children:[Object(a.jsxs)("div",{style:{maxHeight:"calc(".concat(e.maxHeight-6,"vh)"),overflow:"auto",height:"calc(".concat(e.maxHeight-6,"vh)")},children:[U?Object(a.jsx)(de.a,{}):V&&V.task.map((function(e){return Object(a.jsx)(ir,{task:e},"taskinteractdisplay"+e.id)})),Object(a.jsx)("div",{ref:G})]}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"md",open:S,onClose:function(){q(!1)},innerDialog:Object(a.jsx)(or,{command:M,onSubmit:function(t,n){console.log(n),q(!1),Y({callback_id:e.tabInfo.callbackID,command:t,params:n})},onClose:function(){q(!1)}})}),Object(a.jsx)("div",{style:{position:"absolute",width:"100%"},children:Object(a.jsx)("form",{onSubmit:J,children:Object(a.jsx)(Ma.a,{freeSolo:!0,autoComplete:!0,autoHighlight:!0,id:"free-solo-2-demo",disableClearable:!0,disableListWrap:!0,inputValue:l,size:"small",onHighlightChange:function(e,t,n){null!==t&&p(t)},onChange:K,options:y,renderInput:function(e){return e.InputProps.onKeyDown=Z,Object(a.jsx)(x.a,Object(i.a)(Object(i.a)({},e),{},{onChange:K,onKeyDown:Z,size:"small",variant:"outlined",InputProps:Object(i.a)(Object(i.a)({},e.InputProps),{},{type:"search",endAdornment:Object(a.jsx)(o.a.Fragment,{children:Object(a.jsx)(R.a,{color:"primary",variant:"contained",onClick:J,children:Object(a.jsx)(Bt.a,{})})})})}))}})})})]}))}var fr=Object(b.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function xr(e){var t=fr(),n=o.a.useState(0),r=Object(u.a)(n,2),i=r[0],c=r[1],l=o.a.useState([]),s=Object(u.a)(l,2);s[0],s[1];return Object(a.jsxs)("div",{className:t.root,style:{maxHeight:e.maxHeight,height:e.maxHeight,background:"transparent"},children:[Object(a.jsx)(Ia.a,{position:"static",color:"default",children:Object(a.jsx)(qa.a,{value:i,onChange:function(e,t){c(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:e.openTabs.map((function(t,n){return Object(a.jsx)(jr,{onCloseTab:e.onCloseTab,tabInfo:t,index:n},"tablabel"+t.tabID+t.tabType)}))})}),e.openTabs.map((function(t,n){return Object(a.jsx)(Or,{maxHeight:e.tabHeight,style:{height:"calc(".concat(e.tabHeight,"vh)"),maxHeight:"calc(".concat(e.tabHeight,"vh)"),position:"relative",overflow:"auto"},tabInfo:t,value:i,index:n},"tabpanel"+t.tabID+t.tabType)}))]})}var gr=n(707),vr=n(708),yr=n(696),kr=n(335),_r=n.n(kr),wr=n(333),Cr=n.n(wr),Sr=n(334),Ir=n.n(Sr);function qr(e){var t=o.a.useState({}),n=Object(u.a)(t,2),r=n[0],l=n[1];Object(c.useEffect)((function(){l(e.heights)}),[]);var s=function(e,t,n){var a=Object(i.a)({},r);a[e]=parseInt(t),l(a)};return Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(ne.a,{id:"form-dialog-title",children:"Adjust sizes of Top/Bottom sections"}),Object(a.jsx)(ee.a,{dividers:!0,children:Object(a.jsxs)(o.a.Fragment,{children:[Object(a.jsx)(y,{value:r.top,onChange:s,name:"top",type:"number"}),Object(a.jsx)(y,{value:r.bottom,onChange:s,name:"bottom",type:"number"})]})}),Object(a.jsxs)(X.a,{children:[Object(a.jsx)(p.a,{onClick:e.onClose,children:"Close"}),Object(a.jsx)(p.a,{onClick:function(){e.onSubmit(r),e.onClose()},color:"primary",children:"Submit"})]})]})}function Tr(){var e=Object(P.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    last_checkin\n    locked\n    sleep_info\n    port\n    pid\n    os\n    user\n    agent_callback_id\n    payload {\n      payloadtype {\n        ptype\n      }\n    }\n    callbackgraphedges {\n      direction\n      end_timestamp\n      id\n      metadata\n      c2profile {\n        id\n        name\n        is_p2p\n      }\n      destination {\n        active\n        id\n      }\n      source {\n        active\n        id\n      }\n    }\n  }\n}\n "]);return Tr=function(){return e},e}var Pr=Object(w.gql)(Tr()),Dr=Object(b.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{bottom:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{top:e.spacing(2),right:e.spacing(2)}}}}));function Mr(e){var t=Object(w.useReactiveVar)(C),n=Dr(),r=o.a.useState(!1),i=Object(u.a)(r,2),c=i[0],l=i[1],s=o.a.useState([]),d=Object(u.a)(s,2),j=d[0],b=d[1],p=o.a.useState({top:30,bottom:60}),m=Object(u.a)(p,2),h=m[0],O=m[1],f=o.a.useState(!1),x=Object(u.a)(f,2),g=x[0],v=x[1],y=Object(w.useSubscription)(Pr,{variables:{operation_id:t.user.current_operation_id}}),k=y.loading,_=y.error,S=y.data;if(k)return Object(a.jsx)(de.a,{style:{marginTop:"20px"}});if(_)return console.error(_),Object(a.jsx)("div",{children:"Error!"});var I=[{icon:Object(a.jsx)(Cr.a,{}),name:"Table layout"},{icon:Object(a.jsx)(Ir.a,{}),name:"Graph layout"},{icon:Object(a.jsx)(_r.a,{}),name:"Adjust Top/Bottom Size",onClick:function(){v(!0),l(!1)}}];return Object(a.jsxs)("div",{style:{maxWidth:"100%",height:"calc(95vh)"},children:[Object(a.jsx)(Sa,{maxHeight:"calc(".concat(h.top,"vh)"),topHeight:h.top,onOpenTab:function(e){var t=e.tabID,n=e.tabType,a=e.callbackID,r=!1;if(j.forEach((function(e){e.tabID===t&&(r=!0)})),!r){var i=[].concat(Object(T.a)(j),[{tabID:t,tabType:n,callbackID:a}]);b(i)}},callbacks:S.callback},"callbackstable"),Object(a.jsx)(xr,{onCloseTab:function(e){var t=e.tabID,n=j.filter((function(e){return e.tabID!==t}));b(n)},tabHeight:h.bottom,maxHeight:"calc(".concat(h.bottom,"vh)"),openTabs:j,callbacks:S.callback},"callbackstabs"),Object(a.jsx)(gr.a,{ariaLabel:"SpeedDial example",className:n.speedDial,icon:Object(a.jsx)(vr.a,{}),onClose:function(){l(!1)},onOpen:function(){l(!0)},FabProps:{color:"secondary"},open:c,direction:"down",children:I.map((function(e){return Object(a.jsx)(yr.a,{icon:e.icon,tooltipTitle:e.name,onClick:e.onClick},e.name)}))}),Object(a.jsx)(ce,{fullWidth:!0,maxWidth:"sm",open:g,onClose:function(){v(!1),l(!1)},innerDialog:Object(a.jsx)(qr,{onClose:function(){v(!1),l(!1)},heights:h,onSubmit:function(e){O(e),console.log(e),l(!1)}})})]})}var Er=n(33),$r=n(337),Nr=n.n($r),Br=n(338),Ar=n.n(Br),Fr=n(40),zr=n(697),Lr=n(339),Rr=n.n(Lr),Hr=n(340),Wr=n.n(Hr),Ur=n(698),Vr=n(112),Qr=n.n(Vr),Gr=n(336),Jr=n.n(Gr);function Yr(){var e=Object(P.a)(['\nsubscription MySubscription {\n  operationeventlog_aggregate(where: {deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}}) {\n    aggregate{\n        count\n    }\n  }\n}\n ']);return Yr=function(){return e},e}var Kr=Object(w.gql)(Yr());function Zr(e){var t=Object(I.c)().enqueueSnackbar,n=Object(w.useSubscription)(Kr,{onError:function(e){t("Mythic encountered an error getting event log messages: "+e.toString(),{variant:"error"}),console.log(e)}}),r=n.loading,i=n.error,c=n.data;return Object(a.jsx)(R.a,{color:"inherit",component:Fr.b,to:"/new/EventFeed",children:r?Object(a.jsx)(qe.a,{color:"secondary",badgeContent:0,children:Object(a.jsx)(Re.a,{size:20,thickness:4})}):i?Object(a.jsx)(qe.a,{color:"secondary",badgeContent:0,children:Object(a.jsx)(cn.a,{})}):Object(a.jsx)(qe.a,{color:"secondary",badgeContent:c.operationeventlog_aggregate.aggregate.count,children:Object(a.jsx)(Jr.a,{})})})}function Xr(){var e=Object(P.a)(["\nsubscription EventFeedNotificationSubscription($fromNow: timestamp!) {\n  operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}}, order_by: {timestamp: desc}) {\n    operator {\n        username\n    }\n    message\n    level\n    resolved\n  }\n}\n "]);return Xr=function(){return e},e}var ei=Object(w.gql)(Xr());function ti(e){var t=Object(I.c)().enqueueSnackbar,n=o.a.useState(null),a=Object(u.a)(n,2),r=a[0],i=a[1],l=Object(w.useReactiveVar)(C),s=Object(w.useSubscription)(ei,{variables:{fromNow:r}}),d=s.loading,j=s.error,b=s.data;return Object(c.useEffect)((function(){i((new Date).toISOString())}),[]),Object(c.useEffect)((function(){if(console.log(b,d,j),!d&&!j&&b&&b.operationeventlog.length>0)if(b.operationeventlog[0].operator&&l.user.username!==b.operationeventlog[0].operator.username){var e=b.operationeventlog[0].operator.username+":"+b.operationaleventlog[0].message;t(e,{variant:b.operationeventlog[0].level,autoHideDuration:5e3})}else b.operationeventlog[0].operator||t(b.operationeventlog[0].message,{variant:b.operationeventlog[0].level,autoHideDuration:5e3});else j&&(console.log(j),t("Mythic encountered an error getting operational event stream",{variant:"error"}))}),[d,b,t,j]),null}var ni=240,ai=Object(b.a)((function(e){return{root:{width:"100%",position:"sticky",top:"0"},title:{flexGrow:1},hide:{display:"none"},drawer:{width:ni,flexShrink:0},drawerPaper:{width:ni},drawerHeader:Object(i.a)(Object(i.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{maxWidth:"calc(100% - ".concat(ni,"px)"),marginLeft:ni,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},mythicElement:{}}}));function ri(e){var t=ai(),n=Object(Er.a)(),r=o.a.useRef(null),i=o.a.useState(!1),c=Object(u.a)(i,2),l=c[0],s=c[1],b=Object(w.useReactiveVar)(C),p=Object(w.useReactiveVar)(S),m=function(e){s(!1)};return Object(a.jsxs)("div",{className:t.root,children:[Object(a.jsx)(Ia.a,{position:"sticky",className:Object(j.a)(t.appBar,Object(d.a)({},t.appBarShift,p)),children:b.loggedIn?Object(a.jsxs)(ga.a,{variant:"dense",position:"sticky static",children:[Object(a.jsx)(R.a,{edge:"start",className:Object(j.a)(t.menuButton,p&&t.hide),color:"inherit","aria-label":"menu",onClick:function(){S(!0)},children:Object(a.jsx)(Nr.a,{})}),Object(a.jsxs)("div",{children:[b.user?b.user.username:Object(a.jsx)(_.a,{to:"/new/logout"}),Object(a.jsx)(Zr,{}),Object(a.jsx)(ti,{}),Object(a.jsx)(R.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){s(!0)},ref:r,color:"inherit",children:Object(a.jsx)(Ar.a,{})}),Object(a.jsxs)(It.a,{id:"menu-appbar",nodeRef:r,anchorEl:function(){return r.current},anchorOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:m,children:[Object(a.jsx)(St.a,{component:Fr.b,to:"/new/logout",onClick:m,children:"Logout"}),Object(a.jsx)(St.a,{component:Fr.b,to:"/new/settings",onClick:m,name:"settings",children:"My account"})]})]})]}):null}),Object(a.jsxs)(zr.a,{className:t.drawer,variant:"persistent",anchor:"left",open:p,classes:{paper:t.drawerPaper},children:[Object(a.jsx)("div",{className:t.drawerHeader,children:Object(a.jsx)(R.a,{onClick:function(){S(!1)},children:"ltr"===n.direction?Object(a.jsx)(Rr.a,{className:"mythicElement"}):Object(a.jsx)(Wr.a,{className:"mythicElement"})})}),Object(a.jsx)(Aa.a,{}),Object(a.jsx)(At.a,{children:Object(a.jsxs)(qt.a,{button:!0,component:Fr.b,to:"/new",children:[Object(a.jsx)(Ur.a,{children:Object(a.jsx)(Qr.a,{className:"mythicElement"})}),Object(a.jsx)(Tt.a,{primary:"Home"})]},"home")}),Object(a.jsx)(Aa.a,{}),Object(a.jsxs)(At.a,{children:[Object(a.jsxs)(qt.a,{button:!0,component:Fr.b,to:"/new/payloadtypes",children:[Object(a.jsx)(Ur.a,{children:Object(a.jsx)(Qr.a,{className:"mythicElement"})}),Object(a.jsx)(Tt.a,{primary:"Payload Types"})]},"payloadtypes"),Object(a.jsxs)(qt.a,{button:!0,component:Fr.b,to:"/new/c2profiles",children:[Object(a.jsx)(Ur.a,{children:Object(a.jsx)(Qr.a,{className:"mythicElement"})}),Object(a.jsx)(Tt.a,{primary:"C2 Profiles"})]},"c2profiles"),Object(a.jsxs)(qt.a,{button:!0,component:Fr.b,to:"/new/createpayload",children:[Object(a.jsx)(Ur.a,{children:Object(a.jsx)(Qr.a,{className:"mythicElement"})}),Object(a.jsx)(Tt.a,{primary:"Create Payload"})]},"createpayload")]}),Object(a.jsx)(Aa.a,{}),Object(a.jsxs)(At.a,{children:[Object(a.jsxs)(qt.a,{button:!0,component:Fr.b,to:"/new/payloads",children:[Object(a.jsx)(Ur.a,{children:Object(a.jsx)(Qr.a,{className:"mythicElement"})}),Object(a.jsx)(Tt.a,{primary:"View Payloads"})]},"payloads"),Object(a.jsxs)(qt.a,{button:!0,component:Fr.b,to:"/new/callbacks",children:[Object(a.jsx)(Ur.a,{children:Object(a.jsx)(Qr.a,{className:"mythicElement"})}),Object(a.jsx)(Tt.a,{primary:"Active Callbacks"})]},"callbacks")]}),Object(a.jsxs)(qt.a,{children:[Object(a.jsx)(F.a,{checked:"dark"===e.theme,onChange:e.toggleTheme,color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"darkMode"}),Object(a.jsx)("div",{style:{display:"inline-block"},children:" Enable Dark Mode "})]})]})]})}function ii(){var e=Object(P.a)(["\nbody {\n    background: ",";\n    color: ",";\n    font-family: Tahoma, Helvetica, Arial, Roboto, sans-serif;\n}\ntable, td, .mythicElement, .MuiDrawer-paper, .MuiDialog-paper, .MuiDialogContentText-root, input, .MuiList-root, .MuiFormHelperText-root {\n    background: ",";\n    color: "," !important;\n}\n.MuiTypography-colorTextPrimary{\n     color: "," !important;\n}\n.MuiTypography-colorTextSecondary{\n    color: "," !important;\n}\n.MuiStepper-root, .MuiStepLabel-label{\n    background: ",";\n    color: "," !important;\n}\n.MuiList-root{\n    background: ",";\n    color: "," !important;\n}\n.MuiInputBase-root{\n    background: ",";\n    color: "," !important;\n}\n.MuiDialogContent-dividers{\n    border-top: 1px solid ",";\n    border-bottom: 1px solid ",";\n}\n.MuiAccordionSummary-root{\n    background: ",";\n    color: "," !important;\n}\n.MuiAccordionDetails-root{\n    background: ",";\n    color: "," !important;\n    padding-bottom: 0;\n    padding-top: 0;\n}\n.MuiAccordionActions-root{\n    background: ",";\n    color: ",' !important;\n}\n.MuiAccordionSummary-content.Mui-expanded{\n    margin: 0px 0px 0px 0px !important;\n    min-height: unset;\n}\n.MuiAccordionSummary-root.Mui-expanded{\n    min-height: unset;\n}\n[class*="makeStyles-secondaryHeading-"]{\n    color: '," !important;\n}\n.MuiTabs-root{\n    background: ",";\n    color: "," !important;\n}\n// placeholder/helper text for input boxes\n.MuiFormLabel-root {\n    background: transparent;\n    color: "," !important;\n}\n.MuiFormControl-root{\n    border-color: 'white';\n}\n.MuiTableCell-head {\n    background-color: ",";\n    color: "," !important;\n    font-weight: bold;\n}\n.MuiSelect-select.MuiSelect-select{\n    padding-left: 10px\n}\n.MuiToolbar-root {\n    background-color: ",";\n}\n.MuiSelect-select:not([multiple]) option, .MuiSelect-select:not([multiple]) optgroup {\n    background-color: ",";\n}\n.MuiCard-root {\n    background-color: ",";\n    color: "," !important;\n}\n.MuiButton-textPrimary, .MuiSwitch-colorPrimary.Mui-checked{\n    color: "," !important;\n}\n.MuiButton-containedPrimary{\n    background-color: "," !important;\n}\n.MuiButton-textSecondary, .MuiSwitch-colorSecondary.Mui-checked{\n    color: "," !important;\n}\n.MuiButton-containedSecondary{\n    background-color: "," !important;\n}\n.MuiMenuItem-root, .MuiMenu-list, .MuiList-root{\n    background: ",";\n    color: "," !important;\n}\n.MuiAutocomplete-paper{\n    background-color: ",";\n    color: "," !important;\n}\n"]);return ii=function(){return e},e}var ci=Object(mt.c)(ii(),(function(e){return e.theme.body}),(function(e){return e.theme.text}),(function(e){return e.theme.body}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.textDarker}),(function(e){return e.theme.body}),(function(e){return e.theme.text}),(function(e){return e.theme.listItemBackground}),(function(e){return e.theme.text}),(function(e){return e.theme.tableHeader}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.taskAccordian}),(function(e){return e.theme.text}),(function(e){return e.theme.taskAccordianResponse}),(function(e){return e.theme.text}),(function(e){return e.theme.taskAccordianBottom}),(function(e){return e.theme.text}),(function(e){return e.theme.secondaryTextColor}),(function(e){return e.theme.tabHeaderBackground}),(function(e){return e.theme.tabHeaderText}),(function(e){return e.theme.text}),(function(e){return e.theme.tableHeader}),(function(e){return e.theme.text}),(function(e){return e.theme.topAppBar}),(function(e){return e.theme.body}),(function(e){return e.theme.tableHeader}),(function(e){return e.theme.text}),(function(e){return e.theme.primaryButtonTextOnly}),(function(e){return e.theme.primaryButtonTextOnly}),(function(e){return e.theme.secondaryButtonTextOnly}),(function(e){return e.theme.secondaryButtonTextOnly}),(function(e){return e.theme.menuItemBackground}),(function(e){return e.theme.text}),(function(e){return e.theme.menuItemBackground}),(function(e){return e.theme.text})),oi={body:"#FFF",text:"#363537",textLighter:"#B8B8B8",textDarker:"#B8B8B8",toggleBorder:"#FFF",background:"#363537",tableHeader:"#F5F5F5",listItemBackground:"#F5F5F5",errorColor:"#ea7575",successColor:"#37a340",menuItemBackground:"#FBFBFB",topAppBar:"",taskAccordian:"",taskAccordianResponse:"#FAFAFA",taskAccordianBottom:"#F5F5F5",secondaryTextColor:"",tabHeaderBackground:"",tabHeaderText:""},li={body:"#363537",text:"white",textLighter:"#989898",textDarker:"#989898",toggleBorder:"#6B8096",background:"#999",tableHeader:"#484848",listItemBackground:"#484848",primaryButtonTextOnly:"#7e75ea",secondaryButtonTextOnly:"#ea7575",errorColor:"#B71C1C",successColor:"#37a340",menuItemBackground:"#4B515D",topAppBar:"",taskAccordian:"#424242",taskAccordianResponse:"#616161",taskAccordianBottom:"#424242",secondaryTextColor:"#E0E0E0",tabHeaderBackground:"#363537",tabHeaderText:"white"};function si(){var e=Object(P.a)(["\nquery getTaskQuery($task_id: Int!) {\n  task(where: {id: {_eq: $task_id}}) {\n        comment\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        status\n        timestamp\n        command {\n          cmd\n        }\n        responses{\n            id\n        }\n    }\n}"]);return si=function(){return e},e}var di=Object(w.gql)(si());function ui(e){var t=Object(_.g)().taskId,n=Object(w.useQuery)(di,{variables:{task_id:parseInt(t)},onCompleted:function(e){console.log(e)}}),r=n.loading,i=n.error,c=n.data;return r?Object(a.jsx)(de.a,{}):i?(console.error(i),Object(a.jsx)("div",{children:"Error!"})):Object(a.jsx)("div",{style:{marginTop:"10px"},children:Object(a.jsx)(ir,{task:c.task[0]})})}var ji=Object(b.a)((function(e){return{content:{maxWidth:"calc(98vw)",maxHeight:"calc(98vh)",overflow:"auto",padding:"0px 0 0px 16px"},contentShift:{maxWidth:"calc(97vw - ".concat(bi,"px)"),marginLeft:"".concat(bi,"px"),overflow:"auto",padding:"0 0 0 16px"}}})),bi=240;function pi(e){var t=ji(),n=function(){var e=Object(c.useState)("light"),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),i=Object(u.a)(r,2),o=i[0],l=i[1],s=function(e){window.localStorage.setItem("theme",e),a(e)};return Object(c.useEffect)((function(){var e=window.localStorage.getItem("theme");e?a(e):s("light"),l(!0)}),[]),[n,function(){s("light"===n?"dark":"light")},o]}(),r=Object(u.a)(n,2),i=r[0],o=r[1],l=Object(w.useReactiveVar)(S);return Object(a.jsxs)(mt.b,{theme:"dark"===i?li:oi,children:[Object(a.jsx)(ci,{}),Object(a.jsx)(I.b,{maxSnack:5,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(ri,{theme:i,toggleTheme:o}),Object(a.jsx)("div",{className:Object(j.a)(t.content,Object(d.a)({},t.contentShift,l)),children:Object(a.jsxs)(_.d,{children:[Object(a.jsx)(yn,{exact:!0,path:"/new",component:gn}),Object(a.jsx)(_.b,{exact:!0,path:"/new/login",component:q}),Object(a.jsx)(yn,{exact:!0,path:"/new/settings",component:ke}),Object(a.jsx)(yn,{exact:!0,path:"/new/payloadtypes",component:Ae}),Object(a.jsx)(yn,{exact:!0,path:"/new/eventfeed",component:Zt}),Object(a.jsx)(yn,{exact:!0,path:"/new/createpayload",component:_t}),Object(a.jsx)(yn,{exact:!0,path:"/new/payloads",component:mn}),Object(a.jsx)(yn,{exact:!0,path:"/new/c2profiles",component:Xn}),Object(a.jsx)(yn,{exact:!0,path:"/new/callbacks",component:Mr}),Object(a.jsx)(yn,{exact:!0,path:"/new/task/:taskId",component:ui}),Object(a.jsx)(_.b,{exact:!0,path:"/new/logout",component:_e})]})})]})})]})}var mi=n(341),hi=n(343),Oi=n(345);var fi=function(e,t){var n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("access_token")},body:JSON.stringify(t)};return fetch(e,n)},xi=n(6),gi=n(344),vi=new w.InMemoryCache({typePolicies:{Query:{fields:{"Subscription.operationeventlog":{merge:function(e,t){return t}}}}}});null!==localStorage.getItem("access_token")?C({loggedIn:!0,access_token:localStorage.getItem("access_token"),refresh_token:localStorage.getItem("refresh_token"),user:JSON.parse(localStorage.getItem("user"))}):C({loggedIn:!1});var yi=new Oi.a({delay:{initial:20,max:300,jitter:!0},attempts:{max:10,retryIf:function(e,t){return!!e}}}),ki=new w.HttpLink({uri:window.location.origin+"/graphql/",options:{reconnect:!0,connectionParams:{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),_i=Object(gi.a)((function(e,t){var n=t.headers,a=localStorage.getItem("access_token");return{headers:Object(i.a)(Object(i.a)({},n),{},{authorization:a?"Bearer ".concat(a):""})}})),wi=Object(hi.a)((function(e){var t=e.graphQLErrors,n=e.networkError,a=e.operation,c=e.forward;if(console.log("errors?"),t){console.log("[graphQLError]",t);var o,l=Object(r.a)(t);try{for(l.s();!(o=l.n()).done;){var s=o.value;switch(s.extensions.code){case"access-denied":case"start-failed":console.log("got start-failed error");var d=a.getContext().headers;if(Ci())return a.setContext({headers:Object(i.a)(Object(i.a)({},d),{},{authorization:localStorage.getItem("access_token")})}),c(a);window.location.reload();default:console.log(s)}}}catch(s){l.e(s)}finally{l.f()}}if(n)switch(console.log("[Network error]",n),n.extensions.code){case"access-denied":case"start-failed":console.log("got start-failed error");var u=a.getContext().headers;if(Ci())return a.setContext({headers:Object(i.a)(Object(i.a)({},u),{},{authorization:localStorage.getItem("access_token")})}),c(a);window.location.reload();default:console.log(n)}})),Ci=function(){fi("/refresh",{refresh_token:localStorage.getItem("refresh_token")}).then((function(e){e.json().then((function(e){return console.log(e),"access_token"in e?(function(e){localStorage.setItem("access_token",e.access_token)}(e),console.log("successfully got new access_token"),!0):(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),console.log("failed to get new access_token",e),!1)})).catch((function(e){return console.log("Error trying to get json response in GetNewToken",e.toString()),!1}))})).catch((function(e){return console.log("There was an error in GetNewToken!",e.toString()),!1}))},Si=new mi.a({uri:"https:"===window.location.protocol?"wss://"+window.location.host+"/graphql/":"ws://"+window.location.host+"/graphql/",options:{reconnect:!0,connectionParams:{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),Ii=Object(w.split)((function(e){var t=e.query,n=Object(xi.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Si,_i.concat(ki)),qi=new w.ApolloClient({link:Object(w.from)([wi,yi,Ii]),cache:vi});s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(w.ApolloProvider,{client:qi,children:Object(a.jsx)(Fr.a,{children:Object(a.jsx)(pi,{},"App")})})}),document.getElementById("root"))}},[[596,1,2]]]);
//# sourceMappingURL=main.c1d2570a.chunk.js.map