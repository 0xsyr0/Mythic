(this.webpackJsonpmythic=this.webpackJsonpmythic||[]).push([[0],{769:function(e,t,a){"use strict";a.r(t),a.d(t,"apolloClient",(function(){return bx})),a.d(t,"restartWebsockets",(function(){return jx}));var n=a(130),i=a.n(n),c=a(429),r=a(430),o=a(3),s=a(1),l=a.n(s),d=a(37),u=a.n(d),b=a(20),j=a(2),p=a(7),h=a(782),m=a(783),f=a(431),O=a(432),x=a(491),g=a(490),y=a(837),_=a(12),v=a(0),k=Object(_.a)({root:{"& input:valid + fieldset":{borderColor:"grey",borderWidth:1},"& input:invalid + fieldset":{borderColor:"red",borderWidth:2},"& input:valid:focus + fieldset":{borderLeftWidth:6,padding:"4px !important"}}})(y.a),w=function(e){Object(x.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){var a=e.props.name,n=t.target.value,i=!!e.props.validate&&e.props.validate(n);e.props.onChange(a,n,i)},e.checkError=function(){return!!e.props.validate&&e.props.validate(e.props.value)},e.onKeyPress=function(t){"Enter"===t.key?void 0!==e.props.onEnter&&e.props.onEnter():e.onChange(t)},e}return Object(O.a)(a,[{key:"render",value:function(){return Object(v.jsx)("div",{style:{width:this.props.width?this.props.width+"rem":"100%"},children:Object(v.jsx)(k,{fullWidth:!0,placeholder:this.props.placeholder,value:this.props.value,onChange:this.onChange,onKeyPress:this.onKeyPress,label:this.props.name,autoFocus:!!this.props.autoFocus,variant:"outlined",disabled:void 0!==this.props.disabled&&this.props.disabled,required:!!this.props.requiredValue&&this.props.requiredValue,InputLabelProps:this.props.inputLabelProps,multiline:!!this.props.multiline&&this.props.multiline,error:this.checkError(),type:void 0===this.props.type?"text":this.props.type,InputProps:this.props.InputProps,helperText:this.checkError()?this.props.errorText:this.props.helperText,style:{padding:0,marginBottom:this.props.marginBottom?this.props.marginBottom:"10px"}})})}}]),a}(l.a.Component),C=a.p+"static/media/mythic.7189479f.svg",S=a(68),D=a(158),I=Object(D.c)({}),$=Object(D.c)(!1);null!==localStorage.getItem("access_token")&&I({loggedIn:!0,access_token:localStorage.getItem("access_token"),refresh_token:localStorage.getItem("refresh_token"),user:JSON.parse(localStorage.getItem("user"))});var T=function(e){localStorage.setItem("access_token",e.access_token),I.loggedIn=!0},P=function(){console.log("failed refresh"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),I({loggedIn:!1,access_token:null,refresh_token:null,user:null})},A=a(838),E=a(74),F=null,L=function(){return F=Object(E.c)(),null},q={success:function(e,t){this.toast(e,"success",t)},warning:function(e,t){this.toast(e,"warning",t)},info:function(e,t){this.toast(e,"info",t)},error:function(e,t){this.toast(e,"error",t)},dismiss:function(){F.closeSnackbar()},toast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",a=arguments.length>2?arguments[2]:void 0;F.enqueueSnackbar(e,Object(o.a)({variant:t},a))}};function N(e){var t=Object(A.a)(I),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(""),d=Object(j.a)(r,2),u=d[0],b=d[1];Object(s.useEffect)((function(){P()}),[]);var p=function(e){if(e.preventDefault(),""!==i&&""!==u){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:u})};fetch("/auth",t).then((function(e){e.json().then((function(e){"access_token"in e?(!function(e){localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),localStorage.setItem("user",JSON.stringify(e.user)),I(Object(o.a)({loggedIn:!0},e))}(e),jx()):(q.warning("Invalid Username or Password"),console.log("Error",e))})).catch((function(e){q.warning("Error getting JSON from server"),console.log("Error trying to get json response",e.toString())}))})).catch((function(e){q.warning("Error talking to server"),console.log("There was an error!",e.toString())}))}else q.warning("Username and Password required")};return Object(v.jsx)("div",{style:{justifyContent:"center",display:"flex"},children:t.loggedIn?Object(v.jsx)(S.a,{to:function(){var t=e.location.state;return t&&t.from?t.from.pathname:"/new/"}()}):Object(v.jsxs)("div",{children:[Object(v.jsx)("img",{src:C,height:"400px",alt:"Mythic logo"}),Object(v.jsxs)("form",{onSubmit:p,children:[Object(v.jsx)(w,{name:"username",value:i,onChange:function(e,t,a){c(t)},width:30}),Object(v.jsx)(w,{name:"password",type:"password",value:u,onChange:function(e,t,a){b(t)},width:30}),Object(v.jsx)(m.a,{type:"submit",color:"primary",onClick:p,variant:"contained",style:{marginRight:"10px"},children:"Login"})]})]})})}var R=a(5),B=a(6),W=a(848),z=a(850),H=a(840),M=a(847),U=a(849),V=a(839),G=a(222),K=a(841),Q=a(887),J=a(496),Y=a(497),Z=a(99),X=a(196),ee=a.n(X),te=a(195),ae=a.n(te),ne=a(45),ie=a.n(ne),ce=a(114),re=a.n(ce);function oe(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{onClick:function(){return q.warning("Not Implemented Yet")},startIcon:Object(v.jsx)(ie.a,{}),color:"secondary",variant:"contained",children:"Delete"})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(K.a,{checked:e.active,onChange:function(t){var a=t.target.name,n=e.id;e.onChanged({id:n,name:a})},inputProps:{"aria-label":"primary checkbox"},name:"active"})}),Object(v.jsx)(H.a,{children:e.token_type}),Object(v.jsx)(H.a,{children:e.token_value})]},"apitokenRow"+e.id)}var se=a(845),le=a(843),de=a(844),ue=a(842);function be(e){var t=l.a.useState(e.username?e.username:""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState(""),u=Object(j.a)(d,2),b=u[0],p=u[1];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:e.title}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(de.a,{children:"Use this dialog to update some information about an operator."}),Object(v.jsx)(w,{autoFocus:!0,placeholder:e.username,value:n,onChange:function(e,t,a){i(t)},margin:"dense",id:"username",name:"username"}),Object(v.jsx)(w,{margin:"dense",id:"passwordOld",onChange:function(e,t,a){s(t)},name:"old password",type:"password"}),Object(v.jsx)(w,{margin:"dense",id:"passwordNew",onChange:function(e,t,a){p(t)},name:"new password",type:"password"})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.handleClose,variant:"contained",color:"primary",children:"Cancel"}),Object(v.jsx)(m.a,{onClick:function(){e.onAccept(e.id,n,o,b)},variant:"contained",color:"primary",children:"Update"})]})]})}function je(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Delete Operator"}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(de.a,{children:"This deletes an operator and prevents them from permanently logging in again. If you want a temporary solution, disable the operator instead."}),Object(v.jsxs)(de.a,{children:['Are you sure you want to delete operator "',e.username,'"?']})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(v.jsx)(m.a,{onClick:function(){e.onAccept(e.id)},variant:"contained",color:"secondary",children:"Delete"})]})]})}var pe=a(846);function he(e){var t=l.a.useRef(null);return l.a.useEffect((function(){if(e.open){var a=t.current;null!==a&&a.focus()}}),[e.open]),Object(v.jsx)(pe.a,{open:e.open,onClose:e.onClose,scroll:"paper",maxWidth:e.maxWidth,fullWidth:e.fullWidth,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:e.innerDialog})}function me(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=function(){e.onSubmit(n),e.onClose()};return Object(s.useEffect)((function(){i(e.value)}),[e.value]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:e.title}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{autoFocus:!0,onEnter:c,onChange:function(e,t,a){i(t)},value:n})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:c,variant:"contained",color:"secondary",children:"Submit"})]})]})}function fe(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState("dictionary"),r=Object(j.a)(c,2),o=r[0],d=r[1],u=l.a.useState([]),b=Object(j.a)(u,2),p=b[0],h=b[1];return Object(s.useEffect)((function(){var t=[];try{var a;if((a=e.value.constructor===Object?e.value:JSON.parse(e.value)).constructor===Object)for(var n in a)a[n].constructor===Object||Array.isArray(a[n])?t.push({name:n,value:JSON.stringify(a[n],null,2)}):t.push({name:n,value:a[n]}),h([e.leftColumn,e.rightColumn]);else d("array"),a.length>0?(h(Object.keys(a[0])),t=a):h([])}catch(c){console.log(c)}i(t)}),[e.value,e.leftColumn,e.rightColumn]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:e.title}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(G.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsx)(V.a,{children:p.map((function(e,t){return Object(v.jsx)(H.a,{children:e},"header"+t)}))})}),Object(v.jsx)(z.a,{children:"dictionary"===o?n.map((function(e,t){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:e.name}),Object(v.jsx)(H.a,{style:{wordBreak:"break-all",whiteSpace:"pre-wrap"},children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)})):n.map((function(e,t){return Object(v.jsx)(V.a,{hover:!0,children:Object.keys(e).map((function(a){return Object(v.jsx)(H.a,{children:e[a]},"row"+t+"cell"+a)}))},"row"+t)}))})]})})})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function Oe(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];return Object(s.useEffect)((function(){var t=e.keys.reduce((function(t,a){return void 0!==e.value[a]&&null!==e.value[a]&&""!==e.value[a]?[].concat(Object(R.a)(t),[{name:a,value:e.value[a]}]):Object(R.a)(t)}),[]);i(t)}),[e.value,e.keys]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:e.title}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(G.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.leftColumn}),Object(v.jsx)(H.a,{children:e.rightColumn})]})}),Object(v.jsx)(z.a,{children:n.map((function(e,t){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.name}),Object(v.jsx)(H.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function xe(e,t){try{if(null===e)return"N/A";var a=new Date(e);return t?e+" UTC":a.toDateString()+" "+a.toTimeString().substring(0,8)}catch(n){console.log("warning","Failed to get local time converted: "+n.toString())}}function ge(e){var t=new Date,a=t.getTime()+6e4*t.getTimezoneOffset(),n=Math.abs(a-new Date(e).getTime()),i=Math.trunc(n/1e3%60),c=Math.trunc(n/6e4%60),r=Math.trunc(n/36e5%24),o=Math.trunc(n/864e5%365),s="";return 0!==o&&(s+=o+"d"),0!==r&&(s+=r+"h"),0!==c&&(s+=c+"m"),s+=i+"s"}function ye(e,t){var a=Object(s.useRef)();Object(s.useEffect)((function(){a.current=e})),Object(s.useEffect)((function(){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}),[t])}function _e(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),d=r[0],u=r[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],f=p[1],O=Object(A.a)(I),x=function(e,t){};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(V.a,{children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)(m.a,{size:"small",onClick:function(){f(!0)},startIcon:Object(v.jsx)(ie.a,{}),color:"secondary",variant:"contained",children:"Delete"}),Object(v.jsx)(he,{open:h,onClose:function(){f(!1)},innerDialog:Object(v.jsx)(je,Object(o.a)({onClose:function(){f(!1)},onAccept:function(t){e.onDeleteOperator(t),f(!1)}},e))})]}),Object(v.jsx)(H.a,{children:e.username}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(m.a,{size:"small",onClick:function(){u(!0)},color:"primary",variant:"contained",children:"Update"}),Object(v.jsx)(he,{open:d,onClose:function(){u(!1)},innerDialog:Object(v.jsx)(be,Object(o.a)({onAccept:function(t,a,n,i){console.log("settingsoperator onAccept",t,a,n,i),a!==e.username&&e.onUsernameChanged(t,a),u(!1)},handleClose:function(){u(!1)},title:"Update Operator"},e))})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(K.a,{checked:e.view_utc_time,onChange:function(t){var a=e.id;e.onViewUTCChanged(a,!e[t.target.name])},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"view_utc_time"})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(K.a,{checked:e.active,onChange:function(t){var a=e.id;e.onActiveChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"active"})}),Object(v.jsx)(H.a,{children:xe(e.last_login,O.user.view_utc_time)}),Object(v.jsx)(H.a,{children:xe(e.creation_time,O.user.view_utc_time)}),Object(v.jsx)(H.a,{children:Object(v.jsx)(K.a,{checked:e.admin,onChange:function(t){var a=e.id;e.onAdminChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"admin"})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Y.a,{"aria-label":"expand row",size:"small",onClick:function(){return i(!n)},children:n?Object(v.jsx)(ae.a,{className:"mythicElement"}):Object(v.jsx)(ee.a,{className:"mythicElement"})})})]},e.id),Object(v.jsx)(V.a,{children:Object(v.jsx)(H.a,{style:{paddingBottom:0,paddingTop:0},colSpan:9,children:Object(v.jsx)(J.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(v.jsxs)(Q.a,{margin:1,children:[Object(v.jsx)(Z.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"API Tokens"}),Object(v.jsx)(m.a,{size:"small",onClick:function(){return q.warning("Not Implemented Yet")},style:{float:"right"},startIcon:Object(v.jsx)(re.a,{}),color:"primary",variant:"contained",children:"New"}),Object(v.jsxs)(W.a,{size:"small","aria-label":"tokens",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"7rem"},children:"Delete"}),Object(v.jsx)(H.a,{style:{width:"6rem"},children:"Active"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Type"}),Object(v.jsx)(H.a,{children:"Token"})]})}),Object(v.jsx)(z.a,{children:e.apitokens.map((function(e){return Object(s.createElement)(oe,Object(o.a)(Object(o.a)({},e),{},{onChanged:x,key:"token"+e.id}))}))})]})]})})})})]})}var ve=a(60);function ke(e){var t=Object(ve.a)(),a=l.a.useState(!1),n=Object(j.a)(a,2),i=n[0],c=n[1];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Settings"})}),Object(v.jsxs)(M.a,{component:G.a,className:"mythicElement",children:[Object(v.jsx)(m.a,{size:"small",onClick:function(){c(!0)},style:{float:"right"},startIcon:Object(v.jsx)(re.a,{}),color:"primary",variant:"contained",children:"New Operator"}),Object(v.jsx)(he,{open:i,onClose:function(){c(!1)},innerDialog:Object(v.jsx)(be,Object(o.a)({title:"New Operator",onAccept:function(t,a,n,i){n!==i?q.error("Passwords don't match"):0===i.length?q.error("Password must not be empty"):0===a.length?q.error("Username must not be empty"):(e.onNewOperator(a,i),c(!1))},handleClose:function(){c(!1)}},e))}),Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"9rem"},children:"Delete Account"}),Object(v.jsx)(H.a,{children:"Username"}),Object(v.jsx)(H.a,{style:{width:"6rem"},children:"Modify"}),Object(v.jsx)(H.a,{style:{width:"10rem"},children:"UTC Timestamps"}),Object(v.jsx)(H.a,{style:{width:"9rem"},children:"Account Active"}),Object(v.jsx)(H.a,{children:"Last Login"}),Object(v.jsx)(H.a,{children:"Account Creation Date"}),Object(v.jsx)(H.a,{style:{width:"9rem"},children:"Admin Status"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"More..."})]})}),Object(v.jsx)(z.a,{children:e.operator.map((function(t){return Object(v.jsx)(_e,Object(o.a)({onViewUTCChanged:e.onViewUTCChanged,onAdminChanged:e.onAdminChanged,onActiveChanged:e.onActiveChanged,onDeleteOperator:e.onDeleteOperator,onUsernameChanged:e.onUsernameChanged},t),"operator"+t.id)}))})]})]})]})}var we,Ce,Se,De,Ie,$e,Te,Pe=a(177),Ae=a(851),Ee=a(897),Fe=a(853),Le=Object(Pe.a)(we||(we=Object(B.a)(["\nquery GetOperators {\n  operator(where: {deleted: {_eq: false}}, order_by: {username: asc}) {\n    active\n    admin\n    creation_time\n    deleted\n    id\n    last_login\n    username\n    view_utc_time\n    apitokens {\n      token_value\n      token_type\n      active\n      id\n    }\n  }\n}\n"]))),qe=Object(Pe.a)(Ce||(Ce=Object(B.a)(["\nmutation SettingsUpdateOperatorViewUTCTime($id: Int!, $view_utc_time: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {view_utc_time: $view_utc_time}) {\n    id\n    view_utc_time\n  }\n}\n"]))),Ne=Object(Pe.a)(Se||(Se=Object(B.a)(["\nmutation SettingsUpdateOperatorAdminMutation($id: Int!, $admin: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {admin: $admin}) {\n      id\n      admin\n  }\n}\n"]))),Re=Object(Pe.a)(De||(De=Object(B.a)(["\nmutation SettingsUpdateOperatorActiveMutation($id: Int!, $active: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {active: $active}) {\n      id\n      active\n  }\n}\n"]))),Be=Object(Pe.a)(Ie||(Ie=Object(B.a)(["\nmutation SettingsDeleteOperatorMutation($id: Int!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {deleted: true}) {\n      id\n      deleted\n  }\n}\n"]))),We=Object(Pe.a)($e||($e=Object(B.a)(["\nmutation SettingsUsernameOperatorMutation($id: Int!, $username: String!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {username: $username}) {\n      id\n      username\n  }\n}\n"]))),ze=Object(Pe.a)(Te||(Te=Object(B.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    active\n    creation_time\n    deleted\n    error\n    id\n    last_login\n    status\n    username\n    view_utc_time\n  }\n}\n"])));function He(e){var t=Object(A.a)(I),a=Object(Ae.a)(Le,{fetchPolicy:"network-only"}),n=a.loading,i=a.error,c=a.data,r=Object(Ee.a)(qe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){if(e.update_operator_by_pk.id===t.user.id){var a=I();a.user.view_utc_time=e.update_operator_by_pk.view_utc_time,I(a)}q.success("Successfully updated")}else q.warning("Cannot update another user's data without Admin permissions")},onError:function(e){console.log(e),q.error("Unable to update operator timestamps without Admin permissions")}}),s=Object(j.a)(r,1)[0],l=Object(Ee.a)(Be,{update:function(e,t){var a=t.data,n=e.readQuery({query:Le}),i=a.update_operator_by_pk,c=n.operator.filter((function(e){return e.id!==i.id}));e.writeQuery({query:Le,data:{operator:c}})},onCompleted:function(e){null!==e.update_operator_by_pk?q.success("Successfully updated"):q.warning("Cannot update another user's data without Admin permissions")},onError:function(){q.warning("Unable to delete operator without Admin permissions")}}),d=Object(j.a)(l,1)[0],u=Object(Ee.a)(Ne,{onCompleted:function(e){null!==e.update_operator_by_pk?q.success("Successfully updated"):q.warning("Cannot update another user's data without Admin permissions")},onError:function(){q.warning("Unable to update operator admin status without Admin permissions")}}),b=Object(j.a)(u,1)[0],p=Object(Ee.a)(Re,{onCompleted:function(e){null!==e.update_operator_by_pk?q.success("Successfully updated"):q.warning("Cannot update another user's data without Admin permissions")},onError:function(){q.warning("Unable to update operator active status without Admin permissions")}}),h=Object(j.a)(p,1)[0],m=Object(Ee.a)(ze,{update:function(e,t){var a=t.data;if("success"===a.createOperator.status){var n=e.readQuery({query:Le}),i=a.createOperator;e.writeQuery({query:Le,data:{operator:[i].concat(Object(R.a)(n.operator))}})}else q.error(a.createOperator.error)},onError:function(e){q.warning("Unable to create new operator"),console.log(e)}}),f=Object(j.a)(m,1)[0],O=Object(Ee.a)(We,{onCompleted:function(e){null!==e.update_operator_by_pk?q.success("Successfully updated"):q.warning("Cannot update another user's data without Admin permissions")},onError:function(){q.warning("Unable to update operator's username without Admin permissions")}}),x=Object(j.a)(O,1)[0];return n?Object(v.jsx)(Fe.a,{}):i?(console.error(i),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsx)("div",{style:{height:"calc(94vh)",marginTop:"10px",marginRight:"5px"},children:Object(v.jsx)(ke,Object(o.a)({onViewUTCChanged:function(e,t){s({variables:{id:e,view_utc_time:t}})},onAdminChanged:function(e,t){b({variables:{id:e,admin:t}})},onActiveChanged:function(e,t){h({variables:{id:e,active:t}})},onNewOperator:function(e,t){f({variables:{username:e,password:t}})},onDeleteOperator:function(e){d({variables:{id:e}})},onUsernameChanged:function(e,t){x({variables:{id:e,username:t}})}},c))})}function Me(e){return Object(s.useEffect)((function(){I({loggedIn:!1,accessToken:null,refreshToken:null,user:null}),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),$(!1)})),Object(v.jsx)(S.a,{to:"/new/login"})}var Ue,Ve=a(855),Ge=a(856),Ke=a(857),Qe=a(854),Je=Object(Pe.a)(Ue||(Ue=Object(B.a)(["\nquery GetPayloadDetails($payload_name: String!) {\n  payloadtype(where: {ptype: {_eq: $payload_name}}) {\n    buildparameters (where: {deleted: {_eq: false} } ){\n      description\n      name\n      id\n      parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function Ye(e){var t=Object(s.useState)([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(Je,{variables:{payload_name:e.payload_name},onCompleted:function(e){console.log(e),i(e.payloadtype[0].buildparameters)}}),r=c.loading,o=c.error;return r?Object(v.jsx)(Fe.a,{}):o?(console.error(o),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(de.a,{children:"These are the build parameters associated with this payload"}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.description}),Object(v.jsxs)(H.a,{children:["Scripting/Building Name:",Object(v.jsx)("br",{}),e.name,Object(v.jsx)("br",{}),"Parameter Type:",Object(v.jsx)("br",{}),e.parameter_type,Object(v.jsx)("br",{}),"Default Parameter:",Object(v.jsx)("br",{}),e.parameter,Object(v.jsx)("br",{}),"Required value?",Object(v.jsx)("br",{}),e.required?"Yes":"No",Object(v.jsx)("br",{}),"Verifier Regex:",Object(v.jsx)("br",{}),e.verifier_regex,Object(v.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.handleClose,color:"primary",children:"Close"})})]})}var Ze=Object(h.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),Xe=Object(_.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Qe.a);function et(e){var t=Ze(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(!1),d=Object(j.a)(r,2),u=d[0],b=d[1],p=l.a.useState(""),h=Object(j.a)(p,2),f=h[0],O=h[1],x=new Date,g=(x.getTime()+6e4*x.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(s.useEffect)((function(){if(e.wrap_these_payload_types.length>0){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));c(t.join(", "))}else c("");O(e.supported_os.split(",").join(", "))}),[e.wrap_these_payload_types,e.supported_os]),Object(v.jsxs)(Ve.a,{className:t.root,elevation:5,children:[Object(v.jsx)(Xe,{overlap:"circle",classes:{badge:t[g]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(v.jsx)(Ge.a,{className:t.media,component:"img",style:{width:"125px",height:"125",padding:"10px",objectFit:"unset"},src:"/static/"+e.ptype+".svg"})}),Object(v.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(v.jsx)(Z.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.ptype}),Object(v.jsxs)(Ke.a,{style:{textAlign:"left"},children:[Object(v.jsxs)(Z.a,{variant:"body1",component:"p",children:[Object(v.jsx)("b",{children:"Author:"})," ",e.author]}),Object(v.jsxs)(Z.a,{variant:"body1",component:"p",children:[Object(v.jsx)("b",{children:"Supported Operating Systems:"})," ",f]}),0===e.wrap_these_payload_types.length?null:Object(v.jsxs)(Z.a,{variant:"body1",component:"p",children:[Object(v.jsx)("b",{children:"Wrapped Payload Types:"})," ",i]}),Object(v.jsx)(Z.a,{variant:"body2",component:"p",children:e.note})]})]}),Object(v.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(v.jsx)(m.a,{size:"small",variant:"contained",color:"primary",href:e.wrapper?"/docs/wrappers/"+e.ptype:"/docs/agents/"+e.ptype,target:"_blank",children:"Docs"}),Object(v.jsx)(m.a,{size:"small",onClick:function(){b(!0)},color:"primary",variant:"contained",children:"Building Info"}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:u,onClose:function(){b(!1)},innerDialog:Object(v.jsx)(Ye,Object(o.a)(Object(o.a)({},e),{},{payload_name:e.ptype}))})]})]})}var tt,at,nt=a(898),it=Object(Pe.a)(tt||(tt=Object(B.a)(["\n subscription getPayloadTypesSubscription {\n  payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n    author\n    container_running\n    id\n    last_heartbeat\n    note\n    ptype\n    supported_os\n    wrapper\n    translationcontainer {\n        id\n        name\n        last_heartbeat\n        container_running\n    }\n    wrap_these_payload_types {\n        id\n        wrapped {\n          ptype\n        }\n    }\n  }\n}\n "])));function ct(e){var t=Object(ve.a)(),a=Object(nt.a)(it).data,n=l.a.useState([]),i=Object(j.a)(n,2),c=i[0],r=i[1];return Object(s.useEffect)((function(){r(void 0!==a?a.payloadtype:[])}),[a]),Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)("div",{style:{width:"49%",display:"inline-flex",flexDirection:"column",alignItems:"stretch"},children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payload Types"})}),c.map((function(e){return Object(v.jsx)(et,Object(o.a)({},e),"payloadtype"+e.id)}))]})})}var rt=Object(Pe.a)(at||(at=Object(B.a)(["\nquery GetPC2Details($payload_name: String!) {\n  c2profile(where: {name: {_eq: $payload_name}}) {\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      name\n      parameter_type\n      id\n      randomize\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function ot(e){var t=Object(s.useState)([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(rt,{variables:{payload_name:e.payload_name},onCompleted:function(e){i(e.c2profile[0].c2profileparameters)}}),r=c.loading,o=c.error;return r?Object(v.jsx)(Fe.a,{}):o?(console.error(o),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(de.a,{children:"These are the build parameters associated with this payload"}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.description}),Object(v.jsxs)(H.a,{children:["Scripting/Building Name:",Object(v.jsx)("br",{}),e.name,Object(v.jsx)("br",{}),"Parameter Type:",Object(v.jsx)("br",{}),e.parameter_type,Object(v.jsx)("br",{}),"Default Parameter:",Object(v.jsx)("br",{}),e.default_value,Object(v.jsx)("br",{}),"Required value?",Object(v.jsx)("br",{}),e.required?"Yes":"No",Object(v.jsx)("br",{}),"Verifier Regex:",Object(v.jsx)("br",{}),e.verifier_regex,Object(v.jsx)("br",{}),"Randomize value?: ",Object(v.jsx)("br",{}),e.randomize?"Yes":"No",Object(v.jsx)("br",{}),"Random Format String: ",Object(v.jsx)("br",{}),e.format_string,Object(v.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var st,lt,dt=a(143),ut=a.n(dt),bt=a(863),jt=a(160),pt=a.n(jt),ht=a(781),mt=a(494),ft=a(788),Ot=a(861),xt=a(778),gt=Object(Pe.a)(st||(st=Object(B.a)(["\nquery getProfileOutput($id: Int!) {\n  getProfileOutput(id: $id) {\n    status\n    error\n    output\n  }\n}\n"])));function yt(e){var t=Object(Ae.a)(gt,{variables:{id:e.profile_id},onCompleted:function(e){},fetchPolicy:"network-only"}),a=t.loading,n=t.error,i=t.data;return a?Object(v.jsx)(Fe.a,{}):n?(console.error(n),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(de.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(v.jsx)(w,{multiline:!0,onChange:function(){},value:i.getProfileOutput.output})]}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var _t=Object(Pe.a)(lt||(lt=Object(B.a)(["\nquery getProfileConfigOutput($id: Int!, $filename: String!) {\n  downloadContainerFile(id: $id, filename: $filename) {\n    status\n    error\n    filename\n    data\n  }\n}\n"])));function vt(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(_t,{variables:{id:e.profile_id,filename:"config.json"},onCompleted:function(e){"error"===e.downloadContainerFile.status?i("Errored trying to read file from container\n"+e.downloadContainerFile.error):i(atob(e.downloadContainerFile.data))},fetchPolicy:"network-only"}),r=c.loading,o=c.error;if(r)return Object(v.jsx)(Fe.a,{});if(o)return console.error(o),Object(v.jsx)("div",{children:"Error!"});return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Configuration"]}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,onChange:function(e,t,a){i(t)},value:n})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(v.jsx)(m.a,{variant:"contained",onClick:function(){e.onConfigSubmit(btoa(n)),e.onClose()},color:"secondary",children:"Submit"})]})]})}function kt(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(de.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(v.jsx)(w,{multiline:!0,value:e.output,onChange:function(){}})]}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var wt=a(437),Ct=a.n(wt),St=a(862),Dt=a(773),It=a(792),$t=a(858),Tt=a(771),Pt=a(159),At=a.n(Pt),Et=a(84),Ft=a(886),Lt=a(284),qt=a(776);function Nt(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,c=e.required,r=e.verifier_regex,d=e.id,u=e.description,b=e.value,p=(e.returnAllDictValues,l.a.useState("")),h=Object(j.a)(p,2),f=h[0],O=h[1],x=Object(ve.a)(),g=l.a.useState([]),y=Object(j.a)(g,2),_=y[0],k=y[1],C=l.a.useState([]),S=Object(j.a)(C,2),D=S[0],I=S[1],$=l.a.useState([]),T=Object(j.a)($,2),P=T[0],A=T[1],E=l.a.useState(""),F=Object(j.a)(E,2),L=F[0],q=F[1],N=l.a.useState([]),B=Object(j.a)(N,2),W=B[0],z=B[1],M=l.a.useState(new Date),U=Object(j.a)(M,2),G=U[0],K=U[1],Q=function(e){var a=e.reduce((function(e,t){return""!==t.value?[].concat(Object(R.a)(e),[{custom:"*"===t.name,key:t.key,name:t.name,value:t.value}]):Object(R.a)(e)}),[]);t(i,a,!1)};Object(s.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");O(e[0]),z(e)}""!==b&&void 0!==b&&(O(b),t(i,b,""))}else if("Date"===a){if(""!==n){var c=new Date;c.setDate(c.getDate()+parseInt(n)),ae(c),O(-1)}""!==b&&void 0!==b&&b.includes("-")&&(console.log("passed date value: ",b),K(new Date(b)),O(-1),t(i,new Date(b).toISOString().slice(0,10),""))}else if("Dictionary"===a)if(""!==b&&void 0!==b&&"object"===typeof b){console.log("passed dictionaryvalue",b);var r=b.reduce((function(e,t){return t.default_show?[].concat(Object(R.a)(e),[Object(o.a)({},t)]):Object(R.a)(e)}),[]);Q(r),k(r),I(b);var s=b.reduce((function(e,t){var a=r.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(R.a)(e),[Object(o.a)({},t)]):Object(R.a)(e)}),[]);A(s),s.length>0&&q(s[0])}else{var l=JSON.parse(n);I(l);var d=l.reduce((function(e,t){return t.default_show?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(R.a)(e)}),[]);Q(d),k(d);var u=l.reduce((function(e,t){var a=d.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(R.a)(e)}),[]);A(u),u.length>0&&q(u[0])}else void 0!==n&&O(n),""!==b&&void 0!==b&&(O(b),t(i,b,""))}),[n,a,i]);var J=function(e){O(e.target.value),t(i,e.target.value,!1)},X=function(e,a,n){O(a),t(e,a,n)},ee=function(e){return(c&&""!==r||""!==r&&""!==e)&&!RegExp(r).test(e)},te=function(){var e=Object(o.a)({},L);"*"===e.name&&(e.key="",e.value="");var t=[].concat(Object(R.a)(_),[Object(o.a)(Object(o.a)({},e),{},{default_show:!0})]);k(t);var a=P.reduce((function(a,n){var i=t.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return e.name===n.name&&(i+=1),-1===n.max||n.max>i?[].concat(Object(R.a)(a),[Object(o.a)({},n)]):Object(R.a)(a)}),[]);Q(t),A(a),a.length>0&&q(a[0])},ae=function(e){K(e),t(i,e.toISOString().slice(0,10),"")},ne=l.a.useState(null),ce=Object(j.a)(ne,2),re=ce[0],oe=ce[1],se=Boolean(re),le=function(){oe(null)};return Object(v.jsxs)(V.a,{children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Z.a,{"aria-haspopup":"true",onMouseEnter:function(e){oe(e.currentTarget)},onMouseLeave:le,"aria-owns":se?"taskparam"+d+"popover":void 0,children:u}),Object(v.jsx)(qt.a,{id:"taskparam"+d+"popover",open:se,anchorEl:re,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:le,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===x.palette.type?x.palette.primary.dark:x.palette.primary.light,color:"white"},variant:"outlined"},children:Object(v.jsx)(Z.a,{children:i.length>0?i:"No Description"})})]}),Object(v.jsx)(H.a,{children:function(){switch(a){case"Date":return Object(v.jsx)(Et.a,{utils:Lt.a,children:Object(v.jsx)($t.a,{container:!0,justify:"flex-start",children:Object(v.jsx)(Ft.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:G,onChange:ae,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:f,onChange:J,children:W.map((function(e,t){return Object(v.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(v.jsxs)(l.a.Fragment,{children:[_.map((function(e,t){return Object(v.jsxs)("div",{children:[Object(v.jsxs)(Y.a,{onClick:function(e){!function(e){var t=_[e],a=_.filter((function(t,a){return e!==a}));k(a);var n=D.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(R.a)(e),[Object(o.a)({},n)]):Object(R.a)(e)}),[]);Q(a),A(n),n.length>0&&q(n[0])}(t)},children:[Object(v.jsx)(ie.a,{style:{color:x.palette.error.main}})," "]}),"*"===e.name?Object(v.jsx)(Tt.a,{style:{width:"20%"},startAdornment:Object(v.jsx)(m.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=_.map((function(a,n){return n===t?Object(o.a)(Object(o.a)({},a),{},{key:e.target.value}):Object(o.a)({},a)}));Q(a),k(a)}(e,t)}}):Object(v.jsx)(Tt.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(v.jsx)(m.a,{disabled:!0,children:"key"}),value:e.key}),Object(v.jsx)(Tt.a,{style:{width:"75%"},startAdornment:Object(v.jsx)(m.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=_.map((function(a,n){return n===t?Object(o.a)(Object(o.a)({},a),{},{value:e.target.value}):Object(o.a)({},a)}));Q(a),k(a)}(e,t)}})]},"dictval"+t)})),P.length>0?Object(v.jsxs)("div",{children:[Object(v.jsxs)(Y.a,{onClick:te,children:[" ",Object(v.jsx)(At.a,{style:{color:x.palette.success.main}})," "]}),Object(v.jsx)(It.a,{size:"small",value:L,onChange:function(e){return q(e.target.value)},children:P.map((function(e,t){return Object(v.jsx)(Ot.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+t)}))})]}):null]});case"String":return Object(v.jsx)(w,{required:c,value:f,multiline:!0,onChange:X,display:"inline-block",name:i,validate:ee,errorText:"Must match: "+r});default:return null}}()})]},"buildparam"+d)}function Rt(e){var t=function(t,a,n){e.onChange(e.name,t,a,n)};return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"auto"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"20%"},children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:e.c2profileparameters.map((function(a){return Object(v.jsx)(Nt,Object(o.a)({returnAllDictValues:e.returnAllDictValues,onChange:t},a),"c2paramtablerow"+a.id)}))})]})})}var Bt,Wt,zt,Ht,Mt=a(774),Ut=a(262),Vt=Object(Pe.a)(Bt||(Bt=Object(B.a)(["\nquery getProfileParameters($id: Int!, $operation_id: Int!) {\n  c2profile_by_pk(id: $id) {\n    c2profileparameters(where: {deleted: {_eq: false}}, order_by: {name: asc}){\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n      instance_name\n    }\n  }\n}\n"]))),Gt=Object(Pe.a)(Wt||(Wt=Object(B.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    id\n    value\n  }\n}\n"]))),Kt=Object(Pe.a)(zt||(zt=Object(B.a)(["\nmutation deleteSavedInstance($name: String!, $operation_id: Int!){\n  delete_c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}){\n    affected_rows\n  }\n}\n"]))),Qt=Object(Pe.a)(Ht||(Ht=Object(B.a)(["\nmutation createNewC2Instance($instance_name: String!, $c2_instance: String!, $c2profile_id: Int!){\n  create_c2_instance(c2_instance: $c2_instance, instance_name: $instance_name, c2profile_id: $c2profile_id){\n    status\n    error\n  }\n}\n"])));function Jt(e){var t=Object(ve.a)(),a=Object(A.a)(I),n=Object(s.useState)(""),i=Object(j.a)(n,2),c=i[0],r=i[1],d=Object(s.useState)(""),u=Object(j.a)(d,2),p=u[0],h=u[1],f=Object(s.useState)([]),O=Object(j.a)(f,2),x=O[0],g=O[1],y=Object(s.useState)([]),_=Object(j.a)(y,2),k=_[0],C=_[1],S=Object(s.useState)([]),D=Object(j.a)(S,2),$=D[0],T=D[1],P=Object(Ae.a)(Vt,{variables:{id:e.id,operation_id:a.user.current_operation_id},onCompleted:function(e){var t=e.c2profile_by_pk.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Ut(e.format_string).gen();return Object(o.a)(Object(o.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(o.a)(Object(o.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return t.default_show?[].concat(Object(R.a)(e),[{value:t.default_value,key:"*"===t.name?"":t.name,name:t.name,custom:"*"===t.name}]):Object(R.a)(e)}),[]);return Object(o.a)(Object(o.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return n.setDate(n.getDate()+parseInt(e.default_value)),Object(o.a)(Object(o.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(o.a)(Object(o.a)({},e),{},{value:e.default_value})}return Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value})}));t.sort((function(e,t){return-t.description.localeCompare(e.description)})),C(Object(R.a)(t)),T(Object(R.a)(t)),g(e.c2profile_by_pk.c2profileparametersinstances)},onError:function(e){},fetchPolicy:"network-only"}).loading,E=Object(St.a)(Gt,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(o.a)(Object(o.a)({},e),e.c2profileparameter);return"Dictionary"!==t.parameter_type&&"Array"!==t.parameter_type||(t.value=JSON.parse(t.value)),t}));t.sort((function(e,t){return e.name<t.name?-1:1})),T(t)},onError:function(e){q.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),F=Object(j.a)(E,1)[0],L=Object(Ee.a)(Kt,{onCompleted:function(e){h(""),r(""),T(Object(R.a)(k));var t=x.filter((function(e){return e.instance_name!==p}));g(t),q.success("Sucessfully deleted instance")},onError:function(e){q.error("Failed to delete instance: "+e)}}),N=Object(j.a)(L,1)[0],B=Object(Ee.a)(Qt,{onCompleted:function(t){"success"===t.create_c2_instance.status?q.success("Successfully created instance"):q.error("Failed to create instance: "+t.create_c2_instance.error),e.onClose()},onError:function(e){q.error("Failed to create instance: "+e)}}),W=Object(j.a)(B,1)[0];if(P)return Object(v.jsx)(Fe.a,{});return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:["Save an Instance of ",e.name,"'s Parameters"]}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(Z.a,{style:{paddingBottom:"10px"},children:"Saving an instance of the parameters allows you to select them from a dropdown when creating agents later, saving time and typos."}),x.length>0?Object(v.jsxs)($t.a,{container:!0,spacing:2,style:{paddingTop:"10px"},children:[Object(v.jsx)($t.a,{item:!0,xs:6,children:Object(v.jsxs)(Dt.a,{style:{width:"100%"},children:[Object(v.jsx)(Mt.a,{children:"Select an Existing Instance"}),Object(v.jsxs)(It.a,{style:{width:"100%",marginBottom:"10px"},value:p,label:"Select an Existing Instance",onChange:function(e){h(e.target.value),r(e.target.value),""===e.target.value?T(Object(R.a)(k)):(T([]),F({variables:{name:e.target.value,operation_id:a.user.current_operation_id}}))},children:[Object(v.jsx)(Ot.a,{value:"",children:"New Instance"}),x.map((function(e,t){return Object(v.jsx)(Ot.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]})}),Object(v.jsx)($t.a,{item:!0,xs:6,children:p.length>0?Object(v.jsx)(m.a,{style:{backgroundColor:t.palette.error.main,color:"white"},variant:"contained",onClick:function(){T([]),N({variables:{name:p,operation_id:a.user.current_operation_id}})},children:" Delete Instance"}):null})]}):null,Object(v.jsx)(w,{name:"Instance Name",onChange:function(e,t,a){r(t)},value:c,style:{paddingTop:"10px"}}),Object(v.jsx)(Rt,Object(o.a)(Object(o.a)({},e),{},{returnAllDictValues:!0,c2profileparameters:$,onChange:function(e,t,a,n){var i=$.map((function(e){return e.name===t?Object(o.a)(Object(o.a)({},e),{},{error:n,value:a}):e}));console.log(i),T(i)}}))]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(v.jsx)(m.a,{variant:"contained",onClick:function(){if(0!==c.length){var t=$.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,t.value))}),{});W({variables:{operation_id:a.user.current_operation_id,instance_name:c,c2profile_id:e.id,c2_instance:JSON.stringify(t)}})}else q.warning("Must supply an instance name")},color:"secondary",children:p.length>0?"Update":"Create"})]})]})}var Yt,Zt,Xt,ea=a(62),ta=a(64),aa=Object(h.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),na=Object(_.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Qe.a),ia=Object(Pe.a)(Yt||(Yt=Object(B.a)(["\nmutation StartStopProfile($id: Int!, $action: String) {\n  startStopProfile(id: $id, action: $action) {\n    status\n    error\n    output\n  }\n}\n"]))),ca=Object(Pe.a)(Zt||(Zt=Object(B.a)(["\nmutation setProfileConfiguration($id: Int!, $file_path: String!, $data: String!) {\n  uploadContainerFile(id: $id, file_path: $file_path, data: $data) {\n    status\n    error\n    filename\n  }\n}\n"])));function ra(e){var t=aa(),a=new Date,n=Object(ve.a)(),i=(a.getTime()+6e4*a.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning",c=l.a.useState(!1),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(!1),b=Object(j.a)(u,2),p=b[0],h=b[1],f=l.a.useRef(null),O=function(){h((function(e){return!e}))},x=function(e){f.current&&f.current.contains(e.target)||h(!1)},g=Object(Ee.a)(ia,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){F(e.startStopProfile.output),B(!0)}}),y=Object(j.a)(g,1)[0],_=function(){e.running?q.info("Submitting stop task..."):q.info("Submitting start task..."),y({variables:{id:e.id,action:e.running?"stop":"start"}})},k=l.a.useState(!1),w=Object(j.a)(k,2),C=w[0],S=w[1],D=l.a.useState(!1),I=Object(j.a)(D,2),$=I[0],T=I[1],P=l.a.useState(""),A=Object(j.a)(P,2),E=A[0],F=A[1],L=l.a.useState(!1),N=Object(j.a)(L,2),R=N[0],B=N[1],W=l.a.useState(!1),z=Object(j.a)(W,2),H=z[0],M=z[1],U=Object(Ee.a)(ca,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){"success"===e.uploadContainerFile.status?q.success("Updated file"):q.error("Error updating: "+e.uploadContainerFile.error)}}),V=Object(j.a)(U,1)[0];return Object(v.jsxs)(Ve.a,{className:t.root,elevation:5,style:{maxWidth:"100%"},children:[Object(v.jsx)(na,{overlap:"circle",classes:{badge:t[i]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.is_p2p?Object(v.jsx)(ea.a,{icon:ta.g,size:"6x",style:{width:"125px",height:"125px"}}):Object(v.jsx)(ut.a,{style:{width:"125px",height:"125px"}})}),Object(v.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(v.jsx)(Z.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block"},children:e.name}),Object(v.jsxs)(Ke.a,{style:{textAlign:"left"},children:[Object(v.jsxs)(Z.a,{variant:"body1",component:"p",children:[Object(v.jsx)("b",{children:"Author:"})," ",e.author]}),Object(v.jsxs)(Z.a,{variant:"body1",component:"p",children:[Object(v.jsx)("b",{children:"Supported Agents:"})," ",e.payloadtypec2profiles.map((function(e){return e.payloadtype.ptype+" "}))]}),Object(v.jsx)(Z.a,{variant:"body2",component:"p",children:e.description}),Object(v.jsx)(Z.a,{variant:"body2",component:"p",children:e.translation_container?Object(v.jsxs)(Z.a,{variant:"body1",component:"p",children:[Object(v.jsx)("b",{children:"Translation Container:"})," ",e.translation_container]}):null})]})]}),Object(v.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(v.jsx)(m.a,{size:"small",variant:"contained",color:"primary",href:"/docs/c2-profiles/"+e.name.toLowerCase(),target:"_blank",children:"Docs"}),Object(v.jsx)(m.a,{size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Build Info"}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:s,onClose:function(){d(!1)},innerDialog:Object(v.jsx)(ot,Object(o.a)(Object(o.a)({},e),{},{onClose:function(){d(!1)},payload_name:e.name}))}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:R,onClose:function(){B(!1)},innerDialog:Object(v.jsx)(kt,{output:E,onClose:function(){B(!1)},payload_name:e.name})}),e.container_running?e.running?Object(v.jsxs)(bt.a,{variant:"contained",color:e.running?"primary":"secondary",ref:f,"aria-label":"split button",children:[Object(v.jsx)(m.a,{size:"small",onClick:_,style:{width:"100%"},children:"Stop Profile"}),Object(v.jsx)(m.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:O,children:Object(v.jsx)(pt.a,{})})]}):e.is_p2p?null:Object(v.jsxs)(bt.a,{variant:"contained",color:e.running?"primary":"secondary",ref:f,"aria-label":"split button",children:[Object(v.jsx)(m.a,{size:"small",onClick:_,style:{width:"100%"},children:"Start Profile"}),Object(v.jsx)(m.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:O,children:Object(v.jsx)(pt.a,{})})]}):Object(v.jsx)(m.a,{disabled:!0,color:"secondary",children:"Container Offline"}),Object(v.jsxs)(m.a,{size:"small",variant:"contained",color:"primary",onClick:function(){M(!0)},children:[Object(v.jsx)(Ct.a,{})," Saved Instances"]}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:C,onClose:function(){S(!1)},innerDialog:Object(v.jsx)(yt,Object(o.a)(Object(o.a)({},e),{},{payload_name:e.name,onClose:function(){S(!1)},profile_id:e.id}))}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:$,onClose:function(){T(!1)},innerDialog:Object(v.jsx)(vt,Object(o.a)(Object(o.a)({},e),{},{onConfigSubmit:function(t){V({variables:{id:e.id,file_path:"config.json",data:t}})},payload_name:e.name,onClose:function(){T(!1)},profile_id:e.id}))}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:H,onClose:function(){M(!1)},innerDialog:Object(v.jsx)(Jt,Object(o.a)(Object(o.a)({},e),{},{onClose:function(){M(!1)}}))}),Object(v.jsx)(ft.a,{open:p,anchorEl:f.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var a=t.TransitionProps,i=t.placement;return Object(v.jsx)(mt.a,Object(o.a)(Object(o.a)({},a),{},{style:{transformOrigin:"bottom"===i?"center top":"center bottom"},children:Object(v.jsx)(G.a,{style:{backgroundColor:"dark"===n.palette.type?n.palette.primary.dark:n.palette.primary.light,color:"white"},children:Object(v.jsx)(ht.a,{onClickAway:x,children:Object(v.jsxs)(xt.a,{id:"split-button-menu",children:[Object(v.jsx)(Ot.a,{onClick:function(){T(!0)},children:"View/Edit Config"},"dropdownprofile"+e.id+"menu1"),e.running?Object(v.jsx)(Ot.a,{onClick:function(){S(!0)},children:"View Stdout/Stderr"},"dropdownprofile"+e.id+"menu2"):null]})})})}))}})]})]})}var oa=Object(Pe.a)(Xt||(Xt=Object(B.a)(["\nsubscription getPayloadTypesSubscription {\n   c2profile(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   author\n   id\n   container_running\n   description\n   is_p2p\n   last_heartbeat\n   name\n   running\n   payloadtypec2profiles(order_by: {payloadtype: {ptype: asc}}) {\n     payloadtype {\n       ptype\n     }\n   }\n }\n}\n"])));function sa(e){var t=Object(nt.a)(oa,{fetchPolicy:"network-only"}).data,a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=Object(ve.a)();return Object(s.useEffect)((function(){c(void 0!==t?t.c2profile:[])}),[t]),Object(v.jsxs)("div",{style:{width:"49%",display:"inline-flex",flexDirection:"column",alignItems:"stretch",paddingLeft:"10px"},children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"C2 Profiles"})}),i.map((function(e){return Object(v.jsx)(ra,Object(o.a)({},e),"c2prof"+e.id)}))]})}var la,da=Object(h.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),ua=Object(_.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Qe.a);function ba(e){var t=da(),a=new Date,n=(a.getTime()+6e4*a.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(v.jsxs)(Ve.a,{className:t.root,elevation:5,children:[Object(v.jsx)(ua,{overlap:"circle",classes:{badge:t[n]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(v.jsx)(ea.a,{icon:ta.f,size:"6x",style:{width:"125px",height:"125px"}})}),Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.name}),e.payloadtypes.length>0?Object(v.jsxs)(Z.a,{variant:"body1",component:"p",children:[Object(v.jsx)("b",{children:"Translated Payload Types:"})," ",e.payloadtypes.map((function(e){return e.ptype})).join(", ")]}):null]})]})}var ja=Object(Pe.a)(la||(la=Object(B.a)(["\nsubscription getTranslationContainersSubscription {\n translationcontainer(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   name\n   id\n   container_running\n   last_heartbeat\n   payloadtypes(order_by: {ptype: asc}) {\n       ptype\n       id\n   }\n }\n}\n"])));function pa(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState([]),r=Object(j.a)(c,2),d=r[0],u=r[1],b=Object(nt.a)(ja).data,p=Object(ve.a)();return Object(s.useEffect)((function(){if(void 0!==b){var e=b.translationcontainer.filter((function(e){return 0===e.payloadtypes.length})),t=b.translationcontainer.filter((function(e){return e.payloadtypes.length>0}));i(e),u(t)}else i([])}),[b]),Object(v.jsxs)("div",{style:{width:"100%",display:"inline-flex",flexDirection:"column",alignItems:"stretch"},children:[n.length>0?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:p.pageHeader.main,color:p.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers Not Assigned to Payload Types"})}),n.map((function(e){return Object(v.jsx)(ba,Object(o.a)({},e),"translation_container"+e.id)}))]}):null,d.length>0?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:p.pageHeader.main,color:p.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers"})}),d.map((function(e){return Object(v.jsx)(ba,Object(o.a)({},e),"translation_container"+e.id)}))]}):null]})}function ha(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ct,{}),Object(v.jsx)(sa,{}),Object(v.jsx)(pa,{})]})}var ma,fa=a(899),Oa=a(870),xa=a(892),ga=a(859),ya=a(780);function _a(e){return Object(v.jsxs)("div",{children:[Object(v.jsx)(m.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(v.jsx)(m.a,{variant:"contained",color:"primary",onClick:e.finished,children:e.last?"Create Payload":"Next"})]})}var va,ka=Object(Pe.a)(ma||(ma=Object(B.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    id\n    supported_os\n  }\n}\n "])));function wa(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState([]),r=Object(j.a)(c,2),o=r[0],s=r[1];if(Object(Ae.a)(ka,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(R.a)(t),[a])}),[]);return[].concat(Object(R.a)(e),Object(R.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),s(a)},onError:function(e){console.error(e)}}).loading)return Object(v.jsx)("div",{children:Object(v.jsx)(ga.a,{})});return Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(v.jsx)("br",{}),Object(v.jsxs)(Dt.a,{children:[Object(v.jsx)(It.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(v.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(v.jsx)(ya.a,{children:"Target Operating System"})]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(_a,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){e.finished(n)}})]})}function Ca(e){return Object(v.jsxs)(M.a,{component:G.a,className:"mythicElement",children:[Object(v.jsx)(Z.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Build Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:e.buildParameters.map((function(t){return Object(v.jsx)(Nt,Object(o.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var Sa=Object(Pe.a)(va||(va=Object(B.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function Da(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(!1),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState([]),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Object(Ae.a)(Sa,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){console.log(e.prevData),i(e.prevData.payload_type),d(e.prevData.file_extension),h(e.prevData.supports_dynamic_loading);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(o.a)(Object(o.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(R.a)(t),Object(R.a)(n))}return Object(R.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(a)}else{i(t.payloadtype[0].ptype),d(t.payloadtype[0].file_extension),h(t.payloadtype[0].supports_dynamic_loading);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(R.a)(e),Object(R.a)(n))}return Object(R.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(n),console.log(n)}}}),y=g.loading,_=g.error,k=g.data;return y?Object(v.jsx)("div",{children:Object(v.jsx)(ga.a,{})}):_?(console.error(_),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(v.jsx)(It.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=k.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){d(a.file_extension),h(a.supports_dynamic_loading);var n=a.buildparameters.map((function(e){return console.log(e),"ChooseOne"===e.parameter_type?Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(R.a)(t),Object(R.a)(n))}return Object(R.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(t)},children:k.payloadtype.map((function(e){return Object(v.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(v.jsx)("br",{}),Object(v.jsx)(Ca,{onChange:function(e,t,a){var n=O.map((function(n){return n.name===e?Object(o.a)(Object(o.a)({},n),{},{value:t,error:a}):Object(o.a)({},n)}));x(n)},buildParameters:O}),Object(v.jsx)(_a,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=O.map((function(e){return{name:e.name,value:e.value}}));e.finished({payload_type:n,parameters:t,file_extension:s,supports_dynamic_loading:p,os:e.buildOptions})}})]})}function Ia(e){var t=Object(ve.a)();return Object(v.jsx)(he,{fullWidth:!1,maxWidth:"sm",open:e.open,onClose:function(){e.onClose()},innerDialog:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{children:e.title?e.title:"Are you sure?"}),void 0===e.dialogText?null:Object(v.jsx)(le.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:Object(v.jsx)(de.a,{children:e.dialogText})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:e.cancelText?e.cancelText:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.onSubmit(),e.onClose()},autoFocus:!0,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:e.acceptText?e.acceptText:"Remove"})]})]})})}var $a,Ta=a(779),Pa=a(787),Aa=a(866),Ea=a(867),Fa=a(893),La=a(864),qa=a(865),Na=Object(h.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}})),Ra=Object(Pe.a)($a||($a=Object(B.a)(["\nquery getCommands($payloadType: String!) {\n  command(where: {payloadtype: {ptype: {_eq: $payloadType}}, script_only: {_eq: false}, deleted: {_eq: false}}, order_by: {cmd: asc}) {\n    cmd\n    attributes\n    id\n    supported_ui_features\n    help_cmd\n    description\n    needs_admin\n  }\n}\n "])));function Ba(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState([]),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(!1),b=Object(j.a)(u,2),p=b[0],h=b[1],m=Object(Ae.a)(Ra,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type},onCompleted:function(){if(e.buildOptions.supports_dynamic_loading){var t=m.command.reduce((function(t,a){try{var n=JSON.parse(a.attributes);if(0===n.supported_os.length||n.supported_os.includes(e.buildOptions.os)){if(void 0!==n.builtin&&n.builtin)return[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},a),{},{disabled:!0,selected:!0,reason:"This command is builtin and must be included"})]);try{if(void 0!==n.load_only&&n.load_only)return[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},a),{},{disabled:!0,selected:!1,reason:"This command can only be loaded in once a callback is established"})]);var i=!0;if(void 0!==n.filter_by_build_parameter)for(var c=0,r=Object.entries(n.filter_by_build_parameter);c<r.length;c++)for(var s=Object(j.a)(r[c],2),l=s[0],d=s[1],u=0;u<e.buildOptions.parameters.length;u++)e.buildOptions.parameters[u].name===l&&e.buildOptions.parameters[u].value!==d&&(i=!1);if(i)return void 0!==n.suggested_command&&n.suggested_command?[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},a),{},{disabled:!1,selected:!0,reason:"This command is suggested to be included"})]):[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},a),{},{disabled:!1,selected:!1,reason:""})])}catch(b){console.error(b)}}return[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},a),{},{disabled:!0,selected:!1,reason:"This command isn't supported by the selected OS"})])}catch(b){return[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},a),{},{disabled:!1,selected:!1,reason:"Failed to parse command attributes"})])}}),[]);if(d(t),void 0!==e.prevData){var a=t.map((function(t){return e.prevData.includes(t.cmd)?Object(o.a)(Object(o.a)({},t),{},{selected:!0}):Object(o.a)(Object(o.a)({},t),{},{selected:!1})}));d(a)}}else{var n=m.command.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{selected:!0,disabled:!0,reason:"Agent doesn't support dynamic loading"})}));d(n)}}}).data;return Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Build Commands Into Agent"})," ",Object(v.jsx)("br",{}),Object(v.jsx)(Wa,{commands:s,payload_type:e.buildOptions.payload_type,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){for(var a=!1,n=0;n<t.length;n++)if(t[n].supported_ui_features.includes("callback_table:exit")){a=!0;break}if(a){var c=t.map((function(e){return e.cmd}));e.finished(c)}else h(!0),i(t)}}),Object(v.jsx)(Ia,{open:p,title:"No exit command selected, continue?",onClose:function(){return h(!1)},acceptText:"Accept",onSubmit:function(){var t=n.map((function(e){return e.cmd}));e.finished(t)}})]})}function Wa(e){var t=Na(),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState([]),d=Object(j.a)(r,2),u=d[0],b=d[1],p=l.a.useState([]),h=Object(j.a)(p,2),f=h[0],O=h[1],x=S(i,u),g=S(i,f),y=l.a.useState({}),_=Object(j.a)(y,2),k=_[0],w=_[1];function C(e,t){return e.filter((function(e){return void 0===t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}function S(e,t){return e.filter((function(e){return void 0!==t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}var D=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(R.a)(i);-1===a?n.push(t):n.splice(a,1),c(n)}};Object(s.useEffect)((function(){var t=e.commands.reduce((function(e,t){return t.selected?Object(R.a)(e):[].concat(Object(R.a)(e),[Object(o.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.selected?[].concat(Object(R.a)(e),[Object(o.a)({},t)]):Object(R.a)(e)}),[]);b(t),O(a)}),[e.commands]);var I=function(t){var a=e.commands.filter((function(e){return e.cmd===t.target.innerText}));a.length>0&&w(a[0])},$=function(e,a){return Object(v.jsxs)(G.a,{className:t.paper,style:{width:"100%",height:"calc(40vh)",overflow:"auto"},elevation:5,children:[Object(v.jsx)(La.a,{className:t.cardHeader,title:e}),Object(v.jsx)(qa.a,{}),Object(v.jsxs)(Ta.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[a.map((function(e){var t=e.cmd,a="transfer-list-item-".concat(t,"-label");return Object(v.jsx)("div",{onMouseEnter:I,children:Object(v.jsxs)(Pa.a,{style:{padding:0},disabled:e.disabled,role:"listitem",button:!0,onClick:D(e),children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(Fa.a,{disabled:e.disabled,checked:-1!==i.findIndex((function(e){return e.cmd===t})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":a}})}),Object(v.jsx)(Ea.a,{id:a,primary:t})]},t)},"commandtransfer"+t)})),Object(v.jsx)(Pa.a,{})]})]})};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)($t.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(v.jsx)($t.a,{item:!0,xs:5,children:$("Available Commands",u)}),Object(v.jsx)($t.a,{item:!0,children:Object(v.jsxs)($t.a,{container:!0,direction:"column",alignItems:"center",children:[Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&!t.selected?[].concat(Object(R.a)(e),[Object(o.a)({},t)]):Object(R.a)(e)}),[]),a=e.commands.reduce((function(e,t){return!t.disabled||t.selected?[].concat(Object(R.a)(e),[Object(o.a)({},t)]):Object(R.a)(e)}),[]);b(t),O(a)},disabled:0===u.length,"aria-label":"move all right",children:"\u226b"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){O(f.concat(x)),b(C(u,x)),c(C(i,x))},disabled:0===x.length,"aria-label":"move selected right",children:">"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){b(u.concat(g)),O(C(f,g)),c(C(i,g))},disabled:0===g.length,"aria-label":"move selected left",children:"<"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&t.selected?Object(R.a)(e):[].concat(Object(R.a)(e),[Object(o.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.disabled&&t.selected?[].concat(Object(R.a)(e),[Object(o.a)({},t)]):Object(R.a)(e)}),[]);b(t),O(a)},disabled:0===f.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(v.jsx)($t.a,{item:!0,xs:5,children:$("Commands Included",f)})]}),Object(v.jsx)($t.a,{container:!0,justify:"center",alignItems:"flex-start",className:t.root,children:Object(v.jsx)($t.a,{item:!0,xs:12,style:{height:"100%",marginBottom:"10px"},children:void 0!==k.cmd&&Object(v.jsxs)(G.a,{className:t.paper,style:{width:"100%"},elevation:5,children:[Object(v.jsx)(La.a,{className:t.cardHeader,title:Object(v.jsxs)(l.a.Fragment,{children:[k.cmd,Object(v.jsx)(m.a,{variant:"contained",color:"primary",href:"/docs/agents/"+e.payload_type+"/commands/"+k.cmd,style:{marginLeft:"10px",float:"right"},target:"_blank",children:"Documentation"})]})}),Object(v.jsx)(qa.a,{}),""!==k.reason?Object(v.jsxs)(Z.a,{variant:"body1",align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(v.jsxs)("b",{children:[k.disabled?"Disabled Reason: ":"Information: "," "]}),k.reason]}):null,Object(v.jsx)("br",{}),Object(v.jsxs)(Z.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(v.jsx)("b",{children:"Commandline Help: "}),k.help_cmd]}),Object(v.jsxs)(Z.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(v.jsx)("b",{children:"Needs Admin Permissions: "}),k.needs_admin?"True":"False"]}),Object(v.jsxs)(Z.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(v.jsx)("b",{children:"Description: "}),k.description]})]})})}),Object(v.jsx)(_a,{first:e.first,last:e.last,canceled:e.canceled,finished:function(){e.finished(f)}})]})}var za,Ha,Ma=a(868),Ua=Object(Pe.a)(za||(za=Object(B.a)(["\nquery getPayloadTypesC2ProfilesQuery($payloadType: String!, $operation_id: Int!) {\n  c2profile(where: {payloadtypec2profiles: {payloadtype: {ptype: {_eq: $payloadType}}}, deleted: {_eq: false}}) {\n    name\n    is_p2p\n    description\n    id\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n        instance_name\n    }\n  }\n}\n "]))),Va=Object(Pe.a)(Ha||(Ha=Object(B.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n      c2profile {\n          name\n      }\n    }\n    id\n    value\n  }\n}\n"])));function Ga(e){var t=Object(A.a)(I),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(""),s=Object(j.a)(r,2),d=s[0],u=s[1],b=Object(Ae.a)(Ua,{variables:{payloadType:e.buildOptions.payload_type,operation_id:t.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.map((function(t){if(void 0!==e.prevData)for(var a=0;a<e.prevData.length;a++)if(e.prevData[a].name===t.name){var n=e.prevData[a].c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=JSON.parse(e.default_value),a=e.value.map((function(e){var a=t.find((function(t){return t.name===e.name}));return void 0!==a?Object(o.a)(Object(o.a)(Object(o.a)({},a),e),{},{default_show:""!==e.value}):Object(o.a)(Object(o.a)({},e),{},{default_show:!1})})),n=t.reduce((function(e,t){return e.findIndex((function(e){return e.name===t.name}))>-1?Object(R.a)(e):[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{default_show:!1,key:"*"===t.name?"":t.name,value:t.default_value})])}),Object(R.a)(a));return Object(o.a)(Object(o.a)({},e),{},{value:n})}return e}));return n.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(o.a)(Object(o.a)({},t),{},{selected:!0,c2profileparameters:n})}var i=t.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Ut(e.format_string).gen();return Object(o.a)(Object(o.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(o.a)(Object(o.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name,default_show:t.default_show})])}),[]);return Object(o.a)(Object(o.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return""!==e.default_value&&n.setDate(n.getDate()+parseInt(e.default_value)),Object(o.a)(Object(o.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(o.a)(Object(o.a)({},e),{},{value:e.default_value})}return Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value})}));return i.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(o.a)(Object(o.a)({},t),{},{selected:!1,c2profileparameters:i})}));a.sort((function(e,t){return-t.name.localeCompare(e.name)})),c(a)},fetchPolicy:"no-cache"}),p=b.loading,h=b.error,m=function(e,t,a,n){var r=i.map((function(i){if(i.name===e){var c=i.c2profileparameters.map((function(e){return e.name===t?Object(o.a)(Object(o.a)({},e),{},{error:n,value:a}):e}));return Object(o.a)(Object(o.a)({},i),{},{c2profileparameters:c})}return i}));c(r)},f=Object(St.a)(Va,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(o.a)(Object(o.a)({},e),e.c2profileparameter);return"Dictionary"!==t.parameter_type&&"Array"!==t.parameter_type||(t.value=JSON.parse(t.value)),t}));t.sort((function(e,t){return e.name<t.name?-1:1}));var a=i.map((function(e){return t[0].c2profile.name===e.name?Object(o.a)(Object(o.a)({},e),{},{c2profileparameters:t}):e}));c(a)},onError:function(e){q.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),O=Object(j.a)(f,1)[0];return p?Object(v.jsx)("div",{children:Object(v.jsx)(ga.a,{})}):h?(console.error(h),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Select C2 Profiles"}),i.map((function(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Ma.a,{value:"top",control:Object(v.jsx)(K.a,{checked:e.selected,onChange:function(t){return function(e,t){var a=i.map((function(e){return t.name===e.name?Object(o.a)(Object(o.a)({},e),{},{selected:!e.selected}):e}));c(a)}(0,e)},inputProps:{"aria-label":"primary checkbox"},name:"active"}),label:e.name,labelPlacement:"top",style:{display:"inline"}}),e.c2profileparametersinstances.length>0&&e.selected?Object(v.jsxs)(Dt.a,{style:{width:"100%"},children:[Object(v.jsx)(Mt.a,{children:"Select an Existing Instance"}),Object(v.jsxs)(It.a,{style:{width:"100%",marginBottom:"10px"},value:d,label:"Select an Existing Instance",onChange:function(a){return function(e,a){if(u(e.target.value),""!==e.target.value){var n=i.map((function(e){return a.name===e.name&&(e.c2profileparameters=[]),e}));c(n),O({variables:{name:e.target.value,operation_id:t.user.current_operation_id}})}}(a,e)},children:[Object(v.jsx)(Ot.a,{value:"",children:"New Instance"}),e.c2profileparametersinstances.map((function(e,t){return Object(v.jsx)(Ot.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]}):null,Object(v.jsx)(Z.a,{variant:"body1",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:e.description},"step4desc"+e.id),e.selected?Object(v.jsx)(Rt,Object(o.a)(Object(o.a)({returnAllDictValues:!1},e),{},{onChange:m}),"step4table"+e.id):null]},"step4c2switch"+e.id)})),Object(v.jsx)("br",{}),Object(v.jsx)(_a,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=!0,a=!1,n=i.reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=e.value.filter((function(e){return""!==e.value}));return Object(o.a)(Object(o.a)({},e),{},{value:t})}return Object(o.a)({},e)}));return[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{c2profileparameters:a})])}return[].concat(Object(R.a)(e),[Object(o.a)({},t)])}),[]);if(i.forEach((function(e){e.selected&&(a=!0,e.c2profileparameters.forEach((function(a){a.error&&(q.warning(e.name+"'s parameter "+a.name+" is invalid"),t=!1)})))})),t){if(!a)return void q.warning("Must select at least one C2 to include");e.finished(n)}}}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{})]})}var Ka,Qa,Ja=a(869),Ya=a(120),Za=a.n(Ya),Xa=a(81),en=a.n(Xa),tn=a(82),an=a.n(tn),nn=Object(Pe.a)(Ka||(Ka=Object(B.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),cn=Object(h.a)((function(e){return{root:Object(b.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),rn=l.a.forwardRef((function(e,t){var a=Object(ve.a)(),n=cn(a),i=Object(E.c)().closeSnackbar,c=Object(s.useState)(!0),r=Object(j.a)(c,2),o=r[0],l=r[1];return Object(v.jsx)(E.a,{ref:t,className:n.root,children:Object(v.jsxs)(Ve.a,{style:{backgroundColor:a.palette.success.main},children:[Object(v.jsxs)(Ja.a,{classes:{root:n.actionRoot},children:[Object(v.jsx)(Z.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(v.jsxs)("div",{className:n.icons,children:[Object(v.jsx)(Y.a,{"aria-label":"Show more",className:Object(p.default)(n.expand,Object(b.a)({},n.expandOpen,o)),onClick:function(){l(!o)},children:Object(v.jsx)(en.a,{})}),Object(v.jsx)(Y.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(v.jsx)(Za.a,{})})]})]}),Object(v.jsxs)(J.a,{in:o,timeout:"auto",unmountOnExit:!0,children:[Object(v.jsxs)(G.a,{className:n.collapse,children:[Object(v.jsx)(Z.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(v.jsxs)(m.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(v.jsx)(an.a,{className:n.checkIcon}),"Download now"]})]}),Object(v.jsx)(G.a,{className:n.collapse,children:Object(v.jsx)(m.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),on=l.a.forwardRef((function(e,t){var a=Object(ve.a)(),n=cn(a),i=Object(E.c)().closeSnackbar,c=Object(s.useState)(!1),r=Object(j.a)(c,2),o=r[0],l=r[1];return Object(v.jsx)(E.a,{ref:t,className:n.root,children:Object(v.jsxs)(Ve.a,{style:{backgroundColor:a.palette.error.main},children:[Object(v.jsxs)(Ja.a,{classes:{root:n.actionRoot},children:[Object(v.jsx)(Z.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(v.jsxs)("div",{className:n.icons,children:[Object(v.jsx)(Y.a,{"aria-label":"Show more",className:Object(p.default)(n.expand,Object(b.a)({},n.expandOpen,o)),onClick:function(){l(!o)},children:Object(v.jsx)(en.a,{})}),Object(v.jsx)(Y.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(v.jsx)(Za.a,{})})]})]}),Object(v.jsx)(J.a,{in:o,timeout:"auto",unmountOnExit:!0,children:Object(v.jsx)(G.a,{className:n.collapse,children:e.display})})]})})}));function sn(e){var t=l.a.useState((new Date).toISOString()),a=Object(j.a)(t,2),n=a[0],i=(a[1],Object(nt.a)(nn,{variables:{fromNow:n}})),c=i.loading,r=i.error,o=i.data;return Object(s.useEffect)((function(){console.log(o),!c&&!r&&o&&o.payload.length>0?"success"===o.payload[0].build_phase?(q.dismiss(),q.success(o.payload[0].build_message,{persist:!0,content:function(e){return Object(v.jsx)(rn,{id:e,file_id:o.payload[0].filemetum.agent_file_id})}})):"building"===o.payload[0].build_phase||(""!==o.payload[0].build_stderr?q.error(o.payload[0].build_stderr,{persist:!0,content:function(e){return Object(v.jsx)(on,{id:e,display:o.payload[0].build_stderr})}}):q.error(o.payload[0].build_message,{persist:!0,content:function(e){return Object(v.jsx)(on,{id:e,display:o.payload[0].build_message})}})):r&&(console.log(r),q.error("Mythic encountered an error: "+r.toString()))}),[c,o,r]),null}var ln,dn=Object(Pe.a)(Qa||(Qa=Object(B.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function un(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),d=r[0],u=r[1],p=Object(Ee.a)(dn,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?q.info("Submitted payload to build pipeline"):q.error(a.createPayload.error)}}),h=Object(j.a)(p,1)[0];Object(s.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);return Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(v.jsx)("br",{}),Object(v.jsx)(w,{required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(v.jsx)(w,{required:!1,placeholder:"description",value:d,multiline:!1,onChange:function(e,t,a){u(t)},display:"inline-block"}),Object(v.jsx)(_a,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a=e.buildOptions[3].reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.reduce((function(e,t){if("Dictionary"===t.parameter_type){var a=t.value.map((function(e){return{name:e.name,key:e.key,value:e.value,custom:e.custom}}));return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,a))}return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,t.value))}),{});return[].concat(Object(R.a)(e),[{c2_profile:t.name,c2_profile_parameters:a}])}return e}),[]),i={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:d,commands:e.buildOptions[2],build_parameters:t,c2_profiles:a};h({variables:{payload:JSON.stringify(i)}}).catch((function(e){console.log(e)}))}}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(sn,{})]})}function bn(e){var t=l.a.useState({}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=function(e){i(Object(o.a)(Object(o.a)({},n),{},Object(b.a)({},s,e))),m()},p=function(){f()},h=["Select Target OS","Payload Type","Select Commands","Select C2 Profiles","Build"],m=function(){d((function(e){return e+1}))},f=function(){d((function(e){return e-1}))};return Object(v.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(v.jsx)(fa.a,{activeStep:s,alternativeLabel:!0,children:h.map((function(e,t){return Object(v.jsx)(Oa.a,{children:Object(v.jsx)(xa.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(v.jsx)(wa,{buildOptions:n,prevData:n[0],finished:u,canceled:p,first:!0,last:!1});case 1:return Object(v.jsx)(Da,{buildOptions:n[0],prevData:n[1],finished:u,canceled:p,first:!1,last:!1});case 2:return Object(v.jsx)(Ba,{buildOptions:n[1],prevData:n[2],finished:u,canceled:p,first:!1,last:!1});case 3:return Object(v.jsx)(Ga,{buildOptions:n[1],prevData:n[3],finished:u,canceled:p,first:!1,last:!1});case 4:return Object(v.jsx)(un,{buildOptions:n,canceled:p,first:!1,last:!0});default:return"Unknown step"}}(s)]})}function jn(e){return Object(v.jsxs)("div",{children:[Object(v.jsx)(m.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(v.jsx)(m.a,{variant:"contained",color:"primary",onClick:e.finished,disabled:e.disableNext,children:e.last?"Create Payload":"Next"})]})}var pn,hn=Object(Pe.a)(ln||(ln=Object(B.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    id\n    supported_os\n  }\n}\n "])));function mn(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState([]),r=Object(j.a)(c,2),o=r[0],s=r[1];if(Object(Ae.a)(hn,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(R.a)(t),[a])}),[]);return[].concat(Object(R.a)(e),Object(R.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),s(a)},onError:function(e){console.error(e)}}).loading)return Object(v.jsx)("div",{children:Object(v.jsx)(ga.a,{})});return Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(v.jsx)("br",{}),Object(v.jsxs)(Dt.a,{children:[Object(v.jsx)(It.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(v.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(v.jsx)(ya.a,{children:"Target Operating System"})]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(jn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){e.finished(n)}})]})}function fn(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,c=e.required,r=e.verifier_regex,d=e.id,u=e.description,p=e.value,h=e.returnAllDictValues,f=l.a.useState(""),O=Object(j.a)(f,2),x=O[0],g=O[1],y=Object(ve.a)(),_=l.a.useState([]),k=Object(j.a)(_,2),C=k[0],S=k[1],D=l.a.useState([]),I=Object(j.a)(D,2),$=I[0],T=I[1],P=l.a.useState([]),A=Object(j.a)(P,2),E=A[0],F=A[1],L=l.a.useState(""),q=Object(j.a)(L,2),N=q[0],B=q[1],W=l.a.useState([]),z=Object(j.a)(W,2),M=z[0],U=z[1],G=l.a.useState(new Date),K=Object(j.a)(G,2),Q=K[0],J=K[1],X=function(e){var a=e.map((function(e){return h?{custom:"*"===e.name,key:e.key,name:e.name,value:e.value}:Object(b.a)({},e.key,e.value)}));t(i,a,!1)};Object(s.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");g(e[0]),U(e)}""!==p&&void 0!==p&&(g(p),t(i,p,""))}else if("Date"===a){if(""!==n){var c=new Date;c.setDate(c.getDate()+parseInt(n)),ce(c),g(-1)}""!==p&&void 0!==p&&p.includes("-")&&(console.log("passed date value: ",p),J(new Date(p)),g(-1),t(i,new Date(p).toISOString().slice(0,10),""))}else if("Dictionary"===a){var r=JSON.parse(n);T(r);var s=r.reduce((function(e,t){return t.default_show?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(R.a)(e)}),[]);X(s),S(s);var l=r.reduce((function(e,t){var a=s.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(R.a)(e)}),[]);F(l),l.length>0&&B(l[0]),""!==p&&void 0!==p&&"object"===typeof p&&(S(p),X(p))}else void 0!==n&&g(n),""!==p&&void 0!==p&&(g(p),t(i,p,""))}),[n,a,i]);var ee=function(e){g(e.target.value),t(i,e.target.value,!1)},te=function(e,a,n){g(a),t(e,a,n)},ae=function(e){return(c&&""!==r||""!==r&&""!==e)&&!RegExp(r).test(e)},ne=function(){var e=N;S([].concat(Object(R.a)(C),[e]));var t=E.reduce((function(t,a){var n=C.reduce((function(e,t){return t.name===a.name?e+1:e}),0);return e.name===a.name&&(n+=1),-1===a.max||a.max>n?[].concat(Object(R.a)(t),[Object(o.a)({},a)]):Object(R.a)(t)}),[]);X(t),F(t),t.length>0&&B(t[0])},ce=function(e){J(e),t(i,e.toISOString().slice(0,10),"")},re=l.a.useState(null),oe=Object(j.a)(re,2),se=oe[0],le=oe[1],de=Boolean(se),ue=function(){le(null)};return Object(v.jsxs)(V.a,{children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Z.a,{"aria-haspopup":"true",onMouseEnter:function(e){le(e.currentTarget)},onMouseLeave:ue,"aria-owns":de?"taskparam"+d+"popover":void 0,children:u}),Object(v.jsx)(qt.a,{id:"taskparam"+d+"popover",open:de,anchorEl:se,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:ue,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===y.palette.type?y.palette.primary.dark:y.palette.primary.light,color:"white"},variant:"outlined"},children:Object(v.jsx)(Z.a,{children:i.length>0?i:"No Description"})})]}),Object(v.jsx)(H.a,{children:function(){switch(a){case"Date":return Object(v.jsx)(Et.a,{utils:Lt.a,children:Object(v.jsx)($t.a,{container:!0,justify:"flex-start",children:Object(v.jsx)(Ft.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:Q,onChange:ce,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:x,onChange:ee,children:M.map((function(e,t){return Object(v.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(v.jsxs)(l.a.Fragment,{children:[C.map((function(e,t){return Object(v.jsxs)("div",{children:[Object(v.jsxs)(Y.a,{onClick:function(e){!function(e){var t=C[e],a=C.filter((function(t,a){return e!==a}));S(a);var n=$.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},n),{},{value:n.default_value,key:"*"===n.name?"":n.name})]):Object(R.a)(e)}),[]);X(n),F(n),n.length>0&&B(n[0])}(t)},children:[Object(v.jsx)(ie.a,{style:{color:y.palette.error.main}})," "]}),"*"===e.name?Object(v.jsx)(Tt.a,{style:{width:"20%"},startAdornment:Object(v.jsx)(m.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=C.map((function(a,n){return n===t?Object(o.a)(Object(o.a)({},a),{},{key:e.target.value}):Object(o.a)({},a)}));X(a),S(a)}(e,t)}}):Object(v.jsx)(Tt.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(v.jsx)(m.a,{disabled:!0,children:"key"}),value:e.key}),Object(v.jsx)(Tt.a,{style:{width:"75%"},startAdornment:Object(v.jsx)(m.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=C.map((function(a,n){return n===t?Object(o.a)(Object(o.a)({},a),{},{value:e.target.value}):Object(o.a)({},a)}));X(a),S(a)}(e,t)}})]},"dictval"+t)})),E.length>0?Object(v.jsxs)("div",{children:[Object(v.jsxs)(Y.a,{onClick:ne,children:[" ",Object(v.jsx)(At.a,{style:{color:y.palette.success.main}})," "]}),Object(v.jsx)(It.a,{size:"small",value:N,onChange:function(e){return B(e.target.value)},children:E.map((function(e,t){return Object(v.jsx)(Ot.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+"i")}))})]}):null]});case"String":return Object(v.jsx)(w,{required:c,value:x,multiline:!0,onChange:te,display:"inline-block",name:i,validate:ae,errorText:"Must match: "+r});default:return null}}()})]},"buildparam"+d)}function On(e){return Object(v.jsxs)(M.a,{component:G.a,className:"mythicElement",children:[Object(v.jsx)(Z.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Build Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:e.buildParameters.map((function(t){return Object(v.jsx)(fn,Object(o.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var xn,gn=Object(Pe.a)(pn||(pn=Object(B.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function yn(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState([]),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Object(Ae.a)(gn,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){i(e.prevData.payload_type),d(e.prevData.payload_type_id),h(e.prevData.file_extension);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(o.a)(Object(o.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(R.a)(t),Object(R.a)(n))}return Object(R.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(a)}else{i(t.payloadtype[0].ptype),d(t.payloadtype[0].id),h(t.payloadtype[0].file_extension);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(R.a)(e),Object(R.a)(n))}return Object(R.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(n)}}}),y=g.loading,_=g.error,k=g.data;return y?Object(v.jsx)("div",{children:Object(v.jsx)(ga.a,{})}):_?(console.error(_),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(v.jsx)(It.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=k.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){h(a.file_extension),d(a.id);var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(o.a)(Object(o.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(R.a)(t),Object(R.a)(n))}return Object(R.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(t)},children:k.payloadtype.map((function(e){return Object(v.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(v.jsx)("br",{}),Object(v.jsx)(On,{onChange:function(e,t,a){var n=O.map((function(n){return n.name===e?Object(o.a)(Object(o.a)({},n),{},{value:t,error:a}):Object(o.a)({},n)}));x(n)},buildParameters:O}),Object(v.jsx)(jn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=O.map((function(e){return{name:e.name,value:e.value}}));e.finished({payload_type:n,parameters:t,payload_type_id:s,file_extension:p,os:e.buildOptions})}})]})}var _n=Object(Pe.a)(xn||(xn=Object(B.a)(["\nquery GetPayloadDetails($payload_id: Int!, $operation_id: Int!) {\n  payload(where: {id: {_eq: $payload_id}, operation_id: {_eq: $operation_id}}) {\n    uuid\n    wrapped_payload_id\n    payloadtype{\n        ptype\n    }\n    payloadcommands {\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    filemetum {\n      filename_text\n      agent_file_id\n      id\n      md5\n      sha1\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        description\n      }\n    }\n    os\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n  }\n}\n"])));function vn(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Payload Configuration"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(kn,Object(o.a)({},e))}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function kn(e){var t=Object(A.a)(I),a=Object(ve.a)(),n=l.a.useState([]),i=Object(j.a)(n,2),c=i[0],r=i[1],s=l.a.useState([]),d=Object(j.a)(s,2),u=d[0],p=d[1],h=l.a.useState([]),f=Object(j.a)(h,2),O=f[0],x=f[1],g=Object(Ae.a)(_n,{variables:{payload_id:e.payload_id,operation_id:t.user.current_operation_id},onCompleted:function(e){var t=e.payload[0].payloadcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));r(t);var a=e.payload[0].buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));p(a);var n=e.payload[0].c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[].concat(Object(R.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),i=Object.keys(n).reduce((function(e,t){return[].concat(Object(R.a)(e),[{c2_profile:t,parameters:n[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);x(i)}}),y=g.loading,_=g.error,k=g.data;return y?Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}}):_?(console.error(_),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Payload Information"})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Payload Info"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsxs)(z.a,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Payload Type"}),Object(v.jsx)(H.a,{children:k.payload[0].payloadtype.ptype})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Selected OS"}),Object(v.jsx)(H.a,{children:k.payload[0].os})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"UUID"}),Object(v.jsx)(H.a,{children:k.payload[0].uuid})]}),k.payload[0].filemetum?Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Filename"}),Object(v.jsx)(H.a,{children:k.payload[0].filemetum.filename_text})]},"filename_text"):null,Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Download URL"}),Object(v.jsx)(H.a,{children:window.location.origin+"/direct/download/"+k.payload[0].filemetum.agent_file_id})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"SHA1"}),Object(v.jsx)(H.a,{children:k.payload[0].filemetum.sha1})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"MD5"}),Object(v.jsx)(H.a,{children:k.payload[0].filemetum.md5})]})]})]}),Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Build Parameters"})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"30%"},children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:u.map((function(t,a){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:t.description}),Object(v.jsx)(H.a,{children:t.value})]},"buildprop"+a+"for"+e.payload_id)}))})]}),O.map((function(t){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:t.c2_profile})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"30%"},children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{style:{whiteSpace:"pre"},children:t.parameters.map((function(a,n){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:a.description}),Object(v.jsxs)(H.a,{children:["Dictionary"===a.parameter_type?JSON.stringify(JSON.parse(a.value),null,2):a.value,null===a.enc_key?null:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)("br",{}),Object(v.jsx)("b",{children:"Encryption Key: "})," ",a.enc_key]}),null===a.dec_key?null:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)("br",{}),Object(v.jsx)("b",{children:"Decryption Key: "})," ",a.dec_key]})]})]},"c2frag"+e.payload_id+t.c2_profile+n)}))})]})]},"c2frag"+e.payload_id+t.c2_profile)})),c.length>0&&Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Loaded Commands"})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Command Name"}),Object(v.jsx)(H.a,{children:"Mythic Version"}),Object(v.jsx)(H.a,{children:"Loaded Version"}),Object(v.jsx)(H.a,{children:"Documentation"})]})}),Object(v.jsx)(z.a,{children:c.map((function(t){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:t.cmd}),Object(v.jsx)(H.a,{children:t.mythic}),Object(v.jsx)(H.a,{children:t.payload}),Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+k.payload[0].payloadtype.ptype+"/commands/"+t.cmd,children:"Docs"})})]},t.cmd+e.payload_id)}))})]})]}),null!==k.payload[0].wrapped_payload_id&&Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Wrapped Payload Information"})}),Object(v.jsx)(kn,{payload_id:k.payload[0].wrapped_payload_id})]})]})}var wn,Cn,Sn=a(183),Dn=a.n(Sn),In=Object(h.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}})),$n=Object(Pe.a)(wn||(wn=Object(B.a)(['\nquery getWrappablePayloads($payloadType: Int!) {\n  payloadtype_by_pk(id: $payloadType) {\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n        payloads(where: {auto_generated: {_eq: false}, build_phase: {_eq: "success"}, deleted: {_eq: false}}) {\n          id\n          tag\n          uuid\n          creation_time\n          filemetum {\n            agent_file_id\n            filename_text\n            id\n          }\n        }\n      }\n    }\n  }\n}\n '])));function Tn(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)($n,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type_id},onCompleted:function(){if(c.payloadtype_by_pk.wrap_these_payload_types.length>0){for(var e=[],t=0;t<c.payloadtype_by_pk.wrap_these_payload_types.length;t++)for(var a=0;a<c.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads.length;a++)e.push(Object(o.a)({ptype:c.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.ptype},c.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads[a]));i(e)}else q.warning("No supported payload for that wrapper")}}).data;return Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Wrap Agent Into New Payload"})," ",Object(v.jsx)("br",{}),Object(v.jsx)(Pn,{payloadOptions:n,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){void 0!==t.uuid?e.finished(t.uuid):q.error("Can't continue without selecting a payload")}})]})}function Pn(e){In();var t=function(t){e.finished(t)};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(M.a,{component:G.a,children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"4rem"},children:" Select"}),Object(v.jsx)(H.a,{style:{width:"15rem"},children:"Timestamp"}),Object(v.jsx)(H.a,{children:"File"}),Object(v.jsx)(H.a,{children:"Description"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Details"})]})}),Object(v.jsx)(z.a,{children:e.payloadOptions.map((function(e){return Object(v.jsx)(An,{onSelected:t,payload:e},"payload"+e.id)}))})]})}),Object(v.jsx)("div",{style:{paddingTop:"20px"},children:Object(v.jsx)(jn,{disableNext:!0,first:e.first,last:e.last,canceled:e.canceled,finished:t})})]})}function An(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(A.a)(I);return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{size:"small",onClick:function(){e.onSelected(e.payload)},color:"primary",variant:"contained",children:"Select"})}),Object(v.jsx)(H.a,{children:xe(e.payload.creation_time,c.user.view_utc_time)}),Object(v.jsx)(H.a,{children:e.payload.filemetum.filename_text}),Object(v.jsx)(H.a,{children:e.payload.tag}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Y.a,{size:"small",color:"primary",onClick:function(){return i(!0)},children:Object(v.jsx)(Dn.a,{})})})]},"payload"+e.payload.uuid),Object(v.jsx)(V.a,{children:n?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(v.jsx)(vn,Object(o.a)(Object(o.a)({},e),{},{payload_id:e.payload.id,onClose:function(){i(!1)}}))}):null})]})}var En,Fn=Object(Pe.a)(Cn||(Cn=Object(B.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),Ln=Object(h.a)((function(e){return{root:Object(b.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),qn=l.a.forwardRef((function(e,t){var a=Object(ve.a)(),n=Ln(a),i=Object(E.c)().closeSnackbar,c=Object(s.useState)(!0),r=Object(j.a)(c,2),o=r[0],l=r[1];return Object(v.jsx)(E.a,{ref:t,className:n.root,children:Object(v.jsxs)(Ve.a,{style:{backgroundColor:a.palette.success.main},children:[Object(v.jsxs)(Ja.a,{classes:{root:n.actionRoot},children:[Object(v.jsx)(Z.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(v.jsxs)("div",{className:n.icons,children:[Object(v.jsx)(Y.a,{"aria-label":"Show more",className:Object(p.default)(n.expand,Object(b.a)({},n.expandOpen,o)),onClick:function(){l(!o)},children:Object(v.jsx)(en.a,{})}),Object(v.jsx)(Y.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(v.jsx)(Za.a,{})})]})]}),Object(v.jsxs)(J.a,{in:o,timeout:"auto",unmountOnExit:!0,children:[Object(v.jsxs)(G.a,{className:n.collapse,children:[Object(v.jsx)(Z.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(v.jsxs)(m.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(v.jsx)(an.a,{className:n.checkIcon}),"Download now"]})]}),Object(v.jsx)(G.a,{className:n.collapse,children:Object(v.jsx)(m.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),Nn=l.a.forwardRef((function(e,t){var a=Object(ve.a)(),n=Ln(a),i=Object(E.c)().closeSnackbar,c=Object(s.useState)(!1),r=Object(j.a)(c,2),o=r[0],l=r[1];return Object(v.jsx)(E.a,{ref:t,className:n.root,children:Object(v.jsxs)(Ve.a,{style:{backgroundColor:a.palette.error.main},children:[Object(v.jsxs)(Ja.a,{classes:{root:n.actionRoot},children:[Object(v.jsx)(Z.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(v.jsxs)("div",{className:n.icons,children:[Object(v.jsx)(Y.a,{"aria-label":"Show more",className:Object(p.default)(n.expand,Object(b.a)({},n.expandOpen,o)),onClick:function(){l(!o)},children:Object(v.jsx)(en.a,{})}),Object(v.jsx)(Y.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(v.jsx)(Za.a,{})})]})]}),Object(v.jsx)(J.a,{in:o,timeout:"auto",unmountOnExit:!0,children:Object(v.jsx)(G.a,{className:n.collapse,children:e.display})})]})})}));function Rn(e){var t=l.a.useState((new Date).toISOString()),a=Object(j.a)(t,2),n=a[0],i=(a[1],Object(nt.a)(Fn,{variables:{fromNow:n}})),c=i.loading,r=i.error,o=i.data;return Object(s.useEffect)((function(){!c&&!r&&o&&o.payload.length>0?"success"===o.payload[0].build_phase?(q.dismiss(),q.success(o.payload[0].build_message,{persist:!0,content:function(e){return Object(v.jsx)(qn,{id:e,file_id:o.payload[0].filemetum.agent_file_id})}})):"building"===o.payload[0].build_phase?q.info("Building payload ".concat(o.payload[0].uuid,"..."),{autoHideDuration:5e3}):""!==o.payload[0].build_error?q.error(o.payload[0].build_stderr,{persist:!0,content:function(e){return Object(v.jsx)(Nn,{id:e,display:o.payload[0].build_stderr})}}):q.error(o.payload[0].build_message,{persist:!0,content:function(e){return Object(v.jsx)(Nn,{id:e,display:o.payload[0].build_message})}}):r&&(console.log(r),q.error("Mythic encountered an error: "+r.toString()))}),[c,o,r]),null}var Bn=Object(Pe.a)(En||(En=Object(B.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function Wn(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),o=r[0],d=r[1],u=Object(Ee.a)(Bn,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?q.info("Submitted payload to build pipeline"):q.error(a.createPayload.error)}}),b=Object(j.a)(u,1)[0];Object(s.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);return Object(v.jsxs)("div",{children:[Object(v.jsx)(Z.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(v.jsx)("br",{}),Object(v.jsx)(w,{required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(v.jsx)(w,{required:!1,placeholder:"description",value:o,multiline:!1,onChange:function(e,t,a){d(t)},display:"inline-block"}),Object(v.jsx)(jn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:o,commands:[],build_parameters:t,c2_profiles:[],wrapper:!0,wrapped_payload:e.buildOptions[2]};b({variables:{payload:JSON.stringify(a)}}).catch((function(e){console.log(e)}))}}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(Rn,{})]})}function zn(e){var t=l.a.useState({}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=function(e){i(Object(o.a)(Object(o.a)({},n),{},Object(b.a)({},s,e))),m()},p=function(){f()},h=["Select Target OS","Payload Type","Select Payload","Build"],m=function(){d((function(e){return e+1}))},f=function(){d((function(e){return e-1}))};return Object(v.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(v.jsx)(fa.a,{activeStep:s,alternativeLabel:!0,children:h.map((function(e,t){return Object(v.jsx)(Oa.a,{children:Object(v.jsx)(xa.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(v.jsx)(mn,{buildOptions:n,prevData:n[0],finished:u,canceled:p,first:!0,last:!1});case 1:return Object(v.jsx)(yn,{buildOptions:n[0],prevData:n[1],finished:u,canceled:p,first:!1,last:!1});case 2:return Object(v.jsx)(Tn,{buildOptions:n[1],prevData:n[2],finished:u,canceled:p,first:!1,last:!1});case 3:return Object(v.jsx)(Wn,{buildOptions:n,canceled:p,first:!1,last:!0});default:return"Unknown step"}}(s)]})}var Hn=a(872),Mn=a(902),Un=a(439),Vn=a.n(Un),Gn=a(433),Kn=a(871);function Qn(e){var t=l.a.useState(null),a=Object(j.a)(t,2),n=a[0],i=a[1],c=function(){r(),e.onUpdateResolution({id:e.id,resolved:!e.resolved})},r=function(){i(null)},o=l.a.useCallback((function(e){i(e.currentTarget)}),[]);return Object(v.jsxs)(Kn.a,{children:[Object(v.jsx)(Y.a,{"aria-controls":"eventmenu"+e.id,"aria-haspopup":"true",onClick:o,children:Object(v.jsx)(Vn.a,{})}),Object(v.jsxs)(Gn.a,{elevation:5,id:"eventmenu"+e.id,anchorEl:n,open:Boolean(n),onClose:r,children:["warning"===e.level&&e.resolved?Object(v.jsx)(Ot.a,{onClick:c,children:"Unresolve"}):"warning"!==e.level||e.resolved?Object(v.jsx)(Ot.a,{onClick:function(){r(),e.onUpdateLevel({id:e.id})},children:"Make Warning"}):Object(v.jsx)(Ot.a,{onClick:c,children:"Resolve"}),Object(v.jsx)(Ot.a,{onClick:function(){r(),e.getSurroundingEvents({id:e.id})},children:"Get Surrounding Events"}),Object(v.jsxs)(Ot.a,{onClick:function(){r(),e.onUpdateDeleted({id:e.id})},children:[Object(v.jsx)(ie.a,{}),"Delete"]})]})]})}var Jn=Object(h.a)((function(e){return{root:{width:"100%",maxWidth:"36ch"},inline:{display:"inline"}}}));function Yn(e){var t=Jn(),a=Object(ve.a)(),n=Object(A.a)(I);return Object(v.jsxs)(Pa.a,{alignItems:"flex-start",style:Object(o.a)({},e.style),children:[Object(v.jsx)(Hn.a,{children:Object(v.jsx)(Mn.a,{children:e.operator?e.operator.username[0]:"M"})}),Object(v.jsx)(Ea.a,{disableTypography:!0,primary:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(Z.a,{component:"span",variant:"body1",className:t.inline,style:{fontWeight:"bold",margin:0,padding:0},children:[e.operator?e.operator.username:"Mythic",e.count>1?" ( "+e.count+" )":""]}),Object(v.jsx)(Z.a,{component:"span",variant:"caption",className:t.inline,style:{margin:"0 0 0 10px"},children:xe(e.timestamp,n.user.view_utc_time)})]}),secondary:Object(v.jsx)("pre",{style:{overflowX:"auto",width:"max-content",maxWidth:"97%",margin:"0 0 0 0",borderRadius:"9px",padding:"5px",backgroundColor:"warning"===e.level&&e.resolved?a.palette.textBackgroundColorSuccess:"warning"!==e.level||e.resolved?e.operator?a.palette.textBackgroundColor:a.palette.textBackgroundColorMythic:a.palette.textBackgroundColorError},children:e.message}),style:{}}),Object(v.jsx)(Qn,{id:e.id,level:e.level,onUpdateDeleted:e.onUpdateDeleted,onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,getSurroundingEvents:e.getSurroundingEvents,resolved:e.resolved})]})}var Zn=a(263),Xn=a.n(Zn);function ei(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=function(t){t.preventDefault(),n&&n.length>0&&(e.onSubmitMessage(n),i(""))};return Object(v.jsx)("div",{style:{padding:"0",margin:"0",position:"absolute",bottom:0,width:"100%"},children:Object(v.jsx)("form",{onSubmit:c,children:Object(v.jsx)(y.a,{InputProps:{endAdornment:Object(v.jsx)(Y.a,{color:"primary",variant:"contained",onClick:c,children:Object(v.jsx)(Xn.a,{})})},fullWidth:!0,size:"small",style:{padding:0,margin:0},variant:"outlined",value:n,onChange:function(e){e.preventDefault(),i(e.target.value)},label:"Type Message..."})})})}var ti,ai,ni,ii,ci,ri,oi,si,li,di,ui=a(193),bi=a(184),ji=function(e){var t=e.data,a=e.index,n=e.style,i=t[t.length-a-1];return Object(v.jsx)("div",{style:n,children:Object(v.jsx)(Yn,Object(o.a)({},i))})},pi=function(e){var t=e.onUpdateDeleted,a=e.onUpdateLevel,n=e.onUpdateResolution,i=e.getSurroundingEvents,c=e.operationeventlog,r=l.a.createRef(),d=function(e){return 75+20*(c[c.length-e-1].message.match(/\n/g)||[]).length},u=c.map((function(e){return Object(o.a)({onUpdateDeleted:t,onUpdateLevel:a,onUpdateResolution:n,getSurroundingEvents:i},e)}));return Object(s.useEffect)((function(){r.current&&r.current.resetAfterIndex(0)}),[c]),Object(v.jsx)(bi.a,{children:function(e){var t=e.height,a=e.width;return Object(v.jsx)(ui.b,{ref:r,height:t-50,itemData:u,itemCount:c.length,width:a,itemSize:d,overscanCount:20,children:ji})}})};function hi(e){var t=Object(s.useRef)(null),a=Object(ve.a)(),n=function(){t.current.scrollIntoView({behavior:"smooth"})};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(G.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operational Event Messages"}),Object(v.jsx)(m.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.loadMore()},children:"Load More Events"}),Object(v.jsx)(m.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.loadNextError()},children:"Load All Errors"}),Object(v.jsx)(m.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.resolveViewableErrors()},children:"Resolve Viewable Errors"}),Object(v.jsx)(m.a,{variant:"contained",color:"secondary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.resolveAllErrors()},children:"Resolve All Errors"})]}),Object(v.jsxs)(G.a,{elevation:5,style:{position:"relative",height:"calc(90vh)",backgroundColor:a.body},variant:"elevation",children:[Object(v.jsx)(pi,{onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,onUpdateDeleted:e.onUpdateDeleted,getSurroundingEvents:e.getSurroundingEvents,operationeventlog:e.operationeventlog}),Object(v.jsx)("div",{ref:t}),Object(v.jsx)(ei,{onSubmitMessage:function(t){t&&t.length>0&&(e.onSubmitMessage({level:"info",message:t}),n())}})]})]})}var mi=Object(Pe.a)(ti||(ti=Object(B.a)(["\nquery GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),fi=Object(Pe.a)(ai||(ai=Object(B.a)(["\nsubscription GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),Oi=Object(Pe.a)(ni||(ni=Object(B.a)(["\nquery GetSurroundingOperationEventLogs($operation_id: Int!, $lower_id: Int!, $upper_id: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, id: {_gt: $lower_id, _lt: $upper_id}}, order_by: {id: desc}) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),xi=Object(Pe.a)(ii||(ii=Object(B.a)(["\nmutation CreateOperationEventLog($message: String!, $level: String!) {\n  insert_operationeventlog_one(object:{level: $level, message: $message}) {\n    id\n  }\n}\n "]))),gi=Object(Pe.a)(ci||(ci=Object(B.a)(['\n query GetOperationEventLogError($operation_id: Int!) {\n   operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}}, order_by: {id: desc}) {\n     id\n     level\n     message\n     resolved\n     timestamp\n     count\n     operator {\n       id\n       username\n     }\n   }\n }\n  ']))),yi=Object(Pe.a)(ri||(ri=Object(B.a)(["\nmutation UpdateDeletedOperationEventLog($id: Int!) {\n  update_operationeventlog(where:{id: {_eq: $id}}, _set: {deleted: true}) {\n    returning{\n        id\n        deleted\n    }\n  }\n}\n "]))),_i=Object(Pe.a)(oi||(oi=Object(B.a)(["\nmutation UpdateResolutionOperationEventLog($id: Int!, $resolved: Boolean!) {\n  update_operationeventlog_by_pk(pk_columns:{id: $id}, _set: {resolved: $resolved}) {\n    id\n    resolved\n  }\n}\n "]))),vi=Object(Pe.a)(si||(si=Object(B.a)(['\nmutation UpdateLevelOperationEventLog($id: Int!) {\n  update_operationeventlog_by_pk(pk_columns: {id: $id}, _set: {level: "warning"}) {\n    id\n    level\n  }\n}\n ']))),ki=Object(Pe.a)(li||(li=Object(B.a)(["\n mutation UpdateResolveViewableErrorsOperationEventLog($ids: [Int]!) {\n   update_operationeventlog(where:{id: {_in: $ids}}, _set: {resolved: true}) {\n     returning{\n         id\n         resolved\n     }\n   }\n }\n  "]))),wi=Object(Pe.a)(di||(di=Object(B.a)(["\n  mutation UpdateResolveAllErrorsOperationEventLog($operation_id: Int!) {\n    update_operationeventlog(where: {resolved: {_eq: false}, operation_id: {_eq: $operation_id}}, _set: {resolved: true}) {\n      returning{\n          id\n          resolved\n      }\n    }\n  }\n   "])));function Ci(e){var t=Object(A.a)(I),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(0),s=Object(j.a)(r,2),d=s[0],u=s[1];Object(nt.a)(fi,{variables:{operation_id:t.user.current_operation_id,offset:0,eventQuerySize:100},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;0===d&&u(t.data.operationeventlog.length);var a=t.data.operationeventlog.reduce((function(e,t){if(e.find((function(e){return e.id===t.id}))){var a=e.findIndex((function(e){return e.id===t.id})),n=Object(R.a)(e);return n[a]=t,Object(R.a)(n)}return[].concat(Object(R.a)(e),[t])}),Object(R.a)(i));a.sort((function(e,t){return e.id>t.id?-1:t.id>e.id?1:0})),c(a)}});var b=Object(St.a)(mi,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(q.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(R.a)(e):[].concat(Object(R.a)(e),[t])}),Object(R.a)(i));u(d+100),c(t),q.success("Successfully fetched more events")}else q.info("No more events")}}),p=Object(j.a)(b,1)[0],h=Object(St.a)(Oi,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){q.dismiss();var t=!1,a=e.operationeventlog.reduce((function(e,a){return e.find((function(e){return e.id===a.id}))?Object(R.a)(e):(t=!0,[].concat(Object(R.a)(e),[a]))}),Object(R.a)(i));c(a),t?q.success("Successfully fetched surrounding events"):q.info("No additional surrounding events")}}),m=Object(j.a)(h,1)[0],f=Object(St.a)(gi,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(q.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(R.a)(e):[].concat(Object(R.a)(e),[t])}),Object(R.a)(i));c(t),q.success("Successfully fetched more errors")}else q.info("No more events")}}),O=Object(j.a)(f,1)[0],x=Object(Ee.a)(xi),g=Object(j.a)(x,1)[0],y=Object(Ee.a)(yi,{update:function(e,t){var a=t.data.update_operationeventlog.returning[0],n=i.filter((function(e){return e.id!==a.id}));c(n),q.success("Successfully deleted event log")}}),_=Object(j.a)(y,1)[0],k=Object(Ee.a)(_i,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(o.a)(Object(o.a)({},e),{},{resolved:a.resolved}):e}));c(n)}}),w=Object(j.a)(k,1)[0],C=Object(Ee.a)(vi,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(o.a)(Object(o.a)({},e),{},{level:a.level}):e}));c(n)}}),S=Object(j.a)(C,1)[0],D=Object(Ee.a)(ki,{update:function(e,t){var a=t.data;if(q.dismiss(),a.update_operationeventlog.returning.length>0){q.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),r=i.map((function(e){return n.includes(e.id)?Object(o.a)(Object(o.a)({},e),{},{resolved:!0}):Object(o.a)({},e)}));c(r)}else q.info("No Viewable Errors to Resolve")}}),$=Object(j.a)(D,1)[0],T=Object(Ee.a)(wi,{update:function(e,t){var a=t.data;if(q.dismiss(),a.update_operationeventlog.returning.length>0){q.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),r=i.map((function(e){return n.includes(e.id)?Object(o.a)(Object(o.a)({},e),{},{resolved:!0}):Object(o.a)({},e)}));c(r)}else q.info("No Errors to Resolve")}}),P=Object(j.a)(T,1)[0];return Object(v.jsx)(hi,{onSubmitMessage:function(e){var t=e.level,a=e.message;g({variables:{level:t,message:a}})},operationeventlog:i,loadMore:function(){q.info("Loading more events..."),p({variables:{operation_id:t.user.current_operation_id,offset:d,eventQuerySize:100}})},loadNextError:function(){q.info("Loading more errors..."),O({variables:{operation_id:t.user.current_operation_id}})},onUpdateDeleted:function(e){var t=e.id;q.info("Deleting event log..."),_({variables:{id:t}})},onUpdateResolution:function(e){var t=e.id,a=e.resolved;w({variables:{id:t,resolved:a}})},onUpdateLevel:function(e){var t=e.id;S({variables:{id:t}})},getSurroundingEvents:function(e){var a=e.id;q.info("Loading surrounding events..."),m({variables:{lower_id:a-5,upper_id:a+5,operation_id:t.user.current_operation_id}})},resolveViewableErrors:function(){q.info("Resolving Errors...");var e=i.reduce((function(e,t){return"warning"!==t.level||t.resolved?Object(R.a)(e):[].concat(Object(R.a)(e),[t.id])}),[]);$({variables:{ids:e}})},resolveAllErrors:function(){q.info("Resolving Errors..."),P({variables:{operation_id:t.user.current_operation_id}})}})}var Si,Di,Ii,$i,Ti,Pi=a(61),Ai=a.n(Pi);function Ei(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState("operator"),r=Object(j.a)(c,2),d=r[0],u=r[1],b=Object(s.useRef)(null);Object(s.useEffect)((function(){i(e.operator.checked),u(e.operator.view_mode)}),[e.operator]);return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(K.a,{checked:n,onChange:function(t){i(t.target.checked),e.updateOperator(Object(o.a)(Object(o.a)({},e.operator),{},{checked:t.target.checked,view_mode:d}))},color:"secondary"})}),Object(v.jsx)(H.a,{children:e.operator.username}),Object(v.jsx)(H.a,{children:n?Object(v.jsxs)(Dt.a,{style:{width:"100%"},children:[Object(v.jsx)(Mt.a,{ref:b,children:"Options"}),Object(v.jsx)(It.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:d,onChange:function(t){u(t.target.value),e.updateOperator(Object(o.a)(Object(o.a)({},e.operator),{},{checked:n,view_mode:t.target.value}))},input:Object(v.jsx)(Tt.a,{style:{width:"100%"}}),children:["operator","spectator","lead","developer"].map((function(e){return Object(v.jsx)(Ot.a,{value:e,children:e},e)}))})]}):null})]})})}var Fi=Object(Pe.a)(Si||(Si=Object(B.a)(["\nquery GetOperation($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n}\n"]))),Li=Object(Pe.a)(Di||(Di=Object(B.a)(["\nmutation updateLeadMutation($operation_id: Int!, $admin_id: Int!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {admin_id: $admin_id}) {\n    admin {\n      id\n      username\n    }\n    id\n  }\n}\n"]))),qi=Object(Pe.a)(Ii||(Ii=Object(B.a)(["\nmutation updateOperatorViewMode($operatoroperation_id: Int!, $view_mode: String!) {\n  update_operatoroperation_by_pk(pk_columns: {id: $operatoroperation_id}, _set: {view_mode: $view_mode}) {\n    id\n    view_mode\n  }\n}"]))),Ni=Object(Pe.a)($i||($i=Object(B.a)(["\nmutation removeOperatorsFromOperation($operatoroperation_ids: [Int!]!) {\n  delete_operatoroperation(where: {id: {_in: $operatoroperation_ids}}) {\n    returning {\n      id\n    }\n  }\n}"]))),Ri=Object(Pe.a)(Ti||(Ti=Object(B.a)(["\nmutation addNewOperators($operators: [operatoroperation_insert_input!]!) {\n  insert_operatoroperation(objects: $operators) {\n    returning {\n      id\n    }\n  }\n}"])));function Bi(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState({}),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState([]),b=Object(j.a)(u,2),p=b[0],h=b[1];Object(Ae.a)(Fi,{variables:{operation_id:e.id},fetchPolicy:"network-only",onCompleted:function(e){var t=e.operator.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{checked:!1})}));h(e.operation_by_pk.operatoroperations),d(e.operation_by_pk.admin);var a=t.map((function(t){var a=e.operation_by_pk.operatoroperations.find((function(e){return e.operator.id===t.id}));return a?a.operator.id===e.operation_by_pk.admin.id?Object(o.a)(Object(o.a)({},t),{},{checked:!0,view_mode:"lead",operatoroperation_id:a.id}):Object(o.a)(Object(o.a)({},t),{},{checked:!0,view_mode:a.view_mode,operatoroperation_id:a.id}):Object(o.a)(Object(o.a)({},t),{},{view_mode:"operator"})}));a.sort((function(e,t){return e.username>t.username?1:-1})),i(a)},onError:function(e){q.error("Failed to get operational data"),console.error(e)}});var f=Object(Ee.a)(Li,{onCompleted:function(e){q.success("Successfully updated Lead")},onError:function(e){q.error("Failed to update operation"),console.log("error updating operation",e)}}),O=Object(j.a)(f,1)[0],x=Object(Ee.a)(Ri,{onCompleted:function(e){q.success("Sucessfully added operators")},onError:function(e){q.error("Failed to add operators"),console.error("error adding operators to operation",e)}}),g=Object(j.a)(x,1)[0],y=Object(Ee.a)(Ni,{onCompleted:function(e){q.success("Sucessfully removed operators")},onError:function(e){q.error("Failed to remove operators"),console.error("error removing operators from operation",e)}}),_=Object(j.a)(y,1)[0],k=Object(Ee.a)(qi,{onCompleted:function(e){q.success("Successfully updated operator view mode")},onError:function(e){q.error("Failed to update operator view mode"),console.error("failed to update view mode: ",e)}}),w=Object(j.a)(k,1)[0],C=function(e){var t=Object(R.a)(n);"lead"===e.view_mode&&(t=t.map((function(e){return"lead"===e.view_mode?Object(o.a)(Object(o.a)({},e),{},{view_mode:"operator"}):Object(o.a)({},e)}))),t=t.map((function(t){return t.id===e.id?Object(o.a)({},e):Object(o.a)({},t)})),i(t)};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Modify Operator Assignments"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"8rem"},children:"Assign to Operation"}),Object(v.jsx)(H.a,{style:{width:"8rem"},children:"Operator"}),Object(v.jsx)(H.a,{style:{width:"10rem"},children:"Role"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(Ei,{operator:e,updateOperator:C},"operator"+e.id)}))})]})})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(v.jsx)(m.a,{onClick:function(){var t=n.find((function(e){return"lead"===e.view_mode}));if(t){t.id!==s.id&&O({variables:{operation_id:e.id,admin_id:t.id}});var a=[],i=[];n.forEach((function(t){var n=p.find((function(e){return e.operator.id===t.id}));n?t.checked?t.view_mode!==n.view_mode&&(console.log("update:",t),w({variables:{operatoroperation_id:n.id,view_mode:t.view_mode}})):i.push(n.id):t.checked&&a.push({operation_id:e.id,operator_id:t.id,view_mode:t.view_mode})})),a.length>0&&g({variables:{operators:a}}),i.length>0&&_({variables:{operatoroperation_ids:i}}),e.onClose()}else q.error("No Lead for the operation is set")},variant:"contained",color:"secondary",children:"Update"})]})]})}var Wi,zi,Hi,Mi=a(264),Ui=a.n(Mi),Vi=a(441),Gi=a.n(Vi),Ki=a(265),Qi=a.n(Ki),Ji=a(440),Yi=a.n(Ji),Zi=Object(Pe.a)(Wi||(Wi=Object(B.a)(["\nquery GetOperations($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    name\n    id\n    channel\n    display_name\n    icon_emoji\n    icon_url\n    webhook\n    webhook_message\n    complete\n  }\n}\n"]))),Xi=Object(Pe.a)(zi||(zi=Object(B.a)(["\nmutation MyMutation($operation_id: Int!, $channel: String!, $complete: Boolean!, $display_name: String!, $icon_emoji: String!, $icon_url: String!, $name: String!, $webhook: String!, $webhook_message: String!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {channel: $channel, complete: $complete, display_name: $display_name, icon_emoji: $icon_emoji, icon_url: $icon_url, name: $name, webhook: $webhook, webhook_message: $webhook_message}) {\n    id\n    name\n  }\n}\n"])));function ec(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState(""),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useState(""),f=Object(j.a)(h,2),O=f[0],x=f[1],g=l.a.useState(""),y=Object(j.a)(g,2),_=y[0],k=y[1],C=l.a.useState(""),S=Object(j.a)(C,2),D=S[0],I=S[1],$=l.a.useState(""),T=Object(j.a)($,2),P=T[0],A=T[1],E=l.a.useState(!1),F=Object(j.a)(E,2),L=F[0],N=F[1],R=Object(Ee.a)(Xi,{onCompleted:function(e){console.log(e),q.success("Successfully updated operation")},onError:function(e){q.error("Failed to update operation"),console.log("error updating operation",e)}}),B=Object(j.a)(R,1)[0];Object(Ae.a)(Zi,{fetchPolicy:"no-cache",variables:{operation_id:e.id},onCompleted:function(e){i(e.operation_by_pk.name),s(e.operation_by_pk.channel),p(e.operation_by_pk.display_name),x(e.operation_by_pk.icon_emoji),k(e.operation_by_pk.icon_url),I(e.operation_by_pk.webhook),A(e.operation_by_pk.webhook_message),N(e.operation_by_pk.complete)},onError:function(){q.error("Failed to fetch data")}});var W=function(e,t,a){switch(e){case"name":i(t);break;case"Webhook Channel":s(t);break;case"Webhook Display Name":p(t);break;case"Webhook Icon Emoji":x(t);break;case"Webhook Icon URL":k(t);break;case"Webhook URL":I(t);break;case"Webhook POST Message":A(t)}};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:["Modify ",n]}),Object(v.jsxs)(le.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:[Object(v.jsx)(de.a,{children:"Use this dialog to update some information about an operation."}),Object(v.jsx)(w,{autoFocus:!0,value:n,onChange:W,margin:"dense",name:"name"}),"Complete Operation? ",Object(v.jsx)(K.a,{checked:L,onChange:function(e){N(e.target.checked)},color:"secondary"}),Object(v.jsx)(w,{margin:"dense",value:o,onChange:W,name:"Webhook Channel"}),Object(v.jsx)(w,{margin:"dense",value:b,onChange:W,name:"Webhook Display Name"}),Object(v.jsx)(w,{margin:"dense",value:O,onChange:W,name:"Webhook Icon Emoji"}),Object(v.jsx)(w,{margin:"dense",value:_,onChange:W,name:"Webhook Icon URL"}),Object(v.jsx)(w,{margin:"dense",value:D,onChange:W,name:"Webhook URL"}),Object(v.jsx)(w,{margin:"dense",multiline:!0,value:P,onChange:W,name:"Webhook POST Message"})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(v.jsx)(m.a,{onClick:function(){B({variables:{operation_id:e.id,name:n,channel:o,display_name:b,icon_emoji:O,icon_url:_,webhook:D,webhook_message:P,complete:L}}),e.onClose()},variant:"contained",color:"secondary",children:"Update"})]})]})}var tc,ac=Object(Pe.a)(Hi||(Hi=Object(B.a)(["\nmutation updateCurrentOpertionMutation($operator_id: Int!, $operation_id: Int!) {\n  update_operator_by_pk(pk_columns: {id: $operator_id}, _set: {current_operation_id: $operation_id}) {\n    id\n  }\n}\n"])));function nc(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(!1),b=Object(j.a)(u,2),p=(b[0],b[1]),h=l.a.useState(!1),f=Object(j.a)(h,2),O=f[0],x=f[1],g=Object(A.a)(I),y=Object(Ee.a)(ac,{onCompleted:function(t){!function(e){var t=e.operation_name,a=e.operation_id;I(Object(o.a)(Object(o.a)({},I),{},{user:Object(o.a)(Object(o.a)({},I.user),{},{current_operation:t,current_operation_id:a})}))}({operation_name:e.name,operation_id:e.id}),q.success("Updated current operation")},onError:function(e){q.error("Failed to update current operation"),console.error(e)}}),_=Object(j.a)(y,1)[0];return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)(m.a,{size:"small",onClick:function(){i(!0)},startIcon:Object(v.jsx)(Ai.a,{}),color:"secondary",variant:"contained",children:"Edit"}),Object(v.jsx)(he,{open:n,fullWidth:!0,onClose:function(){i(!1)},innerDialog:Object(v.jsx)(ec,{onClose:function(){i(!1)},id:e.id})})]}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(m.a,{size:"small",onClick:function(){d(!0)},startIcon:Object(v.jsx)(Yi.a,{}),color:"secondary",variant:"contained",children:"Edit"}),Object(v.jsx)(he,{open:s,maxHeight:"calc(80vh)",fullWidth:!0,onClose:function(){d(!1)},innerDialog:Object(v.jsx)(Bi,{id:e.id,onClose:function(){d(!1)}})})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{size:"small",onClick:function(){p(!0),q.warning("Not Implemented")},startIcon:Object(v.jsx)(Ui.a,{}),color:"primary",variant:"contained",children:"Edit"})}),Object(v.jsx)(H.a,{children:e.name}),Object(v.jsx)(H.a,{children:e.admin.username}),Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{size:"small",startIcon:Object(v.jsx)(Qi.a,{}),onClick:function(){q.warning("Not Implemented")},color:"primary",variant:"contained",children:"Analysis"})}),Object(v.jsx)(H.a,{children:e.id===g.user.current_operation_id?"Current Operation":Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(m.a,{size:"small",startIcon:Object(v.jsx)(Gi.a,{}),onClick:function(){x(!0)},color:"primary",variant:"contained",children:"Make Current"}),Object(v.jsx)(Ia,{onClose:function(){x(!1)},onSubmit:function(){_({variables:{operator_id:g.user.user_id,operation_id:e.id}})},open:O,title:"Change Current Operation?",acceptText:"Update",dialogText:"Changing operations will force you to log in again"})]})})]},e.id)})}function ic(e){var t=Object(ve.a)(),a=l.a.useState(!1),n=Object(j.a)(a,2),i=n[0],c=n[1];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operations Management"})}),Object(v.jsxs)(M.a,{component:G.a,className:"mythicElement",children:[Object(v.jsx)(m.a,{size:"small",onClick:function(){c(!0)},style:{float:"right"},startIcon:Object(v.jsx)(re.a,{}),color:"primary",variant:"contained",children:"New Operation"}),Object(v.jsx)(he,{open:i,onClose:function(){c(!1)},innerDialog:null}),Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"8rem"},children:"Configure"}),Object(v.jsx)(H.a,{style:{width:"8rem"},children:"Operators"}),Object(v.jsx)(H.a,{style:{width:"10rem"},children:"Assign Blocklists"}),Object(v.jsx)(H.a,{children:"Operation Name"}),Object(v.jsx)(H.a,{children:"Operation Admin"}),Object(v.jsx)(H.a,{style:{width:"10rem"},children:"Analysis"}),Object(v.jsx)(H.a,{style:{width:"12rem"},children:"Operation Status"})]})}),Object(v.jsx)(z.a,{children:e.operation.map((function(t){return Object(v.jsx)(nc,Object(o.a)(Object(o.a)({},t),{},{operator:e.operator}),"operation"+t.id)}))})]})]})]})}var cc=Object(Pe.a)(tc||(tc=Object(B.a)(["\nquery GetOperations {\n  operation(order_by: {name: asc}) {\n    complete\n    name\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n}\n"])));function rc(e){var t=Object(Ae.a)(cc,{fetchPolicy:"network-only"}),a=t.loading,n=t.error,i=t.data;return a?Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}}):n?(console.error(n),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsx)("div",{style:{height:"calc(94vh)",marginTop:"10px",marginRight:"5px"},children:Object(v.jsx)(ic,Object(o.a)({},i))})}var oc,sc=a(266),lc=a.n(sc),dc=(a(354),a(355),a(561),Object(Pe.a)(oc||(oc=Object(B.a)(["\nquery getCommandsAndPayloadTypes{\n  payloadtype(order_by: {ptype: asc}){\n    id\n    ptype\n    commands(order_by: {cmd: asc}){\n      id\n      cmd\n    }\n  }\n}\n"]))));function uc(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(""),o=Object(j.a)(r,2),d=o[0],u=o[1],b=l.a.useState(""),p=Object(j.a)(b,2),h=p[0],f=p[1],O=l.a.useState([]),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useState([]),k=Object(j.a)(_,2),C=k[0],S=k[1],D=l.a.useState(""),I=Object(j.a)(D,2),$=I[0],T=I[1],P=Object(s.useRef)(null),A=Object(s.useRef)(null);Object(Ae.a)(dc,{onCompleted:function(t){if(y(t.payloadtype),void 0!==e.payload_type_id?u(e.payload_type_id):t.payloadtype.length>0&&u(t.payloadtype[0].id),void 0!==e.command_id){f(e.command_id);for(var a=0;a<t.payloadtype.length;a++)e.payload_type_id===t.payloadtype[a].id&&S(t.payloadtype[a].commands)}else t.payloadtype.length>0&&t.payloadtype[0].commands.length>0&&(S(t.payloadtype[0].commands),f(t.payloadtype[0].commands[0].id));void 0!==e.author&&T(e.author)},onError:function(e){}}),Object(s.useEffect)((function(){void 0!==e.script&&c(atob(e.script))}),[e.script]);var E=function(){e.onSubmitEdit({script:btoa(i),command_id:h,payload_type_id:d,author:$}),e.onClose()};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{children:e.title?e.title:"Edit BrowserScript Code"}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsxs)(Dt.a,{style:{width:"50%"},children:[Object(v.jsx)(Mt.a,{ref:P,children:"Payload Type"}),Object(v.jsx)(It.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:d,onChange:function(e){u(e.target.value);var t=g.filter((function(t){return t.id===e.target.value}));S(t[0].commands),f(t[0].commands[0].id)},input:Object(v.jsx)(Tt.a,{style:{width:"100%"}}),children:g.map((function(e){return Object(v.jsx)(Ot.a,{value:e.id,children:e.ptype},"payloadtype"+e.id)}))})]}),Object(v.jsxs)(Dt.a,{style:{width:"50%",paddingBottom:"10px"},children:[Object(v.jsx)(Mt.a,{ref:A,children:"Command"}),Object(v.jsx)(It.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:h,onChange:function(e){f(e.target.value)},input:Object(v.jsx)(Tt.a,{style:{width:"100%"}}),children:C.map((function(e){return Object(v.jsx)(Ot.a,{value:e.id,children:e.cmd},"command"+e.id)}))})]}),Object(v.jsx)(w,{value:$,onChange:function(e,t,a){T(t)},name:"Author",fullWidth:!0}),Object(v.jsx)(lc.a,{mode:"javascript",theme:"dark"===t.palette.type?"monokai":"github",width:"100%",value:i,focus:!0,onChange:function(e){c(e)},setOptions:{}})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",style:{backgroundColor:t.palette.primary.main},children:"Close"}),e.new?Object(v.jsx)(m.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Create"}):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(m.a,{onClick:function(){e.onRevert(),e.onClose()},variant:"contained",style:{backgroundColor:t.palette.success.main},children:"Revert"}),Object(v.jsx)(m.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Save"})]})]})]})}function bc(e){var t=Object(ve.a)(),a=l.a.useState(!1),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(!1),o=Object(j.a)(r,2),d=o[0],u=o[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],f=p[1];Object(s.useEffect)((function(){var t=!1;e.browserscriptoperations.forEach((function(a){a.operation_id===e.operation_id&&(t=!0)})),u(t)}),[e.browserscriptoperations,e.operation_id]);return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Y.a,{size:"small",onClick:function(){f(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})}),Object(v.jsx)(Ia,{onClose:function(){f(!1)},onSubmit:function(){e.onDelete({browserscript_id:e.id})},open:h})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(K.a,{checked:e.active,onChange:function(){e.onToggleActive({browserscript_id:e.id,active:!e.active})},color:"primary",inputProps:{"aria-label":"checkbox",track:"white"},name:"Active"})}),Object(v.jsx)(H.a,{children:e.payloadtype.ptype}),Object(v.jsx)(H.a,{children:null===e.command?"Support Script: "+e.name:e.command.cmd}),Object(v.jsx)(H.a,{children:e.author}),Object(v.jsxs)(H.a,{children:[e.user_modified?"User Modified":""," "]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{size:"small",variant:"contained",onClick:function(){c(!0)},color:"primary",children:" Edit "})}),Object(v.jsx)(H.a,{children:d?Object(v.jsx)(m.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitRemoveFromOperation({browserscript_id:e.id})},color:"secondary",children:"Remove"}):Object(v.jsx)(m.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitApplyToOperation({browserscript_id:e.id})},color:"primary",children:"Apply"})}),i?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:i,onClose:function(){c(!1)},innerDialog:Object(v.jsx)(uc,{onClose:function(){c(!1)},payload_type_id:e.payloadtype.id,command_id:e.command.id,script:e.script,onSubmitEdit:function(t){var a=t.script,n=t.command_id,i=t.payload_type_id,c=t.author;e.onSubmitEdit({browserscript_id:e.id,script:a,command_id:n,payload_type_id:i,author:c})},onRevert:function(){e.onRevert({browserscript_id:e.id,script:e.container_version})},author:e.author})}):null]},"payload"+e.id)})}function jc(e){var t=Object(ve.a)(),a=l.a.useState(!1),n=Object(j.a)(a,2),i=n[0],c=n[1];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Browser Scripts"}),Object(v.jsx)(m.a,{size:"small",onClick:function(){return c(!0)},style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(v.jsx)(re.a,{}),color:"primary",variant:"contained",children:"New Script"}),i?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:i,onClose:function(){c(!1)},innerDialog:Object(v.jsx)(uc,{onClose:function(){c(!1)},title:"Create New Browser Script",new:!0,onSubmitEdit:e.onSubmitNew})}):null]}),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Delete"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Active"}),Object(v.jsx)(H.a,{children:"Payload"}),Object(v.jsx)(H.a,{children:"Command"}),Object(v.jsx)(H.a,{children:" Author"}),Object(v.jsx)(H.a,{style:{width:"15em"},children:"User Modified?"}),Object(v.jsx)(H.a,{style:{width:"8em"},children:" Edit"}),Object(v.jsx)(H.a,{style:{width:"15rem"},children:"Apply to Operation"})]})}),Object(v.jsx)(z.a,{children:e.browserscript.map((function(t){return Object(v.jsx)(bc,Object(o.a)({onSubmitApplyToOperation:e.onSubmitApplyToOperation,onSubmitRemoveFromOperation:e.onSubmitRemoveFromOperation,operation_id:e.operation_id,onToggleActive:e.onToggleActive,onSubmitEdit:e.onSubmitEdit,onRevert:e.onRevert,onToggleOperation:e.onToggleOperation,onDelete:e.onDelete},t),"script"+t.id)}))})]})})]})}var pc,hc,mc,fc,Oc,xc,gc,yc=a(489),_c=Object(yc.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"}}});function vc(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),o=r[0],d=r[1];return Object(s.useEffect)((function(){d(null===e.browserscript.command?"Support Script: "+e.browserscript.name:e.browserscript.command.cmd)}),[e.browserscript]),Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.browserscript.payloadtype.ptype}),Object(v.jsx)(H.a,{children:o}),Object(v.jsxs)(H.a,{children:[e.browserscript.user_modified?"User Modified":""," "]}),Object(v.jsx)(H.a,{children:e.operation.admin.username}),Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{size:"small",variant:"contained",style:{color:_c.palette.info.main},onClick:function(){i(!0)},children:" View "})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(v.jsx)(lc.a,{mode:"javascript",theme:"github",width:"100%",value:atob(e.browserscript.script),focus:!0,readOnly:!0,onChange:function(){},setOptions:{}})})]},"opscript"+e.browserscript.id)})}function kc(e){var t=Object(ve.a)();return e.browserscriptoperation.length>0&&Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operation Browser Scripts"})}),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{maxHeight:"calc(30vh)"},children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"10em"},children:"Payload"}),Object(v.jsx)(H.a,{style:{},children:"Command"}),Object(v.jsx)(H.a,{style:{width:"5em"},children:"User Modified?"}),Object(v.jsx)(H.a,{style:{},children:"Operator"}),Object(v.jsx)(H.a,{style:{width:"5em"},children:"View Script"})]})}),Object(v.jsx)(z.a,{children:e.browserscriptoperation.map((function(e){return Object(v.jsx)(vc,Object(o.a)({},e),"opscriptrow"+e.browserscript.id)}))})]})})]})}var wc,Cc,Sc=Object(Pe.a)(pc||(pc=Object(B.a)(["\nsubscription SubscribeBrowserScripts($operator_id: Int!) {\n  browserscript(where: {operator_id: {_eq: $operator_id}, for_new_ui: {_eq: true}}) {\n    active\n    author\n    user_modified\n    script\n    payloadtype {\n      ptype\n      id\n    }\n    name\n    id\n    creation_time\n    container_version_author\n    container_version\n    command {\n      cmd\n      id\n    }\n    browserscriptoperations {\n      operation_id\n      id\n    }\n  }\n}\n "]))),Dc=Object(Pe.a)(hc||(hc=Object(B.a)(["\nsubscription SubscribeOperationBrowserScripts($operation_id: Int!) {\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {for_new_ui: {_eq: true}}}){\n    browserscript{\n        active\n        author\n        user_modified\n        script\n        payloadtype {\n          ptype\n          id\n        }\n        name\n        id\n        creation_time\n        container_version_author\n        container_version\n        command {\n          cmd\n          id\n        }\n      }\n   operation{\n    admin{\n        username\n    }\n   }\n  }\n}\n "]))),Ic=Object(Pe.a)(mc||(mc=Object(B.a)(["\nmutation updateBrowserScriptActive($browserscript_id: Int!, $active: Boolean!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {active: $active}) {\n    id\n  }\n}\n"]))),$c=Object(Pe.a)(fc||(fc=Object(B.a)(["\nmutation updateBrowserScriptScript($browserscript_id: Int!, $script: String!, $command_id: Int!, $payload_type_id: Int!, $author: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, author: $author, user_modified: true, command_id: $command_id, payload_type_id: $payload_type_id}) {\n    id\n  }\n}\n"]))),Tc=Object(Pe.a)(Oc||(Oc=Object(B.a)(["\nmutation updateBrowserScriptRevert($browserscript_id: Int!, $script: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, user_modified: false}) {\n    id\n  }\n}\n"]))),Pc=Object(Pe.a)(xc||(xc=Object(B.a)(["\nmutation insertNewBrowserScript($script: String!, $author: String!, $payload_type_id: Int!, $command_id: Int!){\n  insert_browserscript_one(object: {script: $script, author: $author, payload_type_id: $payload_type_id, command_id: $command_id}){\n    id\n  }\n}\n"]))),Ac=Object(Pe.a)(gc||(gc=Object(B.a)(["\nmutation deleteBrowserScriptMutation($browserscript_id: Int!){\n  delete_browserscript_by_pk(id: $browserscript_id){\n    id\n  }\n}\n"])));function Ec(e){var t=Object(A.a)(I),a=l.a.useState({browserscript:[]}),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState({browserscriptoperation:[]}),s=Object(j.a)(r,2),d=s[0],u=s[1];Object(nt.a)(Sc,{variables:{operator_id:t.user.id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;console.log(t),c(t.data)}}),Object(nt.a)(Dc,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;u(t.data)}});var b=Object(Ee.a)(Ic,{onCompleted:function(e){q.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),p=Object(j.a)(b,1)[0],h=Object(Ee.a)($c,{onCompleted:function(e){q.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),m=Object(j.a)(h,1)[0],f=Object(Ee.a)(Tc,{onCompleted:function(e){q.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),O=Object(j.a)(f,1)[0],x=Object(Ee.a)(Pc,{onCompleted:function(e){q.success("Successfully created new browser script!")},onError:function(e){q.error("Failed to create new script: "+e)}}),g=Object(j.a)(x,1)[0],y=Object(Ee.a)(Ac,{onCompleted:function(e){q.success("Successfully deleted browser script")},onError:function(e){q.error("Failed to delete browser script: "+e)}}),_=Object(j.a)(y,1)[0];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(jc,Object(o.a)(Object(o.a)({},i),{},{operation_id:t.user.current_operation_id,onToggleActive:function(e){var t=e.browserscript_id,a=e.active;p({variables:{browserscript_id:t,active:a}})},onSubmitEdit:function(e){var t=e.browserscript_id,a=e.script,n=e.command_id,i=e.payload_type_id,c=e.author;m({variables:{browserscript_id:t,script:a,command_id:n,payload_type_id:i,author:c}})},onRevert:function(e){var t=e.browserscript_id,a=e.script;O({variables:{browserscript_id:t,script:a}})},onSubmitNew:function(e){var t=e.script,a=e.author,n=e.payload_type_id,i=e.command_id;g({variables:{author:a,script:t,payload_type_id:n,command_id:i}})},onDelete:function(e){var t=e.browserscript_id;_({variables:{browserscript_id:t}})},onSubmitApplyToOperation:function(e){e.browserscript_id;q.warning("Not Implemented Yet!",{autoHideDuration:1e3})},onSubmitRemoveFromOperation:function(e){e.browserscript_id;q.warning("Not Implemented Yet!",{autoHideDuration:1e3})}})),Object(v.jsx)(kc,Object(o.a)({},d))]})}var Fc,Lc,qc=Object(Pe.a)(wc||(wc=Object(B.a)(["\nmutation updateDescription ($payload_id: Int!, $description: String) {\n  update_payload_by_pk(pk_columns: {id: $payload_id}, _set: {tag: $description}) {\n    tag\n    id\n  }\n}\n"]))),Nc=Object(Pe.a)(Cc||(Cc=Object(B.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    tag\n    id\n  }\n}\n"])));function Rc(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(Nc,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.tag)},fetchPolicy:"network-only"}),r=c.loading,o=c.error,d=Object(Ee.a)(qc,{onCompleted:function(e){q.success("Updated Description")}}),u=Object(j.a)(d,1)[0];if(r)return Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}});if(o)return console.error(o),Object(v.jsx)("div",{children:"Error!"});var b=function(){u({variables:{payload_id:e.payload_id,description:n}}),e.onClose()};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Edit Payload Description"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:b})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(v.jsx)(m.a,{variant:"contained",onClick:b,color:"secondary",children:"Submit"})]})]})}var Bc,Wc=Object(Pe.a)(Fc||(Fc=Object(B.a)(["\nmutation updateDescription ($file_id: Int!, $filename: bytea!) {\n  update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {filename: $filename}) {\n    filename_text\n    id\n  }\n}\n"]))),zc=Object(Pe.a)(Lc||(Lc=Object(B.a)(["\nquery getFilenameQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    filemetum {\n      filename_text\n      id\n    }\n    id\n  }\n}\n"])));function Hc(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(s.useState)(),r=Object(j.a)(c,2),o=r[0],d=r[1],u=Object(Ae.a)(zc,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.filemetum.filename_text),d(e.payload_by_pk.filemetum.id)},fetchPolicy:"network-only"}),b=u.loading,p=u.error,h=Object(Ee.a)(Wc,{onCompleted:function(e){q.success("Updated filename")}}),f=Object(j.a)(h,1)[0];if(b)return Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}});if(p)return console.error(p),Object(v.jsx)("div",{children:"Error!"});var O=function(){f({variables:{file_id:o,filename:n}}),e.onClose()};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Edit Payload Filename"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:O})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(v.jsx)(m.a,{variant:"contained",onClick:O,color:"secondary",children:"Submit"})]})]})}var Mc=Object(Pe.a)(Bc||(Bc=Object(B.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    build_message\n    build_stderr\n    build_stdout\n    id\n  }\n}\n"])));function Uc(e){var t=Object(s.useState)({}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(s.useState)(!1),r=Object(j.a)(c,2),o=r[0],d=r[1],u=Object(Ae.a)(Mc,{variables:{payload_id:e.payload_id},onCompleted:function(t){d(e.viewError);var a="Message:\n"+t.payload_by_pk.build_message;a+="\nSTDOUT:\n"+t.payload_by_pk.build_stdout,i({message:a,error:"STDERR:\n"+t.payload_by_pk.build_stderr})},fetchPolicy:"network-only"}),b=u.loading,p=u.error;return Object(s.useEffect)((function(){d(e.viewError)}),[e.viewError]),b?Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}}):p?(console.error(p),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Payload Build Messages"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,onChange:function(){},value:o?n.error:n.message})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Vc=a(215),Gc=a.n(Vc),Kc=a(789),Qc=a(442),Jc=a.n(Qc);function Yc(e){var t=Object(ve.a)();return Object(v.jsx)(l.a.Fragment,{children:e.payloadc2profiles.map((function(a){return Object(v.jsxs)(Z.a,{children:[a.c2profile.is_p2p?a.c2profile.container_running?Object(v.jsx)(Kc.a,{title:"C2 Container online",children:Object(v.jsx)(an.a,{style:{color:t.palette.success.main}})}):Object(v.jsx)(Kc.a,{title:"C2 Container offline",children:Object(v.jsx)(Gc.a,{style:{color:t.palette.error.main}})}):a.c2profile.running?Object(v.jsx)(Kc.a,{title:"C2 Internal Server Running",children:Object(v.jsx)(an.a,{style:{color:t.palette.success.main}})}):a.c2profile.container_running?Object(v.jsx)(Kc.a,{title:"C2 Internal Server Not Running, but Container Online",children:Object(v.jsx)(Jc.a,{style:{color:t.palette.warning.main}})}):Object(v.jsx)(Kc.a,{title:"C2 Container offline",children:Object(v.jsx)(Gc.a,{style:{color:t.palette.error.main}})})," - ",a.c2profile.name]},a.c2profile.name+e.uuid)}))})}var Zc,Xc=a(96),er=a.n(Xc),tr=a(443),ar=a.n(tr);function nr(e){var t=Object(ve.a)();return Object(v.jsx)(l.a.Fragment,{children:"success"===e.build_phase?Object(v.jsx)(Kc.a,{title:"Download payload",children:Object(v.jsx)(Y.a,{variant:"contained",target:"_blank",color:"primary",href:window.location.origin+"/direct/download/"+e.filemetum.agent_file_id,download:!0,children:Object(v.jsx)(er.a,{style:{color:t.palette.success.main}})})}):"building"===e.build_phase?Object(v.jsx)(Kc.a,{title:"Payload still building",children:Object(v.jsx)(Y.a,{variant:"contained",children:Object(v.jsx)(ga.a,{size:20,thickness:4,style:{color:t.palette.info.main}})})}):Object(v.jsx)(Kc.a,{title:"Failed to build payload",children:Object(v.jsx)(Y.a,{variant:"contained",onClick:function(){return q.warning("Payload failed to build, cannot download")},children:Object(v.jsx)(ar.a,{style:{color:t.palette.error.main}})})})})}var ir,cr=Object(Pe.a)(Zc||(Zc=Object(B.a)(["\nquery checkPayloadConfigurationQuery($uuid: String!) {\n  config_check(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function rr(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(cr,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.config_check.status?i(e.config_check.output):(q.warning(e.config_check.error),i("Error!\n"+e.config_check.error))},fetchPolicy:"network-only"}),r=c.loading,o=c.error;return r?Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}}):o?(console.error(o),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Payload Config Check"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,onChange:function(){},value:n})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var or,sr,lr=Object(Pe.a)(ir||(ir=Object(B.a)(["\nquery generateRedirectRulesMutation($uuid: String!) {\n  redirect_rules(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function dr(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(lr,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.redirect_rules.status?i(e.redirect_rules.output):(q.warning(e.redirect_rules.error),i("Error!\n"+e.redirect_rules.error))},fetchPolicy:"network-only"}),r=c.loading,o=c.error;return r?Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}}):o?(console.error(o),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Payload Redirect Rules Check"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,onChange:function(){},value:n})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var ur,br=Object(Pe.a)(or||(or=Object(B.a)(["\nmutation triggerRebuildMutation($uuid: String!) {\n  rebuild_payload(uuid: $uuid) {\n      status\n      error\n      uuid\n  }\n}\n"]))),jr=Object(Pe.a)(sr||(sr=Object(B.a)(["\nquery exportPayloadConfigQuery($uuid: String!) {\n  export_payload_config(uuid: $uuid) {\n      status\n      error \n      config \n  }\n}\n"])));function pr(e){var t=l.a.useState(!0),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),d=r[0],u=r[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],f=p[1],O=l.a.useState(!1),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useState(!1),k=Object(j.a)(_,2),w=k[0],C=k[1],S=l.a.useState(!1),D=Object(j.a)(S,2),$=D[0],T=D[1],P=l.a.useState(!1),E=Object(j.a)(P,2),F=E[0],L=E[1],N=l.a.useState(!1),R=Object(j.a)(N,2),B=R[0],W=R[1],z=l.a.useState(!1),M=Object(j.a)(z,2),U=M[0],K=M[1],Q=Object(s.useRef)(null),J=Object(A.a)(I),Z=Object(ve.a)(),X=Object(Ee.a)(br,{onCompleted:function(e){console.log(e),q.success("Successfully triggered rebuild")},onError:function(e){q.error("Failed to trigger rebuild: "+e)}}),ee=Object(j.a)(X,1)[0],te=Object(St.a)(jr,{fetchPolicy:"no-cache",onCompleted:function(t){if("success"===t.export_payload_config.status){var a=new Blob([t.export_payload_config.config],{type:"text/plain"}),n=document.getElementById("download_config");if(null!==n)n.href=URL.createObjectURL(a),n.download=e.filemetum.filename_text+".json",n.click();else{var i=document.createElement("a");i.id="download_config",i.href=URL.createObjectURL(a),i.download=e.filemetum.filename_text+".json",document.body.appendChild(i),i.click()}}else q.error("Failed to export configuration: "+t.export_payload_config.error)},onError:function(e){q.error("Failed to export configuration: "+e)}}),ae=Object(j.a)(te,1)[0],ne=[{name:"Rename File",click:function(){C(!0)}},{name:"Edit Description",click:function(){y(!0)}},{name:e.callback_alert?"Stop Alerting to New Callbacks":"Start Alerting to New Callbacks",click:function(){!function(){var t=e.id,a=e.callback_alert;e.onAlertChanged(t,!a)}()}},{name:"View Build Message/Stdout",click:function(){i(!1),T(!0)}},{name:"View Build Errors",click:function(){i(!0),T(!0)}},{name:"Trigger New Build",click:function(){ee({variables:{uuid:e.uuid}})}},{name:"Export Payload Config",click:function(){ae({variables:{uuid:e.uuid}})}},{name:"Generate Redirect Rules",click:function(){K(!0)}},{name:"Check Agent C2 Configuration",click:function(){W(!0)}}],ce=function(e){Q.current&&Q.current.contains(e.target)||u(!1)};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Y.a,{size:"small",onClick:function(){f(!0)},style:{color:Z.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})}),Object(v.jsx)(Ia,{onClose:function(){f(!1)},onSubmit:function(){e.onDeletePayload(e.id),f(!1)},open:h})]}),Object(v.jsx)(H.a,{children:xe(e.creation_time,J.user.view_utc_time)}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(m.a,{ref:Q,size:"small",onClick:function(){u(!0)},color:"primary",variant:"contained",children:"Actions"}),Object(v.jsx)(ft.a,{open:d,anchorEl:Q.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var a=t.TransitionProps,n=t.placement;return Object(v.jsx)(mt.a,Object(o.a)(Object(o.a)({},a),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(v.jsx)(G.a,{variant:"outlined",style:{backgroundColor:"dark"===Z.palette.type?Z.palette.primary.dark:Z.palette.primary.light,color:"white"},children:Object(v.jsx)(ht.a,{onClickAway:ce,children:Object(v.jsx)(xt.a,{id:"split-button-menu",children:ne.map((function(t,a){return Object(v.jsx)(Ot.a,{onClick:function(e){return function(e,t){ne[t].click(),u(!1)}(0,a)},children:t.name},t.name+e.uuid)}))})})})}))}}),g?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:g,onClose:function(){y(!1)},innerDialog:Object(v.jsx)(Rc,{payload_id:e.id,onClose:function(){y(!1)}})}):null,w?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:w,onClose:function(){C(!1)},innerDialog:Object(v.jsx)(Hc,{payload_id:e.id,onClose:function(){C(!1)}})}):null,$?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:$,onClose:function(){T(!1)},innerDialog:Object(v.jsx)(Uc,{payload_id:e.id,viewError:n,onClose:function(){T(!1)}})}):null,B?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:B,onClose:function(){W(!1)},innerDialog:Object(v.jsx)(rr,{uuid:e.uuid,onClose:function(){W(!1)}})}):null,U?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:U,onClose:function(){K(!1)},innerDialog:Object(v.jsx)(dr,{uuid:e.uuid,onClose:function(){K(!1)}})}):null]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(nr,Object(o.a)({},e))}),Object(v.jsx)(H.a,{children:e.filemetum.filename_text}),Object(v.jsx)(H.a,{children:e.tag}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Yc,{payloadc2profiles:e.payloadc2profiles,uuid:e.uuid})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Y.a,{size:"small",color:"primary",onClick:function(){return L(!0)},children:Object(v.jsx)(Dn.a,{})})})]},"payload"+e.uuid),Object(v.jsx)(V.a,{children:F?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:F,onClose:function(){L(!1)},innerDialog:Object(v.jsx)(vn,Object(o.a)(Object(o.a)({},e),{},{payload_id:e.id,onClose:function(){L(!1)}}))}):null})]})}var hr,mr,fr,Or,xr,gr=Object(Pe.a)(ur||(ur=Object(B.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function yr(e){var t=l.a.useState({name:""}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ee.a)(gr,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?q.info("Submitted payload to build pipeline"):q.error(a.createPayload.error)}}),r=Object(j.a)(c,1)[0];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Import Payload Config to Generate New Payload"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsxs)(m.a,{variant:"contained",component:"label",children:[""===n.name?"Select File":n.name,Object(v.jsx)("input",{onChange:function(e){var t=new FileReader;t.onload=function(t){var a=t.target.result;i({name:e.target.files[0].name,contents:a})},t.readAsBinaryString(e.target.files[0])},type:"file",hidden:!0})]})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(v.jsx)(m.a,{variant:"contained",onClick:function(){r({variables:{payload:n.contents}}).catch((function(e){console.log(e)})),e.onClose()},color:"secondary",children:"Submit"})]})]})}function _r(e){var t=e.payload,a=e.onDeletePayload,n=e.onUpdateCallbackAlert,i=Object(ve.a)(),c=l.a.useState(!1),r=Object(j.a)(c,2),s=r[0],d=r[1];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(G.a,{elevation:5,style:{backgroundColor:i.pageHeader.main,color:i.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payloads"}),Object(v.jsx)(m.a,{size:"small",href:"/new/createpayload",style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(v.jsx)(re.a,{}),color:"primary",variant:"contained",children:"New Payload"}),Object(v.jsx)(m.a,{size:"small",onClick:function(){return d(!0)},style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(v.jsx)(re.a,{}),color:"primary",variant:"contained",children:"Import Payload Config"}),s?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:s,onClose:function(){d(!1)},innerDialog:Object(v.jsx)(yr,{onClose:function(){d(!1)}})}):null]}),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"4rem"},children:" Delete"}),Object(v.jsx)(H.a,{style:{width:"15rem"},children:"Timestamp"}),Object(v.jsx)(H.a,{style:{width:"6rem"},children:"Modify"}),Object(v.jsx)(H.a,{style:{width:"6rem"},children:"Download"}),Object(v.jsx)(H.a,{children:"File"}),Object(v.jsx)(H.a,{children:"Description"}),Object(v.jsx)(H.a,{children:"C2 Status"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Details"})]})}),Object(v.jsx)(z.a,{children:t.map((function(e){return Object(v.jsx)(pr,Object(o.a)({onDeletePayload:a,onAlertChanged:n},e),"payload"+e.id)}))})]})})]})}var vr=Object(Pe.a)(hr||(hr=Object(B.a)(["\nfragment payloadData on payload {\n  build_message\n  build_phase\n  build_stderr\n  callback_alert\n  creation_time\n  id\n  operator {\n    id\n    username\n  }\n  uuid\n  tag\n  payloadtype {\n    id\n    ptype\n  }\n  filemetum {\n    agent_file_id\n    filename_text\n    id\n  }\n  payloadc2profiles {\n    c2profile {\n      running\n      name\n      is_p2p\n      container_running\n    }\n  }\n}\n"]))),kr=Object(Pe.a)(mr||(mr=Object(B.a)(["\n","\nsubscription SubPayloadsQuery($operation_id: Int!) {\n  payload(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, auto_generated: {_eq: false}}, order_by: {id: desc}) {\n    ...payloadData\n  }\n}\n"])),vr),wr=Object(Pe.a)(fr||(fr=Object(B.a)(["\n","\nquery GetPayloadsQuery($operation_id: Int!) {\n  payload(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, auto_generated: {_eq: false}}, order_by: {id: desc}, limit: 20) {\n    ...payloadData\n  }\n}\n"])),vr),Cr=Object(Pe.a)(Or||(Or=Object(B.a)(["\nmutation PayloadsDeletePayloadMutation($id: Int!) {\n  update_payload_by_pk(pk_columns: {id: $id}, _set: {deleted: true}) {\n      id\n      deleted\n  }\n}\n"]))),Sr=Object(Pe.a)(xr||(xr=Object(B.a)(["\nmutation PayloadsCallbackAlertMutation($id: Int!, $callback_alert: Boolean!) {\n  update_payload_by_pk(pk_columns: {id: $id}, _set: {callback_alert: $callback_alert}) {\n    id\n    callback_alert\n  }\n}\n"])));function Dr(e){var t=Object(A.a)(I),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1];Object(Ae.a)(wr,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",onCompleted:function(e){var t=e.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(o.a)({},t),Object(R.a)(e)):[t].concat(Object(R.a)(e))}),Object(R.a)(i));t.sort((function(e,t){return e.id>t.id?-1:1})),c(t)}}),Object(nt.a)(kr,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",onSubscriptionData:function(e){var t=e.subscriptionData.data.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(o.a)({},t),Object(R.a)(e)):[t].concat(Object(R.a)(e))}),Object(R.a)(i));t.sort((function(e,t){return e.id>t.id?-1:1})),c(t)},onError:function(e){q.warning("Failed to get payloads"),console.log(e)}});var r=Object(Ee.a)(Cr,{onCompleted:function(e){var t=i.filter((function(t){return t.id!==e.update_payload_by_pk.id}));c(t),q.success("Successfully deleted")},onError:function(e){q.warning("Failed to delete payload"),console.log(e)}}),s=Object(j.a)(r,1)[0],d=Object(Ee.a)(Sr,{onCompleted:function(e){var t=i.map((function(t){return t.id===e.update_payload_by_pk.id?Object(o.a)(Object(o.a)({},t),e.update_payload_by_pk):Object(o.a)({},t)}));e.update_payload_by_pk.callback_alert?q.success("Now Alerting on New Callbacks"):q.success("No Longer Alerting on New Callbacks"),c(t)},onError:function(e){q.warning("Failed to update callback alerting status"),console.log(e)}}),u=Object(j.a)(d,1)[0];return Object(v.jsx)("div",{style:{height:"calc(94vh)",maxHeight:"calc(94vh)",marginTop:"10px"},children:Object(v.jsx)(_r,{onDeletePayload:function(e){s({variables:{id:e}})},onUpdateCallbackAlert:function(e,t){u({variables:{id:e,callback_alert:t}})},payload:i})})}var Ir=a(97),$r=a.n(Ir),Tr=a(267),Pr=a.n(Tr),Ar=a(144),Er=a.n(Ar),Fr=a(77),Lr=function(e,t,a,n,i,c){!function(e,t,a,n,i,c){Fr.select(".contextMenu").remove(),n.length>0&&(Fr.select(c).append("g").attr("class","contextMenu").selectAll("tmp").data(n).enter().append("g").attr("class","menuEntry").style({cursor:"pointer"}),Fr.selectAll(".menuEntry").append("rect").attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("rx",2).attr("fill","#ffffff").attr("width",180).attr("height",30).on("click",(function(t){t.action(e,i)})),Fr.selectAll(".menuEntry").append("text").text((function(e){return e.title})).attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("dy",20).attr("dx",10).on("click",(function(t){t.action(e,i)})),Fr.select("body").on("click",(function(){Fr.select(".contextMenu").remove(),Fr.select(".menuEntry").remove()})))}(e,Fr.event.pageX,Fr.event.pageY-80,a,t,c),Fr.event.preventDefault()},qr=a(289),Nr=a.n(qr);function Rr(e){var t=Object(s.useRef)(null),a=Object(s.useState)(!0),n=Object(j.a)(a,2),i=n[0],c=n[1],r=Object(ve.a)();return Object(s.useEffect)((function(){Wr(e.callbackgraphedges,t,i,{rankDir:"LR",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!0},{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[]},r),c(!1)}),[e.callbackgraphedges,i,r]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:["Callback ",e.id,"'s Egress Path"]}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)("svg",{ref:t,id:"nodeTree",style:{width:"100%",height:"calc(78vh)",marginTop:"10px"}})})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Br,Wr=function(e,t,a,n,i,c){var r,o="stroke: ".concat(c.palette.warning.main,"; stroke-width: 3px; stroke-dasharray: 5, 5; fill:none"),s="fill: ".concat(c.palette.warning.main),l="stroke: ".concat(c.palette.info.main,"; fill: none; stroke-width: 1.5px;"),d="stroke: ".concat(c.palette.info.main,"; fill: ").concat(c.palette.info.main,"; stroke-width: 1.5px;"),u="fill: ".concat(c.palette.success.main,","),b='labelStyle: "font-size: 2em"; fill: '.concat(c.palette.text.primary),j='labelStyle: "font-size: 2em"; fill: '.concat(c.palette.text.primary),p=function(e,t,a){(t.source.active||a.show_all_nodes)&&(h(e,t.source,a),e.setEdge(t.source.id,"Mythic",{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name))},h=function(e,t,a){e.setNode(t.id,{label:m(t,a.label_components),node:t,style:u,labelStyle:b,shape:"circle",isParent:!1}),e.setNode(t.host,{label:t.host,clusterLabelPos:"top",style:"fill:".concat(c.palette.graphGroup),node:null,labelStyle:b,isParent:!0}),e.setParent(t.id,t.host),e.setNode(t.host+"mythic_expander",{label:"",shape:"square",node:t,isParent:!1}),e.setParent(t.host+"mythic_expander",t.host)},m=function(e,t){return t.map((function(t){return e[t]})).join(", ")},f=function(e,t,a){if(t.source.active||t.destination.active||a.show_all_nodes){if(a.show_all_nodes)h(e,t.source,a),h(e,t.destination,a);else if(t.source.active&&h(e,t.source,a),t.destination.active&&h(e,t.destination,a),!t.source.active||!t.destination.active)return;1===t.direction?a.packet_flow_view?O(e,t,2):O(e,t,1):(2===t.direction||O(e,t,1),O(e,t,2))}},O=function(e,t,a){1===a?e.setEdge(t.source.id,t.destination.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name):2===a&&e.setEdge(t.destination.id,t.source.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name)},x=new Nr.a.graphlib.Graph({compound:!0,multigraph:!0,directed:!0}).setGraph({rankdir:n.rankDir}).setDefaultEdgeLabel((function(){return{}})),g=Fr.select(t.current),y=g.select("g")._groups[0][0];r=y?g.select("g"):g.append("g");var _=Fr.zoom().on("zoom",(function(){r.attr("transform",Fr.event.transform)}));a&&(g.select("g.output").remove(),g.call(_)),x.setNode("Mythic",{label:"",style:u,shape:"circle",node:null,labelStyle:b}),e.forEach((function(e){(n.include_disconnected||null===e.end_timestamp)&&(e.destination.id===e.source.id?x.hasEdge(e.source.id,"Mythic",e.c2profile.name)?e.id>x.edge(e.source.id,"Mythic",e.c2profile.name).edge_id&&p(x,e,n):p(x,e,n):1===e.direction?n.packet_flow_view?x.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>x.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(x,e,n):f(x,e,n):x.hasEdge(e.source.id,e.destination.id,e.c2profile.name)?e.id>x.edge(e.source.id,e.destination.id,e.c2profile.name).edge_id?f(x,e,n):console.log("doing nothing, dropping data"):f(x,e,n):2===e.direction&&(x.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>x.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(x,e,n):f(x,e,n)))}));var v=new Nr.a.render,k=g.node().getBoundingClientRect().width,w=g.node().getBoundingClientRect().height;if(v.shapes().circle=function(e,t,a){var n=e.insert("image").attr("class","nodeImage").attr("xlink:href",(function(e){return a.node?"/static/"+a.node.payload.payloadtype.ptype+".svg":"/static/mythic.svg"})).attr("x","-20px").attr("y","-20px").attr("width","40px").attr("height","40px").on("mouseover",(function(t){i.mouseover(e,a,t)})).on("mouseout",(function(t){i.mouseout(e,a,t)})).on("click",(function(t){Fr.event.preventDefault(),i.click(e,a,t)})).on("contextmenu",(function(e){Lr(x,a,i.contextmenu,0,0,"#callbacksgraph")}));return a.intersect=function(e){return Nr.a.intersect.circle(a,20,e)},n},v.shapes().square=function(e,t,a){return e.insert("rect").attr("width",(function(e){var t=x.children(a.node.host),i=a.node.host.length;if(void 0!==t&&t.forEach((function(e){x.node(e).label.length>i&&(i=x.node(e).label.length)})),"LR"===n.rankDir)return 9*i+"px";if(void 0!==t){var c=0;return t.forEach((function(e){x.outEdges(e,"Mythic").length>0&&(c+=1)})),(i=9*i-100*c)<0?0:i+"px"}console.log("candidates were undefined")})).attr("height",0)},v(r,x),a){var C=x.graph().width+40,S=x.graph().height+40,D=Math.min(k/C,w/S),I=k/2-C*D/2,$=w/2-S*D/2;g.transition().duration(500).call(_.transform,Fr.zoomIdentity.translate(I,$).scale(D))}r.selectAll("g.nodes g.label").attr("transform","translate(0,30)")},zr=Object(Pe.a)(Br||(Br=Object(B.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function Hr(e){var t=Object(ve.a)();return Object(v.jsxs)("div",{style:{maxWidth:"30%",width:"30%",display:"inline-flex",height:"calc(94vh)",flexDirection:"column"},children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsxs)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:["Callback ",e.callback.id]})}),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsx)(Mr,Object(o.a)({},e.callback))})]})}function Mr(e){l.a.useRef(null);var t=Object(ve.a)(),a=Object(A.a)(I),n=l.a.useState(""),i=Object(j.a)(n,2),c=i[0],r=i[1],d=l.a.useState(!1),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useState(t.palette.success.main),m=Object(j.a)(h,2),f=m[0],O=m[1],x=l.a.useState(!0),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState(!1),w=Object(j.a)(k,2),C=(w[0],w[1],l.a.useState(!1)),S=Object(j.a)(C,2),D=S[0],$=S[1],T=l.a.useState([]),P=Object(j.a)(T,2),E=P[0],F=P[1],L=l.a.useState([]),q=Object(j.a)(L,2),N=q[0],B=q[1],M=l.a.useState(!0),U=Object(j.a)(M,2),G=U[0],K=U[1],Q=l.a.useState([]),J=Object(j.a)(Q,2),Y=J[0],X=J[1];Object(nt.a)(zr,{variables:{operation_id:a.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;X(t.data.callbackgraphedge)}});ye((function(){var t;t=e.last_checkin,r(ge(t))}));Object(s.useEffect)((function(){var t=N.filter((function(t){return!t.c2profile.is_p2p&&t.source.id===e.id&&t.destination.id===e.id})).length;t>0&&!G?K(!0):0===t&&G&&K(!1)}),[N]),Object(s.useEffect)((function(){var t=function(t){for(var a=Y.filter((function(a){return(a.source.id===e.id||a.destination.id===e.id)&&(!t||null===a.end_timestamp)})),n=!0;n;){var i=Y.reduce((function(e,a){return e.includes(a)?Object(R.a)(e):e.filter((function(e){return(e.source.id===a.source.id||e.source.id===a.destination.id||e.destination.id===a.source.id)&&(!t||null===a.end_timestamp)})).length>0?[].concat(Object(R.a)(e),[a]):Object(R.a)(e)}),Object(R.a)(a));n=i.length>a,a=Object(R.a)(i)}return a},a=t(!0),n=t(!1);F(a),B(n)}),[Y,e.id]),Object(s.useEffect)((function(){0===E.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(O(t.palette.error.main),_(!1)):(O(t.palette.success.main),_(!0))}),[E,t.palette.success.main,t.palette.error.main]);e.locked&&e.locked_operator.username,e.locked?Er.a:$r.a,Ai.a;return Object(v.jsx)(W.a,{size:"small",style:{overflow:"scroll"},children:Object(v.jsxs)(z.a,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Elevation Level"}),Object(v.jsxs)(H.a,{children:[e.integrity_level,e.integrity_level>2?" ( Elevated Access )":"",2==e.integrity_level?" ( Medium Integrity ) ":"",e.integrity_level<2?" ( Low Integrity )":""]})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Callback Lock Status"}),Object(v.jsx)(H.a,{children:e.locked?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Er.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(v.jsx)(Z.a,{style:{display:"inline-block"},children:"Unlock (Locked by "+e.locked_operator.username+")"})]}):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)($r.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(v.jsx)(Z.a,{style:{display:"inline-block"},children:"Lock Callback"})]})})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"IP Address"}),Object(v.jsx)(H.a,{children:e.ip})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"External IP"}),Object(v.jsx)(H.a,{children:e.external_ip})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:e.host})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"User"}),Object(v.jsx)(H.a,{children:e.user})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Domain"}),Object(v.jsx)(H.a,{children:e.domain})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"OS / Architecture"}),Object(v.jsxs)(H.a,{children:[e.os,"(",e.architecture,")"]})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Process ID"}),Object(v.jsx)(H.a,{children:e.pid})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Last Checkin"}),Object(v.jsx)(H.a,{children:c})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Description"}),Object(v.jsx)(H.a,{children:e.description})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Sleep Info"}),Object(v.jsx)(H.a,{children:e.sleep_info})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Agent Type"}),Object(v.jsx)(H.a,{children:e.payload.payloadtype.ptype})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Egress Route"}),Object(v.jsx)(H.a,{children:G?Object(v.jsx)(ut.a,{onClick:function(e){e.stopPropagation(),$(!0)},style:{color:f,cursor:"pointer"}}):Object(v.jsx)(Pr.a,{onClick:function(e){e.stopPropagation(),$(!0)},style:{color:f,cursor:"pointer"}})})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Process Name"}),Object(v.jsx)(H.a,{children:e.process_name})]}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:D,onClose:function(){$(!1)},innerDialog:Object(v.jsx)(Rr,Object(o.a)(Object(o.a)({onClose:function(){$(!1)}},e),{},{callbackgraphedges:y?E:N}))}),Object(v.jsx)(he,{fullWidth:!0,open:b,onClose:function(){p(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Callback's Description",onClose:function(){p(!1)},value:e.description,onSubmit:function(t){e.updateDescription({description:t,id:e.id})}})}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Extra Info"}),Object(v.jsx)(H.a,{children:e.extra_info})]})]})})}var Ur=a(145),Vr=a(873),Gr=["children","value","index","maxHeight","tabInfo","getCallbackData","queryParams","changeSearchParam"],Kr=["label","index","fullWidth","maxHeight","onContextMenu","onCloseTab","selectionFollowsFocus","textColor","indicator","tabInfo","onEditTabDescription","getCallbackData"],Qr=["label","index","fullWidth","maxHeight","selectionFollowsFocus","textColor","indicator","iconComponent"];function Jr(e){var t=e.children,a=e.value,n=e.index,i=(e.maxHeight,e.tabInfo,e.getCallbackData,e.queryParams,e.changeSearchParam,Object(Ur.a)(e,Gr)),c=void 0===e.style?{height:"100%",maxHeight:"100%",position:"relative",width:"100%",maxWidth:"100%"}:e.style;return Object(v.jsx)("div",Object(o.a)(Object(o.a)({role:"tabpanel",hidden:a!==n,id:"scrollable-auto-tabpanel-".concat(n),"aria-labelledby":"scrollable-auto-tab-".concat(n),style:c},i),{},{children:a===n?Object(v.jsx)(l.a.Fragment,{children:t}):null}))}function Yr(e){return{id:"scrollable-auto-tab-".concat(e),"aria-controls":"scrollable-auto-tabpanel-".concat(e)}}function Zr(e){var t=e.label,a=e.index,n=(e.fullWidth,e.maxHeight,e.onContextMenu),i=e.onCloseTab,c=(e.selectionFollowsFocus,e.textColor,e.indicator,e.tabInfo),r=(e.onEditTabDescription,e.getCallbackData,Object(Ur.a)(e,Kr));return Object(v.jsx)(Vr.a,Object(o.a)(Object(o.a)({label:Object(v.jsxs)("span",{onContextMenu:n,style:{display:"inline-block"},children:[t,Object(v.jsx)(Y.a,Object(o.a)(Object(o.a)({component:"div",size:"small",onClick:function(e){e.stopPropagation(),i({tabID:c.tabID,index:a})}},r),{},{children:Object(v.jsx)(Za.a,{})}))]})},Yr(a)),r))}function Xr(e){var t=e.label,a=e.index,n=(e.fullWidth,e.maxHeight,e.selectionFollowsFocus,e.textColor,e.indicator,e.iconComponent),i=Object(Ur.a)(e,Qr);return Object(v.jsx)(Vr.a,Object(o.a)(Object(o.a)({label:Object(v.jsxs)("span",{children:[t,Object(v.jsx)("br",{}),n]})},Yr(a)),i))}var eo=a(22),to=a(903),ao=a(878),no=a(877),io=a(449),co=a.n(io),ro=a(876),oo=a(875),so=a(199);function lo(e){try{var t=document.createElement("textarea");return t.value=e,""===t.value&&(t.value=" "),t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(a){return console.log("warning","Failed to copy to clipboard: "+a.toString()),!1}}var uo=a(270),bo=a.n(uo);function jo(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)("img",{onClick:function(){i(!n)},src:e.href,style:{width:n?"":"100%",height:n?"":"100%",cursor:n?"zoom-out":"zoom-in"}})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var po=function(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=(new Date).toUTCString();return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"xl",open:n,onClose:function(){i(!1)},innerDialog:Object(v.jsx)(jo,{href:"/api/v1.4/files/screencaptures/"+e.agent_file_id+"?time="+c,onClose:function(){i(!1)}})}),Object(v.jsx)(m.a,{color:"primary",variant:e.variant?e.variant:"contained",onClick:function(){i(!0)},style:{marginBottom:"10px"},children:e.name})]})},ho=function(e){return Object(v.jsx)("pre",{style:{margin:0,padding:0,wordBreak:"break-all",whiteSpace:"pre-wrap"},children:e.plaintext})},mo=a(107),fo=(a(321),a(185)),Oo=a.n(fo),xo=a(186),go=a.n(xo),yo=a(187),_o=a.n(yo);function vo(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),o=r[0],d=r[1],u=Object(s.useRef)(null),b=Object(ve.a)();return Object(s.useEffect)((function(){var t=Object(R.a)(e.options);i(t),t.length>0?d(t[0]):d("")}),[e.options]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{children:e.title}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(Dt.a,{style:{width:"100%"},children:[Object(v.jsx)(Mt.a,{ref:u,children:"Options"}),Object(v.jsxs)(It.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:o,onChange:function(e){d(e.target.value)},input:Object(v.jsx)(Tt.a,{style:{width:"100%"}}),children:[Object(v.jsx)(Ot.a,{value:"",children:Object(v.jsx)("em",{children:"None"})}),n.map((function(t){return Object(v.jsx)(Ot.a,{value:t,children:t[e.display]},t[e.identifier])}))]})]})})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.onSubmit(o),e.onClose()},variant:"contained",style:{backgroundColor:b.palette.success.main},children:e.action})]})]})}var ko,wo,Co,So={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},Do=Object(h.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}}));function Io(e){var t=l.a.useState("plaintext"),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState(""),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useState(""),f=Object(j.a)(h,2),O=f[0],x=f[1],g=l.a.useState(""),y=Object(j.a)(g,2),_=y[0],k=y[1],C=Do();return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Register New Credential"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(Dt.a,{className:C.formControl,children:[Object(v.jsx)(Mt.a,{id:"operator-chip-label",children:"Which Type of Credential"}),Object(v.jsx)(It.a,{labelId:"operator-chip-label",id:"operator-chip",value:n,onChange:function(e){i(e.target.value)},input:Object(v.jsx)(Tt.a,{}),MenuProps:So,children:["plaintext","ticket","hash","certificate","key","hex"].map((function(e){return Object(v.jsx)(Ot.a,{value:e,children:Object(v.jsx)(Ea.a,{primary:e})},e)}))})]}),Object(v.jsx)(w,{value:o,onChange:function(e,t,a){s(t)},name:"Account Name"}),Object(v.jsx)(w,{value:b,onChange:function(e,t,a){p(t)},name:"Realm or Domain"}),Object(v.jsx)(w,{value:_,onChange:function(e,t,a){k(t)},name:"Comment"}),Object(v.jsx)(w,{multiline:!0,value:O,onChange:function(e,t,a){x(t)},name:"Credential"})]})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.onSubmit({realm:b,account:o,comment:_,credential:O,type:n}),e.onClose()},color:"primary",variant:"contained",children:"Create"})]})]})}var $o,To,Po,Ao,Eo,Fo,Lo,qo,No,Ro=Object(Pe.a)(ko||(ko=Object(B.a)(["\nmutation getDynamicParamsMutation($callback: Int!, $command: String!, $payload_type: String!, $parameter_name: String!){\n    dynamic_query_function(callback: $callback, command: $command, payload_type: $payload_type, parameter_name: $parameter_name){\n        status\n        error\n        choices\n    }\n}\n"]))),Bo=Object(Pe.a)(wo||(wo=Object(B.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),Wo=Object(Pe.a)(Co||(Co=Object(B.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      ...credentialData\n    }\n  }\n"])),Bo);function zo(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(ve.a)(),r=l.a.useState([]),d=Object(j.a)(r,2),u=d[0],p=d[1],h=l.a.useState(!1),f=Object(j.a)(h,2),O=f[0],x=f[1],g=l.a.useState([]),y=Object(j.a)(g,2),_=y[0],k=y[1],C=l.a.useState([]),S=Object(j.a)(C,2),D=S[0],I=S[1],$=l.a.useState(""),T=Object(j.a)($,2),P=T[0],A=T[1],E=l.a.useState([]),F=Object(j.a)(E,2),L=F[0],N=F[1],B=l.a.useState(0),Q=Object(j.a)(B,2),J=Q[0],Y=Q[1],X=l.a.useState(0),ee=Object(j.a)(X,2),te=ee[0],ae=ee[1],ne=l.a.useState([]),ce=Object(j.a)(ne,2),re=ce[0],oe=ce[1],se=l.a.useState(0),le=Object(j.a)(se,2),de=le[0],ue=le[1],be=l.a.useState([]),je=Object(j.a)(be,2),pe=je[0],me=je[1],fe=l.a.useState(0),Oe=Object(j.a)(fe,2),xe=Oe[0],ge=Oe[1],ye=l.a.useState(!1),_e=Object(j.a)(ye,2),ke=_e[0],we=_e[1],Ce=l.a.useState(!1),Se=Object(j.a)(Ce,2),De=Se[0],Ie=Se[1],$e=l.a.useState({name:""}),Te=Object(j.a)($e,2),Pe=Te[0],Ae=Te[1],Fe=Object(Ee.a)(Ro,{onCompleted:function(t){"success"===t.dynamic_query_function.status?(p(Object(R.a)(t.dynamic_query_function.choices)),"Choice"===e.type&&t.dynamic_query_function.choices.length>0&&(i(t.dynamic_query_function.choices[0]),e.onChange(e.name,t.dynamic_query_function.choices[0],!1))):q.warning("Failed to fetch dynamic parameter query: "+t.dynamic_query_function.error)},onError:function(e){q.warning("Failed to perform dynamic parameter query"),console.log(e)}}),Le=Object(j.a)(Fe,1)[0],qe=Object(Ee.a)(Wo,{fetchPolicy:"no-cache",onCompleted:function(e){q.success("Successfully created new credential"),p([].concat(Object(R.a)(u),[Object(o.a)({},e.insert_credential_one)]))},onError:function(e){q.error("Failed to create credential"),console.log(e)}}),Ne=Object(j.a)(qe,1)[0];Object(s.useEffect)((function(){if(null!==e.dynamic_query_function&&0===u.length&&Le({variables:{callback:e.callback_id,parameter_name:e.name,command:e.commandInfo.cmd,payload_type:e.commandInfo.payloadtype.ptype}}),"Boolean"===e.type)""===n&&(x(e.value),i(e.value));else if("Array"===e.type)0===_.length&&e.value.length>0&&k(e.value);else if("ChoiceMultiple"===e.type&&null===e.dynamic_query_function)""===n&&(I(e.value),i(e.value));else if("AgentConnect"===e.type)if(e.choices.length>0){var t=0;te<e.choices.length?t=te:ae(0),N(e.choices);var a=0;de<e.choices[t].length?a=de:ue(0),oe(e.choices[t].payloads),e.choices[t].payloads.length>0?e.choices[t].payloads[a].c2info.length>0&&me(e.choices[t].payloads[a].c2info):q.warning("No available payloads with a P2P profile created")}else N([]),me([]),q.warning("No available payloads with a P2P profile created");else""===n&&("Number"===e.type?""===e.default_value?i(0):i(parseInt(e.default_value)):i(e.default_value)),null===e.dynamic_query_function&&""===n&&(p(Object(R.a)(e.choices)),e.choices.length>0&&""===e.default_value?(i(e.choices[0]),e.onChange(e.name,e.choices[0],!1)):e.choices.length>0&&(i(e.default_value),e.onChange(e.name,e.default_value,!1)))}),[e.choices,e.default_value,e.type,e.value,x,n]);var Re=function(t,a,n){var i=e.choices[t].payloads[a].c2info[n].parameters.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,t.value))}),{}),c={host:e.choices[t].host,agent_uuid:e.choices[t].payloads[a].uuid,c2_profile:{name:e.choices[t].payloads[a].c2info[n].name,parameters:i}};"callback"===e.choices[t].payloads[a].type?c.callback_uuid=e.choices[t].payloads[a].agent_callback_id:c.callback_uuid="",e.onChange(e.name,c,!1)},Be=function(t){i(t.target.value),e.onChange(e.name,t.target.value,!1)},We=function(t){i(t.target.value),e.onChange(e.name,u[t.target.value],!1)},ze=function(t){for(var a=t.target.options,n=[],c=0,r=a.length;c<r;c+=1)a[c].selected&&n.push(a[c].value);I(n),i(n),e.onChange(e.name,n,!1)},He=function(t,a,n){i(a),e.onChange(e.name,a,n)},Me=function(t,a,n){i(parseInt(a)),e.onChange(e.name,parseInt(a),n)},Ue=function(t,a){x(a),i(a),e.onChange(t,a)},Ve=function(t){var a=new FileReader;a.onload=function(a){var n=btoa(a.target.result);Ae({name:t.target.files[0].name,contents:n}),e.onChange(e.name,{name:t.target.files[0].name,contents:n})},a.readAsBinaryString(t.target.files[0])},Ge=function(t){ae(t.target.value),oe(e.choices[t.target.value].payloads),e.choices[t.target.value].payloads.length>0?(ue(0),e.choices[t.target.value].payloads[0].c2info.length>0?(me(e.choices[0].payloads[0].c2info),ge(0),Re(t.target.value,0,0)):(me([]),ge(null))):(oe([]),ue(null),me([]),ge(null))},Ke=function(t){ue(t.target.value),me(e.choices[te].payloads[t.target.value].c2info),e.choices[te].payloads[t.target.value].c2info.length>0?(ge(0),Re(te,t.target.value,0)):ge(null)},Qe=function(e){ge(e.target.value),Re(te,de,e.target.value)},Je=function(e,t,a){A(t)},Ye=function(e){Y(e.target.value)},Ze=function(){""!==P?(e.onAgentConnectAddNewPayloadOnHost(P.toUpperCase(),e.payload_choices[J].id),we(!1)):q.error("Must set a hostname")},Xe=function(){e.choices[te].payloads[de].payloadOnHostID?e.onAgentConnectRemovePayloadOnHost(e.choices[te].payloads[de].payloadOnHostID):q.warning("Can't remove a callback")},et=function(t){return(e.required&&""!==e.verifier_regex||""!==e.verifier_regex&&""!==t)&&!RegExp(e.verifier_regex).test(t)},tt=function(){var t=[].concat(Object(R.a)(_),[""]);k(t),e.onChange(e.name,t,!1)},at=function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,c=e.credential;Ne({variables:{type:t,account:a,realm:n,comment:i,credential:c}})},nt=l.a.useState(null),it=Object(j.a)(nt,2),ct=it[0],rt=it[1],ot=Boolean(ct),st=function(){rt(null)};return Object(v.jsxs)(V.a,{children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Z.a,{"aria-haspopup":"true",onMouseEnter:function(e){rt(e.currentTarget)},onMouseLeave:st,"aria-owns":ot?"taskparam"+e.id+"popover":void 0,children:e.name}),e.required?Object(v.jsx)(Z.a,{component:"div",style:{color:c.palette.warning.main},children:"Required"}):null,Object(v.jsx)(qt.a,{id:"taskparam"+e.id+"popover",open:ot,anchorEl:ct,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:st,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===c.palette.type?c.palette.primary.dark:c.palette.primary.light,color:"white"},variant:"outlined"},children:Object(v.jsx)(Z.a,{children:e.description.length>0?e.description:"No Description"})})]}),Object(v.jsx)(H.a,{children:function(){switch(e.type){case"Choice":case"ChoiceMultiple":return Object(v.jsx)(Dt.a,{style:{width:"100%"},children:Object(v.jsx)(It.a,{native:!0,autoFocus:e.autoFocus,multiple:"ChoiceMultiple"===e.type,value:"ChoiceMultiple"===e.type?D:n,onChange:"ChoiceMultiple"===e.type?ze:Be,input:Object(v.jsx)(Tt.a,{}),children:u.map((function(t,a){return Object(v.jsx)("option",{value:t,children:t},e.name+a)}))})});case"Array":return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:[Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"}}),Object(v.jsx)(H.a,{})]}),Object(v.jsxs)(z.a,{children:[_.map((function(t,a){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{onClick:function(){return function(t){var a=Object(R.a)(_);a.splice(t,1),k(a),e.onChange(e.name,a,!1)}(a)},color:"secondary",variant:"outlined",size:"small",children:"X"})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(w,{required:e.required,placeholder:"",value:t,multiline:!1,autoFocus:e.autoFocus&&0===a,onChange:function(t,n,i){return function(t,a,n){var i=Object(R.a)(_);i[n]=t,k(i),e.onChange(e.name,i,!1)}(n,0,a)},display:"inline-block",onEnter:tt,validate:et,errorText:"Must match: "+e.verifier_regex})})]},"array"+e.name+a)})),Object(v.jsx)(V.a,{hover:!0,children:Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{onClick:tt,size:"small",variant:"outlined",color:"primary",children:"+"})})})]})]})});case"String":return Object(v.jsx)(w,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,onChange:He,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:et,errorText:"Must match: "+e.verifier_regex});case"Number":return Object(v.jsx)(w,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,type:"number",onChange:Me,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:et,errorText:"Must match: "+e.verifier_regex});case"Boolean":return Object(v.jsx)(K.a,{checked:O,onChange:Ue});case"File":return Object(v.jsxs)(m.a,{variant:"contained",component:"label",children:[""===Pe.name?"Select File":Pe.name,Object(v.jsx)("input",{onChange:Ve,type:"file",hidden:!0})," "]});case"LinkInfo":return Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:function(t){!function(t){var a,n=(a=e.choices[t].source.id===e.callback_id?e.choices[t].source:e.choices[t].destination).c2profileparametersinstances.reduce((function(a,n){return n.c2_profile_id===e.choices[t].c2profile.id?Object(o.a)(Object(o.a)({},a),{},Object(b.a)({},n.c2profileparameter.name,n.c2profileparameter.crypto_type?{crypto_type:n.c2profileparameter.crypto_type,enc_key:n.enc_key,dec_key:n.dec_key}:n.value)):Object(o.a)({},a)}),{}),c={host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:e.choices[t].c2profile.name,parameters:n}};e.onChange(e.name,c,!1),i(t)}(t.target.value)},input:Object(v.jsx)(Tt.a,{}),children:e.choices.map((function(t,a){return Object(v.jsx)("option",{value:a,children:t.display},e.name+a)}))})});case"PayloadList":return Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Be,input:Object(v.jsx)(Tt.a,{}),children:e.choices.map((function(t,a){return Object(v.jsx)("option",{value:t.uuid,children:t.display},e.name+a)}))})});case"AgentConnect":return Object(v.jsxs)(M.a,{component:G.a,className:"mythicElement",children:[Object(v.jsx)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:Object(v.jsxs)(z.a,{children:[ke?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"6em"},children:"Hostname"}),Object(v.jsx)(H.a,{children:Object(v.jsx)(w,{required:!0,placeholder:"hostname",value:P,multiline:!1,autoFocus:e.autoFocus,onChange:Je,display:"inline-block"})})]}),Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Payload on that host"}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:J,onChange:Ye,input:Object(v.jsx)(Tt.a,{}),children:e.payload_choices?e.payload_choices.map((function(t,a){return Object(v.jsx)("option",{value:a,children:t.display},e.name+"newpayload"+a)})):Object(v.jsx)("option",{value:"-1",children:"No Payloads"},e.name+"nooptionnewpayload")})})})]}),Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:Object(v.jsxs)(m.a,{component:"span",style:{color:c.palette.success.main,padding:0},onClick:Ze,children:[Object(v.jsx)(At.a,{}),"Add"]})}),Object(v.jsx)(H.a,{children:Object(v.jsxs)(m.a,{component:"span",style:{color:c.palette.warning.main,padding:0},onClick:function(){we(!1)},children:[Object(v.jsx)(Gc.a,{}),"Cancel"]})})]})]}):null,Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"6em"},children:"Host"}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:te,onChange:Ge,input:Object(v.jsx)(Tt.a,{}),children:L.map((function(t,a){return Object(v.jsx)("option",{value:a,children:t.host},e.name+"connecthost"+a)}))})})})]}),Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Payload"}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:de,onChange:Ke,input:Object(v.jsx)(Tt.a,{}),children:re.map((function(t,a){return Object(v.jsx)("option",{value:a,children:t.display},e.name+"connectagent"+a)}))})})})]}),!ke&&Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:Object(v.jsxs)(m.a,{component:"span",style:{color:c.palette.success.main,padding:0},onClick:function(){we(!0)},children:[Object(v.jsx)(At.a,{}),"Add"]})}),Object(v.jsx)(H.a,{children:Object(v.jsxs)(m.a,{component:"span",style:{color:c.palette.error.main,padding:0},onClick:Xe,children:[Object(v.jsx)(ie.a,{}),"Remove"]})})]}),Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"C2 Profile"}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Dt.a,{children:Object(v.jsx)(It.a,{native:!0,value:xe,onChange:Qe,input:Object(v.jsx)(Tt.a,{}),children:pe.map((function(t,a){return Object(v.jsx)("option",{value:a,children:t.name},e.name+"connectprofile"+a)}))})})})]})]})}),pe.length>0?Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"30%"},children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:pe[xe].parameters.map((function(t,a){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:t.name}),Object(v.jsx)(H.a,{children:Object(v.jsx)("pre",{children:JSON.stringify(t.value,null,2)})})]},"agentconnectparameters"+e.name+a)}))})]}):null]});case"Credential-JSON":return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:De,onClose:function(){Ie(!1)},innerDialog:Object(v.jsx)(Io,{onSubmit:at,onClose:function(){Ie(!1)}})}),Object(v.jsx)(Dt.a,{style:{width:"100%"},children:Object(v.jsx)(It.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:We,input:Object(v.jsx)(Tt.a,{}),children:u.map((function(t,a){return Object(v.jsx)("option",{value:a,children:t.account+"@"+t.realm+" - "+t.credential_text.substring(0,10)+" - "+t.comment},e.name+a)}))})}),Object(v.jsx)(m.a,{size:"small",color:"primary",onClick:function(){Ie(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Account":return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:De,onClose:function(){Ie(!1)},innerDialog:Object(v.jsx)(Io,{onSubmit:at,onClose:function(){Ie(!1)}})}),Object(v.jsx)(Dt.a,{style:{width:"100%"},children:Object(v.jsx)(It.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Be,input:Object(v.jsx)(Tt.a,{}),children:u.map((function(t,a){return Object(v.jsx)("option",{value:t.account,children:t.comment.length>0?t.comment+" ( "+t.account+" )":t.account},e.name+a)}))})}),Object(v.jsx)(m.a,{size:"small",color:"primary",onClick:function(){Ie(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Realm":return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:De,onClose:function(){Ie(!1)},innerDialog:Object(v.jsx)(Io,{onSubmit:at,onClose:function(){Ie(!1)}})}),Object(v.jsx)(Dt.a,{style:{width:"100%"},children:Object(v.jsx)(It.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Be,input:Object(v.jsx)(Tt.a,{}),children:u.map((function(t,a){return Object(v.jsx)("option",{value:t.realm,children:t.comment.length>0?t.comment+" ( "+t.realm+" )":t.realm},e.name+a)}))})}),Object(v.jsx)(m.a,{size:"small",color:"primary",onClick:function(){Ie(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Type":return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:De,onClose:function(){Ie(!1)},innerDialog:Object(v.jsx)(Io,{onSubmit:at,onClose:function(){Ie(!1)}})}),Object(v.jsx)(Dt.a,{style:{width:"100%"},children:Object(v.jsx)(It.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Be,input:Object(v.jsx)(Tt.a,{}),children:u.map((function(t,a){return Object(v.jsx)("option",{value:t.type,children:t.type},e.name+a)}))})}),Object(v.jsx)(m.a,{size:"small",color:"primary",onClick:function(){Ie(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Credential":return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:De,onClose:function(){Ie(!1)},innerDialog:Object(v.jsx)(Io,{onSubmit:at,onClose:function(){Ie(!1)}})}),Object(v.jsx)(Dt.a,{style:{width:"100%"},children:Object(v.jsx)(It.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Be,input:Object(v.jsx)(Tt.a,{}),children:u.map((function(t,a){return Object(v.jsx)("option",{value:t.credential_text,style:{textOverflow:"ellipsis"},children:t.comment.length>0?t.comment+" ( "+t.credential_text+" )":t.credential_text},e.name+a)}))})}),Object(v.jsx)(m.a,{size:"small",color:"primary",onClick:function(){Ie(!0)},variant:"contained",children:"New Credential"})]});default:return null}}()})]},"buildparam"+e.id)}var Ho,Mo=Object(Pe.a)($o||($o=Object(B.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}}) {\n    id\n    command {\n      cmd\n      attributes\n      id\n    }\n  }\n}\n"]))),Uo=Object(Pe.a)(To||(To=Object(B.a)(["\nquery getAllCommandsQuery($payload_type_id: Int!){\n    command(where: {payload_type_id: {_eq: $payload_type_id}, deleted: {_eq: false}}) {\n        attributes\n        cmd\n        id\n    }\n}\n"]))),Vo=Object(Pe.a)(Po||(Po=Object(B.a)(["\nquery getAllEdgesQuery($callback_id: Int!){\n    callbackgraphedge(where: {_or: [{source_id:{_eq: $callback_id}}, {destination_id: {_eq: $callback_id}}]}) {\n        id\n        c2profile {\n          id\n          name\n        }\n        direction\n        destination{\n            agent_callback_id\n            host\n            id\n            payload {\n              id\n              uuid\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              value\n              id\n              c2_profile_id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        source{\n            agent_callback_id\n            host\n            id\n            payload {\n              uuid\n              id\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              c2_profile_id\n              value\n              id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        end_timestamp\n      }\n    }\n"]))),Go=Object(Pe.a)(Ao||(Ao=Object(B.a)(['\nquery getAllPayloadsQuery($operation_id: Int!){\n    payload(where: {deleted: {_eq: false}, build_phase: {_eq: "success"}, operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    uuid\n    payloadc2profiles {\n      id\n      c2profile {\n        name\n        id\n      }\n    }\n    payloadtype{\n        id\n        ptype\n    }\n    filemetum {\n        id\n        filename_text\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        name\n        id\n      }\n    }\n  }\n}\n']))),Ko=Object(Pe.a)(Eo||(Eo=Object(B.a)(["\nquery getAllPayloadsOnHostsQuery($operation_id: Int!){\n    payloadonhost(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, payload: {c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}}) {\n        host\n        id\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n            c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n                c2profile {\n                    name\n                    id\n                }\n                c2profileparameter {\n                    crypto_type\n                    name\n                    id\n                }\n                value\n                enc_key_base64\n                dec_key_base64\n                id\n            }\n        }\n    }\n    callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}, c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}){\n        agent_callback_id\n        host\n        id\n        description\n        crypto_type\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n        }\n        c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n            c2profile {\n                name\n                id\n            }\n            c2profileparameter {\n                crypto_type\n                name\n                id\n            }\n            value\n            enc_key_base64\n            dec_key_base64\n            id\n        }\n    }\n}\n"]))),Qo=Object(Pe.a)(Fo||(Fo=Object(B.a)(["\n    mutation addPayloadOnHostMutation($host: String!, $payload_id: Int!){\n        insert_payloadonhost(objects: {host: $host, payload_id: $payload_id}) {\n            affected_rows\n          }\n    }\n"]))),Jo=Object(Pe.a)(Lo||(Lo=Object(B.a)(["\n    mutation removePayloadOnHostMutation($payloadOnHostID: Int!){\n        delete_payloadonhost_by_pk(id: $payloadOnHostID) {\n            id\n          }\n    }\n"]))),Yo=Object(Pe.a)(qo||(qo=Object(B.a)(["\nquery getCommandQuery($id: Int!){\n  command_by_pk(id: $id) {\n    attributes\n    author\n    cmd\n    description\n    help_cmd\n    id\n    needs_admin\n    version\n    payloadtype{\n        ptype\n    }\n    commandparameters {\n      choice_filter_by_command_attributes\n      choices\n      choices_are_all_commands\n      choices_are_loaded_commands\n      default_value\n      description\n      id\n      name\n      required\n      supported_agent_build_parameters\n      supported_agents\n      type\n      dynamic_query_function\n      ui_position\n    }\n    commandopsec {\n      authentication\n      id\n      injection_method\n      process_creation\n    }\n  }\n}\n"]))),Zo=Object(Pe.a)(No||(No=Object(B.a)(["\nquery getCredentialsQuery($operation_id: Int!){\n    credential(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}}){\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n    }\n}\n"])));function Xo(e){var t=Object(s.useState)({}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(s.useState)([]),r=Object(j.a)(c,2),d=r[0],u=r[1],p=Object(s.useState)(!1),h=Object(j.a)(p,2),f=h[0],O=h[1],x=Object(s.useState)({all:!1,loaded:!1,edges:!1,credentials:!1}),g=Object(j.a)(x,2),y=g[0],_=g[1],k=Object(St.a)(Uo,{fetchPolicy:"no-cache"}),w=Object(j.a)(k,2),C=w[0],S=w[1].data,D=Object(St.a)(Mo,{fetchPolicy:"no-cache"}),I=Object(j.a)(D,2),$=I[0],T=I[1].data,P=Object(St.a)(Vo,{fetchPolicy:"no-cache"}),A=Object(j.a)(P,2),E=A[0],F=A[1].data,L=Object(St.a)(Go,{fetchPolicy:"no-cache"}),q=Object(j.a)(L,2),N=q[0],B=q[1].data,K=Object(St.a)(Ko,{fetchPolicy:"no-cache"}),Q=Object(j.a)(K,2),J=Q[0],Y=Q[1].data,X=Object(St.a)(Zo,{fetchPolicy:"no-cache"}),ee=Object(j.a)(X,2),te=ee[0],ae=ee[1].data,ne=Object(Ee.a)(Qo,{onCompleted:function(t){J({variables:{operation_id:e.operation_id}})}}),ie=Object(j.a)(ne,1)[0],ce=Object(Ee.a)(Jo,{onCompleted:function(t){J({variables:{operation_id:e.operation_id}})}}),re=Object(j.a)(ce,1)[0];Object(Ae.a)(Yo,{variables:{id:e.command.id},onCompleted:function(t){var a={all:!1,loaded:!1,edges:!1,credentials:!1};t.command_by_pk.commandparameters.forEach((function(e){"LinkInfo"===e.type?a.edges=!0:e.choices_are_all_commands?a.all=!0:e.choices_are_loaded_commands?a.loaded=!0:"AgentConnect"===e.type?(a.connect=!0,a.payloads=!0):"PayloadList"===e.type?a.payloads=!0:e.type.includes("Credential")&&(a.credentials=!0)})),i(Object(o.a)({},t.command_by_pk)),a.edges&&E({variables:{callback_id:e.callback_id}}),a.all&&C({variables:{payload_type_id:e.payloadtype_id}}),a.loaded&&$({variables:{callback_id:e.callback_id}}),a.payloads&&N({variables:{operation_id:e.operation_id}}),a.connect&&J({variables:{operation_id:e.operation_id}}),a.credentials&&te({variables:{operation_id:e.operation_id}}),_(a),O(Object(o.a)({},t))}});var oe=function(e,t){var a=new Set(t);return Object(R.a)(new Set(e)).filter((function(e){return a.has(e)}))};Object(s.useEffect)((function(){var t=function(t){if(t.length>0){var a=t[0].payloads[0].c2info[0].parameters.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,t.value))}),{}),n={host:t[0].host,agent_uuid:t[0].payloads[0].uuid,c2_profile:{name:t[0].payloads[0].c2info[0].name,parameters:a}};return"callback"===t[0].payloads[0].type&&(n.callback_uuid=e.choices[0].payloads[0].agent_callback_id),n}return{}},a=function(t){var a;if(t.length>0){var n=(a=t[0].source.id===e.callback_id?t[0].source:t[0].destination).c2profileparametersinstances.reduce((function(e,a){return a.c2_profile_id===t[0].c2profile.id?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},a.c2profileparameter.name,a.c2profileparameter.crypto_type?{crypto_type:a.c2profileparameter.crypto_type,enc_key:a.enc_key_base64,dec_key:a.dec_key_base64}:a.value)):Object(o.a)({},e)}),{});return{host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:t[0].c2profile.name,parameters:n}}}return{}};if(f&&(!y.loaded||T)&&(!y.all||S)&&(!y.edges||F)&&(!y.payloads||B)&&(!y.connect||Y)&&(!y.credentials||ae)){var n=f.command_by_pk.commandparameters.map((function(e){switch(e.type){case"Boolean":return e.default_value?Object(o.a)(Object(o.a)({},e),{},{value:"true"===e.default_value.toLowerCase()}):Object(o.a)(Object(o.a)({},e),{},{value:!1});case"String":return Object(o.a)(Object(o.a)({},e),{},{value:e.default_value});case"Number":return Object(o.a)(Object(o.a)({},e),{},{value:""===e.default_value?0:parseInt(e.default_value)});case"Array":return e.default_value.length>0?Object(o.a)(Object(o.a)({},e),{},{value:JSON.parse(e.default_value)}):Object(o.a)(Object(o.a)({},e),{},{value:[]});case"Choice":case"ChoiceMultiple":var n=e.choices.split("\n"),i=e.default_value;"ChoiceMultiple"===e.type?i=""!==e.default_value?JSON.parse(e.default_value):[]:n.length>0&&(i=""===e.default_value?n[0]:e.default_value);var c=JSON.parse(e.choice_filter_by_command_attributes);return e.choices_are_all_commands?(n=(n=Object(R.a)(S.command)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.attributes),i=0,r=Object.entries(c);i<r.length;i++){var o=Object(j.a)(r[i],2),s=o[0],l=o[1];"spawn_and_injectable"===s?l!==n[s]&&(a=!1):"supported_os"===s&&l.length>0&&0===oe(l,n[s]).length&&(a=!1)}return a?[].concat(Object(R.a)(e),[t.cmd]):e}),[])).length>0&&(i="ChoiceMultiple"===e.type?[]:n[0]):e.choices_are_loaded_commands&&(n=(n=Object(R.a)(T.loadedcommands)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.command.attributes),i=0,r=Object.entries(c);i<r.length;i++){var o=Object(j.a)(r[i],2),s=o[0],l=o[1];"spawn_and_injectable"===s?l!==n[s]&&(a=!1):"supported_os"===s&&l.length>0&&0===oe(l,n[s]).length&&(a=!1)}return a?[].concat(Object(R.a)(e),[t.command.cmd]):e}),[])).length>0&&(i="ChoiceMultiple"===e.type?[]:n[0]),Object(o.a)(Object(o.a)({},e),{},{choices:n,default_value:i,value:i});case"File":return Object(o.a)(Object(o.a)({},e),{},{value:{}});case"Credential-JSON":return ae.credential.length>0?Object(o.a)(Object(o.a)({},e),{},{value:ae.credential[0],choices:ae.credential}):Object(o.a)(Object(o.a)({},e),{},{value:{},choices:[]});case"Credential-Account":return ae.credential.length>0?Object(o.a)(Object(o.a)({},e),{},{value:ae.credential[0].account,choices:ae.credential}):Object(o.a)(Object(o.a)({},e),{},{value:"",choices:[]});case"Credential-Realm":return ae.credential.length>0?Object(o.a)(Object(o.a)({},e),{},{value:ae.credential[0].realm,choices:ae.credential}):Object(o.a)(Object(o.a)({},e),{},{value:"",choices:[]});case"Credential-Type":return ae.credential.length>0?Object(o.a)(Object(o.a)({},e),{},{value:ae.credential[0].type,choices:ae.credential}):Object(o.a)(Object(o.a)({},e),{},{value:"",choices:[]});case"Credential-Credential":return ae.credential.length>0?Object(o.a)(Object(o.a)({},e),{},{value:ae.credential[0].credential_text,choices:ae.credential}):Object(o.a)(Object(o.a)({},e),{},{value:"",choices:[]});case"AgentConnect":var r=B.payload.reduce((function(e,t){var a=t.payloadc2profiles.reduce((function(e,t){return[].concat(Object(R.a)(e),[t.c2profile.name])}),[]).join(",");return[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{display:t.filemetum.filename_text+" - "+a+" - "+t.tag})])}),[]),s=Y.callback.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;for(var n=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[].concat(Object(R.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),i=[],c=0,r=Object.entries(n);c<r.length;c++){var s=Object(j.a)(r[c],2),l=s[0],d=s[1];i.push({name:l,parameters:d})}var u=Object(o.a)(Object(o.a)(Object(o.a)({},t.registered_payload),{},{c2info:i,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return Object(o.a)(Object(o.a)({},e),{},{payloads:[].concat(Object(R.a)(e.payloads),[u])})}return e}));if(a)return n;for(var i=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[].concat(Object(R.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),c=[],r=0,s=Object.entries(i);r<s.length;r++){var l=Object(j.a)(s[r],2),d=l[0],u=l[1];c.push({name:d,parameters:u})}var p=Object(o.a)(Object(o.a)(Object(o.a)({},t.registered_payload),{},{c2info:c,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return[].concat(Object(R.a)(e),[{host:t.host,payloads:[p]}])}),[]),l=Y.payloadonhost.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;var n=!1;if(e.payloads.forEach((function(e){e.id===t.payload.id&&(n=!0)})),n)return e;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[].concat(Object(R.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),c=[],r=0,s=Object.entries(i);r<s.length;r++){var l=Object(j.a)(s[r],2),d=l[0],u=l[1];c.push({name:d,parameters:u})}var p=Object(o.a)(Object(o.a)({},t.payload),{},{c2info:c,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return Object(o.a)(Object(o.a)({},e),{},{payloads:[].concat(Object(R.a)(e.payloads),[p])})}return e}));if(a)return n;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[].concat(Object(R.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),c=[],r=0,s=Object.entries(i);r<s.length;r++){var l=Object(j.a)(s[r],2),d=l[0],u=l[1];c.push({name:d,parameters:u})}var p=Object(o.a)(Object(o.a)({},t.payload),{},{c2info:c,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return[].concat(Object(R.a)(e),[{host:t.host,payloads:[p]}])}),[]),d=s.reduce((function(e,t){var a=e.findIndex((function(e){return e.host===t.host}));return a>-1?(e[a].payloads=[].concat(Object(R.a)(e[a].payloads),Object(R.a)(t.payloads)),Object(R.a)(e)):[].concat(Object(R.a)(e),[Object(o.a)({},t)])}),Object(R.a)(l));return console.log("updating choices and payload choices",d,r),Object(o.a)(Object(o.a)({},e),{},{choices:d,payload_choices:r,value:t(l)});case"PayloadList":var u=e.supported_agents.split(",");-1!==u.indexOf("")&&u.splice(u.indexOf(""));var p=JSON.parse(e.supported_agent_build_parameters),h=B.payload.reduce((function(e,t){var a=t.payloadc2profiles.reduce((function(e,t){return[].concat(Object(R.a)(e),[t.c2profile.name])}),[]).join(",");if(u.length>0&&!u.includes(t.payloadtype.ptype))return e;var n=!0;if(t.payloadtype.ptype in p)for(var i=function(){var e=Object(j.a)(r[c],2),a=e[0],i=e[1];t.buildparameterinstances.forEach((function(e){e.buildparameter.name===a&&e.parameter!==i&&(n=!1)}))},c=0,r=Object.entries(p[t.payloadtype.ptype]);c<r.length;c++)i();return n?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{display:t.filemetum.filename_text+" - "+a+" - "+t.tag})]):e}),[]);return h.length>0?Object(o.a)(Object(o.a)({},e),{},{choices:h,default_value:h[0].uuid,value:h[0].uuid}):Object(o.a)(Object(o.a)({},e),{},{choices:h,value:null});case"LinkInfo":var m=F.callbackgraphedge.reduce((function(e,t){return t.source.id===t.destination.id?e:1===t.direction?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{display:"Callback "+t.source.id+" --"+t.c2profile.name+"--\x3e Callback "+t.destination.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):2===t.direction?[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{display:"Callback "+t.destination.id+"-> "+t.c2profile.name+"--\x3e Callback "+t.source.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):e}),[]);return m.length>0?Object(o.a)(Object(o.a)({},e),{},{choices:m,value:a(m)}):Object(o.a)(Object(o.a)({},e),{},{choices:m,value:{}});default:return Object(o.a)({},e)}})).sort((function(e,t){return e.ui_position>t.ui_position?1:-1}));n.length>0&&(n[0].autoFocus=!0),u(n)}}),[f,T,S,F,y,B,ae,Y,e.callback_id,e.choices]);var de=function(){var t=d.reduce((function(e,t){switch(t.type){case"String":case"Boolean":case"Number":case"Choice":case"ChoiceMultiple":case"Credential-Account":case"Credential-Realm":case"Credential-Type":case"Credential-Credential":case"AgentConnect":case"PayloadList":case"Array":case"LinkInfo":return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,t.value));case"File":return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,t.value.name));case"Credential-JSON":return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,{account:t.value.account,comment:t.value.comment,credential:t.value.credential_text,realm:t.value.realm,type:t.value.type}));default:return Object(o.a)({},e)}}),{}),a=d.reduce((function(e,t){return"File"===t.type?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.name,t.value.contents)):Object(o.a)({},e)}),{});e.onSubmit(e.command.cmd,JSON.stringify(t),JSON.stringify(a))},be=function(e,t){ie({variables:{host:e,payload_id:t}})},je=function(e){re({variables:{payloadOnHostID:e}})},pe=function(e,t,a){var n=d.map((function(a){return a.name===e?Object(o.a)(Object(o.a)({},a),{},{value:t}):Object(o.a)({},a)}));u(n)};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{id:"form-dialog-title",children:[e.command.cmd,"'s Parameters"]}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsxs)(Z.a,{component:"div",children:[Object(v.jsx)("b",{children:"Help"})," ",Object(v.jsx)("pre",{style:{margin:0},children:e.command.help_cmd}),Object(v.jsx)("b",{children:"Description"})," ",Object(v.jsx)("pre",{style:{margin:0,wordBreak:"break-all",overflow:"word-wrap",whiteSpace:"pre-wrap"},children:e.command.description}),Object(v.jsx)("b",{children:"Requires Admin?"})," ",e.command.needs_admin?"True":"False"]}),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"30%"},children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:d.map((function(t){return Object(v.jsx)(zo,Object(o.a)(Object(o.a)({onSubmit:de,onChange:pe,commandInfo:n},t),{},{callback_id:e.callback_id,onAgentConnectAddNewPayloadOnHost:be,onAgentConnectRemovePayloadOnHost:je}),"taskparameterrow"+t.id)}))})]})})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:de,variant:"contained",color:"secondary",children:"Submit"})]})]})}var es,ts,as,ns,is,cs,rs=Object(Pe.a)(Ho||(Ho=Object(B.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $ui_feature: String!) {\n    callback_by_pk(id: $callback_id){\n        operation_id\n        loadedcommands(where: {command: {supported_ui_features: {_ilike: $ui_feature}}}) {\n            id\n            command {\n              cmd\n              help_cmd\n              description\n              id\n              needs_admin\n              payload_type_id\n              attributes\n              commandparameters {\n                id\n                type \n              }\n              supported_ui_features\n            }\n          }\n        payload {\n            payloadtype {\n                id\n                commands(where: {script_only: {_eq: true}, deleted: {_eq: false}, supported_ui_features: {_ilike: $ui_feature }}){\n                    id\n                    cmd\n                    help_cmd\n                    description\n                    needs_admin\n                    attributes\n                    payload_type_id\n                    commandparameters {\n                        id\n                        type\n                    }\n                    supported_ui_features\n                  }\n            }\n        }\n    }\n}\n"]))),os=function(e){var t=e.callback_id,a=e.ui_feature,n=e.parameters,i=e.onTasked,c=l.a.useState([]),r=Object(j.a)(c,2),d=r[0],u=r[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],m=p[1],f=l.a.useState(!1),O=Object(j.a)(f,2),x=O[0],g=O[1],y=l.a.useState({}),_=Object(j.a)(y,2),k=_[0],w=_[1],C=Object(Ee.a)(od,{update:function(e,a){var n=a.data;"error"===n.createTask.status?q.error(n.createTask.error):q.success('Issued "'+k.cmd+'" to Callback '+t),i()},onError:function(e){console.error(e),i()}}),S=Object(j.a)(C,1)[0],D=Object(Ae.a)(rs,{variables:{callback_id:t,ui_feature:"%"+a+"%"},onCompleted:function(e){var t=e.callback_by_pk.loadedcommands.reduce((function(e,t){return[].concat(Object(R.a)(e),[t.command])}),[]),n=e.callback_by_pk.payload.payloadtype.commands.reduce((function(e,t){return[].concat(Object(R.a)(e),[t])}),Object(R.a)(t));u(n),0===n.length?q.warning("No commands currently loaded that support the "+a+" feature"):1===n.length?w(Object(o.a)({},n[0])):(w({}),m(!0))},fetchPolicy:"network-only"}).data;return Object(s.useEffect)((function(){void 0!==k.commandparameters&&(k.commandparameters.length>0?void 0===n||null===n?g(!0):S({variables:{callback_id:t,command:k.cmd,params:n}}):S(void 0===n||null===n?{variables:{callback_id:t,command:k.cmd,params:""}}:{variables:{callback_id:t,command:k.cmd,params:n}}))}),[k]),Object(v.jsxs)("div",{children:[h&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:h,onClose:function(){m(!1)},innerDialog:Object(v.jsx)(vo,{onClose:function(){m(!1)},onSubmit:function(e){w(e)},options:d,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),x&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:x,onClose:function(){g(!1)},innerDialog:Object(v.jsx)(Xo,{command:k,callback_id:t,payloadtype_id:D.callback_by_pk.payload.payloadtype.id,operation_id:D.callback_by_pk.operation_id,onSubmit:function(e,a,n){g(!1),S({variables:{callback_id:t,command:e,params:a,files:n}})},onClose:function(){g(!1)}})})]})},ss=function(e){var t=e.cellData;e.rowData;return Object(v.jsx)("div",{style:Object(o.a)({},t.cellStyle),children:t.plaintext})},ls=function(e){return function(e){var t=e.cellData;try{var a=parseInt(t.plaintext);if(""===t.plaintext)return Object(v.jsx)("div",{style:Object(o.a)({},t.cellStyle)});if(0===a)return Object(v.jsx)("div",{style:Object(o.a)({},t.cellStyle),children:"0 Bytes"});var n=Math.floor(Math.log(a)/Math.log(1024)),i=parseFloat((a/Math.pow(1024,n)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n];return Object(v.jsx)("div",{style:Object(o.a)({},t.cellStyle),children:i})}catch(c){return Object(v.jsx)("div",{style:Object(o.a)({},t.cellStyle),children:t.plaintext})}}({cellData:e.cellData})},ds=function(e){var t=e.cellData,a=e.callback_id,n=(e.rowData,l.a.useState(!1)),i=Object(j.a)(n,2),c=i[0],r=i[1],s=l.a.useState(!1),d=Object(j.a)(s,2),u=d[0],b=d[1];return Object(v.jsxs)("div",{style:Object(o.a)({},t.cellStyle),children:[t.plaintext?t.plaintext:null,t.button?Object(v.jsx)(l.a.Fragment,{children:"dictionary"===t.button.type.toLowerCase()?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(m.a,{size:"small",title:"Display Data",variant:"contained",color:"primary",onClick:function(){return r(!0)},disabled:t.button.disabled,children:t.button.name}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:c,onClose:function(){r(!1)},innerDialog:Object(v.jsx)(fe,{title:t.button.title,leftColumn:t.button.leftColumnTitle,rightColumn:t.button.rightColumnTitle,value:t.button.value,onClose:function(){r(!1)}})})]}):Object(v.jsx)(l.a.Fragment,{children:"task"===t.button.type.toLowerCase()?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(m.a,{size:"small",title:"Issues a task",onClick:function(){return b(!0)},disabled:t.button.disabled,variant:"contained",color:"secondary",children:t.button.name}),u&&Object(v.jsx)(os,{ui_feature:t.button.ui_feature,callback_id:a,parameters:t.button.parameters,onTasked:function(){return b(!1)}})]}):null})}):null]})},us=function(e){var t=e.columnData,a=e.dataKey,n=e.rowData;return function(){switch(t.format){case"string":return Object(v.jsx)(ss,{cellData:n[a],rowData:n});case"size":return Object(v.jsx)(ls,{cellData:n[a],rowData:n});case"button":return Object(v.jsx)(ds,{callback_id:t.callback_id,cellData:n[a],rowData:n});default:return Object(v.jsx)(ss,{cellData:n[a],rowData:n})}}()},bs=function(){return Object(v.jsx)("div",{children:"NO DATA"})},js=function(e){var t=e.table,a=e.callback_id,n=Object(ve.a)(),i=l.a.useState([]),c=Object(j.a)(i,2),r=c[0],d=c[1],u=l.a.useRef([]),p=l.a.useState(""),h=Object(j.a)(p,2),m=h[0],f=h[1],O=l.a.useState({}),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useRef(null),k=l.a.useState("ASC"),w=Object(j.a)(k,2),C=w[0],S=w[1],D=function(e){var t=e.index;return t<0?{backgroundColor:n.pageHeader.main,color:n.pageHeaderText.main}:u.current[t].rowStyle||{}},I=function(e){var a=e.sortBy,n=e.sortDirection,i=Object(R.a)(u.current),c=t.headers.filter((function(e){return e.plaintext===a}))[0].type;"number"===c||"size"===c?i.sort((function(e,t){return parseInt(e[a].plaintext)>parseInt(t[a].plaintext)?1:-1})):"date"===c?i.sort((function(e,t){return new Date(e[a].plaintext)>new Date(t[a].plaintext)?1:-1})):i.sort((function(e,t){return void 0===e[a].plaintext?-1:void 0===t[a].plaintext||e[a].plaintext.toLowerCase()>t[a].plaintext.toLowerCase()?1:-1})),"DESC"===n&&i.reverse(),u.current=Object(R.a)(i),f(a),S(n)},$=function(e){var t=e.index;return u.current[t]},T=l.a.useCallback((function(e){var a,n=e.event,i=e.dataKey,c=e.deltaX;n.preventDefault(),n.stopPropagation();for(var r=Object(o.a)({},g),s=c/_.current.offsetWidth,l="",d=0;d<t.headers.length;d++)t.headers[d].plaintext===i&&d+1<t.headers.length&&(l=t.headers[d+1].plaintext);if(""!==l){var u=Object(o.a)(Object(o.a)({},r),{},(a={},Object(b.a)(a,i,r[i]+s),Object(b.a)(a,l,r[l]-s),a));y(u)}else console.log("next header not found")}),[g]),P=l.a.useCallback((function(e){e.columnData;var t,a=e.dataKey,n=(e.disableSort,e.label),i=e.sortBy,c=e.sortDirection;return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)("span",{style:(t={alignContent:"center",display:"inline-flex",flexDirection:"row"},Object(b.a)(t,"alignContent","stretch"),Object(b.a)(t,"justifyContent","flex-start"),t),children:[n,i===n?"ASC"===c?Object(v.jsx)(go.a,{}):Object(v.jsx)(_o.a,{}):null]}),Object(v.jsx)(Oo.a,{axis:"x",defaultClassName:"DragHandle",defaultClassNameDragging:"DragHandleActive",onDrag:function(e,t){var n=t.deltaX;return T({event:e,dataKey:a,deltaX:n})},position:{x:0},zIndex:999,children:Object(v.jsx)("span",{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"DragHandleIcon",style:{width:"20px",textAlign:"center"},children:"\u22ee"})})]},"header"+a)}),[T]);return Object(s.useEffect)((function(){var e=t.headers.reduce((function(e,t){return t.width?e:e+1}),0),a=100-t.headers.reduce((function(e,t){return t.width?e+t.width:e}),0),n=t.headers.reduce((function(t,n){return Object(o.a)(Object(o.a)({},t),{},Object(b.a)({},n.plaintext,n.width?n.width/100:a/e/100))}),{});y(Object(o.a)({},n))}),[t.headers]),Object(s.useEffect)((function(){u.current=Object(R.a)(t.rows)}),[t.rows]),Object(s.useEffect)((function(){var e=t.headers.map((function(e){return{dataKey:e.plaintext,label:e.plaintext,width:g[e.plaintext]*_.current.offsetWidth,columnData:{format:void 0===e.type?"string":e.type,callback_id:a},cellRenderer:us,headerRenderer:P}}));d(e),e.length>0&&f(e[0].dataKey)}),[t.headers,g]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:n.pageHeader.main,color:n.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:t.title})}),Object(v.jsx)("div",{style:{height:"calc(45vh)",width:"100%"},ref:_,children:Object(v.jsx)(mo.a,{children:function(e){var t=e.height,a=e.width;return Object(v.jsx)(mo.c,{height:t,width:a,headerHeight:25,noRowsRenderer:bs,rowCount:u.current.length,rowGetter:$,rowHeight:35,rowStyle:D,sort:I,sortBy:m,sortDirection:C,children:r.map((function(e){return Object(v.jsx)(mo.b,Object(o.a)({},e),"col"+e.dataKey)}))})}})})]})},ps=function(e){return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Download payload",children:Object(v.jsx)(Y.a,{variant:"contained",component:"a",target:"_blank",color:"primary",href:"/api/v1.4/files/download/"+e.download.agent_file_id,download:!0,children:Object(v.jsx)(er.a,{})})})})},hs=a(69),ms=a.n(hs),fs=Object(Pe.a)(es||(es=Object(B.a)(["\nsubscription subResponsesQuery($task_id: Int!, $fetchLimit: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, limit: $fetchLimit, order_by: {id: desc}) {\n    id\n    response: response_text\n  }\n}"]))),Os=Object(Pe.a)(ts||(ts=Object(B.a)(["\nquery subResponsesQuery($task_id: Int!, $fetchLimit: Int!, $offset: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}, limit: $fetchLimit, offset: $offset, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),xs=Object(Pe.a)(as||(as=Object(B.a)(["\nquery subResponsesQuery($task_id: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),gs=Object(Pe.a)(ns||(ns=Object(B.a)(["\nquery getBrowserScriptsQuery($command_id: Int!, $operator_id: Int!, $operation_id: Int!){\n  browserscript(where: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}, operator_id: {_eq: $operator_id}}) {\n    script\n    id\n  }\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}}}) {\n    browserscript {\n      script\n      id\n    }\n  }\n}\n\n"]))),ys=function(e){var t=Object(ve.a)(),a=l.a.useState(!0),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(""),d=Object(j.a)(r,2),u=d[0],b=d[1],p=l.a.useState([]),h=Object(j.a)(p,2),m=h[0],f=h[1],O=l.a.useState({}),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useRef(),k=Object(A.a)(I),C=l.a.useState(0),S=Object(j.a)(C,2),D=S[0],$=S[1],T=l.a.useState(0),P=Object(j.a)(T,2),E=P[0],F=P[1],L=l.a.useState(""),N=Object(j.a)(L,2),B=N[0],W=N[1],z=l.a.useState(!1),H=Object(j.a)(z,2),M=H[0],U=H[1],V=Object(nt.a)(fs,{variables:{task_id:e.task.id,fetchLimit:e.fetchLimit},fetchPolicy:"network_only",onSubscriptionData:function(t){var a=t.subscriptionData;if(0!==E||a.data.response.length!==e.fetchLimit){if(E>=e.fetchLimit)console.log("got more than we can see currently");else if(a.data.response.length>0){var n=a.data.response.filter((function(e){return e.id>D}));n.sort((function(e,t){return e.id>t.id?1:-1}));for(var i=u,c=Object(R.a)(m),r=D,o=E,s=0;s<n.length&&o<e.fetchLimit;s++)i+=n[s].response,c.push(n[s].response),r=n[s].id,o+=1;b(i),f(c),$(r),F(o)}}else Z({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%_%"}})}}).error,G=function(e){var t=Object(o.a)({},e);if(""===B)return e;if(void 0!==e.plaintext&&(e.plaintext.includes(B)||(t.plaintext="")),void 0!==e.table&&e.table.length>0){var a=e.table.map((function(e){var t=e.rows.filter((function(e){for(var t=!1,a=0,n=Object.entries(e);a<n.length;a++){var i=Object(j.a)(n[a],2),c=(i[0],i[1]);void 0!==c.plaintext&&String(c.plaintext).includes(B)&&(t=!0),void 0!==c.button&&void 0!==c.button.value&&JSON.stringify(c.button.value).includes(B)&&(t=!0)}return t}));return Object(o.a)(Object(o.a)({},e),{},{rows:t})}));t.table=a}return t};Object(s.useEffect)((function(){if(void 0===_.current)c(!1);else if(c(e.viewBrowserScript),e.viewBrowserScript&&void 0!==_.current)try{var t=_.current(e.task,m);y(G(t))}catch(V){c(!1)}}),[e.viewBrowserScript]);var K=Object(St.a)(gs,{fetchPolicy:"network-only",onCompleted:function(t){if(t.browserscriptoperation.length>0)try{atob(t.browserscriptoperation[0].script);c(!0)}catch(V){q.error(V.toString()),c(!1)}else if(t.browserscript.length>0)try{var a=atob(t.browserscript[0].script),n=Function('"use strict";return('+a+")")();_.current=n,c(!0);var i=_.current(e.task,m);y(G(i))}catch(V){q.error(V.toString()),c(!1)}else c(!1)},onError:function(e){console.log(e)}}),Q=Object(j.a)(K,1)[0],J=Object(St.a)(Os,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.response.reduce((function(e,t){return e+t.response}),""),n=t.response.reduce((function(e,t){return t.id>e?t.id:e}),D);$(n),b(a);var r=t.response.map((function(e){return e.response}));if(f(r),i&&void 0!==_.current)try{var o=_.current(e.task,r);y(G(o))}catch(V){console.log(V),c(!1)}F(t.response.length),(""!==e.searchText||M)&&(U(!1),e.changeTotalCount(t.response_aggregate.aggregate.count))},onError:function(e){q.error("Failed to fetch more responses: "+e)}}),Z=Object(j.a)(J,1)[0],X=Object(St.a)(xs,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.response.reduce((function(e,t){return e+t.response}),""),n=t.response.reduce((function(e,t){return t.id>e?t.id:e}),D);$(n),b(a);var r=t.response.map((function(e){return e.response}));if(f(r),i&&void 0!==_.current)try{var o=_.current(e.task,r);y(G(o))}catch(V){c(!1),console.log(V)}F(t.response.length),e.changeTotalCount(0)},onError:function(e){}}),ee=Object(j.a)(X,1)[0];Object(s.useEffect)((function(){void 0!==e.command_id&&Q({variables:{command_id:e.command_id,operator_id:k.user.user_id,operation_id:k.user.current_operation_id}})}),[e.command_id]),Object(s.useEffect)((function(){if(void 0!==_.current)try{var t=_.current(e.task,m);y(G(t))}catch(V){c(!1),console.log(V)}}),[m]),Object(s.useEffect)((function(){void 0===e.searchText||""===e.searchText?Z({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:e.fetchLimit*(e.currentPage-1),search:"%_%"}}):Z({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:e.fetchLimit*(e.currentPage-1),search:"%"+e.searchText+"%"}})}),[e.currentPage]),Object(s.useEffect)((function(){void 0===e.searchText||""===e.searchText?Z({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%_%"}}):Z({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%"+e.searchText+"%"}})}),[e.searchText]),Object(s.useEffect)((function(){e.selectAllOutput?(U(!0),ee({variables:{task_id:e.task.id,search:"%"+e.searchText+"%"}})):($(0),F(0),Z({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%"+e.searchText+"%"}}))}),[e.selectAllOutput]);var te=l.a.useCallback((function(){e.onSubmitSearch(B)}),[B]);return V?(console.error(V),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[e.searchOutput&&Object(v.jsx)(w,{value:B,onEnter:te,onChange:function(e,t,a){return W(t)},placeholder:"Search Output of This Task",name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:te,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}}),Object(v.jsx)("div",{style:{overflow:"auto",maxWidth:"100%",width:"100%",maxHeight:"calc(50vh)"},children:i?Object(v.jsxs)(l.a.Fragment,{children:[g.screenshot&&g.screenshot.map((function(t,a){return Object(v.jsx)(po,Object(o.a)({},t),"screenshot"+a+"fortask"+e.task.id)})),g.plaintext&&Object(v.jsx)(ho,{plaintext:g.plaintext}),g.table&&g.table.map((function(t,a){return Object(v.jsx)(js,{callback_id:e.task.callback_id,table:t},"tablefortask"+e.task.id+"table"+a)})),g.download&&g.download.map((function(t,a){return Object(v.jsx)(ps,{download:t},"download"+a+"fortask"+e.task.id)}))]}):Object(v.jsx)(ho,{plaintext:u})})]})},_s=a(448),vs=a.n(_s),ks=Object(Pe.a)(is||(is=Object(B.a)(["\nmutation updateComment ($task_id: Int!, $comment: String) {\n  update_task_by_pk(pk_columns: {id: $task_id}, _set: {comment: $comment}) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"]))),ws=Object(Pe.a)(cs||(cs=Object(B.a)(["\nquery getCommentQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"])));function Cs(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(ws,{variables:{task_id:e.task_id},onCompleted:function(e){i(e.task_by_pk.comment)},fetchPolicy:"network-only"}),r=c.loading,o=c.error,d=Object(Ee.a)(ks,{update:function(e,t){t.data}}),u=Object(j.a)(d,1)[0];if(r)return Object(v.jsx)(Fe.a,{});if(o)return console.error(o),Object(v.jsx)("div",{children:"Error!"});var b=function(){u({variables:{task_id:e.task_id,comment:n}}),e.onClose()};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Edit Task Comment"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{autoFocus:!0,onEnter:b,onChange:function(e,t,a){i(t)},value:n})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:b,variant:"contained",color:"secondary",children:"Submit"})]})]})}var Ss,Ds,Is,$s,Ts,Ps=a(446),As=a.n(Ps),Es=Object(Pe.a)(Ss||(Ss=Object(B.a)(["\nmutation addTaskTag ($task_id: Int!, $tag: String!) {\n  insert_tasktag_one(object: {task_id: $task_id, tag: $tag}){\n    id\n  }\n}\n"]))),Fs=Object(Pe.a)(Ds||(Ds=Object(B.a)(["\nmutation removeTaskTag($tasktag_id: Int!){\n  delete_tasktag_by_pk(id: $tasktag_id){\n    id\n  }\n}\n"]))),Ls=Object(Pe.a)(Is||(Is=Object(B.a)(["\nquery getTaskTags ($operation_id: Int!) {\n  tasktag(where: {operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    task_id\n  }\n}\n"]))),qs=Object(h.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}}));function Ns(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function Rs(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}function Bs(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(A.a)(I),r=Object(Ae.a)(Ls,{variables:{operation_id:c.user.current_operation_id},onCompleted:function(t){var a=t.tasktag.reduce((function(t,a){return a.task_id===e.task_id?[].concat(Object(R.a)(t),[a]):Object(R.a)(t)}),[]),n=t.tasktag.reduce((function(e,t){return e.find((function(e){return e.tag===t.tag}))||a.find((function(e){return e.tag===t.tag}))?Object(R.a)(e):[].concat(Object(R.a)(e),[t])}),[]);S(n),P(a),N(Object(R.a)(a))},fetchPolicy:"network-only"}),o=r.loading,d=r.error,u=Object(Ee.a)(Es,{update:function(e,t){t.data}}),b=Object(j.a)(u,1)[0],p=Object(Ee.a)(Fs,{update:function(e,t){t.data}}),h=Object(j.a)(p,1)[0],f=qs(),O=l.a.useState([]),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useState([]),k=Object(j.a)(_,2),C=k[0],S=k[1],D=l.a.useState([]),$=Object(j.a)(D,2),T=$[0],P=$[1],E=l.a.useState([]),F=Object(j.a)(E,2),L=F[0],N=F[1],B=Rs(g,C),W=Rs(g,T),z=function(e){return function(){var t=g.indexOf(e),a=Object(R.a)(g);-1===t?a.push(e):a.splice(t,1),y(a)}},H=function(e,t){return Object(v.jsx)(G.a,{className:f.paper,style:{width:"100%"},children:Object(v.jsxs)(Ve.a,{children:[Object(v.jsx)(La.a,{className:f.cardHeader,title:e}),Object(v.jsx)(qa.a,{}),Object(v.jsxs)(Ta.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[t.map((function(e){var t="transfer-list-item-".concat(e.id,"-label");return Object(v.jsxs)(Pa.a,{style:{padding:0},role:"listitem",button:!0,onClick:z(e),children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(Fa.a,{checked:-1!==g.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":t}})}),Object(v.jsx)(Ea.a,{id:t,primary:e.tag})]},e.id)})),Object(v.jsx)(Pa.a,{})]})]})})};if(o)return Object(v.jsx)(Fe.a,{});if(d)return console.error(d),Object(v.jsx)("div",{children:"Error!"});return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Edit Task Tags"}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsxs)($t.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:f.root,children:[Object(v.jsx)($t.a,{item:!0,xs:5,children:H("Unused Tags In Operation",C)}),Object(v.jsx)($t.a,{item:!0,children:Object(v.jsxs)($t.a,{container:!0,direction:"column",alignItems:"center",children:[Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){P(T.concat(C)),S([])},disabled:0===C.length,"aria-label":"move all right",children:"\u226b"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){P(T.concat(B)),S(Ns(C,B)),y(Ns(g,B))},disabled:0===B.length,"aria-label":"move selected right",children:">"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){S(C.concat(W)),P(Ns(T,W)),y(Ns(g,W))},disabled:0===W.length,"aria-label":"move selected left",children:"<"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){S(C.concat(T)),P([])},disabled:0===T.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(v.jsx)($t.a,{item:!0,xs:5,children:H("Applied Tags To Task",T)})]}),Object(v.jsx)(w,{autoFocus:!0,multiline:!1,name:"Add New Tag...",onChange:function(e,t,a){i(t)},value:n,style:{display:"inline-block"},InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Y.a,{style:{color:_c.palette.success.main},variant:"contained",onClick:function(){T.find((function(e){return e.tag===n}))||C.find((function(e){return e.tag===n}))||""!==n&&P([].concat(Object(R.a)(T),[{tag:n,id:0,task_id:0}])),i("")},children:Object(v.jsx)(As.a,{})})})}})]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){L.forEach((function(e){T.find((function(t){return t.id===e.id}))||h({variables:{tasktag_id:e.id}})})),T.forEach((function(t){L.find((function(e){return e.id===t.id}))||b({variables:{task_id:e.task_id,tag:t.tag}})})),""!==n&&b({variables:{task_id:e.task_id,tag:n}}),q.success("Updated tags"),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}var Ws,zs=Object(Pe.a)($s||($s=Object(B.a)(["\nmutation requestOpsecBypass ($task_id: Int!) {\n    requestOpsecBypass(task_id: $task_id){\n        status\n        error\n    }\n}\n"]))),Hs=Object(Pe.a)(Ts||(Ts=Object(B.a)(["\nquery getOPSECQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    opsec_pre_blocked\n    opsec_pre_message\n    opsec_pre_bypassed\n    opsec_pre_bypass_user{\n        username\n        id\n    }\n    opsec_post_blocked\n    opsec_pre_bypass_role\n    opsec_post_message\n    opsec_post_bypassed\n    opsec_post_bypass_role\n    opsec_post_bypass_user{\n        username\n        id\n    }\n    id\n  }\n}\n"])));function Ms(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(s.useState)({}),r=Object(j.a)(c,2),o=r[0],d=r[1],u=Object(E.c)().enqueueSnackbar,b=Object(Ae.a)(Hs,{variables:{task_id:e.task_id},onCompleted:function(e){var t="OPSEC PreCheck Message";console.log(e),null!==e.task_by_pk.opsec_pre_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_pre_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_pre_message+"\n",e.task_by_pk.opsec_post_blocked&&(t+="\nOPSEC PostCheck Message",null!==e.task_by_pk.opsec_post_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_post_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_post_message+"\n"),d(e.task_by_pk),i(t)},fetchPolicy:"network-only"}),p=b.loading,h=b.error,f=Object(Ee.a)(zs,{update:function(e,t){var a=t.data;"success"===a.requestOpsecBypass.status?u("Bypass processed successfully",{variant:"success"}):u(a.requestOpsecBypass.error,{variant:"warning"})}}),O=Object(j.a)(f,1)[0];if(p)return Object(v.jsx)(Fe.a,{});if(h)return console.error(h),Object(v.jsx)("div",{children:"Error!"});return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Request OPSEC Bypass"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,onChange:function(){},value:n})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),!0===o.opsec_pre_blocked&&!o.opsec_pre_bypassed||!0===o.opsec_post_blocked&&!o.opsec_post_bypassed?Object(v.jsx)(m.a,{onClick:function(){console.log(e.task_id),O({variables:{task_id:e.task_id}}),e.onClose()},variant:"contained",color:"secondary",children:"Submit Bypass Request"}):null]})]})}var Us,Vs=Object(Pe.a)(Ws||(Ws=Object(B.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    display_params\n    original_params\n    params\n    id\n  }\n}\n"])));function Gs(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(Vs,{variables:{task_id:e.task_id},onCompleted:function(e){i("Original Parameters:\n"+e.task_by_pk.original_params+"\n\nAgent Parameters:\n"+e.task_by_pk.params+"\n\nDisplay Parameters:\n"+e.task_by_pk.display_params)},fetchPolicy:"network-only"}),r=c.loading,o=c.error;return r?Object(v.jsx)(Fe.a,{}):o?(console.error(o),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"View Task Parameters"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,value:n,onChange:function(){}})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Ks=Object(Pe.a)(Us||(Us=Object(B.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    stdout\n    stderr\n    id\n  }\n}\n"])));function Qs(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(Ae.a)(Ks,{variables:{task_id:e.task_id},onCompleted:function(e){i("[STDOUT]:\n"+e.task_by_pk.stdout+"\n[STDERR]:\n"+e.task_by_pk.stderr)},fetchPolicy:"network-only"}),r=c.loading,o=c.error;return r?Object(v.jsx)(Fe.a,{}):o?(console.error(o),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"View Task Stdout/Stderr"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,value:n,onChange:function(){}})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Js,Ys,Zs=a(447),Xs=a.n(Zs),el=a(269),tl=a.n(el),al=a(188),nl=a.n(al),il=a(189),cl=a.n(il),rl=Object(Pe.a)(Js||(Js=Object(B.a)(["\nfragment allTokenData on token {\n    id\n    Address\n    AppContainer\n    AppContainerNumber\n    AppContainerSid\n    AppId\n    AppModelPolicies\n    AppModelPolicyDictionary\n    AttributesFlags\n    AuditPolicy\n    AuthenticationId_id\n    BnoIsolationPrefix\n    CanSynchronize\n    Capabilities\n    CreationTime\n    DefaultDacl\n    DenyOnlyGroups\n    DeviceClaimAttributes\n    DeviceGroups\n    Elevated\n    ElevationType\n    EnabledGroups\n    ExpirationTime\n    Filtered\n    Flags\n    FullPath\n    GrantedAccess\n    GrantedAccessGeneric\n    GrantedAccessMask\n    GroupCount\n    Groups\n    Handle\n    HandleReferenceCount\n    HasRestrictions\n    ImpersonationLevel\n    Inherit\n    IntegrityLevel\n    IntegrityLevelSid\n    IsClosed\n    IsContainer\n    IsPseudoToken\n    IsRestricted\n    IsSandbox\n    LogonSid\n    LowPrivilegeAppContainer\n    MandatoryPolicy\n    ModifiedId\n    Name\n    NoChildProcess\n    NotLow\n    NtType\n    NtTypeName\n    Origin\n    Owner\n    PackageFullName\n    PackageIdentity\n    PackageName\n    PointerReferenceCount\n    PrimaryGroup\n    PrivateNamespace\n    Privileges\n    ProcessUniqueAttribute\n    ProtectFromClose\n    Restricted\n    RestrictedDeviceClaimAttributes\n    RestrictedDeviceGroups\n    RestrictedSids\n    RestrictedSidsCount\n    RestrictedUserClaimAttributes\n    SandboxInert\n    Sddl\n    SecurityAttributes\n    SecurityDescriptor\n    SessionId\n    Source\n    ThreadID\n    TokenId\n    TokenType\n    TrustLevel\n    UIAccess\n    User\n    UserClaimAttributes\n    VirtualizationAllowed\n    VirtualizationEnabled\n    WriteRestricted\n    task_id\n    logonsession {\n      id\n      LogonId\n      UserName\n      LogonDomain\n      LogonType\n      SessionId\n      Sid\n      LogonTime\n      LogonServer\n      DnsDomainName\n      Upn\n      UserFlags\n      LastSuccessfulLogon\n      LastFailedLogon\n      FailedAttemptCountSinceLastSuccessfulLogon\n      LogonScript\n      ProfilePath\n      HomeDirectory\n      HomeDirectoryDrive\n      LogoffTime\n      KickOffTime\n      PasswordLastSet\n      PasswordCanChange\n      PasswordMustChange\n      task_id\n      authenticationpackages {\n        id\n        Name\n        task_id\n      }\n    }\n}\n"]))),ol=Object(Pe.a)(Ys||(Ys=Object(B.a)(["\n","\nquery getTokenInfo ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    ...allTokenData\n  }\n}\n"])),rl);function sl(e){var t=Object(ve.a)(),a=Object(s.useState)([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=Object(s.useState)([]),o=Object(j.a)(r,2),d=o[0],u=o[1],b=Object(s.useState)([]),p=Object(j.a)(b,2),h=p[0],f=p[1],O=["Address","AppContainer","AppContainerNumber","AppContainerSid","AppId","AppModelPolicies","AppModelPolicyDictionary","AttributesFlags","AuditPolicy","AuthenticationId_id","BnoIsolationPrefix","CanSynchronize","Capabilities","CreationTime","DefaultDacl","DenyOnlyGroups","DeviceClaimAttributes","DeviceGroups","Elevated","ElevationType","EnabledGroups","ExpirationTime","Filtered","Flags","FullPath","GrantedAccess","GrantedAccessGeneric","GrantedAccessMask","GroupCount","Groups","Handle","HandleReferenceCount","HasRestrictions","ImpersonationLevel","Inherit","IntegrityLevel","IntegrityLevelSid","IsClosed","IsContainer","IsPseudoToken","IsRestricted","IsSandbox","LogonSid","LowPrivilegeAppContainer","MandatoryPolicy","ModifiedId","Name","NoChildProcess","NotLow","NtType","NtTypeName","Origin","Owner","PackageFullName","PackageIdentity","PackageName","PointerReferenceCount","PrimaryGroup","PrivateNamespace","Privileges","ProcessUniqueAttribute","ProtectFromClose","Restricted","RestrictedDeviceClaimAttributes","RestrictedDeviceGroups","RestrictedSids","RestrictedSidsCount","RestrictedUserClaimAttributes","SandboxInert","Sddl","SecurityAttributes","SecurityDescriptor","SessionId","Source","ThreadID","TokenId","TokenType","TrustLevel","UIAccess","User","UserClaimAttributes","VirtualizationAllowed","VirtualizationEnabled","WriteRestricted","task_id"],x=["LogonId","UserName","LogonDomain","LogonType","SessionId","Sid","LogonTime","LogonServer","DnsDomainName","Upn","UserFlags","LastSuccessfulLogon","LastFailedLogon","FailedAttemptCountSinceLastSuccessfulLogon","LogonScript","ProfilePath","HomeDirectory","HomeDirectoryDrive","LogoffTime","KickOffTime","PasswordLastSet","PasswordCanChange","PasswordMustChange","task_id"],g=["Name","task_id"];return Object(Ae.a)(ol,{variables:{token_id:e.token_id},onCompleted:function(e){if(null!==e.token_by_pk){c(e.token_by_pk);var t=O.reduce((function(t,a){return void 0!==e.token_by_pk[a]&&null!==e.token_by_pk[a]&&""!==e.token_by_pk[a]?[].concat(Object(R.a)(t),[{name:a,value:e.token_by_pk[a]}]):Object(R.a)(t)}),[]);if(c(t),null!==e.token_by_pk.logonsession){var a=x.reduce((function(t,a){return void 0!==e.token_by_pk.logonsession[a]&&null!==e.token_by_pk.logonsession[a]&&""!==e.token_by_pk.logonsession[a]?[].concat(Object(R.a)(t),[{name:a,value:e.token_by_pk.logonsession[a]}]):Object(R.a)(t)}),[]);if(u(a),e.token_by_pk.logonsession.authenticationpackages.length>0){var n=e.token_by_pk.logonsession.authenticationpackages.map((function(e){return g.reduce((function(t,a){return void 0!==e[a]&&null!==e[a]&&""!==e[a]?[].concat(Object(R.a)(t),[{name:a,value:e[a]}]):Object(R.a)(t)}),[])}));f(n)}}}},onError:function(e){q.error(e)},fetchPolicy:"network-only"}),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Token Information"}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Token Data"})}),Object(v.jsx)(G.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Token Property"}),Object(v.jsx)(H.a,{children:"Token Value"})]})}),Object(v.jsx)(z.a,{children:i.map((function(e,t){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.name}),Object(v.jsx)(H.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})}),d.length>0&&Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Logon Session Data"})}),Object(v.jsx)(G.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Logon Session Property"}),Object(v.jsx)(H.a,{children:"Logon Session Value"})]})}),Object(v.jsx)(z.a,{children:d.map((function(e,t){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.name}),Object(v.jsx)(H.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"logondatarow"+t)}))})]})})})]}),h.map((function(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Authentication Package"})}),Object(v.jsx)(G.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Authentication Package Property"}),Object(v.jsx)(H.a,{children:"Authentication Package Value"})]})}),Object(v.jsx)(z.a,{children:e.map((function(t,a){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:t.name}),Object(v.jsx)(H.a,{children:!0===t.value?"True":!1===t.value?"False":t.value})]},"authpackage"+e.id+"row"+a)}))})]})})})]},"authpkg"+e.id)}))]}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var ll,dl,ul,bl,jl,pl=a(874),hl=a(329),ml=a.n(hl),fl=a(890),Ol=["disableElevation","fullWidth","children","ref"],xl=Object(Pe.a)(ll||(ll=Object(B.a)(["\nmutation reissueTaskMutation($task_id: Int!){\n  reissue_task(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),gl=Object(Pe.a)(dl||(dl=Object(B.a)(["\nmutation reissueTaskHandlerMutation($task_id: Int!){\n  reissue_task_handler(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),yl=Object(Pe.a)(ul||(ul=Object(B.a)(["\nquery subResponsesQuery($task_id: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n}"]))),_l=l.a.forwardRef((function(e){e.disableElevation,e.fullWidth;var t=e.children,a=e.ref,n=Object(Ur.a)(e,Ol);return Object(v.jsx)(pl.a,Object(o.a)(Object(o.a)({},n),{},{ref:a,children:t}))})),vl=function(e){var t=e.task,a=Object(ve.a)(),n=l.a.useState(0),i=Object(j.a)(n,2),c=i[0],r=i[1],o=l.a.useState(!0),d=Object(j.a)(o,2),u=d[0],b=d[1],p=l.a.useState(!1),h=Object(j.a)(p,2),f=h[0],O=h[1],x=l.a.useState(!1),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState(!1),w=Object(j.a)(k,2),C=w[0],S=w[1],D=l.a.useState(!1),I=Object(j.a)(D,2),$=I[0],T=I[1],P=l.a.useState(!1),A=Object(j.a)(P,2),E=A[0],F=A[1],L=l.a.useState(!1),N=Object(j.a)(L,2),R=N[0],B=N[1],W=l.a.useState(0),z=Object(j.a)(W,2),H=z[0],M=z[1],U=l.a.useState(""),V=Object(j.a)(U,2),G=V[0],K=V[1],Q=l.a.useState(!1),J=Object(j.a)(Q,2),Y=J[0],X=J[1],ee=l.a.useState(10),te=Object(j.a)(ee,2),ae=te[0],ne=(te[1],l.a.useState(1)),ie=Object(j.a)(ne,2),ce=ie[0],re=ie[1],oe=l.a.useState(!1),se=Object(j.a)(oe,2),le=se[0],de=se[1],ue=Object(St.a)(yl,{fetchPolicy:"network-only",onCompleted:function(e){var a=e.response.reduce((function(e,t){return e+t.response}),""),n=new Blob([a],{type:"text/plain"}),i=document.getElementById("download_config");if(null!==i)i.href=URL.createObjectURL(n),i.download="task_"+t.id+".txt",i.click();else{var c=document.createElement("a");c.id="download_config",c.href=URL.createObjectURL(n),c.download="task_"+t.id+".txt",document.body.appendChild(c),c.click()}},onError:function(e){}}),be=Object(j.a)(ue,1)[0],je=Object(Ee.a)(xl,{onCompleted:function(e){"success"===e.reissue_task.status?q.success("Successfully re-issued task to Mythic"):q.error("Failed to re-issue task to Mythic: "+e.reissue_task.error)},onError:function(e){console.log(e),q.error("Failed to re-issue task: "+e)}}),pe=Object(j.a)(je,1)[0],me=Object(Ee.a)(gl,{onCompleted:function(e){"success"===e.reissue_task_handler.status?q.success("Successfully resubmitted task for handling"):q.warning("Failed to resubmit task for handling: "+e.reissue_task_handler.error)},onError:function(e){console.log(e),q.error("Error resubmitting task for handling: "+e)}}),fe=Object(j.a)(me,1)[0];Object(s.useEffect)((function(){M(null===t.command?0:t.command.id),void 0!==t.responses_aggregate&&r(t.responses_aggregate.aggregate.count)}),[t.command,t.responses_aggregate]);var Oe=l.a.useCallback((function(e){r(e),re(1)}),[]);return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)($t.a,{container:!0,spacing:0,style:{maxWidth:"100%"},children:[Object(v.jsxs)($t.a,{item:!0,xs:1,style:{maxWidth:"5rem"},children:[Object(v.jsxs)(bt.a,{size:"large",color:"primary",orientation:"vertical",children:[Object(v.jsx)(Kc.a,{title:"Toggle BrowserScript",children:Object(v.jsx)(_l,{size:"small",color:"primary",value:"view browserscript",onChange:function(){b(!u)},selected:u,children:Object(v.jsx)(tl.a,{})})}),Object(v.jsx)(Kc.a,{title:"Fetch All Output",children:Object(v.jsx)(_l,{size:"small",color:"primary",value:"fetchAllOutput",onChange:function(){de(!le)},selected:le,children:Object(v.jsx)(ea.a,{icon:ta.d,size:"lg"})})}),Object(v.jsx)(Kc.a,{title:"Search Task Output",children:Object(v.jsx)(_l,{size:"small",color:"primary",value:"searchOutput",onChange:function(){X(!Y)},selected:Y,children:Object(v.jsx)(ms.a,{})})}),Object(v.jsx)(Kc.a,{title:"Download output",children:Object(v.jsx)(m.a,{onClick:function(){be({variables:{task_id:t.id}})},color:"primary",children:Object(v.jsx)(er.a,{})})}),Object(v.jsx)(Kc.a,{title:"Edit Tags",children:Object(v.jsx)(m.a,{color:"primary",onClick:function(){B(!0)},children:Object(v.jsx)(Xs.a,{})})}),Object(v.jsx)(Kc.a,{title:"Link Task",children:Object(v.jsx)(m.a,{color:"primary",href:"/new/task/"+t.id,target:"_blank",onClick:function(){window.open("/new/task/"+t.id,"_blank")},children:Object(v.jsx)(ea.a,{icon:ta.e,size:"lg"})})}),Object(v.jsx)(Kc.a,{title:"Copy original params to clipboard",children:Object(v.jsx)(m.a,{color:"primary",onClick:function(){lo(t.original_params)?q.success("Copied text!"):q.error("Failed to copy text")},children:Object(v.jsx)(bo.a,{})})}),Object(v.jsx)(Kc.a,{title:"Edit Comment",children:Object(v.jsx)(m.a,{color:"primary",onClick:function(){O(!0)},children:Object(v.jsx)(vs.a,{})})}),Object(v.jsx)(Kc.a,{title:"View All Parameters",children:Object(v.jsx)(m.a,{color:"primary",onClick:function(){S(!0)},children:Object(v.jsx)(nl.a,{})})}),Object(v.jsx)(Kc.a,{title:"View Stdout/Stderr of Task",children:Object(v.jsx)(m.a,{color:"primary",onClick:function(){T(!0)},children:Object(v.jsx)(ea.a,{icon:ta.b,size:"lg"})})}),null===t.opsec_pre_blocked?null:!1===t.opsec_pre_bypassed?Object(v.jsx)(Kc.a,{title:"Submit OPSEC PreCheck Bypass Request",children:Object(v.jsx)(m.a,{style:{color:a.palette.error.main},onClick:function(){F(!0)},children:Object(v.jsx)($r.a,{})})}):Object(v.jsx)(Kc.a,{title:"View OPSEC PreCheck Data",children:Object(v.jsx)(m.a,{style:{color:a.palette.success.main},onClick:function(){F(!0)},children:Object(v.jsx)(Er.a,{})})}),null===t.opsec_post_blocked?null:!1===t.opsec_post_bypassed?Object(v.jsx)(Kc.a,{title:"Submit OPSEC PostCheck Bypass Request",children:Object(v.jsx)(m.a,{style:{color:a.palette.error.main},onClick:function(){F(!0)},children:Object(v.jsx)($r.a,{})})}):Object(v.jsx)(Kc.a,{title:"View OPSEC PostCheck Data",children:Object(v.jsx)(m.a,{style:{color:a.palette.success.main},onClick:function(){F(!0)},children:Object(v.jsx)(Er.a,{})})}),null===t.token?null:Object(v.jsx)(Kc.a,{title:"View Token Information",children:Object(v.jsx)(m.a,{color:"primary",onClick:function(){_(!0)},children:Object(v.jsx)(cl.a,{})})}),t.status.toLowerCase().includes("error: container")?Object(v.jsx)(Kc.a,{title:"Resubmit Tasking",children:Object(v.jsx)(m.a,{style:{color:a.palette.warning.main},onClick:function(){pe({variables:{task_id:t.id}})},children:Object(v.jsx)(ml.a,{})})}):null,t.status.toLowerCase().includes("error: task")?Object(v.jsx)(Kc.a,{title:"Resubmit Task Handler",children:Object(v.jsx)(m.a,{style:{color:a.palette.warning.main},onClick:function(){fe({variables:{task_id:t.id}})},children:Object(v.jsx)(ml.a,{})})}):null]}),y?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:y,onClose:function(){_(!1)},innerDialog:Object(v.jsx)(sl,{token_id:void 0===t.token?0:t.token.id,onClose:function(){_(!1)}})}):null,E?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:E,onClose:function(){F(!1)},innerDialog:Object(v.jsx)(Ms,{task_id:t.id,onClose:function(){F(!1)}})}):null,C?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:C,onClose:function(){S(!1)},innerDialog:Object(v.jsx)(Gs,{task_id:t.id,onClose:function(){S(!1)}})}):null,$?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:$,onClose:function(){T(!1)},innerDialog:Object(v.jsx)(Qs,{task_id:t.id,onClose:function(){T(!1)}})}):null,R?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:R,onClose:function(){B(!1)},innerDialog:Object(v.jsx)(Bs,{task_id:t.id,onClose:function(){B(!1)}})}):null,f?Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:f,onClose:function(){O(!1)},innerDialog:Object(v.jsx)(Cs,{task_id:t.id,onClose:function(){O(!1)}})}):null]}),Object(v.jsx)($t.a,{item:!0,xs:11,children:Object(v.jsx)(ys,{task:t,command_id:H,viewBrowserScript:u,onSubmitSearch:function(e){K(e),""===e&&(void 0!==t.responses_aggregate?r(t.responses_aggregate.aggregate.count):r(0)),re(1)},searchOutput:Y,fetchLimit:ae,currentPage:ce,searchText:G,changeTotalCount:Oe,selectAllOutput:le})}),Object(v.jsx)($t.a,{item:!0,xs:12,children:Object(v.jsx)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:le?null:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(fl.a,{count:Math.ceil(c/ae),page:ce,variant:"outlined",color:"primary",boundaryCount:2,onChange:function(e,t){re(t)}}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",c]})]})})})]})})},kl=Object(Pe.a)(bl||(bl=Object(B.a)(["\nfragment taskData on task {\n  comment\n  callback_id\n  commentOperator{\n      username\n  }\n  completed\n  id\n  operator{\n      username\n  }\n  original_params\n  display_params\n  status\n  timestamp\n  command {\n    cmd\n    id\n  }\n  responses_aggregate {\n    aggregate{\n      count\n      max {\n        timestamp\n      }\n    }\n  }\n  opsec_pre_blocked\n  opsec_pre_bypassed\n  opsec_post_blocked\n  opsec_post_bypassed\n  tasks {\n      id\n  }\n  token {\n    id\n  }\n}\n"]))),wl=Object(Pe.a)(jl||(jl=Object(B.a)(["\n","\nquery getSubTasking($task_id: Int!){\n    task(where: {parent_task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n        ...taskData\n  }\n}\n "])),kl),Cl=Object(h.a)((function(e){return{root:{marginTop:"3px",marginBottom:"2px",marginLeft:"3px",marginRight:"0px",height:"auto",width:"99%"},heading:{fontSize:e.typography.pxToRem(15),display:"inline"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"auto",display:"block",textOverflow:"ellipsis",wordBreak:"break-all",maxWidth:"100%"},taskAndTimeDisplay:Object(b.a)({fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"100%",width:"100%",whiteSpace:"nowrap"},"display","inline-block"),secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"100%",whiteSpace:"break-all",wordBreak:"break-all"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center",marginRight:0},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"}}})),Sl=Object(h.a)((function(e){return{root:{margin:0,padding:0,height:"auto",width:"100%",whiteSpace:"break-all",wordBreak:"break-all"},content:{margin:0,height:"100%",padding:0},expandIcon:{margin:0},expanded:{marginRight:0}}}));function Dl(e){return Object(v.jsx)(so.a,Object(o.a)(Object(o.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(v.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 11.023h-11.826q-.375 0-.669.281t-.294.682v0q0 .401.294 .682t.669.281h11.826q.375 0 .669-.281t.294-.682v0q0-.401-.294-.682t-.669-.281z"})}))}function Il(e){return Object(v.jsx)(so.a,Object(o.a)(Object(o.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(v.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 12.977h-4.923v4.896q0 .401-.281.682t-.682.281v0q-.375 0-.669-.281t-.294-.682v-4.896h-4.923q-.401 0-.682-.294t-.281-.669v0q0-.401.281-.682t.682-.281h4.923v-4.896q0-.401.294-.682t.669-.281v0q.401 0 .682.281t.281.682v4.896h4.923q.401 0 .682.281t.281.682v0q0 .375-.281.669t-.682.294z"})}))}var $l=Object(_.a)((function(e){return{root:{marginRight:0,paddingRight:0,width:"100%"},iconContainer:{"& .close":{opacity:.3}},group:{marginLeft:7,paddingLeft:18,borderLeft:"1px dashed ".concat(Object(eo.c)(e.palette.text.primary,.4))}}}))((function(e){return Object(v.jsx)(oo.a,Object(o.a)({},e))}));function Tl(e){var t=e.task,a=e.filterOptions,n=Cl(),i=l.a.useState([]),c=Object(j.a)(i,2),r=c[0],o=c[1],s=l.a.useCallback((function(e,t){if(t){if(r.includes("treenode:"+e))return;o([].concat(Object(R.a)(r),["treenode:"+e]))}else{var a=r.reduce((function(t,a){return a==="treenode:"+e?Object(R.a)(t):[].concat(Object(R.a)(t),[a])}),[]);o(a)}}),[r]);return Object(v.jsx)(ro.a,{className:n.root,expanded:r,children:Object(v.jsx)(Ll,{task:t,filterOptions:a,nodesSelected:r,toggleSelection:s})})}var Pl,Al=l.a.memo(Tl),El=function(e){var t=e.task,a=e.theme;return t.status.toLowerCase().includes("error")?Object(v.jsx)(Z.a,{size:"small",style:{padding:"0",color:a.palette.error.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"cleared"===t.status?Object(v.jsx)(Z.a,{size:"small",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"cleared"}):t.completed?null:"submitted"===t.status?Object(v.jsx)(Z.a,{size:"small",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"processing"===t.status?Object(v.jsx)(Z.a,{size:"small",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):t.opsec_pre_blocked&&!t.opsec_pre_bypassed?Object(v.jsx)(Z.a,{size:"small",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (PRE)"}):t.opsec_post_blocked&&!t.opsec_post_bypassed?Object(v.jsx)(Z.a,{size:"small",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (POST)"}):Object(v.jsx)(Z.a,{size:"small",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()})},Fl=function(e){var t=e.task,a=e.theme,n=e.children,i=l.a.useState(a.palette.info.main),c=Object(j.a)(i,2),r=c[0],o=c[1];return Object(s.useEffect)((function(){t.status.toLowerCase().includes("error")?o(a.palette.error.main):"cleared"===t.status.toLowerCase()?o(a.palette.warning.main):t.completed?o(a.palette.success.main):"submitted"===t.status?o(a.palette.info.main):t.opsec_pre_blocked&&!t.opsec_pre_bypassed||t.opsec_post_blocked&&!t.opsec_post_bypassed||"processing"===t.status.toLowerCase()?o(a.palette.warning.main):o(a.palette.info.main)}),[t.status,t.completed]),Object(v.jsx)("span",{style:{display:"flex",margin:0,borderWidth:0,padding:0,minHeight:"48px",alignItems:"center",height:"100%",borderLeft:"6px solid "+r,paddingLeft:"5px",width:"100%"},children:n})},Ll=function e(t){var a=t.task,n=t.filterOptions,i=t.nodesSelected,c=t.toggleSelection,r=l.a.useState(!1),o=Object(j.a)(r,2),d=o[0],u=o[1],b=l.a.useState({task:[]}),p=Object(j.a)(b,2),h=p[0],m=p[1],f=l.a.useState(!1),O=Object(j.a)(f,2),x=O[0],g=O[1],y=l.a.useState(!0),_=Object(j.a)(y,2),k=_[0],w=_[1],C=Object(A.a)(I),S=Object(St.a)(wl,{onError:function(e){console.error(e)},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,onCompleted:function(e){if(!i.includes("treenode:"+a.id))return E(),void g(!1);P(2e3),m(e)}}),D=Object(j.a)(S,2),$=D[0],T=D[1],P=T.startPolling,E=T.stopPolling,F=l.a.useCallback((function(e){if(!x)return c(a.id,!0),g(!0),void $({variables:{task_id:a.id}});c(a.id,!1)}),[x]);Object(s.useEffect)((function(){if(a.display_params.includes("help")&&a.operator.username!==C.user.username)w(!1);else if(void 0!==n)if(n.operatorsList.length>0&&!n.operatorsList.includes(a.operator.username))k&&w(!1);else if(n.commentsFlag&&""===a.comment)k&&w(!1);else if(n.commandsList.length>0&&!n.commandsList.includes(a.command.cmd))k&&w(!1);else if(n.everythingButList.length>0&&null!==a.command&&n.everythingButList.includes(a.command.cmd))k&&w(!1);else{if(""!==n.parameterString)if(!new RegExp(n.parameterString).test(a.display_params))return void(k&&w(!1));k||w(!0)}else k||w(!0)}),[n,a.comment,a.command,a.display_params,a.operator.username]);var L=l.a.useCallback((function(e,t){u(!d)}),[d]),q=l.a.useCallback((function(e){e.preventDefault()}),[]);return k?Object(v.jsx)($l,{nodeId:"treenode:"+a.id,onLabelClick:q,onIconClick:F,icon:i.includes("treenode:"+a.id)?Object(v.jsx)(Dl,{}):a.tasks.length>0?Object(v.jsx)(Il,{}):null,label:Object(v.jsx)(ql,{task:a,dropdownOpen:d,toggleTaskDropdown:L}),children:h.task.map((function(t){return Object(v.jsx)(e,{task:t,nodesSelected:i,filterOptions:n,toggleSelection:c},"taskrow: "+t.id)}))}):null},ql=function(e){var t=e.task,a=e.dropdownOpen,n=e.toggleTaskDropdown,i=l.a.useState(new Date),c=Object(j.a)(i,2),r=c[0],o=(c[1],Object(A.a)(I)),d=Object(ve.a)(),u=l.a.useState(!1),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState(0),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Cl(),y=Sl(),_=Object(s.useRef)(t.responses_aggregate.aggregate.count);Object(s.useEffect)((function(){a?(_.current=t.responses_aggregate.aggregate.count,x(0)):t.responses_aggregate.aggregate.count>_.current&&(1===t.responses_aggregate.aggregate.count&&new Date(t.responses_aggregate.aggregate.max.timestamp)>r?n():x(t.responses_aggregate.aggregate.count-_.current))}),[t.responses_aggregate.aggregate.count,a]);return Object(v.jsx)(G.a,{className:g.root,elevation:5,style:{marginRight:0},children:Object(v.jsxs)(to.a,{TransitionProps:{unmountOnExit:!0,onEntered:function(e,a){document.getElementById("scrolltotask".concat(t.id)).scrollIntoView({behavior:"smooth",block:"start",inline:"start"})}},defaultExpanded:!1,onChange:n,expanded:a,children:[Object(v.jsx)(no.a,{expandIcon:Object(v.jsx)(en.a,{}),"aria-controls":"panel1c-content-task-".concat(t.id),id:"panel1c-header",classes:y,children:Object(v.jsx)(Fl,{task:t,theme:d,children:Object(v.jsxs)("div",{id:"scrolltotask"+t.id,style:{width:"100%"},children:[p?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Z.a,{className:g.secondaryHeading,children:t.commentOperator.username}),Object(v.jsx)(Z.a,{className:g.heading,children:t.comment})]}):null,Object(v.jsxs)(Z.a,{className:g.taskAndTimeDisplay,children:["[",xe(t.timestamp,o.user.view_utc_time),"] / ",t.id," / ",t.operator.username,Object(v.jsx)(El,{task:t,theme:d})]}),Object(v.jsxs)("div",{children:[""!==t.comment?Object(v.jsx)("div",{className:g.column,children:Object(v.jsx)(Y.a,{size:"small",style:{padding:"0"},color:"primary",onClick:function(e){e.stopPropagation(),h(!p)},children:Object(v.jsx)(co.a,{})})}):null,Object(v.jsx)("div",{className:g.column,children:Object(v.jsx)(Qe.a,{badgeContent:O,color:"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:Object(v.jsx)(Z.a,{className:g.heading,onClick:function(e){e.stopPropagation()},children:null===t.command?t.original_params:t.command.cmd+" "+t.display_params})})})]})]})})}),Object(v.jsx)(ao.a,{children:Object(v.jsx)(vl,{task:t})})]})})},Nl=a(894),Rl=a(904),Bl={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},Wl=Object(h.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}})),zl=Object(Pe.a)(Pl||(Pl=Object(B.a)(["\nquery operatorQuery($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    operators {\n      username\n      id\n    }\n  }\n}"])));function Hl(e){var t=Object(A.a)(I),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState([]),o=Object(j.a)(r,2),d=o[0],u=o[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],f=p[1],O=l.a.useState([]),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useState([]),k=Object(j.a)(_,2),C=k[0],S=k[1],D=l.a.useState(""),$=Object(j.a)(D,2),T=$[0],P=$[1],E=l.a.useState([]),F=Object(j.a)(E,2),L=F[0],q=F[1],N=Wl();Object(Ae.a)(zl,{variables:{operation_id:t.user.current_operation_id},onCompleted:function(e){u(e.operation_by_pk.operators.map((function(e){return e.username})))}}),Object(s.useEffect)((function(){void 0!==e.filterOptions.operatorsList&&c(e.filterOptions.operatorsList),void 0!==e.filterOptions.commentsFlag&&f(e.filterOptions.commentsFlag),void 0!==e.filterOptions.commandsList&&y(e.filterOptions.commandsList),void 0!==e.filterOptions.parameterString&&P(e.filterOptions.parameterString),void 0!==e.filterOptions.everythingButList&&S(e.filterOptions.everythingButList),e.filterCommandOptions&&q(e.filterCommandOptions)}),[e.filterOptions]);return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Filter Which Tasks Are Visible"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(Dt.a,{className:N.formControl,children:[Object(v.jsx)(Mt.a,{id:"operator-chip-label",children:"Only Show Tasks by the Following Operators"}),Object(v.jsx)(It.a,{labelId:"operator-chip-label",multiple:!0,id:"operator-chip",value:i,onChange:function(e){c(e.target.value)},input:Object(v.jsx)(Tt.a,{}),renderValue:function(e){return Object(v.jsx)("div",{className:N.chips,children:e.map((function(e){return Object(v.jsx)(Rl.a,{label:e,className:N.chip},e)}))})},MenuProps:Bl,children:d.map((function(e){return Object(v.jsxs)(Ot.a,{value:e,children:[Object(v.jsx)(Fa.a,{color:"primary",checked:i.indexOf(e)>-1}),Object(v.jsx)(Ea.a,{primary:e})]},e)}))})]}),"Only Show Tasks with Comments: ",Object(v.jsx)(K.a,{checked:h,onChange:function(e){f(e.target.checked)},color:"primary",name:"Only Comments",inputProps:{"aria-label":"primary checkbox"}}),Object(v.jsxs)(Dt.a,{className:N.formControl,children:[Object(v.jsx)(Mt.a,{id:"include-chip-label",children:"Only Show These Commands"}),Object(v.jsx)(It.a,{labelId:"include-chip-label",multiple:!0,id:"include-chip",value:g,onChange:function(e){y(e.target.value),e.target.value.length>0&&S([])},input:Object(v.jsx)(Tt.a,{}),renderValue:function(e){return Object(v.jsx)("div",{className:N.chips,children:e.map((function(e){return Object(v.jsx)(Rl.a,{label:e,className:N.chip},e)}))})},MenuProps:Bl,children:L.map((function(e){return Object(v.jsxs)(Ot.a,{value:e,children:[Object(v.jsx)(Fa.a,{color:"primary",checked:g.indexOf(e)>-1}),Object(v.jsx)(Ea.a,{primary:e})]},e)}))})]}),Object(v.jsxs)(Dt.a,{className:N.formControl,children:[Object(v.jsx)(Mt.a,{id:"exclude-chip-label",children:"Do Not Show These Commands"}),Object(v.jsx)(It.a,{labelId:"exclude-chip-label",multiple:!0,id:"exclude-chip",value:C,onChange:function(e){S(e.target.value),e.target.value.length>0&&y([])},input:Object(v.jsx)(Tt.a,{}),renderValue:function(e){return Object(v.jsx)("div",{className:N.chips,children:e.map((function(e){return Object(v.jsx)(Rl.a,{label:e,className:N.chip},e)}))})},MenuProps:Bl,children:L.map((function(e){return Object(v.jsxs)(Ot.a,{value:e,children:[Object(v.jsx)(Fa.a,{color:"primary",checked:C.indexOf(e)>-1}),Object(v.jsx)(Ea.a,{primary:e})]},e)}))})]}),Object(v.jsx)(w,{value:T,onChange:function(e,t,a){P(t)},name:"Only Show Tasks with the Following Parameter Regex"})]})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.onSubmit({operatorsList:i,commentsFlag:h,commandsList:g,everythingButList:C,parameterString:T}),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}function Ml(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),o=r[0],d=r[1],u=Object(s.useRef)(null);Object(s.useEffect)((function(){var t=Object(R.a)(e.options);i(t),t.length,d("Default Token"),e.changeSelectedToken("Default Token")}),[e.options]);return Object(v.jsxs)(Dt.a,{style:{maxWidth:"50%"},children:[Object(v.jsx)(Mt.a,{ref:u,children:"Tokens"}),Object(v.jsxs)(It.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:o,onChange:function(t){d(t.target.value),e.changeSelectedToken(t.target.value)},variant:"filled",renderValue:function(e){return"Default Token"===e?"Default Token":null===e.User?e.tokenId:e.User},input:Object(v.jsx)(Tt.a,{style:{width:"100%"}}),children:[Object(v.jsx)(Ot.a,{value:"Default Token",children:"Default Token"},0),n.map((function(e){return Object(v.jsx)(Ot.a,{value:e.token,children:null===e.token.User?e.token.TokenId+" - "+e.token.description:e.token.User+" - "+e.token.description},e.token.id)}))]})]})}var Ul=a(450);function Vl(e){var t=l.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(""),r=Object(j.a)(c,2),d=r[0],u=r[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],m=p[1],f=l.a.useState([]),O=Object(j.a)(f,2),x=O[0],g=O[1],_=l.a.useState([]),k=Object(j.a)(_,2),w=k[0],C=k[1],S=l.a.useState([]),D=Object(j.a)(S,2),I=D[0],$=D[1],T=l.a.useState(!1),P=Object(j.a)(T,2),A=P[0],E=P[1],F=l.a.useState([]),L=Object(j.a)(F,2),q=L[0],N=L[1];Object(s.useEffect)((function(){var t=e.loadedOptions.reduce((function(e,t){return-1===e.findIndex((function(e){return e.cmd===t.cmd}))?[].concat(Object(R.a)(e),[t]):Object(R.a)(e)}),Object(R.a)(e.nonLoadedCommands)).map((function(e){return e.cmd}));if(C(t),e.taskOptions){var a=e.taskOptions.task.map((function(e){return e.command?e.command.cmd+" "+e.original_params:e.original_params})).reduce((function(e,t){return e.includes(t)?e:[].concat(Object(R.a)(e),[t])}),[]);a.length!==I.length&&$(a)}else I.length>0&&$([])}),[e.loadedOptions,e.taskOptions,e.nonLoadedCommands]);Object(s.useEffect)((function(){var t=!1,a=e.tokens.reduce((function(a,n){if(n.callback.id!==e.callback_id)return Object(R.a)(a);var i=!1,c=a.map((function(e){return e.id===n.id?(i=!0,t=function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var a=0,n=Object.entries(e);a<n.length;a++){var i=Object(j.a)(n[a],2),c=i[0];if(i[1],e[c]!==t[c])return!1}return!0}(n,e),Object(o.a)({},n)):Object(o.a)({},e)}));return i?Object(R.a)(c):(t=!0,[].concat(Object(R.a)(c),[n]))}),Object(R.a)(q));t&&N(a)}),[e.tokens]);var B=function(e){if("ArrowUp"===e.code||"ArrowDown"===e.code)0===n.length&&(g(I),m(!0));else if("Tab"===e.key){if(""!==d&&h)i(d+" "),u(""),m(!1),e.preventDefault(),e.stopPropagation()}else if("Enter"===e.key){if(""!==d&&h)i(d+" "),u(""),m(!1),e.preventDefault(),e.stopPropagation();else h||W(e)}},W=function(t){t.preventDefault(),t.stopPropagation(),m(!1),e.onSubmitCommandLine(n),i(""),u("")},z=function(){E(!0)};return Object(v.jsxs)("div",{style:{position:"absolute",top:"92%",width:"100%"},children:[Object(v.jsx)("form",{onSubmit:W,children:Object(v.jsx)(Nl.a,{freeSolo:!0,autoHighlight:!0,open:h,onOpen:function(e){return"mousedown"===e.type||n.includes(" ")?(m(!1),!1):(m(!0),!0)},onClose:function(){return m(!1)},id:"free-solo-2-demo",filterOptions:function(e,t){var a=t.inputValue;return Object(Ul.a)(e,a)},disableClearable:!0,disableListWrap:!0,clearOnEscape:!0,inputValue:n,size:"small",openOnFocus:!1,onHighlightChange:function(e,t,a){n.includes(" ")&&h&&m(!1),"mouse"!==a&&null!==t&&null!==t&&u(t)},onChange:function(e,t){if("change"===e.type)t.length>0&&!t.includes(" ")?h?t.includes(" ")&&m(!1):(m(!0),g(w)):(m(!1),g(I));else if("keydown"===e.type){if("Escape"===e.key)return void m(!1);null===d||"Enter"!==e.key||t.includes(" ")?i(t):i(d+" ")}else if("click"===e.type)i(t+" "),m(!1);else if("blur"===e.type)return e.preventDefault(),void e.stopPropagation();(0===e.target.value.length||0===x.length)&&(m(!1),g(w))},options:x,onInputChange:function(e,t){null!==e&&("keydown"===e.type&&"Enter"===e.key||(i(t),t.length>0&&!h&&!t.includes(" ")?(g(w),m(!0)):0===t.length&&m(!1)))},renderInput:function(t){return Object(v.jsx)(y.a,Object(o.a)(Object(o.a)({},t),{},{placeholder:"Start Typing a Command...",onKeyDown:B,size:"small",variant:"outlined",InputProps:Object(o.a)(Object(o.a)({},t.InputProps),{},{type:"search",endAdornment:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Y.a,{color:"primary",variant:"contained",onClick:W,children:Object(v.jsx)(Xn.a,{})}),Object(v.jsx)(Y.a,{color:"secondary",variant:"contained",onClick:z,children:Object(v.jsx)(Ui.a,{})})]}),startAdornment:Object(v.jsx)(l.a.Fragment,{children:q.length>0?Object(v.jsx)(Ml,{options:q,changeSelectedToken:e.changeSelectedToken}):null})})}))}})}),A&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:A,onClose:function(){E(!1)},innerDialog:Object(v.jsx)(Hl,{filterCommandOptions:w,onSubmit:e.onSubmitFilter,filterOptions:e.filterOptions,onClose:function(){E(!1)}})})]})}var Gl,Kl,Ql,Jl,Yl,Zl,Xl=l.a.memo(Vl),ed=a(452),td=a.n(ed);function ad(e){var t=l.a.useState(e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?e.tabInfo.callbackDescription:"Callback: "+e.tabInfo.callbackID),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),d=r[0],u=r[1];Object(s.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?i(e.tabInfo.callbackDescription):i("Callback: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Zr,Object(o.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),u(!0)}},e)),d&&Object(v.jsx)(he,{fullWidth:!0,open:d,onClose:function(){u(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Tab's Description",onClose:function(){u(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var nd,id=Object(Pe.a)(Gl||(Gl=Object(B.a)(["\n    fragment taskData on task {\n        comment\n        callback_id\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        display_params\n        status\n        timestamp\n        command {\n          cmd\n          id\n        }\n        responses_aggregate {\n            aggregate{\n              count\n              max {\n                timestamp\n              }\n            }\n          }\n        opsec_pre_blocked\n        opsec_pre_bypassed\n        opsec_post_blocked\n        opsec_post_bypassed\n        tasks {\n            id\n        }\n        token {\n            id\n        }\n    }\n"]))),cd=Object(Pe.a)(Kl||(Kl=Object(B.a)(["\nsubscription GetLoadedCommandsSubscription($callback_id: Int!){\n    loadedcommands(where: {callback_id: {_eq: $callback_id}}){\n        id\n        command {\n            cmd\n            help_cmd\n            description\n            id\n            needs_admin\n            payload_type_id\n            attributes\n            commandparameters {\n                id\n                type \n            }\n        }\n    }\n    \n}\n"]))),rd=Object(Pe.a)(Ql||(Ql=Object(B.a)(["\nquery GetLoadedCommandsQuery($payloadtype: String!) {\n  command(where: {payloadtype: {ptype: {_eq: $payloadtype}}, script_only: {_eq: true}, deleted: {_eq: false}}){\n      id\n      cmd\n      help_cmd\n      description\n      needs_admin\n      attributes\n      payload_type_id\n      commandparameters {\n          id\n          type\n      }\n    }\n}\n"]))),od=Object(Pe.a)(Jl||(Jl=Object(B.a)(["\nmutation createTasking($callback_id: Int!, $command: String!, $params: String!, $files: String, $token_id: Int) {\n  createTask(callback_id: $callback_id, command: $command, params: $params, files: $files, token: $token_id) {\n    status\n    id\n    error\n  }\n}\n"]))),sd=Object(Pe.a)(Yl||(Yl=Object(B.a)(["\n","\nsubscription getTasking($callback_id: Int!, $fromNow: timestamp!, $limit: Int){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}, timestamp: {_gt: $fromNow}}, order_by: {id: desc}, limit: $limit) {\n        ...taskData\n    }\n}\n "])),id),ld=Object(Pe.a)(Zl||(Zl=Object(B.a)(["\n","\nquery getBatchTasking($callback_id: Int!, $offset: Int!, $fetchLimit: Int!){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}}, order_by: {id: desc}, limit: $fetchLimit, offset: $offset) {\n        ...taskData\n    }\n    callback(where: {id: {_eq: $callback_id}}){\n        id\n    }\n}\n"])),id),dd=function(e){var t=e.tabInfo,a=e.callbacktokens,n=e.index,i=e.value,c=e.style,r=e.onCloseTab,d=l.a.useState([]),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useState(10),m=Object(j.a)(h,2),f=m[0],O=m[1],x=l.a.useState([]),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState(!1),w=Object(j.a)(k,2),C=w[0],S=w[1],D=l.a.useState({}),I=Object(j.a)(D,2),$=I[0],T=I[1],P=l.a.useState({task:[]}),A=Object(j.a)(P,2),E=A[0],F=A[1],L=l.a.useRef({task:[]}),N=l.a.useState((new Date).toISOString()),B=Object(j.a)(N,2),W=B[0],z=(B[1],l.a.useState({})),H=Object(j.a)(z,2),M=H[0],U=H[1],V=l.a.useState({operatorsList:[],commentsFlag:!1,commandsList:[],parameterString:"",everythingButList:[]}),G=Object(j.a)(V,2),K=G[0],Q=G[1],J=Object(s.useRef)(null),Z=l.a.useState(!0),X=Object(j.a)(Z,2),ee=X[0],te=X[1];Object(s.useEffect)((function(){L.current=E}),[E]);var ae=l.a.useState(!1),ne=Object(j.a)(ae,2),ie=ne[0],ce=ne[1],re=l.a.useState(!1),oe=Object(j.a)(re,2),se=oe[0],le=oe[1],de=Object(s.useRef)(null),ue=Object(Ee.a)(od,{update:function(e,t){var a=t.data;"error"===a.createTask.status?q.error(a.createTask.error):q.success("Task created",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),be=Object(j.a)(ue,1)[0],je=Object(St.a)(rd,{onCompleted:function(e){var a=e.command.reduce((function(e,a){if(e.includes(a.cmd))return Object(R.a)(e);var n=JSON.parse(a.attributes);return 0===n.supported_os.length||n.supported_os.includes(t.os)?[].concat(Object(R.a)(e),[a]):Object(R.a)(e)}),[]);a.sort((function(e,t){return-t.cmd.localeCompare(e.cmd)})),_(a)},onError:function(e){console.error(e)},fetchPolicy:"network-only"}),pe=Object(j.a)(je,1)[0];Object(nt.a)(cd,{variables:{callback_id:t.callbackID},onError:function(e){},onSubscriptionData:function(e){var a=e.subscriptionData.data.loadedcommands.reduce((function(e,a){var n=JSON.parse(a.command.attributes);return 0===n.supported_os.length||n.supported_os.includes(t.os)?[].concat(Object(R.a)(e),[a.command]):Object(R.a)(e)}),[{attributes:{supported_os:[]},commandparameters:[],help:"clear {all | task#}",needs_admin:!1,cmd:"clear",id:-1},{attributes:{supported_os:[]},commandparameters:[],help:"help {command name}",needs_admin:!1,cmd:"help",id:-2}].concat(Object(R.a)(y)));a.sort((function(e,t){return-t.cmd.localeCompare(e.cmd)})),p(a)}});var me=Object(s.useCallback)((function(e){var t=e.subscriptionData;ie||ce(!0);var a=L.current.task.length,n=t.data.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):[].concat(Object(R.a)(e),[t])}),Object(R.a)(L.current.task));n.sort((function(e,t){return e.id<t.id?-1:1})),function(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++){if(e[a].comment!==t[a].comment)return!1;if(e[a].commentOperator!==t[a].commentOperator)return!1;if(e[a].completed!==t[a].completed)return!1;if(e[a].display_params!==t[a].display_params)return!1;if(e[a].original_params!==t[a].original_params)return!1;if(e[a].status!==t[a].status)return!1;if(e[a].timestamp!==t[a].timestamp)return!1;if(e[a].responses_aggregate.aggregate.count!==t[a].responses_aggregate.aggregate.count)return!1;if(e[a].opsec_pre_blocked!==t[a].opsec_pre_blocked)return!1;if(e[a].opsec_pre_bypassed!==t[a].opsec_pre_bypassed)return!1;if(e[a].opsec_post_blocked!==t[a].opsec_post_blocked)return!1;if(e[a].opsec_post_bypassed!==t[a].opsec_post_bypassed)return!1;if(e[a].tasks.length!==t[a].tasks.length)return!1}return!0}(L.current.task,n)||F({task:n}),n.length>a&&te(!0),n.length>f&&O(n.length)}),[ie,ce,te,f]);Object(nt.a)(sd,{variables:{callback_id:t.callbackID,fromNow:W,limit:f},onError:function(e){console.error(e)},fetchPolicy:"no-cache",onSubscriptionData:me});var fe=Object(s.useCallback)((function(){E&&de.current&&de.current.scrollIntoView({behavior:"smooth"})}),[E,de]);Object(s.useLayoutEffect)((function(){ee&&(fe(),te(!1))}),[ee,fe]);var Oe=Object(St.a)(ld,{onError:function(e){console.error(e)},onCompleted:function(e){var a=!1;if(0!==e.callback.length){var n=e.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):(a=!0,[].concat(Object(R.a)(e),[t]))}),Object(R.a)(E.task));n.sort((function(e,t){return e.id<t.id?-1:1})),F({task:n}),a?(e.task.length<10?le(!0):le(!1),q.success("Loaded tasks",{autoHideDuration:1e3})):(q.info("No older tasks available",{autoHideDuration:1e3}),le(!0))}else r(t)},fetchPolicy:"no-cache"}),xe=Object(j.a)(Oe,2),ge=xe[0],ye=xe[1].loading;Object(s.useEffect)((function(){pe({variables:{payloadtype:t.payloadtype}}),ge({variables:{callback_id:t.callbackID,offset:E.task.length,fetchLimit:10}}),te(!0)}),[]);var _e=function(e){var t=e.callback_id,a=e.command,n=e.params,i=e.files;void 0!==M.id?be({variables:{callback_id:t,command:a,params:n,files:i,token_id:M.TokenId}}):be({variables:{callback_id:t,command:a,params:n,files:i}})};return Object(v.jsxs)(Jr,{index:n,value:i,style:c,children:[Object(v.jsxs)("div",{style:{overflow:"auto",height:"92%",maxHeight:"92%"},children:[Object(v.jsxs)("div",{ref:J,style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[!se&&Object(v.jsx)(Kc.a,{title:"Fetch Older Tasks",children:Object(v.jsx)(Y.a,{onClick:function(){ge({variables:{callback_id:t.callbackID,offset:E.task.length,fetchLimit:10}})},variant:"contained",color:"primary",children:Object(v.jsx)(td.a,{})})}),!ie&&Object(v.jsx)(Fe.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}}),ye&&Object(v.jsx)(Fe.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}})]}),E.task.map((function(e){return Object(v.jsx)(Al,{task:e,command_id:null==e.command?0:e.command.id,filterOptions:K},"taskinteractdisplay"+e.id)})),Object(v.jsx)("div",{ref:de})]}),C&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:C,onClose:function(){S(!1)},innerDialog:Object(v.jsx)(Xo,{command:$,callback_id:t.callbackID,payloadtype_id:t.payloadtype_id,operation_id:t.operation_id,onSubmit:function(e,a,n){S(!1),_e({callback_id:t.callbackID,command:e,params:a,files:n})},onClose:function(){S(!1)}})}),Object(v.jsx)(Xl,{onSubmitFilter:function(e){Q(e)},onSubmitCommandLine:function(e){var a=e.split(" ")[0],n=e.substring(a.length).trim(),i=b.find((function(e){return e.cmd===a}));if(void 0!==i)if(0===i.commandparameters.length)_e({callback_id:t.callbackID,command:a,params:n});else{if(i.commandparameters.find((function(e){return"File"===e.parameter_type}))||0===n.length)return T(Object(o.a)(Object(o.a)({},i),{},{typedParameters:e})),void S(!0);_e({callback_id:t.callbackID,command:a,params:n})}else q.warning("Unknown command",{autoHideDuration:1e3})},changeSelectedToken:function(e){"Default Token"!==e?e.TokenId!==M.TokenId&&U(e):U("Default Token")},filterOptions:K,loadedOptions:b,nonLoadedCommands:y,taskOptions:E,tokens:a,callback_id:t.callbackID})]})},ud=Object(Pe.a)(nd||(nd=Object(B.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    last_checkin\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n    callbacktokens(where: {deleted: {_eq: false}}) {\n      token {\n        TokenId\n        id\n        User\n        description\n      }\n      callback {\n        id\n      }\n      id\n    }\n  }\n}\n "])));function bd(e){var t=Object(S.g)().callbackId,a=l.a.useState({payload:{payloadtype:{ptype:""}},callbacktokens:[]}),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState({callbackID:parseInt(t)}),o=Object(j.a)(r,2),s=o[0],d=o[1];return Object(nt.a)(ud,{variables:{callback_id:t},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var a=e.subscriptionData;null!==a.data.callback_by_pk?(c(a.data.callback_by_pk),d({tabID:"interact",tabType:"interact",callbackID:parseInt(t),payloadtype:a.data.callback_by_pk.payload.payloadtype.ptype,payloadDescription:a.data.callback_by_pk.payload.tag,callbackDescription:a.data.callback_by_pk.description,os:a.data.callback_by_pk.payload.os})):q.error("Unknown Callback")}}),Object(v.jsx)("div",{style:{maxWidth:"100%",height:"calc(96vh)"},children:void 0!==s.payloadtype?Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Hr,{callback:i}),Object(v.jsx)(dd,{style:{height:"calc(".concat(96,"vh)"),maxHeight:"calc(".concat(96,"vh)"),width:"69%",maxWidth:"69%",position:"absolute",overflow:"auto",display:"inline-flex",flexDirection:"column"},tabInfo:s,callbacktokens:i.callbacktokens})]}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"Fetching Callback"})})}var jd,pd=a(287),hd=a(880),md=Object(h.a)((function(e){return{root:{width:"100%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:pd.a[500]}}}));function fd(){var e=md(),t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1];return Object(v.jsxs)(Ve.a,{className:e.root,elevation:5,children:[Object(v.jsx)(La.a,{avatar:Object(v.jsx)(Mn.a,{className:e.avatar}),title:"Mythic Quick Start Guide",subheader:"Expand this section to learn how to: Generate a Payload, Download the Payload, Get To Callbacks",style:{paddingBottom:0,marginBottom:0}}),Object(v.jsx)(Ja.a,{styl:{padding:0,margin:0},children:Object(v.jsx)(Y.a,{className:Object(p.default)(e.expand,Object(b.a)({},e.expandOpen,n)),onClick:function(){i(!n)},"aria-expanded":n,"aria-label":"show more",children:Object(v.jsx)(en.a,{})})}),Object(v.jsx)(J.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(v.jsx)(Ke.a,{style:{margin:0,paddingTop:0},children:Object(v.jsxs)("ol",{children:[Object(v.jsxs)("li",{children:["Create a payload at ",Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/createpayload",children:"Create -> Create Payload"}),Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:"Select Desired OS"}),Object(v.jsx)("li",{children:"Select Payload Type and Supply Build Parameters"}),Object(v.jsx)("li",{children:"Select Commands You Want Stamped Into The Agent"}),Object(v.jsx)("li",{children:"Select C2 Profiles and Fill Out Parameters"}),Object(v.jsx)("li",{children:"Name Your Payload"}),Object(v.jsx)("li",{children:"Provide a Description"}),Object(v.jsx)("li",{children:"Build Your Payload"})]})]}),Object(v.jsxs)("li",{children:["Download Your Payload at ",Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/payloads",children:"Operational Data -> Payloads"})]}),Object(v.jsxs)("li",{children:["Run Your payload",Object(v.jsx)("ul",{children:Object(v.jsxs)("li",{children:["For More Information About Your Agent, Check Out The ",Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/docs/agents",children:"Internal Documentation"})]})})]}),Object(v.jsxs)("li",{children:["Interact With Your Agent At ",Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks",children:"Active Callbacks"})]})]})})})]})}var Od=Object(Pe.a)(jd||(jd=Object(B.a)(["\nquery GetC2AndPayloadType {\n  c2profile(where: {deleted: {_eq: false}}) {\n    name\n    id\n  }\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    id\n    payloadtypec2profiles {\n      c2profile {\n        name\n        id\n      }\n    }\n  }\n  wrappers: payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n      }\n    }\n  }\n}\n"])));function xd(e){var t=Object(ve.a)(),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState([]),o=Object(j.a)(r,2),s=o[0],d=o[1],u=l.a.useState([]),b=Object(j.a)(u,2),p=b[0],h=b[1];return Object(Ae.a)(Od,{fetchPolicy:"network-only",onCompleted:function(e){var t=e.c2profile.map((function(e){return e.name})),a=e.payloadtype.map((function(e){var t=e.payloadtypec2profiles.map((function(e){return e.c2profile.name}));return{ptype:e.ptype,payloadtypec2profiles:t}}));t.sort(),a.sort((function(e,t){return e.ptype<t.ptype?-1:1}));var n=e.wrappers.map((function(e){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));return{ptype:e.ptype,wrapped:t}}));n.sort((function(e,t){return e.ptype<t.ptype?-1:1})),h(n),c(t),d(a)},onError:function(e){}}).loading?Object(v.jsx)(Fe.a,{}):Object(v.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Agent / C2 Overview"})}),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{}),i.map((function(e){return Object(v.jsx)(H.a,{children:e},e)}))]})}),Object(v.jsx)(z.a,{children:s.map((function(e){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:e.ptype}),i.map((function(a){return Object(v.jsx)(H.a,{children:e.payloadtypec2profiles.includes(a)?Object(v.jsx)(Kc.a,{title:e.ptype+" supports "+a,children:Object(v.jsx)(an.a,{style:{color:t.palette.success.main}})}):""},"payload"+a)}))]},e.ptype)}))})]})}),p.length>0&&Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{marginTop:"10px"},children:Object(v.jsxs)(W.a,{size:"small",children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{}),s.map((function(e){return Object(v.jsx)(H.a,{children:e.ptype},"wrapped"+e.ptype)}))]})}),Object(v.jsx)(z.a,{children:p.map((function(e){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:e.ptype}),s.map((function(a){return Object(v.jsx)(H.a,{children:e.wrapped.includes(a.ptype)?Object(v.jsx)(Kc.a,{title:e.ptype+" wraps "+a.ptype,children:Object(v.jsx)(an.a,{style:{color:t.palette.success.main}})}):""},"payload"+a.ptype)}))]},"wrapper"+e.ptype)}))})]})})]})}function gd(){var e=Object(ve.a)();return Object(v.jsxs)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:e.pageHeader.main,color:e.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Welcome To Mythic"})}),Object(v.jsx)(fd,{}),Object(v.jsx)(xd,{})]})}var yd=["component"];function _d(e){var t=e.component,a=Object(Ur.a)(e,yd),n=Object(A.a)(I);return Object(v.jsx)(S.b,Object(o.a)(Object(o.a)({},a),{},{render:function(e){return n.loggedIn&&null!==n.user?l.a.createElement(t,e):Object(v.jsx)(S.a,{to:{pathname:"/new/login",state:{from:e.location}}})}}))}var vd=a(881),kd=a(889),wd=a(455),Cd=a.n(wd),Sd=a(277),Dd=a.n(Sd),Id=a(279),$d=a.n(Id),Td=a(454),Pd=a.n(Td),Ad=a(274),Ed=a.n(Ad),Fd=a(453),Ld=a.n(Fd),qd=a(273),Nd=a.n(qd),Rd=a(191),Bd=a.n(Rd),Wd=a(285),zd=Object(h.a)((function(e){return{root:{width:"99%",marginTop:"3px",marginBottom:"2px",marginLeft:"3px",marginRight:"0px",height:"auto"},heading:{fontSize:e.typography.pxToRem(15),whiteSpace:"pre-line"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"calc(90vw)",whiteSpace:"break-word"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),Hd=function(e,t,a,n,i){return{data:Object(o.a)({id:e.id.toString(),isLeaf:void 0===e.filebrowserobjs||0===Object.keys(e.filebrowserobjs).length,isOpenByDefault:!0,name:e.name_text,nestingLevel:t,fetchFolderData:a,setTableData:n,theme:i},e),nestingLevel:t,node:e}},Md=function(e){var t=i.a.mark(o),a=e.treeRoot,n=e.fetchFolderData,c=e.setTableData,r=Object(ve.a)();function o(){var e,o,s,l,d,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(!(e<a.length)){t.next=7;break}return t.next=4,Hd(a[e],0,n,c,r);case 4:e++,t.next=1;break;case 7:return void(t.next=10);case 10:o=t.sent,s=0,l=Object.entries(o.node.filebrowserobjs);case 12:if(!(s<l.length)){t.next=21;break}if(d=Object(j.a)(l[s],2),d[0],!(u=d[1]).is_file){t.next=16;break}return t.abrupt("continue",18);case 16:return t.next=18,Hd(u,o.nestingLevel+1,n,c,r);case 18:s++,t.next=12;break;case 21:t.next=7;break;case 23:case"end":return t.stop()}}),t)}return 0===a.length?Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No File Browser Data Collected"}):Object(v.jsx)(bi.a,{children:function(e){var t=e.height,a=e.width;return Object(v.jsx)(Wd.a,{treeWalker:o,height:t,width:a-10,itemSize:30,overscanCount:20,async:!0,placeholder:Object(v.jsx)("div",{children:"Loading...."}),children:Ud})}})},Ud=function(e){var t=e.data,a=e.isOpen,n=e.style,i=e.setOpen;return Object(v.jsxs)("div",{style:Object(o.a)(Object(o.a)({},n),{},{width:"calc(100vw)",display:"inline-flex",overflow:"auto"}),children:[Object(R.a)(Array(t.nestingLevel)).map((function(e,a){return Object(v.jsx)("div",{style:{borderLeft:"1px dashed ".concat(Object(eo.c)(t.theme.palette.text.primary,.4)),marginLeft:15,paddingRight:15,height:"100%",display:"inline-block"}},"folder"+t.id+"lines"+a)})),Object(v.jsx)(Vd,{filebrowserobj:t,isOpen:a,setOpen:i})]})},Vd=function(e){var t=zd(),a=Object(ve.a)(),n=function(){q.info("fetching elements...",{persist:!0}),e.filebrowserobj.fetchFolderData(e.filebrowserobj),e.isOpen||e.filebrowserobj.fetchFolderData(e.filebrowserobj)},i=function(t){t.stopPropagation(),n(),e.isOpen||n(),e.setOpen(!e.isOpen)};return Object(v.jsxs)(G.a,{className:t.root,elevation:5,style:{backgroundColor:a.body,color:a.text,alignItems:"center",display:"flex"},onClick:function(){e.filebrowserobj.setTableData(e.filebrowserobj)},children:[null===e.filebrowserobj.parent_id?Object(v.jsx)(Ld.a,{style:{marginLeft:"3px",marginRight:"5px"}}):e.filebrowserobj.is_file?Object(v.jsx)(Nd.a,{style:{marginLeft:"3px",marginRight:"5px"}}):e.isOpen?Object(v.jsx)(Ed.a,{style:{marginLeft:"3px",marginRight:"5px",color:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>0||null!==e.filebrowserobj.success?a.folderColor:"grey"},onClick:i}):Object(v.jsx)(Pd.a,{style:{paddingTop:"5px",marginLeft:"3px",marginRight:"5px"},onClick:i}),e.filebrowserobj.nestingLevel>0&&e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>99?Object(v.jsx)(Kc.a,{title:"Number of known children",children:Object(v.jsx)(Qe.a,{style:{left:-50},max:99,badgeContent:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count,color:"primary",anchorOrigin:{vertical:"bottom",horizontal:"left"}})}):null,Object(v.jsx)(Z.a,{style:{color:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>0||null!==e.filebrowserobj.success?a.palette.text.primary:a.palette.text.secondary},children:null===e.filebrowserobj.parent_id?e.filebrowserobj.host:e.filebrowserobj.name_text}),!0===e.filebrowserobj.success&&e.filebrowserobj.nestingLevel>0?Object(v.jsx)(Kc.a,{title:"Successfully listed contents of folder",children:Object(v.jsx)(an.a,{fontSize:"small",style:{color:a.palette.success.main}})}):!1===e.filebrowserobj.success&&e.filebrowserobj.nestingLevel>0?Object(v.jsx)(Kc.a,{title:"Failed to list contents of folder",children:Object(v.jsx)(Bd.a,{fontSize:"small",style:{color:a.palette.danger.main}})}):null]})};function Gd(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(ve.a)();return Object(s.useEffect)((function(){i(e.value)}),[e.value]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:e.title}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(G.a,{elevation:5,style:{position:"relative",backgroundColor:c.body},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Download"}),Object(v.jsx)(H.a,{children:"Time"}),Object(v.jsx)(H.a,{children:"Task"}),Object(v.jsx)(H.a,{children:"Comment"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.complete?Object(v.jsx)(Y.a,{href:"/api/v1.4/files/download/"+e.agent_file_id,style:{color:c.palette.success.main},children:Object(v.jsx)(er.a,{})}):e.chunks_received+"/"+e.total_chunks}),Object(v.jsx)(H.a,{children:e.timestamp}),Object(v.jsx)(H.a,{children:e.task.id}),Object(v.jsx)(H.a,{children:e.comment})]},"hist"+e.id)}))})]})})})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Kd,Qd,Jd,Yd,Zd,Xd,eu,tu,au,nu,iu=a(275),cu=a.n(iu),ru=a(161),ou=a.n(ru),su=a(276),lu=a.n(su),du=Object(Pe.a)(Kd||(Kd=Object(B.a)(["\nquery getPermissionsQuery($filebrowserobj_id: Int!){\n    filebrowserobj_by_pk(id: $filebrowserobj_id){\n        id\n        permissions\n    }\n}\n"]))),uu=Object(Pe.a)(Qd||(Qd=Object(B.a)(["\nquery getFileDownloadHistory($filebrowserobj_id: Int!){\n    filebrowserobj_by_pk(id: $filebrowserobj_id){\n        filemeta {\n            id\n            comment\n            agent_file_id\n            chunks_received\n            complete\n            total_chunks\n            timestamp\n            task {\n                id\n                comment\n            }\n        }\n    }\n}\n"]))),bu=Object(Pe.a)(Jd||(Jd=Object(B.a)(["\nmutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!){\n    update_filebrowserobj_by_pk(pk_columns: {id: $filebrowserobj_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"]))),ju=function(e){var t=e.columnData,a=e.dataKey,n=e.rowData;return function(){switch(t.format){case"string":return Object(v.jsx)(mu,{cellData:n[a],rowData:n});case"name":return Object(v.jsx)(hu,{cellData:n[a],rowData:n});case"size":return Object(v.jsx)(fu,{cellData:n[a]});case"button":return Object(v.jsx)(Ou,{rowData:n,onTaskRowAction:t.onTaskRowAction});default:return Object(v.jsx)(mu,{cellData:n[a],rowData:n})}}()},pu=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useRef(null),r=l.a.useState("ASC"),d=Object(j.a)(r,2),u=d[0],p=d[1],h=l.a.useState("name_text"),m=Object(j.a)(h,2),f=m[0],O=m[1],x=l.a.useState({actions:.065,name_text:.45,size:.08,modify_time:.18,comment:.2}),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState([]),w=Object(j.a)(k,2),C=w[0],S=w[1],D=function(e){var t=e.sortBy,a=e.sortDirection,c=Object(R.a)(n),r=C.filter((function(e){return e.dataKey===t}))[0].columnData.format;"number"===r||"size"===r?c.sort((function(e,a){return parseInt(e[t])>parseInt(a[t])?1:-1})):"date"===r?c.sort((function(e,a){return new Date(e[t])>new Date(a[t])?1:-1})):c.sort((function(e,a){return e[t].toLowerCase()>a[t].toLowerCase()?1:-1})),"DESC"===a&&c.reverse(),i(Object(R.a)(c)),O(t),p(a)},I=function(e){var t=e.index;return n[t]},$=l.a.useCallback((function(e){var t,a=e.event,n=e.dataKey,i=e.deltaX;a.preventDefault(),a.stopPropagation();for(var r=Object(o.a)({},y),s=i/c.current.offsetWidth,l="",d=!1,u=0,p=Object.entries(y);u<p.length;u++){var h=Object(j.a)(p[u],2),m=h[0];h[1];if(d){l=m;break}m===n&&(d=!0)}if(""!==l){var f=Object(o.a)(Object(o.a)({},r),{},(t={},Object(b.a)(t,n,r[n]+s),Object(b.a)(t,l,r[l]-s),t));_(f)}else console.log("next header not found")}),[y]),T=l.a.useCallback((function(e){var t=e.columnData,a=e.dataKey,n=(e.disableSort,e.label),i=e.sortBy,c=e.sortDirection;return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)("span",{style:{display:"inline-flex",flexDirection:"row",alignContent:"stretch",justifyContent:"flex-start"},children:[n,i===a?"ASC"===c?Object(v.jsx)(go.a,{}):Object(v.jsx)(_o.a,{}):null]}),"button"!==t.format&&"Comment"!==n&&Object(v.jsx)(Oo.a,{axis:"x",defaultClassName:"DragHandle",defaultClassNameDragging:"DragHandleActive",onDrag:function(e,t){var n=t.deltaX;return $({event:e,dataKey:a,deltaX:n})},position:{x:0},zIndex:999,children:Object(v.jsx)("span",{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"DragHandleIcon",style:{width:"20px",textAlign:"center"},children:"\u22ee"})})]},"header"+a)}),[$,C]),P=function(t){t.event,t.index;var a=t.rowData;a.is_file||(q.info("Fetching contents of folder..."),e.onRowDoubleClick(a))};return Object(s.useEffect)((function(){S([{columnData:{format:"button",onTaskRowAction:e.onTaskRowAction},dataKey:"actions",label:"Actions",cellRenderer:ju,width:y.actions*c.current.offsetWidth,headerRenderer:T},{columnData:{format:"name"},dataKey:"name_text",label:"Name",cellRenderer:ju,width:y.name_text*c.current.offsetWidth,headerRenderer:T},{columnData:{format:"size"},dataKey:"size",label:"Size",cellRenderer:ju,width:y.size*c.current.offsetWidth,headerRenderer:T},{columnData:{format:"date"},dataKey:"modify_time",label:"Last Modified",cellRenderer:ju,width:y.modify_time*c.current.offsetWidth,headerRenderer:T},{columnData:{format:"string"},dataKey:"comment",label:"Comment",cellRenderer:ju,width:y.comment*c.current.offsetWidth,headerRenderer:T}])}),[y,e.onTaskRowAction]),Object(s.useEffect)((function(){if(e.showDeletedFiles)i(Object(R.a)(e.selectedFolder));else{var t=e.selectedFolder.filter((function(e){return!e.deleted}));i(Object(R.a)(t))}}),[e.selectedFolder,e.showDeletedFiles]),Object(v.jsx)("div",{ref:c,style:{width:"100%",height:"90%",overflow:"hidden"},children:Object(v.jsx)(mo.a,{children:function(e){var t=e.height,a=e.width;return Object(v.jsx)(mo.c,{headerHeight:25,rowCount:n.length,rowGetter:I,rowHeight:35,height:t,width:a,sort:D,sortBy:f,onRowDoubleClick:P,sortDirection:u,children:C.map((function(e){return Object(v.jsx)(mo.b,Object(o.a)({},e),"col"+e.dataKey)}))})}})})},hu=function(e){var t=e.cellData,a=e.rowData,n=Object(ve.a)();return Object(v.jsxs)("div",{style:{alignItems:"center",display:"flex",textDecoration:a.deleted?"line-through":""},children:[a.is_file?Object(v.jsx)(Nd.a,{style:{marginRight:"5px"}}):Object(v.jsx)(Ed.a,{style:{marginRight:"5px",color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.folderColor:"grey"}}),a.filemeta.length>0?Object(v.jsx)(er.a,{style:{color:n.palette.success.main}}):null,Object(v.jsx)(Z.a,{style:{color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.palette.text.primary:n.palette.text.secondary},children:t}),!0===a.success?Object(v.jsx)(Kc.a,{title:"Successfully listed contents of folder",children:Object(v.jsx)(an.a,{fontSize:"small",style:{color:n.palette.success.main}})}):!1===a.success?Object(v.jsx)(Kc.a,{title:"Failed to list contents of folder",children:Object(v.jsx)(Bd.a,{fontSize:"small",style:{color:n.palette.danger.main}})}):null]})},mu=function(e){return e.cellData},fu=function(e){var t=e.cellData;return Object(v.jsx)("div",{children:function(){try{var e=parseInt(t);if(""===t)return"";if(0===e)return"0 Bytes";var a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}catch(n){return t}}()})},Ou=function(e){var t=e.rowData,a=e.onTaskRowAction,n=l.a.useRef(null),i=Object(ve.a)(),c=l.a.useState(!1),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(!1),b=Object(j.a)(u,2),p=b[0],h=b[1],f=l.a.useState(!1),O=Object(j.a)(f,2),x=O[0],g=O[1],y=l.a.useState(!1),_=Object(j.a)(y,2),k=_[0],w=_[1],C=l.a.useState(""),S=Object(j.a)(C,2),D=S[0],I=S[1],$=l.a.useState([]),T=Object(j.a)($,2),P=T[0],A=T[1],E=Object(St.a)(du,{onCompleted:function(e){I(e.filebrowserobj_by_pk.permissions),""!==e.filebrowserobj_by_pk.permissions?g(!0):q.warning("No permission data available")},fetchPolicy:"network-only"}),F=Object(j.a)(E,1)[0],L=Object(St.a)(uu,{onCompleted:function(e){0===e.filebrowserobj_by_pk.filemeta.length?q.warning("File has no download history"):(A(e.filebrowserobj_by_pk.filemeta),w(!0))},fetchPolicy:"network-only"}),N=Object(j.a)(L,1)[0],R=Object(Ee.a)(bu,{onCompleted:function(e){q.success("updated comment")}}),B=Object(j.a)(R,1)[0],W=function(e,t,a){switch(e){case"A":H[a].click(t);break;case"B":M[a].click(t)}d(!1)},z=function(e){n.current&&n.current.contains(e.target)||d(!1)},H=[{name:"View Permissions",icon:Object(v.jsx)(ou.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),F({variables:{filebrowserobj_id:t.id}})}},{name:"Download History",icon:Object(v.jsx)(cu.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),N({variables:{filebrowserobj_id:t.id}})}},{name:"Edit Comment",icon:Object(v.jsx)(Ai.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),h(!0)}},{name:"Copy Path to Clipboard",icon:Object(v.jsx)(bo.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),lo(t.full_path_text)?q.success("Copied text!"):q.error("Failed to copy text")}}],M=[{name:"Task File Listing",icon:Object(v.jsx)(lu.a,{style:{paddingRight:"5px",color:i.palette.warning.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:list"})}},{name:"Task Download",icon:Object(v.jsx)(er.a,{style:{paddingRight:"5px",color:i.palette.success.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:download"})}},{name:"Task File Removal",icon:Object(v.jsx)(ie.a,{style:{paddingRight:"5px",color:i.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:remove"})}}];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(m.a,{style:{padding:0},size:"small","aria-controls":s?"split-button-menu":void 0,"aria-expanded":s?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),d((function(e){return!e}))},color:"primary",variant:"contained",ref:n,children:"Actions"}),Object(v.jsx)(ft.a,{open:s,anchorEl:n.current,role:void 0,transition:!0,style:{zIndex:4e3},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(v.jsx)(mt.a,Object(o.a)(Object(o.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(v.jsx)(G.a,{style:{backgroundColor:"dark"===i.palette.type?i.palette.primary.dark:i.palette.primary.light,color:"white"},children:Object(v.jsx)(ht.a,{onClickAway:z,children:Object(v.jsxs)(xt.a,{id:"split-button-menu",children:[H.map((function(e,t){return Object(v.jsxs)(Ot.a,{onClick:function(e){return W("A",e,t)},children:[e.icon,e.name]},e.name)})),Object(v.jsx)(qa.a,{}),M.map((function(e,t){return Object(v.jsxs)(Ot.a,{onClick:function(e){return W("B",e,t)},children:[e.icon,e.name]},e.name)}))]})})})}))}}),p&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){h(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit File Browser Comment",onSubmit:function(e){B({variables:{filebrowserobj_id:t.id,comment:e}})},value:t.comment,onClose:function(){h(!1)}})}),x&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:x,onClose:function(){g(!1)},innerDialog:Object(v.jsx)(fe,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:D,onClose:function(){g(!1)}})}),k&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:k,onClose:function(){w(!1)},innerDialog:Object(v.jsx)(Gd,{title:"Download History",value:P,onClose:function(){w(!1)}})})]})},xu=a(278),gu=a.n(xu),yu=Object(Pe.a)(Yd||(Yd=Object(B.a)(["\nfragment fileObjData on filebrowserobj {\n    access_time\n    comment\n    deleted\n    filemeta {\n        id\n    }\n    host\n    id\n    is_file\n    modify_time\n    parent_id\n    size\n    success\n    task {\n        callback {\n            id\n        }\n        operator {\n            id\n        }\n    }\n    full_path_text\n    name_text\n    timestamp\n    parent_path_text\n    filebrowserobjs_aggregate {\n        aggregate {\n            count\n        }   \n    }\n}\n"]))),_u=Object(Pe.a)(Zd||(Zd=Object(B.a)(["\n","\nquery myRootFolderQuery($operation_id: Int!) {\n    filebrowserobj(where: {operation_id: {_eq: $operation_id}, parent_id: {_is_null: true}}) {\n      ...fileObjData\n    }\n  }\n"])),yu),vu=Object(Pe.a)(Xd||(Xd=Object(B.a)(["\n","\nquery myFolderQuery($filebrowserobj_id: Int!, $operation_id: Int!) {\n    filebrowserobj(where: {parent_id: {_eq: $filebrowserobj_id}, operation_id: {_eq: $operation_id}}, order_by: {is_file: asc, name: asc}) {\n      ...fileObjData\n    }\n  }\n"])),yu),ku=Object(Pe.a)(eu||(eu=Object(B.a)(["\n","\nsubscription liveData($now: timestamp!, $operation_id: Int!){\n    filebrowserobj(distinct_on: id, order_by: {id: desc}, where: {timestamp: {_gt: $now}, operation_id: {_eq: $operation_id}}, limit: 1){\n        ...fileObjData\n    }\n}\n"])),yu),wu=Object(Pe.a)(tu||(tu=Object(B.a)(["\n","\nquery myDeltaFilesQuery($lastTime: timestamp!, $now: timestamp!, $operation_id: Int!){\n    filebrowserobj(distinct_on: id, order_by: {id: desc}, where: {_and: [{timestamp: {_gte: $lastTime}}, {timestamp: {_lte: $now}}], operation_id: {_eq: $operation_id}}){\n        ...fileObjData\n    }\n}\n"])),yu),Cu=Object(Pe.a)(au||(au=Object(B.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $payloadtype: String!, $ui_feature: String!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_iregex: $ui_feature}}}) {\n    id\n    command {\n      cmd\n      help_cmd\n      description\n      id\n      needs_admin\n      payload_type_id\n      attributes\n      commandparameters {\n        id\n        type \n      }\n      supported_ui_features\n    }\n  }\n  command(where: {payloadtype: {ptype: {_eq: $payloadtype}}, script_only: {_eq: true}, deleted: {_eq: false}, supported_ui_features: {_iregex: $ui_feature }}){\n      id\n      cmd\n      help_cmd\n      description\n      needs_admin\n      attributes\n      payload_type_id\n      commandparameters {\n          id\n          type\n      }\n      supported_ui_features\n    }\n}\n"]))),Su=Object(Pe.a)(nu||(nu=Object(B.a)(["\nquery getCallbackDataQuery($callback_id: Int!){\n    callback_by_pk(id: $callback_id){\n        payload {\n            os\n            payloadtype {\n              ptype\n              id\n            }\n            tag\n            id\n        }\n        id\n        operation_id\n        host\n        active\n    }\n}\n"])));function Du(e){var t=l.a.useState("File Browser: "+e.tabInfo.callbackID),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),d=r[0],u=r[1];Object(s.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("File Browser: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Zr,Object(o.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),u(!0)}},e)),d&&Object(v.jsx)(he,{fullWidth:!0,open:d,onClose:function(){u(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Tab's Description",onClose:function(){u(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var Iu,$u,Tu,Pu,Au,Eu,Fu,Lu,qu,Nu=function(e){var t=e.index,a=e.value,n=e.tabInfo,i=Object(A.a)(I),c=l.a.useRef([]),r=l.a.useState([]),d=Object(j.a)(r,2),u=d[0],b=d[1],p=l.a.useState([]),h=Object(j.a)(p,2),m=h[0],f=h[1],O=l.a.useRef({}),x=l.a.useState({task:{callback:{id:n.callbackID}},host:n.host,full_path_text:"."}),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState({}),w=Object(j.a)(k,2),C=w[0],S=w[1],D=l.a.useState(!1),$=Object(j.a)(D,2),T=$[0],P=$[1],E=l.a.useState(!1),F=Object(j.a)(E,2),L=F[0],N=F[1],B=l.a.useState({}),W=Object(j.a)(B,2),z=W[0],H=W[1],M=l.a.useState({}),U=Object(j.a)(M,2),V=U[0],G=U[1],K=l.a.useState({}),Q=Object(j.a)(K,2),J=Q[0],Y=Q[1],Z=l.a.useState(""),X=Object(j.a)(Z,2),ee=X[0],te=X[1],ae=l.a.useRef(),ne=l.a.useState(!1),ie=Object(j.a)(ne,2),ce=ie[0],re=ie[1],oe=l.a.useRef((new Date).toISOString()),se=l.a.useState({}),le=Object(j.a)(se,2),de=le[0],ue=le[1],be=l.a.useState(!1),je=Object(j.a)(be,2),pe=je[0],me=je[1],fe=Object(Ae.a)(_u,{variables:{operation_id:i.user.current_operation_id},onCompleted:function(e){var t=e.filebrowserobj.reduce((function(e,t){for(var a=0;a<e.length;a++)if(e[a].host===t.host)return e[a].filebrowserobjs.push(Object(o.a)(Object(o.a)({},t),{},{parent_id:t.host,filebrowserobjs:[]})),Object(R.a)(e);return[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{id:t.host,filebrowserobjs:[Object(o.a)(Object(o.a)({},t),{},{parent_id:t.host,filebrowserobjs:[]})]})])}),[]);b(t)},fetchPolicy:"network-only"}).subscribeToMore,Oe=Object(St.a)(wu,{onCompleted:function(e){var t=Object(R.a)(c.current);e.filebrowserobj.forEach((function(e){var a=!1;if(null===e.parent_id){var n=!1;t.forEach((function(t){t.host===e.host&&(n=!0,t.filebrowserobjs.forEach((function(t){t.name_text===e.name_text&&(a=!0,t.comment=e.comment,t.success=e.success,t.deleted=e.deleted,t.filemeta=e.filemeta)})))})),n?n&&!a&&(a=!0,t.forEach((function(t){t.host===e.host&&t.filebrowserobjs.push(Object(o.a)(Object(o.a)({},e),{},{parent_id:e.host,filebrowserobjs:[]}))}))):a=!1}else t.forEach((function(t){t.host===e.host&&(a=!0,ke(t,e.parent_id,[e]))}));a||null!==e.parent_id||t.push(Object(o.a)(Object(o.a)({},e),{},{id:e.host,filebrowserobjs:[Object(o.a)(Object(o.a)({},e),{},{parent_id:e.host,filebrowserobjs:[]})]}))})),b(t),e.filebrowserobj.length>0&&void 0!==O.current.id&&(e.filebrowserobj[0].parent_id===O.current.id||O.current.host===e.filebrowserobj[0].host)&&f(Object.values(O.current.filebrowserobjs))},onError:function(e){console.log(e)}}),xe=Object(j.a)(Oe,1)[0];Object(s.useEffect)((function(){c.current=u}),[u]),Object(s.useEffect)((function(){O.current=y}),[y]);var ge=Object(St.a)(vu,{onError:function(e){console.error(e)},fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:function(e){var t=!1;if(0===e.filebrowserobj.length)return q.dismiss(),null===y.success?q.info("Folder hasn't been listed yet"):q.info("Empty folder"),void f(Object.values(y.filebrowserobjs));q.dismiss(),q.success("Fetched data");var a=u.map((function(a){if(e.filebrowserobj[0].host===a.host){var n=Object(o.a)({},a);return t=!0,ke(n,e.filebrowserobj[0].parent_id,e.filebrowserobj),n}return Object(o.a)({},a)}));t||(a.push(e.filebrowserobj[0]),ke(e.filebrowserobj[0],e.filebrowserobj[0].parent_id,e.filebrowserobj)),b(a),f(Object.values(y.filebrowserobjs))}}),ye=Object(j.a)(ge,1)[0],_e=Object(St.a)(Su,{fetchPolicy:"no-cache",onCompleted:function(e){null!==e.callback_by_pk?e.callback_by_pk.active?G(Object(o.a)(Object(o.a)({},e.callback_by_pk),{},{ui_feature:".*"+ee+".*"},de)):q.warning("That callback isn't active"):q.warning("Failed to find that Callback"),ue({})},onError:function(e){q.error("Failed to fetch callback data for the specified callback")}}),ve=Object(j.a)(_e,1)[0],ke=Object(s.useCallback)((function(e,t,a){if(t===e.id){for(var n=0;n<a.length;n++)void 0===e.filebrowserobjs[a[n].id]?e.filebrowserobjs[a[n].id]=Object(o.a)(Object(o.a)({},a[n]),{},{filebrowserobjs:{}}):e.filebrowserobjs[a[n].id]=Object(o.a)(Object(o.a)({},a[n]),{},{filebrowserobjs:e.filebrowserobjs[a[n].id].filebrowserobjs});return!0}for(var i=0,c=Object.entries(e.filebrowserobjs);i<c.length;i++){var r=Object(j.a)(c[i],2),s=(r[0],r[1]);if(a[0].parent_path_text.startsWith(s.full_path_text))if(ke(s,t,a))return!0}return!1}),[]),we=Object(Ee.a)(od,{update:function(e,t){var a=t.data;"error"===a.createTask.status?q.error(a.createTask.error):q.success('Issued "'+z.cmd+'" to Callback '+V.id),H({}),G({}),Y({}),te("")},onError:function(e){console.error(e),H({}),G({}),Y({}),te("")}}),Ce=Object(j.a)(we,1)[0],Se=Object(St.a)(Cu,{onCompleted:function(e){var t=e.loadedcommands.reduce((function(e,t){return[].concat(Object(R.a)(e),[t.command])}),[]),a=e.command.reduce((function(e,t){return[].concat(Object(R.a)(e),[t])}),Object(R.a)(t));S(a),0===a.length?q.warning("No commands currently loaded that support that feature"):1===a.length?H(Object(o.a)({},a[0])):(H({}),P(!0))},fetchPolicy:"network-only"}),De=Object(j.a)(Se,1)[0];Object(s.useEffect)((function(){if(void 0!==z.cmd)switch(ee){case"file_browser:list":void 0===J.path?Ce({variables:{callback_id:V.id,command:z.cmd,params:JSON.stringify({host:V.host,path:V.fullPath,file:""})}}):Ce({variables:{callback_id:ae.current,command:z.cmd,params:JSON.stringify({host:J.host,path:J.path,file:J.filename})}});break;case"file_browser:upload":N(!0);break;case"file_browser:download":case"file_browser:remove":Ce({variables:{callback_id:ae.current,command:z.cmd,params:JSON.stringify({host:J.host,path:J.path,file:J.filename})}})}}),[z,Ce,V,y.full_path_text,J.filename,J.host,J.path,ee]),Object(s.useEffect)((function(){void 0!==V.id&&De({variables:{callback_id:V.id,payloadtype:V.payload.payloadtype.ptype,ui_feature:V.ui_feature}})}),[V]);var Ie=Object(s.useCallback)((function(e){f(Object.values(e.filebrowserobjs)),_(e)}),[]),$e=Object(s.useCallback)((function(e){ye({variables:{filebrowserobj_id:e.id,operation_id:i.user.current_operation_id}}),_(e)}),[]),Te=Object(s.useCallback)((function(e){var t=e.path,a=e.host,n=e.filename,i=e.uifeature,c=e.confirmed;"file_browser:remove"!==i||c?(ue({}),ve({variables:{callback_id:ae.current}}),S([]),te(i),Y({path:t,host:a,filename:n})):(ue({path:t,host:a,filename:n,uifeature:i}),re(!0))}),[]),Pe=Object(s.useCallback)((function(e,t){var a=t.subscriptionData;if(a.data.filebrowserobj.length>0)return xe({variables:{operation_id:i.user.current_operation_id,now:(new Date).toISOString(),lastTime:oe.current}}),void(oe.current=a.data.filebrowserobj[0].timestamp)}),[ke]);return Object(v.jsxs)(Jr,{index:t,value:a,children:[Object(v.jsx)("div",{style:{maxHeight:"99%",overflow:"auto",height:"99%",width:"calc(31vw)",display:"inline-block"},children:Object(v.jsx)(Md,{showDeletedFiles:pe,treeRoot:u,fetchFolderData:$e,setTableData:Ie})}),Object(v.jsxs)("div",{style:{maxHeight:"99%",overflow:"auto",height:"99%",width:"calc(65vw)",display:"inline-block"},children:[Object(v.jsx)(Ru,{selectedFolderData:y,onListFilesButton:function(e){var t=e.callbackID,a=e.fullPath;ve({variables:{callback_id:t}}),ue({fullPath:a}),S([]),te("file_browser:list")},onUploadFileButton:function(e){var t=e.callbackID;ve({variables:{callback_id:t}}),S([]),te("file_browser:upload")},onChangeCallbackID:function(e){ae.current=e},toggleShowDeletedFiles:function(e){me(e)},initialCallbackID:n.callbackID,subscribeToNewFileBrowserObjs:function(){return fe({document:ku,variables:{now:(new Date).toISOString(),operation_id:i.user.current_operation_id},updateQuery:Pe})}}),Object(v.jsx)(pu,{showDeletedFiles:pe,onRowDoubleClick:$e,selectedFolder:m,onTaskRowAction:Te})]}),T&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:T,onClose:function(){P(!1)},innerDialog:Object(v.jsx)(vo,{onClose:function(){P(!1)},onSubmit:function(e){H(e)},options:C,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),L&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:L,onClose:function(){N(!1)},innerDialog:Object(v.jsx)(Xo,{command:z,callback_id:V.id,payloadtype_id:V.payload.payloadtype.id,operation_id:V.operation_id,onSubmit:function(e,t,a){N(!1),Ce({variables:{callback_id:V.id,command:e,params:t,files:a}})},onClose:function(){N(!1)}})}),ce&&Object(v.jsx)(Ia,{onSubmit:function(){Te(Object(o.a)(Object(o.a)({},de),{},{confirmed:!0}))},onClose:function(){re(!1)},open:ce})]})},Ru=function(e){var t=e.selectedFolderData,a=e.onListFilesButton,n=e.initialCallbackID,i=e.onUploadFileButton,c=e.onChangeCallbackID,r=e.subscribeToNewFileBrowserObjs,o=e.toggleShowDeletedFiles,d=Object(ve.a)(),u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState(""),f=Object(j.a)(m,2),O=f[0],x=f[1],g=l.a.useState(n),y=Object(j.a)(g,2),_=y[0],k=y[1],C=l.a.useState(!1),S=Object(j.a)(C,2),D=S[0],I=S[1],$=l.a.useState(!0),T=Object(j.a)($,2),P=T[0],A=T[1];Object(s.useEffect)((function(){void 0!==t.host&&h(t.host),void 0!==t.full_path_text&&x(t.full_path_text),P||void 0!==t.task&&k(t.task.callback.id)}),[t,P]);var E=function(){""!==O?_>0?a({callbackID:_,fullPath:O}):q.warning("Must select a folder or set a callback number first"):q.warning("Must provide a path to list")};Object(s.useEffect)((function(){c(_)}),[_]),Object(s.useEffect)((function(){r()}),[]);return Object(v.jsxs)($t.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(v.jsx)($t.a,{item:!0,xs:4,children:Object(v.jsx)(w,{placeholder:"Host Name",value:p,onChange:function(e,t,a){h(t)},name:"Host Name"})}),Object(v.jsx)($t.a,{item:!0,xs:7,children:Object(v.jsx)(w,{placeholder:"Path",value:O,onEnter:E,onChange:function(e,t,a){x(t)},name:"Path",InputProps:{endAdornment:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Kc.a,{title:"Task callback to list contents",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:E,children:Object(v.jsx)(Dd.a,{style:{color:d.palette.info.main}})})}),Object(v.jsx)(Kc.a,{title:"Upload file to folder via callback",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){_>0?i({callbackID:_}):q.warning("Must select a folder or set a callback number first")},children:Object(v.jsx)(Cd.a,{style:{color:d.palette.info.main}})})}),Object(v.jsx)(Kc.a,{title:D?"Hide Deleted Files":"Show Deleted Files",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){I(!D),o(!D)},children:D?Object(v.jsx)(ou.a,{style:{color:d.palette.info.main}}):Object(v.jsx)(gu.a,{style:{color:d.palette.info.main}})})})]}),style:{padding:0}}})}),Object(v.jsx)($t.a,{item:!0,xs:1,children:Object(v.jsx)(w,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t,a){A(!0),k(parseInt(t))},value:_,InputProps:{endAdornment:P?Object(v.jsx)(Kc.a,{title:"Change Callback Based on Data Origin",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){A(!1),t.task?k(t.task.callback.id):(k(0),c(0))},children:Object(v.jsx)($r.a,{style:{color:d.palette.info.main}})})}):Object(v.jsx)(Kc.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},children:Object(v.jsx)($d.a,{disabled:!0,style:{color:d.palette.warning.main}})})}),style:{padding:0,margin:0}}})})]})},Bu=Object(h.a)((function(e){return{root:{width:"99%",marginTop:"3px",marginBottom:"2px",marginLeft:"3px",marginRight:"0px",height:"auto"},heading:{fontSize:e.typography.pxToRem(15),whiteSpace:"pre-line"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"calc(90vw)",whiteSpace:"break-word"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),Wu=function(e,t,a){return{data:Object(o.a)({id:e.id.toString(),isLeaf:void 0===e.children||0===e.children.length,isOpenByDefault:!0,name:e.name,nestingLevel:t,theme:a},e),nestingLevel:t,node:e}},zu=function(e){var t=e.treeRoot,a=e.theme,n=Object(s.useCallback)(i.a.mark((function e(){var n,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=7;break}return e.next=4,Wu(t[n],0,a);case 4:n++,e.next=1;break;case 7:return void(e.next=10);case 10:c=e.sent,r=0;case 12:if(!(r<c.node.children.length)){e.next=18;break}return e.next=15,Wu(c.node.children[r],c.nestingLevel+1,a);case 15:r++,e.next=12;break;case 18:e.next=7;break;case 20:case"end":return e.stop()}}),e)})),[t,a]);return 0===t.length?Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Process Listing Data"}):Object(v.jsx)(bi.a,{children:function(e){var t=e.height,a=e.width;return Object(v.jsx)(Wd.a,{treeWalker:n,height:t-10,width:a-10,itemSize:30,async:!0,placeholder:Object(v.jsx)("div",{children:"Loading...."}),children:Hu})}})},Hu=function(e){var t=e.data,a=e.isOpen,n=e.style,i=e.setOpen;return Object(v.jsxs)("div",{style:Object(o.a)(Object(o.a)({},n),{},{width:"calc(100vw)",display:"inline-flex",overflow:"auto"}),children:[Object(R.a)(Array(t.nestingLevel)).map((function(e,a){return Object(v.jsx)("div",{style:{borderLeft:"1px dashed ".concat(Object(eo.c)(t.theme.palette.text.primary,.4)),marginLeft:15,paddingRight:15,height:"100%",display:"inline-block"}},"folder"+t.id+"lines"+a)})),Object(v.jsx)(Mu,{filebrowserobj:t,isOpen:a,setOpen:i})]})},Mu=function(e){var t=Bu(),a=Object(ve.a)();return Object(v.jsx)(G.a,{className:t.root,elevation:5,style:{backgroundColor:a.body,color:a.text,alignItems:"center",display:"flex"},children:Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:[e.filebrowserobj.process_id," - ",e.filebrowserobj.name]})})},Uu=Object(Pe.a)(Iu||(Iu=Object(B.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        command_line\n        description\n        signer\n        start_time\n        name\n        bin_path\n    }\n}\n"]))),Vu=Object(Pe.a)($u||($u=Object(B.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        tokens(where: {deleted: {_eq: false}}) {\n            Address\n            AppContainer\n            AppContainerNumber\n            AppContainerSid\n            AppId\n            AppModelPolicies\n            AppModelPolicyDictionary\n            AttributesFlags\n            AuditPolicy\n            AuthenticationId_id\n            BnoIsolationPrefix\n            CanSynchronize\n            Capabilities\n            CreationTime\n            DefaultDacl\n            DenyOnlyGroups\n            DeviceClaimAttributes\n            DeviceGroups\n            Elevated\n            ElevationType\n            EnabledGroups\n            ExpirationTime\n            Filtered\n            Flags\n            FullPath\n            GrantedAccess\n            GrantedAccessGeneric\n            GrantedAccessMask\n            GroupCount\n            Groups\n            Handle\n            HandleReferenceCount\n            HasRestrictions\n            ImpersonationLevel\n            Inherit\n            IntegrityLevel\n            IntegrityLevelSid\n            IsClosed\n            IsContainer\n            IsPseudoToken\n            IsRestricted\n            IsSandbox\n            LogonSid\n            LowPrivilegeAppContainer\n            MandatoryPolicy\n            ModifiedId\n            Name\n            NoChildProcess\n            NotLow\n            NtType\n            NtTypeName\n            Owner\n            Origin\n            PackageFullName\n            PackageIdentity\n            PackageName\n            PointerReferenceCount\n            PrimaryGroup\n            PrivateNamespace\n            Privileges\n            ProcessUniqueAttribute\n            ProtectFromClose\n            Restricted\n            RestrictedDeviceClaimAttributes\n            RestrictedDeviceGroups\n            RestrictedSids\n            RestrictedSidsCount\n            RestrictedUserClaimAttributes\n            SandboxInert\n            Sddl\n            SecurityAttributes\n            SecurityDescriptor\n            SessionId\n            Source\n            ThreadID\n            TokenId\n            TokenType\n            TrustLevel\n            UIAccess\n            User\n            UserClaimAttributes\n            VirtualizationAllowed\n            VirtualizationEnabled\n            WriteRestricted\n            callbacktokens {\n                callback_id\n            }\n            logonsession {\n                id\n            }\n            task_id\n            timestamp_created\n        }\n    }\n}\n"]))),Gu=function(){return Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Data Selected"})},Ku=function(e){var t=e.columnData,a=e.dataKey,n=e.rowData;return function(){switch(t.format){case"string":return Object(v.jsx)(Ju,{cellData:n[a],rowData:n});case"button":return Object(v.jsx)(Yu,{rowData:n,onTaskRowAction:t.onTaskRowAction,os:t.os});default:return Object(v.jsx)(Ju,{cellData:n[a],rowData:n})}}()},Qu=function(e){var t=l.a.useRef(null),a=l.a.useState("ASC"),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("name"),d=Object(j.a)(r,2),u=d[0],p=d[1],h=l.a.useState({actions:.065,parent_process_id:.0714,process_id:.0714,architecture:.06,name:.14,user:.14,bin_path:.4}),m=Object(j.a)(h,2),f=m[0],O=m[1],x=l.a.useState([]),g=Object(j.a)(x,2),y=g[0],_=g[1],k=function(e){var t=e.sortBy,a=e.sortDirection,n=Object(R.a)($),i=y.filter((function(e){return e.dataKey===t}))[0].columnData.format;"number"===i||"size"===i?n.sort((function(e,a){return parseInt(e[t])>parseInt(a[t])?1:-1})):"date"===i?n.sort((function(e,a){return new Date(e[t])>new Date(a[t])?1:-1})):n.sort((function(e,a){return e[t]>a[t]?1:-1})),"DESC"===a&&n.reverse(),T(Object(R.a)(n)),p(t),c(a)},w=function(e){var t=e.index;return $[t]},C=l.a.useCallback((function(e){var a,n=e.event,i=e.dataKey,c=e.deltaX;n.preventDefault(),n.stopPropagation();for(var r=Object(o.a)({},f),s=c/t.current.offsetWidth,l="",d=!1,u=0,p=Object.entries(f);u<p.length;u++){var h=Object(j.a)(p[u],2),m=h[0];h[1];if(d){l=m;break}m===i&&(d=!0)}if(""!==l){var x=Object(o.a)(Object(o.a)({},r),{},(a={},Object(b.a)(a,i,r[i]+s),Object(b.a)(a,l,r[l]-s),a));O(x)}else console.log("next header not found")}),[f]),S=l.a.useCallback((function(e){var t=e.columnData,a=e.dataKey,n=(e.disableSort,e.label),i=e.sortBy,c=e.sortDirection;return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)("span",{style:{display:"inline-flex",flexDirection:"row",alignContent:"stretch",justifyContent:"flex-start"},children:[n,i===a?"ASC"===c?Object(v.jsx)(go.a,{}):Object(v.jsx)(_o.a,{}):null]}),"button"!==t.format&&"Path"!==n&&Object(v.jsx)(Oo.a,{axis:"x",defaultClassName:"DragHandle",defaultClassNameDragging:"DragHandleActive",onDrag:function(e,t){var n=t.deltaX;return C({event:e,dataKey:a,deltaX:n})},position:{x:0},zIndex:999,children:Object(v.jsx)("span",{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"DragHandleIcon",style:{width:"20px",textAlign:"center"},children:"\u22ee"})})]},"header"+a)}),[C,y]),D=l.a.useState([]),I=Object(j.a)(D,2),$=I[0],T=I[1];return Object(s.useEffect)((function(){_([{columnData:{format:"button",onTaskRowAction:e.onTaskRowAction,os:e.os},dataKey:"actions",label:"Actions",cellRenderer:Ku,width:f.actions*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"number"},dataKey:"parent_process_id",label:"PPID",cellRenderer:Ku,width:f.parent_process_id*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"number"},dataKey:"process_id",label:"PID",cellRenderer:Ku,width:f.process_id*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"architecture",label:"Arch",cellRenderer:Ku,width:f.architecture*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"name",label:"Name",cellRenderer:Ku,width:f.name*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"user",label:"User",cellRenderer:Ku,width:f.user*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"bin_path",label:"Path",cellRenderer:Ku,width:f.bin_path*t.current.offsetWidth,headerRenderer:S}])}),[f,e.onTaskRowAction,e.os]),Object(s.useEffect)((function(){T(e.selectedFolder)}),[e.selectedFolder]),Object(v.jsx)("div",{ref:t,style:{width:"100%",height:"90%",overflow:"hidden"},children:Object(v.jsx)(mo.a,{children:function(e){var t=e.height,a=e.width;return Object(v.jsx)(mo.c,{headerHeight:25,noRowsRenderer:Gu,rowCount:$.length,rowGetter:w,rowHeight:35,height:t,width:a,sort:k,sortBy:u,sortDirection:i,children:y.map((function(e){return Object(v.jsx)(mo.b,Object(o.a)({},e),"col"+e.dataKey)}))})}})})},Ju=function(e){return e.cellData},Yu=function(e){var t=e.rowData,a=e.onTaskRowAction,n=e.os,i=l.a.useRef(null),c=Object(ve.a)(),r=l.a.useState(!1),s=Object(j.a)(r,2),d=s[0],u=s[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],f=p[1],O=l.a.useState(!1),x=Object(j.a)(O,2),g=(x[0],x[1],l.a.useState({})),y=Object(j.a)(g,2),_=y[0],k=y[1],w=l.a.useState({}),C=Object(j.a)(w,2),S=(C[0],C[1]),D=Object(St.a)(Uu,{onCompleted:function(e){k(e.process_by_pk),f(!0)},fetchPolicy:"network-only"}),I=Object(j.a)(D,1)[0],$=Object(St.a)(Vu,{onCompleted:function(e){0===e.process_by_pk.tokens.length?q.warning("No Token Data for Process"):(S(e.process_by_pk.tokens),f(!0))},fetchPolicy:"network-only"}),T=Object(j.a)($,1)[0],P=function(e,t,a){switch(e){case"A":E[a].click(t);break;case"B":F[a].click(t)}u(!1)},A=function(e){i.current&&i.current.contains(e.target)||u(!1)},E=[{name:"View Detailed Data",icon:Object(v.jsx)(ou.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),I({variables:{process_id:t.id}})}},{name:"View Tokens",icon:Object(v.jsx)(ou.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),T({variables:{process_id:t.id}})},os:["Windows"]}],F=[{name:"Task Token Listing",icon:Object(v.jsx)(lu.a,{style:{paddingRight:"5px",color:c.palette.warning.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:list_tokens"})},os:["Windows"]},{name:"Task Inject",icon:Object(v.jsx)(er.a,{style:{paddingRight:"5px",color:c.palette.success.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:inject"})}},{name:"Task Steal Token",icon:Object(v.jsx)(ie.a,{style:{paddingRight:"5px",color:c.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:steal_token"})},os:["Windows"]},{name:"Task Kill Process",icon:Object(v.jsx)(ie.a,{style:{paddingRight:"5px",color:c.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:kill"})}}];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(m.a,{style:{padding:0},size:"small","aria-controls":d?"split-button-menu":void 0,"aria-expanded":d?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),u((function(e){return!e}))},color:"primary",variant:"contained",ref:i,children:"Actions"}),Object(v.jsx)(ft.a,{open:d,anchorEl:i.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(v.jsx)(mt.a,Object(o.a)(Object(o.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(v.jsx)(G.a,{style:{backgroundColor:"dark"===c.palette.type?c.palette.primary.dark:c.palette.primary.light,color:"white"},children:Object(v.jsx)(ht.a,{onClickAway:A,children:Object(v.jsxs)(xt.a,{id:"split-button-menu",children:[E.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(v.jsxs)(Ot.a,{onClick:function(e){return P("A",e,t)},children:[e.icon,e.name]},e.name):null})),Object(v.jsx)(qa.a,{}),F.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(v.jsxs)(Ot.a,{onClick:function(e){return P("B",e,t)},children:[e.icon,e.name]},e.name):null}))]})})})}))}}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:h,onClose:function(){f(!1)},innerDialog:Object(v.jsx)(Oe,{title:"View Detailed Data",leftColumn:"Attribute",rightColumn:"Value",value:_,onClose:function(){f(!1)},keys:["name","bin_path","signer","command_line","start_time","description"]})})]})},Zu=a(457),Xu=a.n(Zu),eb=a(456),tb=a.n(eb),ab=a(458),nb=a.n(ab),ib=Object(Pe.a)(Tu||(Tu=Object(B.a)(["\nfragment objData on process {\n    name\n    process_id\n    parent_process_id\n    architecture\n    bin_path\n    integrity_level\n    id\n    user\n}\n"]))),cb=Object(Pe.a)(Pu||(Pu=Object(B.a)(["\nfragment taskData on task {\n    id\n    callback {\n        id\n        host\n        payload {\n            id\n            os\n            payloadtype{\n                ptype\n            }\n        }\n    }\n}\n"]))),rb=Object(Pe.a)(Au||(Au=Object(B.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_gt: $task_id}}, order_by: {task_id: asc}, limit: 1) {\n        task {\n            ...taskData\n            processes(order_by: {process_id: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),ib,cb),ob=Object(Pe.a)(Eu||(Eu=Object(B.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_lt: $task_id}}, order_by: {task_id: desc}, limit: 1) {\n        task {\n            ...taskData\n            processes(order_by: {name: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),ib,cb),sb=Object(Pe.a)(Fu||(Fu=Object(B.a)(["\nquery getHostsQuery($operation_id: Int!, $host:String!){\n    process_aggregate(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}}, distinct_on: task_id){\n        aggregate {\n            max {\n              task_id\n            }\n        }\n    }\n}\n"]))),lb=Object(Pe.a)(Lu||(Lu=Object(B.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $payloadtype: String!, $ui_feature: String!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_iregex: $ui_feature}}}) {\n    id\n    command {\n      cmd\n      help_cmd\n      description\n      id\n      needs_admin\n      payload_type_id\n      attributes\n      commandparameters {\n        id\n        type \n      }\n      supported_ui_features\n    }\n  }\n  command(where: {payloadtype: {ptype: {_eq: $payloadtype}}, script_only: {_eq: true}, deleted: {_eq: false}, supported_ui_features: {_iregex: $ui_feature }}){\n      id\n      cmd\n      help_cmd\n      description\n      needs_admin\n      attributes\n      payload_type_id\n      commandparameters {\n          id\n          type\n      }\n      supported_ui_features\n    }\n}\n"]))),db=Object(Pe.a)(qu||(qu=Object(B.a)(["\nquery getCallbackDataQuery($callback_id: Int!){\n    callback_by_pk(id: $callback_id){\n        payload {\n            os\n            payloadtype {\n              ptype\n              id\n            }\n            tag\n            id\n        }\n        id\n        operation_id\n        host\n        active\n    }\n}\n"])));function ub(e){var t=l.a.useState("Processes: "+e.tabInfo.host),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),d=r[0],u=r[1];Object(s.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("Processes: "+e.tabInfo.host)}),[e.tabInfo.customDescription]);return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Zr,Object(o.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),u(!0)}},e)),d&&Object(v.jsx)(he,{fullWidth:!0,open:d,onClose:function(){u(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Tab's Description",onClose:function(){u(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var bb,jb=function(e){var t=Object(ve.a)(),a=Object(A.a)(I),n=l.a.useRef([]),i=l.a.useState([]),c=Object(j.a)(i,2),r=c[0],d=c[1],u=l.a.useState([]),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState({}),f=Object(j.a)(m,2),O=f[0],x=f[1],g=l.a.useState(!1),y=Object(j.a)(g,2),_=y[0],k=y[1],w=l.a.useState(!1),C=Object(j.a)(w,2),S=C[0],D=C[1],$=l.a.useState({}),T=Object(j.a)($,2),P=T[0],E=T[1],F=l.a.useState({}),L=Object(j.a)(F,2),N=L[0],B=L[1],W=l.a.useState({}),z=Object(j.a)(W,2),H=z[0],M=z[1],U=l.a.useState(""),V=Object(j.a)(U,2),G=V[0],K=V[1],Q=l.a.useRef(),J=l.a.useState(""),Y=Object(j.a)(J,2),Z=Y[0],X=Y[1],ee=Object(St.a)(db,{fetchPolicy:"no-cache",onCompleted:function(e){null!==e.callback_by_pk?e.callback_by_pk.active?B(Object(o.a)(Object(o.a)({},e.callback_by_pk),{},{ui_feature:".*"+G+".*"})):q.warning("That callback isn't active"):q.warning("Failed to find that Callback")},onError:function(e){q.error("Failed to fetch callback data for the specified callback")}}),te=Object(j.a)(ee,1)[0],ae=function e(t,a){if(t.process_id===a.parent_process_id)return t.children.push(Object(o.a)(Object(o.a)({},a),{},{children:[]})),!0;for(var n=0;n<t.children.length;n++)if(e(t.children[n],a))return!0;return!1},ne=Object(St.a)(rb,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{children:[]})]);var a=Object(R.a)(e).map((function(e){return ae(e,t),Object(o.a)({},e)}));return Object(R.a)(a)}),[]);d(t),h(e.process[0].task.processes),X(e.process[0].task.callback.payload.os),M(e.process[0].task),q.dismiss(),q.success("Successfully fetched process data")}else q.dismiss(),q.warning("No Newer Process Sets")}}),ie=Object(j.a)(ne,1)[0],ce=Object(St.a)(ob,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{children:[]})]);var a=Object(R.a)(e).map((function(e){return ae(e,t),Object(o.a)({},e)}));return Object(R.a)(a)}),[]);d(t),h(e.process[0].task.processes),X(e.process[0].task.callback.payload.os),M(e.process[0].task),q.dismiss(),q.success("Successfully fetched process data")}else q.dismiss(),q.warning("No Earlier Process Sets")}}),re=Object(j.a)(ce,1)[0];Object(Ae.a)(sb,{variables:{operation_id:a.user.current_operation_id,host:e.tabInfo.host},onCompleted:function(t){null===t.process_aggregate.aggregate.max.task_id?(q.warning("No Process Data for "+e.tabInfo.host),M({callback:{host:e.tabInfo.host,id:e.tabInfo.callbackID},id:0})):(q.info("Fetching latest process data for "+e.tabInfo.host),ie({variables:{operation_id:a.user.current_operation_id,host:e.tabInfo.host,task_id:t.process_aggregate.aggregate.max.task_id-1}}))},fetchPolicy:"network-only"}),Object(s.useEffect)((function(){n.current=r}),[r]);var oe=Object(Ee.a)(od,{update:function(e,t){var a=t.data;"error"===a.createTask.status?q.error(a.createTask.error):q.success('Issued "'+P.cmd+'" to Callback '+N.id),E({}),B({}),K("")},onError:function(e){console.error(e),E({}),B({}),K("")}}),se=Object(j.a)(oe,1)[0],le=Object(St.a)(lb,{onCompleted:function(e){var t=e.loadedcommands.reduce((function(e,t){return[].concat(Object(R.a)(e),[t.command])}),[]),a=e.command.reduce((function(e,t){return[].concat(Object(R.a)(e),[t])}),Object(R.a)(t));x(a),0===a.length?q.warning("No commands currently loaded that support that feature"):1===a.length?E(Object(o.a)({},a[0])):(E({}),k(!0))},fetchPolicy:"network-only"}),de=Object(j.a)(le,1)[0];Object(s.useEffect)((function(){if(void 0!==P.cmd)if(0===P.commandparameters.length)se({variables:{callback_id:N.id,command:P.cmd,params:""}});else switch(G){case"process_browser:list":D(!0)}}),[P,se,N,G]),Object(s.useEffect)((function(){void 0!==N.id&&de({variables:{callback_id:N.id,payloadtype:N.payload.payloadtype.ptype,ui_feature:N.ui_feature}})}),[N,de]);return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)("div",{style:{maxHeight:"99%",overflow:"auto",height:"99%",width:"calc(31vw)",display:"inline-block"},children:Object(v.jsx)(zu,{treeRoot:r,theme:t})}),Object(v.jsxs)("div",{style:{maxHeight:"99%",overflow:"auto",height:"99%",width:"calc(65vw)",display:"inline-block"},children:[Object(v.jsx)(pb,{onListFilesButton:function(e){var t=e.callbackID;te({variables:{callback_id:t}}),x([]),K("process_browser:list")},onNextButton:function(t){var n=t.task_id;ie({variables:{operation_id:a.user.current_operation_id,host:e.tabInfo.host,task_id:n}})},onPreviousButton:function(t){var n=t.task_id;re({variables:{operation_id:a.user.current_operation_id,host:e.tabInfo.host,task_id:n}})},onDiffButton:function(e){e.task_id},initialCallbackID:e.tabInfo.callbackID,onChangeCallbackID:function(e){Q.current=e},taskInfo:H}),Object(v.jsx)(Qu,{selectedFolder:p,onTaskRowAction:function(e){e.path,e.host,e.filename;var t=e.uifeature;te({variables:{callback_id:Q.current}}),x([]),K(t)},os:Z})]}),_&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:_,onClose:function(){k(!1)},innerDialog:Object(v.jsx)(vo,{onClose:function(){k(!1)},onSubmit:function(e){E(e)},options:O,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),S&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:S,onClose:function(){D(!1)},innerDialog:Object(v.jsx)(Xo,{command:P,callback_id:N.id,payloadtype_id:N.payload.payloadtype.id,operation_id:N.operation_id,onSubmit:function(e,t,a){D(!1),se({variables:{callback_id:N.id,command:e,params:t,files:a}})},onClose:function(){D(!1)}})})]}))},pb=function(e){var t=e.onListFilesButton,a=e.onNextButton,n=e.onPreviousButton,i=e.initialCallbackID,c=(e.onDiffButton,e.onChangeCallbackID),r=e.taskInfo,o=Object(ve.a)(),d=l.a.useState(""),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useState(i),m=Object(j.a)(h,2),f=m[0],O=m[1],x=l.a.useState(!0),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState(0),C=Object(j.a)(k,2),S=C[0],D=C[1];Object(s.useEffect)((function(){void 0!==r.callback&&(p(r.callback.host),D(r.id)),y||(void 0!==r.callback?O(r.callback.id):O(0))}),[r,y]);return Object(s.useEffect)((function(){c(f)}),[f,c]),Object(v.jsxs)($t.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(v.jsx)($t.a,{item:!0,xs:10,children:Object(v.jsx)(w,{placeholder:"Host Name",value:b,disabled:!0,onChange:function(){},name:"Host Name",InputProps:{endAdornment:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Kc.a,{title:"Fetch Previous Saved Process Listing",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){q.info("Fetching previous process data..."),n({task_id:r.id})},children:Object(v.jsx)(tb.a,{style:{color:o.palette.info.main}})})}),Object(v.jsx)(Kc.a,{title:"Task Callback to List Processes",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){f>0?t({callbackID:f}):q.warning("Must set a callback number to task first")},children:Object(v.jsx)(Dd.a,{style:{color:o.palette.info.main}})})}),Object(v.jsx)(Kc.a,{title:"Fetch Next Saved Process Listing",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){q.info("Fetching next process data..."),a({task_id:r.id})},children:Object(v.jsx)(Xu.a,{style:{color:o.palette.info.main}})})}),Object(v.jsx)(Kc.a,{title:"Compare Previous Listing",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){f>0?a({callbackID:f}):q.warning("Must select a callback number first")},children:Object(v.jsx)(nb.a,{style:{color:o.palette.info.main}})})})]})}})}),Object(v.jsx)($t.a,{item:!0,xs:1,children:Object(v.jsx)(w,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t,a){_(!0),O(parseInt(t))},value:f,InputProps:{endAdornment:y?Object(v.jsx)(Kc.a,{title:"Change Callback Based on Data Origin",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},onClick:function(){_(!1),void 0!==r.callback?O(r.callback.id):O(0)},children:Object(v.jsx)($r.a,{style:{color:o.palette.info.main}})})}):Object(v.jsx)(Kc.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(v.jsx)(Y.a,{style:{padding:"3px"},children:Object(v.jsx)($d.a,{disabled:!0,style:{color:o.palette.warning.main}})})}),style:{padding:0,margin:0}}})}),Object(v.jsx)($t.a,{item:!0,xs:1,children:Object(v.jsx)(w,{type:"number",name:"Task Data",disabled:!0,value:S,onChange:function(){}})})]})},hb=Object(Pe.a)(bb||(bb=Object(B.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbacktoken(where: {deleted: {_eq: false}, callback: {operation_id: {_eq: $operation_id}, active: {_eq: true}}}) {\n    token {\n      TokenId\n      id\n      User\n      description\n    }\n    callback {\n      id\n    }\n    id\n  }\n}\n "]))),mb=Object(h.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function fb(e){var t=e.onCloseTab,a=e.openTabs,n=e.clickedTabId,i=e.clearSelectedTab,c=e.onEditTabDescription,r=mb(),o=Object(A.a)(I),d=l.a.useState([]),u=Object(j.a)(d,2),b=u[0],p=u[1];Object(nt.a)(hb,{variables:{operation_id:o.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;p(t.data.callbacktoken)}});var h=l.a.useState(0),m=Object(j.a)(h,2),f=m[0],O=m[1],x=function(e){var a=e.tabID,n=e.index;O(n>0?n-1:0),t({tabID:a,index:n})};return Object(s.useEffect)((function(){for(var e=0;e<a.length;e++)a[e].tabID===n&&O(e);i()}),[n,a,i]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(vd.a,{position:"static",color:"default",children:Object(v.jsx)(kd.a,{value:f,onChange:function(e,t){O(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",style:{maxWidth:"100%",width:"100%"},"aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e.tabType){case"interact":return Object(v.jsx)(ad,{onEditTabDescription:c,onCloseTab:x,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"fileBrowser":return Object(v.jsx)(Du,{onEditTabDescription:c,onCloseTab:x,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"processBrowser":return Object(v.jsx)(ub,{onEditTabDescription:c,onCloseTab:x,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);default:return null}}))})}),Object(v.jsx)("div",{className:r.root,style:{maxHeight:"100%",height:"100%",background:"transparent"},children:a.map((function(e,t){switch(e.tabType){case"interact":return Object(v.jsx)(dd,{style:{position:"relative",height:"100%",maxHeight:"100%"},onCloseTab:x,tabInfo:e,value:f,index:t,callbacktokens:b},"tabpanel"+e.tabID+e.tabType);case"fileBrowser":return Object(v.jsx)(Nu,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:x,tabInfo:e,value:f,index:t},"tabpanel"+e.tabID+e.tabType);case"processBrowser":return Object(v.jsx)(jb,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:x,tabInfo:e,value:f,index:t},"tabpanel"+e.tabID+e.tabType);default:return null}}))})]})}var Ob=a(900),xb=a(901),gb=a(882),yb=a(464),_b=a.n(yb),vb=a(463),kb=a.n(vb);function wb(e){var t=l.a.useState({top:"0%",bottom:"0%"}),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(s.useEffect)((function(){i(e.heights)}),[e.heights]);var c=function(e,t,a){var c=Object(o.a)({},n);c[e]=t,i(c)};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Adjust sizes of Top/Bottom sections"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(w,{autoFocus:!0,value:n.top,onChange:c,name:"top"}),Object(v.jsx)(w,{value:n.bottom,onChange:c,name:"bottom"})]})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.onSubmit(n),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}var Cb=a(905);function Sb(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}function Db(e,t){return"desc"===e?function(e,a){return Sb(e,a,t)}:function(e,a){return-Sb(e,a,t)}}function Ib(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))}function $b(e){var t=e.classes,a=e.onSelectAllClick,n=e.order,i=e.orderBy,c=e.numSelected,r=e.onRequestSort;return Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{padding:"checkbox",children:Object(v.jsx)(Fa.a,{indeterminate:c>0&&c<e.rowCount,checked:e.rowCount>0&&c===e.rowCount,onChange:a,inputProps:{"aria-label":"select all desserts"}})}),e.headCells.map((function(a){return void 0===e.shownColumns||e.shownColumns.includes(a.id)||"id"===a.id?Object(v.jsx)(H.a,{align:"left",padding:a.disablePadding?"none":"default",sortDirection:i===a.id&&n,children:Object(v.jsxs)(Cb.a,{active:i===a.id,direction:i===a.id?n:"asc",onClick:(c=a.id,function(e){r(e,c)}),children:[a.label,i===a.id?Object(v.jsx)("span",{className:t.visuallyHidden,children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},a.id):null;var c}))]})})}function Tb(e){var t="enhanced-table-checkbox-".concat(e.index);return Object(v.jsxs)(V.a,{hover:!0,role:"checkbox","aria-checked":e.isItemSelected,tabIndex:-1,selected:e.isItemSelected,style:void 0===e.style?{}:e.style,children:[Object(v.jsx)(H.a,{padding:"checkbox",children:Object(v.jsx)(Fa.a,{onClick:function(t){return e.handleClick(t,e.id)},checked:e.isItemSelected,inputProps:{"aria-labelledby":t}})}),e.children]},e.id)}var Pb,Ab,Eb,Fb,Lb,qb,Nb,Rb,Bb=Object(h.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}}));function Wb(e){var t=Bb(),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState([]),o=Object(j.a)(r,2),d=o[0],u=o[1],b=l.a.useState([]),p=Object(j.a)(b,2),h=p[0],f=p[1],O=l.a.useState(""),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useState(""),k=Object(j.a)(_,2),w=k[0],C=k[1],S=$(i,d),D=$(i,h);function I(t,a){return e.itemKey?t.filter((function(t){return void 0===a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1===a.indexOf(e)}))}function $(t,a){return e.itemKey?t.filter((function(t){return void 0!==a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1!==a.indexOf(e)}))}var T=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(R.a)(i);-1===a?n.push(t):n.splice(a,1),c(n)}};Object(s.useEffect)((function(){var t=e.left.reduce((function(t,a){return void 0===e.itemKey?e.right.includes(a)?Object(R.a)(t):[].concat(Object(R.a)(t),[a]):e.right.find((function(t){return t[e.itemKey]===a[e.itemKey]}))?Object(R.a)(t):[].concat(Object(R.a)(t),[a])}),[]);u(t),f(e.right),y(e.leftTitle),C(e.rightTitle)}),[e.left,e.right,e.leftTitle,e.rightTitle,e.itemKey]);var P=function(a,n){return Object(v.jsx)(G.a,{className:t.paper,style:{width:"100%",height:"calc(50vh)"},children:Object(v.jsxs)(Ve.a,{children:[Object(v.jsx)(La.a,{className:t.cardHeader,title:a}),Object(v.jsx)(qa.a,{}),Object(v.jsxs)(Ta.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[n.map((function(t){var a=void 0===e.itemKey?t:t[e.itemKey],n="transfer-list-item-".concat(a,"-label");return Object(v.jsxs)(Pa.a,{style:{padding:0},role:"listitem",button:!0,onClick:T(t),children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(Fa.a,{checked:void 0===e.itemKey?-1!==i.indexOf(a):-1!==i.findIndex((function(t){return t[e.itemKey]===a})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(v.jsx)(Ea.a,{id:n,primary:a})]},a)})),Object(v.jsx)(Pa.a,{})]})]})})};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:e.dialogTitle}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsxs)($t.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(v.jsx)($t.a,{item:!0,xs:5,children:P(g,d)}),Object(v.jsx)($t.a,{item:!0,children:Object(v.jsxs)($t.a,{container:!0,direction:"column",alignItems:"center",children:[Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(d)),u([])},disabled:0===d.length,"aria-label":"move all right",children:"\u226b"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(S)),u(I(d,S)),c(I(i,S))},disabled:0===S.length,"aria-label":"move selected right",children:">"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){u(d.concat(D)),f(I(h,D)),c(I(i,D))},disabled:0===D.length,"aria-label":"move selected left",children:"<"}),Object(v.jsx)(m.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){u(d.concat(h)),f([])},disabled:0===h.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(v.jsx)($t.a,{item:!0,xs:5,children:P(w,h)})]})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.onSubmit({left:d,right:h}),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}function zb(e){return Object(v.jsx)(he,{fullWidth:null!==e.fullWidth&&e.fullWidth,maxWidth:null===e.maxWidth?"sm":e.maxWidth,open:e.open,onClose:function(){e.onClose()},innerDialog:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:e.title}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{multiline:!0,value:e.value,onChange:function(){}})}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})})}var Hb,Mb,Ub=Object(Pe.a)(Pb||(Pb=Object(B.a)(["\nmutation hideCallback ($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, active: false}) {\n    status\n    error\n  }\n}\n"]))),Vb=Object(Pe.a)(Ab||(Ab=Object(B.a)(["\nmutation hideCallback ($callback_id: Int!, $active: Boolean!){\n  updateCallback(input: {callback_id: $callback_id, active: $active}) {\n    status\n    error\n  }\n}\n"]))),Gb=Object(Pe.a)(Eb||(Eb=Object(B.a)(["\nmutation removeEdgeMutation ($edge_id: Int!, $end_timestamp: timestamp!){\n    update_callbackgraphedge_by_pk(pk_columns: {id: $edge_id}, _set: {end_timestamp: $end_timestamp}) {\n        end_timestamp\n        id\n      }\n}\n"]))),Kb=Object(Pe.a)(Fb||(Fb=Object(B.a)(["\nmutation addEdgeMutation ($source_id: Int!, $destination_id: Int!, $profile_id: Int!){\n  insert_callbackgraphedge_one(object: {c2_profile_id: $profile_id, destination_id: $destination_id, direction: 1, source_id: $source_id}) {\n    id\n  }\n}\n"]))),Qb=Object(Pe.a)(Lb||(Lb=Object(B.a)(["\nmutation unlockCallback($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: false}) {\n    status\n    error\n  }\n}\n"]))),Jb=Object(Pe.a)(qb||(qb=Object(B.a)(["\nmutation lockCallack($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: true}) {\n    status\n    error\n  }\n}\n"]))),Yb=Object(Pe.a)(Nb||(Nb=Object(B.a)(["\nmutation updateDescriptionCallack($callback_id: Int!, $description: String!){\n  updateCallback(input: {callback_id: $callback_id, description: $description}) {\n    status\n    error\n  }\n}\n"]))),Zb=Object(Pe.a)(Rb||(Rb=Object(B.a)(["\nmutation updateSleepInfoCallback($callback_id: Int!, $sleep_info: String!){\n  update_callback_by_pk(pk_columns: {id: $callback_id}, _set: {sleep_info: $sleep_info}){\n    id\n    sleep_info\n  }\n}\n"]))),Xb=a(460),ej=a.n(Xb),tj=a(330),aj=a.n(tj),nj=a(459),ij=a.n(nj),cj=a(220),rj=Object(Pe.a)(Hb||(Hb=Object(B.a)(["\nquery GetCallbackDetails($callback_id: Int!) {\n  callback_by_pk(id: $callback_id){\n    payload {\n      uuid\n      payloadtype{\n          ptype\n          id\n          commands(where: {script_only: {_eq: true}, deleted: {_eq: false}}){\n            id\n            cmd\n            version\n          }\n      }\n      filemetum {\n        filename_text\n        agent_file_id\n        id\n        md5\n        sha1\n      }\n      buildparameterinstances {\n        parameter\n        id\n        buildparameter {\n          description\n        }\n      }\n      os\n    }\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n    loadedcommands{\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    last_checkin\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n  }\n  \n}\n"])));function oj(e){var t=Object(ve.a)(),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState([]),s=Object(j.a)(r,2),d=s[0],u=s[1],p=l.a.useState([]),h=Object(j.a)(p,2),f=h[0],O=h[1],x=Object(Ae.a)(rj,{variables:{callback_id:e.callback_id},onCompleted:function(e){var t=e.callback_by_pk.loadedcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})),a=e.callback_by_pk.payload.payloadtype.commands.reduce((function(e,t){return[].concat(Object(R.a)(e),[{cmd:t.cmd,mythic:t.version,payload:t.version}])}),Object(R.a)(t)).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));c(a);var n=e.callback_by_pk.payload.buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));u(n);var i=e.callback_by_pk.c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[].concat(Object(R.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),r=Object.keys(i).reduce((function(e,t){return[].concat(Object(R.a)(e),[{c2_profile:t,parameters:i[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);O(r)}}),g=x.loading,y=x.error,_=x.data;return g?Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}}):y?(console.error(y),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Callback Configuration"}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Callback Information"})}),Object(v.jsx)(Mr,Object(o.a)({},_.callback_by_pk)),Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Payload Information"})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Payload Info"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsxs)(z.a,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Payload Type"}),Object(v.jsx)(H.a,{children:_.callback_by_pk.payload.payloadtype.ptype})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Selected OS"}),Object(v.jsx)(H.a,{children:_.callback_by_pk.payload.os})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"UUID"}),Object(v.jsx)(H.a,{children:_.callback_by_pk.payload.uuid})]}),_.callback_by_pk.payload.filemetum?Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Filename"}),Object(v.jsx)(H.a,{children:_.callback_by_pk.payload.filemetum.filename_text})]},"filename_text"):null,Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"Download URL"}),Object(v.jsx)(H.a,{children:window.location.origin+"/direct/download/"+_.callback_by_pk.payload.filemetum.agent_file_id})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"SHA1"}),Object(v.jsx)(H.a,{children:_.callback_by_pk.payload.filemetum.sha1})]}),Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:"MD5"}),Object(v.jsx)(H.a,{children:_.callback_by_pk.payload.filemetum.md5})]})]})]}),Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Build Parameters"})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"30%"},children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{children:d.map((function(e,t){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.description}),Object(v.jsx)(H.a,{children:e.value})]},"buildprop"+t+"for"+_.callback_by_pk.payload.id)}))})]}),f.map((function(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:e.c2_profile})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"30%"},children:"Parameter"}),Object(v.jsx)(H.a,{children:"Value"})]})}),Object(v.jsx)(z.a,{style:{whiteSpace:"pre"},children:e.parameters.map((function(t,a){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:t.description}),Object(v.jsx)(H.a,{children:"Dictionary"===t.parameter_type||"Array"===t.parameter_type?JSON.stringify(JSON.parse(t.value),null,2):t.value})]},"c2frag"+_.callback_by_pk.payload.id+e.c2_profile+a)}))})]})]},"c2frag"+_.callback_by_pk.payload.id+e.c2_profile)})),Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Loaded Commands"})}),Object(v.jsxs)(W.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Command Name"}),Object(v.jsx)(H.a,{children:"Mythic Version"}),Object(v.jsx)(H.a,{children:"Loaded Version"}),Object(v.jsx)(H.a,{children:"Documentation"})]})}),Object(v.jsx)(z.a,{children:i.map((function(e){return Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:e.cmd}),Object(v.jsx)(H.a,{children:e.mythic}),Object(v.jsx)(H.a,{children:e.payload}),Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+_.callback_by_pk.payload.payloadtype.ptype+"/commands/"+e.cmd,children:"Docs"})})]},e.cmd+_.callback_by_pk.payload.id)}))})]})]}),Object(v.jsx)(se.a,{children:Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var sj=Object(Pe.a)(Mb||(Mb=Object(B.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    id\n    last_checkin\n  }\n}\n "])));function lj(e){var t=l.a.useRef(null),a=Object(ve.a)(),n=l.a.useState(!1),i=Object(j.a)(n,2),c=i[0],r=i[1],d=l.a.useState(!1),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useState(a.palette.success.main),f=Object(j.a)(h,2),O=f[0],x=f[1],g=l.a.useState(!0),y=Object(j.a)(g,2),_=y[0],k=y[1],w=l.a.useState(!1),C=Object(j.a)(w,2),S=C[0],D=C[1],I=l.a.useState(!1),$=Object(j.a)(I,2),T=$[0],P=$[1],A=l.a.useState(!1),E=Object(j.a)(A,2),F=E[0],L=E[1],N=l.a.useState(!1),B=Object(j.a)(N,2),W=B[0],z=B[1],M=l.a.useState([]),U=Object(j.a)(M,2),V=U[0],K=U[1],Q=l.a.useState([]),J=Object(j.a)(Q,2),Y=J[0],Z=J[1],X=l.a.useState([]),ee=Object(j.a)(X,2),te=ee[0],ae=ee[1],ne=l.a.useState(!0),ie=Object(j.a)(ne,2),ce=ie[0],re=ie[1];Object(s.useEffect)((function(){void 0===e.shownColumns?ae([]):ae(e.shownColumns)}),[e.shownColumns]);var oe=function(t){_||q.warning("Agent has no egress route! Re-link before tasking"),"interact"===t?e.onOpenTab({tabType:t,tabID:e.id+t,callbackID:e.id}):"processBrowser"===t?e.onOpenTab({tabType:t,tabID:e.host,callbackID:e.id}):e.onOpenTab({tabType:t,tabID:e.id+t,callbackID:e.id})};Object(s.useEffect)((function(){var t=Y.filter((function(t){return!t.c2profile.is_p2p&&t.source.id===e.id&&t.destination.id===e.id})).length;t>0&&!ce?re(!0):0===t&&ce&&re(!1)}),[Y]),Object(s.useEffect)((function(){var t=function(t){for(var a=e.callbackgraphedges.filter((function(a){return(a.source.id===e.id||a.destination.id===e.id)&&(!t||null===a.end_timestamp)})),n=!0;n;){var i=e.callbackgraphedges.reduce((function(e,a){return e.includes(a)?Object(R.a)(e):e.filter((function(e){return(e.source.id===a.source.id||e.source.id===a.destination.id||e.destination.id===a.source.id)&&(!t||null===a.end_timestamp)})).length>0?[].concat(Object(R.a)(e),[a]):Object(R.a)(e)}),Object(R.a)(a));n=i.length>a,a=Object(R.a)(i)}return a},a=t(!0),n=t(!1);V.length!==a.length&&K(a),Y.length!==n.length&&Z(n)}),[e.callbackgraphedges,e.id]),Object(s.useEffect)((function(){0===V.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(x(a.palette.error.main),k(!1)):(x(a.palette.success.main),k(!0))}),[V,a.palette.success.main,a.palette.error.main]);var se=function(e){t.current&&t.current.contains(e.target)||D(!1)},le=Object(Ee.a)(Ub,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?q.success("Hiding callback"):q.warning(a.updateCallback.error)},onError:function(e){console.log(e)}}),de=Object(j.a)(le,1)[0],ue=l.a.useCallback((function(){z(!0)}),[]),be=Object(s.useCallback)((function(){switch(e.payload.os.toLowerCase()){case"windows":return Object(v.jsx)(ea.a,{icon:cj.d,size:"2x",style:{cursor:"pointer"},onClick:ue});case"linux":return Object(v.jsx)(ea.a,{icon:cj.c,size:"2x",style:{cursor:"pointer"},onClick:ue});case"macos":return Object(v.jsx)(ea.a,{icon:cj.a,size:"2x",style:{cursor:"pointer"},onClick:ue});case"chrome":return Object(v.jsx)(ea.a,{icon:cj.b,size:"2x",style:{cursor:"pointer"},onClick:ue});default:return Object(v.jsx)(ea.a,{icon:ta.h,size:"2x",style:{cursor:"pointer"},onClick:ue})}}),[]),je=[{name:"Hide Callback",icon:Object(v.jsx)(gu.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),de({variables:{callback_id:e.id}})}},{name:"File Browser",icon:Object(v.jsx)(aj.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),oe("fileBrowser")}},{name:"Process Browser",icon:Object(v.jsx)(aj.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),oe("processBrowser")}},{name:e.locked?"Unlock (Locked by "+e.locked_operator.username+")":"Lock Callback",icon:e.locked?Object(v.jsx)(Er.a,{style:{paddingRight:"5px"}}):Object(v.jsx)($r.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),e.toggleLock({id:e.id,locked:e.locked})}},{name:"Edit Description",icon:Object(v.jsx)(Ai.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),r(!0)}},{name:"Expand Callback",icon:Object(v.jsx)(ij.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),window.open("/new/callbacks/"+e.id,"_blank").focus()}},{name:"View Metadata",icon:Object(v.jsx)(Dn.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),p(!0)}}];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(Tb,{id:e.id,handleClick:e.handleClick,isItemSelected:e.isItemSelected(e.id),children:[Object(v.jsxs)(H.a,{children:[Object(v.jsxs)(bt.a,{variant:"contained",color:e.integrity_level>2?"secondary":"primary",ref:t,"aria-label":"split button",children:[Object(v.jsxs)(m.a,{size:"small",onClick:function(e){e.stopPropagation(),oe("interact")},children:[e.locked?Object(v.jsx)($r.a,{}):Object(v.jsx)(nl.a,{})," ",e.id]}),Object(v.jsx)(m.a,{style:{padding:0},size:"small","aria-controls":S?"split-button-menu":void 0,"aria-expanded":S?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),D((function(e){return!e}))},children:Object(v.jsx)(pt.a,{})})]}),Object(v.jsx)(ft.a,{open:S,anchorEl:t.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(e){var t=e.TransitionProps,n=e.placement;return Object(v.jsx)(mt.a,Object(o.a)(Object(o.a)({},t),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(v.jsx)(G.a,{style:{backgroundColor:"dark"===a.palette.type?a.palette.primary.dark:a.palette.primary.light,color:"white"},children:Object(v.jsx)(ht.a,{onClickAway:se,children:Object(v.jsx)(xt.a,{id:"split-button-menu",children:je.map((function(e,t){return Object(v.jsxs)(Ot.a,{onClick:function(e){return function(e,t){je[t].click(e),D(!1)}(e,t)},children:[e.icon,e.name]},e.name)}))})})})}))}})]}),te.includes("ip")?Object(v.jsx)(H.a,{children:e.ip}):null,te.includes("host")?Object(v.jsx)(H.a,{children:e.host}):null,te.includes("user")?Object(v.jsx)(H.a,{children:e.user}):null,te.includes("domain")?Object(v.jsx)(H.a,{children:e.domain}):null,te.includes("os")?Object(v.jsxs)(H.a,{children:[be(),Object(v.jsx)(zb,{onClose:function(){z(!1)},title:"Operating System Information",maxWidth:"md",fullWidth:!0,value:e.os,open:W})]}):null,te.includes("arch")?Object(v.jsx)(H.a,{children:e.architecture}):null,te.includes("pid")?Object(v.jsx)(H.a,{children:e.pid}):null,te.includes("last_checkin")?Object(v.jsx)(H.a,{children:Object(v.jsx)(bj,{callback_id:e.id})}):null,te.includes("description")?Object(v.jsx)(H.a,{children:e.description}):null,te.includes("sleep")?Object(v.jsx)(H.a,{children:Object(v.jsx)(ej.a,{onClick:function(e){e.stopPropagation(),L(!0)},style:{color:""===e.sleep_info?a.palette.warning.main:a.palette.info.main,cursor:"pointer"}})}):null,te.includes("type")?Object(v.jsx)(H.a,{children:e.payload.payloadtype.ptype}):null,te.includes("c2")?Object(v.jsx)(H.a,{children:ce?Object(v.jsx)(ut.a,{onClick:function(e){e.stopPropagation(),P(!0)},style:{color:O,cursor:"pointer"}}):Object(v.jsx)(Pr.a,{onClick:function(e){e.stopPropagation(),P(!0)},style:{color:O,cursor:"pointer"}})}):null,te.includes("process_name")?Object(v.jsx)(H.a,{children:e.process_name}):null,te.includes("external_ip")?Object(v.jsx)(H.a,{children:e.external_ip}):null]}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:T,onClose:function(){P(!1)},innerDialog:Object(v.jsx)(Rr,Object(o.a)(Object(o.a)({onClose:function(){P(!1)}},e),{},{callbackgraphedges:_?V:Y}))}),b&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:b,onClose:function(){p(!1)},innerDialog:Object(v.jsx)(oj,{onClose:function(){p(!1)},callback_id:e.id})}),Object(v.jsx)(he,{fullWidth:!0,open:c,onClose:function(){r(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Callback's Description",onClose:function(){r(!1)},value:e.description,onSubmit:function(t){e.updateDescription({description:t,id:e.id})}})}),Object(v.jsx)(he,{fullWidth:!0,open:F,onClose:function(){L(!1)},innerDialog:Object(v.jsx)(me,{title:"Sleep Information",onClose:function(){L(!1)},value:e.sleep_info,onSubmit:function(t){e.updateSleepInfo({sleep_info:t,id:e.id})}})})]})}var dj=l.a.memo(lj);function uj(e){var t=e.callback_id,a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(""),o=Object(j.a)(r,2),s=o[0],d=o[1];Object(nt.a)(sj,{variables:{callback_id:t},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;d(t.data.callback_by_pk.last_checkin)}});return ye((function(){c(ge(s))})),i}var bj=l.a.memo(uj),jj=a(860),pj=a(461),hj=a.n(pj),mj=Object(h.a)((function(e){return{root:{minHeight:"unset",marginTop:"10px"},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(eo.e)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{}}})),fj=function(e){var t=mj(),a=Object(ve.a)(),n=e.numSelected;return Object(v.jsx)(l.a.Fragment,{children:n>1?Object(v.jsx)(jj.a,{className:Object(p.default)(t.root,Object(b.a)({},t.highlight,n>1)),children:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(Z.a,{className:t.title,color:"inherit",variant:"subtitle1",component:"div",children:[n," selected"]}),Object(v.jsx)(Kc.a,{title:"Hide Selected",children:Object(v.jsx)(Y.a,{"aria-label":"hide",onClick:e.onHideSelected,children:Object(v.jsx)(hj.a,{})})}),Object(v.jsx)(Kc.a,{title:"Task Selected",children:Object(v.jsx)(Y.a,{"aria-label":"hide",onClick:e.onTaskSelected,children:Object(v.jsx)(ea.a,{icon:ta.j,title:"Task All"})})})]})}):Object(v.jsxs)(G.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",width:"100%"},variant:"elevation",children:[Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Active Callbacks"}),Object(v.jsx)(m.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"20px"},onClick:function(t){t.stopPropagation(),e.openDialog()},children:"Show/Hide Columns"})]})})},Oj=Object(h.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function xj(e){var t=Oj(),a=l.a.useState("asc"),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("interact"),d=Object(j.a)(r,2),u=d[0],b=d[1],p=l.a.useState([]),h=Object(j.a)(p,2),m=h[0],f=h[1],O=l.a.useState(!1),x=Object(j.a)(O,2),g=x[0],y=x[1],_=l.a.useState([]),k=Object(j.a)(_,2),w=k[0],C=k[1],S=l.a.useState(["user","host","domain","description","last_checkin","type","c2","ip","os"]),D=Object(j.a)(S,2),I=D[0],$=D[1],T=function(e,t){var a=m.indexOf(t),n=[];-1===a?n=n.concat(m,t):0===a?n=n.concat(m.slice(1)):a===m.length-1?n=n.concat(m.slice(0,-1)):a>0&&(n=n.concat(m.slice(0,a),m.slice(a+1))),f(n)},P=function(e){return-1!==m.indexOf(e)},A=Object(Ee.a)(Ub,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?q.success("Hiding callback"):q.warning(a.updateCallback.error)},onError:function(e){q.warning(e),console.log(e)}}),E=Object(j.a)(A,1)[0],F=Object(Ee.a)(Jb,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?q.success("Locked callback"):q.warning(a.updateCallback.error)},onError:function(e){console.log(e),q.warning(e)}}),L=Object(j.a)(F,1)[0],N=Object(Ee.a)(Qb,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?q.success("Unlocked callback"):q.warning(a.updateCallback.error)},onError:function(e){console.log(e),q.warning(e)}}),B=Object(j.a)(N,1)[0],H=Object(Ee.a)(Yb,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?q.success("Updated Callback"):q.warning(a.updateCallback.error)},onError:function(e){console.log(e),q.warning(e)}}),U=Object(j.a)(H,1)[0],V=Object(Ee.a)(Zb,{update:function(e,t){t.data;q.success("Updated Callback")},onError:function(e){console.log(e),q.warning(e)}}),K=Object(j.a)(V,1)[0],Q=Object(s.useMemo)((function(){return[{id:"id",numeric:!0,disablePadding:!1,label:"Interact"},{id:"ip",numeric:!1,disablePadding:!1,label:"IP"},{id:"host",numeric:!1,disablePadding:!1,label:"Host"},{id:"user",numeric:!1,disablePadding:!1,label:"User"},{id:"domain",numeric:!1,disablePadding:!1,label:"Domain"},{id:"os",numeric:!1,disablePadding:!1,label:"OS"},{id:"arch",numberic:!1,disablePadding:!1,label:"Arch"},{id:"pid",numeric:!0,disablePadding:!1,label:"PID"},{id:"last_checkin",numeric:!0,disablePadding:!1,label:"Last Checkin"},{id:"description",numeric:!1,disablePadding:!1,label:"Description"},{id:"sleep",numeric:!1,disablePadding:!0,label:"Sleep"},{id:"type",numeric:!1,disablePadding:!1,label:"Type"},{id:"c2",numeric:!1,disablePadding:!0,label:"C2"},{id:"process_name",numeric:!1,disablePadding:!0,label:"Process Name"},{id:"external_ip",numberic:!1,disablePadding:!0,label:"External IP"}]}),[]);Object(s.useEffect)((function(){var e=Q.map((function(e){return e.id})).filter((function(e){return"id"!==e}));C(e);var t=localStorage.getItem("callbacks_table_columns");null!==t&&$(JSON.parse(t))}),[Q]);var J=l.a.useCallback((function(e){var t=e.id;e.locked?B({variables:{callback_id:t}}):L({variables:{callback_id:t}})}),[]),Y=l.a.useCallback((function(e){var t=e.id,a=e.description;U({variables:{callback_id:t,description:a}})}),[]),Z=l.a.useCallback((function(e){var t=e.id,a=e.sleep_info;K({variables:{callback_id:t,sleep_info:a}})}),[]);return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(fj,{numSelected:m.length,onHideSelected:function(){for(var t=Object(R.a)(m),a=function(a){t.includes(e.callbacks[a].id)&&(E({variables:{callback_id:e.callbacks[a].id}}),t=t.filter((function(t){return t!==e.callbacks[a].id})))},n=0;n<e.callbacks.length;n++)a(n);f(t)},onTaskSelected:function(){q.warning("Not Implemented Yet")},openDialog:function(){return y(!0)}}),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{maxWidth:"100%",marginRight:"5px",maxHeight:"87%",overflow:"auto"},children:Object(v.jsxs)(W.a,{size:"small",children:[Object(v.jsx)($b,{shownColumns:I,numSelected:m.length,rowCount:e.callbacks.length,classes:t,headCells:Q,onSelectAllClick:function(t){if(t.target.checked)if(m.length>0)f([]);else{var a=e.callbacks.map((function(e){return e.id}));f(a)}else f([])},onRequestSort:function(e,t){c(u===t&&"asc"===i?"desc":"asc"),b(t)},orderBy:u,order:i}),Object(v.jsx)(z.a,{children:Ib(e.callbacks,Db(i,u)).map((function(t,a){return Object(v.jsx)(dj,Object(o.a)(Object(o.a)({shownColumns:I,handleClick:T,isItemSelected:P,onOpenTab:e.onOpenTab},t),{},{callbackgraphedges:e.callbackgraphedges,toggleLock:J,updateDescription:Y,updateSleepInfo:Z}),"callback"+t.id)}))})]})}),g&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"lg",open:g,onClose:function(){y(!1)},innerDialog:Object(v.jsx)(Wb,{onClose:function(){y(!1)},onSubmit:function(e){e.left;var t=e.right;$(t),localStorage.setItem("callbacks_table_columns",JSON.stringify(t))},right:I,rightTitle:"Show these columns",leftTitle:"Hidden Columns",left:w,dialogTitle:"Edit which columns are shown"})})]})}var gj,yj,_j=a(462),vj=Object(Pe.a)(gj||(gj=Object(B.a)(["\nquery getP2PProfilesAndCallbacks($operation_id: Int!){\n  c2profile(where: {is_p2p: {_eq: true}}) {\n    callbackc2profiles(where: {callback: {operation_id: {_eq: $operation_id}}}) {\n      id\n      callback {\n        id\n        description\n      }\n    }\n    name\n    id\n  }\n}\n"]))),kj=Object(h.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120,width:"97%"},selectEmpty:{marginTop:e.spacing(2)}}}));function wj(e){var t=kj(),a=l.a.useState([]),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState([]),o=Object(j.a)(r,2),d=o[0],u=o[1],b=l.a.useState(""),p=Object(j.a)(b,2),h=p[0],f=p[1],O=l.a.useState(""),x=Object(j.a)(O,2),g=x[0],y=x[1],_=Object(s.useRef)(null),k=Object(A.a)(I),w=Object(Ae.a)(vj,{variables:{operation_id:k.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.filter((function(t){var a=!1;return e.source.callbackc2profiles.forEach((function(e){e.c2profile.name===t.name&&(a=!0)})),a}));if(u(a),a.length>0){y(a[0]);var n=a[0].callbackc2profiles.filter((function(t){return t.callback.id!==e.source.id}));c(n),n.length>0&&f(n[0])}},fetchPolicy:"network-only"}),C=w.loading,S=w.error;return C?Object(v.jsx)(Fe.a,{style:{marginTop:"10px"}}):S?(console.error(S),Object(v.jsx)("div",{children:"Error!"})):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(ue.a,{children:["Manually Add Edge From Callback ",e.source.id]}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsxs)(l.a.Fragment,{children:["Manually add an edge from Callback ",e.source.id," to another callback via a P2P C2 Profile they both share.",Object(v.jsx)("br",{}),Object(v.jsxs)(Dt.a,{className:t.formControl,children:[Object(v.jsx)(Mt.a,{id:"demo-dialog-select-label-profile",children:"Profile"}),Object(v.jsxs)(It.a,{labelId:"demo-dialog-select-label-profile",id:"demo-dialog-select",value:g,onChange:function(e){y(e.target.value)},style:{minWidth:"30%"},children:[Object(v.jsx)(Ot.a,{value:"",children:Object(v.jsx)("em",{children:"None"})}),d.map((function(e){return Object(v.jsx)(Ot.a,{value:e,children:e.name},"profile:"+e.id)}))]})]}),Object(v.jsx)("br",{}),Object(v.jsxs)(Dt.a,{className:t.formControl,children:[Object(v.jsx)(Mt.a,{ref:_,children:"Destination"}),Object(v.jsxs)(It.a,{labelId:"demo-dialog-select-label-destination",id:"demo-dialog-select-destination",value:h,onChange:function(e){f(e.target.value)},input:Object(v.jsx)(Tt.a,{}),children:[Object(v.jsx)(Ot.a,{value:"",children:Object(v.jsx)("em",{children:"None"})}),i.map((function(e){return Object(v.jsxs)(Ot.a,{value:e,children:[e.callback.id," (",e.callback.description,")"]},"callback:"+e.callback.id)}))]})]})]})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.onSubmit(e.source.id,g,h.callback),e.onClose()},variant:"contained",style:{backgroundColor:_c.palette.success.main},children:"Add"})]})]})}var Cj,Sj,Dj=Object(Pe.a)(yj||(yj=Object(B.a)(['\nquery loadedLinkCommandsQuery ($callback_id: Int!){\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_ilike: "graph_view:link"}, deleted: {_eq: false}}}) {\n    command {\n        id\n        cmd\n        help_cmd\n        description\n        needs_admin\n    }\n  }\n}\n'])));function Ij(e){var t=e.onOpenTab,a=e.callbackgraphedges,n=Object(ve.a)(),i=Object(s.useRef)(null),c=l.a.useRef(null),r=l.a.useState(!1),d=Object(j.a)(r,2),u=d[0],b=d[1],p=Object(s.useState)(!0),h=Object(j.a)(p,2),f=h[0],O=h[1],x=l.a.useState([]),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState(!1),w=Object(j.a)(k,2),C=w[0],S=w[1],D=l.a.useState(!1),I=Object(j.a)(D,2),$=I[0],T=I[1],P=Object(s.useState)(),A=Object(j.a)(P,2),E=A[0],F=A[1],L=Object(s.useState)(),N=Object(j.a)(L,2),B=N[0],W=N[1],z=Object(s.useState)(!1),H=Object(j.a)(z,2),M=H[0],U=H[1],V=Object(s.useState)(!1),K=Object(j.a)(V,2),Q=K[0],J=K[1],Y=Object(s.useState)([]),Z=Object(j.a)(Y,2),X=Z[0],ee=Z[1],te=Object(s.useState)(null),ae=Object(j.a)(te,2),ne=ae[0],ie=ae[1],ce=Object(St.a)(Dj,{fetchPolicy:"network-only",onCompleted:function(e){if(1===e.loadedcommands.length)F(e.loadedcommands[0].command),S(!0);else if(0===e.loadedcommands.length)q.warning("No commands loaded that are 'link' commands");else{var t=e.loadedcommands.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{display:e.command.cmd})}));_(t),F(t[0].command),T(!0)}}}),re=Object(j.a)(ce,1)[0],oe=Object(Ee.a)(od,{update:function(e,t){var a=t.data;"error"===a.createTask.status?q.error(a.createTask.error):q.success("task created")}}),se=Object(j.a)(oe,1)[0],le=l.a.useState({rankDir:"LR",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!1}),de=Object(j.a)(le,2),ue=de[0],be=de[1],je=Object(Ee.a)(Ub,{update:function(e,t){t.data}}),pe=Object(j.a)(je,1)[0],me=Object(Ee.a)(Gb,{update:function(e,t){t.data}}),fe=Object(j.a)(me,1)[0],Oe=Object(Ee.a)(Kb,{update:function(e,t){t.data}}),xe=Object(j.a)(Oe,1)[0],ge=Object(s.useMemo)((function(){return{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[{title:"Hide Callback",action:function(e,t){pe({variables:{callback_id:t.node.id}})}},{title:"Interact",action:function(e,a){t({tabType:"interact",tabID:a.node.id+"interact",callbackID:a.node.id})}},{title:"Manually Remove Edge",action:function(e,t){var a=function(e,t){return e.nodeEdges(t)}(e,t.node.id).reduce((function(t,a){var n=e.edge(a.v,a.w,a.name);return null===n.end_timestamp?1===n.direction?ue.packet_flow_view?[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},n),{},{display:a.v+" --\x3e "+a.name+" --\x3e "+a.w})]):[].concat(Object(R.a)(t),[Object(o.a)(Object(o.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):Object(R.a)(t)}),[]);ee(a),U(!0)}},{title:"Manually Add Edge",action:function(e,t){ie(t.node),J(!0)}},{title:"Task Callback for Edge",action:function(e,t){_([]),F(null),W(null),re({variables:{callback_id:t.node.id}}),W(t.node)}}]}}),[re,pe,ue,t]),ye=[{name:ue.include_disconnected?"Show Only Active Edges":"Show All Edges",click:function(){var e=Object(o.a)(Object(o.a)({},ue),{},{include_disconnected:!ue.include_disconnected});Wr(Object(R.a)(a),i,!0,e,ge,n),be(e)}},{name:ue.show_all_nodes?"Hide inactive callbacks":"Show All Callbacks",click:function(){var e=Object(o.a)(Object(o.a)({},ue),{},{show_all_nodes:!ue.show_all_nodes});Wr(Object(R.a)(a),i,!0,e,ge,n),be(e)}},{name:"Autosize",click:function(){Wr(Object(R.a)(a),i,!0,ue,ge,n)}},{name:"LR"===ue.rankDir?"Change Layout to Top-Bottom":"Change Layout to Left-Right",click:function(){if("LR"===ue.rankDir){var e=Object(o.a)(Object(o.a)({},ue),{},{rankDir:"BT"});Wr(Object(R.a)(a),i,!0,e,ge,n),be(e)}else{var t=Object(o.a)(Object(o.a)({},ue),{},{rankDir:"LR"});Wr(Object(R.a)(a),i,!0,t,ge,n),be(t)}}},{name:ue.packet_flow_view?"View Connection Directions":"View Egress Routes",click:function(){var e=Object(o.a)(Object(o.a)({},ue),{},{packet_flow_view:!ue.packet_flow_view});Wr(Object(R.a)(a),i,!0,e,ge,n),be(e)}},{name:"Download Graph",click:function(){Object(_j.saveSvgAsPng)(document.getElementById("callbacksgraph"),"diagram.png")}}],_e=function(e){c.current&&c.current.contains(e.target)||b(!1)};return Object(s.useEffect)((function(){var e=Object(R.a)(a);Wr(e,i,f,ue,ge,n),O(!1)}),[a,f,ue,n]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(bt.a,{variant:"contained",ref:c,"aria-label":"split button",style:{marginTop:"10px"},color:"primary",children:Object(v.jsxs)(m.a,{size:"small",color:"primary","aria-controls":u?"split-button-menu":void 0,"aria-expanded":u?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),b((function(e){return!e}))},children:["Actions ",Object(v.jsx)(pt.a,{})]})}),function(){var e="";return e+=ue.include_disconnected?"Showing All Edges, ":"Showing Only Active Edges, ",e+=ue.show_all_nodes?"Showing All Callbacks, ":"Showing Active Callbacks, ",e+="Layout: "+ue.rankDir+", ",e+=ue.packet_flow_view?"Showing Egress Routes":"Showing Connections Paths"}(),Object(v.jsx)(ft.a,{open:u,anchorEl:c.current,role:void 0,transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,a=e.placement;return Object(v.jsx)(mt.a,Object(o.a)(Object(o.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(v.jsx)(G.a,{style:{backgroundColor:"dark"===n.palette.type?n.palette.primary.dark:n.palette.primary.light,color:"white"},children:Object(v.jsx)(ht.a,{onClickAway:_e,children:Object(v.jsx)(xt.a,{id:"split-button-menu",children:ye.map((function(e,t){return Object(v.jsx)(Ot.a,{onClick:function(e){return function(e,t){ye[t].click(),b(!1)}(0,t)},children:e.name},e.name)}))})})})}))}}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:M,onClose:function(){U(!1)},innerDialog:Object(v.jsx)(vo,{onClose:function(){U(!1)},identifier:"edge_id",display:"display",onSubmit:function(e){""!==e?fe({variables:{edge_id:e.edge_id,end_timestamp:(new Date).toISOString()}}):q.warning("No edge selected")},options:X,title:"Manually Remove Edge",action:"remove"})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:Q,onClose:function(){J(!1)},innerDialog:Object(v.jsx)(wj,{onClose:function(){J(!1)},onSubmit:function(e,t,a){""!==t&&""!==a?xe({variables:{source_id:e,profile_id:t.id,destination_id:a.id}}):q.warning("Profile or Destination Callback not provided")},source:ne})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:C,onClose:function(){S(!1)},innerDialog:Object(v.jsx)(Xo,{command:E,callback:B,onSubmit:function(e,t,a){S(!1),se({variables:{callback_id:B.id,command:e,params:t,files:a}})},onClose:function(){S(!1)}})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:$,onClose:function(){T(!1)},innerDialog:Object(v.jsx)(vo,{onClose:function(){T(!1)},onSubmit:function(e){F(e.command),S(!0)},options:y,title:"Select Link Command",action:"select",display:"display",identifier:"display"})}),Object(v.jsx)("div",{style:{maxWidth:"100%",overflow:"auto",height:"100%"},children:Object(v.jsx)("svg",{id:"callbacksgraph",ref:i,width:"100%",height:"98%"})})]})}var $j=Object(Pe.a)(Cj||(Cj=Object(B.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n  }\n}\n "]))),Tj=Object(Pe.a)(Sj||(Sj=Object(B.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function Pj(e){var t=e.onOpenTab,a=e.topDisplay,n=e.heights,i=Object(A.a)(I),c=l.a.useState([]),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState([]),u=Object(j.a)(d,2),b=u[0],p=u[1];Object(nt.a)($j,{variables:{operation_id:i.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;s(t.data.callback)}}),Object(nt.a)(Tj,{variables:{operation_id:i.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;p(t.data.callbackgraphedge)}});var h=function(e){for(var a=e.tabType,n=e.tabID,i=e.callbackID,c=0;c<o.length;c++)if(o[c].id===i){var r={tabID:n,tabType:a,callbackID:i,payloadtype:o[c].payload.payloadtype.ptype,payloadtype_id:o[c].payload.payloadtype.id,operation_id:o[c].operation_id,payloadDescription:o[c].payload.tag,callbackDescription:o[c].description,host:o[c].host,os:o[c].payload.os};t(r)}};return"graph"===a?Object(v.jsx)(Ij,{maxHeight:"100%",topHeight:n.top,onOpenTab:h,callbacks:o,callbackgraphedges:b},"callbacksgraph"):Object(v.jsx)(xj,{onOpenTab:h,callbacks:o,callbackgraphedges:b},"callbackstable")}var Aj=Object(h.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{bottom:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{top:e.spacing(2),right:e.spacing(2)}}}}));function Ej(){var e=l.a.useState("table"),t=Object(j.a)(e,2),a=t[0],n=t[1],i=l.a.useState([]),c=Object(j.a)(i,2),r=c[0],d=c[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState({top:"29%",bottom:"65%"}),f=Object(j.a)(m,2),O=f[0],x=f[1];Object(s.useEffect)((function(){var e=localStorage.getItem("openTabs");if(void 0!==e&&null!==e)try{var t=JSON.parse(e);d(t)}catch(i){console.log("failed to parse oldTabs",i)}var a=localStorage.getItem("heights");if(void 0!==a&&null!==a)try{var n=JSON.parse(a);x(n)}catch(i){console.log("failed to parse oldHeights",i)}}),[]);var g=l.a.useCallback((function(){h("")}),[]),y=l.a.useCallback((function(e){x(e),localStorage.setItem("heights",JSON.stringify(e))}),[]);return Object(v.jsxs)("div",{style:{maxWidth:"100%",height:"calc(95vh)",maxHeight:"calc(95vh)"},children:[Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)("div",{style:{maxHeight:O.top,height:O.top},children:Object(v.jsx)(Pj,{topDisplay:a,onOpenTab:function(e){var t=!1;if(r.forEach((function(a){a.tabID===e.tabID&&(t=!0)})),!t){var a=[].concat(Object(R.a)(r),[Object(o.a)({},e)]);localStorage.setItem("openTabs",JSON.stringify(a)),d(a)}h(e.tabID)},heights:O})}),Object(v.jsx)("div",{style:{maxHeight:O.bottom,height:O.bottom},children:Object(v.jsx)(fb,{onCloseTab:function(e){var t=e.tabID,a=(e.index,r.filter((function(e){return e.tabID!==t})));localStorage.setItem("openTabs",JSON.stringify(a)),d(a)},onEditTabDescription:function(e,t){var a=r.map((function(a){return a.tabID===e.tabID?Object(o.a)(Object(o.a)({},a),{},{customDescription:t}):Object(o.a)({},a)}));d(a),localStorage.setItem("openTabs",JSON.stringify(a))},clearSelectedTab:g,tabHeight:O.bottom,maxHeight:O.bottom,clickedTabId:p,openTabs:r},"callbackstabs")})]}),Object(v.jsx)(Rj,{setTopDisplay:n,heights:O,onSubmitHeights:y})]})}function Fj(e){var t=e.setTopDisplay,a=e.onSubmitHeights,n=e.heights,i=l.a.useState(!1),c=Object(j.a)(i,2),r=c[0],o=c[1],s=Aj(),d=l.a.useState(!1),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useMemo((function(){return[{icon:Object(v.jsx)(kb.a,{}),name:"Table layout",onClick:function(){t("table")}},{icon:Object(v.jsx)(Qi.a,{}),name:"Graph layout",onClick:function(){t("graph")}},{icon:Object(v.jsx)(_b.a,{}),name:"Adjust Top/Bottom Size",onClick:function(){p(!0),o(!1)}}]}),[]);return Object(v.jsxs)(l.a.Fragment,{children:[b&&Object(v.jsx)(he,{fullWidth:!0,maxWidth:"sm",open:b,onClose:function(){p(!1),o(!1)},innerDialog:Object(v.jsx)(wb,{onClose:function(){p(!1),o(!1)},heights:n,onSubmit:function(e){o(!1),a(e)}})}),Object(v.jsx)(Ob.a,{ariaLabel:"SpeedDial example",className:s.speedDial,icon:Object(v.jsx)(xb.a,{}),onClose:function(){o(!1)},onOpen:function(){o(!0)},FabProps:{color:"secondary"},open:r,direction:"down",children:h.map((function(e){return Object(v.jsx)(gb.a,{icon:e.icon,tooltipTitle:e.name,onClick:e.onClick},e.name)}))})]})}var Lj,qj,Nj,Rj=l.a.memo(Fj),Bj=a(465),Wj=a.n(Bj),zj=a(891),Hj=a(906),Mj=a(775),Uj=20,Vj=Object(Pe.a)(Lj||(Lj=Object(B.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_text: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_text: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),id),Gj=Object(Pe.a)(qj||(qj=Object(B.a)(["\n","\nquery parametersQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),id),Kj=Object(Pe.a)(Nj||(Nj=Object(B.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),id);function Qj(e){return Object(v.jsx)(Xr,Object(o.a)({label:"Tasks",iconComponent:Object(v.jsx)(Wj.a,{})},e))}var Jj,Yj,Zj,Xj=function(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("Output"),o=Object(j.a)(r,2),s=o[0],d=o[1],u=["Output","Parameters","Comment"],b=l.a.useState(""),p=Object(j.a)(b,2),h=p[0],m=p[1],f=function(t,a,n,c){var r=a||i,o=c||h;switch(n||s){case"Output":e.onOutputSearch({search:r,offset:0,taskStatus:o});break;case"Parameters":e.onParameterSearch({search:r,offset:0,taskStatus:o});break;case"Comment":e.onCommentSearch({search:r,offset:0,taskStatus:o})}};return l.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Output",i="";t.has("search")&&(c(t.get("search")),a=t.get("search")),t.has("searchField")&&u.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Output"),e.onChangeSearchField("Output"),e.changeSearchParam("searchField","Output")),t.has("taskStatus")&&(m(t.get("taskStatus")),e.onChangeTaskStatus(t.get("taskStatus")),i=t.get("taskStatus")),f(0,a,n,i)}}),[e.value,e.index]),Object(v.jsxs)($t.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(v.jsx)($t.a,{item:!0,xs:6,children:Object(v.jsx)(w,{placeholder:"Search...",value:i,onChange:function(t,a,n){c(a),e.changeSearchParam("search",a)},onEnter:f,name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:f,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(v.jsxs)($t.a,{item:!0,xs:3,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search Task's"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"task_component",name:"searchField",value:s,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:u.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchopt"+e)}))})})]}),Object(v.jsx)($t.a,{item:!0,xs:2,children:Object(v.jsx)(w,{placeholder:"Filter Task Status...",value:h,onChange:function(t,a,n){m(a),e.changeSearchParam("taskStatus",a)},onEnter:f,name:"Filter Task Status..."})})]})},ep=function(e){var t=l.a.useState({task:[]}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState("Output"),f=Object(j.a)(m,2),O=f[0],x=f[1],g=l.a.useState(""),y=Object(j.a)(g,2),_=y[0],k=y[1],w=Object(A.a)(I),C=Object(St.a)(Vj,{fetchPolicy:"no-cache",onCompleted:function(e){q.dismiss(),d(e.task_aggregate.aggregate.count),i({task:e.task})},onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),S=Object(j.a)(C,1)[0],D=Object(St.a)(Gj,{fetchPolicy:"no-cache",onCompleted:function(e){q.dismiss(),d(e.task_aggregate.aggregate.count),i({task:e.task})},onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),$=Object(j.a)(D,1)[0],T=Object(St.a)(Kj,{fetchPolicy:"no-cache",onCompleted:function(e){q.dismiss(),d(e.task_aggregate.aggregate.count),i({task:e.task})},onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),P=Object(j.a)(T,1)[0],E=function(e){var t=e.search,a=e.offset,n=e.taskStatus;q.info("Searching...",{persist:!0}),h(t);var i=t;""===t&&(i="_");var c=n;""===c&&(c="_"),S({variables:{operation_id:w.user.current_operation_id,offset:a,fetchLimit:Uj,search:"%"+i+"%",status:"%"+c+"%"}})},F=function(e){var t=e.search,a=e.offset,n=e.taskStatus;q.info("Searching...",{persist:!0}),h(t);var i=t;""===t&&(i="_");var c=n;""===c&&(c="_"),$({variables:{operation_id:w.user.current_operation_id,offset:a,fetchLimit:Uj,search:"%"+i+"%",status:"%"+c+"%"}})},L=function(e){var t=e.search,a=e.offset,n=e.taskStatus;q.info("Searching...",{persist:!0});var i=t;console.log("search",t),""===t&&(i="_");var c=n;""===c&&(c="_"),h(t),P({variables:{operation_id:w.user.current_operation_id,offset:a,fetchLimit:Uj,search:"%"+i+"%",status:"%"+c+"%"}})};return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)(Xj,{onChangeSearchField:function(e){x(e)},onOutputSearch:E,value:e.value,index:e.index,onChangeTaskStatus:function(e){k(e)},onParameterSearch:F,onCommentSearch:L,changeSearchParam:e.changeSearchParam}),Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.task.length>0?n.task.map((function(e){return Object(v.jsx)(Al,{task:e,command_id:null==e.command?0:e.command.id},"taskinteractdisplay"+e.id)})):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(s/Uj),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(O){case"Output":E({search:p,offset:0,taskStatus:_});break;case"Parameters":F({search:p,offset:0,taskStatus:_});break;case"Comment":L({search:p,offset:0,taskStatus:_})}else switch(O){case"Output":E({search:p,offset:(t-1)*Uj,taskStatus:_});break;case"Parameters":F({search:p,offset:(t-1)*Uj,taskStatus:_});break;case"Comment":L({search:p,offset:(t-1)*Uj,taskStatus:_})}},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",s]})]})]}))},tp=a(281),ap=a.n(tp),np=Object(h.a)((function(e){return{root:Object(b.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),ip=l.a.forwardRef((function(e,t){var a=Object(ve.a)(),n=np(a),i=Object(E.c)().closeSnackbar,c=Object(s.useState)(!0),r=Object(j.a)(c,2),o=r[0],l=r[1];return Object(v.jsx)(E.a,{ref:t,className:n.root,children:Object(v.jsxs)(Ve.a,{style:{backgroundColor:a.palette.success.main},children:[Object(v.jsxs)(Ja.a,{classes:{root:n.actionRoot},children:[Object(v.jsx)(Z.a,{variant:"subtitle2",className:n.typography,children:e.title}),Object(v.jsxs)("div",{className:n.icons,children:[Object(v.jsx)(Y.a,{"aria-label":"Show more",className:Object(p.default)(n.expand,Object(b.a)({},n.expandOpen,o)),onClick:function(){l(!o)},children:Object(v.jsx)(en.a,{})}),Object(v.jsx)(Y.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(v.jsx)(Za.a,{})})]})]}),Object(v.jsx)(J.a,{in:o,timeout:"auto",unmountOnExit:!0,children:Object(v.jsxs)(G.a,{className:n.collapse,children:[Object(v.jsx)(Z.a,{gutterBottom:!0,children:e.innerText}),Object(v.jsxs)(m.a,{size:"small",className:n.button,download:!0,href:e.downloadLink,children:[Object(v.jsx)(an.a,{className:n.checkIcon}),"Download now"]})]})})]})})})),cp=a(331),rp=a.n(cp),op=Object(Pe.a)(Jj||(Jj=Object(B.a)(["\nmutation downloadBulkMutation($files: [String!]!){\n    download_bulk(files: $files){\n        status\n        error\n        file_id\n    }\n}\n"]))),sp=Object(Pe.a)(Yj||(Yj=Object(B.a)(["\nmutation updateFileMutation($file_id: Int!){\n    update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {deleted: true}) {\n        id\n    }\n}\n"]))),lp=Object(Pe.a)(Zj||(Zj=Object(B.a)(["\nmutation updateCommentMutation($file_id: Int!, $comment: String!){\n    update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function dp(e){var t=l.a.useState({}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState([]),r=Object(j.a)(c,2),d=r[0],u=r[1],p=function(e,t){i(Object(o.a)(Object(o.a)({},n),{},Object(b.a)({},e,t)))};Object(s.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.id,!1))}),{});i(t),u(Object(R.a)(e.files))}),[e.files]);var h=Object(Ee.a)(op,{onCompleted:function(e){q.dismiss(),"success"===e.download_bulk.status?q.success("",{persist:!0,content:function(t){return Object(v.jsx)(ip,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):q.error(e.error)},onError:function(e){console.log(e),q.error("Failed to zip up files")}}),f=Object(j.a)(h,1)[0],O=function(e){var t=e.id,a=d.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{deleted:!0}):Object(o.a)({},e)}));u(a)},x=function(e){var t=e.id,a=e.comment,n=d.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{comment:a}):Object(o.a)({},e)}));u(n)};return Object(v.jsxs)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:[Object(v.jsxs)(m.a,{size:"small",onClick:function(){q.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var c=Object(j.a)(i[a],2),r=c[0];if(c[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(r)&&t.push(e.files[o].agent_file_id)}f({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(v.jsx)(rp.a,{}),"Zip & Download Selected"]}),Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"}}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Delete"}),Object(v.jsx)(H.a,{children:"File"}),Object(v.jsx)(H.a,{children:"Time"}),Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:"Comment"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"More"})]})}),Object(v.jsx)(z.a,{children:d.map((function(e){return Object(v.jsx)(up,Object(o.a)({onToggleSelection:p,onEditComment:x,selected:n,onDelete:O},e),"file"+e.id)}))})]})]})}function up(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState(!1),u=Object(j.a)(d,2),b=u[0],p=u[1],h=Object(A.a)(I),m=Object(ve.a)(),f=Object(Ee.a)(sp,{onCompleted:function(t){q.dismiss(),e.onDelete(t.update_filemeta_by_pk)},onError:function(e){console.log(e),q.error("Failed to delete file")}}),O=Object(j.a)(f,1)[0],x=Object(Ee.a)(lp,{onCompleted:function(t){q.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),g=Object(j.a)(x,1)[0];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(Ia,{onClose:function(){i(!1)},onSubmit:function(){O({variables:{file_id:e.id}})},open:n}),Object(v.jsx)(H.a,{children:e.deleted?null:Object(v.jsx)(Kc.a,{title:"Toggle to download multiple files at once",children:Object(v.jsx)(K.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(v.jsx)(H.a,{children:e.deleted?null:Object(v.jsx)(Y.a,{size:"small",onClick:function(){i(!0)},style:{color:m.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})})}),Object(v.jsx)(H.a,{children:e.deleted?Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(v.jsxs)(Z.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:xe(e.timestamp,h.user.view_utc_time)})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(v.jsxs)(H.a,{children:[e.comment,Object(v.jsx)(Y.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:b,onClose:function(){p(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit File Comment",onSubmit:function(t){g({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Y.a,{size:"small","aria-label":"expand row",onClick:function(){return s(!o)},children:o?Object(v.jsx)(ae.a,{className:"mythicElement"}):Object(v.jsx)(ee.a,{className:"mythicElement"})})})]}),o?Object(v.jsx)(V.a,{children:Object(v.jsx)(H.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(v.jsx)(J.a,{in:o,children:Object(v.jsx)(Q.a,{margin:1,children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"16rem"},children:"md5"}),Object(v.jsx)(H.a,{style:{width:"20rem"},children:"sha1"}),Object(v.jsx)(H.a,{style:{width:"20rem"},children:"UUID"}),Object(v.jsx)(H.a,{children:"Operator"}),Object(v.jsx)(H.a,{style:{width:"6rem"},children:"Task"}),Object(v.jsx)(H.a,{children:"Task Comment"}),Object(v.jsx)(H.a,{children:"Command"})]})}),Object(v.jsx)(z.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(v.jsx)(H.a,{children:null===e.task?null:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(v.jsx)(H.a,{children:null!==e.task?Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(v.jsx)(H.a,{children:null===e.task?null:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function bp(e){var t=l.a.useState({}),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState([]),r=Object(j.a)(c,2),d=r[0],u=r[1],p=function(e,t){i(Object(o.a)(Object(o.a)({},n),{},Object(b.a)({},e,t)))};Object(s.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(b.a)({},t.id,!1))}),{});i(t),u(Object(R.a)(e.files))}),[e.files]);var h=Object(Ee.a)(op,{onCompleted:function(e){q.dismiss(),"success"===e.download_bulk.status?q.success("",{persist:!0,content:function(t){return Object(v.jsx)(ip,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):q.error(e.error)},onError:function(e){console.log(e),q.error("Failed to zip up files")}}),f=Object(j.a)(h,1)[0],O=function(e){var t=e.id,a=d.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{deleted:!0}):Object(o.a)({},e)}));u(a)},x=function(e){var t=e.id,a=e.comment,n=d.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{comment:a}):Object(o.a)({},e)}));u(n)};return Object(v.jsxs)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:[Object(v.jsxs)(m.a,{size:"small",onClick:function(){q.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var c=Object(j.a)(i[a],2),r=c[0];if(c[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(r)&&t.push(e.files[o].agent_file_id)}f({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(v.jsx)(rp.a,{}),"Zip & Download Selected"]}),Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"}}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Delete"}),Object(v.jsx)(H.a,{children:"Source"}),Object(v.jsx)(H.a,{children:"Destination"}),Object(v.jsx)(H.a,{children:"Time"}),Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:"Comment"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"More"})]})}),Object(v.jsx)(z.a,{children:d.map((function(e){return Object(v.jsx)(jp,Object(o.a)({onToggleSelection:p,onEditComment:x,selected:n,onDelete:O},e),"file"+e.id)}))})]})]})}function jp(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState(!1),u=Object(j.a)(d,2),b=u[0],p=u[1],h=Object(A.a)(I),m=Object(ve.a)(),f=Object(Ee.a)(sp,{onCompleted:function(t){q.dismiss(),e.onDelete(t.update_filemeta_by_pk)},onError:function(e){console.log(e),q.error("Failed to delete file")}}),O=Object(j.a)(f,1)[0],x=Object(Ee.a)(lp,{onCompleted:function(t){q.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),g=Object(j.a)(x,1)[0];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(Ia,{onClose:function(){i(!1)},onSubmit:function(){O({variables:{file_id:e.id}})},open:n}),Object(v.jsx)(H.a,{children:e.deleted?null:Object(v.jsx)(Kc.a,{title:"Toggle to download multiple files at once",children:Object(v.jsx)(K.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(v.jsx)(H.a,{children:e.deleted?null:Object(v.jsx)(Y.a,{size:"small",onClick:function(){i(!0)},style:{color:m.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",download:!0,underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.filename_text})}),Object(v.jsx)(H.a,{style:{wordBreak:"break-all"},children:e.deleted?Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(v.jsxs)(Z.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:xe(e.timestamp,h.user.view_utc_time)})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(v.jsxs)(H.a,{children:[e.comment,Object(v.jsx)(Y.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:b,onClose:function(){p(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit File Comment",onSubmit:function(t){g({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Y.a,{size:"small","aria-label":"expand row",onClick:function(){return s(!o)},children:o?Object(v.jsx)(ae.a,{className:"mythicElement"}):Object(v.jsx)(ee.a,{className:"mythicElement"})})})]}),o?Object(v.jsx)(V.a,{children:Object(v.jsx)(H.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(v.jsx)(J.a,{in:o,children:Object(v.jsx)(Q.a,{margin:1,children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"md5"}),Object(v.jsx)(H.a,{children:"sha1"}),Object(v.jsx)(H.a,{children:"UUID"}),Object(v.jsx)(H.a,{children:"Operator"}),Object(v.jsx)(H.a,{style:{width:"6rem"},children:"Task"}),Object(v.jsx)(H.a,{children:"Task Comment"}),Object(v.jsx)(H.a,{children:"Command"})]})}),Object(v.jsx)(z.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(v.jsx)(H.a,{children:null===e.task?null:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(v.jsx)(H.a,{children:null!==e.task?Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(v.jsx)(H.a,{children:null===e.task?null:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function pp(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(s.useEffect)((function(){i(Object(R.a)(e.files))}),[e.files]);var c=function(e){var t=e.id,a=e.comment,c=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{comment:a}):Object(o.a)({},e)}));i(c)};return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Thumbnail"}),Object(v.jsx)(H.a,{children:"Filename"}),Object(v.jsx)(H.a,{children:"Time"}),Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:"Comment"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"More"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(hp,Object(o.a)({onEditComment:c},e),"file"+e.id)}))})]})})}function hp(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(A.a)(I),r=l.a.useState(!1),o=Object(j.a)(r,2),s=o[0],d=o[1],u=l.a.useState(!1),b=Object(j.a)(u,2),p=b[0],h=b[1],m=Object(Ee.a)(lp,{onCompleted:function(t){q.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),f=Object(j.a)(m,1)[0];return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsxs)(H.a,{children:[Object(v.jsx)("img",{onClick:function(){return d(!0)},src:"/api/v1.4/files/screencaptures/"+e.agent_file_id,style:{width:"150px",height:"150px",cursor:"pointer"}}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"xl",open:s,onClose:function(){d(!1)},innerDialog:Object(v.jsx)(jo,{href:"/api/v1.4/files/screencaptures/"+e.agent_file_id,onClose:function(){d(!1)}})}),e.chunks_received<e.total_chunks?Object(v.jsxs)(Z.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]}):null]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.filename_text})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:xe(e.timestamp,c.user.view_utc_time)})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(v.jsxs)(H.a,{children:[e.comment,Object(v.jsx)(Y.a,{onClick:function(){return h(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){h(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit File Comment",onSubmit:function(t){f({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){h(!1)}})})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Y.a,{size:"small","aria-label":"expand row",onClick:function(){return i(!n)},children:n?Object(v.jsx)(ae.a,{className:"mythicElement"}):Object(v.jsx)(ee.a,{className:"mythicElement"})})})]}),n?Object(v.jsx)(V.a,{children:Object(v.jsx)(H.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(v.jsx)(J.a,{in:n,children:Object(v.jsx)(Q.a,{margin:1,children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"md5"}),Object(v.jsx)(H.a,{children:"sha1"}),Object(v.jsx)(H.a,{children:"UUID"}),Object(v.jsx)(H.a,{children:"Operator"}),Object(v.jsx)(H.a,{style:{width:"6rem"},children:"Task"}),Object(v.jsx)(H.a,{children:"Task Comment"}),Object(v.jsx)(H.a,{children:"Command"})]})}),Object(v.jsx)(z.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(v.jsx)(H.a,{children:null===e.task?null:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(v.jsx)(H.a,{children:null!==e.task?Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(v.jsx)(H.a,{children:null===e.task?null:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}var mp,fp,Op,xp,gp,yp,_p,vp,kp,wp,Cp,Sp,Dp,Ip,$p=a(466),Tp=a.n($p),Pp=Object(Pe.a)(mp||(mp=Object(B.a)(["\nmutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!){\n    update_filebrowserobj_by_pk(pk_columns: {id: $filebrowserobj_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function Ap(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(s.useEffect)((function(){i(Object(R.a)(e.files))}),[e.files]);var c=function(e){var t=e.id,a=e.comment,c=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{comment:a}):Object(o.a)({},e)}));i(c)};return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Host / Path"}),Object(v.jsx)(H.a,{children:"Modify Time"}),Object(v.jsx)(H.a,{children:"Comment"}),Object(v.jsx)(H.a,{style:{width:"7rem"},children:"Permissions"}),Object(v.jsx)(H.a,{style:{width:"7rem"},children:"Downloads"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(Ep,Object(o.a)({onEditComment:c},e),"file"+e.id)}))})]})})}function Ep(e){var t=l.a.useState(!1),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(!1),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState(!1),u=Object(j.a)(d,2),b=u[0],p=u[1],h=Object(Ee.a)(Pp,{onCompleted:function(t){q.success("updated comment"),e.onEditComment(t.update_filebrowserobj_by_pk)}}),f=Object(j.a)(h,1)[0];return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(v.jsx)(fe,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:e.permissions,onClose:function(){i(!1)}})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:o,onClose:function(){s(!1)},innerDialog:Object(v.jsx)(Gd,{title:"Download History",value:e.filemeta,onClose:function(){s(!1)}})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:b,onClose:function(){p(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit File Browser Comment",onSubmit:function(t){f({variables:{filebrowserobj_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host}),Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",textDecoration:e.deleted?"strike-through":""},children:e.full_path_text})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.modify_time})}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Y.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(m.a,{color:"primary",variant:"outlined",onClick:function(){return i(!0)},children:Object(v.jsx)(Tp.a,{})})}),Object(v.jsx)(H.a,{children:e.filemeta.length>0?Object(v.jsx)(Kc.a,{title:"View Download History and Download Files",children:Object(v.jsx)(m.a,{color:"primary",variant:"contained",onClick:function(){return s(!0)},children:Object(v.jsx)(cu.a,{})})}):null})]})})}var Fp=Object(Pe.a)(fp||(fp=Object(B.a)(["\nfragment filemetaData on filemeta{\n    agent_file_id\n    chunk_size\n    chunks_received\n    complete\n    deleted\n    filename_text\n    full_remote_path_text\n    host\n    id\n    is_download_from_agent\n    is_payload\n    is_screenshot\n    md5\n    operator {\n        id\n        username\n    }\n    comment\n    sha1\n    timestamp\n    total_chunks\n    task {\n        id\n        comment\n        command {\n            cmd\n            id\n        }\n    }\n}\n"]))),Lp=Object(Pe.a)(Op||(Op=Object(B.a)(["\nfragment filebrowserData on filebrowserobj{\n    comment\n    deleted\n    full_path_text\n    host\n    id\n    is_file\n    modify_time\n    permissions\n    size\n    filemeta {\n        id\n        agent_file_id\n        chunks_received\n        complete\n        total_chunks\n        timestamp\n        task {\n            id\n            comment\n        }\n    }\n}\n"]))),qp=20,Np=Object(Pe.a)(xp||(xp=Object(B.a)(["\n","\nquery filenameFileMetaUploadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),Rp=Object(Pe.a)(gp||(gp=Object(B.a)(["\n","\nquery filenameFileMetaDownloadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),Bp=Object(Pe.a)(yp||(yp=Object(B.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {full_path_text: {_ilike: $filename}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, full_path_text: {_ilike: $filename}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),Lp),Wp=Object(Pe.a)(_p||(_p=Object(B.a)(["\n","\nquery hashFileMetaUploadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),zp=Object(Pe.a)(vp||(vp=Object(B.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),Hp=Object(Pe.a)(kp||(kp=Object(B.a)(["\n","\nquery commentFileMetaUploadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),Mp=Object(Pe.a)(wp||(wp=Object(B.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),Up=Object(Pe.a)(Cp||(Cp=Object(B.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),Lp),Vp=Object(Pe.a)(Sp||(Sp=Object(B.a)(["\n","\nquery filenameFileMetaScreenshotQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),Gp=Object(Pe.a)(Dp||(Dp=Object(B.a)(["\n","\nquery hashFileMetaScreenshotQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp),Kp=Object(Pe.a)(Ip||(Ip=Object(B.a)(["\n","\nquery commentFileMetaScreenshotQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),Fp);function Qp(e){return Object(v.jsx)(Xr,Object(o.a)({label:"Files",iconComponent:Object(v.jsx)(ap.a,{})},e))}var Jp,Yp,Zp,Xp,eh,th,ah,nh,ih,ch,rh,oh=function(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(""),o=Object(j.a)(r,2),s=o[0],d=o[1],u=l.a.useState("Filename"),b=Object(j.a)(u,2),p=b[0],h=b[1],m=["Filename","Hash","Comment"],f=l.a.useState("Downloads"),O=Object(j.a)(f,2),x=O[0],g=O[1],y=["Uploads","Downloads","FileBrowser","Screenshots"],_=l.a.useState(!1),k=Object(j.a)(_,2),C=k[0],S=k[1],D=function(t,a,n,c,r){var o=a||s,l=n||i,d=r||x;switch(c||p){case"Filename":e.onFilenameSearch({search:o,searchHost:l,offset:0,adjustedSearchLocation:d});break;case"Hash":e.onHashSearch({search:o,searchHost:l,offset:0,adjustedSearchLocation:d});break;case"Comment":e.onCommentSearch({search:o,searchHost:l,offset:0,adjustedSearchLocation:d})}};return l.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="",i="Filename",r="Downloads";t.has("search")&&(d(t.get("search")),a=t.get("search")),t.has("searchField")&&m.includes(t.get("searchField"))?(h(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),i=t.get("searchField")):(h("Filename"),e.onChangeSearchField("Filename"),e.changeSearchParam("searchField","Filename")),t.has("location")&&y.includes(t.get("location"))&&(g(t.get("location")),r=t.get("location"),e.onChangeSearchLocation(t.get("location"))),t.has("host")&&(c(t.get("host")),n=t.get("host")),S(!C),D(0,a,n,i,r)}}),[e.value,e.index]),Object(v.jsxs)($t.a,{container:!0,spacing:1,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(v.jsx)($t.a,{item:!0,xs:2,children:Object(v.jsx)(w,{placeholder:"Host Name Search...",value:i,onChange:function(t,a,n){c(a),e.changeSearchParam("host",a)},onEnter:D,name:"Host Name Search..."})}),Object(v.jsx)($t.a,{item:!0,xs:3,children:Object(v.jsx)(w,{placeholder:"Search...",value:s,onChange:function(t,a,n){d(a),e.changeSearchParam("search",a)},onEnter:D,name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:D,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(v.jsxs)($t.a,{item:!0,xs:3,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search File's"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"file_component",name:"searchField",value:p,onChange:function(t){h(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:m.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchopt"+e)}))})})]}),Object(v.jsxs)($t.a,{item:!0,xs:4,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search Location"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"file_component",name:"searchLocation",value:x,onChange:function(t){g(t.target.value),e.onChangeSearchLocation(t.target.value),e.changeSearchParam("location",t.target.value)},children:y.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchlocopt"+e)}))})})]})]})},sh=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState([]),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(0),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState(""),f=Object(j.a)(m,2),O=f[0],x=f[1],g=l.a.useState(""),y=Object(j.a)(g,2),_=y[0],k=y[1],w=l.a.useState("Filename"),C=Object(j.a)(w,2),S=C[0],D=C[1],$=l.a.useState("Downloads"),T=Object(j.a)($,2),P=T[0],E=T[1],F=Object(A.a)(I),L=function(e){q.dismiss(),h(e.filemeta_aggregate.aggregate.count),d([]),i(e.filemeta)},N=function(e){q.dismiss(),h(e.filebrowserobj_aggregate.aggregate.count),d(e.filebrowserobj),i([])},R=Object(St.a)(Np,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),B=Object(j.a)(R,1)[0],W=Object(St.a)(Rp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),z=Object(j.a)(W,1)[0],H=Object(St.a)(Bp,{fetchPolicy:"no-cache",onCompleted:N,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),M=Object(j.a)(H,1)[0],U=Object(St.a)(Vp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),V=Object(j.a)(U,1)[0],G=Object(St.a)(Wp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),K=Object(j.a)(G,1)[0],Q=Object(St.a)(zp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),J=Object(j.a)(Q,1)[0],Y=Object(St.a)(Gp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),X=Object(j.a)(Y,1)[0],ee=Object(St.a)(Hp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),te=Object(j.a)(ee,1)[0],ae=Object(St.a)(Mp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),ne=Object(j.a)(ae,1)[0],ie=Object(St.a)(Up,{fetchPolicy:"no-cache",onCompleted:N,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),ce=Object(j.a)(ie,1)[0],re=Object(St.a)(Kp,{fetchPolicy:"no-cache",onCompleted:L,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),oe=Object(j.a)(re,1)[0],se=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;q.info("Searching...",{persist:!0}),x(t),k(a),"FileBrowser"===i?M({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,filename:"%"+t+"%",host:"%"+a+"%"}}):"Uploads"===i?B({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,filename:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===i?z({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,filename:"%"+t+"%",host:"%"+a+"%"}}):V({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,filename:"%"+t+"%",host:"%"+a+"%"}})},le=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;q.info("Searching...",{persist:!0}),x(t),k(a),"FileBrowser"===i?(q.dismiss(),q.warning("FileBrowser doesn't currently track file hashes")):"Uploads"===i?K({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,hash:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===i?J({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,hash:"%"+t+"%",host:"%"+a+"%"}}):X({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,hash:"%"+t+"%",host:"%"+a+"%"}})},de=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;q.info("Searching...",{persist:!0});var c=t;""===t&&(c="_"),x(c),k(a),"FileBrowser"===i?ce({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,comment:"%"+c+"%",host:"%"+a+"%"}}):"Uploads"===i?te({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,comment:"%"+c+"%",host:"%"+a+"%"}}):"Downloads"===i?ne({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,comment:"%"+c+"%",host:"%"+a+"%"}}):oe({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:qp,comment:"%"+c+"%",host:"%"+a+"%"}})};return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)(oh,{onChangeSearchField:function(e){D(e)},onFilenameSearch:se,value:e.value,index:e.index,queryParams:e.queryParams,onHashSearch:le,onCommentSearch:de,onChangeSearchLocation:function(e){E(e),i([]),d([])},changeSearchParam:e.changeSearchParam}),Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.length>0?"Uploads"===P?Object(v.jsx)(bp,{files:n}):"Downloads"===P?Object(v.jsx)(dp,{files:n}):Object(v.jsx)(pp,{files:n}):s.length>0?Object(v.jsx)(Ap,{files:s}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(p/qp),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(S){case"Filename":se({search:O,searchHost:_,offset:0});break;case"Hash":le({search:O,searchHost:_,offset:0});break;case"Comments":de({search:O,offset:0})}else switch(S){case"Filename":se({search:O,searchHost:_,offset:(t-1)*qp});break;case"Hash":le({search:O,offset:(t-1)*qp});break;case"Comments":de({search:O,offset:(t-1)*qp})}},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",p]})]})]}))},lh=a(467),dh=a.n(lh),uh=a(192),bh=a.n(uh),jh=Object(Pe.a)(Jp||(Jp=Object(B.a)(["\nmutation updateCommentMutation($credential_id: Int!, $comment: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {comment: $comment}) {\n        comment\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),ph=Object(Pe.a)(Yp||(Yp=Object(B.a)(["\nmutation updateAccountMutation($credential_id: Int!, $account: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {account: $account}) {\n        account\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),hh=Object(Pe.a)(Zp||(Zp=Object(B.a)(["\nmutation updateAccountMutation($credential_id: Int!, $realm: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {realm: $realm}) {\n        realm\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),mh=Object(Pe.a)(Xp||(Xp=Object(B.a)(["\nmutation updateAccountMutation($credential_id: Int!, $credential: bytea!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {credential_raw: $credential}) {\n        credential_text\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),fh=Object(Pe.a)(eh||(eh=Object(B.a)(["\nmutation updateAccountMutation($credential_id: Int!, $deleted: Boolean!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n        operator {\n            username\n        }\n    }\n}\n"])));function Oh(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(s.useEffect)((function(){i(Object(R.a)(e.credentials))}),[e.credentials]);var c=function(e){var t=e.id,a=e.comment,c=e.operator,r=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{comment:a,operator:c}):Object(o.a)({},e)}));i(r)},r=function(e){var t=e.id,a=e.account,c=e.operator,r=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{account:a,operator:c}):Object(o.a)({},e)}));i(r)},d=function(e){var t=e.id,a=e.realm,c=e.operator,r=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{realm:a,operator:c}):Object(o.a)({},e)}));i(r)},u=function(e){var t=e.id,a=e.credential_text,c=e.operator,r=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{credential_text:a,operator:c}):Object(o.a)({},e)}));i(r)},b=function(e){var t=e.id,a=e.deleted,c=e.operator,r=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{deleted:a,operator:c}):Object(o.a)({},e)}));i(r)};return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Delete"}),Object(v.jsx)(H.a,{children:"Account"}),Object(v.jsx)(H.a,{children:"Realm"}),Object(v.jsx)(H.a,{children:"Credential"}),Object(v.jsx)(H.a,{children:"Comment"}),Object(v.jsx)(H.a,{children:"Timestamp"}),Object(v.jsx)(H.a,{children:"Task / Operator"}),Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Type"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(xh,Object(o.a)({onEditComment:c,onEditAccount:r,onEditRealm:d,onEditCredential:u,onEditDeleted:b},e),"cred"+e.id)}))})]})})}function xh(e){var t=Object(A.a)(I),a=Object(ve.a)(),n=l.a.useState(!1),i=Object(j.a)(n,2),c=i[0],r=i[1],o=l.a.useState(!1),s=Object(j.a)(o,2),d=s[0],u=s[1],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],m=p[1],f=l.a.useState(!1),O=Object(j.a)(f,2),x=O[0],g=O[1],y=l.a.useState(!1),_=Object(j.a)(y,2),k=_[0],w=_[1],C=Object(Ee.a)(jh,{onCompleted:function(t){q.success("updated comment"),e.onEditComment(t.update_credential_by_pk)}}),S=Object(j.a)(C,1)[0],D=Object(Ee.a)(ph,{onCompleted:function(t){q.success("updated account"),e.onEditAccount(t.update_credential_by_pk)}}),$=Object(j.a)(D,1)[0],T=Object(Ee.a)(hh,{onCompleted:function(t){q.success("updated realm"),e.onEditRealm(t.update_credential_by_pk)}}),P=Object(j.a)(T,1)[0],E=Object(Ee.a)(mh,{onCompleted:function(t){q.success("updated credential"),e.onEditCredential(t.update_credential_by_pk)}}),F=Object(j.a)(E,1)[0],L=Object(Ee.a)(fh,{onCompleted:function(t){q.success("updated deleted status"),e.onEditDeleted(t.update_credential_by_pk)}}),N=Object(j.a)(L,1)[0];return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(Ia,{onClose:function(){r(!1)},onSubmit:function(){N({variables:{credential_id:e.id,deleted:!e.deleted}})},open:c,acceptText:e.deleted?"Restore":"Remove"}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:d,onClose:function(){u(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Credential Comment",onSubmit:function(t){S({variables:{credential_id:e.id,comment:t}})},value:e.comment,onClose:function(){u(!1)}})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:h,onClose:function(){m(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Credential Account",onSubmit:function(t){$({variables:{credential_id:e.id,account:t}})},value:e.account,onClose:function(){m(!1)}})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:x,onClose:function(){g(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Credential Realm",onSubmit:function(t){P({variables:{credential_id:e.id,realm:t}})},value:e.realm,onClose:function(){g(!1)}})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:k,onClose:function(){w(!1)},innerDialog:Object(v.jsx)(me,{title:"Edit Credential Credential",onSubmit:function(t){F({variables:{credential_id:e.id,credential:t}})},value:e.credential_text,onClose:function(){w(!1)}})}),Object(v.jsxs)(H.a,{children:[e.deleted?Object(v.jsx)(Kc.a,{title:"Restore Credential for use in Tasking",children:Object(v.jsx)(Y.a,{size:"small",onClick:function(){r(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(v.jsx)(bh.a,{})})}):Object(v.jsx)(Kc.a,{title:"Delete Credential so it can't be used in Tasking",children:Object(v.jsx)(Y.a,{size:"small",onClick:function(){r(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})})})," "]}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Y.a,{onClick:function(){return m(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.account})]}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Y.a,{onClick:function(){return g(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.realm})]}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Y.a,{onClick:function(){return w(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",maxWidth:"40rem"},children:e.credential_text})]}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Y.a,{onClick:function(){return u(!0)},size:"small",style:{display:"inline-block"},children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:xe(e.timestamp,t.user.view_utc_time)})}),Object(v.jsx)(H.a,{children:null!==e.task_id?e.task_id:e.operator.username}),Object(v.jsx)(H.a,{children:e.type})]})})}var gh=Object(Pe.a)(th||(th=Object(B.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),yh=20,_h=Object(Pe.a)(ah||(ah=Object(B.a)(["\n","\nquery accountQuery($operation_id: Int!, $account: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),gh),vh=Object(Pe.a)(nh||(nh=Object(B.a)(["\n","\nquery accountQuery($operation_id: Int!, $realm: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),gh),kh=Object(Pe.a)(ih||(ih=Object(B.a)(["\n","\nquery accountQuery($operation_id: Int!, $credential: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),gh),wh=Object(Pe.a)(ch||(ch=Object(B.a)(["\n","\nquery accountQuery($operation_id: Int!, $comment: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),gh),Ch=Object(Pe.a)(rh||(rh=Object(B.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      id\n    }\n  }\n"])),gh);function Sh(e){return Object(v.jsx)(Xr,Object(o.a)({label:"Credentials",iconComponent:Object(v.jsx)(dh.a,{})},e))}var Dh,Ih,$h,Th,Ph,Ah,Eh,Fh=function(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("Account"),o=Object(j.a)(r,2),s=o[0],d=o[1],u=["Account","Realm","Comment","Credential"],b=l.a.useState(!1),p=Object(j.a)(b,2),h=p[0],f=p[1],O=Object(Ee.a)(Ch,{fetchPolicy:"no-cache",onCompleted:function(e){q.success("Successfully created new credential")},onError:function(e){q.error("Failed to create credential"),console.log(e)}}),x=Object(j.a)(O,1)[0],g=function(t,a,n){var c=a||i;switch(n||s){case"Account":e.onAccountSearch({search:c,offset:0});break;case"Realm":e.onRealmSearch({search:c,offset:0});break;case"Comment":e.onCommentSearch({search:c,offset:0});break;case"Credential":e.onCredentialSearch({search:c,offset:0});break;case"Type":e.OnTypeSearch({search:c,offset:0})}};return l.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Account";t.has("search")&&(c(t.get("search")),a=t.get("search")),t.has("searchField")&&u.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Account"),e.onChangeSearchField("Account"),e.changeSearchParam("searchField","Account")),g(0,a,n)}}),[e.value,e.index]),Object(v.jsxs)($t.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(v.jsx)($t.a,{item:!0,xs:5,children:Object(v.jsx)(w,{placeholder:"Search...",value:i,onChange:function(t,a,n){c(a),e.changeSearchParam("search",a)},onEnter:g,name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:g,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(v.jsxs)($t.a,{item:!0,xs:5,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search Credential's"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"file_component",name:"searchField",value:s,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:u.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchopt"+e)}))})})]}),Object(v.jsxs)($t.a,{item:!0,xs:2,children:[Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:h,onClose:function(){f(!1)},innerDialog:Object(v.jsx)(Io,{onSubmit:function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,c=e.credential;x({variables:{type:t,account:a,realm:n,comment:i,credential:c}})},onClose:function(){f(!1)}})}),Object(v.jsx)(m.a,{size:"small",color:"primary",onClick:function(){f(!0)},variant:"contained",children:"New Credential"})]})]})},Lh=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState("Account"),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Object(A.a)(I),y=function(e){q.dismiss(),d(e.credential_aggregate.aggregate.count),i(e.credential)},_=Object(St.a)(_h,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),k=Object(j.a)(_,1)[0],w=Object(St.a)(vh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),C=Object(j.a)(w,1)[0],S=Object(St.a)(kh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),D=Object(j.a)(S,1)[0],$=Object(St.a)(wh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),T=Object(j.a)($,1)[0],P=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t),k({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:yh,account:"%"+t+"%"}})},E=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t),C({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:yh,realm:"%"+t+"%"}})},F=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t),D({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:yh,credential:"%"+t+"%"}})},L=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:yh,comment:"%"+n+"%"}})};return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)(Fh,{onChangeSearchField:function(e){x(e),i([])},onAccountSearch:P,value:e.value,index:e.index,onRealmSearch:E,onCredentialSearch:F,onCommentSearch:L,changeSearchParam:e.changeSearchParam}),Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.length>0?Object(v.jsx)(Oh,{credentials:n}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(s/yh),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(O){case"Account":P({search:p,offset:0});break;case"Realm":E({search:p,offset:0});break;case"Credential":F({search:p,offset:0});break;case"Comment":L({search:p,offset:0})}else switch(O){case"Account":P({search:p,offset:(t-1)*yh});break;case"Realm":E({search:p,offset:(t-1)*yh});break;case"Credential":F({search:p,offset:(t-1)*yh});break;case"Comment":L({search:p,offset:(t-1)*yh})}},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",s]})]})]}))};function qh(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];return Object(s.useEffect)((function(){Object(R.a)(e.keylogs).reverse();"Keystroke"!==e.sortMethod&&e.sortMethod&&e.sortMethod;for(var t=e.keylogs.reduce((function(e,t){return void 0===e[t.user]?e[t.user]=Object(b.a)({},t.task.callback.host,Object(b.a)({},t.window,[Object(o.a)({},t)])):"undefined"===e[t.user][t.task.callback.host]?e[t.user][t.task.callback.host]=Object(b.a)({},t.window,[Object(o.a)({},t)]):void 0===e[t.user][t.task.callback.host][t.window]?e[t.user][t.task.callback.host][t.window]=[Object(o.a)({},t)]:e[t.user][t.task.callback.host][t.window].push(Object(o.a)({},t)),Object(o.a)({},e)}),{}),a=[],n=0,c=Object.entries(t);n<c.length;n++){for(var r=Object(j.a)(c[n],2),s=r[0],l=r[1],d=[],u=0,p=Object.entries(l);u<p.length;u++){for(var h=Object(j.a)(p[u],2),m=h[0],f=h[1],O=[],x=0,g=Object.entries(f);x<g.length;x++){var y=Object(j.a)(g[x],2),_=y[0],v=y[1];O.push({name:_,value:v})}d.push({name:m,value:O})}a.push({name:s,value:d})}i([].concat(a))}),[e.keylogs]),Object(v.jsx)($t.a,{container:!0,spacing:0,direction:"row",columns:12,children:n.map((function(e){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)($t.a,{item:!0,xs:2,style:{borderBottom:"2px solid grey"},children:e.name}),Object(v.jsx)($t.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:"2px solid grey"},children:e.value.map((function(t,a){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)($t.a,{item:!0,xs:2,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.name}),Object(v.jsx)($t.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.value.map((function(a,n){return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)($t.a,{item:!0,xs:2,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:[" ",a.name," "]}),Object(v.jsx)($t.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:Object(v.jsx)($t.a,{item:!0,xs:12,children:a.value.map((function(n,i){return Object(v.jsx)("span",{children:n.keystrokes_text},e.name+t.name+a.name+i)}))})})]},e.name+t.name+a.name)}))})]},e.name+t.name)}))})]},e.name)}))})}var Nh=Object(Pe.a)(Dh||(Dh=Object(B.a)(["\nfragment keylogData on keylog{\n    keystrokes_text\n    task {\n        id\n        callback {\n            host\n            id\n        }\n    }\n    user\n    window\n    timestamp\n    id\n}\n"]))),Rh=200,Bh=Object(Pe.a)(Ih||(Ih=Object(B.a)(["\n","\nquery keylogQuery($operation_id: Int!, $keylog: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Nh),Wh=Object(Pe.a)($h||($h=Object(B.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: user, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: user, offset: $offset, order_by: {user: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Nh),zh=Object(Pe.a)(Th||(Th=Object(B.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Nh),Hh=Object(Pe.a)(Ph||(Ph=Object(B.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Nh),Mh=Object(Pe.a)(Ah||(Ah=Object(B.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: window, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: window, offset: $offset, order_by: {window: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Nh),Uh=Object(Pe.a)(Eh||(Eh=Object(B.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Nh);function Vh(e){return Object(v.jsx)(Xr,Object(o.a)({label:"Keylogs",iconComponent:Object(v.jsx)(nl.a,{})},e))}var Gh,Kh,Qh,Jh,Yh=function(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("Keystroke"),o=Object(j.a)(r,2),s=o[0],d=o[1],u=["Keystroke","User","Program","Host"],b=function(t,a,n){var c=a||i;switch(n||s){case"Keystroke":e.onKeylogSearch({search:c,offset:0});break;case"User":e.onUserSearch({search:c,offset:0});break;case"Program":e.onProgramSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0})}};return l.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Keystroke";t.has("search")&&(c(t.get("search")),a=t.get("search")),t.has("searchField")&&u.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Keystroke"),e.onChangeSearchField("Keystroke"),e.changeSearchParam("searchField","Keystroke")),b(0,a,n)}}),[e.value,e.index]),Object(v.jsxs)($t.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(v.jsx)($t.a,{item:!0,xs:6,children:Object(v.jsx)(w,{placeholder:"Search...",value:i,onChange:function(t,a,n){c(a),e.changeSearchParam("search",a)},onEnter:b,name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:b,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(v.jsxs)($t.a,{item:!0,xs:6,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search Keylog's"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"file_component",name:"searchField",value:s,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:u.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchopt"+e)}))})})]})]})},Zh=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState("Keystroke"),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Object(A.a)(I),y=function(e){q.dismiss(),d(e.keylog_aggregate.aggregate.count),i(e.keylog)},_=Object(St.a)(Bh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),k=Object(j.a)(_,1)[0],w=Object(St.a)(zh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),C=Object(j.a)(w,1)[0],S=Object(St.a)(Wh,{fetchPolicy:"no-cache",onCompleted:function(e){q.dismiss(),0===e.keylog_aggregate.aggregate.count?q.info("No Results"):q.success("Showing One Entry for Each Unique User"),d(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),D=Object(j.a)(S,1)[0],$=Object(St.a)(Hh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),T=Object(j.a)($,1)[0],P=Object(St.a)(Mh,{fetchPolicy:"no-cache",onCompleted:function(e){q.dismiss(),0===e.keylog_aggregate.aggregate.count?q.info("No Results"):q.success("Showing One Entry for Each Unique Program"),d(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),E=Object(j.a)(P,1)[0],F=Object(St.a)(Uh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),L=Object(j.a)(F,1)[0],N=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),k({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Rh,keylog:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t),""===t?D({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Rh,user:"%_%"}}):C({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Rh,user:"%"+t+"%"}})},B=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t),""===t?E({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Rh,program:"%_%"}}):T({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Rh,program:"%"+t+"%"}})},W=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),L({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Rh,host:"%"+n+"%"}})};return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)(Yh,{onChangeSearchField:function(e){x(e),i([])},onKeylogSearch:N,value:e.value,index:e.index,onUserSearch:R,onProgramSearch:B,onHostSearch:W,changeSearchParam:e.changeSearchParam}),Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.length>0?Object(v.jsx)(qh,{keylogs:n}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(s/Rh),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(O){case"Keystroke":N({search:p,offset:0});break;case"User":R({search:p,offset:0});break;case"Program":B({search:p,offset:0});break;case"Host":W({search:p,offset:0})}else switch(O){case"Keystroke":N({search:p,offset:(t-1)*Rh});break;case"User":R({search:p,offset:(t-1)*Rh});break;case"Program":B({search:p,offset:(t-1)*Rh});break;case"Host":W({search:p,offset:(t-1)*Rh})}},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",s]})]})]}))},Xh=Object(Pe.a)(Gh||(Gh=Object(B.a)(["\nmutation updateComment ($token_id: Int!, $description: String) {\n  update_token_by_pk(pk_columns: {id: $token_id}, _set: {description: $description}) {\n    description\n    id\n  }\n}\n"]))),em=Object(Pe.a)(Kh||(Kh=Object(B.a)(["\nquery getCommentQuery ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    description\n    id\n  }\n}\n"])));function tm(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(Ae.a)(em,{variables:{token_id:e.token_id},onCompleted:function(e){i(e.token_by_pk.description)},fetchPolicy:"network-only"});var c=Object(Ee.a)(Xh,{onCompleted:function(t){console.log("udpated"),e.onClose()},onError:function(t){console.error(t),e.onClose()}}),r=Object(j.a)(c,1)[0],o=function(){r({variables:{token_id:e.token_id,description:n}})};return Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Edit Token Description"}),Object(v.jsx)(le.a,{dividers:!0,children:Object(v.jsx)(w,{autoFocus:!0,onEnter:o,onChange:function(e,t,a){i(t)},value:n})}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:o,variant:"contained",color:"secondary",children:"Submit"})]})]})}var am,nm,im,cm,rm,om=Object(Pe.a)(Qh||(Qh=Object(B.a)(["\nmutation updateCredentialDeletedMutation($token_id: Int!, $deleted: Boolean!){\n    update_token_by_pk(pk_columns: {id: $token_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n    }\n}\n"]))),sm=Object(Pe.a)(Jh||(Jh=Object(B.a)(["\nmutation updateCallbacksOfDeletedTokenMutation($token_id: Int!, $deleted: Boolean!){\n    update_callbacktoken(where: {token_id: {_eq: $token_id}}, _set: {deleted: $deleted}) {\n        affected_rows\n    }\n}\n"])));function lm(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(s.useEffect)((function(){i(Object(R.a)(e.tokens))}),[e.credentials]);var c=function(e){var t=e.id,a=e.deleted,c=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{deleted:a}):Object(o.a)({},e)}));i(c)};return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Delete"}),Object(v.jsx)(H.a,{children:"User"}),Object(v.jsx)(H.a,{children:"Groups"}),Object(v.jsx)(H.a,{children:"TokenId"}),Object(v.jsx)(H.a,{children:"Logon Session"}),Object(v.jsx)(H.a,{children:"Description"}),Object(v.jsx)(H.a,{children:"Task"}),Object(v.jsx)(H.a,{children:"Callbacks With Handles"}),Object(v.jsx)(H.a,{children:"Host"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(dm,Object(o.a)({onEditDeleted:c},e),"cred"+e.id)}))})]})})}function dm(e){Object(A.a)(I);var t=Object(ve.a)(),a=l.a.useState(!1),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState(!1),o=Object(j.a)(r,2),s=o[0],d=o[1],u=l.a.useState(!1),b=Object(j.a)(u,2),p=b[0],h=b[1],m=Object(Ee.a)(sm,{onCompleted:function(e){q.success("Removed token from callback")},onError:function(e){q.error("Operation not allowed")}}),f=Object(j.a)(m,1)[0],O=Object(Ee.a)(om,{onCompleted:function(t){q.success("Updated deleted status"),null===e.callbacktokens||e.deleted||f({variables:{token_id:e.id,deleted:!0}}),e.onEditDeleted(t.update_token_by_pk)},onError:function(e){q.error("Operation not allowed")}}),x=Object(j.a)(O,1)[0];return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(Ia,{onClose:function(){c(!1)},onSubmit:function(){x({variables:{token_id:e.id,deleted:!e.deleted}})},open:i,acceptText:e.deleted?"Restore":"Remove"}),Object(v.jsxs)(H.a,{children:[e.deleted?Object(v.jsx)(Kc.a,{title:"Restore Token for use in Tasking",children:Object(v.jsx)(Y.a,{size:"small",onClick:function(){c(!0)},style:{color:t.palette.success.main},variant:"contained",children:Object(v.jsx)(bh.a,{})})}):Object(v.jsx)(Kc.a,{title:"Delete Token so it can't be used in Tasking",children:Object(v.jsx)(Y.a,{size:"small",onClick:function(){c(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})})})," "]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.User})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.Groups})}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.TokenId}),Object(v.jsx)(Kc.a,{title:"View Token Information",children:Object(v.jsx)(Y.a,{size:"small",color:"primary",onClick:function(){d(!0)},children:Object(v.jsx)(cl.a,{})})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:s,onClose:function(){d(!1)},innerDialog:Object(v.jsx)(sl,{token_id:e.id,onClose:function(){d(!1)}})})]}),Object(v.jsx)(H.a,{children:null===e.logonsession?Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:"No Logon Session Data"}):Object(v.jsxs)(l.a.Fragment,{children:[e.logonsession.LogonId," ",null!==e.logonsession.LogonType?" ("+e.logonsession.LogonType+")":null]})}),Object(v.jsxs)(H.a,{children:[Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description}),Object(v.jsx)(Y.a,{onClick:function(){return h(!0)},size:"small",children:Object(v.jsx)(Ai.a,{})}),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){h(!1)},innerDialog:Object(v.jsx)(tm,{token_id:e.id,onClose:function(){h(!1)}})})]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(v.jsx)(H.a,{children:null===e.callbacktokens?null:e.callbacktokens.map((function(e){return e.callback_id}))}),Object(v.jsx)(H.a,{children:e.host})]})})}var um=Object(Pe.a)(am||(am=Object(B.a)(["\nfragment tokenData on token{\n    id\n    User\n    Groups\n    TokenId\n    logonsession {\n        LogonType\n        UserName\n        LogonDomain\n        id\n        LogonId\n        authenticationpackages(where: {deleted: {_eq: false}}) {\n            Name\n            id\n        }\n    }\n    task {\n        id\n    }\n    host\n    deleted\n    description\n    callbacktokens(where: {deleted: {_eq: false}}) {\n        callback_id\n        id\n    }\n}\n"]))),bm=20,jm=Object(Pe.a)(nm||(nm=Object(B.a)(["\n","\nquery usergroupQuery($operation_id: Int!, $name: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      ...tokenData\n    }\n}\n"])),um),pm=Object(Pe.a)(im||(im=Object(B.a)(["\n","\nquery sidQuery($operation_id: Int!, $sid: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      ...tokenData\n    }\n}\n"])),um),hm=Object(Pe.a)(cm||(cm=Object(B.a)(["\n","\nquery logontypeQuery($operation_id: Int!, $logontype: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n  }\n"])),um),mm=Object(Pe.a)(rm||(rm=Object(B.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n}\n"])),um);function fm(e){return Object(v.jsx)(Xr,Object(o.a)({label:"Tokens",iconComponent:Object(v.jsx)(cl.a,{})},e))}var Om,xm,gm,ym,_m,vm,km=function(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("User/Group"),o=Object(j.a)(r,2),s=o[0],d=o[1],u=["User/Group","SID","LogonType","Host"],b=function(t,a,n){var c=a||i;switch(n||s){case"User/Group":e.onUserGroupSearch({search:c,offset:0});break;case"SID":e.onSIDSearch({search:c,offset:0});break;case"LogonType":e.onLogonTypeSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0})}};return l.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User/Group";t.has("search")&&(c(t.get("search")),a=t.get("search")),t.has("searchField")&&u.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User/Group"),e.onChangeSearchField("User/Group"),e.changeSearchParam("searchField","User/Group")),b(0,a,n)}}),[e.value,e.index]),Object(v.jsxs)($t.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(v.jsx)($t.a,{item:!0,xs:6,children:Object(v.jsx)(w,{placeholder:"Search...",value:i,onChange:function(t,a,n){c(a),e.changeSearchParam("search",a)},onEnter:b,name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:b,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(v.jsxs)($t.a,{item:!0,xs:6,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search Tokens by"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"file_component",name:"searchField",value:s,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:u.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchopt"+e)}))})})]})]})},wm=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState("User/Group"),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Object(A.a)(I),y=function(e){q.dismiss(),d(e.token_aggregate.aggregate.count),i(e.token)},_=Object(St.a)(jm,{fetchPolicy:"network-only",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),k=Object(j.a)(_,1)[0],w=Object(St.a)(pm,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),C=Object(j.a)(w,1)[0],S=Object(St.a)(hm,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),D=Object(j.a)(S,1)[0],$=Object(St.a)(mm,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),T=Object(j.a)($,1)[0],P=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),k({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:bm,name:"%"+n+"%"}})},E=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:bm,logontype:"%"+n+"%"}})},F=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:bm,host:"%"+n+"%"}})},L=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),C({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:bm,sid:"%"+n+"%"}})};return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)(km,{onChangeSearchField:function(e){x(e),i([])},onUserGroupSearch:P,value:e.value,index:e.index,onLogonTypeSearch:E,onHostSearch:F,onSIDSearch:L,changeSearchParam:e.changeSearchParam}),Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.length>0?Object(v.jsx)(lm,{tokens:n}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(s/bm),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(O){case"User/Group":P({search:p,offset:0});break;case"SID":L({search:p,offset:0});break;case"LogonType":E({search:p,offset:0});break;case"Host":F({search:p,offset:0})}else switch(O){case"User/Group":P({search:p,offset:(t-1)*bm});break;case"SID":L({search:p,offset:(t-1)*bm});break;case"LogonType":E({search:p,offset:(t-1)*bm});break;case"Host":F({search:p,offset:(t-1)*bm})}},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",s]})]})]}))},Cm=a(216),Sm=a.n(Cm);function Dm(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(s.useEffect)((function(){i(Object(R.a)(e.callbacks))}),[e.callbacks]);var c=function(e){var t=e.id,a=e.active,c=n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{active:a}):Object(o.a)({},e)}));i(c)};return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Hide"}),Object(v.jsx)(H.a,{children:"User"}),Object(v.jsx)(H.a,{children:"Domain"}),Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:"Description"}),Object(v.jsx)(H.a,{children:"IP"}),Object(v.jsx)(H.a,{children:"Process Name"}),Object(v.jsx)(H.a,{children:"ID"}),Object(v.jsx)(H.a,{children:"Checkin Times"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(Im,Object(o.a)({onEditDeleted:c},e),"cred"+e.id)}))})]})})}function Im(e){var t=Object(A.a)(I),a=Object(ve.a)(),n=l.a.useState(!1),i=Object(j.a)(n,2),c=i[0],r=i[1],o=Object(Ee.a)(Vb,{onCompleted:function(t){q.success("Updated active status"),e.onEditDeleted({id:e.id,active:!e.active})},onError:function(e){q.error("Operation not allowed")}}),s=Object(j.a)(o,1)[0];return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(Ia,{onClose:function(){r(!1)},onSubmit:function(){s({variables:{callback_id:e.id,active:!e.active}})},open:c,acceptText:e.active?"Hide":"Restore"}),Object(v.jsxs)(H.a,{children:[e.active?Object(v.jsx)(Kc.a,{title:"Hide Callback so it can't be used in Tasking",children:Object(v.jsx)(Y.a,{size:"small",onClick:function(){r(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})})}):Object(v.jsx)(Kc.a,{title:"Restore Callback for Tasking",children:Object(v.jsx)(Y.a,{size:"small",onClick:function(){r(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(v.jsx)(bh.a,{})})})," "]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(v.jsx)(H.a,{children:e.host}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(v.jsx)(H.a,{children:e.ip}),Object(v.jsx)(H.a,{children:e.process_name}),Object(v.jsx)(H.a,{children:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})}),Object(v.jsxs)(H.a,{children:[Object(v.jsxs)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Initial: ",xe(e.init_callback,t.user.view_utc_time)]}),Object(v.jsxs)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Latest: ",xe(e.last_checkin,t.user.view_utc_time)]})]})]})})}var $m=Object(Pe.a)(Om||(Om=Object(B.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n}\n"]))),Tm=20,Pm=Object(Pe.a)(xm||(xm=Object(B.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      ...callbackData\n    }\n}\n"])),$m),Am=Object(Pe.a)(gm||(gm=Object(B.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),$m),Em=Object(Pe.a)(ym||(ym=Object(B.a)(["\n","\nquery domainQuery($operation_id: Int!, $domain: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),$m),Fm=Object(Pe.a)(_m||(_m=Object(B.a)(["\n","\nquery domainQuery($operation_id: Int!, $description: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),$m),Lm=Object(Pe.a)(vm||(vm=Object(B.a)(["\n","\nquery domainQuery($operation_id: Int!, $ip: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),$m);function qm(e){return Object(v.jsx)(Xr,Object(o.a)({label:"Callbacks",iconComponent:Object(v.jsx)(Sm.a,{})},e))}var Nm,Rm,Bm,Wm,zm,Hm,Mm,Um=function(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("User"),o=Object(j.a)(r,2),s=o[0],d=o[1],u=["User","Domain","Host","Description","IP"],b=function(t,a,n){var c=a||i;switch(n||s){case"User":e.onUserSearch({search:c,offset:0});break;case"Domain":e.onDomainSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0});break;case"Description":e.onDescriptionSearch({search:c,offset:0});break;case"IP":e.onIPSearch({search:c,offset:0})}};return l.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User";t.has("search")&&(c(t.get("search")),a=t.get("search")),console.log(t.get("searchField")),t.has("searchField")&&u.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User"),e.onChangeSearchField("User"),e.changeSearchParam("searchField","User")),b(0,a,n)}}),[e.value,e.index]),Object(v.jsxs)($t.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(v.jsx)($t.a,{item:!0,xs:6,children:Object(v.jsx)(w,{placeholder:"Search...",value:i,onChange:function(t,a,n){c(a),e.changeSearchParam("search",a)},onEnter:b,name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:b,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(v.jsxs)($t.a,{item:!0,xs:6,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search Callbacks by"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"file_component",name:"searchField",value:s,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:u.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchopt"+e)}))})})]})]})},Vm=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState("User"),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Object(A.a)(I),y=function(e){q.dismiss(),d(e.callback_aggregate.aggregate.count),i(e.callback)},_=Object(St.a)(Pm,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),k=Object(j.a)(_,1)[0],w=Object(St.a)(Em,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),C=Object(j.a)(w,1)[0],S=Object(St.a)(Fm,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),D=Object(j.a)(S,1)[0],$=Object(St.a)(Am,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),T=Object(j.a)($,1)[0],P=Object(St.a)(Lm,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),E=Object(j.a)(P,1)[0],F=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),k({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Tm,user:"%"+n+"%"}})},L=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),C({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Tm,domain:"%"+n+"%"}})},N=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Tm,host:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Tm,description:"%"+n+"%"}})},B=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Tm,ip:"%"+n+"%"}})};return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)(Um,{onChangeSearchField:function(e){x(e),i([])},onUserSearch:F,onIPSearch:B,value:e.value,index:e.index,onDomainSearch:L,onHostSearch:N,onDescriptionSearch:R,changeSearchParam:e.changeSearchParam}),Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.length>0?Object(v.jsx)(Dm,{callbacks:n}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(s/Tm),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(O){case"User":F({search:p,offset:0});break;case"Domain":L({search:p,offset:0});break;case"Description":R({search:p,offset:0});break;case"Host":N({search:p,offset:0});break;case"IP":B({search:p,offset:0})}else switch(O){case"User":F({search:p,offset:(t-1)*Tm});break;case"Domain":L({search:p,offset:(t-1)*Tm});break;case"Description":R({search:p,offset:(t-1)*Tm});break;case"Host":N({search:p,offset:(t-1)*Tm});break;case"IP":B({search:p,offset:(t-1)*Tm})}},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",s]})]})]}))},Gm=a(282),Km=a.n(Gm);function Qm(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];return Object(s.useEffect)((function(){i(Object(R.a)(e.artifacts))}),[e.artifacts]),Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Type"}),Object(v.jsx)(H.a,{children:"Command"}),Object(v.jsx)(H.a,{children:"Task"}),Object(v.jsx)(H.a,{children:"Callback"}),Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:"Artifact"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(Jm,Object(o.a)({},e),"cred"+e.id)}))})]})})}function Jm(e){return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.artifact.name})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.task.callback_id,children:e.task.callback_id})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.host})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.artifact_instance_text})})]})})}var Ym=Object(Pe.a)(Nm||(Nm=Object(B.a)(["\nfragment artifactData on taskartifact{\n    id\n    artifact_instance_text\n    host\n    id\n    timestamp\n    artifact {\n        name\n        description\n    }\n    task {\n        id\n        callback_id\n        command {\n            cmd\n        }\n    }\n}\n"]))),Zm=20,Xm=Object(Pe.a)(Rm||(Rm=Object(B.a)(["\n","\nquery artifactQuery($operation_id: Int!, $artifact: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      ...artifactData\n    }\n}\n"])),Ym),ef=Object(Pe.a)(Bm||(Bm=Object(B.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Ym),tf=Object(Pe.a)(Wm||(Wm=Object(B.a)(["\n","\nquery commandQuery($operation_id: Int!, $command: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Ym),af=Object(Pe.a)(zm||(zm=Object(B.a)(["\n","\nquery typeQuery($operation_id: Int!, $type: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Ym),nf=Object(Pe.a)(Hm||(Hm=Object(B.a)(["\n","\nquery taskQuery($operation_id: Int!, $task_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Ym),cf=Object(Pe.a)(Mm||(Mm=Object(B.a)(["\n","\nquery taskQuery($operation_id: Int!, $callback_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Ym);function rf(e){return Object(v.jsx)(Xr,Object(o.a)({label:"Artifacts",iconComponent:Object(v.jsx)(Km.a,{})},e))}var of,sf,lf,df=function(e){var t=Object(ve.a)(),a=l.a.useState(""),n=Object(j.a)(a,2),i=n[0],c=n[1],r=l.a.useState("Artifact"),o=Object(j.a)(r,2),s=o[0],d=o[1],u=["Artifact","Command","Host","Type","Task","Callback"],b=function(t,a,n){var c=a||i;switch(n||s){case"Artifact":e.onArtifactSearch({search:c,offset:0});break;case"Command":e.onCommandSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0});break;case"Type":e.onTypeSearch({search:c,offset:0});break;case"Task":e.onTaskSearch({search:c,offset:0});break;case"Callback":e.onCallbackSearch({search:c,offset:0})}};return l.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Artifact";t.has("search")&&(c(t.get("search")),a=t.get("search")),t.has("searchField")&&u.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Artifact"),e.onChangeSearchField("Artifact"),e.changeSearchParam("searchField","Artifact")),b(0,a,n)}}),[e.value,e.index]),Object(v.jsxs)($t.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(v.jsx)($t.a,{item:!0,xs:6,children:Object(v.jsx)(w,{placeholder:"Search...",value:i,onChange:function(t,a,n){c(a),e.changeSearchParam("search",a)},onEnter:b,name:"Search...",InputProps:{endAdornment:Object(v.jsx)(l.a.Fragment,{children:Object(v.jsx)(Kc.a,{title:"Search",children:Object(v.jsx)(Y.a,{onClick:b,children:Object(v.jsx)(ms.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(v.jsxs)($t.a,{item:!0,xs:6,children:[Object(v.jsx)(Mj.a,{component:"legend",children:"Search Artifacts by"}),Object(v.jsx)(Dt.a,{component:"fieldset",children:Object(v.jsx)(Hj.a,{row:!0,"aria-label":"file_component",name:"searchField",value:s,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:u.map((function(e){return Object(v.jsx)(Ma.a,{value:e,control:Object(v.jsx)(zj.a,{}),label:e},"searchopt"+e)}))})})]})]})},uf=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),s=r[0],d=r[1],u=l.a.useState(""),b=Object(j.a)(u,2),p=b[0],h=b[1],m=l.a.useState("Artifact"),f=Object(j.a)(m,2),O=f[0],x=f[1],g=Object(A.a)(I),y=function(e){q.dismiss(),d(e.taskartifact_aggregate.aggregate.count),i(e.taskartifact)},_=Object(St.a)(Xm,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),k=Object(j.a)(_,1)[0],w=Object(St.a)(tf,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),C=Object(j.a)(w,1)[0],S=Object(St.a)(af,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),D=Object(j.a)(S,1)[0],$=Object(St.a)(ef,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),T=Object(j.a)($,1)[0],P=Object(St.a)(nf,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),E=Object(j.a)(P,1)[0],F=Object(St.a)(cf,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){q.error("Failed to fetch data for search"),console.log(e)}}),L=Object(j.a)(F,1)[0],N=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),k({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Zm,artifact:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),C({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Zm,command:"%"+n+"%"}})},B=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Zm,host:"%"+n+"%"}})},W=function(e){var t=e.search,a=e.offset;q.info("Searching...",{persist:!0}),h(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Zm,type:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;""!==t?(q.info("Searching...",{persist:!0}),h(t),E({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Zm,task_id:parseInt(t)}})):q.warning("Must specify a task number")},H=function(e){var t=e.search,a=e.offset;""!==t?(q.info("Searching...",{persist:!0}),h(t),L({variables:{operation_id:g.user.current_operation_id,offset:a,fetchLimit:Zm,callback_id:t}})):q.warning("Must specify a callback number")};return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)(df,{onChangeSearchField:function(e){x(e),i([])},onArtifactSearch:N,onTaskSearch:z,value:e.value,index:e.index,onCommandSearch:R,onHostSearch:B,onTypeSearch:W,onCallbackSearch:H,changeSearchParam:e.changeSearchParam}),Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.length>0?Object(v.jsx)(Qm,{artifacts:n}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(s/Zm),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(O){case"Artifact":N({search:p,offset:0});break;case"Command":R({search:p,offset:0});break;case"Type":W({search:p,offset:0});break;case"Host":B({search:p,offset:0});break;case"Task":z({search:p,offset:0});break;case"Callback":H({search:p,offset:0})}else switch(O){case"Artifact":N({search:p,offset:(t-1)*Zm});break;case"Command":R({search:p,offset:(t-1)*Zm});break;case"Type":W({search:p,offset:(t-1)*Zm});break;case"Host":B({search:p,offset:(t-1)*Zm});break;case"Task":z({search:p,offset:(t-1)*Zm});break;case"Callback":H({search:p,offset:(t-1)*Zm})}},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",s]})]})]}))},bf=Object(Pe.a)(of||(of=Object(B.a)(["\nmutation StopSocksMutation($callback_id: Int!){\n    stop_socks(callback_id: $callback_id){\n        status\n        error\n    }\n}\n"])));function jf(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1];Object(s.useEffect)((function(){i(Object(R.a)(e.callbacks))}),[e.callbacks]);var c=function(e){var t=e.id,a=(e.active,n.map((function(e){return e.id===t?Object(o.a)(Object(o.a)({},e),{},{port:null}):Object(o.a)({},e)})));i(a)};return Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(v.jsxs)(W.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{style:{width:"5rem"},children:"Stop"}),Object(v.jsx)(H.a,{children:"User"}),Object(v.jsx)(H.a,{children:"Domain"}),Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:"Description"}),Object(v.jsx)(H.a,{children:"ID"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsx)(pf,Object(o.a)({onEditDeleted:c},e),"cred"+e.id)}))})]})})}function pf(e){Object(A.a)(I);var t=Object(ve.a)(),a=l.a.useState(!1),n=Object(j.a)(a,2),i=n[0],c=n[1],r=Object(Ee.a)(bf,{onCompleted:function(t){q.success("Stopped Socks on that Port"),e.onEditDeleted({id:e.id})},onError:function(e){q.error("Operation not allowed")}}),o=Object(j.a)(r,1)[0];return Object(v.jsx)(l.a.Fragment,{children:Object(v.jsxs)(V.a,{hover:!0,children:[Object(v.jsx)(Ia,{onClose:function(){c(!1)},onSubmit:function(){o({variables:{callback_id:e.id}})},open:i,acceptText:"Stop Socks"}),Object(v.jsxs)(H.a,{children:[e.port?Object(v.jsx)(Kc.a,{title:"Stop Socks Port on Mythic Server",children:Object(v.jsx)(Y.a,{size:"small",onClick:function(){c(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(v.jsx)(ie.a,{})})}):null," "]}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(v.jsx)(H.a,{children:e.host}),Object(v.jsx)(H.a,{children:Object(v.jsx)(Z.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(v.jsx)(H.a,{children:Object(v.jsx)(hd.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})})]})})}var hf=Object(Pe.a)(sf||(sf=Object(B.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n    port\n}\n"]))),mf=Object(Pe.a)(lf||(lf=Object(B.a)(["\n","\nquery userQuery($operation_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      ...callbackData\n    }\n}\n"])),hf);function ff(e){return Object(v.jsx)(Xr,Object(o.a)({label:"SOCKS",iconComponent:Object(v.jsx)(ea.a,{icon:ta.i,size:"lg"})},e))}var Of=function(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=l.a.useState(0),r=Object(j.a)(c,2),d=r[0],u=r[1],b=Object(A.a)(I),p=Object(St.a)(mf,{fetchPolicy:"network-only",onCompleted:function(e){q.dismiss(),0===e.callback_aggregate.aggregate.count&&q.info("No Socks Running"),u(e.callback_aggregate.aggregate.count),i(e.callback)},onError:function(e){q.error("Failed to fetch data for socks"),console.log(e)}}),h=Object(j.a)(p,1)[0];Object(s.useEffect)((function(){e.value===e.index&&h({variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}})}),[e.value,e.index]);return Object(v.jsxs)(Jr,Object(o.a)(Object(o.a)({},e),{},{children:[Object(v.jsx)("div",{style:{overflow:"auto",height:"calc(78vh)",background:"transparent"},children:n.length>0?Object(v.jsx)(jf,{callbacks:n}):Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(v.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(v.jsx)(fl.a,{count:Math.ceil(d/20),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){h(1===t?{variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}}:{variables:{offset:20*(t-1),operation_id:b.user.current_operation_id,fetchLimit:20}})},showFirstButton:!0,showLastButton:!0}),Object(v.jsxs)(Z.a,{style:{paddingLeft:"10px"},children:["Total Results: ",d]})]})]}))},xf=Object(h.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function gf(e){var t=xf(),a=["callbacks","tasks","files","credentials","keylogs","artifacts","tokens","socks"],n=new URLSearchParams(window.location.search),i=n.get("tab"),c=a.findIndex((function(e){return e===i})),r=-1===c?0:c,o=function(t,a){n.set(t,a);var i=window.location.pathname+"?"+n.toString();e.history.push(i)};return Object(v.jsxs)("div",{className:t.root,style:{height:"100%"},children:[Object(v.jsx)(vd.a,{position:"static",color:"default",children:Object(v.jsx)(kd.a,{value:r,onChange:function(t,i){n.set("tab",a[i]);var c=window.location.pathname+"?"+n.toString();e.history.push(c)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e){case"tasks":return Object(v.jsx)(Qj,{},"taskstab");case"files":return Object(v.jsx)(Qp,{},"filestab");case"credentials":return Object(v.jsx)(Sh,{},"credentialstab");case"keylogs":return Object(v.jsx)(Vh,{},"keylogstab");case"tokens":return Object(v.jsx)(fm,{},"tokenstab");case"callbacks":return Object(v.jsx)(qm,{},"callbackstab");case"artifacts":return Object(v.jsx)(rf,{},"artifactstab");case"socks":return Object(v.jsx)(ff,{},"sockstab");default:return null}}))})}),a.map((function(e,t){switch(e){case"tasks":return Object(v.jsx)(ep,{index:t,value:r,changeSearchParam:o},"taskspanel");case"callbacks":return Object(v.jsx)(Vm,{index:t,value:r,changeSearchParam:o},"callbackspanel");case"files":return Object(v.jsx)(sh,{index:t,value:r,changeSearchParam:o},"filespanel");case"credentials":return Object(v.jsx)(Lh,{index:t,value:r,changeSearchParam:o},"credentialspanel");case"keylogs":return Object(v.jsx)(Zh,{index:t,value:r,changeSearchParam:o},"keylogspanel");case"tokens":return Object(v.jsx)(wm,{index:t,value:r,changeSearchParam:o},"tokenspanel");case"artifacts":return Object(v.jsx)(uf,{index:t,value:r,changeSearchParam:o},"artifactspanel");case"socks":return Object(v.jsx)(Of,{index:t,value:r,changeSearchParam:o},"sockspanel");default:return null}}))]})}var yf,_f,vf=a(469),kf=a.n(vf),wf=a(471),Cf=a.n(wf),Sf=a(40),Df=a(883),If=a(473),$f=a.n(If),Tf=a(474),Pf=a.n(Tf),Af=a(477),Ef=a.n(Af),Ff=a(468),Lf=a.n(Ff),qf=Object(Pe.a)(yf||(yf=Object(B.a)(['\nsubscription MySubscription($operation_id: Int!) {\n  operationeventlog_aggregate(where: {deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}, operation_id: {_eq: $operation_id}}) {\n    aggregate{\n        count\n    }\n  }\n}\n '])));function Nf(e){var t=Object(A.a)(I),a=Object(nt.a)(qf,{variables:{operation_id:t.user.current_operation_id},onError:function(e){q.error("Mythic encountered an error getting event log messages: "+e.toString()),console.error(e)}}),n=a.loading,i=a.error,c=a.data;return Object(v.jsx)(Y.a,{color:"inherit",component:Sf.b,to:"/new/EventFeed",style:{float:"right"},children:Object(v.jsx)(Kc.a,{title:"Event Feed",children:n?Object(v.jsx)(Qe.a,{color:"secondary",badgeContent:0,children:Object(v.jsx)(ga.a,{size:20,thickness:4})}):i?Object(v.jsx)(Qe.a,{color:"secondary",badgeContent:0,children:Object(v.jsx)(Bd.a,{})}):Object(v.jsx)(Qe.a,{badgeContent:c.operationeventlog_aggregate.aggregate.count,color:"error",children:Object(v.jsx)(Lf.a,{})})})})}var Rf=Object(Pe.a)(_f||(_f=Object(B.a)(["\nsubscription EventFeedNotificationSubscription($fromNow: timestamp!, $operation_id: Int!) {\n  operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    operator {\n        username\n    }\n    message\n    level\n    resolved\n    source\n  }\n}\n "])));function Bf(e){var t=Object(A.a)(I),a=l.a.useRef((new Date).toISOString()),n=Object(nt.a)(Rf,{variables:{fromNow:a.current,operation_id:t.user&&t.user.current_operation_id?t.user.current_operation_id:0},fetchPolicy:"no-cache",onError:function(e){q.warning("Failed to get event notifications")}}),i=n.loading,c=n.error,r=n.data;return Object(s.useEffect)((function(){if(!i&&!c&&r&&r.operationeventlog.length>0){if("debug"===r.operationeventlog[0].source)return;if(r.operationeventlog[0].operator){var e=r.operationeventlog[0].operator.username+":"+r.operationeventlog[0].message;q.toast(e,r.operationeventlog[0].level,{autoHideDuration:2e3})}else r.operationeventlog[0].operator||q.toast(r.operationeventlog[0].message,r.operationeventlog[0].level,{autoHideDuration:3e3})}else c&&(console.error(c),q.warning("Mythic encountered an error getting operational event stream",{autoHideDuration:2e3}))}),[i,r,c,t.user]),null}var Wf,zf=a(472),Hf=a.n(zf),Mf=["title","titleId"];function Uf(){return(Uf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Vf(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Gf(e,t){var a=e.title,n=e.titleId,i=Vf(e,Mf);return s.createElement("svg",Uf({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"80px",height:"66px",viewBox:"0 0 80 66",enableBackground:"new 0 0 80 66",xmlSpace:"preserve",ref:t,"aria-labelledby":n},i),a?s.createElement("title",{id:n},a):null,Wf||(Wf=s.createElement("image",{id:"image0",width:80,height:66,x:0,y:0,href:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABCCAYAAADAD1E9AAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAA CXBIWXMAAC4jAAAuIwF4pT92AAAAAW9yTlQBz6J3mgAAJBNJREFUeNrtnHmUHFd97z+/e6uql9k0 I41leZG1L9MaLR7JeMMeYyDGduwQkCAsTgwBAu+FlxwekDxMmBDgASEJO4hgjDHbk4JZYgwOCRov eJ2xZNmjfbMlaxstM+qZ6e6quvf3/uhuebRhY3iBd05+59Q56pqqunW/97d+768E/4miYACGpl7e uobu4D9z7P/vRVluAY5mF08bjBa/sXquCuh/yfNIHTyAg+GS7xzkwlnV8/+lhc8rSlfYU9O0A/kL 7zxgFn2ier4Q/bbf7XdalOV2K7My9d/7sxfesd8s2vHbfq/fWVEQBaN0B6vguMnunNY9Ya9d+LMj LNbDLDyveu1/me5xqYLWFeo40AAGm5bOffaci3ueDReVR1ii+8LFy6rXd4W/7Xf+TYq82BsVzAYK QYGBuH5uX+OSdkp6nce/UZXLz/Vh9lni2Ib28inJuscGKETjr689R3rptt1AP0WhC+iHHOXj71Yi q130OwH/2wbsNyLjTVDB7GbhNbtN5x17pPPwEIt1iEVaYonukc6+vdklFwAMjAsaCrKG7mB8dH4h sqanJ/hdS31+JQ3U6vUi4Pc3LjwrHeNt6vWmHGaOBUooIVARBZF/ONevf6+AKl2h0J8ArGK5hdWs AAewna4WE7rpQVJucRe0WX/eBGu2Hw79YGmSd36yNAexP7ZrZ5mhRzrhAEAfhEsh+W2D9ysBWAMP Ad1tFv13VD8xQU1+VDwV1ThCokCEEvoLCXjP+cn6R6qT7QqX1sBbQ3dwFb0pwC4KV3kx7wKutNAe KkhgIGOQksd6xTSFaPEw/mVLqPz+1aPp/Q9/K7jzm399PhxRsFJbhN+mvGBz6KXbCugus+CjE735 nKrmD5OOOvU0Y6IK/omK6vKpuv7y85P1j/TV8r86eFoDby9d+e0s+E4W+/NmNa8V1fZUNRlD47HU VcZG48qId/EwPj5ajpOj5NLhzXvidPBwvmXm9LeXmb1he/PiZQKu7gL01/Dlv668oIHrJvi07Xxb m7dfOURaUbBt2GCoQbaLas8Fo098sz6ZfrqCOnDwnOZtZUm7Ibl/EsHcQdIUiDNIPotBzfHBSNRT RknRVCIxuTg2whZSzqOx+SyOHCsPuabGWfOLjx7eyqzMbLZVlOVWWP2frpHPC2B98jsyC+dK7DcC qCp5sVLJysenjq37XyKidaChPxXQ58DHCHilx2yVf3m8Te2iI+JGUc23iJWi1S14fiBnZTdp6kI9 VFmkxlys6MImNYFTT7k1+JYsPP9bfvMB44+OfURSzm6ZZGadfWD96IkLjYwf+7cuCtJTM/MdsuCe QRbpNhZU9ppFurPpwpufu64rPJMZ1VmXrRT+6QiLdAuF0S0U9GnTqTsaF3/gTGNvb148e1O28+NH 7GLdYhb8z/r5TZMv/Ket4YI3AwxQmLqBwhc2NSz6+ObswpcC9PwuRem+WtK7LVh4zT4W6nYWlA/K It3VvOSWKiizMr/shesVyWY6522Rgm6Wgm6mkOwxC3VH24Vvq183QCGqH30nJdobmxf97SYpPACw feKSl+9vvPQsgIEZl099SjqKu8JO3di4uGdT2+Lle+ma9DsFYj3n2ioL7nmWTt3JAt1mFmw4+e91 TT25jKuDsZnCP+6nUzfSMbKPTt2WXXh7DeDodLxgD5itzMrUtXqDLfzrQKYwa0O285Ynmxa+9cnc gtdtiTp1gyns2XPRqydubl68bHtr19QXMT8Zf/CbDEZ1IDZGnZ1bqWrOflmo28NFNwPsZ2FDzxlW evx5BdlIx+btFHSADt0khXR38+LZ1b/98rKuvgADYcdLNuYXXf8Ec6c/aToOPSnzKxuY//XdXJJ7 bpyeX6p1PWBWgV1Dd1BN4k8PloKpJ/m/VnQfKFQrhy3M/fABWaibpaO0Sxbo5uzCnj44PvE1EAxA 4+Y53ZM2ZDqv3RIWFsNzlccG5s8eoCMZYL7bSUE30HHfySD/Mjm58lAwe+nKP/f7zGDUF6HvDAv1 4HmX5B5h3sRHmDdxgELbzmnd2ZPH6nueRT4tK6IgDAwkAH5ay42lXWMoGpbw2ljmQy5a8JaBOL5D 2dIVdHbPwphs8MT+c72VYmB4KcAww7UcTc4OIYghthBJ3m5iDK6ny/bQ/7y1bTWCVyP5quPJc//Y GrqDQXpVaon5ybIKbDvdspTe4+nU2sz82b4iL1H0EkQWsnf4AjCNoJTwWnrm4EifdGxDdU2M/lDY 9CT0+/HFwAsCcBtEs6GygRnvyux6dOEY850iFuBYoC6K/fmNmP9lP/RRSoeOkP3xQwwhX2+8qPld 5z/0UEnB9DM5hT14vEUsioIKkglSxl6I7p0IIsAKcArytyBXnQG46thdtjrhXvronCe41yFc52IW N2FCCySqxKr46psBYL22RZipFnnZEP7vHqXjRyn2lqX0P6lg/hboOYnQOAXAu2uJ6Tq4KnPx7C/o K9+Cfn616JESBAEYbJljLlnW4YIjR71+YVV2FL7cwe538lDVpITetK/mQ02YGY7TFFVjYoRkKJn3 q8F3CpjKaXK9VSy3BTZYYSCGfv9YtnMGcfpRfLqiCWNSVUoow6QJ1TpaaxScqdm/JiK+jFcgEIga kRtGSG54SOa+X/zmT9YXaDwrdIJ/6aMrvJZtlY0XXzPNEvzIXlggHhpK/ZHdRhsiNFU09hC0WPfY 7qj8uU9lHY1k58/+OMBOurN1k7qLfgeQJrolVd1nIBgh9SJctfGsiy5ZSn/SN86XvVhZxXK7ikK0 gtWuwEC8c1p39tGg8DdaTjY1efN6j5ohfFLEl1O0DBJkMPkmCRomSJBtMUHUZIKoSWymGZPLKnmn zjp8MkwapyitGnziQeatrFtDzzjcjjvfesWxc1p3dmTX/vUNE7KzR4eKibI9lFwnlBwgqvX7BLQp SBtHfDAm+qVO99S7+ugKu8ZVInXfsdYU/nmCmj89ihvLqeRLWdmdOWfC5YUdDzxTDQDdFtoVViug Z6omnks1lksvg9JNrzs+VmtXixup3ITz72lVc8GwOrwQA4KqzWFMJMIonlR0lyjrxcpmacscJLAV LSXZdLgyXY25osGbQuqVCpqAWpC0FRsdxX35Uja+cxXYOpskJ6vlelnwswliXj7kkwrGZHRyFvaV qKm8BAgpqtXJqCJCI1ZKefOWhaNP3DYAUQekdae/AtzazPzZPmaLKChUskimbGRII/sXS8vrbz8J JNNPlx1PqEKVVN1Bv19xEgPzaENhsa/ozeL1j5rUtMfqKYsm1YITm1djnYHE8pA1cqd4u6bt3IkD 03f1ls+k1Q9NWHKDK8afbnQ6fQSfUM064laCaNi4913qN/59XTlkfP24ziz4Uqs3f3aUtIKQUSPg PIhQu7Ai1uwUp/PGgehFMQGGtD37J0sG+2+vAlEt7usD9Zn572z19otHcV4hDiCbw1AUP+Atd0jG 3NMwjQ2FgRMZ69OZ7LRoYJ5TfaV4XW49lzRgGFVPIpoqOAGTVROGYigb32ubgg9dOPTkfeOf0wPm SroNQBNFKdKk3bRrnZAYKCyPDm/b8K9NFX1lUXwCahVMgCCBufDSZMPaPrpCqWvfOlP4YIPKh+uI SzVoplUwNGnTIFc0/quxYWZTylXH8CnPBSEHahujiNKE8FNLDva/F6q5YIGBuK6JjzD//S2Yj5fw JGgZkCwmkxXDsHg8bEN4SoSNzvKMzUdF3xSKJK7BHy5PUefniGcR6PwWrKQKIzivSCyIAQ2yGBNh GMFtiaz50IVu4Lt1wK6ny+6g3y8HXw8cp1kjuZtZ0bVsqwD0BvPXNKR0j+ITAW3ARGOi916hm7qp Kl9VHreF+yZ5+9JDmnhA1EilwUu2ukKWQevul8bodoYrX03QuGb+luPlnHpFtZXADgW6Jp+X1xaO DRwZoBB1MJD8bbXc8w/bwmvF+5Ut2LYxPDG+DKSo5jOIicQgVP2Jr/Hfte0+VCFBKaN4tCSI92g2 wtgMQoySivZbYz6/zHXcUdMm6TuJXnthwakQrWAg/llrV0s0PLrFes5KUAdKg1ibWr3m0nTTPdID pgf8PZMXNkw6lHwXxyvymEzJco9X/0P18jKLbgpasw+WRyrfbEpoq8fwSo2zq4FoVERRkiZMVDR6 UIxdflH65H09YK7s7jb0wlX0pvfT2RqZ+K+ccnMTtl2AMTwpJKjUCFg1PBfkaqmLqKICZDKIyWJI UcbQA8ZwV8bwjQvTjcdN9eSg9qvK3czKXMu2yr3ZjjfmK/rNojoH4hoxUQm980o2vUbG+yuAvuyC R9rLXHTUsnKxe+rP6g97WObfNV3D63aH6TZNOapKhOX8vJe2snpSUSe1vWEgjpRIBeJQ3n9JvPGT 9QkB1LXhfjpbA5vcgJcbVLnYIufka5h5OCHJNYBBUIFRPB7daYV7ReyPMy789yWsG6qbYB9dwa8D 3OnkP8y8J7NeFpTExxYiD8da1c0SqPqHHvBruruD/H0HNjRhZpu2aNm8Q2v7FMzaSUvO1lH33mwQ 3Fkqjqhe0LxY89kJfuOhkJxt0cTd3JhKc4xSEfWCGF+NxEGLWooTwh/lr+34k4Xf/vbRVSy3y4F+ dpgTWetCY0QyX61dKKrzVZmm0CyKVSERI8NGeVrEbLCGda1JZePsmp+q3t8dNFGUX9VUn0/q6d1/ BHM/0OTMR4bVJYqaPMYaeFU9jZHVYFaAe5h5X74gyL7j6Fm2q2Nv/+NrmJa9il3lxyZ3zogPlD9i zm18Xf7Z3SblELnJF1I+MPo/4saoRWO/xHudk00plPGeqlP3Cq7J2HCkyRzR4eTPL2fTt+vF/2ow M+gyL3bPdxXYo3SZVmb4Ff+P6Pw6gP/eWLgqGHU/r6gHiJvERono/wygntBV1T2g4c93+9Gj5mg4 E3j8KnaVH2TuNcmB5O6JjXkZfHYtlSuuTcy5Z8uR73xN7Dld/83tLeZEbIXArCkFvpRNZWkJ70As gjnmXWyH07YGCb51v86dL2z+YA+YD4GXWsVSX8QZdBmAIk06SK8uB10N0k63NFEUgHGR1EG/U/rN 8/Ub3kuv7/l1Nuaj6EC5NOaME+sF9YDzTDw+aI31EKE/wfPXd5eqjUH3h/O6bGp+Io2WweLGUst7 P5DNdnaEQfskBjMh/usr52TOX4rZPUqa+FkuY/51TP2wddLiRL1WXVekCBX1TCG65T4zL3uF3/Te 5RSiVXS4FayuVxSOGqCnSu8pZ/roCos01RiZ3ucFZxWFaAMD6YsBMvVxqIr1aFXbBNQgJ6xaTRPr u2oVAJNwW9BgGSk+XWm4/tU5n4nYc9MbaXjtm2n5g2vZ9/WVzuwbgYzxQcWHLnEXY2QP0FJTazXV 0u9QYvj5vqxuNTYaW1tcPKHAuiEYYBWFaDkDyQt1+mvoDu6l19f9XR9d4RAj8731BVWZJl5zABIE Ra9staFb//Lylh0ram0lK+kK3/ECfeUggwbAl3VBI4YRSV299giRA6clIusJ8H1m/jubvfniMeNi 9S60Myf6ePvDYphtHFtp/9+f4th9DxH/5HuYpgIUUwTURHanS/xUVAMDmEwwCPpgEvtA8ZNAQlWa xMjq5iVX9Czt/0qta6HK4dXfo5t2XQ20MygAWyjKPvpdXYP+LZh7maT6BkVeATq7QSy2FsXrK5Gg jOIrwGNi9BtPu6avv4P+pD7WmWixk4G+2859MOu4ZAxNQSWLsXmk+xQA65XJPZMXNmQOVjZHKudW 8GSNxfoK5UmN+LJ3QdcFNmybQGXHHtwTOyHMI6kqqkLGljVrheE4oyKISCJewxzmOBflUCIxFAO/ i3zwyahlwndf+swDR1+IVvwsmPd73ukHQuSlGQwxnriaXDtUfNWQ6kaFMWAzGKwIRdwOY8z7rnGb vlddtEJ0lKy2MsNTW6xBBs1RsloH767MvE/lK/qeMXyqggSIVfSZV2k0+xQA67Vrr5n31y3efGwY lxiRBCsbNWOOKdodjO4W87rXuNzcmfbwh/8GE8wF1apnrZbIUvcHSA0xAUUd481UVUMkzIqhaPUw gb3HGelVa54yiezPFaaUx8bGCHcczbtQztNK2qHw6lzKK1BlDO+pkgv1klRUTqH3a29W3buOVIIQ YUz89zNnN/zl1fvWPn2mhfphw4LJJo4/nUvl9WPqHCJWVSsTCDIp+sGr2fyREwbrqeWD97d0trpi ss16bfOhqM2Fe+Ji5RjGbKYhfECbg1tkz9q21o990sdDx8zQJz+CnbQQDtUIjrxVP5aIiKm+fh3E 4yLHf6rgRcUFEOawqEBJPIlqSbImJlU08dlITCaL4FQZwTmqm/kn+PAThlCtrxumivLxaA/4JmxQ DHyJjP2cj5PvhhdM2eNarNrdh1rccNqhibtOlTc0qmkq4pxUy9ZyBpN16I5rieYLA/EJANZ93380 FD7eMpq+fxiNRSQSBKNKCwGHiR+yhcnf1IGHv2Aue5m2v+tm2f3Gd2Dy56BjMWQjKBcxjS24kXSc Bsopk9RxM1JRp1plUoDghDpOBFe9ulbmEVYfW4tSp9GeOngYSRCKeSdtJfE4iIFIIbZKlMdUK5tA hgiMauwbc0oYqFTLSyExaKhQCZAMoBODYOklycbHV9IVnrCHu5gnkn9vWLBQYndHpT0rGnvjnRcv 4ET9mLjKRILplcHiI27ebA3W3jujYcXr00o+Zyp9/4aZPovk0Hqa3/w6ggXTKa27B2mZglYcKlK1 7tNojFaRMghWBPGCqqh3gnpBvVbvVAjqnbA67qh7Oz3pAFUB6wNzb2r5gfN6SaOaIMbHCoEHXwGn otZ6zUrqc6jaWLyviKYqqCjiUdeAiRLRUrMNX355uvHheoAxddNdSn+yEkLS5BuZpCzJgScSn1RE A4NWY4PxKmYMcOglprmxDyAZGvL5hQVSwGeq6zHhZVdQGavuHGnqahSznjrB+r9r2qSqOFVRVeMV q7XDg1UwKtXsuX4891vxqrX3HPdvwKlqJtZrXKottiG38Jj4+xvFRpGIQRQVRVWTVDROhdihiao4 VcQrQYgEjQRhLPS2Zxo7rkw33jc+OhuAOrE4PTv/9Y2VZFF5Rnt81kc/EZrL5uDSQ2hzhEdURSxW 8JDXcmXMA/HBQTKT2/GA27SP3NW/T9DWSnnVQ8D5aKIn7ATVJ+j15ElXc5M6p38qUCdefwJQOu75 9f6C6n2iAmPi3EQvb/MjY295tW69YljdWyvqN0dqbIOaMIcNM2qiSCXKYsM8JsxjAkAd3CdWXnO9 br3qkvK6XX0n5ZAnlj+TGqake/aQv+hKSgcPEf9iPRK140dTF4AFOTRmvMHJqCvHzQGQDA2Ty1Ub BDxPE86+kTRJSNlKEM3Fez+uUDzJ5E7jt07n1E6bXdd9ayDV+Bu7uivgpMcIIAdwaQv2L3/M3H+7 js1fW0Xhm5BcXUJfKWgHRiYJYkT1mAo7A+SxZs+al7N1Q20TQdbQbcfvM58CoDs4OslkpjL03V4c O7HMRlOv4rEqQpgxt5Uq6ftzmLWlcnyJADZJDMYcr41UwJUrVToqNFCuuX8ZP7dfAaRTQK6vhEIu QEspniLGtqDOj3uSGd/sZhRcBcUF8gFSflqrSn5SO04s7sa9TA+YKXTZd9CfnC7pNgCD9FYDovMz 0ooDAgnOWQxG1HvVSIR8Nvjr0dQtzogImF0+SS8bBSQIAxfHtfEvoLRxO25sDOFs/GipaoKcbHYn mtx4s6sex33TCff5Wp7uFTQKcKUYUBouvRB1Hjm/GZk9CZk5EVoiVNNxz9dgDOes18vvaVpwPcA3 WNhwuj6ZVWBXUYhWVrts/S8r+wLgeMO3ep2TAN6KZ+9IAqJ5TJQY+lzqi5NTc82RQB92vjw1l23I HAUXtLbY5FgRB0Rzz2ast5ehmRdgF8wkfWonomEVFTlVx/Qkuz7VpE9SQan6UAktPjJovIspt3yY Qw88QsoO/O7n/GgI2GlL0CMl9FgMiAho4j2V0cqngLtuYv1oD5huTuzVWQEeBl4QPRbUS7efZgqz 0jiePYZqzplMJAHHtGb81myKnVvmsWDZk6YyKxNYFIjaJ3Fs565qdlqOESYzdOt3EDMJkTzq/Sno nJgLnr4v6GSzxwjqEkxrHm3LUdrez7x//AzFAwcZ6v0xLRe/nKZLuzSc3C5pqczQLx6l+LMfVYGc uhj/zBCIDSqqcaOXuXcGsz/5h+nW93VQCKrdDC+OvTZfocsCOJfOasFmQxHxkdw5Eum7nGFbhCAT s5s1MusBJAxSscHZ6bESBsREESNrn8QC/uAoKgINZ+G9e85cFTxy/NBxB5yav+n49EbAq8e7MjJj IqkqI9v7mf/ZLyITJrD3Ex8l2zo/ToeKcenQYR+Xy3HjnNlJR89fsfjHPyG4/JWUn1mHXjCBVBO8 aDhM6nH63h9l5rxqBQPx3eO+6fuVAazb93Xp5p8eEfcXPpDDbRMa3ndtZfOXpDVzW4NYdN/oWOn6 zs8cFYf3Pu+sZP1o1S2kpTLp4WGUyfiyx6vgxxwqpg6SesTrGYDyosd95AnpDYpa0Mgg7Tlkejul Hf34oY10feu7hOdM0U1v+eM0YDq5lCizaW9U/sZX7bEP3RLteMPrwr7L/iAtPrtXF//DR2h+483E T6/DTJ+I1nYcYlVGEr/6rpbOGdeyrbLqRX49erzDFOBGv/UzNkmX7D88UvhBOKcvPVp+136tkA/t gytWr3aj6nekSTpZ47TEhCwpkBSL2LMn4ThQddw1z1YDzFsjYsBUS7UTQRqvoePTG5oCaAnR1OPK T1MaHKC883HOefd7WPbzXh2L42Tta19NM1MD05YlLiZ3udamD9iZy97uFr303XRe1tsgLcFTb38r G7/0VTfnLTcRdl5KvHMtem4zTl2QGJLAa8PwSOnnPy1c0raCgfjFgDie0pfVFMLfY2A3jt3f05mX TdHofaWc+cvLSwMPAzj4VOr4pEH6k3ICIMPrN9AwZyZFwGTt8cCgio9EjEb239NKujijMimGFPS0 BIDWeuxVPa64+Xgtm1t2FVN+70rOWrYUctlk0+o7ZeRLnw1b2jrwGfut/L7KXaORmV46Gl+lR0vt iu4zjH0uOefs708+96rP7P/6V2zQ3OTm/s177OPLHyTzbBEm5uBwKawYG2cdFxzafOiBNe3dF101 2DtyG9OyN7Or/ALxO9WDj/+a6Ad23u9nm+wz1wwNPFEPNt8PZ/+5wbwuSZLLNB94P7bbTPiTmxjb spP4wT4kPwnGHICLEJsKm8Km6CPlYuV2q9i0SnqZk0mFaqmsYpsiclcsoGH+HBqmTdXMxDbS1LmD /Y8z/OlPBRFgZ190f26s8qEjzx5bmop5f4uaiSlVJiJAMAqj6CeCXOYxM63pX4Y3PsyMj37CZdon 2Q1vfysBzdjJ56MHSqhQyavJVEI2TJzY1H3t/rWDK+kKW0/Th/OCAKybdC/dtg5kT43mOg4icy5C /CMJJKgPoCx25rmk2wdBbI3OVBRJJmDCUSu3uow8mBtzt45WW0LseN5Oqry/U6/etGTJXlbATJpA Uhwx5fuesHp4YzWazujqzzfm//d16+//HsAdZuZwozfNRVxJkLCaPZI0YrPGyO1lY76SppXu6Jym jw7vXc+0v/lwnJ18VvT0p79KZWsflgsQsSgkWZWwYhjUXHDTzaObf1qf9xSw0MV4Jvx5AazLyTv7 NQAV0P/DzB+2E9xw0LoyYLwrBcZmRZ3Wt0rrIyQt2LCSMW8qO3dDUyorjuETVMPjtLGIy6qxph5x 2Qe1NtaY1iSaM6s3f277F65bc/cP649dVShE5Y2VR63XRc9ptbpmAhsE5rNHfJo0Yt7zGj8r+zW7 5Y9apjTeVtzzBE1/9MfxhMULZfipDUHxPx4Rt7eIWAtOY4tEVoTY6Lex5qNvibdtGI/H6T7kecFd 6HUG4tvMmRcY/2ObC98Rj5bf1kKwwlkoi5KmHhU8SI0lVoNiMhgS9KkoF72tVIofkloxp+AjxGog T6F8xqnvRk2LZE0SNEX7o+b8460TW+698pGfba2/x2dnzcq8e9u2yqrC8mhsy9qNUaIzYqn1rGBt YMwdx9RVJqj500YbXHl1rdXjVqbfYM5r+mK0Z/25MInoDdeD8+lo/4Am2w4YsZFRpw68aZDAjKkj YddPDPwgKFz+yO6BB57sOb5zeWLMe16pmzDAd+zMR9ucXXbE+D0mE/yFw0VU/B+o15cipj2EIKTK /ZVRvGGfUabk1ZAj6DwQJq9oScw/HsPFChEoBvEzco1TLy098eyZxq/Xoz10Bz30pl/LzTxfKrrJ ePIOkhwShtbcNYovNTmzPBfYa16VbrpnJV3hPvq1B9KVkM/OXvrmZNvhNyS68yVNnJsxzU0kx8pV Og5URZxRX8ksviDbMmuqHdn+DKW1DyBndXz/LQef+sOTNfEFfWpQp7u+aWd9ocGZZYOko9ZzHuX0 X5zX/2by4cAkGhdnM+EsaYyuqGTkbaWs+TrWEKjs0HzwJiuGkSB9603Jtn8asv7hDBIpmnhIchjz bFJ6D8Bna18/9UCwikK0hu6gZ1w92lHbZpRM5hVZL/kUjQMIjTUPFPH5vOM4eKsoRFXQSasWxNgf b+1b+ae688qJL//9OTHmDaPHxr6cWNvnMMUAK3mCICtRQ+WJZ+3gjqfH8i9dFmdedSPu4FOvvvsl V3cArGb5qS2+Z5J6m9c37MzXN3jznTGt9wVqKUBy+eoa/MWNbP3Myffedk7nvOzB0rf+KN3WdWsw 65UZuOPsyW0du+PR0Bwu78GrVSEJVEIVtrxJzy8IvekqltvTtWrU+wy/+ZJXNVcGtm+0I/E5KZAP 7EDs1QWehWcFUfcr0033fpZZmXeP652pa/KVdJvTdSncmp97jo99wad+ieTMErVcHY48017Guem3 fDAZ+tm92eSRn//lTfDpNRBcRbV38pcCWPd738rOmeHKboOFjIfUoy6PyThh7/lh+HuXxRufAmQV mA10S11LVjAQ/2uuMNWWKqVr2TZ4WzhjmbX2hpbmzOePHIvfmS/7D43WTDlCyAf2ytekW+8708Z3 HcCv2hnfyzv+sIjzjVG0P/FqSX3r9DB78ZXJhrX1RX8+tzSlVsaebqxbmdTkpp33edm17qbo6usq 7Z0dmd2f/vvH3wFdPMdGnhnA8XZ+u8x4LKdmaQlfVjRsJrCp6H3LWhpvnD60buhMyed4IMZPaiWE jVM7G0t7RrZbT2sKlSZMJkE/8WZ2/FUPBD21FT7ZEv7ZzHx33stnirg0H4apCW02GYv3Ls42Xbak vG7X6TTv+aT67Um3hUEzhazWfSbAl9o7VgeDu19rL76oYvYezgTP7Lj2TRz7yQl7IlrVHttT9Ymi IJ9jVgRwu5nxD03YpWPiR1XINom1GP3CCt125fShdUN9dIVnytxr/ue4Nq6kK1xVy6ve+MyTRzWy d2eqi5kmKA59We1W3/McTye3MS27goH4y+GcRer1MyN4FSTNpJp1Y3H/Fa0TOl4seDUt0h560x4G 4nfQn3SAfoOFDQCMpH+fNpxN8eG1pvLMUUaDSe+pza3apd8zLsLWzaTW+aS3N81/dTgS31lWH0dI pEAz8vYb2f7PcGLV8nwy/tOAuny1ae6/ZIvpa8aqLcORgdGzCRZez5YdJ9+3sqsr1CeOPhWmOqeM 960SGC+sfpPfvuJkbf915OT3/Hx+1oUylva7SNQnXgKFRoLL/4Ttv1hJVxjUwftaMPPSxvPadqzY 9dh+gFub59/kRir/nKj3kdgIkScavXn7jWx5tAeCamvaCwOvp9Z7eCtzmzzpMpnevF2Plq90Q5U/ GEFdrXWXRrENEzPGf6x8dntbrnHWn5W2PbQC3FfbL5yVPDF0h3XMqQiasUEs3v7dm/yWj/0mwYMq ufxpps8NQtvw35Ntj7tU3x0I+NhXvKjmJcghvhvPL/ZRFvkChcYspXsmYS89FOiIivbh/JxWDc4Z 1ZQsBpsLv/2a0qY3Vlfo+R306Vb0S0zrFszPWjBBKYSMg8T76k66AgbaovBN++Jkcs7LP2CFUcs6 RdOsk6WRUyooYmR46fkTlyx6+tGd1G79TfyHPMvBrgb3j+aCv2tWe0tZPLFQavSSS2rf1GUx2MDe c/PczA0yMBArSBCF5bkk2jZI+gtJNW/gfIWhIZKnAaPiozma/QBAtVt14AUzFSfJxeCfPobfQyIN MaS1BnyMSONZQeaDN5Y3fv+LZvqqMfRJdVrEMcmAxGh/jIwqnNtqw88uevrRnfXA9Zv6Qno1uFVg 93ouHMGtF2XMog0lzKiCVSQtCW3nNuY+JgNPxqsoRMJA/H8BtvEYyTM8EcEAAADoZVhJZk1NACoA AAAIAAcBEgADAAAAAQABAAABGgAFAAAAAQAAAGIBGwAFAAAAAQAAAGoBKAADAAAAAQACAAABMQAC AAAAJAAAAHIBMgACAAAAFAAAAJaHaQAEAAAAAQAAAKoAAAAAAAABLAAAAAEAAAEsAAAAAUFkb2Jl IElsbHVzdHJhdG9yIENDIDIzLjAgKFdpbmRvd3MpADIwMjA6MDI6MTMgMDI6MTA6MDMAAAOQBAAC AAAAFAAAANSgAgAEAAAAAQAAAFCgAwAEAAAAAQAAAEIAAAAAMjAyMDowMjoxMyAwOToxMDowMgB/ /K2cAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTEwLTI3VDE3OjE4OjU4KzAwOjAwCRQNHwAAACV0 RVh0ZGF0ZTptb2RpZnkAMjAyMC0xMC0yN1QxNzoxODo1OCswMDowMHhJtaMAAAAhdEVYdGV4aWY6 RGF0ZVRpbWUAMjAyMDowMjoxMyAwMjoxMDowM+QYGrMAAAAqdEVYdGV4aWY6RGF0ZVRpbWVEaWdp dGl6ZWQAMjAyMDowMjoxMyAwOToxMDowMhsP+NkAAAATdEVYdGV4aWY6RXhpZk9mZnNldAAxNzDS Dd5MAAAAF3RFWHRleGlmOlBpeGVsWERpbWVuc2lvbgA4MIVW3/AAAAAXdEVYdGV4aWY6UGl4ZWxZ RGltZW5zaW9uADY2LyCOzgAAADF0RVh0ZXhpZjpTb2Z0d2FyZQBBZG9iZSBJbGx1c3RyYXRvciBD QyAyMy4wIChXaW5kb3dzKV8EztAAAAAASUVORK5CYII="})))}var Kf=s.forwardRef(Gf),Qf=(a.p,a(475)),Jf=a.n(Qf),Yf=a(879),Zf=a(221),Xf=a.n(Zf),eO=a(476),tO=a.n(eO),aO=a(290),nO=a.n(aO),iO=a(478),cO=a.n(iO),rO=a(479),oO=a.n(rO),sO=a(480),lO=a.n(sO),dO=a(470),uO=a.n(dO),bO=240,jO=Object(h.a)((function(e){return{root:{width:"100%",position:"sticky",top:"0"},title:{flexGrow:1},hide:{display:"none"},drawer:{width:bO,flexShrink:0},drawerPaper:{width:bO},drawerHeader:Object(o.a)(Object(o.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{maxWidth:"calc(100% - ".concat(bO,"px)"),marginLeft:bO,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},nested:{paddingLeft:e.spacing(4)},mythicElement:{}}}));function pO(e){var t=Object(ve.a)(),a=jO(t),n=l.a.useRef(null),i=l.a.useRef(null),c=l.a.useState(!1),r=Object(j.a)(c,2),o=r[0],s=r[1],d=l.a.useState(!1),u=Object(j.a)(d,2),h=u[0],m=u[1],f=Object(A.a)(I),O=Object(A.a)($),x=l.a.useState(!1),g=Object(j.a)(x,2),y=g[0],_=g[1],k=l.a.useState(!1),w=Object(j.a)(k,2),C=w[0],D=w[1],T=l.a.useState(!1),P=Object(j.a)(T,2),E=P[0],F=P[1],L=l.a.useState(!1),q=Object(j.a)(L,2),N=q[0],R=q[1],B=function(){$(!1)},W=function(e){s(!1)},z=function(e){m(!1)};return Object(v.jsxs)("div",{className:a.root,children:[f.user&&f.user.current_operation_id?Object(v.jsx)(Bf,{}):null,Object(v.jsx)(vd.a,{position:"sticky",className:Object(p.default)(a.appBar,Object(b.a)({},a.appBarShift,O)),children:f.loggedIn?Object(v.jsxs)(jj.a,{variant:"dense",position:"sticky static",children:[Object(v.jsx)(Y.a,{edge:"start",className:Object(p.default)(a.menuButton,O&&a.hide),color:"inherit","aria-label":"menu",onClick:function(){$(!0)},children:Object(v.jsx)(kf.a,{})}),Object(v.jsxs)("div",{style:{width:"100%"},children:[Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/payloadtypes",color:"inherit",children:Object(v.jsx)(Kc.a,{title:"C2 Profiles and Payload Types",children:Object(v.jsx)(uO.a,{className:"mythicElement"})})}),Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/payloads",color:"inherit",children:Object(v.jsx)(ea.a,{icon:ta.a,title:"Payloads"})}),Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/search",color:"inherit",children:Object(v.jsx)(Kc.a,{title:"Search Operation",children:Object(v.jsx)(ms.a,{className:"mythicElement"})})}),Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/search?searchField=Filename&tab=files&location=Downloads",color:"inherit",children:Object(v.jsx)(Kc.a,{title:"Files",children:Object(v.jsx)(ap.a,{className:"mythicElement"})})}),Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/search?searchField=Artifact&tab=artifacts",color:"inherit",children:Object(v.jsx)(Kc.a,{title:"Artifacts",children:Object(v.jsx)(Km.a,{className:"mythicElement"})})}),Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/search?tab=socks",color:"inherit",children:Object(v.jsx)(ea.a,{icon:ta.i,title:"SOCKS"})}),Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/search?searchField=Filename&tab=files&location=Screenshots",color:"inherit",children:Object(v.jsx)(ea.a,{icon:ta.c,title:"Screenshots"})}),Object(v.jsx)(Y.a,{component:Sf.b,to:"/new/callbacks",color:"inherit",children:Object(v.jsx)(Kc.a,{title:"Active Callbacks",children:Object(v.jsx)(Sm.a,{className:"mythicElement"})})}),Object(v.jsxs)(Gn.a,{id:"menu-appbar",nodeRef:n,anchorEl:function(){return n.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:o,onClose:W,MenuListProps:{style:{backgroundColor:"dark"===t.palette.type?t.palette.primary.dark:t.palette.primary.light,color:"white"}},children:[Object(v.jsx)(Ot.a,{component:Sf.b,to:"/new/settings",onClick:W,name:"settings",children:"Settings"}),Object(v.jsx)(Ot.a,{component:Sf.b,to:"/new/logout",onClick:W,children:"Logout"})]}),Object(v.jsxs)("div",{style:{display:"inline-flex",justifyContent:"flex-end",float:"right"},children:[Object(v.jsx)(Y.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){s(!0)},ref:n,color:"inherit",style:{float:"right"},children:Object(v.jsx)(Kc.a,{title:"Settings or Logout",children:Object(v.jsx)(Cf.a,{})})}),Object(v.jsx)(Y.a,{"aria-label":"documentation links","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){m(!0)},ref:i,color:"inherit",style:{float:"right"},children:Object(v.jsx)(Kc.a,{title:"Help Documentation",children:Object(v.jsx)(Hf.a,{})})}),Object(v.jsxs)(Gn.a,{id:"menu-appbar",nodeRef:i,anchorEl:function(){return i.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:h,onClose:z,MenuListProps:{style:{backgroundColor:"dark"===t.palette.type?t.palette.primary.dark:t.palette.primary.light,color:"white"}},children:[Object(v.jsx)(Ot.a,{component:Sf.b,target:"_blank",to:"/docs/agents",onClick:z,children:"Agent Documentation"}),Object(v.jsx)(Ot.a,{component:Sf.b,target:"_blank",to:"/docs/wrappers",onClick:z,children:"Wrapper Documentation"}),Object(v.jsx)(Ot.a,{component:Sf.b,target:"_blank",to:"/docs/c2-profiles",onClick:z,children:"C2 Profile Documentation"}),Object(v.jsx)(Ot.a,{component:Sf.b,href:"https://docs.mythic-c2.net",target:"_blank",onClick:z,children:"Mythic Documentation"})]}),Object(v.jsx)(Nf,{}),null===f.user?Object(v.jsx)(S.a,{to:"/new/logout"}):Object(v.jsx)(Z.a,{style:{display:"flex",alignItems:"center",paddingRight:"80px"},children:f.user.username})]})]})]}):null}),Object(v.jsxs)(Df.a,{className:a.drawer,anchor:"left",open:O,classes:{paper:a.drawerPaper},onEscapeKeyDown:B,children:[Object(v.jsxs)("div",{className:a.drawerHeader,role:"presentation",children:[Object(v.jsx)(Kf,{style:{width:"90%"}}),"v2.3.1",Object(v.jsx)(Y.a,{onClick:B,children:"ltr"===t.direction?Object(v.jsx)($f.a,{className:"mythicElement"}):Object(v.jsx)(Pf.a,{className:"mythicElement"})})]}),Object(v.jsx)(qa.a,{}),Object(v.jsx)(Ta.a,{subheader:Object(v.jsx)(Yf.a,{component:"div",id:"nested-list-subheader",children:"Home"}),children:Object(v.jsxs)(Pa.a,{button:!0,component:Sf.b,to:"/new",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(Jf.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Home"})]},"home")}),Object(v.jsx)(qa.a,{}),Object(v.jsxs)(Ta.a,{subheader:Object(v.jsx)(Yf.a,{component:"div",id:"nested-list-subheader",children:"Global Configurations"}),children:[Object(v.jsxs)(Pa.a,{button:!0,onClick:function(){_(!y)},children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(tO.a,{})}),Object(v.jsx)(Ea.a,{children:"Services"}),y?Object(v.jsx)(Xf.a,{}):Object(v.jsx)(en.a,{})]}),Object(v.jsx)(J.a,{in:y,unmountOnExit:!0,children:Object(v.jsxs)(Ta.a,{component:"div",disablePadding:!0,children:[Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/payloadtypes",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(Ef.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Payload Types"})]},"payloadtypes"),Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/c2profiles",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(ut.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"C2 Profiles"})]},"c2profiles")]})}),Object(v.jsxs)(Pa.a,{button:!0,onClick:function(){D(!C)},children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(nO.a,{})}),Object(v.jsx)(Ea.a,{children:"Create"}),C?Object(v.jsx)(Xf.a,{}):Object(v.jsx)(en.a,{})]}),Object(v.jsx)(J.a,{in:C,unmountOnExit:!0,children:Object(v.jsxs)(Ta.a,{component:"div",disablePadding:!0,children:[Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/createpayload",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(nO.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Create Payload"})]},"createpayload"),Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/createwrapper",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(nO.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Create Wrapped Payload"})]},"createwrapper")]})}),Object(v.jsxs)(Pa.a,{button:!0,onClick:function(){F(!E)},children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(cO.a,{})}),Object(v.jsx)(Ea.a,{children:"Operations"}),E?Object(v.jsx)(Xf.a,{}):Object(v.jsx)(en.a,{})]}),Object(v.jsx)(J.a,{in:E,unmountOnExit:!0,children:Object(v.jsxs)(Ta.a,{component:"div",disablePadding:!0,children:[Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/operations",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(Ai.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Modify Operations"})]},"modifyoperations"),Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/commandblocklists",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(oO.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Command Block Lists"})]},"modifyblocklists"),Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/browserscripts",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(tl.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"BrowserScripts"})]},"browserscripts")]})})]}),Object(v.jsx)(qa.a,{}),Object(v.jsxs)(Ta.a,{subheader:Object(v.jsx)(Yf.a,{component:"div",id:"nested-list-subheader",children:"Operational Views"}),children:[Object(v.jsxs)(Pa.a,{button:!0,onClick:function(){R(!N)},children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(lO.a,{})}),Object(v.jsx)(Ea.a,{children:"Operational Data"}),N?Object(v.jsx)(Xf.a,{}):Object(v.jsx)(en.a,{})]}),Object(v.jsx)(J.a,{in:N,unmountOnExit:!0,children:Object(v.jsxs)(Ta.a,{component:"div",disablePadding:!0,children:[Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/payloads",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(ea.a,{icon:ta.a,size:"lg"})}),Object(v.jsx)(Ea.a,{primary:"Payloads"})]},"payloads"),Object(v.jsxs)(Pa.a,{button:!0,className:a.nested,component:Sf.b,to:"/new/search",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(ms.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Search"})]},"search")]})}),Object(v.jsxs)(Pa.a,{button:!0,component:Sf.b,to:"/new/callbacks",onClick:B,children:[Object(v.jsx)(Aa.a,{children:Object(v.jsx)(Sm.a,{className:"mythicElement"})}),Object(v.jsx)(Ea.a,{primary:"Active Callbacks"})]},"callbacks")]}),Object(v.jsxs)(Pa.a,{children:[Object(v.jsx)(K.a,{checked:"dark"===e.theme,onChange:e.toggleTheme,color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"darkMode"}),Object(v.jsx)("div",{style:{display:"inline-block"},children:" Enable Dark Mode "})]})]})]})}var hO;function mO(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(ve.a)();return Object(s.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(R.a)(e),Object(R.a)(t.taskartifacts))}),[]);t.sort((function(e,t){return e.task_id>t.task_id?1:t.task_id>e.task_id?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Artifact Tasks"})}),Object(v.jsx)(G.a,{elevation:5,style:{position:"relative",backgroundColor:c.body},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Task ID"}),Object(v.jsx)(H.a,{children:"Artifact Type"}),Object(v.jsx)(H.a,{children:"Host"}),Object(v.jsx)(H.a,{children:"Artifact"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.task_id}),Object(v.jsx)(H.a,{children:e.artifact.name}),Object(v.jsx)(H.a,{children:e.host}),Object(v.jsx)(H.a,{children:e.artifact_instance_text})]},"artifact"+e.id)}))})]})})})]})}function fO(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(ve.a)();return Object(s.useEffect)((function(){var t=e.tasks.reduce((function(e,t){var a=t.attacktasks.reduce((function(t,a){return e.find((function(e){return e.attack.t_num===a.attack.t_num}))?Object(R.a)(t):[].concat(Object(R.a)(t),[a])}),[]);return[].concat(Object(R.a)(e),Object(R.a)(a))}),[]);t.sort((function(e,t){return e.attack.t_num>t.attack.t_num?1:t.attack.t_num>e.attack.t_num?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"MITRE ATT&CK Mappings"})}),Object(v.jsx)(G.a,{elevation:5,style:{position:"relative",backgroundColor:c.body},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Technique ID"}),Object(v.jsx)(H.a,{children:"Technique"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.attack.t_num}),Object(v.jsx)(H.a,{children:e.attack.name})]},"attack"+e.attack.id)}))})]})})})]})}function OO(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(ve.a)();return Object(s.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(R.a)(e),Object(R.a)(t.filemeta))}),[]);i(t),t.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0}))}),[e.tasks]),0===n.length?null:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Files / Screenshots"})}),Object(v.jsx)(G.a,{elevation:5,style:{position:"relative",backgroundColor:c.body},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Filename"}),Object(v.jsx)(H.a,{children:"Type"}),Object(v.jsx)(H.a,{children:"Remote Path"}),Object(v.jsx)(H.a,{children:"Comment"}),Object(v.jsx)(H.a,{children:"Hashes"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:!e.deleted&&e.complete?Object(v.jsx)(hd.a,{href:window.origin+"/api/v1.4/files/download/"+e.agent_file_id,style:{textDecoration:"underline",color:"inherit"},children:e.filename_text}):e.complete?e.filename_text:e.filename_text+" ("+e.chunks_received+"/"+e.total_chunks+")"}),Object(v.jsx)(H.a,{children:e.is_screenshot?"Screenshot":e.is_payload?"Payload":e.is_download_from_agent?"Download":"Upload"}),Object(v.jsx)(H.a,{children:""===e.full_remote_path_text?"":e.host+":"+e.full_remote_path_text}),Object(v.jsx)(H.a,{children:e.task.comment}),Object(v.jsxs)(H.a,{children:["MD5:",Object(v.jsx)("br",{}),e.md5,Object(v.jsx)("br",{}),"SHA1:",Object(v.jsx)("br",{}),e.sha1]})]},"file"+e.id)}))})]})})})]})}function xO(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(ve.a)();return Object(s.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(R.a)(e),Object(R.a)(t.credentials))}),[]);i(t)}),[e.tasks]),0===n.length?null:Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(G.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Credentials"})}),Object(v.jsx)(G.a,{elevation:5,style:{position:"relative",backgroundColor:c.body},variant:"elevation",children:Object(v.jsx)(M.a,{component:G.a,className:"mythicElement",children:Object(v.jsxs)(W.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(v.jsx)(U.a,{children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:"Task"}),Object(v.jsx)(H.a,{children:"Type"}),Object(v.jsx)(H.a,{children:"Realm"}),Object(v.jsx)(H.a,{children:"Account"}),Object(v.jsx)(H.a,{children:"Credentials"}),Object(v.jsx)(H.a,{children:"Comment"})]})}),Object(v.jsx)(z.a,{children:n.map((function(e){return Object(v.jsxs)(V.a,{children:[Object(v.jsx)(H.a,{children:e.task_id}),Object(v.jsx)(H.a,{children:e.type}),Object(v.jsx)(H.a,{children:e.realm}),Object(v.jsx)(H.a,{children:e.account}),Object(v.jsx)(H.a,{children:e.credential_text}),Object(v.jsx)(H.a,{children:e.comment})]},"cred"+e.id)}))})]})})})]})}var gO,yO,_O,vO,kO,wO=Object(Pe.a)(hO||(hO=Object(B.a)(["\nquery taskMetadataQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}) {\n      credentials {\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n        task_id\n      }\n      filemeta {\n        agent_file_id\n        complete\n        deleted\n        filename_text\n        full_remote_path_text\n        host\n        id\n        total_chunks\n        chunks_received\n        is_download_from_agent\n        is_payload\n        is_screenshot\n        md5\n        sha1\n        task {\n            comment\n            id\n        }\n      }\n      taskartifacts {\n        artifact_instance_text\n        host\n        task_id\n        artifact{\n            id\n            name\n        }\n        id\n      }\n      tokens {\n        TokenId\n        id\n        host\n      }\n      attacktasks(distinct_on: attack_id) {\n        attack {\n          name\n          os\n          id\n          t_num\n          tactic\n        }\n        id\n      }\n      id\n    }\n  }"])));function CO(e){var t=l.a.useState([]),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(St.a)(wO,{onCompleted:function(e){i(e.task)},onError:function(e){console.log("error!",e)}}),r=Object(j.a)(c,1)[0];return Object(s.useEffect)((function(){r({variables:{task_range:e.taskIDs}})}),[e.taskIDs,r]),Object(v.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(v.jsx)(mO,{tasks:n}),Object(v.jsx)(fO,{tasks:n}),Object(v.jsx)(OO,{tasks:n}),Object(v.jsx)(xO,{tasks:n})]})}function SO(e){var t=Object(s.useState)(0),a=Object(j.a)(t,2),n=a[0],i=a[1],c=Object(s.useState)([]),r=Object(j.a)(c,2),o=r[0],d=r[1],u=Object(s.useState)(10),b=Object(j.a)(u,2),p=b[0],h=b[1],f=Object(s.useState)(10),O=Object(j.a)(f,2),x=O[0],g=O[1],y=Object(s.useState)("all"),_=Object(j.a)(y,2),k=_[0],C=_[1],S=Object(s.useState)(""),D=Object(j.a)(S,2),I=D[0],$=D[1],T=Object(s.useRef)(null);return Object(s.useEffect)((function(){d(e.taskOptions),e.taskOptions.length>0&&i(e.taskOptions[0])}),[e.tasks,e.taskOptions]),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsx)(ue.a,{id:"form-dialog-title",children:"Add More Tasks to View"}),Object(v.jsxs)(le.a,{dividers:!0,children:[Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(Dt.a,{style:{width:"100%"},children:[Object(v.jsx)(Mt.a,{ref:T,children:"View More Tasks Around Task:"}),Object(v.jsx)(It.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:n,onChange:function(e){i(e.target.value)},input:Object(v.jsx)(Tt.a,{}),children:o.map((function(e){return Object(v.jsx)(Ot.a,{value:e,children:e},"selectiontask:"+e)}))})]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{})]}),Object(v.jsx)(w,{type:"number",value:p,onChange:function(e,t,a){return h(t)},name:"Number of tasks before"}),Object(v.jsx)(w,{type:"number",value:x,onChange:function(e,t,a){return g(t)},name:"Number of tasks after"}),Object(v.jsxs)(l.a.Fragment,{children:[Object(v.jsxs)(Dt.a,{style:{width:"100%"},children:[Object(v.jsx)(Mt.a,{ref:T,children:"Search Type"}),Object(v.jsx)(It.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:k,onChange:function(e){C(e.target.value)},input:Object(v.jsx)(Tt.a,{}),children:[{type:"all",text:"All Callbacks"},{type:"callback",text:"This Callack"},{type:"operator",text:"All callbacks but limited by operator"}].map((function(e){return Object(v.jsx)(Ot.a,{value:e.type,children:e.text},"selectiontype:"+e.type)}))})]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{})]}),"operator"===k?Object(v.jsx)(w,{multiline:!1,onChange:function(e,t,a){$(t)},value:I,name:"Operator Username"}):null]}),Object(v.jsxs)(se.a,{children:[Object(v.jsx)(m.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(v.jsx)(m.a,{onClick:function(){e.submitFetchTasks({taskSelected:n,beforeCount:parseInt(p),afterCount:parseInt(x),search:"operator"===k?I:k}),e.onClose()},variant:"contained",color:"secondary",children:"Fetch Tasks"})]})]})}var DO=Object(Pe.a)(gO||(gO=Object(B.a)(["\nfragment TaskData on task {\n    comment\n    callback_id\n    commentOperator{\n        username\n    }\n    completed\n    id\n    operator{\n        username\n    }\n    display_params\n    original_params\n    status\n    timestamp\n    command {\n        cmd\n        id\n    }\n    callback {\n        id\n        host\n        user\n        integrity_level\n        domain\n    }\n    responses_aggregate{\n        aggregate{\n            count\n        }\n    }\n    parent_task_id\n    opsec_pre_blocked\n    opsec_pre_bypassed\n    opsec_post_blocked\n    opsec_post_bypassed\n    tasks {\n        id\n    }\n    token {\n        id\n    }\n}\n"]))),IO=Object(Pe.a)(yO||(yO=Object(B.a)(["\n","\nquery tasksQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),DO),$O=Object(Pe.a)(_O||(_O=Object(B.a)(["\n","\nquery tasksAcrossAllCallbacks($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, order_by: {id: desc}, limit: $beforeCount) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),DO),TO=Object(Pe.a)(vO||(vO=Object(B.a)(["\n","\nquery tasksAcrossACallbacks($callback_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskDAta\n    }\n}"])),DO),PO=Object(Pe.a)(kO||(kO=Object(B.a)(["\n","\nquery tasksAcrossAllCallbacksByOperator($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!, $operator: String!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),DO);function AO(e){var t=Object(A.a)(I),a=Object(S.g)().taskId,n=l.a.useState([]),i=Object(j.a)(n,2),c=i[0],r=i[1],d=l.a.useState([]),u=Object(j.a)(d,2),b=u[0],p=u[1],h=l.a.useState([]),f=Object(j.a)(h,2),O=f[0],x=f[1],g=l.a.useState(!1),y=Object(j.a)(g,2),_=y[0],k=y[1],w=l.a.useState(!1),C=Object(j.a)(w,2),D=C[0],$=C[1],T=Object(ve.a)(),P=function(e){var t=e.filter((function(e){return null===e.parent_task_id})),a=[],n=-1;0===t.length&&(t=Object(R.a)(e));var i=O.reduce((function(e,t){return"task"===t.type&&null===t.parent_task_id?e.find((function(e){return e.id===t.id}))?Object(R.a)(e):[].concat(Object(R.a)(e),[Object(o.a)(Object(o.a)({},t),{},{checked:!1})]):Object(R.a)(e)}),Object(R.a)(t));i.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0})),i.forEach((function(e){e.callback.id!==n&&a.push(Object(o.a)(Object(o.a)({type:"callback"},e.callback),{},{checked:!1})),n=e.callback.id,a.push(Object(o.a)(Object(o.a)({type:"task"},e),{},{checked:!1}))})),x(a);var s=e.reduce((function(e,t){var a=t.tasks.filter((function(t){return!e.includes(t.id)})).map((function(e){return e.id}));return e.includes(t.id)?[].concat(Object(R.a)(e),Object(R.a)(a)):[].concat(Object(R.a)(e),[t.id],Object(R.a)(a))}),Object(R.a)(c));r(s)},E=Object(St.a)($O,{onCompleted:function(e){q.success("Successfully fetched tasks"),P([].concat(Object(R.a)(e.before),Object(R.a)(e.after)))}}),F=Object(j.a)(E,1)[0],L=Object(St.a)(TO,{onCompleted:function(e){q.success("Successfully fetched tasks"),P([].concat(Object(R.a)(e.before),Object(R.a)(e.after)))}}),N=Object(j.a)(L,1)[0],B=Object(St.a)(PO,{onCompleted:function(e){q.success("Successfully fetched tasks"),P([].concat(Object(R.a)(e.before),Object(R.a)(e.after)))}}),W=Object(j.a)(B,1)[0],z=Object(St.a)(IO,{onCompleted:function(e){P(e.task)}}),H=Object(j.a)(z,1)[0],M=function(e){var t=O.map((function(t){return"task"===t.type&&"task"+t.id===e.target.name?Object(o.a)(Object(o.a)({},t),{},{checked:e.target.checked}):Object(o.a)({},t)}));x(t)};return Object(s.useEffect)((function(){if(window.location.pathname.includes("/new/tasks/by_range")){var e=new URLSearchParams(window.location.search);if(e.has("tasks")){console.log(e.get("tasks"));var t=function(e){for(var t=[],a=e.split(","),n=0;n<a.length;n++)a[n].includes("-")?function(){var e=a[n].split("-");e=e.map((function(e){return parseInt(e)})),t.push.apply(t,Object(R.a)(Object(R.a)(Array(e[1]-e[0]+1).keys()).map((function(t){return t+e[0]}))))}():t.push(parseInt(a[n]));return t.sort((function(e,t){return e-t})),t}(e.get("tasks"));H({variables:{task_range:t}})}else q.warning("URL Query missing '?tasks=' with a range of tasks")}else H({variables:{task_range:[parseInt(a)]}})}),[H,a]),Object(v.jsxs)("div",{style:{marginTop:"10px",maxHeight:"calc(94vh)",width:"100%",marginBottom:"10px"},children:[Object(v.jsxs)(G.a,{elevation:5,style:{backgroundColor:T.pageHeader.main,color:T.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(v.jsx)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Task View"}),Object(v.jsx)(m.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:T.palette.success.main},onClick:function(){var e=function(e){e.sort((function(e,t){return e-t}));for(var t,a,n=[],i=0;i<e.length;i++){for(a=t=e[i];e[i+1]-e[i]===1;)a=e[i+1],i++;n.push(t===a?t+"":t+"-"+a)}return n.join(",")}(Object(R.a)(c));lo(window.origin+"/new/tasks/by_range?tasks="+e),q.success("Copied link to clipboard!")},children:"Get Shareable link"}),Object(v.jsx)(m.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:T.palette.warning.main},onClick:function(){k(!_);var e=O.filter((function(e){return!e.checked}));x(e);var t=e.reduce((function(e,t){return"task"===t.type?[].concat(Object(R.a)(e),[t.id]):Object(R.a)(e)}),[]);r(t)},children:"Remove Tasks From View"}),Object(v.jsx)(m.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(e){e.stopPropagation(),q.warning("Not implemented yet")},children:"Add Tags To All"})]}),O.map((function(e){return"task"===e.type?Object(v.jsxs)($t.a,{container:!0,alignItems:"stretch",style:{marginRight:"5px"},children:[Object(v.jsx)($t.a,{item:!0,style:{display:"inline-flex",width:_?"96%":"100%"},children:Object(v.jsx)(Al,{task:e,command_id:null===e.command?0:e.command.id})}),Object(v.jsx)($t.a,{item:!0,style:{display:"inline-flex"},children:_?Object(v.jsx)(K.a,{checked:e.checked,onChange:M,name:"task"+e.id,inputProps:{"aria-label":"checkbox",color:T.palette.error.main}}):null})]},"taskdisplay:"+e.id):Object(v.jsxs)(G.a,{elevation:5,style:{marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(v.jsxs)(Z.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:[""===e.domain?null:e.domain+"\\",e.user,e.integrity_level>2?"*":null,"@",e.host," (",e.id,")"]}),Object(v.jsx)(m.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:T.palette.info.main},onClick:function(){!function(e){var t=O.reduce((function(t,a){return"task"===a.type&&a.callback.id===e?[].concat(Object(R.a)(t),[a.id]):Object(R.a)(t)}),[]);p(t),$(!0)}(e.id)},children:"Include More Tasks"})]},"taskdisplayforcallback:"+e.id)})),Object(v.jsx)(he,{fullWidth:!0,maxWidth:"md",open:D,onClose:function(){$(!1)},innerDialog:Object(v.jsx)(SO,{submitFetchTasks:function(e){var a=e.taskSelected,n=e.beforeCount,i=e.afterCount,c=e.search;switch(q.info("Searching for tasks..."),c){case"all":F({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i}});break;case"callback":N({variables:{}});break;default:W({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i,operator:c}})}},taskOptions:b,onClose:function(){$(!1)}})}),Object(v.jsx)(CO,{taskIDs:c})]})}var EO,FO=a(884),LO=a(481),qO=Object(LO.a)(EO||(EO=Object(B.a)(["\nbody {\n    margin: 0\n}\n.MuiAccordionDetails-root{\n\n    padding-bottom: 0;\n    padding-top: 0;\n}\n.MuiAccordionSummary-content.Mui-expanded{\n    margin: 0px 0px 0px 0px !important;\n    min-height: unset;\n}\n.MuiAccordionSummary-root.Mui-expanded{\n    min-height: unset;\n}\n// placeholder/helper text for input boxes\n.MuiFormLabel-root {\n    background: transparent;\n}\n.MuiTableCell-head {\n\n    font-weight: bold;\n}\n.MuiSelect-select.MuiSelect-select{\n    padding-left: 10px\n}\n.BaseTable__column-resizer {\n    background-color: "," !important;\n}\n.ReactVirtualized__Table__row {\n    &:hover,\n    &--hovered {\n        background-color: "," !important;\n        \n    }\n}\n.menuEntry {\n  cursor: pointer;\n}\n\ntspan {\n  font-size: 15px;\n  stroke: none;\n}\n.DragHandle {\n    z-index: 2;\n    cursor: col-resize;\n}\n.DragHandle:hover {\n    background-color: rgba(0, 0, 0, 0.1);\n}\n.ReactVirtualized__Table__headerTruncatedText {\n\n  }\n.ReactVirtualized__Table__headerColumn {\n\n    padding: 0;\n  }\n.DragHandleActive,\n    .DragHandleActive:hover {\n        color: #0b6fcc;\n        z-index: 3;\n    }\n\n.DragHandleIcon {\n\n    float:right;\n}\n.MuiTab-root {\n    max-width: unset;\n}\n"])),(function(e){return e.theme.tableHover}),(function(e){return e.theme.tableHover})),NO=a(885),RO=Object(h.a)((function(e){return{content:{maxWidth:"calc(99vw)",maxHeight:"calc(98vh)",overflow:"auto",padding:"0px 0 0px 16px"}}}));function BO(e){var t=RO(),a=Object(A.a)(I),n=function(){var e=Object(s.useState)("light"),t=Object(j.a)(e,2),a=t[0],n=t[1],i=Object(s.useState)(!1),c=Object(j.a)(i,2),r=c[0],o=c[1],l=function(e){window.localStorage.setItem("theme",e),n(e)};return Object(s.useEffect)((function(){var e=window.localStorage.getItem("theme");e?n(e):l("light"),o(!0)}),[]),[a,function(){l("light"===a?"dark":"light")},r]}(),i=Object(j.a)(n,2),c=i[0],r=i[1],o=Object(A.a)($),d=l.a.useMemo((function(){return Object(yc.a)({palette:{primary:{main:"#7f93c0"},secondary:{main:"#a791c3"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"},type:c,background:{main:"#303030"},text:{primary:"dark"===c?"#fff":"#000",secondary:"dark"===c?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.54)"},textBackgroundColor:"dark"===c?"#74828b":"#d9dbdc",textBackgroundColorMythic:"dark"===c?"#436b9f":"#aadcf5",textBackgroundColorSuccess:"dark"===c?"#09a21a":"#70e373",textBackgroundColorError:"dark"===c?"#9f1616":"#f19da3",graphGroup:"dark"===c?"#394c5d":"#d3d7e8"},folderColor:"#f1d592",tableHeader:"#484848",tableBorder:"dark"===c?"rgba(81,81,81,1)":"rgba(224,224,224,1)",tableHover:"dark"===c?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)",pageHeader:{main:"#827E80"},pageHeaderText:{main:"white"}})}),[c]);return Object(v.jsxs)(FO.a,{theme:d,children:[Object(v.jsx)(qO,{theme:d}),Object(v.jsx)(NO.a,{}),Object(v.jsxs)(E.b,{maxSnack:5,anchorOrigin:{vertical:"top",horizontal:"center"},children:[Object(v.jsx)(L,{}),Object(v.jsxs)("div",{className:"App",children:[a.loggedIn&&void 0!==a.user&&null!==a.user?Object(v.jsx)(pO,{theme:c,toggleTheme:r}):null,Object(v.jsx)("div",{className:Object(p.default)(t.content,Object(b.a)({},t.contentShift,o)),children:Object(v.jsxs)(S.d,{children:[Object(v.jsx)(_d,{exact:!0,path:"/new",component:gd}),Object(v.jsx)(S.b,{exact:!0,path:"/new/login",component:N}),Object(v.jsx)(_d,{exact:!0,path:"/new/settings",component:He}),Object(v.jsx)(_d,{exact:!0,path:"/new/payloadtypes",component:ha}),Object(v.jsx)(_d,{exact:!0,path:"/new/eventfeed",component:Ci}),Object(v.jsx)(_d,{exact:!0,path:"/new/createpayload",component:bn}),Object(v.jsx)(_d,{exact:!0,path:"/new/createwrapper",component:zn}),Object(v.jsx)(_d,{exact:!0,path:"/new/payloads",component:Dr}),Object(v.jsx)(_d,{exact:!0,path:"/new/c2profiles",component:ha}),Object(v.jsx)(_d,{exact:!0,path:"/new/services/",component:ha}),Object(v.jsx)(_d,{exact:!0,path:"/new/callbacks",component:Ej}),Object(v.jsx)(_d,{path:"/new/search",component:gf}),Object(v.jsx)(_d,{exact:!0,path:"/new/browserscripts",component:Ec}),Object(v.jsx)(_d,{exact:!0,path:"/new/task/:taskId",component:AO}),Object(v.jsx)(_d,{exact:!0,path:"/new/tasks/by_range",component:AO}),Object(v.jsx)(_d,{exact:!0,path:"/new/operations",component:rc}),Object(v.jsx)(_d,{exact:!0,path:"/new/callbacks/:callbackId",component:bd}),Object(v.jsx)(S.b,{exact:!0,path:"/new/logout",component:Me})]})})]})]})]})}var WO=a(770),zO=a(888),HO=a(218),MO=a.n(HO),UO=a(14),VO=a(323),GO=a(768),KO=a(488),QO=a(487),JO=a(895),YO=a(217),ZO=a(146),XO=a(486),ex=a(324),tx=a.n(ex),ax=new WO.a({typePolicies:{Query:{fields:{operationeventlog:{},callback:{}}}}}),nx=new JO.a({delay:{initial:20,max:300,jitter:!0},attempts:{max:2,retryIf:function(e,t){return!!e}}}),ix=new zO.a({uri:window.location.origin+"/graphql/",options:{reconnect:!0,connectionParams:{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),cx=Object(XO.a)((function(e,t){var a=t.headers;return{headers:Object(o.a)(Object(o.a)({},a),{},{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))})}})),rx=function(e){return new MO.a((function(t){e.then((function(e){console.log(t),t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)}))}))},ox=Object(QO.a)((function(e){var t=e.graphQLErrors,a=e.networkError,n=e.operation,i=e.forward;console.log("errors?");try{if(t){console.log("[graphQLError]",t);var c,o=Object(r.a)(t);try{for(o.s();!(c=o.n()).done;){var s=c.value;switch(s.extensions.code){case"forbidden":q.error(s.message);break;case"access-denied":case"start-failed":return console.log("got start-failed error in graphql"),rx(sx()).flatMap((function(){return n.setContext({headers:{Authorization:"Bearer "+localStorage.getItem("access_token")}}),console.log("forwarding operation in promise thingy",localStorage.getItem("access_token")),i(n)}));case"validation-failed":return void console.log(s);default:console.log(s),q.error(s.message)}}}catch(s){o.e(s)}finally{o.f()}}if(a){if(console.log("[Network error]",a),void 0===a.extensions)return q.error("Failed to connect to Mythic, please refresh"),jx(),void(window.location="/new/login");switch(a.extensions.code){case"access-denied":q.warning("Access Denied");break;case"start-failed":console.log("got start-failed error in network"),jx(),window.location="/new/login";break;default:console.log(a)}}}catch(l){return q.error("Failed to connect to Mythic, please refresh"),console.log(l),jx(),void(window.location="/new/login")}})),sx=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:localStorage.getItem("refresh_token"),access_token:localStorage.getItem("access_Token")})},e.abrupt("return",fetch("/refresh",t).then((function(e){e.json().then((function(e){return console.log(e),"access_token"in e?(T(e),console.log("successfully got new access_token"),!0):(P(),!1)})).catch((function(t){return console.log("Error trying to get json response in GetNewToken",t.toString()),console.log(e),P(),!1}))})).catch((function(e){return console.log("There was an error in GetNewToken!",e.toString()),P(),!1})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),lx=new YO.SubscriptionClient("https:"===window.location.protocol?"wss://"+window.location.host+"/graphql/":"ws://"+window.location.host+"/graphql/",{reconnect:!0,connectionParams:function(){return{Authorization:"Bearer ".concat(localStorage.getItem("access_token")),headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),dx=new KO.a(lx),ux=Object(UO.split)((function(e){var t=e.query,a=Object(ZO.e)(t);return"OperationDefinition"===a.kind&&"subscription"===a.operation}),dx,ix),bx=new VO.a({link:Object(UO.from)([cx,ox,nx,cx.concat(ux)]),cache:ax});function jx(){var e=Object.assign({},lx.operations);lx.close(!0),lx.connect(),Object.keys(e).forEach((function(t){lx.sendMessage(t,tx.a.GQL_START,e[t].options)}))}u.a.render(Object(v.jsx)(l.a.StrictMode,{children:Object(v.jsx)(GO.a,{client:bx,children:Object(v.jsx)(Sf.a,{children:Object(v.jsx)(BO,{},"App")})})}),document.getElementById("root"))}},[[769,1,2]]]);
//# sourceMappingURL=main.0716214b.chunk.js.map