(this.webpackJsonpmythic=this.webpackJsonpmythic||[]).push([[0],{139:function(e,t,a){"use strict";a.d(t,"a",(function(){return he}));var n,i,r,c=a(25),o=a(6),s=a(3),l=a(2),d=a(7),u=a(1),b=a.n(u),j=a(69),p=a(124),m=a(123),h=a(131),f=a(62),O=a(245),g=a(247),x=a(84),y=a(244),_=a(246),v=a(130),k=a(83),w=a(373),C=a(378),S=a(921),D=a(372),I=a(18),T=a(187),$=a.n(T),P=a(49),A=a.n(P),E=a(60),L=a(237),F=a.n(L),q=a(67),N=a(221),R=a(4),B=a(852),z=a(169),W=a(14),M=a(0),H=Object(q.a)(n||(n=Object(d.a)(["\nmutation getDynamicParamsMutation($callback: Int!, $command: String!, $payload_type: String!, $parameter_name: String!){\n    dynamic_query_function(callback: $callback, command: $command, payload_type: $payload_type, parameter_name: $parameter_name){\n        status\n        error\n        choices\n    }\n}\n"]))),U=Object(q.a)(i||(i=Object(d.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),G=Object(q.a)(r||(r=Object(d.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      ...credentialData\n    }\n  }\n"])),U);function V(e){var t=b.a.useState(""),a=Object(l.a)(t,2),n=a[0],i=a[1],r=Object(E.a)(),d=b.a.useState([]),p=Object(l.a)(d,2),m=p[0],h=p[1],T=b.a.useState(!1),P=Object(l.a)(T,2),L=P[0],q=P[1],U=b.a.useState([]),V=Object(l.a)(U,2),K=V[0],Q=V[1],J=b.a.useState([]),Y=Object(l.a)(J,2),Z=Y[0],X=Y[1],ee=b.a.useState(""),te=Object(l.a)(ee,2),ae=te[0],ne=te[1],ie=b.a.useState([]),re=Object(l.a)(ie,2),ce=re[0],oe=re[1],se=b.a.useState(0),le=Object(l.a)(se,2),de=le[0],ue=le[1],be=b.a.useState(0),je=Object(l.a)(be,2),pe=je[0],me=je[1],he=b.a.useState([]),fe=Object(l.a)(he,2),Oe=fe[0],ge=fe[1],xe=b.a.useState(0),ye=Object(l.a)(xe,2),_e=ye[0],ve=ye[1],ke=b.a.useState([]),we=Object(l.a)(ke,2),Ce=we[0],Se=we[1],De=b.a.useState(0),Ie=Object(l.a)(De,2),Te=Ie[0],$e=Ie[1],Pe=b.a.useState(!1),Ae=Object(l.a)(Pe,2),Ee=Ae[0],Le=Ae[1],Fe=b.a.useState(!1),qe=Object(l.a)(Fe,2),Ne=qe[0],Re=qe[1],Be=b.a.useState({name:""}),ze=Object(l.a)(Be,2),We=ze[0],Me=ze[1],He=Object(N.a)(H,{onCompleted:function(t){"success"===t.dynamic_query_function.status?(h(Object(o.a)(t.dynamic_query_function.choices)),"Choice"===e.type&&t.dynamic_query_function.choices.length>0&&(i(t.dynamic_query_function.choices[0]),e.onChange(e.name,t.dynamic_query_function.choices[0],!1))):R.b.warning("Failed to fetch dynamic parameter query: "+t.dynamic_query_function.error)},onError:function(e){R.b.warning("Failed to perform dynamic parameter query"),console.log(e)}}),Ue=Object(l.a)(He,1)[0],Ge=Object(N.a)(G,{fetchPolicy:"no-cache",onCompleted:function(e){R.b.success("Successfully created new credential"),h([].concat(Object(o.a)(m),[Object(s.a)({},e.insert_credential_one)]))},onError:function(e){R.b.error("Failed to create credential"),console.log(e)}}),Ve=Object(l.a)(Ge,1)[0];Object(u.useEffect)((function(){if(null!==e.dynamic_query_function&&0===m.length&&Ue({variables:{callback:e.callback_id,parameter_name:e.name,command:e.commandInfo.cmd,payload_type:e.commandInfo.payloadtype.ptype}}),"Boolean"===e.type)""===n&&(q(e.value),i(e.value));else if("Array"===e.type)0===K.length&&e.value.length>0&&Q(e.value);else if("ChoiceMultiple"===e.type&&null===e.dynamic_query_function)""===n&&(X(e.value),i(e.value),h(e.choices));else if("AgentConnect"===e.type)if(e.choices.length>0){var t=0;pe<e.choices.length?t=pe:me(0),oe(e.choices);var a=0;_e<e.choices[t].payloads.length?a=_e:ve(0),ge(e.choices[t].payloads),e.choices[t].payloads.length>0?e.choices[t].payloads[a].c2info.length>0&&Se(e.choices[t].payloads[a].c2info):R.b.warning("Mythic knows of no host with a P2P payload. Please add one.")}else oe([]),Se([]),R.b.warning("Mythic knows of no host with a P2P payload. Please add one.");else""===n&&("Number"===e.type?""===e.value?i(0):i(parseInt(e.value)):i(e.value)),null===e.dynamic_query_function&&""===n&&(h(Object(o.a)(e.choices)),i(e.value))}),[e.choices,e.default_value,e.type,e.value,q,n]);var Ke=function(t,a,n){var i=e.choices[t].payloads[a].c2info[n].parameters.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.name,t.value))}),{}),r={host:e.choices[t].host,agent_uuid:e.choices[t].payloads[a].uuid,c2_profile:{name:e.choices[t].payloads[a].c2info[n].name,parameters:i}};"callback"===e.choices[t].payloads[a].type?r.callback_uuid=e.choices[t].payloads[a].agent_callback_id:r.callback_uuid="",e.onChange(e.name,r,!1)},Qe=function(t){i(t.target.value),e.onChange(e.name,t.target.value,!1)},Je=function(t){i(t.target.value),e.onChange(e.name,m[t.target.value],!1)},Ye=function(t){for(var a=t.target.options,n=[],r=0,c=a.length;r<c;r+=1)a[r].selected&&n.push(a[r].value);X(n),i(n),e.onChange(e.name,n,!1)},Ze=function(t,a,n){i(a),e.onChange(e.name,a,n)},Xe=function(t,a,n){i(parseInt(a)),e.onChange(e.name,parseInt(a),n)},et=function(t,a){q(a),i(a),e.onChange(t,a)},tt=function(t){var a=new FileReader;a.onload=function(a){var n=btoa(a.target.result);Me({name:t.target.files[0].name,contents:n}),e.onChange(e.name,{name:t.target.files[0].name,contents:n})},a.readAsBinaryString(t.target.files[0])},at=function(t){me(t.target.value),ge(e.choices[t.target.value].payloads),e.choices[t.target.value].payloads.length>0?(ve(0),e.choices[t.target.value].payloads[0].c2info.length>0?(Se(e.choices[0].payloads[0].c2info),$e(0),Ke(t.target.value,0,0)):(Se([]),$e(null))):(ge([]),ve(null),Se([]),$e(null))},nt=function(t){ve(t.target.value),Se(e.choices[pe].payloads[t.target.value].c2info),e.choices[pe].payloads[t.target.value].c2info.length>0?($e(0),Ke(pe,t.target.value,0)):$e(null)},it=function(e){$e(e.target.value),Ke(pe,_e,e.target.value)},rt=function(e,t,a){ne(t)},ct=function(e){ue(e.target.value)},ot=function(){""!==ae?(e.onAgentConnectAddNewPayloadOnHost(ae.toUpperCase(),e.payload_choices[de].id),Le(!1)):R.b.error("Must set a hostname")},st=function(){e.choices[pe].payloads[_e].payloadOnHostID?e.onAgentConnectRemovePayloadOnHost(e.choices[pe].payloads[_e].payloadOnHostID):R.b.warning("Can't remove a callback")},lt=function(t){return(e.required&&""!==e.verifier_regex||""!==e.verifier_regex&&""!==t)&&!RegExp(e.verifier_regex).test(t)},dt=function(){var t=[].concat(Object(o.a)(K),[""]);Q(t),e.onChange(e.name,t,!1)},ut=function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,r=e.credential;Ve({variables:{type:t,account:a,realm:n,comment:i,credential:r}})},bt=b.a.useState(null),jt=Object(l.a)(bt,2),pt=jt[0],mt=jt[1],ht=Boolean(pt),ft=function(){mt(null)};return Object(M.jsxs)(v.a,{children:[Object(M.jsxs)(x.a,{children:[Object(M.jsx)(f.a,{"aria-haspopup":"true",onMouseEnter:function(e){mt(e.currentTarget)},onMouseLeave:ft,"aria-owns":ht?"taskparam"+e.id+"popover":void 0,children:e.display_name}),e.required?Object(M.jsx)(f.a,{component:"div",style:{color:r.palette.warning.main},children:"Required"}):null,Object(M.jsx)(B.a,{id:"taskparam"+e.id+"popover",open:ht,anchorEl:pt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:ft,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"},variant:"outlined"},children:Object(M.jsx)(f.a,{children:e.description.length>0?e.description:"No Description"})})]}),Object(M.jsx)(x.a,{children:function(){switch(e.type){case"Choice":case"ChoiceMultiple":return Object(M.jsx)(w.a,{style:{width:"100%"},children:Object(M.jsx)(C.a,{native:!0,autoFocus:e.autoFocus,multiple:"ChoiceMultiple"===e.type,value:"ChoiceMultiple"===e.type?Z:n,onChange:"ChoiceMultiple"===e.type?Ye:Qe,input:Object(M.jsx)(D.a,{}),children:m.map((function(t,a){return Object(M.jsx)("option",{value:t,children:t},e.name+a)}))})});case"Array":return Object(M.jsx)(y.a,{component:k.a,className:"mythicElement",children:Object(M.jsxs)(O.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:[Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{style:{width:"5rem"}}),Object(M.jsx)(x.a,{})]}),Object(M.jsxs)(g.a,{children:[K.map((function(t,a){return Object(M.jsxs)(v.a,{hover:!0,children:[Object(M.jsx)(x.a,{children:Object(M.jsx)(j.a,{onClick:function(){return function(t){var a=Object(o.a)(K);a.splice(t,1),Q(a),e.onChange(e.name,a,!1)}(a)},color:"secondary",variant:"outlined",size:"small",children:"X"})}),Object(M.jsx)(x.a,{children:Object(M.jsx)(I.a,{required:e.required,placeholder:"",value:t,multiline:!1,autoFocus:e.autoFocus&&0===a,onChange:function(t,n,i){return function(t,a,n){var i=Object(o.a)(K);i[n]=t,Q(i),e.onChange(e.name,i,!1)}(n,0,a)},display:"inline-block",onEnter:dt,validate:lt,errorText:"Must match: "+e.verifier_regex})})]},"array"+e.name+a)})),Object(M.jsx)(v.a,{hover:!0,children:Object(M.jsx)(x.a,{children:Object(M.jsx)(j.a,{onClick:dt,size:"small",variant:"outlined",color:"primary",children:"+"})})})]})]})});case"String":return Object(M.jsx)(I.a,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,onChange:Ze,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:lt,errorText:"Must match: "+e.verifier_regex});case"Number":return Object(M.jsx)(I.a,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,type:"number",onChange:Xe,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:lt,errorText:"Must match: "+e.verifier_regex});case"Boolean":return Object(M.jsx)(S.a,{checked:L,onChange:et});case"File":return Object(M.jsxs)(j.a,{variant:"contained",component:"label",children:[""===We.name?"Select File":We.name,Object(M.jsx)("input",{onChange:tt,type:"file",hidden:!0})," "]});case"LinkInfo":return Object(M.jsx)(w.a,{children:Object(M.jsx)(C.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:function(t){!function(t){var a,n=(a=e.choices[t].source.id===e.callback_id?e.choices[t].destination:e.choices[t].source).c2profileparametersinstances.reduce((function(a,n){return n.c2_profile_id===e.choices[t].c2profile.id?Object(s.a)(Object(s.a)({},a),{},Object(c.a)({},n.c2profileparameter.name,n.c2profileparameter.crypto_type?{crypto_type:n.c2profileparameter.crypto_type,enc_key:n.enc_key,dec_key:n.dec_key}:n.value)):Object(s.a)({},a)}),{}),r={host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:e.choices[t].c2profile.name,parameters:n}};e.onChange(e.name,r,!1),i(t)}(t.target.value)},input:Object(M.jsx)(D.a,{}),children:e.choices.map((function(t,a){return Object(M.jsx)("option",{value:a,children:t.display},e.name+a)}))})});case"PayloadList":return Object(M.jsx)(w.a,{children:Object(M.jsx)(C.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Qe,input:Object(M.jsx)(D.a,{}),children:e.choices.map((function(t,a){return Object(M.jsx)("option",{value:t.uuid,children:t.display},e.name+a)}))})});case"AgentConnect":return Object(M.jsxs)(y.a,{component:k.a,className:"mythicElement",children:[Object(M.jsx)(O.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:Object(M.jsxs)(g.a,{children:[Ee?Object(M.jsxs)(b.a.Fragment,{children:[Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{style:{width:"6em"},children:"Hostname"}),Object(M.jsx)(x.a,{children:Object(M.jsx)(I.a,{required:!0,placeholder:"hostname",value:ae,multiline:!1,autoFocus:e.autoFocus,onChange:rt,display:"inline-block"})})]}),Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{children:"Payload on that host"}),Object(M.jsx)(x.a,{children:Object(M.jsx)(w.a,{children:Object(M.jsx)(C.a,{native:!0,value:de,onChange:ct,input:Object(M.jsx)(D.a,{}),children:e.payload_choices?e.payload_choices.map((function(t,a){return Object(M.jsx)("option",{value:a,children:t.display},e.name+"newpayload"+a)})):Object(M.jsx)("option",{value:"-1",children:"No Payloads"},e.name+"nooptionnewpayload")})})})]}),Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{children:Object(M.jsxs)(j.a,{component:"span",style:{color:r.palette.success.main,padding:0},onClick:ot,children:[Object(M.jsx)($.a,{}),"Add"]})}),Object(M.jsx)(x.a,{children:Object(M.jsxs)(j.a,{component:"span",style:{color:r.palette.warning.main,padding:0},onClick:function(){Le(!1)},children:[Object(M.jsx)(F.a,{}),"Cancel"]})})]})]}):null,Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{style:{width:"6em"},children:"Host"}),Object(M.jsx)(x.a,{children:Object(M.jsx)(w.a,{children:Object(M.jsx)(C.a,{native:!0,value:pe,onChange:at,input:Object(M.jsx)(D.a,{}),children:ce.map((function(t,a){return Object(M.jsx)("option",{value:a,children:t.host},e.name+"connecthost"+a)}))})})})]}),Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{children:"Payload"}),Object(M.jsx)(x.a,{children:Object(M.jsx)(w.a,{children:Object(M.jsx)(C.a,{native:!0,value:_e,onChange:nt,input:Object(M.jsx)(D.a,{}),children:Oe.map((function(t,a){return Object(M.jsx)("option",{value:a,children:t.display},e.name+"connectagent"+a)}))})})})]}),!Ee&&Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{children:Object(M.jsxs)(j.a,{component:"span",style:{color:r.palette.success.main,padding:0},onClick:function(){Le(!0)},children:[Object(M.jsx)($.a,{}),"Add"]})}),Object(M.jsx)(x.a,{children:Object(M.jsxs)(j.a,{component:"span",style:{color:r.palette.error.main,padding:0},onClick:st,children:[Object(M.jsx)(A.a,{}),"Remove"]})})]}),Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{children:"C2 Profile"}),Object(M.jsx)(x.a,{children:Object(M.jsx)(w.a,{children:Object(M.jsx)(C.a,{native:!0,value:Te,onChange:it,input:Object(M.jsx)(D.a,{}),children:Ce.map((function(t,a){return Object(M.jsx)("option",{value:a,children:t.name},e.name+"connectprofile"+a)}))})})})]})]})}),Ce.length>0?Object(M.jsxs)(O.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(M.jsx)(_.a,{children:Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{style:{width:"30%"},children:"Parameter"}),Object(M.jsx)(x.a,{children:"Value"})]})}),Object(M.jsx)(g.a,{children:Ce[Te].parameters.map((function(t,a){return Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{children:t.name}),Object(M.jsx)(x.a,{children:Object(M.jsx)("pre",{children:JSON.stringify(t.value,null,2)})})]},"agentconnectparameters"+e.name+a)}))})]}):null]});case"Credential-JSON":return Object(M.jsxs)(b.a.Fragment,{children:[Object(M.jsx)(W.a,{fullWidth:!0,maxWidth:"md",open:Ne,onClose:function(){Re(!1)},innerDialog:Object(M.jsx)(z.a,{onSubmit:ut,onClose:function(){Re(!1)}})}),Object(M.jsx)(w.a,{style:{width:"100%"},children:Object(M.jsx)(C.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Je,input:Object(M.jsx)(D.a,{}),children:m.map((function(t,a){return Object(M.jsx)("option",{value:a,children:t.account+"@"+t.realm+" - "+t.credential_text.substring(0,10)+" - "+t.comment},e.name+a)}))})}),Object(M.jsx)(j.a,{size:"small",color:"primary",onClick:function(){Re(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Account":return Object(M.jsxs)(b.a.Fragment,{children:[Object(M.jsx)(W.a,{fullWidth:!0,maxWidth:"md",open:Ne,onClose:function(){Re(!1)},innerDialog:Object(M.jsx)(z.a,{onSubmit:ut,onClose:function(){Re(!1)}})}),Object(M.jsx)(w.a,{style:{width:"100%"},children:Object(M.jsx)(C.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Qe,input:Object(M.jsx)(D.a,{}),children:m.map((function(t,a){return Object(M.jsx)("option",{value:t.account,children:t.comment.length>0?t.comment+" ( "+t.account+" )":t.account},e.name+a)}))})}),Object(M.jsx)(j.a,{size:"small",color:"primary",onClick:function(){Re(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Realm":return Object(M.jsxs)(b.a.Fragment,{children:[Object(M.jsx)(W.a,{fullWidth:!0,maxWidth:"md",open:Ne,onClose:function(){Re(!1)},innerDialog:Object(M.jsx)(z.a,{onSubmit:ut,onClose:function(){Re(!1)}})}),Object(M.jsx)(w.a,{style:{width:"100%"},children:Object(M.jsx)(C.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Qe,input:Object(M.jsx)(D.a,{}),children:m.map((function(t,a){return Object(M.jsx)("option",{value:t.realm,children:t.comment.length>0?t.comment+" ( "+t.realm+" )":t.realm},e.name+a)}))})}),Object(M.jsx)(j.a,{size:"small",color:"primary",onClick:function(){Re(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Type":return Object(M.jsxs)(b.a.Fragment,{children:[Object(M.jsx)(W.a,{fullWidth:!0,maxWidth:"md",open:Ne,onClose:function(){Re(!1)},innerDialog:Object(M.jsx)(z.a,{onSubmit:ut,onClose:function(){Re(!1)}})}),Object(M.jsx)(w.a,{style:{width:"100%"},children:Object(M.jsx)(C.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Qe,input:Object(M.jsx)(D.a,{}),children:m.map((function(t,a){return Object(M.jsx)("option",{value:t.type,children:t.type},e.name+a)}))})}),Object(M.jsx)(j.a,{size:"small",color:"primary",onClick:function(){Re(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Credential":return Object(M.jsxs)(b.a.Fragment,{children:[Object(M.jsx)(W.a,{fullWidth:!0,maxWidth:"md",open:Ne,onClose:function(){Re(!1)},innerDialog:Object(M.jsx)(z.a,{onSubmit:ut,onClose:function(){Re(!1)}})}),Object(M.jsx)(w.a,{style:{width:"100%"},children:Object(M.jsx)(C.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Qe,input:Object(M.jsx)(D.a,{}),children:m.map((function(t,a){return Object(M.jsx)("option",{value:t.credential_text,style:{textOverflow:"ellipsis"},children:t.comment.length>0?t.comment+" ( "+t.credential_text+" )":t.credential_text},e.name+a)}))})}),Object(M.jsx)(j.a,{size:"small",color:"primary",onClick:function(){Re(!0)},variant:"contained",children:"New Credential"})]});default:return null}}()})]},"buildparam"+e.id)}var K,Q,J,Y,Z,X,ee,te,ae,ne=a(249),ie=a(219),re=a(849),ce=a(376),oe=Object(q.a)(K||(K=Object(d.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}}) {\n    id\n    command {\n      cmd\n      attributes\n      id\n    }\n  }\n}\n"]))),se=Object(q.a)(Q||(Q=Object(d.a)(["\nquery getAllCommandsQuery($payload_type_id: Int!){\n    command(where: {payload_type_id: {_eq: $payload_type_id}, deleted: {_eq: false}}) {\n        attributes\n        cmd\n        id\n    }\n}\n"]))),le=Object(q.a)(J||(J=Object(d.a)(["\nquery getAllEdgesQuery($callback_id: Int!){\n    callbackgraphedge(where: {_or: [{source_id:{_eq: $callback_id}}, {destination_id: {_eq: $callback_id}}]}) {\n        id\n        c2profile {\n          id\n          name\n        }\n        direction\n        destination{\n            agent_callback_id\n            host\n            id\n            payload {\n              id\n              uuid\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              value\n              id\n              c2_profile_id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        source{\n            agent_callback_id\n            host\n            id\n            payload {\n              uuid\n              id\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              c2_profile_id\n              value\n              id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        end_timestamp\n      }\n    }\n"]))),de=Object(q.a)(Y||(Y=Object(d.a)(['\nquery getAllPayloadsQuery($operation_id: Int!){\n    payload(where: {deleted: {_eq: false}, build_phase: {_eq: "success"}, operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    uuid\n    payloadc2profiles {\n      id\n      c2profile {\n        name\n        id\n      }\n    }\n    payloadtype{\n        id\n        ptype\n    }\n    filemetum {\n        id\n        filename_text\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        name\n        id\n      }\n    }\n  }\n}\n']))),ue=Object(q.a)(Z||(Z=Object(d.a)(["\nquery getAllPayloadsOnHostsQuery($operation_id: Int!){\n    payloadonhost(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, payload: {c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}}) {\n        host\n        id\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n            c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n                c2profile {\n                    name\n                    id\n                }\n                c2profileparameter {\n                    crypto_type\n                    name\n                    id\n                }\n                value\n                enc_key_base64\n                dec_key_base64\n                id\n            }\n        }\n    }\n    callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}, c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}){\n        agent_callback_id\n        host\n        id\n        description\n        crypto_type\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n        }\n        c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n            c2profile {\n                name\n                id\n            }\n            c2profileparameter {\n                crypto_type\n                name\n                id\n            }\n            value\n            enc_key_base64\n            dec_key_base64\n            id\n        }\n    }\n}\n"]))),be=Object(q.a)(X||(X=Object(d.a)(["\n    mutation addPayloadOnHostMutation($host: String!, $payload_id: Int!){\n        insert_payloadonhost(objects: {host: $host, payload_id: $payload_id}) {\n            affected_rows\n          }\n    }\n"]))),je=Object(q.a)(ee||(ee=Object(d.a)(["\n    mutation removePayloadOnHostMutation($payloadOnHostID: Int!){\n        delete_payloadonhost_by_pk(id: $payloadOnHostID) {\n            id\n          }\n    }\n"]))),pe=Object(q.a)(te||(te=Object(d.a)(["\nquery getCommandQuery($id: Int!){\n  command_by_pk(id: $id) {\n    attributes\n    author\n    cmd\n    description\n    help_cmd\n    id\n    needs_admin\n    version\n    payloadtype{\n        ptype\n    }\n    commandparameters {\n      choice_filter_by_command_attributes\n      choices\n      choices_are_all_commands\n      choices_are_loaded_commands\n      default_value\n      description\n      id\n      name\n      required\n      supported_agent_build_parameters\n      supported_agents\n      type\n      dynamic_query_function\n      ui_position\n      parameter_group_name\n      display_name\n      cli_name\n    }\n    commandopsec {\n      authentication\n      id\n      injection_method\n      process_creation\n    }\n  }\n}\n"]))),me=Object(q.a)(ae||(ae=Object(d.a)(["\nquery getCredentialsQuery($operation_id: Int!){\n    credential(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}}){\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n    }\n}\n"])));function he(e){var t=Object(u.useState)({}),a=Object(l.a)(t,2),n=a[0],i=a[1],r=Object(u.useState)([]),d=Object(l.a)(r,2),C=d[0],S=d[1],I=Object(u.useState)("Default"),T=Object(l.a)(I,2),$=T[0],P=T[1],A=Object(u.useState)([]),E=Object(l.a)(A,2),L=E[0],F=E[1],q=Object(u.useState)(!1),R=Object(l.a)(q,2),B=R[0],z=R[1],W=Object(u.useState)({all:!1,loaded:!1,edges:!1,credentials:!1}),H=Object(l.a)(W,2),U=H[0],G=H[1],K=Object(ne.a)(se,{fetchPolicy:"no-cache"}),Q=Object(l.a)(K,2),J=Q[0],Y=Q[1].data,Z=Object(ne.a)(oe,{fetchPolicy:"no-cache"}),X=Object(l.a)(Z,2),ee=X[0],te=X[1].data,ae=Object(ne.a)(le,{fetchPolicy:"no-cache"}),he=Object(l.a)(ae,2),fe=he[0],Oe=he[1].data,ge=Object(ne.a)(de,{fetchPolicy:"no-cache"}),xe=Object(l.a)(ge,2),ye=xe[0],_e=xe[1].data,ve=Object(ne.a)(ue,{fetchPolicy:"no-cache"}),ke=Object(l.a)(ve,2),we=ke[0],Ce=ke[1].data,Se=Object(ne.a)(me,{fetchPolicy:"no-cache"}),De=Object(l.a)(Se,2),Ie=De[0],Te=De[1].data,$e=Object(N.a)(be,{onCompleted:function(t){we({variables:{operation_id:e.operation_id}})}}),Pe=Object(l.a)($e,1)[0],Ae=Object(N.a)(je,{onCompleted:function(t){we({variables:{operation_id:e.operation_id}})}}),Ee=Object(l.a)(Ae,1)[0];Object(ie.a)(pe,{variables:{id:e.command.id},onCompleted:function(t){var a={all:!1,loaded:!1,edges:!1,credentials:!1},n=[];t.command_by_pk.commandparameters.forEach((function(e){n.includes(e.parameter_group_name)||n.push(e.parameter_group_name),"LinkInfo"===e.type?a.edges=!0:e.choices_are_all_commands?a.all=!0:e.choices_are_loaded_commands?a.loaded=!0:"AgentConnect"===e.type?(a.connect=!0,a.payloads=!0):"PayloadList"===e.type?a.payloads=!0:e.type.includes("Credential")&&(a.credentials=!0)})),n.sort(),S(n),e.command.groupName&&n.includes(e.command.groupName)?P(e.command.groupName):n.includes("Default")||P(n[0]),i(Object(s.a)({},t.command_by_pk)),a.edges&&fe({variables:{callback_id:e.callback_id}}),a.all&&J({variables:{payload_type_id:e.payloadtype_id}}),a.loaded&&ee({variables:{callback_id:e.callback_id}}),a.payloads&&ye({variables:{operation_id:e.operation_id}}),a.connect&&we({variables:{operation_id:e.operation_id}}),a.credentials&&Ie({variables:{operation_id:e.operation_id}}),G(a),z(Object(s.a)({},t))}});var Le=function(e,t){var a=new Set(t);return Object(o.a)(new Set(e)).filter((function(e){return a.has(e)}))};Object(u.useEffect)((function(){var t=function(t){if(t.length>0){var a=t[0].payloads[0].c2info[0].parameters.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.name,t.value))}),{}),n={host:t[0].host,agent_uuid:t[0].payloads[0].uuid,c2_profile:{name:t[0].payloads[0].c2info[0].name,parameters:a}};return"callback"===t[0].payloads[0].type&&(n.callback_uuid=e.choices[0].payloads[0].agent_callback_id),n}return{}},a=function(t){var a;if(t.length>0){var n=(a=t[0].source.id===e.callback_id?t[0].destination:t[0].source).c2profileparametersinstances.reduce((function(e,a){return a.c2_profile_id===t[0].c2profile.id?Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},a.c2profileparameter.name,a.c2profileparameter.crypto_type?{crypto_type:a.c2profileparameter.crypto_type,enc_key:a.enc_key_base64,dec_key:a.dec_key_base64}:a.value)):Object(s.a)({},e)}),{});return{host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:t[0].c2profile.name,parameters:n}}}return{}};if(B&&(!U.loaded||te)&&(!U.all||Y)&&(!U.edges||Oe)&&(!U.payloads||_e)&&(!U.connect||Ce)&&(!U.credentials||Te)){var n=B.command_by_pk.commandparameters.reduce((function(n,i){if(i.parameter_group_name!==$)return Object(o.a)(n);switch(i.type){case"Boolean":return i.name in e.command.parsedParameters?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):i.default_value?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:"true"===i.default_value.toLowerCase()})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:!1})]);case"String":return i.name in e.command.parsedParameters?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:i.default_value})]);case"Number":return i.name in e.command.parsedParameters?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:""===i.default_value?0:parseInt(i.default_value)})]);case"Array":return i.name in e.command.parsedParameters?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):i.default_value.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:JSON.parse(i.default_value)})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:[]})]);case"Choice":case"ChoiceMultiple":var r=i.choices.split("\n"),d=i.default_value;"ChoiceMultiple"===i.type?d=""!==i.default_value?JSON.parse(i.default_value):[]:r.length>0&&(d=""===i.default_value?r[0]:i.default_value);var u=JSON.parse(i.choice_filter_by_command_attributes);return i.choices_are_all_commands?((r=(r=Object(o.a)(Y.command)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.attributes),i=0,r=Object.entries(u);i<r.length;i++){var c=Object(l.a)(r[i],2),s=c[0],d=c[1];"spawn_and_injectable"===s?d!==n[s]&&(a=!1):"supported_os"===s&&d.length>0&&0===Le(d,n[s]).length&&(a=!1)}return a?[].concat(Object(o.a)(e),[t.cmd]):Object(o.a)(e)}),[])).sort(),r.length>0&&(d="ChoiceMultiple"===i.type?[]:r[0])):i.choices_are_loaded_commands&&(r=(r=Object(o.a)(te.loadedcommands)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.command.attributes),i=0,r=Object.entries(u);i<r.length;i++){var c=Object(l.a)(r[i],2),s=c[0],d=c[1];"spawn_and_injectable"===s?d!==n[s]&&(a=!1):"supported_os"===s&&d.length>0&&0===Le(d,n[s]).length&&(a=!1)}return a?[].concat(Object(o.a)(e),[t.command.cmd]):Object(o.a)(e)}),[])).length>0&&(d="ChoiceMultiple"===i.type?[]:r[0]),i.name in e.command.parsedParameters?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{choices:r,value:e.command.parsedParameters[i.name]})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{choices:r,default_value:d,value:d})]);case"File":return[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:{}})]);case"Credential-JSON":return Te.credential.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:Te.credential[0],choices:Te.credential})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:{},choices:[]})]);case"Credential-Account":return Te.credential.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:Te.credential[0].account,choices:Te.credential})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:"",choices:[]})]);case"Credential-Realm":return Te.credential.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:Te.credential[0].realm,choices:Te.credential})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:"",choices:[]})]);case"Credential-Type":return Te.credential.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:Te.credential[0].type,choices:Te.credential})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:"",choices:[]})]);case"Credential-Credential":return Te.credential.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:Te.credential[0].credential_text,choices:Te.credential})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{value:"",choices:[]})]);case"AgentConnect":var b=_e.payload.reduce((function(e,t){var a=t.payloadc2profiles.reduce((function(e,t){return[].concat(Object(o.a)(e),[t.c2profile.name])}),[]).join(",");return[].concat(Object(o.a)(e),[Object(s.a)(Object(s.a)({},t),{},{display:t.filemetum.filename_text+" - "+a+" - "+t.tag})])}),[]),j=Ce.callback.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;for(var n=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[].concat(Object(o.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),i=[],r=0,d=Object.entries(n);r<d.length;r++){var u=Object(l.a)(d[r],2),b=u[0],j=u[1];i.push({name:b,parameters:j})}var p=Object(s.a)(Object(s.a)(Object(s.a)({},t.registered_payload),{},{c2info:i,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return Object(s.a)(Object(s.a)({},e),{},{payloads:[].concat(Object(o.a)(e.payloads),[p])})}return e}));if(a)return n;for(var i=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[].concat(Object(o.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],d=0,u=Object.entries(i);d<u.length;d++){var b=Object(l.a)(u[d],2),j=b[0],p=b[1];r.push({name:j,parameters:p})}var m=Object(s.a)(Object(s.a)(Object(s.a)({},t.registered_payload),{},{c2info:r,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return[].concat(Object(o.a)(e),[{host:t.host,payloads:[m]}])}),[]),p=Ce.payloadonhost.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;var n=!1;if(e.payloads.forEach((function(e){e.id===t.payload.id&&(n=!0)})),n)return e;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[].concat(Object(o.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],d=0,u=Object.entries(i);d<u.length;d++){var b=Object(l.a)(u[d],2),j=b[0],p=b[1];r.push({name:j,parameters:p})}var m=Object(s.a)(Object(s.a)({},t.payload),{},{c2info:r,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return Object(s.a)(Object(s.a)({},e),{},{payloads:[].concat(Object(o.a)(e.payloads),[m])})}return e}));if(a)return n;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[].concat(Object(o.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],d=0,u=Object.entries(i);d<u.length;d++){var b=Object(l.a)(u[d],2),j=b[0],p=b[1];r.push({name:j,parameters:p})}var m=Object(s.a)(Object(s.a)({},t.payload),{},{c2info:r,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return[].concat(Object(o.a)(e),[{host:t.host,payloads:[m]}])}),[]),m=j.reduce((function(e,t){var a=e.findIndex((function(e){return e.host===t.host}));return a>-1?(e[a].payloads=[].concat(Object(o.a)(e[a].payloads),Object(o.a)(t.payloads)),Object(o.a)(e)):[].concat(Object(o.a)(e),[Object(s.a)({},t)])}),Object(o.a)(p));return console.log("updating choices and payload choices",m,b),[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{choices:m,payload_choices:b,value:t(p)})]);case"PayloadList":var h=i.supported_agents.split(",");-1!==h.indexOf("")&&h.splice(h.indexOf(""));var f=JSON.parse(i.supported_agent_build_parameters),O=_e.payload.reduce((function(e,t){var a=t.payloadc2profiles.reduce((function(e,t){return[].concat(Object(o.a)(e),[t.c2profile.name])}),[]).join(",");if(h.length>0&&!h.includes(t.payloadtype.ptype))return e;var n=!0;if(t.payloadtype.ptype in f)for(var i=function(){var e=Object(l.a)(c[r],2),a=e[0],i=e[1];t.buildparameterinstances.forEach((function(e){e.buildparameter.name===a&&e.parameter!==i&&(n=!1)}))},r=0,c=Object.entries(f[t.payloadtype.ptype]);r<c.length;r++)i();return n?[].concat(Object(o.a)(e),[Object(s.a)(Object(s.a)({},t),{},{display:t.filemetum.filename_text+" - "+a+" - "+t.tag})]):e}),[]);return O.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{choices:O,default_value:O[0].uuid,value:O[0].uuid})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{choices:O,value:null})]);case"LinkInfo":var g=Oe.callbackgraphedge.reduce((function(e,t){return t.source.id===t.destination.id?e:1===t.direction?[].concat(Object(o.a)(e),[Object(s.a)(Object(s.a)({},t),{},{display:"Callback "+t.source.id+" --"+t.c2profile.name+"--\x3e Callback "+t.destination.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):2===t.direction?[].concat(Object(o.a)(e),[Object(s.a)(Object(s.a)({},t),{},{display:"Callback "+t.destination.id+"-> "+t.c2profile.name+"--\x3e Callback "+t.source.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):e}),[]);return g.length>0?[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{choices:g,value:a(g)})]):[].concat(Object(o.a)(n),[Object(s.a)(Object(s.a)({},i),{},{choices:g,value:{}})]);default:return[].concat(Object(o.a)(n),[Object(s.a)({},i)])}}),[]).sort((function(e,t){return e.ui_position>t.ui_position?1:-1}));n.length>0&&(n[0].autoFocus=!0),F(n)}}),[$,B,te,Y,Oe,U,_e,Te,Ce,e.callback_id,e.choices]);var Fe=function(){var t=L.reduce((function(e,t){switch(t.type){case"String":case"Boolean":case"Number":case"Choice":case"ChoiceMultiple":case"Credential-Account":case"Credential-Realm":case"Credential-Type":case"Credential-Credential":case"AgentConnect":case"PayloadList":case"Array":case"LinkInfo":return Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.name,t.value));case"File":return Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.name,t.value.name));case"Credential-JSON":return Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.name,{account:t.value.account,comment:t.value.comment,credential:t.value.credential_text,realm:t.value.realm,type:t.value.type}));default:return Object(s.a)({},e)}}),{}),a=L.reduce((function(e,t){return"File"===t.type?Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.name,t.value.contents)):Object(s.a)({},e)}),{});e.onSubmit(e.command.cmd,JSON.stringify(t),JSON.stringify(a),$)},qe=function(e,t){Pe({variables:{host:e,payload_id:t}})},Ne=function(e){Ee({variables:{payloadOnHostID:e}})},Re=function(e,t,a){var n=L.map((function(a){return a.name===e?Object(s.a)(Object(s.a)({},a),{},{value:t}):Object(s.a)({},a)}));F(n)};return Object(M.jsxs)(b.a.Fragment,{children:[Object(M.jsxs)(h.a,{id:"form-dialog-title",children:[e.command.cmd,"'s Parameters"]}),Object(M.jsxs)(m.a,{dividers:!0,children:[Object(M.jsxs)(f.a,{component:"div",children:[Object(M.jsx)("b",{children:"Help"})," ",Object(M.jsx)("pre",{style:{margin:0},children:e.command.help_cmd}),Object(M.jsx)("b",{children:"Description"})," ",Object(M.jsx)("pre",{style:{margin:0,wordBreak:"break-all",overflow:"word-wrap",whiteSpace:"pre-wrap"},children:e.command.description}),Object(M.jsx)("b",{children:"Requires Admin?"})," ",e.command.needs_admin?"True":"False",C.length>1&&Object(M.jsx)(w.a,{style:{width:"100%"},children:Object(M.jsx)(re.a,{select:!0,label:"Parameter Group",value:$,onChange:function(e){P(e.target.value)},input:Object(M.jsx)(D.a,{}),children:C.map((function(e,t){return Object(M.jsx)(ce.a,{value:e,children:e},"paramgroup"+t)}))})})]}),Object(M.jsx)(y.a,{component:k.a,className:"mythicElement",children:Object(M.jsxs)(O.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(M.jsx)(_.a,{children:Object(M.jsxs)(v.a,{children:[Object(M.jsx)(x.a,{style:{width:"30%"},children:"Parameter"}),Object(M.jsx)(x.a,{children:"Value"})]})}),Object(M.jsx)(g.a,{children:L.map((function(t){return Object(M.jsx)(V,Object(s.a)(Object(s.a)({onSubmit:Fe,onChange:Re,commandInfo:n},t),{},{callback_id:e.callback_id,onAgentConnectAddNewPayloadOnHost:qe,onAgentConnectRemovePayloadOnHost:Ne}),"taskparameterrow"+t.id)}))})]})})]}),Object(M.jsxs)(p.a,{children:[Object(M.jsx)(j.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(M.jsx)(j.a,{onClick:Fe,variant:"contained",color:"secondary",children:"Submit"})]})]})}},14:function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return _})),a.d(t,"c",(function(){return v})),a.d(t,"d",(function(){return k}));var n=a(6),i=a(2),r=a(1),c=a.n(r),o=a(857),s=a(69),l=a(124),d=a(123),u=a(131),b=a(18),j=a(245),p=a(247),m=a(84),h=a(244),f=a(246),O=a(130),g=a(83),x=a(0);function y(e){var t=c.a.useRef(null);return c.a.useEffect((function(){if(e.open){var a=t.current;null!==a&&a.focus()}}),[e.open]),Object(x.jsx)(o.a,{open:e.open,onClose:e.onClose,scroll:"paper",maxWidth:e.maxWidth,fullWidth:e.fullWidth,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:e.innerDialog})}function _(e){var t=c.a.useState(""),a=Object(i.a)(t,2),n=a[0],o=a[1],j=function(){e.onSubmit(n),e.onClose()};return Object(r.useEffect)((function(){o(e.value)}),[e.value]),Object(x.jsxs)(c.a.Fragment,{children:[Object(x.jsx)(u.a,{id:"form-dialog-title",children:e.title}),Object(x.jsx)(d.a,{dividers:!0,children:Object(x.jsx)(b.a,{autoFocus:!0,onEnter:j,onChange:function(e,t,a){o(t)},value:n})}),Object(x.jsxs)(l.a,{children:[Object(x.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(s.a,{onClick:j,variant:"contained",color:"secondary",children:"Submit"})]})]})}function v(e){var t=c.a.useState([]),a=Object(i.a)(t,2),n=a[0],o=a[1],b=c.a.useState("dictionary"),y=Object(i.a)(b,2),_=y[0],v=y[1],k=c.a.useState([]),w=Object(i.a)(k,2),C=w[0],S=w[1];return Object(r.useEffect)((function(){var t=[];try{var a;if((a=e.value.constructor===Object?e.value:JSON.parse(e.value)).constructor===Object)for(var n in a)a[n].constructor===Object||Array.isArray(a[n])?t.push({name:n,value:JSON.stringify(a[n],null,2)}):t.push({name:n,value:a[n]}),S([e.leftColumn,e.rightColumn]);else v("array"),a.length>0?(S(Object.keys(a[0])),t=a):S([])}catch(i){console.log(i)}o(t)}),[e.value,e.leftColumn,e.rightColumn]),Object(x.jsxs)(c.a.Fragment,{children:[Object(x.jsx)(u.a,{id:"form-dialog-title",children:e.title}),Object(x.jsx)(d.a,{dividers:!0,children:Object(x.jsx)(g.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(x.jsx)(h.a,{component:g.a,className:"mythicElement",children:Object(x.jsxs)(j.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(f.a,{children:Object(x.jsx)(O.a,{children:C.map((function(e,t){return Object(x.jsx)(m.a,{children:e},"header"+t)}))})}),Object(x.jsx)(p.a,{children:"dictionary"===_?n.map((function(e,t){return Object(x.jsxs)(O.a,{hover:!0,children:[Object(x.jsx)(m.a,{children:e.name}),Object(x.jsx)(m.a,{style:{wordBreak:"break-all",whiteSpace:"pre-wrap"},children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)})):n.map((function(e,t){return Object(x.jsx)(O.a,{hover:!0,children:Object.keys(e).map((function(a){return Object(x.jsx)(m.a,{children:e[a]},"row"+t+"cell"+a)}))},"row"+t)}))})]})})})}),Object(x.jsx)(l.a,{children:Object(x.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function k(e){var t=c.a.useState([]),a=Object(i.a)(t,2),o=a[0],b=a[1];return Object(r.useEffect)((function(){var t=e.keys.reduce((function(t,a){return void 0!==e.value[a]&&null!==e.value[a]&&""!==e.value[a]?[].concat(Object(n.a)(t),[{name:a,value:e.value[a]}]):Object(n.a)(t)}),[]);b(t)}),[e.value,e.keys]),Object(x.jsxs)(c.a.Fragment,{children:[Object(x.jsx)(u.a,{id:"form-dialog-title",children:e.title}),Object(x.jsx)(d.a,{dividers:!0,children:Object(x.jsx)(g.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(x.jsx)(h.a,{component:g.a,className:"mythicElement",children:Object(x.jsxs)(j.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(f.a,{children:Object(x.jsxs)(O.a,{children:[Object(x.jsx)(m.a,{children:e.leftColumn}),Object(x.jsx)(m.a,{children:e.rightColumn})]})}),Object(x.jsx)(p.a,{children:o.map((function(e,t){return Object(x.jsxs)(O.a,{children:[Object(x.jsx)(m.a,{children:e.name}),Object(x.jsx)(m.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})})}),Object(x.jsx)(l.a,{children:Object(x.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},142:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(6),i=a(2),r=a(1),c=a.n(r),o=a(69),s=a(124),l=a(123),d=a(131),u=a(376),b=a(373),j=a(378),p=a(374),m=a(372),h=a(60),f=a(0);function O(e){var t=c.a.useState([]),a=Object(i.a)(t,2),O=a[0],g=a[1],x=c.a.useState(""),y=Object(i.a)(x,2),_=y[0],v=y[1],k=Object(r.useRef)(null),w=Object(h.a)();return Object(r.useEffect)((function(){var t=Object(n.a)(e.options);g(t),t.length>0?v(t[0]):v("")}),[e.options]),Object(f.jsxs)(c.a.Fragment,{children:[Object(f.jsx)(d.a,{children:e.title}),Object(f.jsx)(l.a,{dividers:!0,children:Object(f.jsx)(c.a.Fragment,{children:Object(f.jsxs)(b.a,{style:{width:"100%"},children:[Object(f.jsx)(p.a,{ref:k,children:"Options"}),Object(f.jsxs)(j.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:_,onChange:function(e){v(e.target.value)},input:Object(f.jsx)(m.a,{style:{width:"100%"}}),children:[Object(f.jsx)(u.a,{value:"",children:Object(f.jsx)("em",{children:"None"})}),O.map((function(t){return Object(f.jsx)(u.a,{value:t,children:t[e.display]},t[e.identifier])}))]})]})})}),Object(f.jsxs)(s.a,{children:[Object(f.jsx)(o.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(f.jsx)(o.a,{onClick:function(){e.onSubmit(_),e.dontCloseOnSubmit||e.onClose()},variant:"contained",style:{backgroundColor:w.palette.success.main},children:e.action})]})]})}},166:function(e,t,a){"use strict";function n(e){try{var t=document.createElement("textarea");return t.value=e,""===t.value&&(t.value=" "),t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(a){return console.log("warning","Failed to copy to clipboard: "+a.toString()),!1}}a.d(t,"a",(function(){return n}))},169:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),i=a(1),r=a.n(i),c=a(69),o=a(124),s=a(123),l=a(131),d=a(18),u=a(378),b=a(372),j=a(374),p=a(376),m=a(373),h=a(558),f=a(143),O=a(0),g={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},x=Object(f.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}}));function y(e){var t=r.a.useState("plaintext"),a=Object(n.a)(t,2),i=a[0],f=a[1],y=r.a.useState(""),_=Object(n.a)(y,2),v=_[0],k=_[1],w=r.a.useState(""),C=Object(n.a)(w,2),S=C[0],D=C[1],I=r.a.useState(""),T=Object(n.a)(I,2),$=T[0],P=T[1],A=r.a.useState(""),E=Object(n.a)(A,2),L=E[0],F=E[1],q=x();return Object(O.jsxs)(r.a.Fragment,{children:[Object(O.jsx)(l.a,{id:"form-dialog-title",children:"Register New Credential"}),Object(O.jsx)(s.a,{dividers:!0,children:Object(O.jsxs)(r.a.Fragment,{children:[Object(O.jsxs)(m.a,{className:q.formControl,children:[Object(O.jsx)(j.a,{id:"operator-chip-label",children:"Which Type of Credential"}),Object(O.jsx)(u.a,{labelId:"operator-chip-label",id:"operator-chip",value:i,onChange:function(e){f(e.target.value)},input:Object(O.jsx)(b.a,{}),MenuProps:g,children:["plaintext","ticket","hash","certificate","key","hex"].map((function(e){return Object(O.jsx)(p.a,{value:e,children:Object(O.jsx)(h.a,{primary:e})},e)}))})]}),Object(O.jsx)(d.a,{value:v,onChange:function(e,t,a){k(t)},name:"Account Name"}),Object(O.jsx)(d.a,{value:S,onChange:function(e,t,a){D(t)},name:"Realm or Domain"}),Object(O.jsx)(d.a,{value:L,onChange:function(e,t,a){F(t)},name:"Comment"}),Object(O.jsx)(d.a,{multiline:!0,value:$,onChange:function(e,t,a){P(t)},name:"Credential"})]})}),Object(O.jsxs)(o.a,{children:[Object(O.jsx)(c.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(O.jsx)(c.a,{onClick:function(){e.onSubmit({realm:S,account:v,comment:L,credential:$,type:i}),e.onClose()},color:"primary",variant:"contained",children:"Create"})]})]})}},18:function(e,t,a){"use strict";var n=a(477),i=a(478),r=a(548),c=a(546),o=a(1),s=a.n(o),l=a(849),d=a(13),u=a(0),b=Object(d.a)({root:{"& input:valid + fieldset":{borderColor:"grey",borderWidth:1},"& input:invalid + fieldset":{borderColor:"red",borderWidth:2},"& input:valid:focus + fieldset":{borderLeftWidth:6,padding:"4px !important"}}})(l.a),j=function(e){Object(r.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onChange=function(t){var a=e.props.name,n=t.target.value,i=!!e.props.validate&&e.props.validate(n);e.props.onChange(a,n,i)},e.checkError=function(){return!!e.props.validate&&e.props.validate(e.props.value)},e.onKeyPress=function(t){"Enter"===t.key?void 0!==e.props.onEnter&&e.props.onEnter():e.onChange(t)},e}return Object(i.a)(a,[{key:"render",value:function(){return Object(u.jsx)("div",{style:{width:this.props.width?this.props.width+"rem":"100%"},children:Object(u.jsx)(b,{fullWidth:!0,placeholder:this.props.placeholder,value:this.props.value,onChange:this.onChange,onKeyPress:this.onKeyPress,label:this.props.name,autoFocus:!!this.props.autoFocus,variant:"outlined",disabled:void 0!==this.props.disabled&&this.props.disabled,required:!!this.props.requiredValue&&this.props.requiredValue,InputLabelProps:this.props.inputLabelProps,multiline:!!this.props.multiline&&this.props.multiline,error:this.checkError(),type:void 0===this.props.type?"text":this.props.type,InputProps:this.props.InputProps,helperText:this.checkError()?this.props.errorText:this.props.helperText,style:{padding:0,marginBottom:this.props.marginBottom?this.props.marginBottom:"10px"}})})}}]),a}(s.a.Component);t.a=j},19:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return l}));var n=a(3),i=a(152),r=Object(i.c)({loggedIn:!1,user:null,access_token:null,refresh_token:null}),c=Object(i.c)(!1),o=function(e){localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),localStorage.setItem("user",JSON.stringify(e.user)),r(Object(n.a)({loggedIn:!0},e))},s=function(e){localStorage.setItem("access_token",e.access_token),r(Object(n.a)({loggedIn:!0,access_token:localStorage.getItem("access_token")},r()))},l=function(){console.log("failed refresh"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),r({loggedIn:!1,access_token:null,refresh_token:null,user:null})}},206:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(369),i=Object(n.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"}}})},207:function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n,i,r=a(6),c=a(2),o=a(3),s=a(7),l=a(1),d=a.n(l),u=a(218),b=a(83),j=a(62),p=a(66),m=a(19),h=a(324),f=a(143),O=a(13),g=a(28),x=a(880),y=a(872),_=a(871),v=a(94),k=a.n(v),w=a(504),C=a.n(w),S=a(861),D=a(60),I=a(870),T=a(869),$=a(171),P=a(67),A=a(249),E=a(490),L=a(0),F=Object(P.a)(n||(n=Object(s.a)(["\nfragment taskData on task {\n  comment\n  callback_id\n  commentOperator{\n      username\n  }\n  completed\n  id\n  operator{\n      username\n  }\n  original_params\n  display_params\n  status\n  timestamp\n  command {\n    cmd\n    id\n  }\n  command_name\n  responses_aggregate {\n    aggregate{\n      count\n      max {\n        timestamp\n      }\n    }\n  }\n  opsec_pre_blocked\n  opsec_pre_bypassed\n  opsec_post_blocked\n  opsec_post_bypassed\n  tasks {\n      id\n  }\n  token {\n    id\n  }\n}\n"]))),q=Object(P.a)(i||(i=Object(s.a)(["\n","\nquery getSubTasking($task_id: Int!){\n    task(where: {parent_task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n        ...taskData\n  }\n}\n "])),F),N=Object(f.a)((function(e){return{root:{marginTop:"3px",marginLeft:"3px",marginRight:"0px",height:"auto",width:"99%"},heading:{fontSize:e.typography.pxToRem(15),display:"inline",cursor:"default"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"auto",display:"block",textOverflow:"ellipsis",wordBreak:"break-all",maxWidth:"100%"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",width:"100%",whiteSpace:"nowrap",display:"inline-block"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"100%",whiteSpace:"break-all",wordBreak:"break-all"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center",marginRight:0},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"}}})),R=Object(f.a)((function(e){return{root:{margin:0,padding:0,height:"auto",width:"100%",whiteSpace:"break-all",wordBreak:"break-all"},content:{margin:0,height:"100%",padding:0},expandIcon:{margin:0},expanded:{marginRight:0}}}));function B(e){return Object(L.jsx)($.a,Object(o.a)(Object(o.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(L.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 11.023h-11.826q-.375 0-.669.281t-.294.682v0q0 .401.294 .682t.669.281h11.826q.375 0 .669-.281t.294-.682v0q0-.401-.294-.682t-.669-.281z"})}))}function z(e){return Object(L.jsx)($.a,Object(o.a)(Object(o.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(L.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 12.977h-4.923v4.896q0 .401-.281.682t-.682.281v0q-.375 0-.669-.281t-.294-.682v-4.896h-4.923q-.401 0-.682-.294t-.281-.669v0q0-.401.281-.682t.682-.281h4.923v-4.896q0-.401.294-.682t.669-.281v0q.401 0 .682.281t.281.682v4.896h4.923q.401 0 .682.281t.281.682v0q0 .375-.281.669t-.682.294z"})}))}var W=Object(O.a)((function(e){return{root:{marginRight:0,paddingRight:0,width:"100%","&:hover":{backgroundColor:"none"}},iconContainer:{"& .close":{opacity:.3}},group:{marginLeft:7,paddingLeft:18,borderLeft:"1px dashed ".concat(Object(g.c)(e.palette.text.primary,.4))}}}))((function(e){return Object(L.jsx)(T.a,Object(o.a)({},e))}));function M(e){var t=e.task,a=e.filterOptions,n=N(),i=d.a.useState([]),o=Object(c.a)(i,2),s=o[0],l=o[1],u=d.a.useCallback((function(e,t){if(t){if(s.includes("treenode:"+e))return;l([].concat(Object(r.a)(s),["treenode:"+e]))}else{var a=s.reduce((function(t,a){return a==="treenode:"+e?Object(r.a)(t):[].concat(Object(r.a)(t),[a])}),[]);l(a)}}),[s]);return Object(L.jsx)(I.a,{className:n.root,expanded:s,children:Object(L.jsx)(V,{task:t,filterOptions:a,nodesSelected:s,toggleSelection:u})})}var H=d.a.memo(M),U=function(e){var t=e.task,a=e.theme;return t.status.toLowerCase().includes("error")?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.error.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"cleared"===t.status?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"cleared"}):t.completed?null:"submitted"===t.status?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"processing"===t.status?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):t.opsec_pre_blocked&&!t.opsec_pre_bypassed?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (PRE)"}):t.opsec_post_blocked&&!t.opsec_post_bypassed?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (POST)"}):Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()})},G=function(e){var t=e.task,a=e.theme,n=e.children,i=d.a.useState(a.palette.info.main),r=Object(c.a)(i,2),o=r[0],s=r[1];return Object(l.useEffect)((function(){t.status.toLowerCase().includes("error")?s(a.palette.error.main):"cleared"===t.status.toLowerCase()?s(a.palette.warning.main):t.completed?s(a.palette.success.main):"submitted"===t.status?s(a.palette.info.main):t.opsec_pre_blocked&&!t.opsec_pre_bypassed||t.opsec_post_blocked&&!t.opsec_post_bypassed||"processing"===t.status.toLowerCase()?s(a.palette.warning.main):s(a.palette.info.main)}),[t.status,t.completed]),Object(L.jsx)("span",{style:{display:"flex",margin:0,borderWidth:0,padding:0,minHeight:"48px",alignItems:"center",height:"100%",borderLeft:"6px solid "+o,paddingLeft:"5px",width:"100%"},children:n})},V=function e(t){var a=t.task,n=t.filterOptions,i=t.nodesSelected,r=t.toggleSelection,o=d.a.useState(!1),s=Object(c.a)(o,2),u=s[0],b=s[1],j=d.a.useState({task:[]}),p=Object(c.a)(j,2),f=p[0],O=p[1],g=d.a.useState(!1),x=Object(c.a)(g,2),y=x[0],_=x[1],v=d.a.useState(!0),k=Object(c.a)(v,2),w=k[0],C=k[1],S=Object(h.a)(m.b),D=Object(A.a)(q,{onError:function(e){console.error(e)},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,onCompleted:function(e){if(!i.includes("treenode:"+a.id))return E(),void _(!1);P(2e3),O(e)}}),I=Object(c.a)(D,2),T=I[0],$=I[1],P=$.startPolling,E=$.stopPolling,F=d.a.useCallback((function(e){if(!y)return r(a.id,!0),_(!0),void T({variables:{task_id:a.id}});r(a.id,!1)}),[y]);Object(l.useEffect)((function(){if(a.display_params.includes("help")&&a.operator.username!==S.user.username)C(!1);else if(void 0!==n)if(n.operatorsList.length>0&&!n.operatorsList.includes(a.operator.username))w&&C(!1);else if(n.commentsFlag&&""===a.comment)w&&C(!1);else if(n.commandsList.length>0&&!n.commandsList.includes(a.command_name))w&&C(!1);else if(n.everythingButList.length>0&&n.everythingButList.includes(a.command_name))w&&C(!1);else{if(""!==n.parameterString)if(!new RegExp(n.parameterString).test(a.display_params))return void(w&&C(!1));w||C(!0)}else w||C(!0)}),[n,a.comment,a.command,a.display_params,a.operator.username]);var N=d.a.useCallback((function(e,t){b(!u)}),[u]);return Object(l.useEffect)((function(){!y&&a.tasks.length>0&&F()}),[a.tasks]),w?Object(L.jsx)(W,{nodeId:"treenode:"+a.id,onIconClick:F,icon:i.includes("treenode:"+a.id)?Object(L.jsx)(B,{}):a.tasks.length>0?Object(L.jsx)(z,{}):null,label:Object(L.jsx)(K,{task:a,dropdownOpen:u,toggleTaskDropdown:N}),children:f.task.map((function(t){return Object(L.jsx)(e,{task:t,nodesSelected:i,filterOptions:n,toggleSelection:r},"taskrow: "+t.id)}))}):null},K=function(e){var t=e.task,a=e.dropdownOpen,n=e.toggleTaskDropdown,i=d.a.useState(new Date),r=Object(c.a)(i,2),o=r[0],s=(r[1],Object(h.a)(m.b)),f=Object(D.a)(),O=d.a.useState(!1),g=Object(c.a)(O,2),v=g[0],w=g[1],I=d.a.useState(0),T=Object(c.a)(I,2),$=T[0],P=T[1],A=N(),F=R(),q=Object(l.useRef)(t.responses_aggregate.aggregate.count);Object(l.useLayoutEffect)((function(){B()}),[]),Object(l.useEffect)((function(){a?(q.current=t.responses_aggregate.aggregate.count,P(0)):t.responses_aggregate.aggregate.count>q.current&&(1===t.responses_aggregate.aggregate.count&&new Date(t.responses_aggregate.aggregate.max.timestamp)>o?n():P(t.responses_aggregate.aggregate.count-q.current))}),[t.responses_aggregate.aggregate.count,a]);var B=function(e,a){document.getElementById("scrolltotask".concat(t.id)).scrollIntoView({behavior:"smooth",block:"start",inline:"start"})};return Object(L.jsx)(b.a,{className:A.root,elevation:5,style:{marginRight:0},children:Object(L.jsxs)(x.a,{TransitionProps:{unmountOnExit:!0,onEntered:B},defaultExpanded:!1,onChange:n,expanded:a,children:[Object(L.jsx)(_.a,{expandIcon:Object(L.jsx)(k.a,{}),"aria-controls":"panel1c-content-task-".concat(t.id),id:"panel1c-header",classes:F,children:Object(L.jsx)(G,{task:t,theme:f,children:Object(L.jsxs)("div",{id:"scrolltotask"+t.id,style:{width:"100%"},children:[v?Object(L.jsxs)(d.a.Fragment,{children:[Object(L.jsx)(j.a,{className:A.secondaryHeading,children:t.commentOperator.username}),Object(L.jsx)(j.a,{className:A.heading,children:t.comment})]}):null,Object(L.jsxs)(j.a,{className:A.taskAndTimeDisplay,children:["[",Object(p.b)(t.timestamp,s.user.view_utc_time),"] / ",t.id," / ",t.operator.username,Object(L.jsx)(U,{task:t,theme:f})]}),Object(L.jsxs)("div",{children:[""!==t.comment?Object(L.jsx)("div",{className:A.column,children:Object(L.jsx)(u.a,{size:"small",style:{padding:"0"},color:"primary",onClick:function(e){e.stopPropagation(),w(!v)},children:Object(L.jsx)(C.a,{})})}):null,Object(L.jsx)("div",{className:A.column,children:Object(L.jsx)(S.a,{badgeContent:$,color:"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:Object(L.jsx)(j.a,{className:A.heading,onClick:function(e){e.stopPropagation()},children:t.command_name+" "+t.display_params})})})]})]})})}),Object(L.jsx)(y.a,{style:{cursor:"default"},children:Object(L.jsx)(E.a,{task:t})})]})})}},298:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a(1),r=a.n(i),c=a(69),o=a(124),s=a(123),l=a(0);function d(e){var t=r.a.useState(!1),a=Object(n.a)(t,2),i=a[0],d=a[1];return Object(l.jsxs)(r.a.Fragment,{children:[Object(l.jsx)(s.a,{dividers:!0,children:Object(l.jsx)("img",{onClick:function(){d(!i)},src:e.href,style:{width:i?"":"100%",height:i?"":"100%",cursor:i?"zoom-out":"zoom-in"}})}),Object(l.jsx)(o.a,{children:Object(l.jsx)(c.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}},300:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n,i,r=a(6),c=a(2),o=a(7),s=a(1),l=a.n(s),d=a(67),u=a(219),b=a(4),j=a(69),p=a(124),m=a(123),h=a(131),f=a(245),O=a(247),g=a(84),x=a(244),y=a(246),_=a(130),v=a(83),k=a(62),w=a(60),C=a(0),S=Object(d.a)(n||(n=Object(o.a)(["\nfragment allTokenData on token {\n    id\n    Address\n    AppContainer\n    AppContainerNumber\n    AppContainerSid\n    AppId\n    AppModelPolicies\n    AppModelPolicyDictionary\n    AttributesFlags\n    AuditPolicy\n    AuthenticationId_id\n    BnoIsolationPrefix\n    CanSynchronize\n    Capabilities\n    CreationTime\n    DefaultDacl\n    DenyOnlyGroups\n    DeviceClaimAttributes\n    DeviceGroups\n    Elevated\n    ElevationType\n    EnabledGroups\n    ExpirationTime\n    Filtered\n    Flags\n    FullPath\n    GrantedAccess\n    GrantedAccessGeneric\n    GrantedAccessMask\n    GroupCount\n    Groups\n    Handle\n    HandleReferenceCount\n    HasRestrictions\n    ImpersonationLevel\n    Inherit\n    IntegrityLevel\n    IntegrityLevelSid\n    IsClosed\n    IsContainer\n    IsPseudoToken\n    IsRestricted\n    IsSandbox\n    LogonSid\n    LowPrivilegeAppContainer\n    MandatoryPolicy\n    ModifiedId\n    Name\n    NoChildProcess\n    NotLow\n    NtType\n    NtTypeName\n    Origin\n    Owner\n    PackageFullName\n    PackageIdentity\n    PackageName\n    PointerReferenceCount\n    PrimaryGroup\n    PrivateNamespace\n    Privileges\n    ProcessUniqueAttribute\n    ProtectFromClose\n    Restricted\n    RestrictedDeviceClaimAttributes\n    RestrictedDeviceGroups\n    RestrictedSids\n    RestrictedSidsCount\n    RestrictedUserClaimAttributes\n    SandboxInert\n    Sddl\n    SecurityAttributes\n    SecurityDescriptor\n    SessionId\n    Source\n    ThreadID\n    TokenId\n    TokenType\n    TrustLevel\n    UIAccess\n    User\n    UserClaimAttributes\n    VirtualizationAllowed\n    VirtualizationEnabled\n    WriteRestricted\n    task_id\n    logonsession {\n      id\n      LogonId\n      UserName\n      LogonDomain\n      LogonType\n      SessionId\n      Sid\n      LogonTime\n      LogonServer\n      DnsDomainName\n      Upn\n      UserFlags\n      LastSuccessfulLogon\n      LastFailedLogon\n      FailedAttemptCountSinceLastSuccessfulLogon\n      LogonScript\n      ProfilePath\n      HomeDirectory\n      HomeDirectoryDrive\n      LogoffTime\n      KickOffTime\n      PasswordLastSet\n      PasswordCanChange\n      PasswordMustChange\n      task_id\n      authenticationpackages {\n        id\n        Name\n        task_id\n      }\n    }\n}\n"]))),D=Object(d.a)(i||(i=Object(o.a)(["\n","\nquery getTokenInfo ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    ...allTokenData\n  }\n}\n"])),S);function I(e){var t=Object(w.a)(),a=Object(s.useState)([]),n=Object(c.a)(a,2),i=n[0],o=n[1],d=Object(s.useState)([]),S=Object(c.a)(d,2),I=S[0],T=S[1],$=Object(s.useState)([]),P=Object(c.a)($,2),A=P[0],E=P[1],L=["Address","AppContainer","AppContainerNumber","AppContainerSid","AppId","AppModelPolicies","AppModelPolicyDictionary","AttributesFlags","AuditPolicy","AuthenticationId_id","BnoIsolationPrefix","CanSynchronize","Capabilities","CreationTime","DefaultDacl","DenyOnlyGroups","DeviceClaimAttributes","DeviceGroups","Elevated","ElevationType","EnabledGroups","ExpirationTime","Filtered","Flags","FullPath","GrantedAccess","GrantedAccessGeneric","GrantedAccessMask","GroupCount","Groups","Handle","HandleReferenceCount","HasRestrictions","ImpersonationLevel","Inherit","IntegrityLevel","IntegrityLevelSid","IsClosed","IsContainer","IsPseudoToken","IsRestricted","IsSandbox","LogonSid","LowPrivilegeAppContainer","MandatoryPolicy","ModifiedId","Name","NoChildProcess","NotLow","NtType","NtTypeName","Origin","Owner","PackageFullName","PackageIdentity","PackageName","PointerReferenceCount","PrimaryGroup","PrivateNamespace","Privileges","ProcessUniqueAttribute","ProtectFromClose","Restricted","RestrictedDeviceClaimAttributes","RestrictedDeviceGroups","RestrictedSids","RestrictedSidsCount","RestrictedUserClaimAttributes","SandboxInert","Sddl","SecurityAttributes","SecurityDescriptor","SessionId","Source","ThreadID","TokenId","TokenType","TrustLevel","UIAccess","User","UserClaimAttributes","VirtualizationAllowed","VirtualizationEnabled","WriteRestricted","task_id"],F=["LogonId","UserName","LogonDomain","LogonType","SessionId","Sid","LogonTime","LogonServer","DnsDomainName","Upn","UserFlags","LastSuccessfulLogon","LastFailedLogon","FailedAttemptCountSinceLastSuccessfulLogon","LogonScript","ProfilePath","HomeDirectory","HomeDirectoryDrive","LogoffTime","KickOffTime","PasswordLastSet","PasswordCanChange","PasswordMustChange","task_id"],q=["Name","task_id"];return Object(u.a)(D,{variables:{token_id:e.token_id},onCompleted:function(e){if(null!==e.token_by_pk){o(e.token_by_pk);var t=L.reduce((function(t,a){return void 0!==e.token_by_pk[a]&&null!==e.token_by_pk[a]&&""!==e.token_by_pk[a]?[].concat(Object(r.a)(t),[{name:a,value:e.token_by_pk[a]}]):Object(r.a)(t)}),[]);if(o(t),null!==e.token_by_pk.logonsession){var a=F.reduce((function(t,a){return void 0!==e.token_by_pk.logonsession[a]&&null!==e.token_by_pk.logonsession[a]&&""!==e.token_by_pk.logonsession[a]?[].concat(Object(r.a)(t),[{name:a,value:e.token_by_pk.logonsession[a]}]):Object(r.a)(t)}),[]);if(T(a),e.token_by_pk.logonsession.authenticationpackages.length>0){var n=e.token_by_pk.logonsession.authenticationpackages.map((function(e){return q.reduce((function(t,a){return void 0!==e[a]&&null!==e[a]&&""!==e[a]?[].concat(Object(r.a)(t),[{name:a,value:e[a]}]):Object(r.a)(t)}),[])}));E(n)}}}},onError:function(e){b.b.error(e)},fetchPolicy:"network-only"}),Object(C.jsxs)(l.a.Fragment,{children:[Object(C.jsx)(h.a,{id:"form-dialog-title",children:"Token Information"}),Object(C.jsxs)(m.a,{dividers:!0,children:[Object(C.jsx)(v.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(C.jsx)(k.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Token Data"})}),Object(C.jsx)(v.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(C.jsx)(x.a,{component:v.a,className:"mythicElement",children:Object(C.jsxs)(f.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(C.jsx)(y.a,{children:Object(C.jsxs)(_.a,{children:[Object(C.jsx)(g.a,{children:"Token Property"}),Object(C.jsx)(g.a,{children:"Token Value"})]})}),Object(C.jsx)(O.a,{children:i.map((function(e,t){return Object(C.jsxs)(_.a,{children:[Object(C.jsx)(g.a,{children:e.name}),Object(C.jsx)(g.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})}),I.length>0&&Object(C.jsxs)(l.a.Fragment,{children:[Object(C.jsx)(v.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(C.jsx)(k.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Logon Session Data"})}),Object(C.jsx)(v.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(C.jsx)(x.a,{component:v.a,className:"mythicElement",children:Object(C.jsxs)(f.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(C.jsx)(y.a,{children:Object(C.jsxs)(_.a,{children:[Object(C.jsx)(g.a,{children:"Logon Session Property"}),Object(C.jsx)(g.a,{children:"Logon Session Value"})]})}),Object(C.jsx)(O.a,{children:I.map((function(e,t){return Object(C.jsxs)(_.a,{children:[Object(C.jsx)(g.a,{children:e.name}),Object(C.jsx)(g.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"logondatarow"+t)}))})]})})})]}),A.map((function(e){return Object(C.jsxs)(l.a.Fragment,{children:[Object(C.jsx)(v.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(C.jsx)(k.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Authentication Package"})}),Object(C.jsx)(v.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(C.jsx)(x.a,{component:v.a,className:"mythicElement",children:Object(C.jsxs)(f.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(C.jsx)(y.a,{children:Object(C.jsxs)(_.a,{children:[Object(C.jsx)(g.a,{children:"Authentication Package Property"}),Object(C.jsx)(g.a,{children:"Authentication Package Value"})]})}),Object(C.jsx)(O.a,{children:e.map((function(t,a){return Object(C.jsxs)(_.a,{children:[Object(C.jsx)(g.a,{children:t.name}),Object(C.jsx)(g.a,{children:!0===t.value?"True":!1===t.value?"False":t.value})]},"authpackage"+e.id+"row"+a)}))})]})})})]},"authpkg"+e.id)}))]}),Object(C.jsx)(p.a,{children:Object(C.jsx)(j.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},317:function(e,t,a){"use strict";var n=a(3),i=a(6),r=a(2),c=a(93),o=a(1),s=a.n(o),l=a(165),d=a(493),u=a.n(d),b=a(138),j=a(939),p=a(62),m=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250,n=Object(o.useState)(0),i=Object(r.a)(n,2),c=i[0],s=i[1];return Object(o.useEffect)((function(){var n=setTimeout((function(){1===c&&e(),s(0)}),a);return 2===c&&t(),function(){return clearTimeout(n)}}),[a,e,t,c]),function(){return s((function(e){return e+1}))}},h=a(143),f=Object(h.a)((function(e){return{headerCellRow:{display:"flex",flexDirection:"row",position:"sticky",top:"0",left:"0",right:"0",zIndex:1},headerCell:{display:"flex",alignItems:"center",padding:"0 0.25em",boxSizing:"border-box",justifyContent:"space-between",userSelect:"none",backgroundColor:e.palette.background.paper,borderTop:"1px solid #e0e0e0",borderRight:"1px solid #e0e0e0",borderBottom:"1px solid #e0e0e0","&:first-child":{borderLeft:"1px solid #e0e0e0"},"&:hover":{backgroundColor:e.tableHover,cursor:"pointer"}},cell:{display:"flex",alignItems:"center",padding:"0 0.25em",boxSizing:"border-box",fontFamily:"monospace",borderBottom:"1px solid #e0e0e0","&:hover":{backgroundColor:e.tableHover,cursor:"pointer"}},cellInner:{width:"100%",whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"},draggableHandlesContainer:{position:"absolute",top:0,overflowX:"hidden"},draggableHandlesClickArea:{position:"absolute",top:0,width:"16px",cursor:"col-resize",pointerEvents:"initial"},draggableHandlesIndicator:{position:"absolute",top:0,left:8,width:"1px",backgroundImage:"linear-gradient(#7f93c0, #00000000)"}}})),O=a(0),g=["style","rowIndex","columnIndex","data"],x=function(e){var t=e.onClick,a=void 0===t?function(){}:t,n=e.onDoubleClick,i=void 0===n?function(){}:n,r=e.sortIndicatorIndex,s=e.sortDirection,l=e.headerNameKey,d=void 0===l?"name":l,u=e.VariableSizeGridProps,b=u.style,h=u.rowIndex,x=u.columnIndex,y=u.data,_=(Object(c.a)(u,g),f()),v=Object(o.useCallback)((function(e){a(e,x)}),[a,x]),k=Object(o.useCallback)((function(e){i(e,x)}),[i,x]),w=m(v,k),C=y.items[h][x];return Object(O.jsx)("div",{style:b,className:_.headerCell,onClick:w,children:Object(O.jsxs)(j.a,{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",children:[Object(O.jsx)(p.a,{className:_.cellInner,variant:"body1",children:C[d].toUpperCase()}),r===x&&("ASC"===s?Object(O.jsx)("div",{children:"\u2191"}):Object(O.jsx)("div",{children:"\u2193"}))]})})},y=["style","rowIndex","columnIndex","data"],_=function(e){var t=e.VariableSizeGridProps,a=t.style,i=t.rowIndex,r=t.columnIndex,s=t.data,l=(Object(c.a)(t,y),f()),d=Object(o.useCallback)((function(e){s.onDoubleClickRow(e,i-1)}),[s,i]),u=s.items[i][r];return Object(O.jsx)("div",{style:Object(n.a)(Object(n.a)({},a),(null===u||void 0===u?void 0:u.cellStyle)||null),className:l.cell,onDoubleClick:d,children:Object(O.jsx)("div",{className:l.cellInner,children:u})})},v=a(299),k=a.n(v),w=s.a.forwardRef((function(e,t){var a=e.height,n=e.rowHeight,i=e.width,c=e.minColumnWidth,s=e.columnWidths,l=e.onStop,d=f(),u=Object(o.useState)(!1),b=Object(r.a)(u,2),j=b[0],p=b[1];return Object(O.jsx)("div",{ref:t,className:d.draggableHandlesContainer,style:{height:a,width:i,pointerEvents:j?"initial":"none"},children:s.map((function(e,t){var i=s.slice(0,t).reduce((function(e,t){return e+t}),0);return Object(O.jsx)(k.a,{axis:"x",bounds:{left:c-s[t],right:Number.POSITIVE_INFINITY,top:0,bottom:0},position:j?null:{x:0,y:0},onStart:function(){p(t)},onStop:function(e,a){p(!1),l(a.x,t)},children:Object(O.jsx)("div",{className:d.draggableHandlesClickArea,style:{left:i+s[t]-1-8,height:n},children:Object(O.jsx)("div",{className:d.draggableHandlesIndicator,style:{display:j===t?"block":"none",height:a/2}})})},t)}))})})),C=["columns","sortIndicatorIndex","sortDirection","items","headerNameKey","onClickHeader","onDoubleClickRow","rowHeight","widthMeasureKey"],S=["children"],D=100,I=function(e){return 0===e.rowIndex?null:Object(O.jsx)(_,{VariableSizeGridProps:e})},T=function(e){var t=e.columns,a=e.sortIndicatorIndex,l=e.sortDirection,d=e.items,j=e.headerNameKey,p=e.onClickHeader,m=e.onDoubleClickRow,h=e.rowHeight,g=e.widthMeasureKey,y=Object(c.a)(e,C),_=u()().width,v=Object(o.useState)(t.map((function(e){return e.width||D}))),k=Object(r.a)(v,2),T=k[0],$=k[1],P=Object(o.useRef)(null),A=Object(o.useRef)(null),E=Object(o.useCallback)((function(e){return T[e]}),[T]),L=Object(o.useCallback)((function(e){return h}),[h]);Object(o.useEffect)((function(){var e=y.width-_,a=t.map((function(e){return e.width||D})),n=e-a.reduce((function(e,t){return e+t}),0);if(n>0){for(var i=[],r=0;r<t.length;r++)t[r].fillWidth&&i.push(r);0===i.length&&i.push(t.length-1);for(var c=0;c<i.length;c++)a[i[c]]+=n/i.length}$(a)}),[_]),Object(o.useEffect)((function(){P.current.resetAfterColumnIndex(0,!0)}),[T]);var F=[t].concat(Object(i.a)(d)),q=s.a.forwardRef((function(e,r){var o=e.children,s=Object(c.a)(e,S),u=f();return Object(O.jsxs)("div",Object(n.a)(Object(n.a)({ref:r},s),{},{children:[Object(O.jsx)("div",{className:u.headerCellRow,style:{height:L(0)},children:t.map((function(e,t){var n=T.slice(0,t).reduce((function(e,t){return e+t}),0);return Object(O.jsx)(x,{headerNameKey:j,onClick:p,onDoubleClick:function(t,a){e.disableAutosize||function(e){var t=Math.max.apply(Math,Object(i.a)(d.map((function(t){return"string"===typeof t[e]?t[e].length:g?String(null===(a=t[e])||void 0===a||null===(n=a.props)||void 0===n||null===(i=n.cellData)||void 0===i?void 0:i[g]).length||-1:(null===(r=t[e])||void 0===r||null===(c=r.props)||void 0===c||null===(o=c.cellData)||void 0===o?void 0:o.length)||-1;var a,n,i,r,c,o})))),a=T.map((function(a,n){return e===n?Math.floor(Math.max(8*t+32,D)):Math.floor(a)}));$(a)}(a)},sortIndicatorIndex:a,sortDirection:l,VariableSizeGridProps:{style:{position:"absolute",top:0,left:n,height:L(0),width:E(t)},rowIndex:0,columnIndex:t,data:{items:F}}},t)}))}),o]}))}));return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(b.b,{height:y.height,width:y.width,columnCount:t.length,columnWidth:E,headerNameKey:j,rowCount:F.length,rowHeight:L,itemData:{items:F,onDoubleClickRow:m},innerElementType:q,overscanRowCount:20,onScroll:function(e){var t=e.scrollLeft;A.current&&A.current.scrollTo({left:t})},ref:P,children:I}),Object(O.jsx)(w,{height:y.height,rowHeight:L(0),width:y.width,minColumnWidth:D,columnWidths:T,onStop:function(e,t){var a=T.map((function(a,n){return t===n?Math.floor(Math.max(a+e,D)):Math.floor(a)}));$(a)},ref:A})]})},$=function(e){var t=e.columns,a=e.sortIndicatorIndex,i=e.sortDirection,r=e.items,c=e.onClickHeader,o=e.headerNameKey,s=e.onDoubleClickRow,d=e.widthMeasureKey,u=e.rowHeight,b=void 0===u?32:u;return Object(O.jsx)(l.a,{children:function(e){return Object(O.jsx)(T,Object(n.a)({columns:t,headerNameKey:o,sortIndicatorIndex:a,sortDirection:i,items:r,widthMeasureKey:d,rowHeight:b,onClickHeader:c,onDoubleClickRow:s},e))}})};t.a=$},364:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a(1),r=a.n(i),c=a(137),o=a.n(c),s=(a(332),a(255),a(333),a(60)),l=a(0),d=function(e){var t=Object(s.a)(),a=r.a.useState(String(e.plaintext)),c=Object(n.a)(a,2),d=c[0],u=c[1];return Object(i.useEffect)((function(){try{var t=JSON.stringify(JSON.parse(String(e.plaintext)),null,4);u(t)}catch(a){u(String(e.plaintext))}}),[e.plaintext]),Object(l.jsx)(o.a,{mode:"json",theme:"dark"===t.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:d,width:"100%",minLines:2,maxLines:50,readOnly:!0,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})}},4:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return o}));var n=a(3),i=a(87),r=null,c=function(){return r=Object(i.c)(),null},o={success:function(e,t){this.toast(e,"success",t)},warning:function(e,t){this.toast(e,"warning",t)},info:function(e,t){this.toast(e,"info",t)},error:function(e,t){this.toast(e,"error",t)},dismiss:function(){r.closeSnackbar()},toast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",a=arguments.length>2?arguments[2]:void 0;r.enqueueSnackbar(e,Object(n.a)({variant:t},a))}}},47:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(3),i=a(93),r=(a(1),a(143)),c=a(250),o=a(0),s=["children","title"],l=Object(r.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function d(e){var t=e.children,a=e.title,r=Object(i.a)(e,s),d=l();return Object(o.jsx)(c.a,Object(n.a)(Object(n.a)({title:a,arrow:!0,classes:{tooltip:d.tooltip,arrow:d.arrow}},r),{},{children:Object(o.jsx)("span",{style:{display:"inline-block"},children:t})}))}},490:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return oe}));var n,i,r,c=a(2),o=a(7),s=a(1),l=a.n(s),d=a(166),u=a(111),b=a.n(u),j=a(302),p=a.n(j),m=a(491),h=a(503),f=a.n(h),O=a(14),g=a(496),x=a(497),y=a(60),_=a(112),v=a.n(_),k=a(167),w=a.n(k),C=a(499),S=a(500),D=a(501),I=a(4),T=a(502),$=a.n(T),P=a(301),A=a.n(P),E=a(208),L=a.n(E),F=a(209),q=a.n(F),N=a(300),R=a(172),B=a(365),z=a.n(B),W=a(67),M=a(249),H=a(221),U=a(54),G=a(33),V=a(874),K=a(62),Q=a(79),J=a.n(Q),Y=a(877),Z=a(878),X=a(95),ee=a(143),te=a(375),ae=a(0),ne=Object(W.a)(n||(n=Object(o.a)(["\nmutation reissueTaskMutation($task_id: Int!){\n  reissue_task(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),ie=Object(W.a)(i||(i=Object(o.a)(["\nmutation reissueTaskHandlerMutation($task_id: Int!){\n  reissue_task_handler(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),re=Object(W.a)(r||(r=Object(o.a)(["\nquery subResponsesQuery($task_id: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n}"]))),ce=Object(ee.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{top:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{bottom:e.spacing(1),left:e.spacing(2)},zIndex:3},tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),oe=function(t){var a=t.task,n=Object(y.a)(),i=l.a.useState(0),r=Object(c.a)(i,2),o=r[0],u=r[1],j=l.a.useState(!0),h=Object(c.a)(j,2),_=h[0],k=h[1],T=l.a.useState(!1),P=Object(c.a)(T,2),E=P[0],F=P[1],B=l.a.useState(!1),W=Object(c.a)(B,2),Q=W[0],ee=W[1],oe=l.a.useState(!1),se=Object(c.a)(oe,2),le=se[0],de=se[1],ue=l.a.useState(!1),be=Object(c.a)(ue,2),je=be[0],pe=be[1],me=l.a.useState(!1),he=Object(c.a)(me,2),fe=he[0],Oe=he[1],ge=l.a.useState(!1),xe=Object(c.a)(ge,2),ye=xe[0],_e=xe[1],ve=l.a.useState(0),ke=Object(c.a)(ve,2),we=ke[0],Ce=ke[1],Se=l.a.useState(""),De=Object(c.a)(Se,2),Ie=De[0],Te=De[1],$e=l.a.useState(!1),Pe=Object(c.a)($e,2),Ae=Pe[0],Ee=Pe[1],Le=l.a.useState(10),Fe=Object(c.a)(Le,2),qe=Fe[0],Ne=(Fe[1],l.a.useState(1)),Re=Object(c.a)(Ne,2),Be=Re[0],ze=Re[1],We=l.a.useState(!1),Me=Object(c.a)(We,2),He=Me[0],Ue=Me[1],Ge=ce(),Ve=l.a.useState(!1),Ke=Object(c.a)(Ve,2),Qe=Ke[0],Je=Ke[1],Ye=Object(M.a)(re,{fetchPolicy:"network-only",onCompleted:function(t){var n=t.response.reduce((function(t,a){return t+e.from(a.response,"base64")}),""),i=new Blob([n],{type:"application/octet-stream"}),r=document.getElementById("download_config");if(null!==r)r.href=URL.createObjectURL(i),r.download="task_"+a.id+".txt",r.click();else{var c=document.createElement("a");c.id="download_config",c.href=URL.createObjectURL(i),c.download="task_"+a.id+".txt",document.body.appendChild(c),c.click()}},onError:function(e){}}),Ze=Object(c.a)(Ye,1)[0],Xe=Object(H.a)(ne,{onCompleted:function(e){"success"===e.reissue_task.status?I.b.success("Successfully re-issued task to Mythic"):I.b.error("Failed to re-issue task to Mythic: "+e.reissue_task.error)},onError:function(e){console.log(e),I.b.error("Failed to re-issue task: "+e)}}),et=Object(c.a)(Xe,1)[0],tt=Object(H.a)(ie,{onCompleted:function(e){"success"===e.reissue_task_handler.status?I.b.success("Successfully resubmitted task for handling"):I.b.warning("Failed to resubmit task for handling: "+e.reissue_task_handler.error)},onError:function(e){console.log(e),I.b.error("Error resubmitting task for handling: "+e)}}),at=Object(c.a)(tt,1)[0];Object(s.useEffect)((function(){Ce(null===a.command?0:a.command.id),void 0!==a.responses_aggregate&&u(a.responses_aggregate.aggregate.count)}),[a.command,a.responses_aggregate]);var nt=l.a.useCallback((function(e){u(e),ze(1)}),[]),it="top";return Object(ae.jsx)(l.a.Fragment,{children:Object(ae.jsxs)(R.a,{container:!0,spacing:0,style:{maxWidth:"100%"},children:[Object(ae.jsx)(te.a,{open:Qe,onClick:function(){Je(!1)},style:{zIndex:2,position:"absolute"}}),Q?Object(ae.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:Q,onClose:function(){ee(!1)},innerDialog:Object(ae.jsx)(N.a,{token_id:void 0===a.token?0:a.token.id,onClose:function(){ee(!1)}})}):null,fe?Object(ae.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:fe,onClose:function(){Oe(!1)},innerDialog:Object(ae.jsx)(C.a,{task_id:a.id,onClose:function(){Oe(!1)}})}):null,le?Object(ae.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:le,onClose:function(){de(!1)},innerDialog:Object(ae.jsx)(S.a,{task_id:a.id,onClose:function(){de(!1)}})}):null,je?Object(ae.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:je,onClose:function(){pe(!1)},innerDialog:Object(ae.jsx)(D.a,{task_id:a.id,onClose:function(){pe(!1)}})}):null,ye?Object(ae.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:ye,onClose:function(){_e(!1)},innerDialog:Object(ae.jsx)(x.a,{task_id:a.id,onClose:function(){_e(!1)}})}):null,E?Object(ae.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:E,onClose:function(){F(!1)},innerDialog:Object(ae.jsx)(g.a,{task_id:a.id,onClose:function(){F(!1)}})}):null,Object(ae.jsx)(R.a,{item:!0,xs:12,children:Object(ae.jsx)(m.a,{task:a,command_id:we,viewBrowserScript:_,onSubmitSearch:function(e){Te(e),""===e&&(void 0!==a.responses_aggregate?u(a.responses_aggregate.aggregate.count):u(0)),ze(1)},searchOutput:Ae,fetchLimit:qe,currentPage:Be,searchText:Ie,changeTotalCount:nt,selectAllOutput:He})}),Object(ae.jsxs)(R.a,{item:!0,xs:12,children:[Object(ae.jsxs)(Y.a,{ariaLabel:"Task Speeddial",className:Ge.speedDial,icon:Object(ae.jsx)(Z.a,{}),onClick:function(){Je(!Qe)},FabProps:{color:"primary",size:"small"},open:Qe,direction:"right",children:[Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(A.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Toggle BrowserScript",onClick:function(){k(!_),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(U.a,{icon:G.i,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"View All Output",onClick:function(){Ue(!He),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(J.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Search Output",onClick:function(){Ee(!Ae),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(b.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Download output",onClick:function(){Ze({variables:{task_id:a.id}}),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)($.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Edit Tags",onClick:function(){_e(!0),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(U.a,{icon:G.j,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Open Task in New Window",onClick:function(){window.open("/new/task/"+a.id,"_blank")}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(p.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Copy original params to clipboard",onClick:function(){Object(d.a)(a.original_params)?I.b.success("Copied text!"):I.b.error("Failed to copy text"),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(f.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Edit Comment",onClick:function(){F(!0),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(L.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"View All Parameters",onClick:function(){de(!0),Je(!1)}}),Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(U.a,{icon:G.b,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"View Stdout/Stderr of Task",onClick:function(){pe(!0),Je(!1)}}),null===a.opsec_pre_blocked?null:!1===a.opsec_pre_bypassed?Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(v.a,{style:{color:n.palette.error.main}}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Submit OPSEC PreCheck Bypass Request",onClick:function(){Oe(!0),Je(!1)}}):Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(w.a,{style:{color:n.palette.success.main}}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"View OPSEC PreCheck Data",onClick:function(){Oe(!0),Je(!1)}}),null===a.opsec_post_blocked?null:!1===a.opsec_post_bypassed?Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(v.a,{style:{color:n.palette.error.main}}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Submit OPSEC PostCheck Bypass Request",onClick:function(){Oe(!0),Je(!1)}}):Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(w.a,{style:{color:n.palette.success.main}}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"View OPSEC PostCheck Data",onClick:function(){Oe(!0),Je(!1)}}),null===a.token?null:Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(q.a,{}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"View Token Information",onClick:function(){ee(!0),Je(!1)}}),a.status.toLowerCase().includes("error: container")?Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(z.a,{style:{color:n.palette.warning.main}}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Resubmit Tasking",onClick:function(){et({variables:{task_id:a.id}})}}):null,a.status.toLowerCase().includes("error: task")?Object(ae.jsx)(X.a,{icon:Object(ae.jsx)(z.a,{style:{color:n.palette.warning.main}}),arrow:!0,TooltipClasses:{tooltip:Ge.tooltip,arrow:Ge.arrow},tooltipPlacement:it,tooltipTitle:"Resubmit Task Handler",onClick:function(){at({variables:{task_id:a.id}})}}):null]}),Object(ae.jsx)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:Object(ae.jsxs)(l.a.Fragment,{children:[Object(ae.jsx)(V.a,{count:Math.ceil(o/qe),page:Be,variant:"outlined",color:"primary",boundaryCount:2,onChange:function(e,t){ze(t)},style:{margin:"10px"}}),Object(ae.jsxs)(K.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})})]})]})})}}).call(this,a(463).Buffer)},491:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return L}));var n,i,r,c,o=a(6),s=a(3),l=a(2),d=a(7),u=a(1),b=a.n(u),j=a(67),p=a(876),m=a(249),h=a(324),f=a(19),O=a(4),g=a(492),x=a(364),y=a(549),_=a(494),v=a(495),k=a(18),w=a(79),C=a.n(w),S=a(60),D=a(218),I=a(47),T=a(0),$=Object(j.a)(n||(n=Object(d.a)(["\nsubscription subResponsesQuery($task_id: Int!, $fetchLimit: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, limit: $fetchLimit, order_by: {id: desc}) {\n    id\n    response: response_text\n  }\n}"]))),P=Object(j.a)(i||(i=Object(d.a)(["\nquery subResponsesQuery($task_id: Int!, $fetchLimit: Int!, $offset: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}, limit: $fetchLimit, offset: $offset, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),A=Object(j.a)(r||(r=Object(d.a)(["\nquery subResponsesQuery($task_id: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),E=Object(j.a)(c||(c=Object(d.a)(["\nquery getBrowserScriptsQuery($command_id: Int!, $operator_id: Int!, $operation_id: Int!){\n  browserscript(where: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}, operator_id: {_eq: $operator_id}}) {\n    script\n    id\n  }\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}}}) {\n    browserscript {\n      script\n      id\n    }\n  }\n}\n\n"]))),L=function(t){var a,n,i,r,c=Object(S.a)(),d=b.a.useState(!0),j=Object(l.a)(d,2),w=j[0],L=j[1],F=b.a.useState(""),q=Object(l.a)(F,2),N=q[0],R=q[1],B=b.a.useState([]),z=Object(l.a)(B,2),W=z[0],M=z[1],H=b.a.useState({}),U=Object(l.a)(H,2),G=U[0],V=U[1],K=b.a.useRef(),Q=Object(h.a)(f.b),J=b.a.useState(0),Y=Object(l.a)(J,2),Z=Y[0],X=Y[1],ee=b.a.useState(0),te=Object(l.a)(ee,2),ae=te[0],ne=te[1],ie=b.a.useState(""),re=Object(l.a)(ie,2),ce=re[0],oe=re[1],se=b.a.useState(!1),le=Object(l.a)(se,2),de=le[0],ue=le[1];Object(p.a)($,{variables:{task_id:t.task.id,fetchLimit:t.fetchLimit},fetchPolicy:"network_only",onSubscriptionData:function(a){var n=a.subscriptionData;if(0!==ae||n.data.response.length!==t.fetchLimit){if(ae>=t.fetchLimit)console.log("got more than we can see currently");else if(n.data.response.length>0){var i=n.data.response.filter((function(e){return e.id>Z})).map((function(t){return Object(s.a)(Object(s.a)({},t),{},{response:e.from(t.response,"base64")})}));i.sort((function(e,t){return e.id>t.id?1:-1}));for(var r=N,c=Object(o.a)(W),l=Z,d=ae,u=0;u<i.length&&d<t.fetchLimit;u++)r+=i[u].response,c.push(i[u].response),l=i[u].id,d+=1;R(r),M(c),X(l),ne(d)}}else he({variables:{task_id:t.task.id,fetchLimit:t.fetchLimit,offset:0,search:"%_%"}})}});var be=function(e){var t=Object(s.a)({},e);if(""===ce)return e;if(void 0!==e.plaintext&&(e.plaintext.includes(ce)||(t.plaintext="")),void 0!==e.table&&e.table.length>0){var a=e.table.map((function(e){var t=e.rows.filter((function(e){for(var t=!1,a=0,n=Object.values(e);a<n.length;a++){var i=n[a];void 0!==i.plaintext&&String(i.plaintext).includes(ce)&&(t=!0),void 0!==i.button&&void 0!==i.button.value&&JSON.stringify(i.button.value).includes(ce)&&(t=!0)}return t}));return Object(s.a)(Object(s.a)({},e),{},{rows:t})}));t.table=a}return t};Object(u.useEffect)((function(){if(void 0===K.current)L(!1);else if(L(t.viewBrowserScript),t.viewBrowserScript&&void 0!==K.current)try{var e=K.current(t.task,W);V(be(e))}catch(a){L(!1)}}),[t.viewBrowserScript]);var je=Object(m.a)(E,{fetchPolicy:"network-only",onCompleted:function(a){if(a.browserscriptoperation.length>0)try{var n=e.from(a.browserscriptoperation[0].script,"base64"),i=Function('"use strict";return('+n+")")();K.current=i,L(!0);var r=K.current(t.task,W);V(be(r))}catch(l){O.b.error(l.toString()),console.log(l),L(!1)}else if(a.browserscript.length>0)try{var c=e.from(a.browserscript[0].script,"base64"),o=Function('"use strict";return('+c+")")();K.current=o,L(!0),console.log(W);var s=K.current(t.task,W);V(be(s))}catch(l){O.b.error(l.toString()),console.log(l),L(!1)}else L(!1)},onError:function(e){console.log(e)}}),pe=Object(l.a)(je,1)[0],me=Object(m.a)(P,{fetchPolicy:"network-only",onCompleted:function(a){var n=a.response.reduce((function(t,a){return t+e.from(a.response,"base64")}),""),i=a.response.reduce((function(e,t){return t.id>e?t.id:e}),Z);X(i),R(n);var r=a.response.map((function(t){return e.from(t.response,"base64")}));if(M(r),w&&void 0!==K.current)try{var c=K.current(t.task,r);V(be(c))}catch(o){console.log(o),L(!1)}ne(a.response.length),(""!==t.searchText||de)&&(ue(!1),t.changeTotalCount(a.response_aggregate.aggregate.count))},onError:function(e){O.b.error("Failed to fetch more responses: "+e)}}),he=Object(l.a)(me,1)[0],fe=Object(m.a)(A,{fetchPolicy:"network-only",onCompleted:function(a){var n=a.response.reduce((function(t,a){return t+e.from(a.response,"base64")}),""),i=a.response.reduce((function(e,t){return t.id>e?t.id:e}),Z);X(i),R(n);var r=a.response.map((function(t){return e.from(t.response,"base64")}));if(M(r),w&&void 0!==K.current)try{var c=K.current(t.task,r);V(be(c))}catch(o){L(!1),console.log(o)}ne(a.response.length),t.changeTotalCount(0)},onError:function(e){}}),Oe=Object(l.a)(fe,1)[0];Object(u.useEffect)((function(){void 0!==t.command_id&&pe({variables:{command_id:t.command_id,operator_id:Q.user.user_id,operation_id:Q.user.current_operation_id}})}),[t.command_id]),Object(u.useEffect)((function(){if(void 0!==K.current)try{var e=K.current(t.task,W);V(be(e))}catch(a){L(!1),console.log(a)}}),[W]),Object(u.useEffect)((function(){void 0===t.searchText||""===t.searchText?he({variables:{task_id:t.task.id,fetchLimit:t.fetchLimit,offset:t.fetchLimit*(t.currentPage-1),search:"%_%"}}):he({variables:{task_id:t.task.id,fetchLimit:t.fetchLimit,offset:t.fetchLimit*(t.currentPage-1),search:"%"+t.searchText+"%"}})}),[t.currentPage]),Object(u.useEffect)((function(){void 0===t.searchText||""===t.searchText?he({variables:{task_id:t.task.id,fetchLimit:t.fetchLimit,offset:0,search:"%_%"}}):he({variables:{task_id:t.task.id,fetchLimit:t.fetchLimit,offset:0,search:"%"+t.searchText+"%"}})}),[t.searchText]),Object(u.useEffect)((function(){t.selectAllOutput?(ue(!0),Oe({variables:{task_id:t.task.id,search:"%"+t.searchText+"%"}})):(X(0),ne(0),he({variables:{task_id:t.task.id,fetchLimit:t.fetchLimit,offset:0,search:"%"+t.searchText+"%"}}))}),[t.selectAllOutput]);var ge=b.a.useCallback((function(){t.onSubmitSearch(ce)}),[ce]);return Object(T.jsxs)(b.a.Fragment,{children:[t.searchOutput&&Object(T.jsx)(k.a,{value:ce,autoFocus:!0,onEnter:ge,onChange:function(e,t,a){return oe(t)},placeholder:"Search Output of This Task",name:"Search...",InputProps:{endAdornment:Object(T.jsx)(b.a.Fragment,{children:Object(T.jsx)(I.a,{title:"Search",children:Object(T.jsx)(D.a,{onClick:ge,children:Object(T.jsx)(C.a,{style:{color:c.palette.info.main}})})})}),style:{padding:0}}}),Object(T.jsx)("div",{style:{overflow:"auto",maxWidth:"100%",width:"100%"},children:w&&G?Object(T.jsxs)(b.a.Fragment,{children:[(null===G||void 0===G||null===(a=G.screenshot)||void 0===a?void 0:a.map((function(e,a){return Object(T.jsx)(g.a,Object(s.a)({},e),"screenshot"+a+"fortask"+t.task.id)})))||null,(null===G||void 0===G?void 0:G.plaintext)&&Object(T.jsx)(x.a,{plaintext:G.plaintext}),(null===G||void 0===G||null===(n=G.table)||void 0===n?void 0:n.map((function(e,a){return Object(T.jsx)(y.a,{callback_id:t.task.callback_id,table:e},"tablefortask"+t.task.id+"table"+a)})))||null,(null===G||void 0===G||null===(i=G.download)||void 0===i?void 0:i.map((function(e,a){return Object(T.jsx)(_.a,{download:e},"download"+a+"fortask"+t.task.id)})))||null,(null===G||void 0===G||null===(r=G.search)||void 0===r?void 0:r.map((function(e,a){return Object(T.jsx)(v.a,{search:e},"searchlink"+a+"fortask"+t.task.id)})))||null]}):Object(T.jsx)(x.a,{plaintext:N})})]})}}).call(this,a(463).Buffer)},492:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(2),i=a(1),r=a.n(i),c=a(69),o=a(298),s=a(14),l=a(250),d=a(143),u=a(0),b=Object(d.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),j=function(e){var t=r.a.useState(!1),a=Object(n.a)(t,2),i=a[0],d=a[1],j=b(),p=(new Date).toUTCString();return Object(u.jsxs)(r.a.Fragment,{children:[i&&Object(u.jsx)(s.a,{fullWidth:!0,maxWidth:"xl",open:i,onClose:function(){d(!1)},innerDialog:Object(u.jsx)(o.a,{href:"/api/v1.4/files/screencaptures/"+e.agent_file_id+"?time="+p,onClose:function(){d(!1)}})}),Object(u.jsx)("pre",{style:{display:"inline-block"},children:(null===e||void 0===e?void 0:e.plaintext)||""}),Object(u.jsx)(l.a,{title:(null===e||void 0===e?void 0:e.hoverText)||"View Screenshot",arrow:!0,classes:{tooltip:j.tooltip,arrow:j.arrow},children:Object(u.jsx)(c.a,{color:"primary",variant:e.variant?e.variant:"contained",onClick:function(){d(!0)},style:{marginBottom:"10px"},children:e.name})})]})}},494:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(1),i=a.n(n),r=a(111),c=a.n(r),o=a(250),s=a(143),l=a(69),d=a(0),u=Object(s.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),b=function(e){var t,a,n,r,s=u();return Object(d.jsxs)(i.a.Fragment,{children:[Object(d.jsx)("pre",{style:{display:"inline-block"},children:(null===(t=e.download)||void 0===t?void 0:t.plaintext)||""}),Object(d.jsx)(o.a,{title:(null===e||void 0===e||null===(a=e.dowload)||void 0===a?void 0:a.hoverText)||"Download payload",arrow:!0,classes:{tooltip:s.tooltip,arrow:s.arrow},children:Object(d.jsx)(l.a,{variant:(null===(n=e.download)||void 0===n?void 0:n.variant)||"contained",component:"a",target:"_blank",color:"primary",href:"/api/v1.4/files/download/"+e.download.agent_file_id,download:!0,startIcon:Object(d.jsx)(c.a,{}),children:(null===(r=e.download)||void 0===r?void 0:r.name)||""})}),Object(d.jsx)("br",{})]})}},495:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(1),i=a.n(n),r=a(250),c=a(143),o=a(867),s=a(0),l=Object(c.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),d=function(e){var t,a,n,c=l();return Object(s.jsxs)(i.a.Fragment,{children:[Object(s.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap"},children:(null===(t=e.search)||void 0===t?void 0:t.plaintext)||""}),Object(s.jsx)(r.a,{title:(null===(a=e.search)||void 0===a?void 0:a.hoverText)||"View on Search Page",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(s.jsx)(o.a,{component:"a",target:"_blank",href:window.location.origin+"/new/search/?"+e.search.search,children:(null===(n=e.search)||void 0===n?void 0:n.name)||""})}),Object(s.jsx)("br",{})]})}},496:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n,i,r=a(2),c=a(7),o=a(1),s=a.n(o),l=a(69),d=a(124),u=a(123),b=a(131),j=a(18),p=a(67),m=a(219),h=a(221),f=a(248),O=a(0),g=Object(p.a)(n||(n=Object(c.a)(["\nmutation updateComment ($task_id: Int!, $comment: String) {\n  update_task_by_pk(pk_columns: {id: $task_id}, _set: {comment: $comment}) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"]))),x=Object(p.a)(i||(i=Object(c.a)(["\nquery getCommentQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"])));function y(e){var t=Object(o.useState)(""),a=Object(r.a)(t,2),n=a[0],i=a[1],c=Object(m.a)(x,{variables:{task_id:e.task_id},onCompleted:function(e){i(e.task_by_pk.comment)},fetchPolicy:"network-only"}),p=c.loading,y=c.error,_=Object(h.a)(g,{update:function(e,t){t.data}}),v=Object(r.a)(_,1)[0];if(p)return Object(O.jsx)(f.a,{});if(y)return console.error(y),Object(O.jsx)("div",{children:"Error!"});var k=function(){v({variables:{task_id:e.task_id,comment:n}}),e.onClose()};return Object(O.jsxs)(s.a.Fragment,{children:[Object(O.jsx)(b.a,{id:"form-dialog-title",children:"Edit Task Comment"}),Object(O.jsx)(u.a,{dividers:!0,children:Object(O.jsx)(j.a,{autoFocus:!0,onEnter:k,onChange:function(e,t,a){i(t)},value:n})}),Object(O.jsxs)(d.a,{children:[Object(O.jsx)(l.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(O.jsx)(l.a,{onClick:k,variant:"contained",color:"secondary",children:"Submit"})]})]})}},497:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));var n,i,r,c=a(6),o=a(2),s=a(7),l=a(1),d=a.n(l),u=a(69),b=a(124),j=a(123),p=a(131),m=a(18),h=a(67),f=a(324),O=a(219),g=a(221),x=a(248),y=a(19),_=a(143),v=a(172),k=a(553),w=a(377),C=a(866),S=a(558),D=a(875),I=a(83),T=a(862),$=a(864),P=a(865),A=a(498),E=a.n(A),L=a(218),F=a(206),q=a(4),N=a(0),R=Object(h.a)(n||(n=Object(s.a)(["\nmutation addTaskTag ($task_id: Int!, $tag: String!) {\n  insert_tasktag_one(object: {task_id: $task_id, tag: $tag}){\n    id\n  }\n}\n"]))),B=Object(h.a)(i||(i=Object(s.a)(["\nmutation removeTaskTag($tasktag_id: Int!){\n  delete_tasktag_by_pk(id: $tasktag_id){\n    id\n  }\n}\n"]))),z=Object(h.a)(r||(r=Object(s.a)(["\nquery getTaskTags ($operation_id: Int!) {\n  tasktag(where: {operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    task_id\n  }\n}\n"]))),W=Object(_.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}}));function M(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function H(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}function U(e){var t=Object(l.useState)(""),a=Object(o.a)(t,2),n=a[0],i=a[1],r=Object(f.a)(y.b),s=Object(O.a)(z,{variables:{operation_id:r.user.current_operation_id},onCompleted:function(t){var a=t.tasktag.reduce((function(t,a){return a.task_id===e.task_id?[].concat(Object(c.a)(t),[a]):Object(c.a)(t)}),[]),n=t.tasktag.reduce((function(e,t){return e.find((function(e){return e.tag===t.tag}))||a.find((function(e){return e.tag===t.tag}))?Object(c.a)(e):[].concat(Object(c.a)(e),[t])}),[]);ae(n),ce(a),de(Object(c.a)(a))},fetchPolicy:"network-only"}),h=s.loading,_=s.error,A=Object(g.a)(R,{update:function(e,t){t.data}}),U=Object(o.a)(A,1)[0],G=Object(g.a)(B,{update:function(e,t){t.data}}),V=Object(o.a)(G,1)[0],K=W(),Q=d.a.useState([]),J=Object(o.a)(Q,2),Y=J[0],Z=J[1],X=d.a.useState([]),ee=Object(o.a)(X,2),te=ee[0],ae=ee[1],ne=d.a.useState([]),ie=Object(o.a)(ne,2),re=ie[0],ce=ie[1],oe=d.a.useState([]),se=Object(o.a)(oe,2),le=se[0],de=se[1],ue=H(Y,te),be=H(Y,re),je=function(e){return function(){var t=Y.indexOf(e),a=Object(c.a)(Y);-1===t?a.push(e):a.splice(t,1),Z(a)}},pe=function(e,t){return Object(N.jsx)(I.a,{className:K.paper,style:{width:"100%"},children:Object(N.jsxs)(T.a,{children:[Object(N.jsx)($.a,{className:K.cardHeader,title:e}),Object(N.jsx)(P.a,{}),Object(N.jsxs)(k.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[t.map((function(e){var t="transfer-list-item-".concat(e.id,"-label");return Object(N.jsxs)(w.a,{style:{padding:0},role:"listitem",button:!0,onClick:je(e),children:[Object(N.jsx)(C.a,{children:Object(N.jsx)(D.a,{checked:-1!==Y.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":t}})}),Object(N.jsx)(S.a,{id:t,primary:e.tag})]},e.id)})),Object(N.jsx)(w.a,{})]})]})})};if(h)return Object(N.jsx)(x.a,{});if(_)return console.error(_),Object(N.jsx)("div",{children:"Error!"});return Object(N.jsxs)(d.a.Fragment,{children:[Object(N.jsx)(p.a,{id:"form-dialog-title",children:"Edit Task Tags"}),Object(N.jsxs)(j.a,{dividers:!0,children:[Object(N.jsxs)(v.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:K.root,children:[Object(N.jsx)(v.a,{item:!0,xs:5,children:pe("Unused Tags In Operation",te)}),Object(N.jsx)(v.a,{item:!0,children:Object(N.jsxs)(v.a,{container:!0,direction:"column",alignItems:"center",children:[Object(N.jsx)(u.a,{variant:"outlined",size:"small",className:K.button,onClick:function(){ce(re.concat(te)),ae([])},disabled:0===te.length,"aria-label":"move all right",children:"\u226b"}),Object(N.jsx)(u.a,{variant:"outlined",size:"small",className:K.button,onClick:function(){ce(re.concat(ue)),ae(M(te,ue)),Z(M(Y,ue))},disabled:0===ue.length,"aria-label":"move selected right",children:">"}),Object(N.jsx)(u.a,{variant:"outlined",size:"small",className:K.button,onClick:function(){ae(te.concat(be)),ce(M(re,be)),Z(M(Y,be))},disabled:0===be.length,"aria-label":"move selected left",children:"<"}),Object(N.jsx)(u.a,{variant:"outlined",size:"small",className:K.button,onClick:function(){ae(te.concat(re)),ce([])},disabled:0===re.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(N.jsx)(v.a,{item:!0,xs:5,children:pe("Applied Tags To Task",re)})]}),Object(N.jsx)(m.a,{autoFocus:!0,multiline:!1,name:"Add New Tag...",onChange:function(e,t,a){i(t)},value:n,style:{display:"inline-block"},InputProps:{endAdornment:Object(N.jsx)(d.a.Fragment,{children:Object(N.jsx)(L.a,{style:{color:F.a.palette.success.main},variant:"contained",onClick:function(){re.find((function(e){return e.tag===n}))||te.find((function(e){return e.tag===n}))||""!==n&&ce([].concat(Object(c.a)(re),[{tag:n,id:0,task_id:0}])),i("")},children:Object(N.jsx)(E.a,{})})})}})]}),Object(N.jsxs)(b.a,{children:[Object(N.jsx)(u.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(N.jsx)(u.a,{onClick:function(){le.forEach((function(e){re.find((function(t){return t.id===e.id}))||V({variables:{tasktag_id:e.id}})})),re.forEach((function(t){le.find((function(e){return e.id===t.id}))||U({variables:{task_id:e.task_id,tag:t.tag}})})),""!==n&&U({variables:{task_id:e.task_id,tag:n}}),q.b.success("Updated tags"),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}},499:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n,i,r=a(2),c=a(7),o=a(1),s=a.n(o),l=a(69),d=a(124),u=a(123),b=a(131),j=a(18),p=a(67),m=a(219),h=a(221),f=a(248),O=a(87),g=a(0),x=Object(p.a)(n||(n=Object(c.a)(["\nmutation requestOpsecBypass ($task_id: Int!) {\n    requestOpsecBypass(task_id: $task_id){\n        status\n        error\n    }\n}\n"]))),y=Object(p.a)(i||(i=Object(c.a)(["\nquery getOPSECQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    opsec_pre_blocked\n    opsec_pre_message\n    opsec_pre_bypassed\n    opsec_pre_bypass_user{\n        username\n        id\n    }\n    opsec_post_blocked\n    opsec_pre_bypass_role\n    opsec_post_message\n    opsec_post_bypassed\n    opsec_post_bypass_role\n    opsec_post_bypass_user{\n        username\n        id\n    }\n    id\n  }\n}\n"])));function _(e){var t=Object(o.useState)(""),a=Object(r.a)(t,2),n=a[0],i=a[1],c=Object(o.useState)({}),p=Object(r.a)(c,2),_=p[0],v=p[1],k=Object(O.c)().enqueueSnackbar,w=Object(m.a)(y,{variables:{task_id:e.task_id},onCompleted:function(e){var t="OPSEC PreCheck Message";console.log(e),null!==e.task_by_pk.opsec_pre_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_pre_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_pre_message+"\n",e.task_by_pk.opsec_post_blocked&&(t+="\nOPSEC PostCheck Message",null!==e.task_by_pk.opsec_post_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_post_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_post_message+"\n"),v(e.task_by_pk),i(t)},fetchPolicy:"network-only"}),C=w.loading,S=w.error,D=Object(h.a)(x,{update:function(e,t){var a=t.data;"success"===a.requestOpsecBypass.status?k("Bypass processed successfully",{variant:"success"}):k(a.requestOpsecBypass.error,{variant:"warning"})}}),I=Object(r.a)(D,1)[0];if(C)return Object(g.jsx)(f.a,{});if(S)return console.error(S),Object(g.jsx)("div",{children:"Error!"});return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{id:"form-dialog-title",children:"Request OPSEC Bypass"}),Object(g.jsx)(u.a,{dividers:!0,children:Object(g.jsx)(j.a,{multiline:!0,onChange:function(){},value:n})}),Object(g.jsxs)(d.a,{children:[Object(g.jsx)(l.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),!0===_.opsec_pre_blocked&&!_.opsec_pre_bypassed||!0===_.opsec_post_blocked&&!_.opsec_post_bypassed?Object(g.jsx)(l.a,{onClick:function(){console.log(e.task_id),I({variables:{task_id:e.task_id}}),e.onClose()},variant:"contained",color:"secondary",children:"Submit Bypass Request"}):null]})]})}},50:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return O}));var n=a(3),i=a(93),r=a(218),c=a(141),o=a.n(c),s=a(559),l=a(1),d=a.n(l),u=a(0),b=["children","value","index","maxHeight","tabInfo","getCallbackData","queryParams","changeSearchParam"],j=["label","index","fullWidth","maxHeight","onContextMenu","onCloseTab","selectionFollowsFocus","textColor","indicator","tabInfo","onEditTabDescription","getCallbackData"],p=["label","index","fullWidth","maxHeight","selectionFollowsFocus","textColor","indicator","iconComponent"];function m(e){var t=e.children,a=e.value,r=e.index,c=(e.maxHeight,e.tabInfo,e.getCallbackData,e.queryParams,e.changeSearchParam,Object(i.a)(e,b)),o=void 0===e.style?{display:a===r?"flex":"none",flexDirection:"column",flexGrow:1,width:"100%",maxWidth:"100%",overflowY:"auto"}:e.style;return Object(u.jsx)("div",Object(n.a)(Object(n.a)({role:"tabpanel",hidden:a!==r,id:"scrollable-auto-tabpanel-".concat(r),"aria-labelledby":"scrollable-auto-tab-".concat(r),style:o},c),{},{children:Object(u.jsx)(d.a.Fragment,{children:t})}))}function h(e){return{id:"scrollable-auto-tab-".concat(e),"aria-controls":"scrollable-auto-tabpanel-".concat(e)}}function f(e){var t=e.label,a=e.index,c=(e.fullWidth,e.maxHeight,e.onContextMenu),l=e.onCloseTab,d=(e.selectionFollowsFocus,e.textColor,e.indicator,e.tabInfo),b=(e.onEditTabDescription,e.getCallbackData,Object(i.a)(e,j));return Object(u.jsx)(s.a,Object(n.a)(Object(n.a)({label:Object(u.jsxs)("span",{onContextMenu:c,style:{display:"inline-block",zIndex:1},children:[t,Object(u.jsx)(r.a,Object(n.a)(Object(n.a)({component:"div",size:"small",onClick:function(e){e.stopPropagation(),l({tabID:d.tabID,index:a})}},b),{},{children:Object(u.jsx)(o.a,{})}))]})},h(a)),b))}function O(e){var t=e.label,a=e.index,r=(e.fullWidth,e.maxHeight,e.selectionFollowsFocus,e.textColor,e.indicator,e.iconComponent),c=Object(i.a)(e,p);return Object(u.jsx)(s.a,Object(n.a)(Object(n.a)({label:Object(u.jsxs)("span",{children:[t,Object(u.jsx)("br",{}),r]})},h(a)),c))}},500:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n,i=a(2),r=a(7),c=a(1),o=a.n(c),s=a(69),l=a(124),d=a(123),u=a(131),b=a(18),j=a(67),p=a(219),m=a(248),h=a(0),f=Object(j.a)(n||(n=Object(r.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    display_params\n    original_params\n    params\n    tasking_location\n    parameter_group_name\n    id\n  }\n}\n"])));function O(e){var t=Object(c.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],j=Object(p.a)(f,{variables:{task_id:e.task_id},onCompleted:function(e){var t="Original Parameters:\n"+e.task_by_pk.original_params;t+="\n\nAgent Parameters:\n"+e.task_by_pk.params,t+="\n\nDisplay Parameters:\n"+e.task_by_pk.display_params,t+="\n\nTasking Location:\n"+e.task_by_pk.tasking_location,t+="\n\nParameter Group:\n"+e.task_by_pk.parameter_group_name,r(t)},fetchPolicy:"network-only"}),O=j.loading,g=j.error;return O?Object(h.jsx)(m.a,{}):g?(console.error(g),Object(h.jsx)("div",{children:"Error!"})):Object(h.jsxs)(o.a.Fragment,{children:[Object(h.jsx)(u.a,{id:"form-dialog-title",children:"View Task Parameters"}),Object(h.jsx)(d.a,{dividers:!0,children:Object(h.jsx)(b.a,{multiline:!0,value:n,onChange:function(){}})}),Object(h.jsx)(l.a,{children:Object(h.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},501:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n,i=a(2),r=a(7),c=a(1),o=a.n(c),s=a(69),l=a(124),d=a(123),u=a(131),b=a(18),j=a(67),p=a(219),m=a(248),h=a(0),f=Object(j.a)(n||(n=Object(r.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    stdout\n    stderr\n    id\n  }\n}\n"])));function O(e){var t=Object(c.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],j=Object(p.a)(f,{variables:{task_id:e.task_id},onCompleted:function(e){r("[STDOUT]:\n"+e.task_by_pk.stdout+"\n[STDERR]:\n"+e.task_by_pk.stderr)},fetchPolicy:"network-only"}),O=j.loading,g=j.error;return O?Object(h.jsx)(m.a,{}):g?(console.error(g),Object(h.jsx)("div",{children:"Error!"})):Object(h.jsxs)(o.a.Fragment,{children:[Object(h.jsx)(u.a,{id:"form-dialog-title",children:"View Task Stdout/Stderr"}),Object(h.jsx)(d.a,{dividers:!0,children:Object(h.jsx)(b.a,{multiline:!0,value:n,onChange:function(){}})}),Object(h.jsx)(l.a,{children:Object(h.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},549:function(e,t,a){"use strict";a.d(t,"a",(function(){return W}));var n,i=a(6),r=a(2),c=a(3),o=a(1),s=a.n(o),l=a(69),d=a(14),u=a(83),b=a(62),j=a(60),p=(a(355),a(7)),m=a(67),h=a(221),f=a(219),O=a(4),g=a(142),x=a(92),y=a(139),_=a(0),v=Object(m.a)(n||(n=Object(p.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $ui_feature: String!) {\n    callback_by_pk(id: $callback_id){\n        operation_id\n        loadedcommands(where: {command: {supported_ui_features: {_ilike: $ui_feature}}}) {\n            id\n            command {\n              cmd\n              help_cmd\n              description\n              id\n              needs_admin\n              payload_type_id\n              attributes\n              commandparameters {\n                id\n                type \n              }\n              supported_ui_features\n            }\n        }\n        callbacktokens(where: {deleted: {_eq: false}}) {\n            token {\n              TokenId\n              id\n              User\n              description\n            }\n            id\n        }\n    }\n}\n"]))),k=function(e){var t=e.callback_id,a=e.ui_feature,n=e.parameters,l=e.onTasked,u=s.a.useState([]),b=Object(r.a)(u,2),j=b[0],p=b[1],m=s.a.useState(!1),k=Object(r.a)(m,2),w=k[0],C=k[1],S=s.a.useState(!1),D=Object(r.a)(S,2),I=D[0],T=D[1],$=s.a.useState({}),P=Object(r.a)($,2),A=P[0],E=P[1],L=s.a.useState([]),F=Object(r.a)(L,2),q=F[0],N=F[1],R=s.a.useState({}),B=Object(r.a)(R,2),z=B[0],W=B[1],M=s.a.useState(!1),H=Object(r.a)(M,2),U=H[0],G=H[1],V=s.a.useState({}),K=Object(r.a)(V,2),Q=K[0],J=K[1],Y=Object(h.a)(x.c,{update:function(e,a){var n=a.data;"error"===n.createTask.status?O.b.error(n.createTask.error):O.b.success('Issued "'+A.cmd+'" to Callback '+t),l()},onError:function(e){console.error(e),l()}}),Z=Object(r.a)(Y,1)[0],X=Object(f.a)(v,{variables:{callback_id:t,ui_feature:"%"+a+"%"},onCompleted:function(e){var t=e.callback_by_pk.loadedcommands.reduce((function(e,t){return[].concat(Object(i.a)(e),[t.command])}),[]),n=e.callback_by_pk.callbacktokens.reduce((function(e,t){return[].concat(Object(i.a)(e),[Object(c.a)(Object(c.a)({},t.token),{},{display:null===t.token.User?t.token.TokenId+" - "+t.token.description:t.token.User+" - "+t.token.description})])}),[]);N(n),p(t),0===t.length?O.b.warning("No commands currently loaded that support the "+a+" feature"):1===t.length?E(Object(c.a)({},t[0])):(E({}),C(!0))},fetchPolicy:"no-cache"}).data,ee=function(e){var t=e.variables;q.length>0?(G(!0),J(t)):Z({variables:t})};return Object(o.useEffect)((function(){""===z&&Z({variables:Q}),z.TokenId&&Z({variables:Object(c.a)(Object(c.a)({},Q),{},{token_id:z.TokenId})})}),[z]),Object(o.useEffect)((function(){void 0!==A.commandparameters&&(A.commandparameters.length>0?void 0===n||null===n?T(!0):ee("string"===typeof n?{variables:{callback_id:t,command:A.cmd,params:n}}:{variables:{callback_id:t,command:A.cmd,params:JSON.stringify(n),tasking_location:"browserscript"}}):ee(void 0===n||null===n?{variables:{callback_id:t,command:A.cmd,params:""}}:"string"===typeof n?{variables:{callback_id:t,command:A.cmd,params:n}}:{variables:{callback_id:t,command:A.cmd,params:JSON.stringify(n),tasking_location:"browserscript"}}))}),[A]),Object(_.jsxs)("div",{children:[w&&Object(_.jsx)(d.a,{fullWidth:!0,maxWidth:"sm",open:w,onClose:function(){C(!1),l()},innerDialog:Object(_.jsx)(g.a,{onClose:function(){C(!1)},onSubmit:function(e){E(e)},options:j,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),I&&Object(_.jsx)(d.a,{fullWidth:!0,maxWidth:"lg",open:I,onClose:function(){T(!1),l()},innerDialog:Object(_.jsx)(y.a,{command:A,callback_id:t,payloadtype_id:X.callback_by_pk.payload.payloadtype.id,operation_id:X.callback_by_pk.operation_id,onSubmit:function(e,a,n){T(!1),ee({variables:{callback_id:t,command:e,params:a,files:n,tasking_location:"modal"}})},onClose:function(){T(!1)}})}),U&&Object(_.jsx)(d.a,{fullWidth:!0,maxWidth:"sm",open:U,onClose:function(){G(!1),l()},innerDialog:Object(_.jsx)(g.a,{onClose:function(){G(!1),l()},onSubmit:function(e){W(e)},dontCloseOnSubmit:!0,options:q,title:"Select Token",action:"select",identifier:"id",display:"display"})})]})},w=a(552),C=a(863),S=a(376),D=a(854),I=a(856),T=a(166),$=a(218),P=a(47),A=a(54),E=a(317),L=a(33),F=function(e){switch(e.toLowerCase()){case"openfolder":case"folder":return L.u;case"closedfolder":return L.t;case"archive":case"zip":return L.l;case"diskimage":return L.c;case"executable":return L.e;case"word":return L.r;case"excel":return L.n;case"powerpoint":return L.q;case"pdf":case"adobe":return L.p;case"database":return L.g;case"key":return L.v;case"code":case"source":return L.m;case"download":return L.h;case"upload":return L.F;case"png":case"jpg":case"image":return L.o;case"list":return L.y;case"delete":return L.E;case"inject":return L.C;case"kill":return L.A;case"camera":return L.d;default:return L.k}},q=function(){},N=function(e){var t=e.cellData,a=e.rowData;return Object(_.jsxs)("div",{style:Object(c.a)(Object(c.a)({},(null===a||void 0===a?void 0:a.rowStyle)||null),(null===t||void 0===t?void 0:t.cellStyle)||null),children:[(null===t||void 0===t?void 0:t.copyIcon)?Object(_.jsx)(P.a,{title:"Copy to clipboard",children:Object(_.jsx)($.a,{onClick:function(){return e=t.plaintext,void(Object(T.a)(e)?O.b.success("Copied text!"):O.b.error("Failed to copy text"));var e},size:"small",children:Object(_.jsx)(A.a,{icon:L.f})})}):null,(null===t||void 0===t?void 0:t.startIcon)?Object(_.jsx)(P.a,{title:(null===t||void 0===t?void 0:t.startIconHoverText)||"",children:Object(_.jsx)(A.a,{icon:F(null===t||void 0===t?void 0:t.startIcon),style:{marginRight:"5px",color:(null===t||void 0===t?void 0:t.startIconColor)||""}})}):null,(null===t||void 0===t?void 0:t.plaintextHoverText)?Object(_.jsx)(P.a,{title:t.plaintextHoverText,children:Object(_.jsx)("pre",{style:{display:"inline-block"},children:(null===t||void 0===t?void 0:t.plaintext)||" "})}):Object(_.jsx)("pre",{style:{display:"inline-block"},children:(null===t||void 0===t?void 0:t.plaintext)||" "}),(null===t||void 0===t?void 0:t.endIcon)?Object(_.jsx)(P.a,{title:(null===t||void 0===t?void 0:t.endIconHoverText)||"",children:Object(_.jsx)(A.a,{icon:F(null===t||void 0===t?void 0:t.endIcon),style:{color:(null===t||void 0===t?void 0:t.endIconColor)||""}})}):null]})},R=function(e){var t=e.cellData;try{var a=parseInt(t.plaintext);if(""===t.plaintext)return"";if(0===a)return"0 Bytes";var n=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,n)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}catch(i){return(null===t||void 0===t?void 0:t.plaintext)||""}},B=function(e){var t=e.cellData,a=e.rowData;return Object(_.jsx)("div",{style:Object(c.a)(Object(c.a)({},(null===a||void 0===a?void 0:a.rowStyle)||null),(null===t||void 0===t?void 0:t.cellStyle)||null),children:(null===t||void 0===t?void 0:t.plaintextHoverText)?Object(_.jsx)(P.a,{title:t.plaintextHoverText,children:Object(_.jsx)("pre",{style:{display:"inline-block"},children:R({cellData:t})})}):Object(_.jsx)("pre",{style:{display:"inline-block"},children:R({cellData:t})})})},z=function(e){var t=e.cellData,a=e.callback_id,n=e.rowData,i=Object(j.a)(),b=s.a.useState(!1),p=Object(r.a)(b,2),m=p[0],h=p[1],f=s.a.useState(!1),O=Object(r.a)(f,2),g=O[0],x=O[1],y=Object(o.useRef)(null),v=s.a.useState(!1),T=Object(r.a)(v,2),$=T[0],E=T[1],L=s.a.useState({}),q=Object(r.a)(L,2),N=q[0],R=q[1],B=function(e){y.current&&y.current.contains(e.target)||E(!1)},z=function(){x(!1),R({})},W=function(){h(!1),R({})};return Object(_.jsxs)("div",{style:Object(c.a)(Object(c.a)({},(null===n||void 0===n?void 0:n.rowStyle)||null),(null===t||void 0===t?void 0:t.cellStyle)||null),children:[(null===t||void 0===t?void 0:t.plaintext)?t.plaintext:null,(null===t||void 0===t?void 0:t.button)?function(){var e,n,r,o,b,j,p,f,O,v,T,L,q,M,H,U,G,V;switch(t.button.type.toLowerCase()){case"dictionary":return Object(_.jsxs)(s.a.Fragment,{children:[Object(_.jsx)(P.a,{title:(null===t||void 0===t||null===(e=t.button)||void 0===e?void 0:e.hoverText)||"Display Data",children:Object(_.jsx)(l.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return h(!0)},disabled:(null===t||void 0===t||null===(n=t.button)||void 0===n?void 0:n.disabled)||!1,startIcon:(null===t||void 0===t||null===(r=t.button)||void 0===r?void 0:r.startIcon)?Object(_.jsx)(A.a,{icon:F(null===t||void 0===t||null===(o=t.button)||void 0===o?void 0:o.startIcon),style:{color:(null===t||void 0===t||null===(b=t.button)||void 0===b?void 0:b.startIconColor)||""}}):null,children:(null===t||void 0===t||null===(j=t.button)||void 0===j?void 0:j.name)||" "})}),m&&Object(_.jsx)(d.a,{fullWidth:!0,maxWidth:"lg",open:m,onClose:function(){h(!1)},innerDialog:Object(_.jsx)(d.c,{title:(null===t||void 0===t||null===(p=t.button)||void 0===p?void 0:p.title)||"Title Here",leftColumn:(null===t||void 0===t||null===(f=t.button)||void 0===f?void 0:f.leftColumnTitle)||"Left Column",rightColumn:(null===t||void 0===t||null===(O=t.button)||void 0===O?void 0:O.rightColumnTitle)||"Right Column",value:(null===t||void 0===t||null===(v=t.button)||void 0===v?void 0:v.value)||{},onClose:function(){h(!1)}})})]});case"task":return Object(_.jsxs)(s.a.Fragment,{children:[Object(_.jsx)(P.a,{title:(null===t||void 0===t||null===(T=t.button)||void 0===T?void 0:T.hoverText)||"Issues Task to Agent",children:Object(_.jsx)(l.a,{size:"small",onClick:function(){return x(!0)},disabled:(null===t||void 0===t||null===(L=t.button)||void 0===L?void 0:L.disabled)||!1,variant:"contained",color:"secondary",startIcon:(null===t||void 0===t||null===(q=t.button)||void 0===q?void 0:q.startIcon)?Object(_.jsx)(A.a,{icon:F(null===t||void 0===t||null===(M=t.button)||void 0===M?void 0:M.startIcon),style:{color:(null===t||void 0===t||null===(H=t.button)||void 0===H?void 0:H.startIconColor)||""}}):null,children:(null===t||void 0===t||null===(U=t.button)||void 0===U?void 0:U.name)||" "})}),g&&Object(_.jsx)(k,{ui_feature:(null===t||void 0===t||null===(G=t.button)||void 0===G?void 0:G.ui_feature)||" ",callback_id:a,parameters:(null===t||void 0===t||null===(V=t.button)||void 0===V?void 0:V.parameters)||"",onTasked:function(){return x(!1)}})]});case"menu":return Object(_.jsxs)(s.a.Fragment,{children:[g&&Object(_.jsx)(k,{ui_feature:N.ui_feature,callback_id:a,parameters:N.parameters,onTasked:z}),m&&Object(_.jsx)(d.a,{fullWidth:!0,maxWidth:"lg",open:m,onClose:W,innerDialog:Object(_.jsx)(d.c,{title:N.title,leftColumn:N.leftColumnTitle,rightColumn:N.rightColumnTitle,value:N.value,onClose:W})}),Object(_.jsx)(l.a,{ref:y,size:"small",onClick:function(){E(!0)},color:"primary",variant:"contained",children:t.button.name}),Object(_.jsx)(C.a,{open:$,anchorEl:y.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var a=e.TransitionProps,n=e.placement;return Object(_.jsx)(w.a,Object(c.a)(Object(c.a)({},a),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(_.jsx)(u.a,{variant:"outlined",style:{backgroundColor:"dark"===i.palette.type?i.palette.primary.dark:i.palette.primary.light,color:"white"},children:Object(_.jsx)(I.a,{onClickAway:B,children:Object(_.jsx)(D.a,{id:"split-button-menu",children:t.button.value.map((function(e,a){return Object(_.jsx)(S.a,{disabled:e.disabled,onClick:function(e){return function(e,a){switch(t.button.value[a].type.toLowerCase()){case"task":R(t.button.value[a]),x(!0);break;case"dictionary":R(t.button.value[a]),h(!0)}E(!1)}(0,a)},children:Object(_.jsxs)(P.a,{title:(null===e||void 0===e?void 0:e.hoverText)||("task"===e.type?"Task an Agent":"Display Data"),children:[(null===e||void 0===e?void 0:e.startIcon)?Object(_.jsx)(A.a,{icon:F(null===e||void 0===e?void 0:e.startIcon),style:{color:(null===e||void 0===e?void 0:e.startIconColor)||"",marginRight:"5px"}}):null,e.name]})},e.name+a)}))})})})}))}})]})}}():null]})},W=function(e){var t=e.table,a=e.callback_id,n=Object(j.a)(),c=s.a.useState(530),l=Object(r.a)(c,2),d=l[0],p=l[1],m=Math.floor(d/35),h=s.a.useState([]),f=Object(r.a)(h,2),O=f[0],g=f[1],x=s.a.useState({sortKey:null,sortType:null,sortDirection:"ASC"}),y=Object(r.a)(x,2),v=y[0],k=y[1],w=s.a.useMemo((function(){if(null===v.sortKey||null===v.sortType)return O;var e=Object(i.a)(O);return"number"===v.sortType||"size"===v.sortType?e.sort((function(e,t){return parseInt(e[v.sortKey].plaintext)>parseInt(t[v.sortKey].plaintext)?1:-1})):"date"===v.sortType?e.sort((function(e,t){return new Date(e[v.sortKey].plaintext)>new Date(t[v.sortKey].plaintext)?1:-1})):e.sort((function(e,t){return void 0===e[v.sortKey].plaintext?-1:void 0===t[v.sortKey].plaintext||e[v.sortKey].plaintext.toLowerCase()>t[v.sortKey].plaintext.toLowerCase()?1:-1})),"DESC"===v.sortDirection&&e.reverse(),e}),[O,v]),C=s.a.useMemo((function(){return w.map((function(e){for(var n=[],i=0;i<t.headers.length;i++)switch(t.headers[i].type){case"string":n.push(Object(_.jsx)(N,{cellData:e[t.headers[i].plaintext],rowData:e}));break;case"size":n.push(Object(_.jsx)(B,{cellData:e[t.headers[i].plaintext],rowData:e}));break;case"button":n.push(Object(_.jsx)(z,{callback_id:a,cellData:e[t.headers[i].plaintext],rowData:e}));break;default:n.push(Object(_.jsx)(N,{cellData:e[t.headers[i].plaintext],rowData:e}))}return[].concat(n)}))}),[w]);Object(o.useEffect)((function(){g(Object(i.a)(t.rows)),t.rows.length<m&&p(35*t.rows.length+45)}),[t.rows]);var S=t.headers.findIndex((function(e){return e.plaintext===v.sortKey}));return Object(_.jsxs)(s.a.Fragment,{children:[(null===t||void 0===t?void 0:t.title)?Object(_.jsx)(u.a,{elevation:5,style:{backgroundColor:n.pageHeader.main,color:n.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(_.jsx)(b.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:t.title})}):null,Object(_.jsx)("div",{style:{height:d,width:"100%"},children:Object(_.jsx)(E.a,{columns:t.headers,sortIndicatorIndex:S,sortDirection:v.sortDirection,items:C,widthMeasureKey:"plaintext",headerNameKey:"plaintext",onDoubleClickRow:q,rowHeight:35,onClickHeader:function(e,a){var n=t.headers[a];console.log(n),n.disableSort||(n.plaintext||k({sortKey:null,sortType:null,sortDirection:"ASC"}),v.sortKey===n.plaintext&&"ASC"===v.sortDirection?k({sortKey:n.plaintext,sortType:n.type,sortDirection:"DESC"}):k({sortKey:n.plaintext,sortType:n.type,sortDirection:"ASC"}))}})})]})}},66:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return c}));var n=a(1);function i(e,t){try{if(null===e)return"N/A";var a=new Date(e);return t?e+" UTC":a.toDateString()+" "+a.toTimeString().substring(0,8)}catch(n){console.log("warning","Failed to get local time converted: "+n.toString())}}function r(e){var t=new Date,a=t.getTime()+6e4*t.getTimezoneOffset(),n=Math.abs(a-new Date(e).getTime()),i=Math.trunc(n/1e3%60),r=Math.trunc(n/6e4%60),c=Math.trunc(n/36e5%24),o=Math.trunc(n/864e5%365),s="";return 0!==o&&(s+=o+"d"),0!==c&&(s+=c+"h"),0!==r&&(s+=r+"m"),s+=i+"s"}function c(e,t){var a=Object(n.useRef)();Object(n.useEffect)((function(){a.current=e})),Object(n.useEffect)((function(){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}),[t])}},829:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=829},847:function(e,t,a){"use strict";a.r(t),a.d(t,"mythicVersion",(function(){return Sh})),a.d(t,"mythicUIVersion",(function(){return Dh})),a.d(t,"isJWTValid",(function(){return Ph})),a.d(t,"apolloClient",(function(){return Rh})),a.d(t,"restartWebsockets",(function(){return Bh}));var n=a(476),i=a(168),r=a.n(i),c=a(360),o=a(1),s=a.n(o),l=a(42),d=a.n(l),u=a(2),b=a(69),j=a(18),p=a.p+"static/media/mythic.7189479f.svg",m=a(78),h=a(19),f=a(324),O=a(4),g=a(0);function x(e){var t=Object(f.a)(h.b),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),l=Object(u.a)(c,2),d=l[0],x=l[1];Object(o.useEffect)((function(){Ph()||(console.log("calling FailedRefresh on the login page to remove old data"),Object(h.a)())}),[]);var y=function(e){if(e.preventDefault(),""!==i&&""!==d){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:d})};fetch("/auth",t).then((function(e){e.json().then((function(e){console.log(e),"access_token"in e?(Object(h.d)(e),Bh()):(O.b.warning("Invalid Username or Password"),console.log("Error",e))})).catch((function(e){O.b.warning("Error getting JSON from server"),console.log("Error trying to get json response",e.toString())}))})).catch((function(e){O.b.warning("Error talking to server"),console.log("There was an error!",e.toString())}))}else O.b.warning("Username and Password required")};return Object(g.jsx)("div",{style:{justifyContent:"center",display:"flex"},children:t.loggedIn?Object(g.jsx)(m.a,{to:function(){var t=e.location.state;return t&&t.from?t.from.pathname:"/new/"}()}):Object(g.jsxs)("div",{children:[Object(g.jsx)("img",{src:p,height:"400px",alt:"Mythic logo"}),Object(g.jsxs)("form",{onSubmit:y,children:[Object(g.jsx)(j.a,{name:"username",value:i,onChange:function(e,t,a){r(t)},width:30}),Object(g.jsx)(j.a,{name:"password",type:"password",value:d,onChange:function(e,t,a){x(t)},width:30}),Object(g.jsx)(b.a,{type:"submit",color:"primary",onClick:y,variant:"contained",style:{marginRight:"10px"},children:"Login"})]})]})})}var y=a(6),_=a(3),v=a(7),k=a(245),w=a(247),C=a(84),S=a(244),D=a(246),I=a(130),T=a(83),$=a(921),P=a(939),A=a(555),E=a(218),L=a(62),F=a(215),q=a.n(F),N=a(214),R=a.n(N),B=a(49),z=a.n(B),W=a(105),M=a.n(W);function H(e){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{size:"small",onClick:function(){e.onDeleteAPIToken(e.id)},startIcon:Object(g.jsx)(z.a,{}),color:"secondary",variant:"contained",children:"Delete"})}),Object(g.jsx)(C.a,{children:e.token_value})]},"apitokenRow"+e.id)}var U=a(124),G=a(123),V=a(920),K=a(131);function Q(e){var t=s.a.useState(e.username?e.username:""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),p=Object(u.a)(d,2),m=p[0],h=p[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:e.title}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(V.a,{children:"Use this dialog to update some information about an operator."}),Object(g.jsx)(j.a,{autoFocus:!0,placeholder:e.username,value:n,onChange:function(e,t,a){i(t)},margin:"dense",id:"username",name:"username"}),Object(g.jsx)(j.a,{margin:"dense",id:"passwordOld",onChange:function(e,t,a){l(t)},name:"old password",type:"password"}),Object(g.jsx)(j.a,{margin:"dense",id:"passwordNew",onChange:function(e,t,a){h(t)},name:"new password",type:"password"})]}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.handleClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){e.onAccept(e.id,n,o,m)},variant:"contained",color:"primary",children:"Update"})]})]})}function J(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Delete Operator"}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(V.a,{children:"This deletes an operator and prevents them from permanently logging in again. If you want a temporary solution, disable the operator instead."}),Object(g.jsxs)(V.a,{children:['Are you sure you want to delete operator "',e.username,'"?']})]}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){e.onAccept(e.id)},variant:"contained",color:"secondary",children:"Delete"})]})]})}var Y=a(14),Z=a(66);function X(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],O=p[1],x=Object(f.a)(h.b);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(I.a,{children:[Object(g.jsxs)(C.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){O(!0)},startIcon:Object(g.jsx)(z.a,{}),color:"secondary",variant:"contained",children:"Delete"}),Object(g.jsx)(Y.a,{open:m,onClose:function(){O(!1)},innerDialog:Object(g.jsx)(J,Object(_.a)({onClose:function(){O(!1)},onAccept:function(t){e.onDeleteOperator(t),O(!1)}},e))})]}),Object(g.jsx)(C.a,{children:e.username}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Update"}),Object(g.jsx)(Y.a,{open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(Q,Object(_.a)({onAccept:function(t,a,n,i){a!==e.username&&e.onUsernameChanged(t,a),i.length>0&&e.onPasswordChanged({user_id:t,old_password:n,new_password:i}),d(!1)},handleClose:function(){d(!1)},title:"Update Operator"},e))})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:e.view_utc_time,onChange:function(t){var a=e.id;e.onViewUTCChanged(a,!e[t.target.name])},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"view_utc_time"})}),Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:e.active,onChange:function(t){var a=e.id;e.onActiveChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"active"})}),Object(g.jsx)(C.a,{children:Object(Z.b)(e.last_login,x.user.view_utc_time)}),Object(g.jsx)(C.a,{children:Object(Z.b)(e.creation_time,x.user.view_utc_time)}),Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:e.admin,onChange:function(t){var a=e.id;e.onAdminChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"admin"})}),Object(g.jsx)(C.a,{children:e.id===x.user.id&&Object(g.jsx)(E.a,{"aria-label":"expand row",size:"small",onClick:function(){return i(!n)},children:n?Object(g.jsx)(R.a,{className:"mythicElement"}):Object(g.jsx)(q.a,{className:"mythicElement"})})})]},e.id),Object(g.jsx)(I.a,{children:e.id===x.user.id&&Object(g.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:9,children:Object(g.jsx)(A.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(g.jsxs)(P.a,{margin:1,children:[Object(g.jsx)(L.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"API Tokens"}),Object(g.jsx)(b.a,{size:"small",onClick:e.onCreateAPIToken,style:{float:"right"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"New"}),Object(g.jsxs)(k.a,{size:"small","aria-label":"tokens",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"10rem"},children:"Delete"}),Object(g.jsx)(C.a,{children:"Token"})]})}),Object(g.jsx)(w.a,{children:e.apitokens.map((function(t){return Object(o.createElement)(H,Object(_.a)(Object(_.a)({},t),{},{key:"token"+t.id,onDeleteAPIToken:e.onDeleteAPIToken}))}))})]})]})})})})]})}var ee=a(60);function te(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Settings"})}),Object(g.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{float:"right"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"New Operator"}),Object(g.jsx)(Y.a,{open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(Q,Object(_.a)({title:"New Operator",onAccept:function(t,a,n,i){n!==i?O.b.error("Passwords don't match"):0===i.length?O.b.error("Password must not be empty"):0===a.length?O.b.error("Username must not be empty"):(e.onNewOperator(a,i),r(!1))},handleClose:function(){r(!1)}},e))}),Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"9rem"},children:"Delete Account"}),Object(g.jsx)(C.a,{children:"Username"}),Object(g.jsx)(C.a,{style:{width:"6rem"},children:"Modify"}),Object(g.jsx)(C.a,{style:{width:"10rem"},children:"UTC Timestamps"}),Object(g.jsx)(C.a,{style:{width:"9rem"},children:"Account Active"}),Object(g.jsx)(C.a,{children:"Last Login"}),Object(g.jsx)(C.a,{children:"Account Creation Date"}),Object(g.jsx)(C.a,{style:{width:"9rem"},children:"Admin Status"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"More..."})]})}),Object(g.jsx)(w.a,{children:e.operators.map((function(t){return Object(g.jsx)(X,Object(_.a)({onViewUTCChanged:e.onViewUTCChanged,onAdminChanged:e.onAdminChanged,onActiveChanged:e.onActiveChanged,onDeleteOperator:e.onDeleteOperator,onUsernameChanged:e.onUsernameChanged,onPasswordChanged:e.onPasswordChanged,onDeleteAPIToken:e.onDeleteAPIToken,onCreateAPIToken:e.onCreateAPIToken},t),"operator"+t.id)}))})]})]})]})}var ae,ne,ie,re,ce,oe,se,le,de,ue,be=a(67),je=a(219),pe=a(221),me=Object(be.a)(ae||(ae=Object(v.a)(["\nquery GetOperators {\n  operator(where: {deleted: {_eq: false}}, order_by: {username: asc}) {\n    active\n    admin\n    creation_time\n    deleted\n    id\n    last_login\n    username\n    view_utc_time\n    apitokens {\n      token_value\n      token_type\n      active\n      id\n    }\n  }\n}\n"]))),he=Object(be.a)(ne||(ne=Object(v.a)(["\nmutation SettingsUpdateOperatorViewUTCTime($id: Int!, $view_utc_time: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {view_utc_time: $view_utc_time}) {\n    id\n    view_utc_time\n  }\n}\n"]))),fe=Object(be.a)(ie||(ie=Object(v.a)(["\nmutation SettingsUpdateOperatorAdminMutation($id: Int!, $admin: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {admin: $admin}) {\n      id\n      admin\n  }\n}\n"]))),Oe=Object(be.a)(re||(re=Object(v.a)(["\nmutation SettingsUpdateOperatorActiveMutation($id: Int!, $active: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {active: $active}) {\n      id\n      active\n  }\n}\n"]))),ge=Object(be.a)(ce||(ce=Object(v.a)(["\nmutation SettingsDeleteOperatorMutation($id: Int!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {deleted: true}) {\n      id\n      deleted\n  }\n}\n"]))),xe=Object(be.a)(oe||(oe=Object(v.a)(["\nmutation SettingsUsernameOperatorMutation($id: Int!, $username: String!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {username: $username}) {\n      id\n      username\n  }\n}\n"]))),ye=Object(be.a)(se||(se=Object(v.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    active\n    creation_time\n    deleted\n    error\n    id\n    last_login\n    status\n    username\n    view_utc_time\n  }\n}\n"]))),_e=Object(be.a)(le||(le=Object(v.a)(["\nmutation operatorsUpdatePasswordMutation($user_id: Int!, $new_password: String!, $old_password: String){\n  updatePassword(user_id: $user_id, new_password: $new_password, old_password: $old_password){\n    status\n    error\n  }\n}\n"]))),ve=Object(be.a)(de||(de=Object(v.a)(['\nmutation createAPITokenMutation{\n  createAPIToken(token_type: "User"){\n    id\n    token_value\n    status\n    error\n    operator_id\n  }\n}\n']))),ke=Object(be.a)(ue||(ue=Object(v.a)(["\nmutation deleteAPIToken($id: Int!){\n  delete_apitokens_by_pk(id: $id){\n    id\n    operator_id\n  }\n}\n"])));function we(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1];Object(je.a)(me,{fetchPolicy:"no-cache",onCompleted:function(e){r(e.operator)}});var c=Object(pe.a)(he,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var a=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(_.a)(Object(_.a)({},t),{},{view_utc_time:e.update_operator_by_pk.view_utc_time}):Object(_.a)({},t)}));if(e.update_operator_by_pk.id===t.user.id){var n=Object(h.b)();n.user.view_utc_time=e.update_operator_by_pk.view_utc_time,Object(h.b)(n)}r(a),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(e){console.log(e),O.b.error("Unable to update operator timestamps without Admin permissions")}}),o=Object(u.a)(c,1)[0],l=Object(pe.a)(ge,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.filter((function(t){return t.id!==e.update_operator_by_pk.id}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to delete operator without Admin permissions")}}),d=Object(u.a)(l,1)[0],b=Object(pe.a)(fe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(_.a)(Object(_.a)({},t),{},{admin:e.update_operator_by_pk.admin}):Object(_.a)({},t)}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to update operator admin status without Admin permissions")}}),j=Object(u.a)(b,1)[0],p=Object(pe.a)(Oe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(_.a)(Object(_.a)({},t),{},{active:e.update_operator_by_pk.active}):Object(_.a)({},t)}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to update operator active status without Admin permissions")}}),m=Object(u.a)(p,1)[0],x=Object(pe.a)(ve,{onCompleted:function(e){if("success"===e.createAPIToken.status){O.b.success("Successfully created new API Token");var t=i.map((function(t){return t.id===e.createAPIToken.operator_id?Object(_.a)(Object(_.a)({},t),{},{apitokens:[].concat(Object(y.a)(t.apitokens),[Object(_.a)({},e.createAPIToken)])}):Object(_.a)({},t)}));r(t)}else O.b.error(e.createAPIToken.error)},onError:function(e){console.log(e)}}),v=Object(u.a)(x,1)[0],k=Object(pe.a)(ke,{onCompleted:function(e){var t=i.map((function(t){return t.id===e.delete_apitokens_by_pk.operator_id?Object(_.a)(Object(_.a)({},t),{},{apitokens:t.apitokens.filter((function(t){return t.id!==e.delete_apitokens_by_pk.id}))}):Object(_.a)({},t)}));r(t)},onError:function(e){}}),w=Object(u.a)(k,1)[0],C=Object(pe.a)(ye,{onCompleted:function(e){if("success"===e.createOperator.status){var t=e.createOperator;r([].concat(Object(y.a)(i),[t]))}else O.b.error(e.createOperator.error)},onError:function(e){O.b.warning("Unable to create new operator"),console.log(e)}}),S=Object(u.a)(C,1)[0],D=Object(pe.a)(xe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(_.a)(Object(_.a)({},t),{},{username:e.update_operator_by_pk.username}):Object(_.a)({},t)}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to update operator's username without Admin permissions")}}),I=Object(u.a)(D,1)[0],T=Object(pe.a)(_e,{onCompleted:function(e){"success"===e.updatePassword.status?O.b.success("Successfully updated password"):O.b.warning(e.updatePassword.error)},onError:function(){O.b.warning("Unable to update operator's password without Admin permissions")}}),$=Object(u.a)(T,1)[0];return Object(g.jsx)("div",{style:{height:"calc(94vh)",marginTop:"10px",marginRight:"5px"},children:Object(g.jsx)(te,{onViewUTCChanged:function(e,t){o({variables:{id:e,view_utc_time:t}})},onAdminChanged:function(e,t){j({variables:{id:e,admin:t}})},onActiveChanged:function(e,t){m({variables:{id:e,active:t}})},onNewOperator:function(e,t){S({variables:{username:e,password:t}})},onDeleteOperator:function(e){d({variables:{id:e}})},onUsernameChanged:function(e,t){I({variables:{id:e,username:t}})},onPasswordChanged:function(e){var t=e.user_id,a=e.old_password,n=e.new_password;$({variables:{user_id:t,new_password:n,old_password:a}})},onCreateAPIToken:function(){v({variables:{}})},onDeleteAPIToken:function(e){w({variables:{id:e}})},operators:i})})}var Ce,Se=a(143),De=a(13),Ie=a(862),Te=a(923),$e=a(924),Pe=a(861),Ae=a(248),Ee=Object(be.a)(Ce||(Ce=Object(v.a)(["\nquery GetPayloadDetails($payload_name: String!) {\n  payloadtype(where: {ptype: {_eq: $payload_name}}) {\n    buildparameters (where: {deleted: {_eq: false} } ){\n      description\n      name\n      id\n      parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function Le(e){var t=Object(o.useState)([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(Ee,{variables:{payload_name:e.payload_name},onCompleted:function(e){console.log(e);var t=e.payloadtype[0].buildparameters.map((function(e){switch(e.parameter_type){case"ChooseOne":return Object(_.a)(Object(_.a)({},e),{},{defaultParameter:e.parameter.split("\n")[0],options:e.parameter.split("\n").join(", ")});default:return Object(_.a)(Object(_.a)({},e),{},{defaultParameter:e.parameter})}}));i(t)}}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ae.a,{}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(V.a,{children:"These are the build parameters associated with this payload"}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:e.description}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)("b",{children:"Scripting/Building Name: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.name}),Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Parameter Type: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.parameter_type}),Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Default Parameter: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.defaultParameter}),Object(g.jsx)("br",{}),"ChooseOne"===e.parameter_type?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("b",{children:"Parameter Options: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.options}),Object(g.jsx)("br",{})]}):null,Object(g.jsx)("b",{children:"Required? "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.required?"Yes":"No"}),Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Verifier Regex: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.verifier_regex}),Object(g.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.handleClose,color:"primary",children:"Close"})})]})}var Fe=Object(Se.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),qe=Object(De.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Pe.a);function Ne(e){var t=Fe(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(""),m=Object(u.a)(p,2),h=m[0],f=m[1],O=new Date,x=(O.getTime()+6e4*O.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(o.useEffect)((function(){if(e.wrap_these_payload_types.length>0){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));r(t.join(", "))}else r("");f(e.supported_os.split(",").join(", "))}),[e.wrap_these_payload_types,e.supported_os]),Object(g.jsxs)(Ie.a,{className:t.root,elevation:5,children:[Object(g.jsx)(qe,{overlap:"circle",classes:{badge:t[x]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(g.jsx)(Te.a,{className:t.media,component:"img",style:{width:"125px",height:"125",padding:"10px",objectFit:"unset"},src:"/static/"+e.ptype+".svg"})}),Object(g.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(g.jsx)(L.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.ptype}),Object(g.jsxs)($e.a,{style:{textAlign:"left"},children:[Object(g.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Author:"})," ",e.author]}),Object(g.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Supported Operating Systems:"})," ",h]}),0===e.wrap_these_payload_types.length?null:Object(g.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Wrapped Payload Types:"})," ",i]}),Object(g.jsx)(L.a,{variant:"body2",component:"p",children:e.note})]})]}),Object(g.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(g.jsx)(b.a,{size:"small",variant:"contained",color:"primary",href:e.wrapper?"/docs/wrappers/"+e.ptype:"/docs/agents/"+e.ptype,target:"_blank",children:"Docs"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){j(!0)},color:"primary",variant:"contained",children:"Building Info"}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:d,onClose:function(){j(!1)},innerDialog:Object(g.jsx)(Le,Object(_.a)(Object(_.a)({},e),{},{payload_name:e.ptype}))})]})]})}var Re,Be,ze=a(876),We=Object(be.a)(Re||(Re=Object(v.a)(["\n subscription getPayloadTypesSubscription {\n  payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n    author\n    container_running\n    id\n    last_heartbeat\n    note\n    ptype\n    supported_os\n    wrapper\n    translationcontainer {\n        id\n        name\n        last_heartbeat\n        container_running\n    }\n    wrap_these_payload_types {\n        id\n        wrapped {\n          ptype\n        }\n    }\n  }\n}\n "])));function Me(e){var t=Object(ee.a)(),a=Object(ze.a)(We).data,n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1];return Object(o.useEffect)((function(){c(void 0!==a?a.payloadtype:[])}),[a]),Object(g.jsxs)("div",{style:{flexDirection:"column",alignItems:"stretch"},children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payload Types"})}),r.map((function(e){return Object(g.jsx)(Ne,Object(_.a)({},e),"payloadtype"+e.id)}))]})}var He=Object(be.a)(Be||(Be=Object(v.a)(["\nquery GetPC2Details($payload_name: String!) {\n  c2profile(where: {name: {_eq: $payload_name}}) {\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      name\n      parameter_type\n      id\n      randomize\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function Ue(e){var t=Object(o.useState)([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(He,{variables:{payload_name:e.payload_name},onCompleted:function(e){var t=e.c2profile[0].c2profileparameters.map((function(e){switch(e.parameter_type){case"ChooseOne":return Object(_.a)(Object(_.a)({},e),{},{defaultParameter:e.default_value.split("\n")[0],options:e.default_value.split("\n").join(", ")});case"Date":return Object(_.a)(Object(_.a)({},e),{},{defaultParameter:"Today with an offset of "+e.default_value+" days"});case"Dictionary":return Object(_.a)(Object(_.a)({},e),{},{defaultParameter:JSON.stringify(JSON.parse(e.default_value),null,2)});default:return Object(_.a)(Object(_.a)({},e),{},{defaultParameter:e.default_value})}}));i(t)}}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ae.a,{}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(V.a,{children:"These are the build parameters associated with this payload"}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:e.description}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)("b",{children:"Scripting/Building Name: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.name}),Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Parameter Type: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.parameter_type}),Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Default Parameter: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.defaultParameter}),Object(g.jsx)("br",{}),"ChooseOne"===e.parameter_type?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("b",{children:"Parameter Options: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.options}),Object(g.jsx)("br",{})]}):null,Object(g.jsx)("b",{children:"Required? "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.required?"Yes":"No"}),Object(g.jsx)("br",{}),""===e.verifier_regex?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("b",{children:"Verifier Regex: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.verifier_regex}),Object(g.jsx)("br",{})]}),Object(g.jsx)("b",{children:"Randomize value?: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.randomize?"Yes":"No"}),Object(g.jsx)("br",{}),""===e.format_string?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("b",{children:"Random Format String: "}),Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.format_string}),Object(g.jsx)("br",{})]})]})]},"buildprop"+e.id)}))})]})]}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Ge,Ve=a(164),Ke=a.n(Ve),Qe=a(927),Je=a(188),Ye=a.n(Je),Ze=a(856),Xe=a(552),et=a(863),tt=a(376),at=a(854),nt=Object(be.a)(Ge||(Ge=Object(v.a)(["\nquery getProfileOutput($id: Int!) {\n  getProfileOutput(id: $id) {\n    status\n    error\n    output\n  }\n}\n"])));function it(e){var t=Object(je.a)(nt,{variables:{id:e.profile_id},onCompleted:function(e){},fetchPolicy:"network-only"}),a=t.loading,n=t.error,i=t.data;return a?Object(g.jsx)(Ae.a,{}):n?(console.error(n),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(V.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(g.jsx)(j.a,{multiline:!0,onChange:function(){},value:i.getProfileOutput.output})]}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var rt,ct=a(137),ot=a.n(ct),st=(a(332),a(255),a(333),Object(be.a)(rt||(rt=Object(v.a)(["\nquery getProfileConfigOutput($id: Int!, $filename: String!) {\n  downloadContainerFile(id: $id, filename: $filename) {\n    status\n    error\n    filename\n    data\n  }\n}\n"]))));function lt(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(st,{variables:{id:e.profile_id,filename:"config.json"},onCompleted:function(e){"error"===e.downloadContainerFile.status?i("Errored trying to read file from container\n"+e.downloadContainerFile.error):(console.log(e),i(atob(e.downloadContainerFile.data)))},fetchPolicy:"network-only"}),c=r.loading,l=r.error;if(c)return Object(g.jsx)(Ae.a,{});if(l)return console.error(l),Object(g.jsx)("div",{children:"Error!"});return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Configuration"]}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(ot.a,{mode:"json",theme:"monokai",onChange:function(e,t){i(e)},fontSize:14,showGutter:!0,highlightActiveLine:!0,value:n,focus:!0,width:"100%",setOptions:{showLineNumbers:!0,tabSize:4}})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:function(){e.onConfigSubmit(btoa(n)),e.onClose()},color:"secondary",children:"Submit"})]})]})}function dt(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(V.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(g.jsx)(j.a,{multiline:!0,value:e.output,onChange:function(){}})]}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var ut=a(483),bt=a.n(ut),jt=a(25),pt=a(249),mt=a(373),ht=a(378),ft=a(172),Ot=a(372),gt=a(187),xt=a.n(gt),yt=a(99),_t=a(938),vt=a(316),kt=a(852);function wt(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,r=e.required,c=e.verifier_regex,l=e.id,d=e.description,p=e.value,m=(e.returnAllDictValues,s.a.useState("")),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(ee.a)(),v=s.a.useState([]),k=Object(u.a)(v,2),w=k[0],S=k[1],D=s.a.useState([]),T=Object(u.a)(D,2),P=T[0],A=T[1],F=s.a.useState([]),q=Object(u.a)(F,2),N=q[0],R=q[1],B=s.a.useState(""),W=Object(u.a)(B,2),M=W[0],H=W[1],U=s.a.useState([]),G=Object(u.a)(U,2),V=G[0],K=G[1],Q=s.a.useState(new Date),J=Object(u.a)(Q,2),Y=J[0],Z=J[1],X=function(e){var a=e.reduce((function(e,t){return""!==t.value?[].concat(Object(y.a)(e),[{custom:"*"===t.name,key:t.key,name:t.name,value:t.value}]):Object(y.a)(e)}),[]);t(i,a,!1)};Object(o.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");O(e[0]),K(e)}""!==p&&void 0!==p&&(O(p),t(i,p,""))}else if("Date"===a){if(""!==n){var r=new Date;r.setDate(r.getDate()+parseInt(n)),re(r),O(-1)}""!==p&&void 0!==p&&p.includes("-")&&(console.log("passed date value: ",p),Z(new Date(p)),O(-1),t(i,new Date(p).toISOString().slice(0,10),""))}else if("Dictionary"===a)if(""!==p&&void 0!==p&&"object"===typeof p){console.log("passed dictionaryvalue",p);var c=p.reduce((function(e,t){return t.default_show?[].concat(Object(y.a)(e),[Object(_.a)({},t)]):Object(y.a)(e)}),[]);X(c),S(c),A(p);var o=p.reduce((function(e,t){var a=c.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(y.a)(e),[Object(_.a)({},t)]):Object(y.a)(e)}),[]);R(o),o.length>0&&H(o[0])}else{var s=JSON.parse(n);A(s);var l=s.reduce((function(e,t){return t.default_show?[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);X(l),S(l);var d=s.reduce((function(e,t){var a=l.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);R(d),d.length>0&&H(d[0])}else"Boolean"===a?(O(void 0===n||"true"===n.toLowerCase()),""!==p&&void 0!==p&&(console.log(p,!0),O(p))):(void 0!==n&&O(n),""!==p&&void 0!==p&&(O(p),t(i,p,"")))}),[n,a,i]);var te=function(e){O(e.target.value),t(i,e.target.value,!1)},ae=function(e,a,n){O(a),t(e,a,n)},ne=function(e){return(r&&""!==c||""!==c&&""!==e)&&!RegExp(c).test(e)},ie=function(){var e=Object(_.a)({},M);"*"===e.name&&(e.key="",e.value="");var t=[].concat(Object(y.a)(w),[Object(_.a)(Object(_.a)({},e),{},{default_show:!0})]);S(t);var a=N.reduce((function(a,n){var i=t.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return e.name===n.name&&(i+=1),-1===n.max||n.max>i?[].concat(Object(y.a)(a),[Object(_.a)({},n)]):Object(y.a)(a)}),[]);X(t),R(a),a.length>0&&H(a[0])},re=function(e){Z(e),t(i,e.toISOString().slice(0,10),"")},ce=function(e){var a=!f;O(a),t(i,a,!1)},oe=s.a.useState(null),se=Object(u.a)(oe,2),le=se[0],de=se[1],ue=Boolean(le),be=function(){de(null)};return Object(g.jsxs)(I.a,{children:[Object(g.jsxs)(C.a,{children:[Object(g.jsx)(L.a,{"aria-haspopup":"true",onMouseEnter:function(e){de(e.currentTarget)},onMouseLeave:be,"aria-owns":ue?"taskparam"+l+"popover":void 0,children:d}),Object(g.jsx)(kt.a,{id:"taskparam"+l+"popover",open:ue,anchorEl:le,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:be,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===x.palette.type?x.palette.primary.dark:x.palette.primary.light,color:"white"},variant:"outlined"},children:Object(g.jsx)(L.a,{children:i.length>0?i:"No Description"})})]}),Object(g.jsx)(C.a,{children:function(){switch(a){case"Date":return Object(g.jsx)(yt.a,{utils:vt.a,children:Object(g.jsx)(ft.a,{container:!0,justify:"flex-start",children:Object(g.jsx)(_t.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:Y,onChange:re,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(g.jsx)(mt.a,{children:Object(g.jsx)(ht.a,{native:!0,value:f,onChange:te,children:V.map((function(e,t){return Object(g.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(g.jsxs)(s.a.Fragment,{children:[w.map((function(e,t){return Object(g.jsxs)("div",{children:[Object(g.jsxs)(E.a,{onClick:function(e){!function(e){var t=w[e],a=w.filter((function(t,a){return e!==a}));S(a);var n=P.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(y.a)(e),[Object(_.a)({},n)]):Object(y.a)(e)}),[]);X(a),R(n),n.length>0&&H(n[0])}(t)},children:[Object(g.jsx)(z.a,{style:{color:x.palette.error.main}})," "]}),"*"===e.name?Object(g.jsx)(Ot.a,{style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=w.map((function(a,n){return n===t?Object(_.a)(Object(_.a)({},a),{},{key:e.target.value}):Object(_.a)({},a)}));X(a),S(a)}(e,t)}}):Object(g.jsx)(Ot.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"key"}),value:e.key}),Object(g.jsx)(Ot.a,{style:{width:"75%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=w.map((function(a,n){return n===t?Object(_.a)(Object(_.a)({},a),{},{value:e.target.value}):Object(_.a)({},a)}));X(a),S(a)}(e,t)}})]},"dictval"+t)})),N.length>0?Object(g.jsxs)("div",{children:[Object(g.jsxs)(E.a,{onClick:ie,children:[" ",Object(g.jsx)(xt.a,{style:{color:x.palette.success.main}})," "]}),Object(g.jsx)(ht.a,{size:"small",value:M,onChange:function(e){return H(e.target.value)},children:N.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+t)}))})]}):null]});case"String":return Object(g.jsx)(j.a,{required:r,value:f,multiline:!0,onChange:ae,display:"inline-block",name:i,validate:ne,errorText:"Must match: "+c});case"Boolean":return Object(g.jsx)($.a,{checked:f,onChange:ce,inputProps:{"aria-label":"primary checkbox"}});default:return null}}()})]},"buildparam"+l)}function Ct(e){var t=function(t,a,n){e.onChange(e.name,t,a,n)};return Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"auto"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"20%"},children:"Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{children:e.c2profileparameters.map((function(a){return Object(g.jsx)(wt,Object(_.a)({returnAllDictValues:e.returnAllDictValues,onChange:t},a),"c2paramtablerow"+a.id)}))})]})})}var St,Dt,It,Tt,$t=a(374),Pt=a(293),At=Object(be.a)(St||(St=Object(v.a)(["\nquery getProfileParameters($id: Int!, $operation_id: Int!) {\n  c2profile_by_pk(id: $id) {\n    c2profileparameters(where: {deleted: {_eq: false}}, order_by: {name: asc}){\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n      instance_name\n    }\n  }\n}\n"]))),Et=Object(be.a)(Dt||(Dt=Object(v.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    id\n    value\n  }\n}\n"]))),Lt=Object(be.a)(It||(It=Object(v.a)(["\nmutation deleteSavedInstance($name: String!, $operation_id: Int!){\n  delete_c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}){\n    affected_rows\n  }\n}\n"]))),Ft=Object(be.a)(Tt||(Tt=Object(v.a)(["\nmutation createNewC2Instance($instance_name: String!, $c2_instance: String!, $c2profile_id: Int!){\n  create_c2_instance(c2_instance: $c2_instance, instance_name: $instance_name, c2profile_id: $c2profile_id){\n    status\n    error\n  }\n}\n"])));function qt(e){var t=Object(ee.a)(),a=Object(f.a)(h.b),n=Object(o.useState)(""),i=Object(u.a)(n,2),r=i[0],c=i[1],l=Object(o.useState)(""),d=Object(u.a)(l,2),p=d[0],m=d[1],x=Object(o.useState)([]),v=Object(u.a)(x,2),k=v[0],w=v[1],C=Object(o.useState)([]),S=Object(u.a)(C,2),D=S[0],I=S[1],T=Object(o.useState)([]),$=Object(u.a)(T,2),P=$[0],A=$[1],E=Object(je.a)(At,{variables:{id:e.id,operation_id:a.user.current_operation_id},onCompleted:function(e){var t=e.c2profile_by_pk.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Pt(e.format_string).gen();return Object(_.a)(Object(_.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(_.a)(Object(_.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return t.default_show?[].concat(Object(y.a)(e),[{value:t.default_value,key:"*"===t.name?"":t.name,name:t.name,custom:"*"===t.name}]):Object(y.a)(e)}),[]);return Object(_.a)(Object(_.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return n.setDate(n.getDate()+parseInt(e.default_value)),Object(_.a)(Object(_.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(_.a)(Object(_.a)({},e),{},{value:e.default_value})}return Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value})}));t.sort((function(e,t){return-t.description.localeCompare(e.description)})),I(Object(y.a)(t)),A(Object(y.a)(t)),w(e.c2profile_by_pk.c2profileparametersinstances)},onError:function(e){},fetchPolicy:"network-only"}).loading,F=Object(pt.a)(Et,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(_.a)(Object(_.a)({},e),e.c2profileparameter);return"Dictionary"!==t.parameter_type&&"Array"!==t.parameter_type||(t.value=JSON.parse(t.value)),t}));t.sort((function(e,t){return e.name<t.name?-1:1})),A(t)},onError:function(e){O.b.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),q=Object(u.a)(F,1)[0],N=Object(pe.a)(Lt,{onCompleted:function(e){m(""),c(""),A(Object(y.a)(D));var t=k.filter((function(e){return e.instance_name!==p}));w(t),O.b.success("Sucessfully deleted instance")},onError:function(e){O.b.error("Failed to delete instance: "+e)}}),R=Object(u.a)(N,1)[0],B=Object(pe.a)(Ft,{onCompleted:function(t){"success"===t.create_c2_instance.status?O.b.success("Successfully created instance"):O.b.error("Failed to create instance: "+t.create_c2_instance.error),e.onClose()},onError:function(e){O.b.error("Failed to create instance: "+e)}}),z=Object(u.a)(B,1)[0];if(E)return Object(g.jsx)(Ae.a,{});return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:["Save an Instance of ",e.name,"'s Parameters"]}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(L.a,{style:{paddingBottom:"10px"},children:"Saving an instance of the parameters allows you to select them from a dropdown when creating agents later, saving time and typos."}),k.length>0?Object(g.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px"},children:[Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsxs)(mt.a,{style:{width:"100%"},children:[Object(g.jsx)($t.a,{children:"Select an Existing Instance"}),Object(g.jsxs)(ht.a,{style:{width:"100%",marginBottom:"10px"},value:p,label:"Select an Existing Instance",onChange:function(e){m(e.target.value),c(e.target.value),""===e.target.value?A(Object(y.a)(D)):(A([]),q({variables:{name:e.target.value,operation_id:a.user.current_operation_id}}))},children:[Object(g.jsx)(tt.a,{value:"",children:"New Instance"}),k.map((function(e,t){return Object(g.jsx)(tt.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]})}),Object(g.jsx)(ft.a,{item:!0,xs:6,children:p.length>0?Object(g.jsx)(b.a,{style:{backgroundColor:t.palette.error.main,color:"white"},variant:"contained",onClick:function(){A([]),R({variables:{name:p,operation_id:a.user.current_operation_id}})},children:" Delete Instance"}):null})]}):null,Object(g.jsx)(j.a,{name:"Instance Name",onChange:function(e,t,a){c(t)},value:r,style:{paddingTop:"10px"}}),Object(g.jsx)(Ct,Object(_.a)(Object(_.a)({},e),{},{returnAllDictValues:!0,c2profileparameters:P,onChange:function(e,t,a,n){var i=P.map((function(e){return e.name===t?Object(_.a)(Object(_.a)({},e),{},{error:n,value:a}):e}));console.log(i),A(i)}}))]}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:function(){if(0!==r.length){var t=P.reduce((function(e,t){return Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.name,t.value))}),{});z({variables:{operation_id:a.user.current_operation_id,instance_name:r,c2profile_id:e.id,c2_instance:JSON.stringify(t)}})}else O.b.warning("Must supply an instance name")},color:"secondary",children:p.length>0?"Update":"Create"})]})]})}var Nt,Rt,Bt,zt=a(54),Wt=a(33),Mt=Object(Se.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"},successButton:{backgroundColor:e.palette.success.main,color:"white","&:hover":{backgroundColor:e.palette.success.dark}},errorButton:{backgroundColor:e.palette.error.main,color:"white","&:hover":{backgroundColor:e.palette.error.dark}}}})),Ht=Object(De.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Pe.a),Ut=Object(be.a)(Nt||(Nt=Object(v.a)(["\nmutation StartStopProfile($id: Int!, $action: String) {\n  startStopProfile(id: $id, action: $action) {\n    status\n    error\n    output\n  }\n}\n"]))),Gt=Object(be.a)(Rt||(Rt=Object(v.a)(["\nmutation setProfileConfiguration($id: Int!, $file_path: String!, $data: String!) {\n  uploadContainerFile(id: $id, file_path: $file_path, data: $data) {\n    status\n    error\n    filename\n  }\n}\n"])));function Vt(e){var t=new Date,a=Object(ee.a)(),n=Mt(a),i=(t.getTime()+6e4*t.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning",r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useRef(null),f=function(){m((function(e){return!e}))},x=function(e){h.current&&h.current.contains(e.target)||m(!1)},y=Object(pe.a)(Ut,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){N(e.startStopProfile.output),W(!0)}}),v=Object(u.a)(y,1)[0],k=function(){e.running?O.b.info("Submitting stop task..."):O.b.info("Submitting start task..."),v({variables:{id:e.id,action:e.running?"stop":"start"}})},w=s.a.useState(!1),C=Object(u.a)(w,2),S=C[0],D=C[1],I=s.a.useState(!1),$=Object(u.a)(I,2),P=$[0],A=$[1],E=s.a.useState(""),F=Object(u.a)(E,2),q=F[0],N=F[1],R=s.a.useState(!1),B=Object(u.a)(R,2),z=B[0],W=B[1],M=s.a.useState(!1),H=Object(u.a)(M,2),U=H[0],G=H[1],V=Object(pe.a)(Gt,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){"success"===e.uploadContainerFile.status?O.b.success("Updated file"):O.b.error("Error updating: "+e.uploadContainerFile.error)}}),K=Object(u.a)(V,1)[0];return Object(g.jsxs)(Ie.a,{className:n.root,elevation:5,style:{maxWidth:"100%"},children:[Object(g.jsx)(Ht,{overlap:"circle",classes:{badge:n[i]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.is_p2p?Object(g.jsx)(zt.a,{icon:Wt.x,style:{width:"100px",height:"100px",marginTop:"25px"}}):Object(g.jsx)(Ke.a,{style:{width:"100px",height:"100px",marginTop:"25px"}})}),Object(g.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(g.jsx)(L.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block"},children:e.name}),!e.is_p2p&&e.running&&Object(g.jsx)(L.a,{variant:"h6",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block",color:a.palette.success.main},children:"(Server Running)"}),!e.is_p2p&&!e.running&&Object(g.jsx)(L.a,{variant:"h6",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block",color:a.palette.error.main},children:"(Server Not Running)"}),Object(g.jsxs)($e.a,{style:{textAlign:"left"},children:[Object(g.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Author:"})," ",e.author]}),Object(g.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Supported Agents:"})," ",e.payloadtypec2profiles.map((function(e){return e.payloadtype.ptype+" "}))]}),Object(g.jsx)(L.a,{variant:"body2",component:"p",children:e.description}),Object(g.jsx)(L.a,{variant:"body2",component:"p"})]})]}),Object(g.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(g.jsx)(b.a,{size:"small",variant:"contained",color:"primary",href:"/docs/c2-profiles/"+e.name.toLowerCase(),target:"_blank",children:"Docs"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){l(!0)},color:"primary",variant:"contained",children:"Build Info"}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:o,onClose:function(){l(!1)},innerDialog:Object(g.jsx)(Ue,Object(_.a)(Object(_.a)({},e),{},{onClose:function(){l(!1)},payload_name:e.name}))}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:z,onClose:function(){W(!1)},innerDialog:Object(g.jsx)(dt,{output:q,onClose:function(){W(!1)},payload_name:e.name})}),e.container_running?e.running?Object(g.jsxs)(Qe.a,{variant:"contained",ref:h,"aria-label":"split button",children:[Object(g.jsx)(b.a,{size:"small",className:e.running?n.successButton:n.errorButton,onClick:k,style:{width:"100%"},children:"Stop Profile"}),Object(g.jsx)(b.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",className:e.running?n.successButton:n.errorButton,onClick:f,children:Object(g.jsx)(Ye.a,{})})]}):e.is_p2p?null:Object(g.jsxs)(Qe.a,{variant:"contained",ref:h,"aria-label":"split button",children:[Object(g.jsx)(b.a,{size:"small",onClick:k,className:e.running?n.successButton:n.errorButton,style:{width:"100%"},children:"Start Profile"}),Object(g.jsx)(b.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",className:e.running?n.successButton:n.errorButton,onClick:f,children:Object(g.jsx)(Ye.a,{})})]}):Object(g.jsx)(b.a,{disabled:!0,color:"secondary",children:"Container Offline"}),Object(g.jsxs)(b.a,{size:"small",variant:"contained",color:"primary",onClick:function(){G(!0)},children:[Object(g.jsx)(bt.a,{})," Saved Instances"]}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:S,onClose:function(){D(!1)},innerDialog:Object(g.jsx)(it,Object(_.a)(Object(_.a)({},e),{},{payload_name:e.name,onClose:function(){D(!1)},profile_id:e.id}))}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:P,onClose:function(){A(!1)},innerDialog:Object(g.jsx)(lt,Object(_.a)(Object(_.a)({},e),{},{onConfigSubmit:function(t){K({variables:{id:e.id,file_path:"config.json",data:t}})},payload_name:e.name,onClose:function(){A(!1)},profile_id:e.id}))}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:U,onClose:function(){G(!1)},innerDialog:Object(g.jsx)(qt,Object(_.a)(Object(_.a)({},e),{},{onClose:function(){G(!1)}}))}),Object(g.jsx)(et.a,{open:p,anchorEl:h.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var n=t.TransitionProps,i=t.placement;return Object(g.jsx)(Xe.a,Object(_.a)(Object(_.a)({},n),{},{style:{transformOrigin:"bottom"===i?"center top":"center bottom"},children:Object(g.jsx)(T.a,{style:{backgroundColor:"dark"===a.palette.type?a.palette.primary.dark:a.palette.primary.light,color:"white"},children:Object(g.jsx)(Ze.a,{onClickAway:x,children:Object(g.jsxs)(at.a,{id:"split-button-menu",children:[Object(g.jsx)(tt.a,{onClick:function(){A(!0)},children:"View/Edit Config"},"dropdownprofile"+e.id+"menu1"),e.running?Object(g.jsx)(tt.a,{onClick:function(){D(!0)},children:"View Stdout/Stderr"},"dropdownprofile"+e.id+"menu2"):null]})})})}))}})]})]})}var Kt=Object(be.a)(Bt||(Bt=Object(v.a)(["\nsubscription getPayloadTypesSubscription {\n   c2profile(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   author\n   id\n   container_running\n   description\n   is_p2p\n   last_heartbeat\n   name\n   running\n   payloadtypec2profiles(order_by: {payloadtype: {ptype: asc}}) {\n     payloadtype {\n       ptype\n     }\n   }\n }\n}\n"])));function Qt(e){var t=Object(ze.a)(Kt,{fetchPolicy:"network-only"}).data,a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(ee.a)();return Object(o.useEffect)((function(){r(void 0!==t?t.c2profile:[])}),[t]),Object(g.jsxs)("div",{style:{flexDirection:"column",alignItems:"stretch",paddingLeft:"10px"},children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"C2 Profiles"})}),i.map((function(e){return Object(g.jsx)(Vt,Object(_.a)({},e),"c2prof"+e.id)}))]})}var Jt,Yt=Object(Se.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),Zt=Object(De.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Pe.a);function Xt(e){var t=Yt(),a=new Date,n=(a.getTime()+6e4*a.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(g.jsxs)(Ie.a,{className:t.root,elevation:5,children:[Object(g.jsx)(Zt,{overlap:"circle",classes:{badge:t[n]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(g.jsx)(zt.a,{icon:Wt.w,size:"6x",style:{width:"125px",height:"125px"}})}),Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.name}),e.payloadtypes.length>0?Object(g.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Translated Payload Types:"})," ",e.payloadtypes.map((function(e){return e.ptype})).join(", ")]}):null]})]})}var ea=Object(be.a)(Jt||(Jt=Object(v.a)(["\nsubscription getTranslationContainersSubscription {\n translationcontainer(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   name\n   id\n   container_running\n   last_heartbeat\n   payloadtypes(order_by: {ptype: asc}) {\n       ptype\n       id\n   }\n }\n}\n"])));function ta(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(ze.a)(ea).data,j=Object(ee.a)();return Object(o.useEffect)((function(){if(void 0!==b){var e=b.translationcontainer.filter((function(e){return 0===e.payloadtypes.length})),t=b.translationcontainer.filter((function(e){return e.payloadtypes.length>0}));i(e),d(t)}else i([])}),[b]),Object(g.jsxs)("div",{style:{width:"100%",display:"inline-flex",flexDirection:"column",alignItems:"stretch"},children:[n.length>0?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:j.pageHeader.main,color:j.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers Not Assigned to Payload Types"})}),n.map((function(e){return Object(g.jsx)(Xt,Object(_.a)({},e),"translation_container"+e.id)}))]}):null,l.length>0?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:j.pageHeader.main,color:j.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers"})}),l.map((function(e){return Object(g.jsx)(Xt,Object(_.a)({},e),"translation_container"+e.id)}))]}):null]})}function aa(e){return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(ft.a,{container:!0,spacing:0,children:[Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsx)(Me,{})}),Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsx)(Qt,{})}),Object(g.jsx)(ft.a,{item:!0,xs:12,children:Object(g.jsx)(ta,{})})]})})}var na,ia=a(945),ra=a(930),ca=a(942),oa=a(925),sa=a(855);function la(e){return Object(g.jsxs)("div",{children:[Object(g.jsx)(b.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",onClick:e.finished,children:e.last?"Create Payload":"Next"})]})}var da,ua=Object(be.a)(na||(na=Object(v.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    id\n    supported_os\n  }\n}\n "])));function ba(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];if(Object(je.a)(ua,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(y.a)(t),[a])}),[]);return[].concat(Object(y.a)(e),Object(y.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),l(a)},onError:function(e){console.error(e)}}).loading)return Object(g.jsx)("div",{children:Object(g.jsx)(oa.a,{})});return Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(g.jsx)("br",{}),Object(g.jsxs)(mt.a,{children:[Object(g.jsx)(ht.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(g.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(g.jsx)(sa.a,{children:"Target Operating System"})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(la,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){e.finished(n)}})]})}function ja(e){return Object(g.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(g.jsx)(L.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Build Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{children:e.buildParameters.map((function(t){return Object(g.jsx)(wt,Object(_.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var pa=Object(be.a)(da||(da=Object(v.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function ma(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(je.a)(pa,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){console.log(e.prevData),i(e.prevData.payload_type),l(e.prevData.file_extension),p(e.prevData.supports_dynamic_loading);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(_.a)(Object(_.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(a)}else{i(t.payloadtype[0].ptype),l(t.payloadtype[0].file_extension),p(t.payloadtype[0].supports_dynamic_loading);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):"Boolean"===e.parameter_type?Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:"true"===e.default_value.toLowerCase()}):Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(e),Object(y.a)(n))}return Object(y.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(n),console.log(n)}}}),v=x.loading,k=x.error,w=x.data;return v?Object(g.jsx)("div",{children:Object(g.jsx)(oa.a,{})}):k?(console.error(k),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(g.jsx)(ht.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=w.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){l(a.file_extension),p(a.supports_dynamic_loading);var n=a.buildparameters.map((function(e){return console.log(e),"ChooseOne"===e.parameter_type?Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):"Boolean"===e.parameter_type?Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:"true"===e.default_value.toLowerCase()}):Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(t)},children:w.payloadtype.map((function(e){return Object(g.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(g.jsx)("br",{}),Object(g.jsx)(ja,{onChange:function(e,t,a){var n=f.map((function(n){return n.name===e?Object(_.a)(Object(_.a)({},n),{},{value:t,error:a}):Object(_.a)({},n)}));O(n)},buildParameters:f}),Object(g.jsx)(la,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=f.map((function(e){return{name:e.name,value:e.value}}));e.finished({payload_type:n,parameters:t,file_extension:o,supports_dynamic_loading:j,os:e.buildOptions})}})]})}function ha(e){var t=Object(ee.a)();return Object(g.jsx)(Y.a,{fullWidth:!1,maxWidth:"sm",open:e.open,onClose:function(){e.onClose()},innerDialog:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{children:e.title?e.title:"Are you sure?"}),void 0===e.dialogText?null:Object(g.jsx)(G.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:Object(g.jsx)(V.a,{children:e.dialogText})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:e.cancelText?e.cancelText:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit(),e.onClose()},autoFocus:!0,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:e.acceptText?e.acceptText:"Remove"})]})]})})}var fa,Oa=a(553),ga=a(377),xa=a(866),ya=a(558),_a=a(875),va=a(864),ka=a(865),wa=Object(Se.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}})),Ca=Object(be.a)(fa||(fa=Object(v.a)(["\nquery getCommands($payloadType: String!) {\n  command(where: {payloadtype: {ptype: {_eq: $payloadType}}, deleted: {_eq: false}}, order_by: {cmd: asc}) {\n    cmd\n    attributes\n    id\n    supported_ui_features\n    help_cmd\n    description\n    needs_admin\n  }\n}\n "])));function Sa(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(je.a)(Ca,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type},onCompleted:function(){if(e.buildOptions.supports_dynamic_loading){var t=m.command.reduce((function(t,a){try{var n=JSON.parse(a.attributes);if(0===n.supported_os.length||n.supported_os.includes(e.buildOptions.os)){if(void 0!==n.builtin&&n.builtin)return[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},a),{},{disabled:!0,selected:!0,reason:"This command is builtin and must be included"})]);try{if(void 0!==n.load_only&&n.load_only)return[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},a),{},{disabled:!0,selected:!1,reason:"This command can only be loaded in once a callback is established"})]);var i=!0,r={};if(void 0!==n.filter_by_build_parameter)for(var c=0,o=Object.entries(n.filter_by_build_parameter);c<o.length;c++)for(var s=Object(u.a)(o[c],2),l=s[0],d=s[1],b=0;b<e.buildOptions.parameters.length;b++)e.buildOptions.parameters[b].name===l&&e.buildOptions.parameters[b].value!==d&&(i=!1,r.name=l,r.value=d);return i?void 0!==n.suggested_command&&n.suggested_command?[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},a),{},{disabled:!1,selected:!0,reason:"This command is suggested to be included"})]):[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},a),{},{disabled:!1,selected:!1,reason:""})]):[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},a),{},{disabled:!0,selected:!1,reason:'Not available when build option "'+r.name+'" is not "'+r.value+'"'})])}catch(j){console.error(j)}}return[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},a),{},{disabled:!0,selected:!1,reason:"This command isn't supported by the selected OS"})])}catch(j){return[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},a),{},{disabled:!1,selected:!1,reason:"Failed to parse command attributes"})])}}),[]);if(l(t),void 0!==e.prevData){var a=t.map((function(t){return e.prevData.includes(t.cmd)?Object(_.a)(Object(_.a)({},t),{},{selected:!0}):Object(_.a)(Object(_.a)({},t),{},{selected:!1})}));l(a)}}else{var n=m.command.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{selected:!0,disabled:!0,reason:"Agent doesn't support dynamic loading"})}));l(n)}}}).data;return Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Build Commands Into Agent"})," ",Object(g.jsx)("br",{}),Object(g.jsx)(Da,{commands:o,payload_type:e.buildOptions.payload_type,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){for(var a=!1,n=0;n<t.length;n++)if(t[n].supported_ui_features.includes("callback_table:exit")){a=!0;break}if(a){var r=t.map((function(e){return e.cmd}));e.finished(r)}else p(!0),i(t)}}),Object(g.jsx)(ha,{open:j,title:"No exit command selected, continue?",onClose:function(){return p(!1)},acceptText:"Accept",onSubmit:function(){var t=n.map((function(e){return e.cmd}));e.finished(t)}})]})}function Da(e){var t=wa(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=D(i,d),x=D(i,h),v=s.a.useState({}),k=Object(u.a)(v,2),w=k[0],C=k[1];function S(e,t){return e.filter((function(e){return void 0===t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}function D(e,t){return e.filter((function(e){return void 0!==t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}var I=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(y.a)(i);-1===a?n.push(t):n.splice(a,1),r(n)}};Object(o.useEffect)((function(){var t=e.commands.reduce((function(e,t){return t.selected?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(_.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.selected?[].concat(Object(y.a)(e),[Object(_.a)({},t)]):Object(y.a)(e)}),[]);j(t),f(a)}),[e.commands]);var $=function(t){var a=e.commands.filter((function(e){return e.cmd===t.target.innerText}));a.length>0&&C(a[0])},P=function(e,a){return Object(g.jsxs)(T.a,{className:t.paper,style:{width:"100%",height:"calc(40vh)",overflow:"auto"},elevation:5,children:[Object(g.jsx)(va.a,{className:t.cardHeader,title:e}),Object(g.jsx)(ka.a,{classes:{root:t.divider}}),Object(g.jsxs)(Oa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[a.map((function(e){var t=e.cmd,a="transfer-list-item-".concat(t,"-label");return Object(g.jsx)("div",{onMouseEnter:$,children:Object(g.jsxs)(ga.a,{style:{padding:0},disabled:e.disabled,role:"listitem",button:!0,onClick:I(e),children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(_a.a,{disabled:e.disabled,checked:-1!==i.findIndex((function(e){return e.cmd===t})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":a}})}),Object(g.jsx)(ya.a,{id:a,primary:t})]},t)},"commandtransfer"+t)})),Object(g.jsx)(ga.a,{})]})]})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(g.jsx)(ft.a,{item:!0,xs:5,children:P("Available Commands",d)}),Object(g.jsx)(ft.a,{item:!0,children:Object(g.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&!t.selected?[].concat(Object(y.a)(e),[Object(_.a)({},t)]):Object(y.a)(e)}),[]),a=e.commands.reduce((function(e,t){return!t.disabled||t.selected?[].concat(Object(y.a)(e),[Object(_.a)({},t)]):Object(y.a)(e)}),[]);j(t),f(a)},disabled:0===d.length,"aria-label":"move all right",children:"\u226b"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(O)),j(S(d,O)),r(S(i,O))},disabled:0===O.length,"aria-label":"move selected right",children:">"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(x)),f(S(h,x)),r(S(i,x))},disabled:0===x.length,"aria-label":"move selected left",children:"<"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&t.selected?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(_.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.disabled&&t.selected?[].concat(Object(y.a)(e),[Object(_.a)({},t)]):Object(y.a)(e)}),[]);j(t),f(a)},disabled:0===h.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(g.jsx)(ft.a,{item:!0,xs:5,children:P("Commands Included",h)})]}),Object(g.jsx)(ft.a,{container:!0,justify:"center",alignItems:"flex-start",className:t.root,children:Object(g.jsx)(ft.a,{item:!0,xs:12,style:{height:"100%",marginBottom:"10px"},children:void 0!==w.cmd&&Object(g.jsxs)(T.a,{className:t.paper,style:{width:"100%"},elevation:5,children:[Object(g.jsx)(va.a,{className:t.cardHeader,title:Object(g.jsxs)(s.a.Fragment,{children:[w.cmd,Object(g.jsx)(b.a,{variant:"contained",color:"primary",href:"/docs/agents/"+e.payload_type+"/commands/"+w.cmd,style:{marginLeft:"10px",float:"right"},target:"_blank",children:"Documentation"})]})}),Object(g.jsx)(ka.a,{classes:{root:t.divider}}),""!==w.reason?Object(g.jsxs)(L.a,{variant:"body1",align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsxs)("b",{children:[w.disabled?"Disabled Reason: ":"Information: "," "]}),w.reason]}):null,Object(g.jsx)("br",{}),Object(g.jsxs)(L.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsx)("b",{children:"Commandline Help: "}),w.help_cmd]}),Object(g.jsxs)(L.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsx)("b",{children:"Needs Admin Permissions: "}),w.needs_admin?"True":"False"]}),Object(g.jsxs)(L.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsx)("b",{children:"Description: "}),w.description]})]})})}),Object(g.jsx)(la,{first:e.first,last:e.last,canceled:e.canceled,finished:function(){e.finished(h)}})]})}var Ia,Ta,$a=a(928),Pa=Object(be.a)(Ia||(Ia=Object(v.a)(["\nquery getPayloadTypesC2ProfilesQuery($payloadType: String!, $operation_id: Int!) {\n  c2profile(where: {payloadtypec2profiles: {payloadtype: {ptype: {_eq: $payloadType}}}, deleted: {_eq: false}}) {\n    name\n    is_p2p\n    description\n    id\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n        instance_name\n    }\n  }\n}\n "]))),Aa=Object(be.a)(Ta||(Ta=Object(v.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n      c2profile {\n          name\n      }\n    }\n    id\n    value\n  }\n}\n"])));function Ea(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1],b=Object(je.a)(Pa,{variables:{payloadType:e.buildOptions.payload_type,operation_id:t.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.map((function(t){if(void 0!==e.prevData){console.log(e.prevData);for(var a=0;a<e.prevData.length;a++)if(e.prevData[a].name===t.name){var n=e.prevData[a].c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=JSON.parse(e.default_value),a=e.value.map((function(e){var a=t.find((function(t){return t.name===e.name}));return void 0!==a?Object(_.a)(Object(_.a)(Object(_.a)({},a),e),{},{default_show:""!==e.value}):Object(_.a)(Object(_.a)({},e),{},{default_show:!1})})),n=t.reduce((function(e,t){return e.findIndex((function(e){return e.name===t.name}))>-1?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{default_show:!1,key:"*"===t.name?"":t.name,value:t.default_value})])}),Object(y.a)(a));return Object(_.a)(Object(_.a)({},e),{},{value:n})}return e}));return n.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(_.a)(Object(_.a)({},t),{},{selected:e.prevData[a].selected,c2profileparameters:n})}}var i=t.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Pt(e.format_string).gen();return Object(_.a)(Object(_.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(_.a)(Object(_.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name,default_show:t.default_show})])}),[]);return Object(_.a)(Object(_.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return""!==e.default_value&&n.setDate(n.getDate()+parseInt(e.default_value)),Object(_.a)(Object(_.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(_.a)(Object(_.a)({},e),{},{value:e.default_value})}return Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value})}));return i.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(_.a)(Object(_.a)({},t),{},{selected:!1,c2profileparameters:i})}));a.sort((function(e,t){return-t.name.localeCompare(e.name)})),r(a)},fetchPolicy:"no-cache"}),j=b.loading,p=b.error,m=function(e,t,a,n){var c=i.map((function(i){if(i.name===e){var r=i.c2profileparameters.map((function(e){return e.name===t?Object(_.a)(Object(_.a)({},e),{},{error:n,value:a}):e}));return Object(_.a)(Object(_.a)({},i),{},{c2profileparameters:r})}return i}));r(c)},x=Object(pt.a)(Aa,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(_.a)(Object(_.a)({},e),e.c2profileparameter);return"Dictionary"!==t.parameter_type&&"Array"!==t.parameter_type||(t.value=JSON.parse(t.value)),t}));t.sort((function(e,t){return e.name<t.name?-1:1}));var a=i.map((function(e){return t[0].c2profile.name===e.name?Object(_.a)(Object(_.a)({},e),{},{c2profileparameters:t}):e}));r(a)},onError:function(e){O.b.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),v=Object(u.a)(x,1)[0];return j?Object(g.jsx)("div",{children:Object(g.jsx)(oa.a,{})}):p?(console.error(p),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Select C2 Profiles"}),i.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)($a.a,{value:"top",control:Object(g.jsx)($.a,{checked:e.selected,onChange:function(t){return function(e,t){var a=i.map((function(e){return t.name===e.name?Object(_.a)(Object(_.a)({},e),{},{selected:!e.selected}):e}));r(a)}(0,e)},inputProps:{"aria-label":"primary checkbox"},name:"active"}),label:e.name,labelPlacement:"top",style:{display:"inline"}}),e.c2profileparametersinstances.length>0&&e.selected?Object(g.jsxs)(mt.a,{style:{width:"100%"},children:[Object(g.jsx)($t.a,{children:"Select an Existing Instance"}),Object(g.jsxs)(ht.a,{style:{width:"100%",marginBottom:"10px"},value:l,label:"Select an Existing Instance",onChange:function(a){return function(e,a){if(d(e.target.value),""!==e.target.value){var n=i.map((function(e){return a.name===e.name&&(e.c2profileparameters=[]),e}));r(n),v({variables:{name:e.target.value,operation_id:t.user.current_operation_id}})}}(a,e)},children:[Object(g.jsx)(tt.a,{value:"",children:"New Instance"}),e.c2profileparametersinstances.map((function(e,t){return Object(g.jsx)(tt.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]}):null,Object(g.jsx)(L.a,{variant:"body1",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:e.description},"step4desc"+e.id),e.selected?Object(g.jsx)(Ct,Object(_.a)(Object(_.a)({returnAllDictValues:!1},e),{},{onChange:m}),"step4table"+e.id):null]},"step4c2switch"+e.id)})),Object(g.jsx)("br",{}),Object(g.jsx)(la,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=!0,a=!1,n=i.reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=e.value.filter((function(e){return""!==e.value}));return Object(_.a)(Object(_.a)({},e),{},{value:t})}return Object(_.a)({},e)}));return[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{c2profileparameters:a})])}return[].concat(Object(y.a)(e),[Object(_.a)({},t)])}),[]);if(i.forEach((function(e){e.selected&&(a=!0,e.c2profileparameters.forEach((function(a){a.error&&(O.b.warning(e.name+"'s parameter "+a.name+" is invalid"),t=!1)})))})),t){if(!a)return void O.b.warning("Must select at least one C2 to include");e.finished(n)}}}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{})]})}var La,Fa,qa=a(87),Na=a(8),Ra=a(929),Ba=a(141),za=a.n(Ba),Wa=a(94),Ma=a.n(Wa),Ha=a(97),Ua=a.n(Ha),Ga=Object(be.a)(La||(La=Object(v.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),Va=Object(Se.a)((function(e){return{root:Object(jt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),Ka=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=Va(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)(qa.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ie.a,{style:{backgroundColor:a.palette.success.main},children:[Object(g.jsxs)(Ra.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(L.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(E.a,{"aria-label":"Show more",className:Object(Na.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(Ma.a,{})}),Object(g.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(za.a,{})})]})]}),Object(g.jsxs)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:[Object(g.jsxs)(T.a,{className:n.collapse,children:[Object(g.jsx)(L.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(g.jsxs)(b.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(g.jsx)(Ua.a,{className:n.checkIcon}),"Download now"]})]}),Object(g.jsx)(T.a,{className:n.collapse,children:Object(g.jsx)(b.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),Qa=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=Va(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!1),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)(qa.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ie.a,{style:{backgroundColor:a.palette.error.main},children:[Object(g.jsxs)(Ra.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(L.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(E.a,{"aria-label":"Show more",className:Object(Na.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(Ma.a,{})}),Object(g.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(za.a,{})})]})]}),Object(g.jsx)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(g.jsx)(T.a,{className:n.collapse,children:e.display})})]})})}));function Ja(e){var t=s.a.useState((new Date).toISOString()),a=Object(u.a)(t,2),n=a[0],i=(a[1],Object(ze.a)(Ga,{variables:{fromNow:n}})),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){console.log(l),!r&&!c&&l&&l.payload.length>0?"success"===l.payload[0].build_phase?(O.b.dismiss(),O.b.success(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(Ka,{id:e,file_id:l.payload[0].filemetum.agent_file_id})}})):"building"===l.payload[0].build_phase||(""!==l.payload[0].build_stderr?O.b.error(l.payload[0].build_stderr,{persist:!0,content:function(e){return Object(g.jsx)(Qa,{id:e,display:l.payload[0].build_stderr})}}):O.b.error(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(Qa,{id:e,display:l.payload[0].build_message})}})):c&&(console.log(c),O.b.error("Mythic encountered an error: "+c.toString()))}),[r,l,c]),null}var Ya,Za=Object(be.a)(Fa||(Fa=Object(v.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function Xa(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(pe.a)(Za,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?O.b.info("Submitted payload to build pipeline"):O.b.error(a.createPayload.error)}}),p=Object(u.a)(b,1)[0];Object(o.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);return Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(g.jsx)("br",{}),Object(g.jsx)(j.a,{required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(g.jsx)(j.a,{required:!1,placeholder:"description",value:l,multiline:!1,onChange:function(e,t,a){d(t)},display:"inline-block"}),Object(g.jsx)(la,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a=e.buildOptions[3].reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.reduce((function(e,t){if("Dictionary"===t.parameter_type){var a=t.value.map((function(e){return{name:e.name,key:e.key,value:e.value,custom:e.custom}}));return Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.name,a))}return Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.name,t.value))}),{});return[].concat(Object(y.a)(e),[{c2_profile:t.name,c2_profile_parameters:a}])}return e}),[]),i={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:l,commands:e.buildOptions[2],build_parameters:t,c2_profiles:a};p({variables:{payload:JSON.stringify(i)}}).catch((function(e){console.log(e)}))}}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(Ja,{})]})}function en(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=function(e){i(Object(_.a)(Object(_.a)({},n),{},Object(jt.a)({},o,e))),p()},b=function(){m()},j=["Select Target OS","Payload Type","Select Commands","Select C2 Profiles","Build"],p=function(){l((function(e){return e+1}))},m=function(){l((function(e){return e-1}))};return Object(g.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(g.jsx)(ia.a,{activeStep:o,alternativeLabel:!0,children:j.map((function(e,t){return Object(g.jsx)(ra.a,{children:Object(g.jsx)(ca.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(g.jsx)(ba,{buildOptions:n,prevData:n[0],finished:d,canceled:b,first:!0,last:!1});case 1:return Object(g.jsx)(ma,{buildOptions:n[0],prevData:n[1],finished:d,canceled:b,first:!1,last:!1});case 2:return Object(g.jsx)(Sa,{buildOptions:n[1],prevData:n[2],finished:d,canceled:b,first:!1,last:!1});case 3:return Object(g.jsx)(Ea,{buildOptions:n[1],prevData:n[3],finished:d,canceled:b,first:!1,last:!1});case 4:return Object(g.jsx)(Xa,{buildOptions:n,canceled:b,first:!1,last:!0});default:return"Unknown step"}}(o)]})}function tn(e){return Object(g.jsxs)("div",{children:[Object(g.jsx)(b.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",onClick:e.finished,disabled:e.disableNext,children:e.last?"Create Payload":"Next"})]})}var an,nn=Object(be.a)(Ya||(Ya=Object(v.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    id\n    supported_os\n  }\n}\n "])));function rn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];if(Object(je.a)(nn,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(y.a)(t),[a])}),[]);return[].concat(Object(y.a)(e),Object(y.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),l(a),0===a.length&&O.b.warning("No Wrappers exist within Mythic. Try importing one first via the mythic-cli binary")},onError:function(e){console.error(e)}}).loading)return Object(g.jsx)("div",{children:Object(g.jsx)(oa.a,{})});return Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(g.jsx)("br",{}),Object(g.jsxs)(mt.a,{children:[Object(g.jsx)(ht.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(g.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(g.jsx)(sa.a,{children:"Target Operating System"})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(tn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){0!==o.length?e.finished(n):O.b.warning("No Wrappers exist within Mythic. Try importing one first via the mythic-cli binary")}})]})}function cn(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,r=e.required,c=e.verifier_regex,l=e.id,d=e.description,p=e.value,m=e.returnAllDictValues,h=s.a.useState(""),f=Object(u.a)(h,2),O=f[0],x=f[1],v=Object(ee.a)(),k=s.a.useState([]),w=Object(u.a)(k,2),S=w[0],D=w[1],T=s.a.useState([]),$=Object(u.a)(T,2),P=$[0],A=$[1],F=s.a.useState([]),q=Object(u.a)(F,2),N=q[0],R=q[1],B=s.a.useState(""),W=Object(u.a)(B,2),M=W[0],H=W[1],U=s.a.useState([]),G=Object(u.a)(U,2),V=G[0],K=G[1],Q=s.a.useState(new Date),J=Object(u.a)(Q,2),Y=J[0],Z=J[1],X=function(e){var a=e.map((function(e){return m?{custom:"*"===e.name,key:e.key,name:e.name,value:e.value}:Object(jt.a)({},e.key,e.value)}));t(i,a,!1)};Object(o.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");x(e[0]),K(e)}""!==p&&void 0!==p&&(x(p),t(i,p,""))}else if("Date"===a){if(""!==n){var r=new Date;r.setDate(r.getDate()+parseInt(n)),re(r),x(-1)}""!==p&&void 0!==p&&p.includes("-")&&(console.log("passed date value: ",p),Z(new Date(p)),x(-1),t(i,new Date(p).toISOString().slice(0,10),""))}else if("Dictionary"===a){var c=JSON.parse(n);A(c);var o=c.reduce((function(e,t){return t.default_show?[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);X(o),D(o);var s=c.reduce((function(e,t){var a=o.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);R(s),s.length>0&&H(s[0]),""!==p&&void 0!==p&&"object"===typeof p&&(D(p),X(p))}else void 0!==n&&x(n),""!==p&&void 0!==p&&(x(p),t(i,p,""))}),[n,a,i]);var te=function(e){x(e.target.value),t(i,e.target.value,!1)},ae=function(e,a,n){x(a),t(e,a,n)},ne=function(e){return(r&&""!==c||""!==c&&""!==e)&&!RegExp(c).test(e)},ie=function(){var e=M;D([].concat(Object(y.a)(S),[e]));var t=N.reduce((function(t,a){var n=S.reduce((function(e,t){return t.name===a.name?e+1:e}),0);return e.name===a.name&&(n+=1),-1===a.max||a.max>n?[].concat(Object(y.a)(t),[Object(_.a)({},a)]):Object(y.a)(t)}),[]);X(t),R(t),t.length>0&&H(t[0])},re=function(e){Z(e),t(i,e.toISOString().slice(0,10),"")},ce=s.a.useState(null),oe=Object(u.a)(ce,2),se=oe[0],le=oe[1],de=Boolean(se),ue=function(){le(null)};return Object(g.jsxs)(I.a,{children:[Object(g.jsxs)(C.a,{children:[Object(g.jsx)(L.a,{"aria-haspopup":"true",onMouseEnter:function(e){le(e.currentTarget)},onMouseLeave:ue,"aria-owns":de?"taskparam"+l+"popover":void 0,children:d}),Object(g.jsx)(kt.a,{id:"taskparam"+l+"popover",open:de,anchorEl:se,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:ue,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===v.palette.type?v.palette.primary.dark:v.palette.primary.light,color:"white"},variant:"outlined"},children:Object(g.jsx)(L.a,{children:i.length>0?i:"No Description"})})]}),Object(g.jsx)(C.a,{children:function(){switch(a){case"Date":return Object(g.jsx)(yt.a,{utils:vt.a,children:Object(g.jsx)(ft.a,{container:!0,justify:"flex-start",children:Object(g.jsx)(_t.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:Y,onChange:re,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(g.jsx)(mt.a,{children:Object(g.jsx)(ht.a,{native:!0,value:O,onChange:te,children:V.map((function(e,t){return Object(g.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(g.jsxs)(s.a.Fragment,{children:[S.map((function(e,t){return Object(g.jsxs)("div",{children:[Object(g.jsxs)(E.a,{onClick:function(e){!function(e){var t=S[e],a=S.filter((function(t,a){return e!==a}));D(a);var n=P.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},n),{},{value:n.default_value,key:"*"===n.name?"":n.name})]):Object(y.a)(e)}),[]);X(n),R(n),n.length>0&&H(n[0])}(t)},children:[Object(g.jsx)(z.a,{style:{color:v.palette.error.main}})," "]}),"*"===e.name?Object(g.jsx)(Ot.a,{style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=S.map((function(a,n){return n===t?Object(_.a)(Object(_.a)({},a),{},{key:e.target.value}):Object(_.a)({},a)}));X(a),D(a)}(e,t)}}):Object(g.jsx)(Ot.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"key"}),value:e.key}),Object(g.jsx)(Ot.a,{style:{width:"75%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=S.map((function(a,n){return n===t?Object(_.a)(Object(_.a)({},a),{},{value:e.target.value}):Object(_.a)({},a)}));X(a),D(a)}(e,t)}})]},"dictval"+t)})),N.length>0?Object(g.jsxs)("div",{children:[Object(g.jsxs)(E.a,{onClick:ie,children:[" ",Object(g.jsx)(xt.a,{style:{color:v.palette.success.main}})," "]}),Object(g.jsx)(ht.a,{size:"small",value:M,onChange:function(e){return H(e.target.value)},children:N.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+"i")}))})]}):null]});case"String":return Object(g.jsx)(j.a,{required:r,value:O,multiline:!0,onChange:ae,display:"inline-block",name:i,validate:ne,errorText:"Must match: "+c});default:return null}}()})]},"buildparam"+l)}function on(e){return Object(g.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(g.jsx)(L.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Build Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{children:e.buildParameters.map((function(t){return Object(g.jsx)(cn,Object(_.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var sn,ln=Object(be.a)(an||(an=Object(v.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function dn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],x=h[1],v=Object(je.a)(ln,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){i(e.prevData.payload_type),l(e.prevData.payload_type_id),p(e.prevData.file_extension);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(_.a)(Object(_.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(a),0===a.length&&O.b.warning("No available payload types exist for the selected OS")}else{i(t.payloadtype[0].ptype),l(t.payloadtype[0].id),p(t.payloadtype[0].file_extension);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(e),Object(y.a)(n))}return Object(y.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(n)}}}),k=v.loading,w=v.error,C=v.data;return k?Object(g.jsx)("div",{children:Object(g.jsx)(oa.a,{})}):w?(console.error(w),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(g.jsx)(ht.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=C.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){p(a.file_extension),l(a.id);var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(_.a)(Object(_.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),x(t)},children:C.payloadtype.map((function(e){return Object(g.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(g.jsx)("br",{}),Object(g.jsx)(on,{onChange:function(e,t,a){var n=f.map((function(n){return n.name===e?Object(_.a)(Object(_.a)({},n),{},{value:t,error:a}):Object(_.a)({},n)}));x(n)},buildParameters:f}),Object(g.jsx)(tn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=f.map((function(e){return{name:e.name,value:e.value}}));""!==n?e.finished({payload_type:n,parameters:t,payload_type_id:o,file_extension:j,os:e.buildOptions}):O.b.warning("No payload type selected")}})]})}var un=Object(be.a)(sn||(sn=Object(v.a)(["\nquery GetPayloadDetails($payload_id: Int!, $operation_id: Int!) {\n  payload(where: {id: {_eq: $payload_id}, operation_id: {_eq: $operation_id}}) {\n    uuid\n    wrapped_payload_id\n    payloadtype{\n        ptype\n    }\n    payloadcommands {\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    filemetum {\n      filename_text\n      agent_file_id\n      id\n      md5\n      sha1\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        description\n      }\n    }\n    os\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n  }\n}\n"])));function bn(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Payload Configuration"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(jn,Object(_.a)({},e))}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function jn(e){var t=Object(f.a)(h.b),a=Object(ee.a)(),n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState([]),l=Object(u.a)(o,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),O=m[0],x=m[1],v=Object(je.a)(un,{variables:{payload_id:e.payload_id,operation_id:t.user.current_operation_id},onCompleted:function(e){var t=e.payload[0].payloadcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));c(t);var a=e.payload[0].buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));j(a);var n=e.payload[0].c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.c2profile.name,[].concat(Object(y.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),i=Object.keys(n).reduce((function(e,t){return[].concat(Object(y.a)(e),[{c2_profile:t,parameters:n[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);x(i)}}),S=v.loading,$=v.error,P=v.data;return S?Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}}):$?(console.error($),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Payload Information"})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Payload Info"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsxs)(w.a,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Payload Type"}),Object(g.jsx)(C.a,{children:P.payload[0].payloadtype.ptype})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Selected OS"}),Object(g.jsx)(C.a,{children:P.payload[0].os})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"UUID"}),Object(g.jsx)(C.a,{children:P.payload[0].uuid})]}),P.payload[0].filemetum?Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Filename"}),Object(g.jsx)(C.a,{children:P.payload[0].filemetum.filename_text})]},"filename_text"):null,Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Download URL"}),Object(g.jsx)(C.a,{children:window.location.origin+"/direct/download/"+P.payload[0].filemetum.agent_file_id})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"SHA1"}),Object(g.jsx)(C.a,{children:P.payload[0].filemetum.sha1})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"MD5"}),Object(g.jsx)(C.a,{children:P.payload[0].filemetum.md5})]})]})]}),Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Build Parameters"})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{children:d.map((function(t,a){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:t.description}),Object(g.jsx)(C.a,{children:t.value})]},"buildprop"+a+"for"+e.payload_id)}))})]}),O.map((function(t){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:t.c2_profile})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{style:{whiteSpace:"pre"},children:t.parameters.map((function(a,n){return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:a.description}),Object(g.jsxs)(C.a,{children:["Dictionary"===a.parameter_type?JSON.stringify(JSON.parse(a.value),null,2):a.value,null===a.enc_key?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Encryption Key: "})," ",a.enc_key]}),null===a.dec_key?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Decryption Key: "})," ",a.dec_key]})]})]},"c2frag"+e.payload_id+t.c2_profile+n)}))})]})]},"c2frag"+e.payload_id+t.c2_profile)})),r.length>0&&Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Loaded Commands"})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Command Name"}),Object(g.jsx)(C.a,{children:"Mythic Version"}),Object(g.jsx)(C.a,{children:"Loaded Version"}),Object(g.jsx)(C.a,{children:"Documentation"})]})}),Object(g.jsx)(w.a,{children:r.map((function(t){return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:t.cmd}),Object(g.jsx)(C.a,{children:t.mythic}),Object(g.jsx)(C.a,{children:t.payload}),Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+P.payload[0].payloadtype.ptype+"/commands/"+t.cmd,children:"Docs"})})]},t.cmd+e.payload_id)}))})]})]}),null!==P.payload[0].wrapped_payload_id&&Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Wrapped Payload Information"})}),Object(g.jsx)(jn,{payload_id:P.payload[0].wrapped_payload_id})]})]})}var pn,mn,hn=a(205),fn=a.n(hn),On=Object(Se.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}})),gn=Object(be.a)(pn||(pn=Object(v.a)(['\nquery getWrappablePayloads($payloadType: Int!) {\n  payloadtype_by_pk(id: $payloadType) {\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n        payloads(where: {auto_generated: {_eq: false}, build_phase: {_eq: "success"}, deleted: {_eq: false}}) {\n          id\n          tag\n          uuid\n          creation_time\n          filemetum {\n            agent_file_id\n            filename_text\n            id\n          }\n        }\n      }\n    }\n  }\n}\n '])));function xn(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(gn,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type_id},onCompleted:function(){if(r.payloadtype_by_pk.wrap_these_payload_types.length>0){for(var e=[],t=0;t<r.payloadtype_by_pk.wrap_these_payload_types.length;t++)for(var a=0;a<r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads.length;a++)e.push(Object(_.a)({ptype:r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.ptype},r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads[a]));i(e)}else O.b.warning("No supported payload for that wrapper")}}).data;return Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Wrap Agent Into New Payload"})," ",Object(g.jsx)("br",{}),Object(g.jsx)(yn,{payloadOptions:n,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){void 0!==t.uuid?e.finished(t.uuid):O.b.error("Can't continue without selecting a payload")}})]})}function yn(e){On();var t=function(t){e.finished(t)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(S.a,{component:T.a,children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"4rem"},children:" Select"}),Object(g.jsx)(C.a,{style:{width:"15rem"},children:"Timestamp"}),Object(g.jsx)(C.a,{children:"File"}),Object(g.jsx)(C.a,{children:"Description"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Details"})]})}),Object(g.jsx)(w.a,{children:e.payloadOptions.map((function(e){return Object(g.jsx)(_n,{onSelected:t,payload:e},"payload"+e.id)}))})]})}),Object(g.jsx)("div",{style:{paddingTop:"20px"},children:Object(g.jsx)(tn,{disableNext:!0,first:e.first,last:e.last,canceled:e.canceled,finished:t})})]})}function _n(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(f.a)(h.b);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{size:"small",onClick:function(){e.onSelected(e.payload)},color:"primary",variant:"contained",children:"Select"})}),Object(g.jsx)(C.a,{children:Object(Z.b)(e.payload.creation_time,r.user.view_utc_time)}),Object(g.jsx)(C.a,{children:e.payload.filemetum.filename_text}),Object(g.jsx)(C.a,{children:e.payload.tag}),Object(g.jsx)(C.a,{children:Object(g.jsx)(E.a,{size:"small",color:"primary",onClick:function(){return i(!0)},children:Object(g.jsx)(fn.a,{})})})]},"payload"+e.payload.uuid),Object(g.jsx)(I.a,{children:n?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(g.jsx)(bn,Object(_.a)(Object(_.a)({},e),{},{payload_id:e.payload.id,onClose:function(){i(!1)}}))}):null})]})}var vn,kn=Object(be.a)(mn||(mn=Object(v.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),wn=Object(Se.a)((function(e){return{root:Object(jt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),Cn=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=wn(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)(qa.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ie.a,{style:{backgroundColor:a.palette.success.main},children:[Object(g.jsxs)(Ra.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(L.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(E.a,{"aria-label":"Show more",className:Object(Na.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(Ma.a,{})}),Object(g.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(za.a,{})})]})]}),Object(g.jsxs)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:[Object(g.jsxs)(T.a,{className:n.collapse,children:[Object(g.jsx)(L.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(g.jsxs)(b.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(g.jsx)(Ua.a,{className:n.checkIcon}),"Download now"]})]}),Object(g.jsx)(T.a,{className:n.collapse,children:Object(g.jsx)(b.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),Sn=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=wn(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!1),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)(qa.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ie.a,{style:{backgroundColor:a.palette.error.main},children:[Object(g.jsxs)(Ra.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(L.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(E.a,{"aria-label":"Show more",className:Object(Na.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(Ma.a,{})}),Object(g.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(za.a,{})})]})]}),Object(g.jsx)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(g.jsx)(T.a,{className:n.collapse,children:e.display})})]})})}));function Dn(e){var t=s.a.useState((new Date).toISOString()),a=Object(u.a)(t,2),n=a[0],i=(a[1],Object(ze.a)(kn,{variables:{fromNow:n}})),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){!r&&!c&&l&&l.payload.length>0?"success"===l.payload[0].build_phase?(O.b.dismiss(),O.b.success(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(Cn,{id:e,file_id:l.payload[0].filemetum.agent_file_id})}})):"building"===l.payload[0].build_phase?O.b.info("Building payload ".concat(l.payload[0].uuid,"..."),{autoHideDuration:5e3}):""!==l.payload[0].build_error?O.b.error(l.payload[0].build_stderr,{persist:!0,content:function(e){return Object(g.jsx)(Sn,{id:e,display:l.payload[0].build_stderr})}}):O.b.error(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(Sn,{id:e,display:l.payload[0].build_message})}}):c&&(console.log(c),O.b.error("Mythic encountered an error: "+c.toString()))}),[r,l,c]),null}var In=Object(be.a)(vn||(vn=Object(v.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function Tn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(pe.a)(In,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?O.b.info("Submitted payload to build pipeline"):O.b.error(a.createPayload.error)}}),p=Object(u.a)(b,1)[0];Object(o.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);return Object(g.jsxs)("div",{children:[Object(g.jsx)(L.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(g.jsx)("br",{}),Object(g.jsx)(j.a,{required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(g.jsx)(j.a,{required:!1,placeholder:"description",value:l,multiline:!1,onChange:function(e,t,a){d(t)},display:"inline-block"}),Object(g.jsx)(tn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:l,commands:[],build_parameters:t,c2_profiles:[],wrapper:!0,wrapped_payload:e.buildOptions[2]};p({variables:{payload:JSON.stringify(a)}}).catch((function(e){console.log(e)}))}}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(Dn,{})]})}function $n(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=function(e){i(Object(_.a)(Object(_.a)({},n),{},Object(jt.a)({},o,e))),p()},b=function(){m()},j=["Select Target OS","Payload Type","Select Payload","Build"],p=function(){l((function(e){return e+1}))},m=function(){l((function(e){return e-1}))};return Object(g.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(g.jsx)(ia.a,{activeStep:o,alternativeLabel:!0,children:j.map((function(e,t){return Object(g.jsx)(ra.a,{children:Object(g.jsx)(ca.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(g.jsx)(rn,{buildOptions:n,prevData:n[0],finished:d,canceled:b,first:!0,last:!1});case 1:return Object(g.jsx)(dn,{buildOptions:n[0],prevData:n[1],finished:d,canceled:b,first:!1,last:!1});case 2:return Object(g.jsx)(xn,{buildOptions:n[1],prevData:n[2],finished:d,canceled:b,first:!1,last:!1});case 3:return Object(g.jsx)(Tn,{buildOptions:n,canceled:b,first:!1,last:!0});default:return"Unknown step"}}(o)]})}var Pn=a(932),An=a(946),En=a(485),Ln=a.n(En),Fn=a(479),qn=a(931);function Nn(e){var t=s.a.useState(null),a=Object(u.a)(t,2),n=a[0],i=a[1],r=function(){c(),e.onUpdateResolution({id:e.id,resolved:!e.resolved})},c=function(){i(null)},o=s.a.useCallback((function(e){i(e.currentTarget)}),[]);return Object(g.jsxs)(qn.a,{children:[Object(g.jsx)(E.a,{"aria-controls":"eventmenu"+e.id,"aria-haspopup":"true",onClick:o,children:Object(g.jsx)(Ln.a,{})}),Object(g.jsxs)(Fn.a,{elevation:5,id:"eventmenu"+e.id,anchorEl:n,open:Boolean(n),onClose:c,children:["warning"===e.level&&e.resolved?Object(g.jsx)(tt.a,{onClick:r,children:"Unresolve"}):"warning"!==e.level||e.resolved?Object(g.jsx)(tt.a,{onClick:function(){c(),e.onUpdateLevel({id:e.id})},children:"Make Warning"}):Object(g.jsx)(tt.a,{onClick:r,children:"Resolve"}),Object(g.jsx)(tt.a,{onClick:function(){c(),e.getSurroundingEvents({id:e.id})},children:"Get Surrounding Events"}),Object(g.jsxs)(tt.a,{onClick:function(){c(),e.onUpdateDeleted({id:e.id})},children:[Object(g.jsx)(z.a,{}),"Delete"]})]})]})}var Rn=Object(Se.a)((function(e){return{root:{width:"100%",maxWidth:"36ch"},inline:{display:"inline"}}}));function Bn(e){var t=Rn(),a=Object(ee.a)(),n=Object(f.a)(h.b);return Object(g.jsxs)(ga.a,{alignItems:"flex-start",style:Object(_.a)({},e.style),children:[Object(g.jsx)(Pn.a,{children:Object(g.jsx)(An.a,{children:e.operator?e.operator.username[0]:"M"})}),Object(g.jsx)(ya.a,{disableTypography:!0,primary:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(L.a,{component:"span",variant:"body1",className:t.inline,style:{fontWeight:"bold",margin:0,padding:0},children:[e.operator?e.operator.username:"Mythic",e.count>1?" ( "+e.count+" )":""]}),Object(g.jsx)(L.a,{component:"span",variant:"caption",className:t.inline,style:{margin:"0 0 0 10px"},children:Object(Z.b)(e.timestamp,n.user.view_utc_time)})]}),secondary:Object(g.jsx)("pre",{style:{overflowX:"auto",width:"max-content",maxWidth:"97%",margin:"0 0 0 0",borderRadius:"9px",padding:"5px",backgroundColor:"warning"===e.level&&e.resolved?a.palette.textBackgroundColorSuccess:"warning"!==e.level||e.resolved?e.operator?a.palette.textBackgroundColor:a.palette.textBackgroundColorMythic:a.palette.textBackgroundColorError},children:e.message}),style:{}}),Object(g.jsx)(Nn,{id:e.id,level:e.level,onUpdateDeleted:e.onUpdateDeleted,onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,getSurroundingEvents:e.getSurroundingEvents,resolved:e.resolved})]})}var zn=a(294),Wn=a.n(zn),Mn=a(849);function Hn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=function(t){t.preventDefault(),n&&n.length>0&&(e.onSubmitMessage(n),i(""))};return Object(g.jsx)("div",{style:{padding:"0",margin:"0",position:"absolute",bottom:0,width:"100%"},children:Object(g.jsx)("form",{onSubmit:r,children:Object(g.jsx)(Mn.a,{InputProps:{endAdornment:Object(g.jsx)(E.a,{color:"primary",variant:"contained",onClick:r,children:Object(g.jsx)(Wn.a,{})})},fullWidth:!0,size:"small",style:{padding:0,margin:0},variant:"outlined",value:n,onChange:function(e){e.preventDefault(),i(e.target.value)},label:"Type Message..."})})})}var Un,Gn,Vn,Kn,Qn,Jn,Yn,Zn,Xn,ei,ti=a(138),ai=a(165),ni=function(e){var t=e.data,a=e.index,n=e.style,i=t[t.length-a-1];return Object(g.jsx)("div",{style:n,children:Object(g.jsx)(Bn,Object(_.a)({},i))})},ii=function(e){var t=e.onUpdateDeleted,a=e.onUpdateLevel,n=e.onUpdateResolution,i=e.getSurroundingEvents,r=e.operationeventlog,c=s.a.createRef(),l=function(e){return 75+20*(r[r.length-e-1].message.match(/\n/g)||[]).length},d=r.map((function(e){return Object(_.a)({onUpdateDeleted:t,onUpdateLevel:a,onUpdateResolution:n,getSurroundingEvents:i},e)}));return Object(o.useEffect)((function(){c.current&&c.current.resetAfterIndex(0)}),[r]),Object(g.jsx)(ai.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(ti.c,{ref:c,height:t-50,itemData:d,itemCount:r.length,width:a,itemSize:l,overscanCount:20,children:ni})}})};function ri(e){var t=Object(o.useRef)(null),a=Object(ee.a)(),n=function(){t.current.scrollIntoView({behavior:"smooth"})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operational Event Messages"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.loadMore()},children:"Load More Events"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.loadNextError()},children:"Load All Errors"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.resolveViewableErrors()},children:"Resolve Viewable Errors"}),Object(g.jsx)(b.a,{variant:"contained",color:"secondary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.resolveAllErrors()},children:"Resolve All Errors"})]}),Object(g.jsxs)(T.a,{elevation:5,style:{position:"relative",height:"calc(90vh)",backgroundColor:a.body},variant:"elevation",children:[Object(g.jsx)(ii,{onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,onUpdateDeleted:e.onUpdateDeleted,getSurroundingEvents:e.getSurroundingEvents,operationeventlog:e.operationeventlog}),Object(g.jsx)("div",{ref:t}),Object(g.jsx)(Hn,{onSubmitMessage:function(t){t&&t.length>0&&(e.onSubmitMessage({level:"info",message:t}),n())}})]})]})}var ci=Object(be.a)(Un||(Un=Object(v.a)(["\nquery GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),oi=Object(be.a)(Gn||(Gn=Object(v.a)(["\nsubscription GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),si=Object(be.a)(Vn||(Vn=Object(v.a)(["\nquery GetSurroundingOperationEventLogs($operation_id: Int!, $lower_id: Int!, $upper_id: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, id: {_gt: $lower_id, _lt: $upper_id}}, order_by: {id: desc}) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),li=Object(be.a)(Kn||(Kn=Object(v.a)(["\nmutation CreateOperationEventLog($message: String!, $level: String!) {\n  insert_operationeventlog_one(object:{level: $level, message: $message}) {\n    id\n  }\n}\n "]))),di=Object(be.a)(Qn||(Qn=Object(v.a)(['\n query GetOperationEventLogError($operation_id: Int!) {\n   operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}}, order_by: {id: desc}) {\n     id\n     level\n     message\n     resolved\n     timestamp\n     count\n     operator {\n       id\n       username\n     }\n   }\n }\n  ']))),ui=Object(be.a)(Jn||(Jn=Object(v.a)(["\nmutation UpdateDeletedOperationEventLog($id: Int!) {\n  update_operationeventlog(where:{id: {_eq: $id}}, _set: {deleted: true}) {\n    returning{\n        id\n        deleted\n    }\n  }\n}\n "]))),bi=Object(be.a)(Yn||(Yn=Object(v.a)(["\nmutation UpdateResolutionOperationEventLog($id: Int!, $resolved: Boolean!) {\n  update_operationeventlog_by_pk(pk_columns:{id: $id}, _set: {resolved: $resolved}) {\n    id\n    resolved\n  }\n}\n "]))),ji=Object(be.a)(Zn||(Zn=Object(v.a)(['\nmutation UpdateLevelOperationEventLog($id: Int!) {\n  update_operationeventlog_by_pk(pk_columns: {id: $id}, _set: {level: "warning"}) {\n    id\n    level\n  }\n}\n ']))),pi=Object(be.a)(Xn||(Xn=Object(v.a)(["\n mutation UpdateResolveViewableErrorsOperationEventLog($ids: [Int]!) {\n   update_operationeventlog(where:{id: {_in: $ids}}, _set: {resolved: true}) {\n     returning{\n         id\n         resolved\n     }\n   }\n }\n  "]))),mi=Object(be.a)(ei||(ei=Object(v.a)(["\n  mutation UpdateResolveAllErrorsOperationEventLog($operation_id: Int!) {\n    update_operationeventlog(where: {resolved: {_eq: false}, operation_id: {_eq: $operation_id}}, _set: {resolved: true}) {\n      returning{\n          id\n          resolved\n      }\n    }\n  }\n   "])));function hi(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(0),o=Object(u.a)(c,2),l=o[0],d=o[1];Object(ze.a)(oi,{variables:{operation_id:t.user.current_operation_id,offset:0,eventQuerySize:100},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;0===l&&d(t.data.operationeventlog.length);var a=t.data.operationeventlog.reduce((function(e,t){if(e.find((function(e){return e.id===t.id}))){var a=e.findIndex((function(e){return e.id===t.id})),n=Object(y.a)(e);return n[a]=t,Object(y.a)(n)}return[].concat(Object(y.a)(e),[t])}),Object(y.a)(i));a.sort((function(e,t){return e.id>t.id?-1:t.id>e.id?1:0})),r(a)}});var b=Object(pt.a)(ci,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(O.b.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(y.a)(e):[].concat(Object(y.a)(e),[t])}),Object(y.a)(i));d(l+100),r(t),O.b.success("Successfully fetched more events")}else O.b.info("No more events")}}),j=Object(u.a)(b,1)[0],p=Object(pt.a)(si,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){O.b.dismiss();var t=!1,a=e.operationeventlog.reduce((function(e,a){return e.find((function(e){return e.id===a.id}))?Object(y.a)(e):(t=!0,[].concat(Object(y.a)(e),[a]))}),Object(y.a)(i));r(a),t?O.b.success("Successfully fetched surrounding events"):O.b.info("No additional surrounding events")}}),m=Object(u.a)(p,1)[0],x=Object(pt.a)(di,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(O.b.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(y.a)(e):[].concat(Object(y.a)(e),[t])}),Object(y.a)(i));r(t),O.b.success("Successfully fetched more errors")}else O.b.info("No more events")}}),v=Object(u.a)(x,1)[0],k=Object(pe.a)(li),w=Object(u.a)(k,1)[0],C=Object(pe.a)(ui,{update:function(e,t){var a=t.data.update_operationeventlog.returning[0],n=i.filter((function(e){return e.id!==a.id}));r(n),O.b.success("Successfully deleted event log")}}),S=Object(u.a)(C,1)[0],D=Object(pe.a)(bi,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(_.a)(Object(_.a)({},e),{},{resolved:a.resolved}):e}));r(n)}}),I=Object(u.a)(D,1)[0],T=Object(pe.a)(ji,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(_.a)(Object(_.a)({},e),{},{level:a.level}):e}));r(n)}}),$=Object(u.a)(T,1)[0],P=Object(pe.a)(pi,{update:function(e,t){var a=t.data;if(O.b.dismiss(),a.update_operationeventlog.returning.length>0){O.b.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),c=i.map((function(e){return n.includes(e.id)?Object(_.a)(Object(_.a)({},e),{},{resolved:!0}):Object(_.a)({},e)}));r(c)}else O.b.info("No Viewable Errors to Resolve")}}),A=Object(u.a)(P,1)[0],E=Object(pe.a)(mi,{update:function(e,t){var a=t.data;if(O.b.dismiss(),a.update_operationeventlog.returning.length>0){O.b.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),c=i.map((function(e){return n.includes(e.id)?Object(_.a)(Object(_.a)({},e),{},{resolved:!0}):Object(_.a)({},e)}));r(c)}else O.b.info("No Errors to Resolve")}}),L=Object(u.a)(E,1)[0];return Object(g.jsx)(ri,{onSubmitMessage:function(e){var t=e.level,a=e.message;w({variables:{level:t,message:a}})},operationeventlog:i,loadMore:function(){O.b.info("Loading more events..."),j({variables:{operation_id:t.user.current_operation_id,offset:l,eventQuerySize:100}})},loadNextError:function(){O.b.info("Loading more errors..."),v({variables:{operation_id:t.user.current_operation_id}})},onUpdateDeleted:function(e){var t=e.id;O.b.info("Deleting event log..."),S({variables:{id:t}})},onUpdateResolution:function(e){var t=e.id,a=e.resolved;I({variables:{id:t,resolved:a}})},onUpdateLevel:function(e){var t=e.id;$({variables:{id:t}})},getSurroundingEvents:function(e){var a=e.id;O.b.info("Loading surrounding events..."),m({variables:{lower_id:a-5,upper_id:a+5,operation_id:t.user.current_operation_id}})},resolveViewableErrors:function(){O.b.info("Resolving Errors...");var e=i.reduce((function(e,t){return"warning"!==t.level||t.resolved?Object(y.a)(e):[].concat(Object(y.a)(e),[t.id])}),[]);A({variables:{ids:e}})},resolveAllErrors:function(){O.b.info("Resolving Errors..."),L({variables:{operation_id:t.user.current_operation_id}})}})}var fi,Oi,gi,xi,yi,_i=a(73),vi=a.n(_i);function ki(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState("operator"),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState({}),j=Object(u.a)(b,2),p=j[0],m=j[1],h=Object(o.useRef)(null);Object(o.useEffect)((function(){i(e.operator.checked),d(e.operator.view_mode),console.log(e.operator),e.operator.disabledcommandsprofile?m(e.operator.disabledcommandsprofile.name):m("")}),[e.operator]);return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:n,onChange:function(t){i(t.target.checked),e.updateOperator(Object(_.a)(Object(_.a)({},e.operator),{},{checked:t.target.checked,view_mode:l}))},color:"secondary"})}),Object(g.jsx)(C.a,{children:e.operator.username}),Object(g.jsx)(C.a,{children:n?Object(g.jsxs)(mt.a,{style:{width:"100%"},children:[Object(g.jsx)($t.a,{ref:h,children:"Options"}),Object(g.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:l,onChange:function(t){d(t.target.value),e.updateOperator(Object(_.a)(Object(_.a)({},e.operator),{},{checked:n,view_mode:t.target.value}))},input:Object(g.jsx)(Ot.a,{style:{width:"100%"}}),children:["operator","spectator","lead"].map((function(e){return Object(g.jsx)(tt.a,{value:e,children:e},e)}))})]}):null}),Object(g.jsx)(C.a,{children:n?Object(g.jsxs)(mt.a,{style:{width:"100%"},children:[Object(g.jsx)($t.a,{ref:h,children:"Block List Options"}),Object(g.jsxs)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:p,onChange:function(t){m(t.target.value);var a=e.commandBlockLists.findIndex((function(e){return e.name===t.target.value}));a>-1?e.updateOperator(Object(_.a)(Object(_.a)({},e.operator),{},{checked:n,disabledcommandsprofile:e.commandBlockLists[a]})):e.updateOperator(Object(_.a)(Object(_.a)({},e.operator),{},{checked:n,disabledcommandsprofile:null}))},input:Object(g.jsx)(Ot.a,{style:{width:"100%"}}),children:[Object(g.jsx)(tt.a,{value:-1,children:"None"},"None"),e.commandBlockLists.map((function(t){return Object(g.jsx)(tt.a,{value:t.name,children:t.name},e.operator.username+t.name)}))]})]}):null})]})})}var wi=Object(be.a)(fi||(fi=Object(v.a)(["\nquery GetOperation($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      disabledcommandsprofile {\n        name\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n  disabledcommandsprofile(where: {operation_id: {_eq: $operation_id}}, distinct_on: name, order_by: {name: asc}) {\n    name\n    id\n  }\n}\n"]))),Ci=Object(be.a)(Oi||(Oi=Object(v.a)(["\nmutation updateLeadMutation($operation_id: Int!, $admin_id: Int!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {admin_id: $admin_id}) {\n    admin {\n      id\n      username\n    }\n    id\n  }\n}\n"]))),Si=Object(be.a)(gi||(gi=Object(v.a)(["\nmutation updateOperatorViewMode($operatoroperation_id: Int!, $view_mode: String!, $disabledcommandsprofile: Int) {\n  update_operatoroperation_by_pk(pk_columns: {id: $operatoroperation_id}, _set: {view_mode: $view_mode, base_disabled_commands_id: $disabledcommandsprofile}) {\n    id\n    view_mode\n  }\n}"]))),Di=Object(be.a)(xi||(xi=Object(v.a)(["\nmutation removeOperatorsFromOperation($operatoroperation_ids: [Int!]!) {\n  delete_operatoroperation(where: {id: {_in: $operatoroperation_ids}}) {\n    returning {\n      id\n    }\n  }\n}"]))),Ii=Object(be.a)(yi||(yi=Object(v.a)(["\nmutation addNewOperators($operators: [operatoroperation_insert_input!]!) {\n  insert_operatoroperation(objects: $operators) {\n    returning {\n      id\n    }\n  }\n}"])));function Ti(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState({}),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState([]),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState([]),f=Object(u.a)(h,2),x=f[0],v=f[1];Object(je.a)(wi,{variables:{operation_id:e.id},fetchPolicy:"network-only",onCompleted:function(e){var t=e.operator.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{checked:!1})}));m(e.operation_by_pk.operatoroperations),l(e.operation_by_pk.admin);var a=t.map((function(t){var a=e.operation_by_pk.operatoroperations.find((function(e){return e.operator.id===t.id}));return a?a.operator.id===e.operation_by_pk.admin.id?Object(_.a)(Object(_.a)({},t),{},{checked:!0,view_mode:"lead",operatoroperation_id:a.id,disabledcommandsprofile:a.disabledcommandsprofile}):Object(_.a)(Object(_.a)({},t),{},{checked:!0,view_mode:a.view_mode,operatoroperation_id:a.id,disabledcommandsprofile:a.disabledcommandsprofile}):Object(_.a)(Object(_.a)({},t),{},{view_mode:"operator"})}));a.sort((function(e,t){return e.username>t.username?1:-1})),i(a);var n=Object(y.a)(e.disabledcommandsprofile);v(n)},onError:function(e){O.b.error("Failed to get operational data"),console.error(e)}});var $=Object(pe.a)(Ci,{onCompleted:function(e){O.b.success("Successfully updated Lead")},onError:function(e){O.b.error("Failed to update operation"),console.log("error updating operation",e)}}),P=Object(u.a)($,1)[0],A=Object(pe.a)(Ii,{onCompleted:function(e){O.b.success("Sucessfully added operators")},onError:function(e){O.b.error("Failed to add operators"),console.error("error adding operators to operation",e)}}),E=Object(u.a)(A,1)[0],L=Object(pe.a)(Di,{onCompleted:function(e){O.b.success("Sucessfully removed operators")},onError:function(e){O.b.error("Failed to remove operators"),console.error("error removing operators from operation",e)}}),F=Object(u.a)(L,1)[0],q=Object(pe.a)(Si,{onCompleted:function(e){O.b.success("Successfully updated operator view mode")},onError:function(e){O.b.error("Failed to update operator view mode"),console.error("failed to update view mode: ",e)}}),N=Object(u.a)(q,1)[0],R=function(e){var t=Object(y.a)(n);"lead"===e.view_mode&&(t=t.map((function(e){return"lead"===e.view_mode?Object(_.a)(Object(_.a)({},e),{},{view_mode:"operator"}):Object(_.a)({},e)}))),t=t.map((function(t){return t.id===e.id?Object(_.a)({},e):Object(_.a)({},t)})),i(t)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Modify Operator Assignments"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"8rem"},children:"Assign to Operation"}),Object(g.jsx)(C.a,{style:{width:"8rem"},children:"Operator"}),Object(g.jsx)(C.a,{style:{width:"10rem"},children:"Role"}),Object(g.jsx)(C.a,{children:"Block List"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)(ki,{operator:e,updateOperator:R,commandBlockLists:x},"operator"+e.id)}))})]})})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){var t=n.find((function(e){return"lead"===e.view_mode}));if(t){t.id!==o.id&&P({variables:{operation_id:e.id,admin_id:t.id}});var a=[],i=[];n.forEach((function(t){var n=p.find((function(e){return e.operator.id===t.id}));n?t.checked?t.view_mode===n.view_mode&&t.disabledcommandsprofile===n.disabledcommandsprofile||N({variables:{operatoroperation_id:n.id,view_mode:t.view_mode,disabledcommandsprofile:t.disabledcommandsprofile?t.disabledcommandsprofile.id:null}}):i.push(n.id):t.checked&&a.push({operation_id:e.id,operator_id:t.id,view_mode:t.view_mode})})),a.length>0&&E({variables:{operators:a}}),i.length>0&&F({variables:{operatoroperation_ids:i}}),e.onClose()}else O.b.error("No Lead for the operation is set")},variant:"contained",color:"secondary",children:"Update"})]})]})}var $i,Pi,Ai=a(487),Ei=a.n(Ai),Li=a(295),Fi=a.n(Li),qi=a(486),Ni=a.n(qi),Ri=Object(be.a)($i||($i=Object(v.a)(["\nquery GetOperations($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    name\n    id\n    channel\n    display_name\n    icon_emoji\n    icon_url\n    webhook\n    webhook_message\n    complete\n  }\n}\n"])));function Bi(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),p=Object(u.a)(d,2),m=p[0],h=p[1],f=s.a.useState(""),x=Object(u.a)(f,2),y=x[0],_=x[1],v=s.a.useState(""),k=Object(u.a)(v,2),w=k[0],C=k[1],S=s.a.useState(""),D=Object(u.a)(S,2),I=D[0],T=D[1],P=s.a.useState(""),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useState(!1),q=Object(u.a)(F,2),N=q[0],R=q[1];Object(je.a)(Ri,{fetchPolicy:"no-cache",variables:{operation_id:e.id},onCompleted:function(e){var t=e.operation_by_pk.webhook_message;try{t=JSON.stringify(JSON.parse(t),null,4)}catch(a){}i(e.operation_by_pk.name),l(e.operation_by_pk.channel),h(e.operation_by_pk.display_name),_(e.operation_by_pk.icon_emoji),C(e.operation_by_pk.icon_url),T(e.operation_by_pk.webhook),L(t),R(e.operation_by_pk.complete)},onError:function(){O.b.error("Failed to fetch data")}});var B=function(e,t,a){switch(e){case"name":i(t);break;case"Webhook Channel":l(t);break;case"Webhook Display Name":h(t);break;case"Webhook Icon Emoji":_(t);break;case"Webhook Icon URL":C(t);break;case"Webhook URL":T(t);break;case"Webhook POST Message":L(t)}};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:["Modify ",n]}),Object(g.jsxs)(G.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:[Object(g.jsx)(V.a,{children:"Use this dialog to update some information about an operation."}),Object(g.jsx)(j.a,{autoFocus:!0,value:n,onChange:B,margin:"dense",name:"name"}),"Complete Operation? ",Object(g.jsx)($.a,{checked:N,onChange:function(e){R(e.target.checked)},color:"secondary"}),Object(g.jsx)(j.a,{margin:"dense",value:o,onChange:B,name:"Webhook Channel"}),Object(g.jsx)(j.a,{margin:"dense",value:m,onChange:B,name:"Webhook Display Name"}),Object(g.jsx)(j.a,{margin:"dense",value:y,onChange:B,name:"Webhook Icon Emoji"}),Object(g.jsx)(j.a,{margin:"dense",value:w,onChange:B,name:"Webhook Icon URL"}),Object(g.jsx)(j.a,{margin:"dense",value:I,onChange:B,name:"Webhook URL"}),Object(g.jsx)(ot.a,{mode:"json",theme:"monokai",onChange:function(e,t){L(e)},fontSize:14,showGutter:!0,maxLines:20,highlightActiveLine:!0,value:E,width:"100%",setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})]}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){e.onUpdateOperation({operation_id:e.id,name:n,channel:o,display_name:m,icon_emoji:y,icon_url:w,webhook:I,webhook_message:E,complete:N}),e.onClose()},variant:"contained",color:"secondary",children:"Update"})]})]})}var zi,Wi,Mi,Hi=Object(be.a)(Pi||(Pi=Object(v.a)(["\nmutation updateCurrentOpertionMutation($operator_id: Int!, $operation_id: Int!) {\n  updateCurrentOperation(user_id: $operator_id, operation_id: $operation_id) {\n    status\n    error\n    operation_id\n  }\n}\n"])));function Ui(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],x=Object(f.a)(h.b),y=Object(pe.a)(Hi,{onCompleted:function(e){"success"===e.updateCurrentOperation.status?(Object(h.b)(Object(_.a)(Object(_.a)({},h.b),{},{user:Object(_.a)(Object(_.a)({},h.b.user),{},{current_operation_id:e.updateCurrentOperation.operation_id,current_operation_name:e.updateCurrentOperation.operation_name})})),O.b.success("Updated current operation")):O.b.error(e.updateCurrentOperation.error)},onError:function(e){O.b.error("Failed to update current operation"),console.error(e)}}),v=Object(u.a)(y,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsxs)(C.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){i(!0)},startIcon:Object(g.jsx)(vi.a,{}),color:e.complete?"secondary":"primary",variant:"contained",children:"Edit"}),n&&Object(g.jsx)(Y.a,{open:n,fullWidth:!0,maxWidth:"lg",onClose:function(){i(!1)},innerDialog:Object(g.jsx)(Bi,{onClose:function(){i(!1)},id:e.id,onUpdateOperation:e.onUpdateOperation})})]}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){l(!0)},startIcon:Object(g.jsx)(Ni.a,{}),color:e.complete?"secondary":"primary",variant:"contained",children:"Edit"}),o&&Object(g.jsx)(Y.a,{open:o,maxHeight:"calc(80vh)",fullWidth:!0,maxWidth:"md",onClose:function(){l(!1)},innerDialog:Object(g.jsx)(Ti,{id:e.id,onClose:function(){l(!1)}})})]}),Object(g.jsxs)(C.a,{children:[e.name," ",e.complete?" (Completed) ":""]}),Object(g.jsx)(C.a,{children:e.admin.username}),Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{size:"small",startIcon:Object(g.jsx)(Fi.a,{}),onClick:function(){O.b.warning("Not Implemented")},color:"primary",variant:"contained",children:"Analysis"})}),Object(g.jsx)(C.a,{children:e.id===x.user.current_operation_id?"Current Operation":Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{size:"small",startIcon:Object(g.jsx)(Ei.a,{}),onClick:function(){m(!0)},color:"primary",variant:"contained",children:"Make Current"}),p&&Object(g.jsx)(ha,{onClose:function(){m(!1)},onSubmit:function(){v({variables:{operator_id:x.user.user_id,operation_id:e.id}})},open:p,title:"Change Current Operation?",acceptText:"Update",dialogText:"Changing operations will force you to log in again"})]})})]},e.id)})}var Gi,Vi=Object(be.a)(zi||(zi=Object(v.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    error\n    id\n    status\n  }\n}\n"]))),Ki=Object(be.a)(Wi||(Wi=Object(v.a)(["\nmutation MyMutation($operation_id: Int!, $channel: String!, $complete: Boolean!, $display_name: String!, $icon_emoji: String!, $icon_url: String!, $name: String!, $webhook: String!, $webhook_message: String!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {channel: $channel, complete: $complete, display_name: $display_name, icon_emoji: $icon_emoji, icon_url: $icon_url, name: $name, webhook: $webhook, webhook_message: $webhook_message}) {\n    id\n    name\n    complete\n  }\n}\n"]))),Qi=Object(be.a)(Mi||(Mi=Object(v.a)(["\nmutation newOperationMutation{\n    createOperation{\n        status\n        error\n        operation{\n            name\n            id\n            admin {\n                id\n                username\n            }\n        }\n        \n    }\n}\n"])));function Ji(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(pe.a)(Vi,{update:function(e,t){var a=t.data;"success"===a.createOperator.status?O.b.success("Created operator"):O.b.error(a.createOperator.error)},onError:function(e){O.b.warning("Unable to create new operator"),console.log(e)}}),o=Object(u.a)(c,1)[0],l=Object(pe.a)(Ki,{onCompleted:function(t){e.onUpdateOperation(t.update_operation_by_pk),O.b.success("Successfully updated operation")},onError:function(e){O.b.error("Failed to update operation"),console.log("error updating operation",e)}}),d=Object(u.a)(l,1)[0],j=Object(pe.a)(Qi,{onCompleted:function(t){console.log(t),"success"===t.createOperation.status?(O.b.success("Successfully created operation!"),e.onNewOperation(t.createOperation.operation)):O.b.error(t.createOperation.error)},onError:function(e){console.log(e)}}),p=Object(u.a)(j,1)[0],m=function(e){var t=e.operation_id,a=e.name,n=e.channel,i=e.display_name,r=e.icon_emoji,c=e.icon_url,o=e.webhook,s=e.webhook_message,l=e.complete;d({variables:{operation_id:t,name:a,channel:n,display_name:i,icon_emoji:r,icon_url:c,webhook:o,webhook_message:s,complete:l}})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operations"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){p()},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"New Operation"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"New Operator"}),i&&Object(g.jsx)(Y.a,{open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(Q,Object(_.a)({title:"New Operator",onAccept:function(e,t,a,n){a!==n?O.b.error("Passwords don't match"):0===n.length?O.b.error("Password must not be empty"):0===t.length?O.b.error("Username must not be empty"):(o({variables:{username:t,password:n}}),r(!1))},handleClose:function(){r(!1)}},e))})]}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"8rem"},children:"Configure"}),Object(g.jsx)(C.a,{style:{width:"8rem"},children:"Operators"}),Object(g.jsx)(C.a,{children:"Operation Name"}),Object(g.jsx)(C.a,{children:"Operation Admin"}),Object(g.jsx)(C.a,{style:{width:"10rem"},children:"Analysis"}),Object(g.jsx)(C.a,{style:{width:"12rem"},children:"Operation Status"})]})}),Object(g.jsx)(w.a,{children:e.operations.map((function(t){return Object(g.jsx)(Ui,Object(_.a)(Object(_.a)({onUpdateOperation:m},t),{},{operator:e.operator}),"operation"+t.id)}))})]})})]})}var Yi=Object(Se.a)((function(e){return{root:{margin:"auto"},paper:{overflow:"auto",backgroundColor:"rgb(76,80,86) !important"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}}));function Zi(e){var t=Yi(),a=Object(ee.a)(),n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState([]),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState(""),_=Object(u.a)(x,2),v=_[0],k=_[1],w=s.a.useState(""),C=Object(u.a)(w,2),S=C[0],D=C[1],I=A(r,j),$=A(r,f);function P(t,a){return e.itemKey?t.filter((function(t){return void 0===a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1===a.indexOf(e)}))}function A(t,a){return e.itemKey?t.filter((function(t){return void 0!==a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1!==a.indexOf(e)}))}var E=function(t){return function(){var a=-1;a=e.itemKey?r.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):r.indexOf(t);var n=Object(y.a)(r);-1===a?n.push(t):n.splice(a,1),c(n)}};Object(o.useEffect)((function(){var t=e.left.reduce((function(t,a){return void 0===e.itemKey?e.right.includes(a)?Object(y.a)(t):[].concat(Object(y.a)(t),[a]):e.right.find((function(t){return t[e.itemKey]===a[e.itemKey]}))?Object(y.a)(t):[].concat(Object(y.a)(t),[a])}),[]);p(t),O(e.right),k(e.leftTitle),D(e.rightTitle)}),[e.left,e.right,e.leftTitle,e.rightTitle,e.itemKey]),Object(o.useEffect)((function(){e.onChange({selected:f,ptype:e.ptype})}),[f]);var F=function(a,n){return Object(g.jsx)(T.a,{style:{width:"100%"},children:Object(g.jsxs)(Ie.a,{children:[Object(g.jsx)(va.a,{className:t.paper,title:a}),Object(g.jsx)(ka.a,{classes:{root:t.divider}}),Object(g.jsx)($e.a,{style:{height:"calc(30vh)",overflow:"auto"},className:t.paper,children:Object(g.jsx)(Oa.a,{dense:!0,component:"div",role:"list",style:{padding:0},className:t.paper,children:n.map((function(t){var a=void 0===e.itemKey?t:t[e.itemKey],n="transfer-list-item-".concat(a,"-label");return Object(g.jsxs)(ga.a,{style:{padding:0},role:"listitem",button:!0,onClick:E(t),children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(_a.a,{checked:void 0===e.itemKey?-1!==r.indexOf(a):-1!==r.findIndex((function(t){return t[e.itemKey]===a})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(g.jsx)(ya.a,{id:n,primary:a})]},a)}))})})]})})};return Object(g.jsxs)(ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(g.jsx)(ft.a,{item:!0,xs:12,children:Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:e.ptype})})}),Object(g.jsx)(ft.a,{item:!0,xs:5,children:F(v,j)}),Object(g.jsx)(ft.a,{item:!0,children:Object(g.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){O(f.concat(j)),p([])},disabled:0===j.length,"aria-label":"move all right",children:"\u226b"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){O(f.concat(I)),p(P(j,I)),c(P(r,I))},disabled:0===I.length,"aria-label":"move selected right",children:">"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){p(j.concat($)),O(P(f,$)),c(P(r,$))},disabled:0===$.length,"aria-label":"move selected left",children:"<"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){p(j.concat(f)),O([])},disabled:0===f.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(g.jsx)(ft.a,{item:!0,xs:5,children:F(S,f)})]})}var Xi=s.a.memo(Zi),er=Object(be.a)(Gi||(Gi=Object(v.a)(["\n  query getPayloadTypesAndCommands{\n    payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n      commands(order_by: {cmd: asc}) {\n        cmd\n        id\n      }\n      id\n      ptype\n    }\n  }\n"])));function tr(e){var t=e.dialogTitle,a=e.onSubmit,n=e.blockListName,i=e.onClose,r=e.currentSelected,c=e.editable,o=s.a.useState([]),l=Object(u.a)(o,2),d=l[0],p=l[1],m=s.a.useState({}),h=Object(u.a)(m,2),f=h[0],x=h[1],v=s.a.useState(""),k=Object(u.a)(v,2),w=k[0],C=k[1];Object(je.a)(er,{fetchPolicy:"network-only",onCompleted:function(e){n&&C(n);var t=e.payloadtype.map((function(e){var t=[];return void 0!==r[e.ptype]&&(t=Object(y.a)(r[e.ptype])),Object(_.a)(Object(_.a)({},e),{},{selected:t})}));p(t),x(Object(_.a)({},r))},onError:function(e){}});var S=s.a.useCallback((function(e){var t=e.selected,a=e.ptype;x(Object(_.a)(Object(_.a)({},f),{},Object(jt.a)({},a,t)))}),[f]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:t}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(j.a,{disabled:!c,onChange:function(e,t,a){C(t)},value:w,name:"Block List Name",autoFocus:!0,requiredValue:!0}),d.map((function(e){return Object(g.jsx)(Xi,{leftTitle:"Not Blocked",onChange:S,rightTitle:"Blocked Commands",itemKey:"cmd",right:e.selected,left:e.commands,ptype:e.ptype},e.ptype)}))]}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:i,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){if(""!==w.trim()){for(var e=[],t=[],n=0,c=Object.values(f);n<c.length;n++)for(var o=c[n],s=0;s<o.length;s++)e.push({command_id:o[s].id,name:w.trim()});for(var l=function(){for(var a=u[d],n=function(n){var i=e.findIndex((function(e){return e.command_id===a[n].id}));i>-1?e.splice(i,1):t.push({command_id:a[n].id,name:w.trim()})},i=0;i<a.length;i++)n(i)},d=0,u=Object.values(r);d<u.length;d++)l();a({toAdd:e,toRemove:t}),i()}else O.b.warning("Must supply a block list name")},variant:"contained",color:"secondary",children:"Submit"})]})]})}var ar,nr,ir,rr,cr,or=a(296),sr=a.n(or),lr=Object(be.a)(ar||(ar=Object(v.a)(["\nmutation newBlockListsEntries($entries: [disabledcommandsprofile_insert_input!]!) {\n    insert_disabledcommandsprofile(objects: $entries) {\n        returning {\n            id\n            name\n            command{\n              id\n              cmd\n              payloadtype{\n                ptype\n              }\n            }\n        }\n    }\n}\n"]))),dr=Object(be.a)(nr||(nr=Object(v.a)(["\nmutation deleteEntireBlockList($name: String!){\n    deleteBlockList(name: $name){\n        status\n        error\n        name\n    }\n}\n"]))),ur=Object(be.a)(ir||(ir=Object(v.a)(["\nmutation deleteBlockListEntries($name: String!, $entries: [Int!]!){\n    deleteBlockListEntry(name: $name, entries: $entries){\n        status\n        error\n        name\n        deleted_ids\n    }\n}\n"])));function br(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=Object(pe.a)(lr,{onCompleted:function(e){var t=e.insert_disabledcommandsprofile.returning.reduce((function(e,t){return void 0===e[t.command.payloadtype.ptype]&&(e[t.command.payloadtype.ptype]=[]),e[t.command.payloadtype.ptype].push(t),Object(_.a)({},e)}),{}),a=Object(y.a)(l),n=!1,i=a.map((function(a){if(a.name===e.insert_disabledcommandsprofile.returning[0].name){n=!0;for(var i={},r=0,c=Object.entries(t);r<c.length;r++){var o=Object(u.a)(c[r],2),s=o[0],l=o[1];void 0===i[s]?i[s]=Object(y.a)(l):i[s]=[].concat(Object(y.a)(i[s]),Object(y.a)(l))}for(var d=0,b=Object.entries(a.entries);d<b.length;d++){var j=Object(u.a)(b[d],2),p=j[0],m=j[1];void 0===i[p]?i[p]=Object(y.a)(m):i[p]=[].concat(Object(y.a)(i[p]),Object(y.a)(m))}return Object(_.a)(Object(_.a)({},a),{},{entries:i})}return Object(_.a)({},a)}));d(n?Object(y.a)(i):[].concat(Object(y.a)(i),[{name:e.insert_disabledcommandsprofile.returning[0].name,entries:t}]))},onError:function(e){O.b.warning("Unable to create new block lists"),console.log(e)}}),p=Object(u.a)(j,1)[0],m=Object(pe.a)(dr,{onCompleted:function(e){if("success"===e.deleteBlockList.status){var t=l.filter((function(t){return t.name!==e.deleteBlockList.name}));d(t),O.b.success("Successfully deleted block list")}else O.b.error(e.deleteBlockList.error)},onError:function(e){O.b.warning("Unable to delete block list"),console.log(e)}}),h=Object(u.a)(m,1)[0],f=Object(pe.a)(ur,{onCompleted:function(e){if("success"===e.deleteBlockListEntry.status){O.b.success("Successfully deleted block list");var t=Object(y.a)(l).map((function(t){if(t.name===e.deleteBlockListEntry.name){for(var a={},n=0,i=Object.entries(t.entries);n<i.length;n++){var r=Object(u.a)(i[n],2),c=r[0],o=r[1].filter((function(t){return!e.deleteBlockListEntry.deleted_ids.includes(t.id)}));a[c]=o}return Object(_.a)(Object(_.a)({},t),{},{entries:a})}return Object(_.a)({},t)}));d(Object(y.a)(t))}else O.b.error(e.deleteBlockListEntry.error)},onError:function(e){O.b.warning("Unable to delete block list"),console.log(e)}}),x=Object(u.a)(f,1)[0];s.a.useEffect((function(){d(e.blockLists)}),[e.blockLists]);var v=function(e){var t=e.toAdd,a=e.toRemove;t.length>0&&p({variables:{entries:t}});var n=a.map((function(e){return e.command_id}));n.length>0&&x({variables:{entries:n,name:a[0].name}})},$=function(e){var t=e.name;h({variables:{name:t}})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Command Block Lists"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"New Block List"}),i&&Object(g.jsx)(Y.a,{open:i,fullWidth:!0,maxWidth:"lg",onClose:function(){r(!1)},innerDialog:Object(g.jsx)(tr,{editable:!0,currentSelected:[],onSubmit:function(e){var t=e.toAdd;p({variables:{entries:t}})},dialogTitle:"Create New Block List",onClose:function(){return r(!1)}})})]}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(C.a,{style:{width:"7rem"},children:"Modify"}),Object(g.jsx)(C.a,{style:{width:"15rem"},children:"Name"}),Object(g.jsx)(C.a,{children:"Blocked Commands"})]})}),Object(g.jsx)(w.a,{children:l.map((function(e){return Object(g.jsx)(jr,Object(_.a)(Object(_.a)({},e),{},{onAcceptDelete:$,onSubmitEdits:v}),e.name)}))})]})})]})}function jr(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState({}),O=Object(u.a)(f,2),x=O[0],y=O[1];s.a.useEffect((function(){for(var t=[],a={},n=0,i=Object.entries(e.entries);n<i.length;n++){var r=Object(u.a)(i[n],2),c=r[0],o=r[1],s=o.map((function(e){return e.command.cmd})).sort().join(", ");t.push({ptype:c,commands:s}),a[c]=o.map((function(e){return e.command}))}y(a),d(t)}),[e.entries]);return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsxs)(C.a,{children:[Object(g.jsx)(E.a,{size:"small",onClick:function(){r(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})}),Object(g.jsx)(ha,{onClose:function(){r(!1)},onSubmit:function(){r(!1),e.onAcceptDelete({name:e.name})},open:i})]}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){h(!0)},startIcon:Object(g.jsx)(sr.a,{}),color:"secondary",variant:"contained",children:"Edit"}),m&&Object(g.jsx)(Y.a,{open:m,fullWidth:!0,maxWidth:"lg",onClose:function(){h(!1)},innerDialog:Object(g.jsx)(tr,{editable:!1,blockListName:e.name,currentSelected:x,onSubmit:function(t){var a=t.toAdd,n=t.toRemove;e.onSubmitEdits({toAdd:a,toRemove:n})},dialogTitle:"Edit Block List",onClose:function(){return h(!1)}})})]}),Object(g.jsx)(C.a,{children:e.name}),Object(g.jsx)(C.a,{children:l.map((function(t){return Object(g.jsxs)("div",{children:[t.ptype," - ",t.commands]},e.name+t.ptype)}))})]})}var pr=Object(be.a)(rr||(rr=Object(v.a)(["\nquery GetOperations {\n  operation(order_by: {name: asc}) {\n    complete\n    name\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n}\n"]))),mr=Object(be.a)(cr||(cr=Object(v.a)(["\nquery getBlockLists {\n  disabledcommandsprofile(order_by: {name: asc}) {\n    id\n    name\n    command{\n      id\n      cmd\n      payloadtype{\n        ptype\n      }\n    }\n  }\n}\n"])));function hr(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];Object(je.a)(pr,{fetchPolicy:"network-only",onCompleted:function(e){l(e.operation)},onError:function(e){}}),Object(je.a)(mr,{fetchPolicy:"network-only",onCompleted:function(e){for(var t=e.disabledcommandsprofile.reduce((function(e,t){return void 0===e[t.name]&&(e[t.name]={}),void 0===e[t.name][t.command.payloadtype.ptype]&&(e[t.name][t.command.payloadtype.ptype]=[]),e[t.name][t.command.payloadtype.ptype].push(t),Object(_.a)({},e)}),{}),a=[],n=0,r=Object.entries(t);n<r.length;n++){var c=Object(u.a)(r[n],2),o=c[0],s=c[1];a.push({name:o,entries:s})}i(a)},onError:function(e){}});return Object(g.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(g.jsx)(Ji,{operations:o,onUpdateOperation:function(e){var t=e.id,a=e.name,n=e.complete,i=o.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{name:a,complete:n}):Object(_.a)({},e)}));l(i)},onNewOperation:function(e){var t=e.id,a=e.name,n=e.admin;l([].concat(Object(y.a)(o),[{id:t,name:a,admin:n}]))}}),Object(g.jsx)(br,{blockLists:n})]})}a(399),a(400);var fr,Or=Object(be.a)(fr||(fr=Object(v.a)(["\nquery getCommandsAndPayloadTypes{\n  payloadtype(order_by: {ptype: asc}){\n    id\n    ptype\n    commands(order_by: {cmd: asc}){\n      id\n      cmd\n    }\n  }\n}\n"])));function gr(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),l=Object(u.a)(c,2),d=l[0],p=l[1],m=s.a.useState(""),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState([]),y=Object(u.a)(x,2),_=y[0],v=y[1],k=s.a.useState([]),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState(""),I=Object(u.a)(D,2),T=I[0],$=I[1],P=Object(o.useRef)(null),A=Object(o.useRef)(null);Object(je.a)(Or,{onCompleted:function(t){if(v(t.payloadtype),void 0!==e.payload_type_id?p(e.payload_type_id):t.payloadtype.length>0&&p(t.payloadtype[0].id),void 0!==e.command_id){O(e.command_id);for(var a=0;a<t.payloadtype.length;a++)e.payload_type_id===t.payloadtype[a].id&&S(t.payloadtype[a].commands)}else t.payloadtype.length>0&&t.payloadtype[0].commands.length>0&&(S(t.payloadtype[0].commands),O(t.payloadtype[0].commands[0].id));void 0!==e.author&&$(e.author)},onError:function(e){}}),Object(o.useEffect)((function(){void 0!==e.script&&r(atob(e.script))}),[e.script]);var E=function(){e.onSubmitEdit({script:btoa(i),command_id:f,payload_type_id:d,author:T}),e.onClose()};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{children:e.title?e.title:"Edit BrowserScript Code"}),Object(g.jsxs)(G.a,{dividers:!0,style:{height:"calc(80vh)"},children:[Object(g.jsxs)(mt.a,{style:{width:"50%"},children:[Object(g.jsx)($t.a,{ref:P,children:"Payload Type"}),Object(g.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:d,onChange:function(e){p(e.target.value);var t=_.filter((function(t){return t.id===e.target.value}));S(t[0].commands),O(t[0].commands[0].id)},input:Object(g.jsx)(Ot.a,{style:{width:"100%"}}),children:_.map((function(e){return Object(g.jsx)(tt.a,{value:e.id,children:e.ptype},"payloadtype"+e.id)}))})]}),Object(g.jsxs)(mt.a,{style:{width:"50%",paddingBottom:"10px"},children:[Object(g.jsx)($t.a,{ref:A,children:"Command"}),Object(g.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:f,onChange:function(e){O(e.target.value)},input:Object(g.jsx)(Ot.a,{style:{width:"100%"}}),children:C.map((function(e){return Object(g.jsx)(tt.a,{value:e.id,children:e.cmd},"command"+e.id)}))})]}),Object(g.jsx)(j.a,{value:T,onChange:function(e,t,a){$(t)},name:"Author",fullWidth:!0}),Object(g.jsx)(ot.a,{mode:"javascript",theme:"dark"===t.palette.type?"monokai":"github",width:"100%",height:"100%",value:i,focus:!0,onChange:function(e){r(e)},setOptions:{}})]}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",style:{backgroundColor:t.palette.primary.main},children:"Close"}),e.new?Object(g.jsx)(b.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Create"}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{onClick:function(){e.onRevert(),e.onClose()},variant:"contained",style:{backgroundColor:t.palette.success.main},children:"Revert"}),Object(g.jsx)(b.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Save"})]})]})]})}function xr(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1];Object(o.useEffect)((function(){var t=!1;e.browserscriptoperations.forEach((function(a){a.operation_id===e.operation_id&&(t=!0)})),j(t)}),[e.browserscriptoperations,e.operation_id]);return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsxs)(C.a,{children:[Object(g.jsx)(E.a,{size:"small",onClick:function(){f(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})}),Object(g.jsx)(ha,{onClose:function(){f(!1)},onSubmit:function(){e.onDelete({browserscript_id:e.id})},open:h})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:e.active,onChange:function(){e.onToggleActive({browserscript_id:e.id,active:!e.active})},color:"primary",inputProps:{"aria-label":"checkbox",track:"white"},name:"Active"})}),Object(g.jsx)(C.a,{children:e.payloadtype.ptype}),Object(g.jsx)(C.a,{children:e.command.cmd}),Object(g.jsx)(C.a,{children:e.author}),Object(g.jsxs)(C.a,{children:[e.user_modified?"User Modified":""," "]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){r(!0)},color:"primary",children:" Edit "})}),Object(g.jsx)(C.a,{children:d?Object(g.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitRemoveFromOperation({browserscript_id:e.id})},color:"secondary",children:"Remove"}):Object(g.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitApplyToOperation({browserscript_id:e.id})},color:"primary",children:"Apply"})}),i?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"xl",open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(gr,{onClose:function(){r(!1)},payload_type_id:e.payloadtype.id,command_id:e.command.id,script:e.script,onSubmitEdit:function(t){var a=t.script,n=t.command_id,i=t.payload_type_id,r=t.author;e.onSubmitEdit({browserscript_id:e.id,script:a,command_id:n,payload_type_id:i,author:r})},onRevert:function(){e.onRevert({browserscript_id:e.id,script:e.container_version})},author:e.author})}):null]},"payload"+e.id)})}function yr(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Browser Scripts"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){return r(!0)},style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"New Script"}),i?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(gr,{onClose:function(){r(!1)},title:"Create New Browser Script",new:!0,onSubmitEdit:e.onSubmitNew})}):null]}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Active"}),Object(g.jsx)(C.a,{children:"Payload"}),Object(g.jsx)(C.a,{children:"Command"}),Object(g.jsx)(C.a,{children:" Author"}),Object(g.jsx)(C.a,{style:{width:"15em"},children:"User Modified?"}),Object(g.jsx)(C.a,{style:{width:"8em"},children:" Edit"}),Object(g.jsx)(C.a,{style:{width:"15rem"},children:"Apply to Operation"})]})}),Object(g.jsx)(w.a,{children:e.browserscript.map((function(t){return Object(g.jsx)(xr,Object(_.a)({onSubmitApplyToOperation:e.onSubmitApplyToOperation,onSubmitRemoveFromOperation:e.onSubmitRemoveFromOperation,operation_id:e.operation_id,onToggleActive:e.onToggleActive,onSubmitEdit:e.onSubmitEdit,onRevert:e.onRevert,onToggleOperation:e.onToggleOperation,onDelete:e.onDelete},t),"script"+t.id)}))})]})})]})}var _r,vr,kr,wr,Cr,Sr,Dr,Ir=a(206);function Tr(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1];return Object(o.useEffect)((function(){d(null===e.browserscript.command?"Support Script: "+e.browserscript.name:e.browserscript.command.cmd)}),[e.browserscript]),Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:e.browserscript.payloadtype.ptype}),Object(g.jsx)(C.a,{children:l}),Object(g.jsxs)(C.a,{children:[e.browserscript.user_modified?"User Modified":""," "]}),Object(g.jsx)(C.a,{children:e.operation.admin.username}),Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{size:"small",variant:"contained",style:{color:Ir.a.palette.info.main},onClick:function(){i(!0)},children:" View "})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(g.jsx)(ot.a,{mode:"javascript",theme:"github",width:"100%",value:atob(e.browserscript.script),focus:!0,readOnly:!0,onChange:function(){},setOptions:{}})})]},"opscript"+e.browserscript.id)})}function $r(e){var t=Object(ee.a)();return e.browserscriptoperation.length>0&&Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operation Browser Scripts"})}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{maxHeight:"calc(30vh)"},children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"10em"},children:"Payload"}),Object(g.jsx)(C.a,{style:{},children:"Command"}),Object(g.jsx)(C.a,{style:{width:"5em"},children:"User Modified?"}),Object(g.jsx)(C.a,{style:{},children:"Operator"}),Object(g.jsx)(C.a,{style:{width:"5em"},children:"View Script"})]})}),Object(g.jsx)(w.a,{children:e.browserscriptoperation.map((function(e){return Object(g.jsx)(Tr,Object(_.a)({},e),"opscriptrow"+e.browserscript.id)}))})]})})]})}var Pr,Ar,Er=Object(be.a)(_r||(_r=Object(v.a)(["\nsubscription SubscribeBrowserScripts($operator_id: Int!) {\n  browserscript(where: {operator_id: {_eq: $operator_id}, for_new_ui: {_eq: true}}) {\n    active\n    author\n    user_modified\n    script\n    payloadtype {\n      ptype\n      id\n    }\n    name\n    id\n    creation_time\n    container_version_author\n    container_version\n    command {\n      cmd\n      id\n    }\n    browserscriptoperations {\n      operation_id\n      id\n    }\n  }\n}\n "]))),Lr=Object(be.a)(vr||(vr=Object(v.a)(["\nsubscription SubscribeOperationBrowserScripts($operation_id: Int!) {\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {for_new_ui: {_eq: true}}}){\n    browserscript{\n        active\n        author\n        user_modified\n        script\n        payloadtype {\n          ptype\n          id\n        }\n        name\n        id\n        creation_time\n        container_version_author\n        container_version\n        command {\n          cmd\n          id\n        }\n      }\n   operation{\n    admin{\n        username\n    }\n   }\n  }\n}\n "]))),Fr=Object(be.a)(kr||(kr=Object(v.a)(["\nmutation updateBrowserScriptActive($browserscript_id: Int!, $active: Boolean!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {active: $active}) {\n    id\n  }\n}\n"]))),qr=Object(be.a)(wr||(wr=Object(v.a)(["\nmutation updateBrowserScriptScript($browserscript_id: Int!, $script: String!, $command_id: Int!, $payload_type_id: Int!, $author: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, author: $author, user_modified: true, command_id: $command_id, payload_type_id: $payload_type_id}) {\n    id\n  }\n}\n"]))),Nr=Object(be.a)(Cr||(Cr=Object(v.a)(["\nmutation updateBrowserScriptRevert($browserscript_id: Int!, $script: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, user_modified: false}) {\n    id\n  }\n}\n"]))),Rr=Object(be.a)(Sr||(Sr=Object(v.a)(["\nmutation insertNewBrowserScript($script: String!, $author: String!, $payload_type_id: Int!, $command_id: Int!){\n  insert_browserscript_one(object: {script: $script, author: $author, payload_type_id: $payload_type_id, command_id: $command_id}){\n    id\n  }\n}\n"]))),Br=Object(be.a)(Dr||(Dr=Object(v.a)(["\nmutation deleteBrowserScriptMutation($browserscript_id: Int!){\n  delete_browserscript_by_pk(id: $browserscript_id){\n    id\n  }\n}\n"])));function zr(e){var t=Object(f.a)(h.b),a=s.a.useState({browserscript:[]}),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState({browserscriptoperation:[]}),o=Object(u.a)(c,2),l=o[0],d=o[1];Object(ze.a)(Er,{variables:{operator_id:t.user.id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;console.log(t),r(t.data)}}),Object(ze.a)(Lr,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;d(t.data)}});var b=Object(pe.a)(Fr,{onCompleted:function(e){O.b.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),j=Object(u.a)(b,1)[0],p=Object(pe.a)(qr,{onCompleted:function(e){O.b.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),m=Object(u.a)(p,1)[0],x=Object(pe.a)(Nr,{onCompleted:function(e){O.b.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),y=Object(u.a)(x,1)[0],v=Object(pe.a)(Rr,{onCompleted:function(e){O.b.success("Successfully created new browser script!")},onError:function(e){O.b.error("Failed to create new script: "+e)}}),k=Object(u.a)(v,1)[0],w=Object(pe.a)(Br,{onCompleted:function(e){O.b.success("Successfully deleted browser script")},onError:function(e){O.b.error("Failed to delete browser script: "+e)}}),C=Object(u.a)(w,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(yr,Object(_.a)(Object(_.a)({},i),{},{operation_id:t.user.current_operation_id,onToggleActive:function(e){var t=e.browserscript_id,a=e.active;j({variables:{browserscript_id:t,active:a}})},onSubmitEdit:function(e){var t=e.browserscript_id,a=e.script,n=e.command_id,i=e.payload_type_id,r=e.author;m({variables:{browserscript_id:t,script:a,command_id:n,payload_type_id:i,author:r}})},onRevert:function(e){var t=e.browserscript_id,a=e.script;y({variables:{browserscript_id:t,script:a}})},onSubmitNew:function(e){var t=e.script,a=e.author,n=e.payload_type_id,i=e.command_id;k({variables:{author:a,script:t,payload_type_id:n,command_id:i}})},onDelete:function(e){var t=e.browserscript_id;C({variables:{browserscript_id:t}})},onSubmitApplyToOperation:function(e){e.browserscript_id;O.b.warning("Not Implemented Yet!",{autoHideDuration:1e3})},onSubmitRemoveFromOperation:function(e){e.browserscript_id;O.b.warning("Not Implemented Yet!",{autoHideDuration:1e3})}})),Object(g.jsx)($r,Object(_.a)({},l))]})}var Wr,Mr,Hr=Object(be.a)(Pr||(Pr=Object(v.a)(["\nmutation updateDescription ($payload_id: Int!, $description: String) {\n  update_payload_by_pk(pk_columns: {id: $payload_id}, _set: {tag: $description}) {\n    tag\n    id\n  }\n}\n"]))),Ur=Object(be.a)(Ar||(Ar=Object(v.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    tag\n    id\n  }\n}\n"])));function Gr(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(Ur,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.tag)},fetchPolicy:"network-only"}),c=r.loading,l=r.error,d=Object(pe.a)(Hr,{onCompleted:function(e){O.b.success("Updated Description")}}),p=Object(u.a)(d,1)[0];if(c)return Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}});if(l)return console.error(l),Object(g.jsx)("div",{children:"Error!"});var m=function(){p({variables:{payload_id:e.payload_id,description:n}}),e.onClose()};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Edit Payload Description"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(j.a,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:m})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:m,color:"secondary",children:"Submit"})]})]})}var Vr,Kr=Object(be.a)(Wr||(Wr=Object(v.a)(["\nmutation updateDescription ($file_id: Int!, $filename: bytea!) {\n  update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {filename: $filename}) {\n    filename_text\n    id\n  }\n}\n"]))),Qr=Object(be.a)(Mr||(Mr=Object(v.a)(["\nquery getFilenameQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    filemetum {\n      filename_text\n      id\n    }\n    id\n  }\n}\n"])));function Jr(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(),c=Object(u.a)(r,2),l=c[0],d=c[1],p=Object(je.a)(Qr,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.filemetum.filename_text),d(e.payload_by_pk.filemetum.id)},fetchPolicy:"network-only"}),m=p.loading,h=p.error,f=Object(pe.a)(Kr,{onCompleted:function(e){O.b.success("Updated filename")}}),x=Object(u.a)(f,1)[0];if(m)return Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}});if(h)return console.error(h),Object(g.jsx)("div",{children:"Error!"});var y=function(){x({variables:{file_id:l,filename:n}}),e.onClose()};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Edit Payload Filename"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(j.a,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:y})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:y,color:"secondary",children:"Submit"})]})]})}var Yr=Object(be.a)(Vr||(Vr=Object(v.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    build_message\n    build_stderr\n    build_stdout\n    id\n  }\n}\n"])));function Zr(e){var t=Object(o.useState)({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],p=Object(je.a)(Yr,{variables:{payload_id:e.payload_id},onCompleted:function(t){d(e.viewError);var a="Message:\n"+t.payload_by_pk.build_message;a+="\nSTDOUT:\n"+t.payload_by_pk.build_stdout,i({message:a,error:"STDERR:\n"+t.payload_by_pk.build_stderr})},fetchPolicy:"network-only"}),m=p.loading,h=p.error;return Object(o.useEffect)((function(){d(e.viewError)}),[e.viewError]),m?Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}}):h?(console.error(h),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Payload Build Messages"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(j.a,{multiline:!0,onChange:function(){},value:l?n.error:n.message})}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Xr=a(237),ec=a.n(Xr),tc=a(47),ac=a(488),nc=a.n(ac);function ic(e){var t=Object(ee.a)();return Object(g.jsx)(s.a.Fragment,{children:e.payloadc2profiles.map((function(a){return Object(g.jsxs)(L.a,{style:{display:"flex"},children:[a.c2profile.is_p2p?a.c2profile.container_running?Object(g.jsx)(tc.a,{title:"C2 Container online",children:Object(g.jsx)(Ua.a,{style:{color:t.palette.success.main}})}):Object(g.jsx)(tc.a,{title:"C2 Container offline",children:Object(g.jsx)(ec.a,{style:{color:t.palette.error.main}})}):a.c2profile.running?Object(g.jsx)(tc.a,{title:"C2 Internal Server Running",children:Object(g.jsx)(Ua.a,{style:{color:t.palette.success.main}})}):a.c2profile.container_running?Object(g.jsx)(tc.a,{title:"C2 Internal Server Not Running, but Container Online",children:Object(g.jsx)(nc.a,{style:{color:t.palette.warning.main}})}):Object(g.jsx)(tc.a,{title:"C2 Container offline",children:Object(g.jsx)(ec.a,{style:{color:t.palette.error.main}})})," - ",a.c2profile.name]},a.c2profile.name+e.uuid)}))})}var rc,cc=a(111),oc=a.n(cc),sc=a(489),lc=a.n(sc);function dc(e){var t=Object(ee.a)();return Object(g.jsx)(s.a.Fragment,{children:"success"===e.build_phase?Object(g.jsx)(tc.a,{title:"Download payload",children:Object(g.jsx)(E.a,{variant:"contained",target:"_blank",color:"primary",href:window.location.origin+"/direct/download/"+e.filemetum.agent_file_id,download:!0,children:Object(g.jsx)(oc.a,{style:{color:t.palette.success.main}})})}):"building"===e.build_phase?Object(g.jsx)(tc.a,{title:"Payload still building",children:Object(g.jsx)(E.a,{variant:"contained",children:Object(g.jsx)(oa.a,{size:20,thickness:4,style:{color:t.palette.info.main}})})}):Object(g.jsx)(tc.a,{title:"Failed to build payload",children:Object(g.jsx)(E.a,{variant:"contained",onClick:function(){return O.b.warning("Payload failed to build, cannot download")},children:Object(g.jsx)(lc.a,{style:{color:t.palette.error.main}})})})})}var uc,bc=Object(be.a)(rc||(rc=Object(v.a)(["\nquery checkPayloadConfigurationQuery($uuid: String!) {\n  config_check(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function jc(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(bc,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.config_check.status?i(e.config_check.output):(O.b.warning(e.config_check.error),i("Error!\n"+e.config_check.error))},fetchPolicy:"network-only"}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Payload Config Check"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(j.a,{multiline:!0,onChange:function(){},value:n})}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var pc,mc,hc=Object(be.a)(uc||(uc=Object(v.a)(["\nquery generateRedirectRulesMutation($uuid: String!) {\n  redirect_rules(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function fc(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(hc,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.redirect_rules.status?i(e.redirect_rules.output):(O.b.warning(e.redirect_rules.error),i("Error!\n"+e.redirect_rules.error))},fetchPolicy:"network-only"}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Payload Redirect Rules Check"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(j.a,{multiline:!0,onChange:function(){},value:n})}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Oc,gc=Object(be.a)(pc||(pc=Object(v.a)(["\nmutation triggerRebuildMutation($uuid: String!) {\n  rebuild_payload(uuid: $uuid) {\n      status\n      error\n      uuid\n  }\n}\n"]))),xc=Object(be.a)(mc||(mc=Object(v.a)(["\nquery exportPayloadConfigQuery($uuid: String!) {\n  export_payload_config(uuid: $uuid) {\n      status\n      error \n      config \n  }\n}\n"])));function yc(e){var t=s.a.useState(!0),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],x=p[1],y=s.a.useState(!1),v=Object(u.a)(y,2),k=v[0],w=v[1],S=s.a.useState(!1),D=Object(u.a)(S,2),$=D[0],P=D[1],A=s.a.useState(!1),L=Object(u.a)(A,2),F=L[0],q=L[1],N=s.a.useState(!1),R=Object(u.a)(N,2),B=R[0],W=R[1],M=s.a.useState(!1),H=Object(u.a)(M,2),U=H[0],G=H[1],V=s.a.useState(!1),K=Object(u.a)(V,2),Q=K[0],J=K[1],X=Object(o.useRef)(null),te=Object(f.a)(h.b),ae=Object(ee.a)(),ne=Object(pe.a)(gc,{onCompleted:function(e){console.log(e),O.b.success("Successfully triggered rebuild")},onError:function(e){O.b.error("Failed to trigger rebuild: "+e)}}),ie=Object(u.a)(ne,1)[0],re=Object(pt.a)(xc,{fetchPolicy:"no-cache",onCompleted:function(t){if("success"===t.export_payload_config.status){var a=new Blob([t.export_payload_config.config],{type:"text/plain"}),n=document.getElementById("download_config");if(null!==n)n.href=URL.createObjectURL(a),n.download=e.filemetum.filename_text+".json",n.click();else{var i=document.createElement("a");i.id="download_config",i.href=URL.createObjectURL(a),i.download=e.filemetum.filename_text+".json",document.body.appendChild(i),i.click()}}else O.b.error("Failed to export configuration: "+t.export_payload_config.error)},onError:function(e){O.b.error("Failed to export configuration: "+e)}}),ce=Object(u.a)(re,1)[0],oe=[{name:"Rename File",click:function(){P(!0)}},{name:"Edit Description",click:function(){w(!0)}},{name:e.callback_alert?"Stop Alerting to New Callbacks":"Start Alerting to New Callbacks",click:function(){!function(){var t=e.id,a=e.callback_alert;e.onAlertChanged(t,!a)}()}},{name:"View Build Message/Stdout",click:function(){i(!1),q(!0)}},{name:"View Build Errors",click:function(){i(!0),q(!0)}},{name:"Trigger New Build",click:function(){ie({variables:{uuid:e.uuid}})}},{name:"Export Payload Config",click:function(){ce({variables:{uuid:e.uuid}})}},{name:"Generate Redirect Rules",click:function(){J(!0)}},{name:"Check Agent C2 Configuration",click:function(){G(!0)}}],se=function(e){X.current&&X.current.contains(e.target)||d(!1)};return s.a.useMemo((function(){return!e.deleted&&!e.auto_generated||(e.deleted&&e.showDeleted?!e.auto_generated||!(!e.auto_generated||!e.showAutoGenerated):!(!e.auto_generated||!e.showAutoGenerated)&&(!e.deleted||!(!e.deleted||!e.showDeleted)))}),[e.deleted,e.showDeleted,e.auto_generated,e.showAutoGenerated])?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:e.deleted?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(E.a,{size:"small",onClick:function(){x(!0)},style:{color:ae.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})}),m&&Object(g.jsx)(ha,{onClose:function(){x(!1)},onSubmit:function(){e.onDeletePayload(e.filemetum.id),x(!1)},open:m})]})}),Object(g.jsx)(C.a,{children:Object(Z.b)(e.creation_time,te.user.view_utc_time)}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(b.a,{ref:X,size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Actions"}),Object(g.jsx)(et.a,{open:l,anchorEl:X.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var a=t.TransitionProps,n=t.placement;return Object(g.jsx)(Xe.a,Object(_.a)(Object(_.a)({},a),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(g.jsx)(T.a,{variant:"outlined",style:{backgroundColor:"dark"===ae.palette.type?ae.palette.primary.dark:ae.palette.primary.light,color:"white"},children:Object(g.jsx)(Ze.a,{onClickAway:se,children:Object(g.jsx)(at.a,{id:"split-button-menu",children:oe.map((function(t,a){return Object(g.jsx)(tt.a,{onClick:function(e){return function(e,t){oe[t].click(),d(!1)}(0,a)},children:t.name},t.name+e.uuid)}))})})})}))}}),k?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:k,onClose:function(){w(!1)},innerDialog:Object(g.jsx)(Gr,{payload_id:e.id,onClose:function(){w(!1)}})}):null,$?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:$,onClose:function(){P(!1)},innerDialog:Object(g.jsx)(Jr,{payload_id:e.id,onClose:function(){P(!1)}})}):null,F?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:F,onClose:function(){q(!1)},innerDialog:Object(g.jsx)(Zr,{payload_id:e.id,viewError:n,onClose:function(){q(!1)}})}):null,U?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:U,onClose:function(){G(!1)},innerDialog:Object(g.jsx)(jc,{uuid:e.uuid,onClose:function(){G(!1)}})}):null,Q?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:Q,onClose:function(){J(!1)},innerDialog:Object(g.jsx)(fc,{uuid:e.uuid,onClose:function(){J(!1)}})}):null]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(dc,Object(_.a)({},e))}),Object(g.jsx)(C.a,{children:e.filemetum.filename_text}),Object(g.jsx)(C.a,{children:e.tag}),Object(g.jsx)(C.a,{children:Object(g.jsx)(ic,{payloadc2profiles:e.payloadc2profiles,uuid:e.uuid})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(E.a,{size:"small",color:"primary",onClick:function(){return W(!0)},children:Object(g.jsx)(fn.a,{})})})]},"payload"+e.uuid),Object(g.jsx)(I.a,{children:B?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:B,onClose:function(){W(!1)},innerDialog:Object(g.jsx)(bn,Object(_.a)(Object(_.a)({},e),{},{payload_id:e.id,onClose:function(){W(!1)}}))}):null})]}):null}var _c,vc,kc,wc,Cc,Sc=Object(be.a)(Oc||(Oc=Object(v.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function Dc(e){var t=s.a.useState({name:""}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(pe.a)(Sc,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?O.b.info("Submitted payload to build pipeline"):O.b.error(a.createPayload.error)}}),c=Object(u.a)(r,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Import Payload Config to Generate New Payload"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsxs)(b.a,{variant:"contained",component:"label",children:[""===n.name?"Select File":n.name,Object(g.jsx)("input",{onChange:function(e){var t=new FileReader;t.onload=function(t){var a=t.target.result;i({name:e.target.files[0].name,contents:a})},t.readAsBinaryString(e.target.files[0])},type:"file",hidden:!0})]})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:function(){c({variables:{payload:n.contents}}).catch((function(e){console.log(e)})),e.onClose()},color:"secondary",children:"Submit"})]})]})}function Ic(e){var t=e.payload,a=e.onDeletePayload,n=e.onUpdateCallbackAlert,i=Object(ee.a)(),r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState(!1),f=Object(u.a)(h,2),O=f[0],x=f[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(T.a,{elevation:5,style:{backgroundColor:i.pageHeader.main,color:i.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payloads"}),Object(g.jsx)(b.a,{size:"small",color:"primary",variant:"contained",style:{float:"right",marginTop:"10px",marginRight:"30px"},onClick:function(){l(!o)},children:o?"Hide Deleted":"Show Deleted"}),Object(g.jsx)(b.a,{size:"small",color:"primary",variant:"contained",style:{float:"right",marginTop:"10px",marginRight:"30px"},onClick:function(){m(!p)},children:p?"Hide AutoGenerated":"Show AutoGenerated"}),Object(g.jsx)(b.a,{size:"small",href:"/new/createpayload",style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"New Payload"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){return x(!0)},style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(g.jsx)(M.a,{}),color:"primary",variant:"contained",children:"Import Payload Config"}),O?Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:O,onClose:function(){x(!1)},innerDialog:Object(g.jsx)(Dc,{onClose:function(){x(!1)}})}):null]}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"4rem"},children:" Delete"}),Object(g.jsx)(C.a,{style:{width:"15rem"},children:"Timestamp"}),Object(g.jsx)(C.a,{style:{width:"6rem"},children:"Modify"}),Object(g.jsx)(C.a,{style:{width:"6rem"},children:"Download"}),Object(g.jsx)(C.a,{children:"File"}),Object(g.jsx)(C.a,{children:"Description"}),Object(g.jsx)(C.a,{children:"C2 Status"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Details"})]})}),Object(g.jsx)(w.a,{children:t.map((function(e){return Object(g.jsx)(yc,Object(_.a)({onDeletePayload:a,onAlertChanged:n,showDeleted:o,showAutoGenerated:p},e),"payload"+e.id)}))})]})})]})}var Tc=Object(be.a)(_c||(_c=Object(v.a)(["\nfragment payloadData on payload {\n  build_message\n  build_phase\n  build_stderr\n  callback_alert\n  creation_time\n  id\n  operator {\n    id\n    username\n  }\n  uuid\n  tag\n  deleted\n  auto_generated\n  payloadtype {\n    id\n    ptype\n  }\n  filemetum {\n    agent_file_id\n    filename_text\n    id\n  }\n  payloadc2profiles {\n    c2profile {\n      running\n      name\n      is_p2p\n      container_running\n    }\n  }\n}\n"]))),$c=Object(be.a)(vc||(vc=Object(v.a)(["\n","\nsubscription SubPayloadsQuery($operation_id: Int!) {\n  payload(where: { operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    ...payloadData\n  }\n}\n"])),Tc),Pc=Object(be.a)(kc||(kc=Object(v.a)(["\n","\nquery GetPayloadsQuery($operation_id: Int!) {\n  payload(where: { operation_id: {_eq: $operation_id}}, order_by: {id: desc}, limit: 20) {\n    ...payloadData\n  }\n}\n"])),Tc),Ac=Object(be.a)(wc||(wc=Object(v.a)(["\nmutation PayloadsDeletePayloadMutation($id: Int!) {\n  deleteFile(file_id: $id) {\n      file_ids\n      status\n      error\n      payload_ids\n  }\n}\n"]))),Ec=Object(be.a)(Cc||(Cc=Object(v.a)(["\nmutation PayloadsCallbackAlertMutation($id: Int!, $callback_alert: Boolean!) {\n  update_payload_by_pk(pk_columns: {id: $id}, _set: {callback_alert: $callback_alert}) {\n    id\n    callback_alert\n  }\n}\n"])));function Lc(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1];Object(je.a)(Pc,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",onCompleted:function(e){var t=e.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(_.a)({},t),Object(y.a)(e)):[t].concat(Object(y.a)(e))}),Object(y.a)(i));t.sort((function(e,t){return e.id>t.id?-1:1})),r(t)}}),Object(ze.a)($c,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",onSubscriptionData:function(e){var t=e.subscriptionData.data.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(_.a)({},t),Object(y.a)(e)):[t].concat(Object(y.a)(e))}),Object(y.a)(i));t.sort((function(e,t){return e.id>t.id?-1:1})),r(t)},onError:function(e){O.b.warning("Failed to get payloads"),console.log(e)}});var c=Object(pe.a)(Ac,{onCompleted:function(e){if("success"===e.deleteFile.status){var t=i.map((function(t){return e.deleteFile.payload_ids.includes(t.id)?Object(_.a)(Object(_.a)({},t),{},{deleted:!0}):Object(_.a)({},t)}));r(t),O.b.success("Successfully deleted")}else O.b.error(e.deleteFile.error)},onError:function(e){O.b.warning("Failed to delete payload"),console.log(e)}}),o=Object(u.a)(c,1)[0],l=Object(pe.a)(Ec,{onCompleted:function(e){var t=i.map((function(t){return t.id===e.update_payload_by_pk.id?Object(_.a)(Object(_.a)({},t),e.update_payload_by_pk):Object(_.a)({},t)}));e.update_payload_by_pk.callback_alert?O.b.success("Now Alerting on New Callbacks"):O.b.success("No Longer Alerting on New Callbacks"),r(t)},onError:function(e){O.b.warning("Failed to update callback alerting status"),console.log(e)}}),d=Object(u.a)(l,1)[0];return Object(g.jsx)("div",{style:{height:"calc(94vh)",maxHeight:"calc(94vh)",marginTop:"10px"},children:Object(g.jsx)(Ic,{onDeletePayload:function(e){o({variables:{id:e}})},onUpdateCallbackAlert:function(e,t){d({variables:{id:e,callback_alert:t}})},payload:i})})}var Fc=a(112),qc=a.n(Fc),Nc=a(297),Rc=a.n(Nc),Bc=a(167),zc=a.n(Bc),Wc=a(90),Mc=function(e,t,a,n,i,r){!function(e,t,a,n,i,r){Wc.select(".contextMenu").remove(),n.length>0&&(Wc.select(r).append("g").attr("class","contextMenu").selectAll("tmp").data(n).enter().append("g").attr("class","menuEntry").style({cursor:"pointer"}),Wc.selectAll(".menuEntry").append("rect").attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("rx",2).attr("fill","#ffffff").attr("width",180).attr("height",30).on("click",(function(t){t.action(e,i)})),Wc.selectAll(".menuEntry").append("text").text((function(e){return e.title})).attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("dy",20).attr("dx",10).on("click",(function(t){t.action(e,i)})),Wc.select("body").on("click",(function(){Wc.select(".contextMenu").remove(),Wc.select(".menuEntry").remove()})))}(e,Wc.event.pageX,Wc.event.pageY-80,a,t,r),Wc.event.preventDefault()},Hc=a(321),Uc=a.n(Hc);function Gc(e){var t=Object(o.useRef)(null),a=Object(o.useState)(!0),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(ee.a)();return Object(o.useEffect)((function(){Kc(e.callbackgraphedges,t,i,{rankDir:"LR",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!0},{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[]},c),r(!1)}),[e.callbackgraphedges,i,c]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{id:"form-dialog-title",children:["Callback ",e.id,"'s Egress Path"]}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)("svg",{ref:t,id:"nodeTree",style:{width:"100%",height:"calc(78vh)",marginTop:"10px"}})})}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Vc,Kc=function(e,t,a,n,i,r){var c,o="stroke: ".concat(r.palette.warning.main,"; stroke-width: 3px; stroke-dasharray: 5, 5; fill:none"),s="fill: ".concat(r.palette.warning.main),l="stroke: ".concat(r.palette.info.main,"; fill: none; stroke-width: 1.5px;"),d="stroke: ".concat(r.palette.info.main,"; fill: ").concat(r.palette.info.main,"; stroke-width: 1.5px;"),u="fill: ".concat(r.palette.success.main,","),b='labelStyle: "font-size: 2em"; fill: '.concat(r.palette.text.primary),j='labelStyle: "font-size: 2em"; fill: '.concat(r.palette.text.primary),p=function(e,t,a){(t.source.active||a.show_all_nodes)&&(m(e,t.source,a),e.setEdge(t.source.id,"Mythic",{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name))},m=function(e,t,a){e.setNode(t.id,{label:h(t,a.label_components),node:t,style:u,labelStyle:b,shape:"circle",isParent:!1}),e.setNode(t.host,{label:t.host,clusterLabelPos:"top",style:"fill:".concat(r.palette.graphGroup),node:null,labelStyle:b,isParent:!0}),e.setParent(t.id,t.host),e.setNode(t.host+"mythic_expander",{label:"",shape:"square",node:t,isParent:!1}),e.setParent(t.host+"mythic_expander",t.host)},h=function(e,t){return t.map((function(t){return e[t]})).join(", ")},f=function(e,t,a){if(t.source.active||t.destination.active||a.show_all_nodes){if(a.show_all_nodes)m(e,t.source,a),m(e,t.destination,a);else if(t.source.active&&m(e,t.source,a),t.destination.active&&m(e,t.destination,a),!t.source.active||!t.destination.active)return;1===t.direction?a.packet_flow_view?O(e,t,2):O(e,t,1):(2===t.direction||O(e,t,1),O(e,t,2))}},O=function(e,t,a){1===a?e.setEdge(t.source.id,t.destination.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name):2===a&&e.setEdge(t.destination.id,t.source.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name)},g=new Uc.a.graphlib.Graph({compound:!0,multigraph:!0,directed:!0}).setGraph({rankdir:n.rankDir}).setDefaultEdgeLabel((function(){return{}})),x=Wc.select(t.current),y=x.select("g")._groups[0][0];c=y?x.select("g"):x.append("g");var _=Wc.zoom().on("zoom",(function(){c.attr("transform",Wc.event.transform)}));a&&(x.select("g.output").remove(),x.call(_)),g.setNode("Mythic",{label:"",style:u,shape:"circle",node:null,labelStyle:b}),e.forEach((function(e){(n.include_disconnected||null===e.end_timestamp)&&(e.destination.id===e.source.id?g.hasEdge(e.source.id,"Mythic",e.c2profile.name)?e.id>g.edge(e.source.id,"Mythic",e.c2profile.name).edge_id&&p(g,e,n):p(g,e,n):1===e.direction?n.packet_flow_view?g.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>g.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(g,e,n):f(g,e,n):g.hasEdge(e.source.id,e.destination.id,e.c2profile.name)?e.id>g.edge(e.source.id,e.destination.id,e.c2profile.name).edge_id?f(g,e,n):console.log("doing nothing, dropping data"):f(g,e,n):2===e.direction&&(g.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>g.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(g,e,n):f(g,e,n)))}));var v=new Uc.a.render,k=x.node().getBoundingClientRect().width,w=x.node().getBoundingClientRect().height;if(v.shapes().circle=function(e,t,a){var n=e.insert("image").attr("class","nodeImage").attr("xlink:href",(function(e){return a.node?"/static/"+a.node.payload.payloadtype.ptype+".svg":"/static/mythic.svg"})).attr("x","-20px").attr("y","-20px").attr("width","40px").attr("height","40px").on("mouseover",(function(t){i.mouseover(e,a,t)})).on("mouseout",(function(t){i.mouseout(e,a,t)})).on("click",(function(t){Wc.event.preventDefault(),i.click(e,a,t)})).on("contextmenu",(function(e){Mc(g,a,i.contextmenu,0,0,"#callbacksgraph")}));return a.intersect=function(e){return Uc.a.intersect.circle(a,20,e)},n},v.shapes().square=function(e,t,a){return e.insert("rect").attr("width",(function(e){var t=g.children(a.node.host),i=a.node.host.length;if(void 0!==t&&t.forEach((function(e){g.node(e).label.length>i&&(i=g.node(e).label.length)})),"LR"===n.rankDir)return 9*i+"px";if(void 0!==t){var r=0;return t.forEach((function(e){g.outEdges(e,"Mythic").length>0&&(r+=1)})),(i=9*i-100*r)<0?0:i+"px"}console.log("candidates were undefined")})).attr("height",0)},v(c,g),a){var C=g.graph().width+40,S=g.graph().height+40,D=Math.min(k/C,w/S),I=k/2-C*D/2,T=w/2-S*D/2;x.transition().duration(500).call(_.transform,Wc.zoomIdentity.translate(I,T).scale(D))}c.selectAll("g.nodes g.label").attr("transform","translate(0,30)")},Qc=Object(be.a)(Vc||(Vc=Object(v.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function Jc(e){var t=Object(ee.a)();return Object(g.jsxs)("div",{style:{maxWidth:"30%",width:"30%",display:"inline-flex",height:"calc(94vh)",flexDirection:"column"},children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsxs)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:["Callback ",e.callback.id]})}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsx)(Yc,Object(_.a)({},e.callback))})]})}function Yc(e){s.a.useRef(null);var t=Object(ee.a)(),a=Object(f.a)(h.b),n=s.a.useState(""),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState(!1),d=Object(u.a)(l,2),b=d[0],j=d[1],p=s.a.useState(t.palette.success.main),m=Object(u.a)(p,2),O=m[0],x=m[1],v=s.a.useState(!0),S=Object(u.a)(v,2),D=S[0],T=S[1],$=s.a.useState(!1),P=Object(u.a)($,2),A=P[0],E=P[1],F=s.a.useState([]),q=Object(u.a)(F,2),N=q[0],R=q[1],B=s.a.useState([]),z=Object(u.a)(B,2),W=z[0],M=z[1],H=s.a.useState(!0),U=Object(u.a)(H,2),G=U[0],V=U[1],K=s.a.useState([]),Q=Object(u.a)(K,2),J=Q[0],X=Q[1];Object(ze.a)(Qc,{variables:{operation_id:a.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;X(t.data.callbackgraphedge)}});Object(Z.c)((function(){var t;t=e.last_checkin,c(Object(Z.a)(t))})),Object(o.useEffect)((function(){var t=W.filter((function(t){return!t.c2profile.is_p2p&&t.source.id===e.id&&t.destination.id===e.id})).length;t>0&&!G?V(!0):0===t&&G&&V(!1)}),[W]),Object(o.useEffect)((function(){var t=function(t){for(var a=J.filter((function(a){return(a.source.id===e.id||a.destination.id===e.id)&&(!t||null===a.end_timestamp)})),n=!0;n;){var i=J.reduce((function(e,a){return e.includes(a)?Object(y.a)(e):e.filter((function(e){return(e.source.id===a.source.id||e.source.id===a.destination.id||e.destination.id===a.source.id)&&(!t||null===a.end_timestamp)})).length>0?[].concat(Object(y.a)(e),[a]):Object(y.a)(e)}),Object(y.a)(a));n=i.length>a,a=Object(y.a)(i)}return a},a=t(!0),n=t(!1);R(a),M(n)}),[J,e.id]),Object(o.useEffect)((function(){0===N.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(x(t.palette.error.main),T(!1)):(x(t.palette.success.main),T(!0))}),[N,t.palette.success.main,t.palette.error.main]);e.locked&&e.locked_operator.username,e.locked?zc.a:qc.a,vi.a;return Object(g.jsx)(k.a,{size:"small",style:{overflow:"scroll"},children:Object(g.jsxs)(w.a,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Elevation Level"}),Object(g.jsxs)(C.a,{children:[e.integrity_level,e.integrity_level>2?" ( Elevated Access )":"",2===e.integrity_level?" ( Medium Integrity ) ":"",e.integrity_level<2?" ( Low Integrity )":""]})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Callback Lock Status"}),Object(g.jsx)(C.a,{children:e.locked?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(zc.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(g.jsx)(L.a,{style:{display:"inline-block"},children:"Unlock (Locked by "+e.locked_operator.username+")"})]}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(qc.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(g.jsx)(L.a,{style:{display:"inline-block"},children:"Lock Callback"})]})})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"IP Address"}),Object(g.jsx)(C.a,{children:e.ip})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"External IP"}),Object(g.jsx)(C.a,{children:e.external_ip})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:e.host})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"User"}),Object(g.jsx)(C.a,{children:e.user})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Domain"}),Object(g.jsx)(C.a,{children:e.domain})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"OS / Architecture"}),Object(g.jsxs)(C.a,{children:[e.os,"(",e.architecture,")"]})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Process ID"}),Object(g.jsx)(C.a,{children:e.pid})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Last Checkin"}),Object(g.jsx)(C.a,{children:r})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Description"}),Object(g.jsx)(C.a,{children:e.description})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Sleep Info"}),Object(g.jsx)(C.a,{children:e.sleep_info})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Agent Type"}),Object(g.jsx)(C.a,{children:e.payload.payloadtype.ptype})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Egress Route"}),Object(g.jsx)(C.a,{children:G?Object(g.jsx)(Ke.a,{onClick:function(e){e.stopPropagation(),E(!0)},style:{color:O,cursor:"pointer"}}):Object(g.jsx)(Rc.a,{onClick:function(e){e.stopPropagation(),E(!0)},style:{color:O,cursor:"pointer"}})})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Process Name"}),Object(g.jsx)(C.a,{children:e.process_name})]}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:A,onClose:function(){E(!1)},innerDialog:Object(g.jsx)(Gc,Object(_.a)(Object(_.a)({onClose:function(){E(!1)}},e),{},{callbackgraphedges:D?N:W}))}),Object(g.jsx)(Y.a,{fullWidth:!0,open:b,onClose:function(){j(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Callback's Description",onClose:function(){j(!1)},value:e.description,onSubmit:function(t){e.updateDescription({description:t,id:e.id})}})}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Extra Info"}),Object(g.jsx)(C.a,{children:e.extra_info})]})]})})}var Zc,Xc=a(92),eo=Object(be.a)(Zc||(Zc=Object(v.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    last_checkin\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n    callbacktokens(where: {deleted: {_eq: false}}) {\n      token {\n        TokenId\n        id\n        User\n        description\n      }\n      callback {\n        id\n      }\n      id\n    }\n  }\n}\n "])));function to(e){var t=Object(m.g)().callbackId,a=s.a.useState({payload:{payloadtype:{ptype:""}},callbacktokens:[]}),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState({callbackID:parseInt(t)}),o=Object(u.a)(c,2),l=o[0],d=o[1];return Object(ze.a)(eo,{variables:{callback_id:t},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var a=e.subscriptionData;null!==a.data.callback_by_pk?(r(a.data.callback_by_pk),d({tabID:"interact",tabType:"interact",callbackID:parseInt(t),payloadtype:a.data.callback_by_pk.payload.payloadtype.ptype,payloadDescription:a.data.callback_by_pk.payload.tag,callbackDescription:a.data.callback_by_pk.description,os:a.data.callback_by_pk.payload.os})):O.b.error("Unknown Callback")}}),Object(g.jsx)("div",{style:{width:"100%",height:"100%",maxHeight:"100%",display:"flex",flexDirection:"row"},children:void 0!==l.payloadtype?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Jc,{callback:i}),Object(g.jsx)(Xc.b,{style:{height:"calc(".concat(96,"vh)"),maxHeight:"calc(".concat(96,"vh)"),width:"69%",maxWidth:"69%",position:"absolute",overflow:"auto",display:"inline-flex",flexDirection:"column"},tabInfo:l,callbacktokens:i.callbacktokens})]}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"Fetching Callback"})})}var ao=a(319),no=a(867),io=Object(Se.a)((function(e){return{root:{width:"100%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:ao.a[500]}}}));function ro(){var e=io(),t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(g.jsxs)(Ie.a,{className:e.root,elevation:5,children:[Object(g.jsx)(va.a,{avatar:Object(g.jsx)(An.a,{className:e.avatar}),title:"Mythic Quick Start Guide",subheader:"Expand this section to learn how to: Generate a Payload, Download the Payload, Get To Callbacks",style:{paddingBottom:0,marginBottom:0}}),Object(g.jsx)(Ra.a,{styl:{padding:0,margin:0},children:Object(g.jsx)(E.a,{className:Object(Na.default)(e.expand,Object(jt.a)({},e.expandOpen,n)),onClick:function(){i(!n)},"aria-expanded":n,"aria-label":"show more",children:Object(g.jsx)(Ma.a,{})})}),Object(g.jsx)(A.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(g.jsx)($e.a,{style:{margin:0,paddingTop:0},children:Object(g.jsxs)("ol",{children:[Object(g.jsxs)("li",{children:["Create a payload at ",Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/createpayload",children:"Create -> Create Payload"}),Object(g.jsxs)("ul",{children:[Object(g.jsx)("li",{children:"Select Desired OS"}),Object(g.jsx)("li",{children:"Select Payload Type and Supply Build Parameters"}),Object(g.jsx)("li",{children:"Select Commands You Want Stamped Into The Agent"}),Object(g.jsx)("li",{children:"Select C2 Profiles and Fill Out Parameters"}),Object(g.jsx)("li",{children:"Name Your Payload"}),Object(g.jsx)("li",{children:"Provide a Description"}),Object(g.jsx)("li",{children:"Build Your Payload"})]})]}),Object(g.jsxs)("li",{children:["Download Your Payload at ",Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/payloads",children:"Operational Data -> Payloads"})]}),Object(g.jsxs)("li",{children:["Run Your payload",Object(g.jsx)("ul",{children:Object(g.jsxs)("li",{children:["For More Information About Your Agent, Check Out The ",Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/docs/agents",children:"Internal Documentation"})]})})]}),Object(g.jsxs)("li",{children:["Interact With Your Agent At ",Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks",children:"Active Callbacks"})]})]})})})]})}var co,oo=a(250),so=Object(be.a)(co||(co=Object(v.a)(["\nquery GetC2AndPayloadType {\n  c2profile(where: {deleted: {_eq: false}}) {\n    name\n    id\n  }\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    id\n    payloadtypec2profiles {\n      c2profile {\n        name\n        id\n      }\n    }\n  }\n  wrappers: payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n      }\n    }\n  }\n}\n"])));function lo(e){var t=Object(ee.a)(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],b=s.a.useState([]),j=Object(u.a)(b,2),p=j[0],m=j[1];return Object(je.a)(so,{fetchPolicy:"network-only",onCompleted:function(e){var t=e.c2profile.map((function(e){return e.name})),a=e.payloadtype.map((function(e){var t=e.payloadtypec2profiles.map((function(e){return e.c2profile.name}));return{ptype:e.ptype,payloadtypec2profiles:t}}));t.sort(),a.sort((function(e,t){return e.ptype<t.ptype?-1:1}));var n=e.wrappers.map((function(e){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));return{ptype:e.ptype,wrapped:t}}));n.sort((function(e,t){return e.ptype<t.ptype?-1:1})),m(n),r(t),d(a)},onError:function(e){}}).loading?Object(g.jsx)(Ae.a,{}):Object(g.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Agent / C2 Overview"})}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{}),i.map((function(e){return Object(g.jsx)(C.a,{children:e},e)}))]})}),Object(g.jsx)(w.a,{children:l.map((function(e){return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:e.ptype}),i.map((function(a){return Object(g.jsx)(C.a,{children:e.payloadtypec2profiles.includes(a)?Object(g.jsx)(oo.a,{title:e.ptype+" supports "+a,children:Object(g.jsx)(Ua.a,{style:{color:t.palette.success.main}})}):""},"payload"+a)}))]},e.ptype)}))})]})}),p.length>0&&Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{marginTop:"10px"},children:Object(g.jsxs)(k.a,{size:"small",children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{}),l.map((function(e){return Object(g.jsx)(C.a,{children:e.ptype},"wrapped"+e.ptype)}))]})}),Object(g.jsx)(w.a,{children:p.map((function(e){return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:e.ptype}),l.map((function(a){return Object(g.jsx)(C.a,{children:e.wrapped.includes(a.ptype)?Object(g.jsx)(oo.a,{title:e.ptype+" wraps "+a.ptype,children:Object(g.jsx)(Ua.a,{style:{color:t.palette.success.main}})}):""},"payload"+a.ptype)}))]},"wrapper"+e.ptype)}))})]})})]})}function uo(){var e=Object(ee.a)();return Object(g.jsxs)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:e.pageHeader.main,color:e.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Welcome To Mythic"})}),Object(g.jsx)(ro,{}),Object(g.jsx)(lo,{})]})}var bo=a(93),jo=["component"];function po(e){var t=e.component,a=Object(bo.a)(e,jo),n=Object(f.a)(h.b);return Object(g.jsx)(m.b,Object(_.a)(Object(_.a)({},a),{},{render:function(e){return n.loggedIn&&n.user?s.a.createElement(t,e):Object(g.jsx)(m.a,{to:{pathname:"/new/login",state:{from:e.location}}})}}))}var mo=a(933),ho=a(941),fo=a(50),Oo=a(142),go=a(509),xo=a.n(go),yo=a(309),_o=a.n(yo),vo=a(311),ko=a.n(vo),wo=a(139),Co=a(28),So=a(508),Do=a.n(So),Io=a(306),To=a.n(Io),$o=a(507),Po=a.n($o),Ao=a(305),Eo=a.n(Ao),Lo=a(210),Fo=a.n(Lo),qo=["onSelectNode","onExpandNode","onCollapseNode"],No=Object(Se.a)((function(e){return{rowContainer:{},row:{display:"flex",alignItems:"left",marginLeft:function(t){return e.spacing(3*t.depth)},userSelect:"none",whiteSpace:"nowrap"},rowButtonWrapper:{width:e.spacing(3),textAlign:"center","&:hover":{cursor:"pointer",textDecoration:"underline"}},rowButton:{width:e.spacing(3)},rowLabel:{marginLeft:e.spacing(.5)},heading:{fontSize:e.typography.pxToRem(15),whiteSpace:"pre-line"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"calc(90vw)",whiteSpace:"break-word"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),Ro=function(e){var t=e.data,a=e.isOpen,n=e.onClickButton,i=e.handleOnClickRow,r=Object(ee.a)();return Object(g.jsxs)("div",{style:{display:"flex",marginBottom:"2px",flexGrow:1,width:"100%"},children:[Object(y.a)(Array(t.depth)).map((function(e,a){return Object(g.jsx)("div",{style:{borderLeft:"2px dashed ".concat(Object(Co.c)(r.palette.text.primary,.4)),marginLeft:15,paddingRight:15,display:"inline-block"}},"folder"+t.id+"lines"+a)})),Object(g.jsx)(Bo,{filebrowserobj:t,isOpen:a,onClickButton:n,handleOnClickRow:i})]})},Bo=function(e){var t=No(),a=Object(ee.a)();return Object(g.jsxs)("div",{className:t.root,style:{backgroundColor:a.body,color:a.text,alignItems:"center",display:"flex",paddingRight:"10px"},onClick:e.handleOnClickRow,children:[null===e.filebrowserobj.parent_id?Object(g.jsx)(Po.a,{style:{marginLeft:"3px",marginRight:"5px"},onClick:e.onClickButton}):e.filebrowserobj.is_file?Object(g.jsx)(Eo.a,{style:{marginLeft:"3px",marginRight:"5px"}}):e.isOpen?Object(g.jsx)(To.a,{style:{marginLeft:"3px",marginRight:"5px",color:a.folderColor},onClick:e.onClickButton}):Object(g.jsx)(Do.a,{style:{paddingTop:"5px",marginLeft:"3px",marginRight:"5px",color:a.folderColor},onClick:e.onClickButton}),e.filebrowserobj.depth>0&&e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>99?Object(g.jsx)(oo.a,{title:"Number of known children",children:Object(g.jsx)(Pe.a,{style:{left:-50},max:99,badgeContent:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count,color:"primary",anchorOrigin:{vertical:"bottom",horizontal:"left"}})}):null,Object(g.jsx)(L.a,{style:{color:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>0||null!==e.filebrowserobj.success?a.palette.text.primary:a.palette.text.secondary},children:null===e.filebrowserobj.parent_id?e.filebrowserobj.host:e.filebrowserobj.name_text}),!0===e.filebrowserobj.success&&e.filebrowserobj.depth>0?Object(g.jsx)(oo.a,{title:"Successfully listed contents of folder",children:Object(g.jsx)(Ua.a,{fontSize:"small",style:{color:a.palette.success.main}})}):!1===e.filebrowserobj.success&&e.filebrowserobj.depth>0?Object(g.jsx)(oo.a,{title:"Failed to list contents of folder",children:Object(g.jsx)(Fo.a,{fontSize:"small",style:{color:a.palette.error.main}})}):null]})},zo=function(e){var t=e.onSelectNode,a=e.onExpandNode,n=e.onCollapseNode,i=Object(bo.a)(e,qo),r=i.data[i.index];return Object(g.jsx)(Ro,{data:r.data,handleOnClickRow:function(e){t(r.id,r)},onClickButton:function(e){e.stopPropagation(),r.isOpen?n(r.id,r):(O.b.info("fetching elements...",{persist:!0}),a(r.id,r))},isOpen:r.isOpen})},Wo=function(e){var t=e.nodes,a=e.openNodes,n=e.onSelectNode,i=e.onExpandNode,r=e.onCollapseNode,c=e.display_name,s=Object(o.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 0===t||!0===a[e.id]?[{id:e.id,name:e[c],depth:t,isLeaf:!Array.isArray(e.children)||0===e.children.length,isOpen:!0,data:Object(_.a)(Object(_.a)({},e),{},{depth:t})}].concat(Object(y.a)(Object.values(e.children).reduce((function(e,a){return a.is_file?Object(y.a)(e):[].concat(Object(y.a)(e),[s(a,t+1)])}),[]).flat())):[{id:e.id,name:e[c],depth:t,isLeaf:!Array.isArray(e.children)||0===e.children.length,isOpen:!1,data:Object(_.a)(Object(_.a)({},e),{},{depth:t})}]}),[a]),l=Object(o.useMemo)((function(){return t.map((function(e){return s(e)})).flat()}),[s,t]);return Object(g.jsx)(ai.a,{children:function(e){return Object(g.jsx)(ti.a,{itemData:l,direction:"vertical",height:e.height-10,width:e.width-10,itemCount:l.length,itemSize:24,children:function(e){return Object(g.jsx)(zo,Object(_.a)(Object(_.a)({},e),{},{onSelectNode:n,onExpandNode:i,onCollapseNode:r}))}})}})},Mo=function(e){var t=e.treeRoot,a=e.fetchFolderData,n=e.setTableData,i=s.a.useState({}),r=Object(u.a)(i,2),c=r[0],o=r[1];return 0===t.length?Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No File Browser Data Collected"}):Object(g.jsx)(Wo,{nodes:t,display_name:"name_text",openNodes:c,onSelectNode:function(e,t){n(t.data),console.log("onSelectNode",e,t)},onExpandNode:function(e,t){console.log("toggleNodeExpanded",e,t),n(t.data),a(t.data),o(Object(_.a)(Object(_.a)({},c),{},Object(jt.a)({},e,!0)))},onCollapseNode:function(e,t){o(Object(_.a)(Object(_.a)({},c),{},Object(jt.a)({},e,!1)))}})};function Ho(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){i(e.value)}),[e.value]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Download"}),Object(g.jsx)(C.a,{children:"Time"}),Object(g.jsx)(C.a,{children:"Task"}),Object(g.jsx)(C.a,{children:"Comment"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:e.complete?Object(g.jsx)(E.a,{href:"/api/v1.4/files/download/"+e.agent_file_id,style:{color:r.palette.success.main},children:Object(g.jsx)(oc.a,{})}):e.chunks_received+"/"+e.total_chunks}),Object(g.jsx)(C.a,{children:e.timestamp}),Object(g.jsx)(C.a,{children:e.task.id}),Object(g.jsx)(C.a,{children:e.comment})]},"hist"+e.id)}))})]})})})}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Uo,Go,Vo,Ko,Qo,Jo,Yo,Zo,Xo,es,ts=a(307),as=a.n(ts),ns=a(189),is=a.n(ns),rs=a(308),cs=a.n(rs),os=(a(355),a(302)),ss=a.n(os),ls=a(166),ds=a(317),us=Object(be.a)(Uo||(Uo=Object(v.a)(["\n    query getPermissionsQuery($filebrowserobj_id: Int!) {\n        filebrowserobj_by_pk(id: $filebrowserobj_id) {\n            id\n            permissions\n        }\n    }\n"]))),bs=Object(be.a)(Go||(Go=Object(v.a)(["\n    query getFileDownloadHistory($filebrowserobj_id: Int!) {\n        filebrowserobj_by_pk(id: $filebrowserobj_id) {\n            filemeta {\n                id\n                comment\n                agent_file_id\n                chunks_received\n                complete\n                total_chunks\n                timestamp\n                task {\n                    id\n                    comment\n                }\n            }\n        }\n    }\n"]))),js=Object(be.a)(Vo||(Vo=Object(v.a)(["\n    mutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!) {\n        update_filebrowserobj_by_pk(pk_columns: { id: $filebrowserobj_id }, _set: { comment: $comment }) {\n            comment\n            id\n        }\n    }\n"]))),ps=[{name:"Actions",width:100,disableAutosize:!0,disableSort:!0},{name:"Name",type:"string",key:"name_text",fillWidth:!0},{name:"Size",type:"number",key:"size",width:200},{name:"Last Modified",type:"date",key:"modify_time",width:200},{name:"Comment",type:"string",key:"comment",width:200}],ms=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(null),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState(null),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState(null),f=Object(u.a)(h,2),x=f[0],_=f[1],v=s.a.useMemo((function(){if(null===p||null===x)return n;var e=Object(y.a)(n);return"number"===x||"size"===x||"date"===x?e.sort((function(e,t){return parseInt(e[p])>parseInt(t[p])?1:-1})):"string"===x&&e.sort((function(e,t){return e[p].toLowerCase()>t[p].toLowerCase()?1:-1})),"DESC"===l&&e.reverse(),e}),[n,p,x,l]),k=s.a.useMemo((function(){return v.map((function(t){return[Object(g.jsx)(xs,{rowData:t,onTaskRowAction:e.onTaskRowAction}),Object(g.jsx)(hs,{rowData:t,cellData:t.name_text}),gs({cellData:t.size}),Os({cellData:t.modify_time}),fs({cellData:t.comment})]}))}),[v,e.onTaskRowAction]);Object(o.useEffect)((function(){if(e.showDeletedFiles)i(Object(y.a)(e.selectedFolder));else{var t=e.selectedFolder.filter((function(e){return!e.deleted}));i(Object(y.a)(t))}}),[e.selectedFolder,e.showDeletedFiles]);var w=ps.findIndex((function(e){return e.key===p}));return Object(g.jsx)("div",{style:{width:"100%",height:"100%"},children:Object(g.jsx)(ds.a,{columns:ps,sortIndicatorIndex:w,sortDirection:l,items:k,rowHeight:35,onClickHeader:function(e,t){var a=ps[t];a.disableSort||(a.key||(m(null),_(null),d("ASC")),p===a.key?"ASC"===l?d("DESC"):(m(null),_(null),d("ASC")):(d("ASC"),m(a.key),_(a.type)))},onDoubleClickRow:function(t,a){var i=n[a];i.is_file||(O.b.info("Fetching contents of folder..."),e.onRowDoubleClick(i),m(null),_(null),d("ASC"))}})})},hs=function(e){var t=e.cellData,a=e.rowData,n=Object(ee.a)();return Object(g.jsxs)("div",{style:{alignItems:"center",display:"flex",textDecoration:a.deleted?"line-through":""},children:[a.is_file?Object(g.jsx)(Eo.a,{style:{marginRight:"5px"}}):Object(g.jsx)(To.a,{style:{marginRight:"5px",color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.folderColor:"grey"}}),a.filemeta.length>0?Object(g.jsx)(oc.a,{style:{color:n.palette.success.main}}):null,Object(g.jsx)("pre",{style:{color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.palette.text.primary:n.palette.text.secondary},children:t}),!0===a.success?Object(g.jsx)(oo.a,{title:"Successfully listed contents of folder",children:Object(g.jsx)(Ua.a,{fontSize:"small",style:{color:n.palette.success.main}})}):!1===a.success?Object(g.jsx)(oo.a,{title:"Failed to list contents of folder",children:Object(g.jsx)(Fo.a,{fontSize:"small",style:{color:n.palette.error.main}})}):null]})},fs=function(e){return e.cellData},Os=function(e){var t=e.cellData;return""===t||t<=0?t:new Date(parseInt(t)).toISOString()},gs=function(e){var t=e.cellData;return function(){try{var e=parseInt(t);if(""===t)return"";if(0===e)return"0 B";var a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}catch(n){return t}}()},xs=function(e){var t=e.rowData,a=e.onTaskRowAction,n=s.a.useRef(null),i=Object(ee.a)(),r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState(!1),f=Object(u.a)(h,2),x=f[0],y=f[1],v=s.a.useState(!1),k=Object(u.a)(v,2),w=k[0],C=k[1],S=s.a.useState(""),D=Object(u.a)(S,2),I=D[0],$=D[1],P=s.a.useState([]),A=Object(u.a)(P,2),E=A[0],L=A[1],F=Object(pt.a)(us,{onCompleted:function(e){$(e.filebrowserobj_by_pk.permissions),""!==e.filebrowserobj_by_pk.permissions?y(!0):O.b.warning("No permission data available")},fetchPolicy:"network-only"}),q=Object(u.a)(F,1)[0],N=Object(pt.a)(bs,{onCompleted:function(e){0===e.filebrowserobj_by_pk.filemeta.length?O.b.warning("File has no download history"):(L(e.filebrowserobj_by_pk.filemeta),C(!0))},fetchPolicy:"network-only"}),R=Object(u.a)(N,1)[0],B=Object(pe.a)(js,{onCompleted:function(e){O.b.success("updated comment")}}),W=Object(u.a)(B,1)[0],M=function(e,t,a){switch(e){case"A":U[a].click(t);break;case"B":G[a].click(t)}l(!1)},H=function(e){n.current&&n.current.contains(e.target)||l(!1)},U=[{name:"View Permissions",icon:Object(g.jsx)(is.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),q({variables:{filebrowserobj_id:t.id}})}},{name:"Download History",icon:Object(g.jsx)(as.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),R({variables:{filebrowserobj_id:t.id}})}},{name:"Edit Comment",icon:Object(g.jsx)(vi.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),m(!0)}},{name:"Copy Path to Clipboard",icon:Object(g.jsx)(ss.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),Object(ls.a)(t.full_path_text)?O.b.success("Copied text!"):O.b.error("Failed to copy text")}}],G=[{name:"Task File Listing",icon:Object(g.jsx)(cs.a,{style:{paddingRight:"5px",color:i.palette.warning.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:list"})}},{name:"Task Download",icon:Object(g.jsx)(oc.a,{style:{paddingRight:"5px",color:i.palette.success.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:download"})}},{name:"Task File Removal",icon:Object(g.jsx)(z.a,{style:{paddingRight:"5px",color:i.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:remove"})}}];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{style:{},size:"small","aria-controls":o?"split-button-menu":void 0,"aria-expanded":o?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),l((function(e){return!e}))},color:"primary",variant:"contained",ref:n,children:"Actions"}),Object(g.jsx)(et.a,{open:o,anchorEl:n.current,role:void 0,transition:!0,style:{zIndex:4e3},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(g.jsx)(Xe.a,Object(_.a)(Object(_.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(g.jsx)(T.a,{style:{backgroundColor:"dark"===i.palette.type?i.palette.primary.dark:i.palette.primary.light,color:"white"},children:Object(g.jsx)(Ze.a,{onClickAway:H,children:Object(g.jsxs)(at.a,{id:"split-button-menu",children:[U.map((function(e,t){return Object(g.jsxs)(tt.a,{onClick:function(e){return M("A",e,t)},children:[e.icon,e.name]},e.name)})),Object(g.jsx)(ka.a,{}),G.map((function(e,t){return Object(g.jsxs)(tt.a,{onClick:function(e){return M("B",e,t)},children:[e.icon,e.name]},e.name)}))]})})})}))}}),p&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit File Browser Comment",onSubmit:function(e){W({variables:{filebrowserobj_id:t.id,comment:e}})},value:t.comment,onClose:function(){m(!1)}})}),x&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:x,onClose:function(){y(!1)},innerDialog:Object(g.jsx)(Y.c,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:I,onClose:function(){y(!1)}})}),w&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:w,onClose:function(){C(!1)},innerDialog:Object(g.jsx)(Ho,{title:"Download History",value:E,onClose:function(){C(!1)}})})]})},ys=a(310),_s=a.n(ys),vs=a(375),ks=Object(be.a)(Ko||(Ko=Object(v.a)(["\n    fragment fileObjData on filebrowserobj {\n        access_time\n        comment\n        deleted\n        filemeta {\n            id\n        }\n        host\n        id\n        is_file\n        modify_time\n        parent_id\n        size\n        success\n        task {\n            callback {\n                id\n            }\n            operator {\n                id\n            }\n        }\n        full_path_text\n        name_text\n        timestamp\n        parent_path_text\n        filebrowserobjs_aggregate {\n            aggregate {\n                count\n            }\n        }\n    }\n"]))),ws=Object(be.a)(Qo||(Qo=Object(v.a)(["\n    ","\n    query myRootFolderQuery($operation_id: Int!) {\n        filebrowserobj(where: { operation_id: { _eq: $operation_id }, parent_id: { _is_null: true } }) {\n            ...fileObjData\n        }\n    }\n"])),ks),Cs=Object(be.a)(Jo||(Jo=Object(v.a)(["\n    ","\n    query myFolderQuery($filebrowserobj_id: Int!, $operation_id: Int!) {\n        filebrowserobj(\n            where: { parent_id: { _eq: $filebrowserobj_id }, operation_id: { _eq: $operation_id } }\n            order_by: { is_file: asc, name: asc }\n        ) {\n            ...fileObjData\n        }\n    }\n"])),ks),Ss=Object(be.a)(Yo||(Yo=Object(v.a)(["\n    ","\n    subscription liveData($now: timestamp!, $operation_id: Int!) {\n        filebrowserobj(\n            distinct_on: id\n            order_by: { id: desc }\n            where: { timestamp: { _gt: $now }, operation_id: { _eq: $operation_id } }\n            limit: 1\n        ) {\n            ...fileObjData\n        }\n    }\n"])),ks),Ds=Object(be.a)(Zo||(Zo=Object(v.a)(["\n    ","\n    query myDeltaFilesQuery($lastTime: timestamp!, $now: timestamp!, $operation_id: Int!) {\n        filebrowserobj(\n            distinct_on: id\n            order_by: { id: desc }\n            where: {\n                _and: [{ timestamp: { _gte: $lastTime } }, { timestamp: { _lte: $now } }]\n                operation_id: { _eq: $operation_id }\n            }\n        ) {\n            ...fileObjData\n        }\n    }\n"])),ks),Is=Object(be.a)(Xo||(Xo=Object(v.a)(["\n    query GetLoadedCommandsQuery($callback_id: Int!, $payloadtype: String!, $ui_feature: String!) {\n        loadedcommands(\n            where: { callback_id: { _eq: $callback_id }, command: { supported_ui_features: { _iregex: $ui_feature } } }\n        ) {\n            id\n            command {\n                cmd\n                help_cmd\n                description\n                id\n                needs_admin\n                payload_type_id\n                attributes\n                commandparameters {\n                    id\n                    type\n                }\n                supported_ui_features\n            }\n        }\n        command(\n            where: {\n                payloadtype: { ptype: { _eq: $payloadtype } }\n                script_only: { _eq: true }\n                deleted: { _eq: false }\n                supported_ui_features: { _iregex: $ui_feature }\n            }\n        ) {\n            id\n            cmd\n            help_cmd\n            description\n            needs_admin\n            attributes\n            payload_type_id\n            commandparameters {\n                id\n                type\n            }\n            supported_ui_features\n        }\n    }\n"]))),Ts=Object(be.a)(es||(es=Object(v.a)(["\n    query getCallbackDataQuery($callback_id: Int!) {\n        callback_by_pk(id: $callback_id) {\n            payload {\n                os\n                payloadtype {\n                    ptype\n                    id\n                }\n                tag\n                id\n            }\n            id\n            operation_id\n            host\n            active\n        }\n    }\n"])));function $s(e){var t=s.a.useState("File Browser: "+e.tabInfo.callbackID),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1];Object(o.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("File Browser: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(fo.b,Object(_.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),d(!0)}},e)),l&&Object(g.jsx)(Y.a,{fullWidth:!0,open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Tab's Description",onClose:function(){d(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var Ps,As,Es,Ls,Fs,qs,Ns,Rs,Bs,zs=function(e){var t=e.index,a=e.value,n=e.tabInfo,i=Object(f.a)(h.b),r=s.a.useRef([]),c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],x=p[1],v=s.a.useState([]),k=Object(u.a)(v,2),w=k[0],C=k[1],S=s.a.useRef({}),D=s.a.useState({task:{callback:{id:n.callbackID}},host:n.host,full_path_text:"."}),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState({}),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useState(!1),q=Object(u.a)(F,2),N=q[0],R=q[1],B=s.a.useState(!1),z=Object(u.a)(B,2),W=z[0],M=z[1],H=s.a.useState({}),U=Object(u.a)(H,2),G=U[0],V=U[1],K=s.a.useState({}),Q=Object(u.a)(K,2),J=Q[0],Z=Q[1],X=s.a.useState({}),ee=Object(u.a)(X,2),te=ee[0],ae=ee[1],ne=s.a.useState(""),ie=Object(u.a)(ne,2),re=ie[0],ce=ie[1],oe=s.a.useRef(),se=s.a.useState(!1),le=Object(u.a)(se,2),de=le[0],ue=le[1],be=s.a.useRef((new Date).toISOString()),me=s.a.useState({}),he=Object(u.a)(me,2),fe=he[0],Oe=he[1],ge=s.a.useState(!1),xe=Object(u.a)(ge,2),ye=xe[0],_e=xe[1],ve=Object(je.a)(ws,{variables:{operation_id:i.user.current_operation_id},onCompleted:function(e){var t=e.filebrowserobj.reduce((function(e,t){for(var a=0;a<e.length;a++)if(e[a].host===t.host)return e[a].chilren.push(Object(_.a)(Object(_.a)({},t),{},{parent_id:t.host,children:[]})),Object(y.a)(e);return[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{id:t.host,children:[Object(_.a)(Object(_.a)({},t),{},{parent_id:t.host,children:[]})]})])}),[]);x(t)},fetchPolicy:"network-only"}).subscribeToMore,ke=Object(pt.a)(Ds,{onCompleted:function(e){var t=Object(y.a)(r.current);e.filebrowserobj.forEach((function(e){var a=!1;if(null===e.parent_id){var n=!1;t.forEach((function(t){t.host===e.host&&(n=!0,t.children.forEach((function(t){t.name_text===e.name_text&&(a=!0,t.comment=e.comment,t.success=e.success,t.deleted=e.deleted,t.filemeta=e.filemeta)})))})),n?n&&!a&&(a=!0,t.forEach((function(t){t.host===e.host&&t.children.push(Object(_.a)(Object(_.a)({},e),{},{parent_id:e.host,children:[]}))}))):a=!1}else t.forEach((function(t){t.host===e.host&&(a=!0,Te(t,e.parent_id,[e]))}));a||null!==e.parent_id||t.push(Object(_.a)(Object(_.a)({},e),{},{id:e.host,children:[Object(_.a)(Object(_.a)({},e),{},{parent_id:e.host,children:[]})]}))})),x(t),e.filebrowserobj.length>0&&void 0!==S.current.id&&(e.filebrowserobj[0].parent_id===S.current.id||S.current.host===e.filebrowserobj[0].host)&&C(Object.values(S.current.children))},onError:function(e){console.log(e)}}),we=Object(u.a)(ke,1)[0];Object(o.useEffect)((function(){r.current=m}),[m]),Object(o.useEffect)((function(){S.current=T}),[T]);var Ce=Object(pt.a)(Cs,{onError:function(e){console.error(e)},fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:function(e){var t=!1;if(0===e.filebrowserobj.length)return O.b.dismiss(),null===T.success?O.b.info("Folder hasn't been listed yet"):O.b.info("Empty folder"),C(Object.values(T.children)),void b(!1);O.b.dismiss(),O.b.success("Fetched data");var a=m.map((function(a){if(e.filebrowserobj[0].host===a.host){var n=Object(_.a)({},a);return t=!0,Te(n,e.filebrowserobj[0].parent_id,e.filebrowserobj),n}return Object(_.a)({},a)}));t||(a.push(e.filebrowserobj[0]),Te(e.filebrowserobj[0],e.filebrowserobj[0].parent_id,e.filebrowserobj)),x(a),C(Object.values(T.children)),b(!1)}}),Se=Object(u.a)(Ce,1)[0],De=Object(pt.a)(Ts,{fetchPolicy:"no-cache",onCompleted:function(e){null!==e.callback_by_pk?e.callback_by_pk.active?Z(Object(_.a)(Object(_.a)({},e.callback_by_pk),{},{ui_feature:".*"+re+".*"},fe)):O.b.warning("That callback isn't active"):O.b.warning("Failed to find that Callback"),Oe({})},onError:function(e){O.b.error("Failed to fetch callback data for the specified callback")}}),Ie=Object(u.a)(De,1)[0],Te=Object(o.useCallback)((function(e,t,a){if(t===e.id){for(var n=0;n<a.length;n++)void 0===e.children[a[n].id]?e.children[a[n].id]=Object(_.a)(Object(_.a)({},a[n]),{},{children:{}}):e.children[a[n].id]=Object(_.a)(Object(_.a)({},a[n]),{},{children:e.children[a[n].id].children});return!0}for(var i=0,r=Object.entries(e.children);i<r.length;i++){var c=Object(u.a)(r[i],2),o=(c[0],c[1]);if(a[0].parent_path_text.startsWith(o.full_path_text))if(Te(o,t,a))return!0}return!1}),[]),$e=Object(pe.a)(Xc.c,{update:function(e,t){var a=t.data;"error"===a.createTask.status?O.b.error(a.createTask.error):O.b.success('Issued "'+G.cmd+'" to Callback '+J.id),V({}),Z({}),ae({}),ce("")},onError:function(e){console.error(e),V({}),Z({}),ae({}),ce("")}}),Pe=Object(u.a)($e,1)[0],Ae=Object(pt.a)(Is,{onCompleted:function(e){var t=e.loadedcommands.reduce((function(e,t){return[].concat(Object(y.a)(e),[t.command])}),[]),a=e.command.reduce((function(e,t){return[].concat(Object(y.a)(e),[t])}),Object(y.a)(t));L(a),0===a.length?O.b.warning("No commands currently loaded that support that feature"):1===a.length?V(Object(_.a)({},a[0])):(V({}),R(!0))},fetchPolicy:"network-only"}),Ee=Object(u.a)(Ae,1)[0];Object(o.useEffect)((function(){if(void 0!==G.cmd)switch(re){case"file_browser:list":void 0===te.path?Pe({variables:{callback_id:J.id,command:G.cmd,params:JSON.stringify({host:J.host,path:J.fullPath,file:""}),tasking_location:"file_browser"}}):Pe({variables:{callback_id:oe.current,command:G.cmd,params:JSON.stringify({host:te.host,path:te.path,file:te.filename}),tasking_location:"file_browser"}});break;case"file_browser:upload":M(!0);break;case"file_browser:download":case"file_browser:remove":Pe({variables:{callback_id:oe.current,command:G.cmd,params:JSON.stringify({host:te.host,path:te.path,file:te.filename}),tasking_location:"file_browser"}})}}),[G,Pe,J,T.full_path_text,te.filename,te.host,te.path,re]),Object(o.useEffect)((function(){void 0!==J.id&&Ee({variables:{callback_id:J.id,payloadtype:J.payload.payloadtype.ptype,ui_feature:J.ui_feature}})}),[J]);var Le=Object(o.useCallback)((function(e){C(Object.values(e.children)),$(e)}),[]),Fe=Object(o.useCallback)((function(e){Se({variables:{filebrowserobj_id:e.id,operation_id:i.user.current_operation_id}}),b(!0),$(e)}),[]),qe=Object(o.useCallback)((function(e){var t=e.path,a=e.host,n=e.filename,i=e.uifeature,r=e.confirmed;"file_browser:remove"!==i||r?(Oe({}),Ie({variables:{callback_id:oe.current}}),L([]),ce(i),ae({path:t,host:a,filename:n})):(Oe({path:t,host:a,filename:n,uifeature:i}),ue(!0))}),[]),Ne=Object(o.useCallback)((function(e,t){var a=t.subscriptionData;if(a.data.filebrowserobj.length>0)return we({variables:{operation_id:i.user.current_operation_id,now:(new Date).toISOString(),lastTime:be.current}}),void(null!==a.data.filebrowserobj[0]&&void 0!==a.data.filebrowserobj[0]&&(be.current=a.data.filebrowserobj[0].timestamp))}),[Te]);return Object(g.jsxs)(fo.c,{index:t,value:a,children:[Object(g.jsxs)("div",{style:{display:"flex",flexGrow:1,overflowY:"auto"},children:[Object(g.jsxs)("div",{style:{width:"30%",overflow:"auto"},children:[Object(g.jsx)(vs.a,{open:d,style:{zIndex:2,position:"absolute"},children:Object(g.jsx)(oa.a,{color:"inherit"})}),Object(g.jsx)(Mo,{showDeletedFiles:ye,treeRoot:m,fetchFolderData:Fe,setTableData:Le})]}),Object(g.jsxs)("div",{style:{width:"60%",display:"flex",flexDirection:"column",flexGrow:1},children:[Object(g.jsx)("div",{style:{flexGrow:0},children:Object(g.jsx)(Ws,{selectedFolderData:T,onListFilesButton:function(e){var t=e.callbackID,a=e.fullPath;Ie({variables:{callback_id:t}}),Oe({fullPath:a}),L([]),ce("file_browser:list")},onUploadFileButton:function(e){var t=e.callbackID;Ie({variables:{callback_id:t}}),L([]),ce("file_browser:upload")},onChangeCallbackID:function(e){oe.current=e},toggleShowDeletedFiles:function(e){_e(e)},initialCallbackID:n.callbackID,subscribeToNewFileBrowserObjs:function(){return ve({document:Ss,variables:{now:(new Date).toISOString(),operation_id:i.user.current_operation_id},updateQuery:Ne})}})}),Object(g.jsxs)("div",{style:{flexGrow:1},children:[Object(g.jsx)(vs.a,{open:d,style:{zIndex:2,position:"absolute"},children:Object(g.jsx)(oa.a,{color:"inherit"})}),Object(g.jsx)(ms,{showDeletedFiles:ye,onRowDoubleClick:Fe,selectedFolder:w,onTaskRowAction:qe})]})]})]}),N&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:N,onClose:function(){R(!1)},innerDialog:Object(g.jsx)(Oo.a,{onClose:function(){R(!1)},onSubmit:function(e){V(e)},options:E,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),W&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:W,onClose:function(){M(!1)},innerDialog:Object(g.jsx)(wo.a,{command:G,callback_id:J.id,payloadtype_id:J.payload.payloadtype.id,operation_id:J.operation_id,onSubmit:function(e,t,a){M(!1),Pe({variables:{callback_id:J.id,command:e,params:t,files:a}})},onClose:function(){M(!1)}})}),de&&Object(g.jsx)(ha,{onSubmit:function(){qe(Object(_.a)(Object(_.a)({},fe),{},{confirmed:!0}))},onClose:function(){ue(!1)},open:de})]})},Ws=function(e){var t=e.selectedFolderData,a=e.onListFilesButton,n=e.initialCallbackID,i=e.onUploadFileButton,r=e.onChangeCallbackID,c=e.subscribeToNewFileBrowserObjs,l=e.toggleShowDeletedFiles,d=Object(ee.a)(),b=s.a.useState(""),p=Object(u.a)(b,2),m=p[0],h=p[1],f=s.a.useState(""),x=Object(u.a)(f,2),y=x[0],_=x[1],v=s.a.useState(n),k=Object(u.a)(v,2),w=k[0],C=k[1],S=s.a.useState(!1),D=Object(u.a)(S,2),I=D[0],T=D[1],$=s.a.useState(!0),P=Object(u.a)($,2),A=P[0],L=P[1];Object(o.useEffect)((function(){void 0!==t.host&&h(t.host),void 0!==t.full_path_text&&_(t.full_path_text),A||void 0!==t.task&&C(t.task.callback.id)}),[t,A]);var F=function(){""!==y?w>0?a({callbackID:w,fullPath:y}):O.b.warning("Must select a folder or set a callback number first"):O.b.warning("Must provide a path to list")};Object(o.useEffect)((function(){r(w)}),[w]),Object(o.useEffect)((function(){c()}),[]);return Object(g.jsxs)(ft.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(g.jsx)(ft.a,{item:!0,xs:4,children:Object(g.jsx)(j.a,{placeholder:"Host Name",value:m,onChange:function(e,t){h(t)},name:"Host Name"})}),Object(g.jsx)(ft.a,{item:!0,xs:7,children:Object(g.jsx)(j.a,{placeholder:"Path",value:y,onEnter:F,onChange:function(e,t){_(t)},name:"Path",InputProps:{endAdornment:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(oo.a,{title:"Task callback to list contents",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:F,children:Object(g.jsx)(_o.a,{style:{color:d.palette.info.main}})})}),Object(g.jsx)(oo.a,{title:"Upload file to folder via callback",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){w>0?i({callbackID:w}):O.b.warning("Must select a folder or set a callback number first")},children:Object(g.jsx)(xo.a,{style:{color:d.palette.info.main}})})}),Object(g.jsx)(oo.a,{title:I?"Hide Deleted Files":"Show Deleted Files",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){T(!I),l(!I)},children:I?Object(g.jsx)(is.a,{style:{color:d.palette.info.main}}):Object(g.jsx)(_s.a,{style:{color:d.palette.info.main}})})})]}),style:{padding:0}}})}),Object(g.jsx)(ft.a,{item:!0,xs:1,children:Object(g.jsx)(j.a,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t){L(!0),C(parseInt(t))},value:w,InputProps:{endAdornment:A?Object(g.jsx)(oo.a,{title:"Change Callback Based on Data Origin",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){L(!1),t.task?C(t.task.callback.id):(C(0),r(0))},children:Object(g.jsx)(qc.a,{style:{color:d.palette.info.main}})})}):Object(g.jsx)(oo.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(g.jsx)(E.a,{style:{padding:"3px"},children:Object(g.jsx)(ko.a,{disabled:!0,style:{color:d.palette.warning.main}})})}),style:{padding:0,margin:0}}})})]})},Ms=a(547),Hs=Object(Se.a)((function(e){return{root:{width:"99%",marginTop:"3px",marginBottom:"2px",marginLeft:"3px",marginRight:"0px",height:"auto"},heading:{fontSize:e.typography.pxToRem(15),whiteSpace:"pre-line"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"calc(90vw)",whiteSpace:"break-word"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),Us=function(e,t,a){return{data:Object(_.a)({id:e.id.toString(),isLeaf:void 0===e.children||0===e.children.length,isOpenByDefault:!0,name:e.name,nestingLevel:t,theme:a},e),nestingLevel:t,node:e}},Gs=function(e){var t=e.treeRoot,a=e.theme,n=Object(o.useCallback)(r.a.mark((function e(){var n,i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=7;break}return e.next=4,Us(t[n],0,a);case 4:n++,e.next=1;break;case 7:return void(e.next=10);case 10:i=e.sent,c=0;case 12:if(!(c<i.node.children.length)){e.next=18;break}return e.next=15,Us(i.node.children[c],i.nestingLevel+1,a);case 15:c++,e.next=12;break;case 18:e.next=7;break;case 20:case"end":return e.stop()}}),e)})),[t,a]);return 0===t.length?Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Process Listing Data"}):Object(g.jsx)(ai.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(Ms.a,{treeWalker:n,height:t-10,width:a-10,itemSize:30,async:!0,placeholder:Object(g.jsx)("div",{children:"Loading...."}),children:Vs})}})},Vs=function(e){var t=e.data,a=e.isOpen,n=e.style,i=e.setOpen;return Object(g.jsxs)("div",{style:Object(_.a)(Object(_.a)({},n),{},{width:"calc(100vw)",display:"inline-flex",overflow:"auto"}),children:[Object(y.a)(Array(t.nestingLevel)).map((function(e,a){return Object(g.jsx)("div",{style:{borderLeft:"1px dashed ".concat(Object(Co.c)(t.theme.palette.text.primary,.4)),marginLeft:15,paddingRight:15,height:"100%",display:"inline-block"}},"folder"+t.id+"lines"+a)})),Object(g.jsx)(Ks,{filebrowserobj:t,isOpen:a,setOpen:i})]})},Ks=function(e){var t=Hs(),a=Object(ee.a)();return Object(g.jsx)(T.a,{className:t.root,elevation:5,style:{backgroundColor:a.body,color:a.text,alignItems:"center",display:"flex"},children:Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:[e.filebrowserobj.process_id," - ",e.filebrowserobj.name]})})},Qs=a(323),Js=a(299),Ys=a.n(Js),Zs=a(512),Xs=a.n(Zs),el=a(513),tl=a.n(el),al=Object(be.a)(Ps||(Ps=Object(v.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        command_line\n        description\n        signer\n        start_time\n        name\n        bin_path\n    }\n}\n"]))),nl=Object(be.a)(As||(As=Object(v.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        tokens(where: {deleted: {_eq: false}}) {\n            Address\n            AppContainer\n            AppContainerNumber\n            AppContainerSid\n            AppId\n            AppModelPolicies\n            AppModelPolicyDictionary\n            AttributesFlags\n            AuditPolicy\n            AuthenticationId_id\n            BnoIsolationPrefix\n            CanSynchronize\n            Capabilities\n            CreationTime\n            DefaultDacl\n            DenyOnlyGroups\n            DeviceClaimAttributes\n            DeviceGroups\n            Elevated\n            ElevationType\n            EnabledGroups\n            ExpirationTime\n            Filtered\n            Flags\n            FullPath\n            GrantedAccess\n            GrantedAccessGeneric\n            GrantedAccessMask\n            GroupCount\n            Groups\n            Handle\n            HandleReferenceCount\n            HasRestrictions\n            ImpersonationLevel\n            Inherit\n            IntegrityLevel\n            IntegrityLevelSid\n            IsClosed\n            IsContainer\n            IsPseudoToken\n            IsRestricted\n            IsSandbox\n            LogonSid\n            LowPrivilegeAppContainer\n            MandatoryPolicy\n            ModifiedId\n            Name\n            NoChildProcess\n            NotLow\n            NtType\n            NtTypeName\n            Owner\n            Origin\n            PackageFullName\n            PackageIdentity\n            PackageName\n            PointerReferenceCount\n            PrimaryGroup\n            PrivateNamespace\n            Privileges\n            ProcessUniqueAttribute\n            ProtectFromClose\n            Restricted\n            RestrictedDeviceClaimAttributes\n            RestrictedDeviceGroups\n            RestrictedSids\n            RestrictedSidsCount\n            RestrictedUserClaimAttributes\n            SandboxInert\n            Sddl\n            SecurityAttributes\n            SecurityDescriptor\n            SessionId\n            Source\n            ThreadID\n            TokenId\n            TokenType\n            TrustLevel\n            UIAccess\n            User\n            UserClaimAttributes\n            VirtualizationAllowed\n            VirtualizationEnabled\n            WriteRestricted\n            callbacktokens {\n                callback_id\n            }\n            logonsession {\n                id\n            }\n            task_id\n            timestamp_created\n        }\n    }\n}\n"]))),il=function(){return Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Data Selected"})},rl=function(e){var t=e.columnData,a=e.dataKey,n=e.rowData;return function(){switch(t.format){case"string":return Object(g.jsx)(ol,{cellData:n[a],rowData:n});case"button":return Object(g.jsx)(sl,{rowData:n,onTaskRowAction:t.onTaskRowAction,os:t.os});default:return Object(g.jsx)(ol,{cellData:n[a],rowData:n})}}()},cl=function(e){var t=s.a.useRef(null),a=s.a.useState("ASC"),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("name"),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState({actions:.065,parent_process_id:.0714,process_id:.0714,architecture:.06,name:.14,user:.14,bin_path:.4}),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState([]),O=Object(u.a)(f,2),x=O[0],v=O[1],k=function(e){var t=e.sortBy,a=e.sortDirection,n=Object(y.a)(T),i=x.filter((function(e){return e.dataKey===t}))[0].columnData.format;"number"===i||"size"===i?n.sort((function(e,a){return parseInt(e[t])>parseInt(a[t])?1:-1})):"date"===i?n.sort((function(e,a){return new Date(e[t])>new Date(a[t])?1:-1})):n.sort((function(e,a){return e[t]>a[t]?1:-1})),"DESC"===a&&n.reverse(),$(Object(y.a)(n)),b(t),r(a)},w=function(e){var t=e.index;return T[t]},C=s.a.useCallback((function(e){var a,n=e.event,i=e.dataKey,r=e.deltaX;n.preventDefault(),n.stopPropagation();for(var c=Object(_.a)({},m),o=r/t.current.offsetWidth,s="",l=!1,d=0,u=Object.keys(m);d<u.length;d++){var b=u[d];if(l){s=b;break}b===i&&(l=!0)}if(""!==s){var j=Object(_.a)(Object(_.a)({},c),{},(a={},Object(jt.a)(a,i,c[i]+o),Object(jt.a)(a,s,c[s]-o),a));h(j)}else console.log("next header not found")}),[m]),S=s.a.useCallback((function(e){var t=e.columnData,a=e.dataKey,n=(e.disableSort,e.label),i=e.sortBy,r=e.sortDirection;return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)("span",{style:{display:"inline-flex",flexDirection:"row",alignContent:"stretch",justifyContent:"flex-start"},children:[n,i===a?"ASC"===r?Object(g.jsx)(Xs.a,{}):Object(g.jsx)(tl.a,{}):null]}),"button"!==t.format&&"Path"!==n&&Object(g.jsx)(Ys.a,{axis:"x",defaultClassName:"DragHandle",defaultClassNameDragging:"DragHandleActive",onDrag:function(e,t){var n=t.deltaX;return C({event:e,dataKey:a,deltaX:n})},position:{x:0},zIndex:999,children:Object(g.jsx)("span",{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"DragHandleIcon",style:{width:"20px",textAlign:"center"},children:"\u22ee"})})]},"header"+a)}),[C,x]),D=s.a.useState([]),I=Object(u.a)(D,2),T=I[0],$=I[1];return Object(o.useEffect)((function(){v([{columnData:{format:"button",onTaskRowAction:e.onTaskRowAction,os:e.os},dataKey:"actions",label:"Actions",cellRenderer:rl,width:m.actions*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"number"},dataKey:"parent_process_id",label:"PPID",cellRenderer:rl,width:m.parent_process_id*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"number"},dataKey:"process_id",label:"PID",cellRenderer:rl,width:m.process_id*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"architecture",label:"Arch",cellRenderer:rl,width:m.architecture*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"name",label:"Name",cellRenderer:rl,width:m.name*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"user",label:"User",cellRenderer:rl,width:m.user*t.current.offsetWidth,headerRenderer:S},{columnData:{format:"string"},dataKey:"bin_path",label:"Path",cellRenderer:rl,width:m.bin_path*t.current.offsetWidth,headerRenderer:S}])}),[m,e.onTaskRowAction,e.os]),Object(o.useEffect)((function(){$(e.selectedFolder)}),[e.selectedFolder]),Object(g.jsx)("div",{ref:t,style:{width:"100%",height:"90%",overflow:"hidden"},children:Object(g.jsx)(Qs.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(Qs.c,{headerHeight:25,noRowsRenderer:il,rowCount:T.length,rowGetter:w,rowHeight:35,height:t,width:a,sort:k,sortBy:d,sortDirection:i,children:x.map((function(e){return Object(g.jsx)(Qs.b,Object(_.a)({},e),"col"+e.dataKey)}))})}})})},ol=function(e){return e.cellData},sl=function(e){var t=e.rowData,a=e.onTaskRowAction,n=e.os,i=s.a.useRef(null),r=Object(ee.a)(),c=s.a.useState(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),x=Object(u.a)(f,2),y=(x[0],x[1],s.a.useState({})),v=Object(u.a)(y,2),k=v[0],w=v[1],C=s.a.useState({}),S=Object(u.a)(C,2),D=(S[0],S[1]),I=Object(pt.a)(al,{onCompleted:function(e){w(e.process_by_pk),h(!0)},fetchPolicy:"network-only"}),$=Object(u.a)(I,1)[0],P=Object(pt.a)(nl,{onCompleted:function(e){0===e.process_by_pk.tokens.length?O.b.warning("No Token Data for Process"):(D(e.process_by_pk.tokens),h(!0))},fetchPolicy:"network-only"}),A=Object(u.a)(P,1)[0],E=function(e,t,a){switch(e){case"A":F[a].click(t);break;case"B":q[a].click(t)}d(!1)},L=function(e){i.current&&i.current.contains(e.target)||d(!1)},F=[{name:"View Detailed Data",icon:Object(g.jsx)(is.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),$({variables:{process_id:t.id}})}},{name:"View Tokens",icon:Object(g.jsx)(is.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),A({variables:{process_id:t.id}})},os:["Windows"]}],q=[{name:"Task Token Listing",icon:Object(g.jsx)(cs.a,{style:{paddingRight:"5px",color:r.palette.warning.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:list_tokens"})},os:["Windows"]},{name:"Task Inject",icon:Object(g.jsx)(oc.a,{style:{paddingRight:"5px",color:r.palette.success.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:inject"})}},{name:"Task Steal Token",icon:Object(g.jsx)(z.a,{style:{paddingRight:"5px",color:r.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:steal_token"})},os:["Windows"]},{name:"Task Kill Process",icon:Object(g.jsx)(z.a,{style:{paddingRight:"5px",color:r.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:kill"})}}];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{style:{padding:0},size:"small","aria-controls":l?"split-button-menu":void 0,"aria-expanded":l?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),d((function(e){return!e}))},color:"primary",variant:"contained",ref:i,children:"Actions"}),Object(g.jsx)(et.a,{open:l,anchorEl:i.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(g.jsx)(Xe.a,Object(_.a)(Object(_.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(g.jsx)(T.a,{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"},children:Object(g.jsx)(Ze.a,{onClickAway:L,children:Object(g.jsxs)(at.a,{id:"split-button-menu",children:[F.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(g.jsxs)(tt.a,{onClick:function(e){return E("A",e,t)},children:[e.icon,e.name]},e.name):null})),Object(g.jsx)(ka.a,{}),q.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(g.jsxs)(tt.a,{onClick:function(e){return E("B",e,t)},children:[e.icon,e.name]},e.name):null}))]})})})}))}}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){h(!1)},innerDialog:Object(g.jsx)(Y.d,{title:"View Detailed Data",leftColumn:"Attribute",rightColumn:"Value",value:k,onClose:function(){h(!1)},keys:["name","bin_path","signer","command_line","start_time","description"]})})]})},ll=a(515),dl=a.n(ll),ul=a(514),bl=a.n(ul),jl=a(516),pl=a.n(jl),ml=Object(be.a)(Es||(Es=Object(v.a)(["\nfragment objData on process {\n    name\n    process_id\n    parent_process_id\n    architecture\n    bin_path\n    integrity_level\n    id\n    user\n}\n"]))),hl=Object(be.a)(Ls||(Ls=Object(v.a)(["\nfragment taskData on task {\n    id\n    callback {\n        id\n        host\n        payload {\n            id\n            os\n            payloadtype{\n                ptype\n            }\n        }\n    }\n}\n"]))),fl=Object(be.a)(Fs||(Fs=Object(v.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_gt: $task_id}}, order_by: {task_id: asc}, limit: 1) {\n        task {\n            ...taskData\n            processes(order_by: {process_id: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),ml,hl),Ol=Object(be.a)(qs||(qs=Object(v.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_lt: $task_id}}, order_by: {task_id: desc}, limit: 1) {\n        task {\n            ...taskData\n            processes(order_by: {name: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),ml,hl),gl=Object(be.a)(Ns||(Ns=Object(v.a)(["\nquery getHostsQuery($operation_id: Int!, $host:String!){\n    process_aggregate(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}}, distinct_on: task_id){\n        aggregate {\n            max {\n              task_id\n            }\n        }\n    }\n}\n"]))),xl=Object(be.a)(Rs||(Rs=Object(v.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $payloadtype: String!, $ui_feature: String!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_iregex: $ui_feature}}}) {\n    id\n    command {\n      cmd\n      help_cmd\n      description\n      id\n      needs_admin\n      payload_type_id\n      attributes\n      commandparameters {\n        id\n        type \n      }\n      supported_ui_features\n    }\n  }\n  command(where: {payloadtype: {ptype: {_eq: $payloadtype}}, script_only: {_eq: true}, deleted: {_eq: false}, supported_ui_features: {_iregex: $ui_feature }}){\n      id\n      cmd\n      help_cmd\n      description\n      needs_admin\n      attributes\n      payload_type_id\n      commandparameters {\n          id\n          type\n      }\n      supported_ui_features\n    }\n}\n"]))),yl=Object(be.a)(Bs||(Bs=Object(v.a)(["\nquery getCallbackDataQuery($callback_id: Int!){\n    callback_by_pk(id: $callback_id){\n        payload {\n            os\n            payloadtype {\n              ptype\n              id\n            }\n            tag\n            id\n        }\n        id\n        operation_id\n        host\n        active\n    }\n}\n"])));function _l(e){var t=s.a.useState("Processes: "+e.tabInfo.host),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1];Object(o.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("Processes: "+e.tabInfo.host)}),[e.tabInfo.customDescription]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(fo.b,Object(_.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),d(!0)}},e)),l&&Object(g.jsx)(Y.a,{fullWidth:!0,open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Tab's Description",onClose:function(){d(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var vl,kl=function(e){var t=e.index,a=e.value,n=e.tabInfo,i=Object(ee.a)(),r=Object(f.a)(h.b),c=s.a.useRef([]),l=s.a.useState([]),d=Object(u.a)(l,2),b=d[0],j=d[1],p=s.a.useState([]),m=Object(u.a)(p,2),x=m[0],v=m[1],k=s.a.useState({}),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState(!1),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState(!1),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useState({}),q=Object(u.a)(F,2),N=q[0],R=q[1],B=s.a.useState({}),z=Object(u.a)(B,2),W=z[0],M=z[1],H=s.a.useState({}),U=Object(u.a)(H,2),G=U[0],V=U[1],K=s.a.useState(""),Q=Object(u.a)(K,2),J=Q[0],Z=Q[1],X=s.a.useRef(),te=s.a.useState(""),ae=Object(u.a)(te,2),ne=ae[0],ie=ae[1],re=Object(pt.a)(yl,{fetchPolicy:"no-cache",onCompleted:function(e){null!==e.callback_by_pk?e.callback_by_pk.active?M(Object(_.a)(Object(_.a)({},e.callback_by_pk),{},{ui_feature:".*"+J+".*"})):O.b.warning("That callback isn't active"):O.b.warning("Failed to find that Callback")},onError:function(e){O.b.error("Failed to fetch callback data for the specified callback")}}),ce=Object(u.a)(re,1)[0],oe=function e(t,a){if(t.process_id===a.parent_process_id)return t.children.push(Object(_.a)(Object(_.a)({},a),{},{children:[]})),!0;for(var n=0;n<t.children.length;n++)if(e(t.children[n],a))return!0;return!1},se=Object(pt.a)(fl,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{children:[]})]);var a=Object(y.a)(e).map((function(e){return oe(e,t),Object(_.a)({},e)}));return Object(y.a)(a)}),[]);j(t),v(e.process[0].task.processes),ie(e.process[0].task.callback.payload.os),V(e.process[0].task),O.b.dismiss(),O.b.success("Successfully fetched process data")}else O.b.dismiss(),O.b.warning("No Newer Process Sets")}}),le=Object(u.a)(se,1)[0],de=Object(pt.a)(Ol,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{children:[]})]);var a=Object(y.a)(e).map((function(e){return oe(e,t),Object(_.a)({},e)}));return Object(y.a)(a)}),[]);j(t),v(e.process[0].task.processes),ie(e.process[0].task.callback.payload.os),V(e.process[0].task),O.b.dismiss(),O.b.success("Successfully fetched process data")}else O.b.dismiss(),O.b.warning("No Earlier Process Sets")}}),ue=Object(u.a)(de,1)[0];Object(je.a)(gl,{variables:{operation_id:r.user.current_operation_id,host:n.host},onCompleted:function(e){null===e.process_aggregate.aggregate.max.task_id?(O.b.warning("No Process Data for "+n.host),V({callback:{host:n.host,id:n.callbackID},id:0})):(O.b.info("Fetching latest process data for "+n.host),le({variables:{operation_id:r.user.current_operation_id,host:n.host,task_id:e.process_aggregate.aggregate.max.task_id-1}}))},fetchPolicy:"network-only"}),Object(o.useEffect)((function(){c.current=b}),[b]);var be=Object(pe.a)(Xc.c,{update:function(e,t){var a=t.data;"error"===a.createTask.status?O.b.error(a.createTask.error):O.b.success('Issued "'+N.cmd+'" to Callback '+W.id),R({}),M({}),Z("")},onError:function(e){console.error(e),R({}),M({}),Z("")}}),me=Object(u.a)(be,1)[0],he=Object(pt.a)(xl,{onCompleted:function(e){var t=e.loadedcommands.reduce((function(e,t){return[].concat(Object(y.a)(e),[t.command])}),[]),a=e.command.reduce((function(e,t){return[].concat(Object(y.a)(e),[t])}),Object(y.a)(t));S(a),0===a.length?O.b.warning("No commands currently loaded that support that feature"):1===a.length?R(Object(_.a)({},a[0])):(R({}),$(!0))},fetchPolicy:"network-only"}),fe=Object(u.a)(he,1)[0];Object(o.useEffect)((function(){if(void 0!==N.cmd)if(0===N.commandparameters.length)me({variables:{callback_id:W.id,command:N.cmd,params:""}});else switch(J){case"process_browser:list":L(!0)}}),[N,me,W,J]),Object(o.useEffect)((function(){void 0!==W.id&&fe({variables:{callback_id:W.id,payloadtype:W.payload.payloadtype.ptype,ui_feature:W.ui_feature}})}),[W,fe]);return Object(g.jsxs)(fo.c,{index:t,value:a,children:[Object(g.jsxs)("div",{style:{display:"flex",flexGrow:1,overflowY:"auto"},children:[Object(g.jsx)("div",{style:{width:"30%",overflow:"auto",flexGrow:1},children:Object(g.jsx)(Gs,{treeRoot:b,theme:i})}),Object(g.jsxs)("div",{style:{width:"60%",display:"flex",flexDirection:"column",overflow:"auto",flexGrow:1},children:[Object(g.jsx)(wl,{onListFilesButton:function(e){var t=e.callbackID;ce({variables:{callback_id:t}}),S([]),Z("process_browser:list")},onNextButton:function(e){var t=e.task_id;le({variables:{operation_id:r.user.current_operation_id,host:n.host,task_id:t}})},onPreviousButton:function(e){var t=e.task_id;ue({variables:{operation_id:r.user.current_operation_id,host:n.host,task_id:t}})},onDiffButton:function(e){e.task_id},initialCallbackID:n.callbackID,onChangeCallbackID:function(e){X.current=e},taskInfo:G}),Object(g.jsx)(cl,{selectedFolder:x,onTaskRowAction:function(e){e.path,e.host,e.filename;var t=e.uifeature;ce({variables:{callback_id:X.current}}),S([]),Z(t)},os:ne})]})]}),T&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:T,onClose:function(){$(!1)},innerDialog:Object(g.jsx)(Oo.a,{onClose:function(){$(!1)},onSubmit:function(e){R(e)},options:C,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),E&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:E,onClose:function(){L(!1)},innerDialog:Object(g.jsx)(wo.a,{command:N,callback_id:W.id,payloadtype_id:W.payload.payloadtype.id,operation_id:W.operation_id,onSubmit:function(e,t,a){L(!1),me({variables:{callback_id:W.id,command:e,params:t,files:a}})},onClose:function(){L(!1)}})})]})},wl=function(e){var t=e.onListFilesButton,a=e.onNextButton,n=e.onPreviousButton,i=e.initialCallbackID,r=(e.onDiffButton,e.onChangeCallbackID),c=e.taskInfo,l=Object(ee.a)(),d=s.a.useState(""),b=Object(u.a)(d,2),p=b[0],m=b[1],h=s.a.useState(i),f=Object(u.a)(h,2),x=f[0],y=f[1],_=s.a.useState(!0),v=Object(u.a)(_,2),k=v[0],w=v[1],C=s.a.useState(0),S=Object(u.a)(C,2),D=S[0],I=S[1];Object(o.useEffect)((function(){void 0!==c.callback&&(m(c.callback.host),I(c.id)),k||(void 0!==c.callback?y(c.callback.id):y(0))}),[c,k]);return Object(o.useEffect)((function(){r(x)}),[x,r]),Object(g.jsxs)(ft.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(g.jsx)(ft.a,{item:!0,xs:10,children:Object(g.jsx)(j.a,{placeholder:"Host Name",value:p,disabled:!0,onChange:function(){},name:"Host Name",InputProps:{endAdornment:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(oo.a,{title:"Fetch Previous Saved Process Listing",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){O.b.info("Fetching previous process data..."),n({task_id:c.id})},children:Object(g.jsx)(bl.a,{style:{color:l.palette.info.main}})})}),Object(g.jsx)(oo.a,{title:"Task Callback to List Processes",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){x>0?t({callbackID:x}):O.b.warning("Must set a callback number to task first")},children:Object(g.jsx)(_o.a,{style:{color:l.palette.info.main}})})}),Object(g.jsx)(oo.a,{title:"Fetch Next Saved Process Listing",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){O.b.info("Fetching next process data..."),a({task_id:c.id})},children:Object(g.jsx)(dl.a,{style:{color:l.palette.info.main}})})}),Object(g.jsx)(oo.a,{title:"Compare Previous Listing",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){x>0?a({callbackID:x}):O.b.warning("Must select a callback number first")},children:Object(g.jsx)(pl.a,{style:{color:l.palette.info.main}})})})]})}})}),Object(g.jsx)(ft.a,{item:!0,xs:1,children:Object(g.jsx)(j.a,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t,a){w(!0),y(parseInt(t))},value:x,InputProps:{endAdornment:k?Object(g.jsx)(oo.a,{title:"Change Callback Based on Data Origin",children:Object(g.jsx)(E.a,{style:{padding:"3px"},onClick:function(){w(!1),void 0!==c.callback?y(c.callback.id):y(0)},children:Object(g.jsx)(qc.a,{style:{color:l.palette.info.main}})})}):Object(g.jsx)(oo.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(g.jsx)(E.a,{style:{padding:"3px"},children:Object(g.jsx)(ko.a,{disabled:!0,style:{color:l.palette.warning.main}})})}),style:{padding:0,margin:0}}})}),Object(g.jsx)(ft.a,{item:!0,xs:1,children:Object(g.jsx)(j.a,{type:"number",name:"Task Data",disabled:!0,value:D,onChange:function(){}})})]})},Cl=Object(be.a)(vl||(vl=Object(v.a)(["\n    subscription CallbacksSubscription($operation_id: Int!) {\n        callbacktoken(\n            where: {\n                deleted: { _eq: false }\n                callback: { operation_id: { _eq: $operation_id }, active: { _eq: true } }\n            }\n        ) {\n            token {\n                TokenId\n                id\n                User\n                description\n            }\n            callback {\n                id\n            }\n            id\n        }\n    }\n"]))),Sl=Object(Se.a)((function(e){return{root:{width:"100%"}}}));function Dl(e){var t=e.onCloseTab,a=e.openTabs,n=e.clickedTabId,i=e.clearSelectedTab,r=e.onEditTabDescription,c=Sl(),l=Object(f.a)(h.b),d=s.a.useState([]),b=Object(u.a)(d,2),j=b[0],p=b[1];Object(ze.a)(Cl,{variables:{operation_id:l.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;p(t.data.callbacktoken)}});var m=s.a.useState(0),O=Object(u.a)(m,2),x=O[0],y=O[1],_=function(e){var a=e.tabID,n=e.index;y(n>0?n-1:0),t({tabID:a,index:n})};return Object(o.useEffect)((function(){for(var e=0;e<a.length;e++)a[e].tabID===n&&y(e);i()}),[n,a,i]),Object(g.jsxs)("div",{className:c.root,style:{display:"flex",flexDirection:"column",flexGrow:1,height:"100%"},children:[Object(g.jsx)(mo.a,{color:"default",position:"static",children:Object(g.jsx)(ho.a,{value:x,onChange:function(e,t){y(t),localStorage.setItem("clickedTab",a[t].tabID)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",style:{maxWidth:"100%",width:"100%"},"aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e.tabType){case"interact":return Object(g.jsx)(Xc.a,{onEditTabDescription:r,onCloseTab:_,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"fileBrowser":return Object(g.jsx)($s,{onEditTabDescription:r,onCloseTab:_,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"processBrowser":return Object(g.jsx)(_l,{onEditTabDescription:r,onCloseTab:_,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);default:return null}}))})}),a.map((function(e,t){switch(e.tabType){case"interact":return Object(g.jsx)(Xc.b,{style:{position:"relative",height:"100%",maxHeight:"100%",overflow:"auto"},onCloseTab:_,tabInfo:e,value:x,index:t,callbacktokens:j},"tabpanel"+e.tabID+e.tabType);case"fileBrowser":return Object(g.jsx)(zs,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:_,tabInfo:e,value:x,index:t},"tabpanel"+e.tabID+e.tabType);case"processBrowser":return Object(g.jsx)(kl,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:_,tabInfo:e,value:x,index:t},"tabpanel"+e.tabID+e.tabType);default:return null}}))]})}var Il=a(877),Tl=a(878),$l=a(95),Pl=a(522),Al=a.n(Pl),El=a(521),Ll=a.n(El);function Fl(e){var t=s.a.useState({top:"0%",bottom:"0%"}),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(e.heights)}),[e.heights]);var r=function(e,t,a){var r=Object(_.a)({},n);r[e]=t,i(r)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Adjust sizes of Top/Bottom sections"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(j.a,{autoFocus:!0,value:n.top,onChange:r,name:"top"}),Object(g.jsx)(j.a,{value:n.bottom,onChange:r,name:"bottom"})]})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit(n),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}var ql=a(948);function Nl(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}function Rl(e,t){return"desc"===e?function(e,a){return Nl(e,a,t)}:function(e,a){return-Nl(e,a,t)}}function Bl(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))}function zl(e){var t=e.classes,a=e.onSelectAllClick,n=e.order,i=e.orderBy,r=e.numSelected,c=e.onRequestSort;return Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{padding:"checkbox",children:Object(g.jsx)(_a.a,{indeterminate:r>0&&r<e.rowCount,checked:e.rowCount>0&&r===e.rowCount,onChange:a,inputProps:{"aria-label":"select all desserts"}})}),e.headCells.map((function(a){return void 0===e.shownColumns||e.shownColumns.includes(a.id)||"id"===a.id?Object(g.jsx)(C.a,{align:"left",padding:a.disablePadding?"none":"default",sortDirection:i===a.id&&n,children:Object(g.jsxs)(ql.a,{active:i===a.id,direction:i===a.id?n:"asc",onClick:(r=a.id,function(e){c(e,r)}),children:[a.label,i===a.id?Object(g.jsx)("span",{className:t.visuallyHidden,children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},a.id):null;var r}))]})})}function Wl(e){var t="enhanced-table-checkbox-".concat(e.index);return Object(g.jsxs)(I.a,{hover:!0,role:"checkbox","aria-checked":e.isItemSelected,tabIndex:-1,selected:e.isItemSelected,style:void 0===e.style?{}:e.style,children:[Object(g.jsx)(C.a,{padding:"checkbox",children:Object(g.jsx)(_a.a,{onClick:function(t){return e.handleClick(t,e.id)},checked:e.isItemSelected,inputProps:{"aria-labelledby":t}})}),e.children]},e.id)}var Ml=Object(Se.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}}));function Hl(e){var t=Ml(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState(""),x=Object(u.a)(O,2),_=x[0],v=x[1],k=s.a.useState(""),w=Object(u.a)(k,2),C=w[0],S=w[1],D=P(i,d),I=P(i,h);function $(t,a){return e.itemKey?t.filter((function(t){return void 0===a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1===a.indexOf(e)}))}function P(t,a){return e.itemKey?t.filter((function(t){return void 0!==a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1!==a.indexOf(e)}))}var A=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(y.a)(i);-1===a?n.push(t):n.splice(a,1),r(n)}};Object(o.useEffect)((function(){var t=e.left.reduce((function(t,a){return void 0===e.itemKey?e.right.includes(a)?Object(y.a)(t):[].concat(Object(y.a)(t),[a]):e.right.find((function(t){return t[e.itemKey]===a[e.itemKey]}))?Object(y.a)(t):[].concat(Object(y.a)(t),[a])}),[]);j(t),f(e.right),v(e.leftTitle),S(e.rightTitle)}),[e.left,e.right,e.leftTitle,e.rightTitle,e.itemKey]);var E=function(a,n){return Object(g.jsx)(T.a,{className:t.paper,style:{width:"100%",height:"calc(50vh)"},children:Object(g.jsxs)(Ie.a,{children:[Object(g.jsx)(va.a,{className:t.cardHeader,title:a}),Object(g.jsx)(ka.a,{}),Object(g.jsxs)(Oa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[n.map((function(t){var a=void 0===e.itemKey?t:t[e.itemKey],n="transfer-list-item-".concat(a,"-label");return Object(g.jsxs)(ga.a,{style:{padding:0},role:"listitem",button:!0,onClick:A(t),children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(_a.a,{checked:void 0===e.itemKey?-1!==i.indexOf(a):-1!==i.findIndex((function(t){return t[e.itemKey]===a})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(g.jsx)(ya.a,{id:n,primary:a})]},a)})),Object(g.jsx)(ga.a,{})]})]})})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:e.dialogTitle}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsxs)(ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(g.jsx)(ft.a,{item:!0,xs:5,children:E(_,d)}),Object(g.jsx)(ft.a,{item:!0,children:Object(g.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(d)),j([])},disabled:0===d.length,"aria-label":"move all right",children:"\u226b"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(D)),j($(d,D)),r($(i,D))},disabled:0===D.length,"aria-label":"move selected right",children:">"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(I)),f($(h,I)),r($(i,I))},disabled:0===I.length,"aria-label":"move selected left",children:"<"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(h)),f([])},disabled:0===h.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(g.jsx)(ft.a,{item:!0,xs:5,children:E(C,h)})]})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit({left:d,right:h}),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}function Ul(e){return Object(g.jsx)(Y.a,{fullWidth:null!==e.fullWidth&&e.fullWidth,maxWidth:null===e.maxWidth?"sm":e.maxWidth,open:e.open,onClose:function(){e.onClose()},innerDialog:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(j.a,{multiline:!0,value:e.value,onChange:function(){}})}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})})}var Gl,Vl,Kl,Ql,Jl,Yl,Zl,Xl,ed,td,ad=a(208),nd=a.n(ad),id=Object(be.a)(Gl||(Gl=Object(v.a)(["\nmutation hideCallback ($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, active: false}) {\n    status\n    error\n  }\n}\n"]))),rd=Object(be.a)(Vl||(Vl=Object(v.a)(["\nmutation hideCallback ($callback_id: Int!, $active: Boolean!){\n  updateCallback(input: {callback_id: $callback_id, active: $active}) {\n    status\n    error\n  }\n}\n"]))),cd=Object(be.a)(Kl||(Kl=Object(v.a)(["\nmutation removeEdgeMutation ($edge_id: Int!, $end_timestamp: timestamp!){\n    update_callbackgraphedge_by_pk(pk_columns: {id: $edge_id}, _set: {end_timestamp: $end_timestamp}) {\n        end_timestamp\n        id\n      }\n}\n"]))),od=Object(be.a)(Ql||(Ql=Object(v.a)(["\nmutation addEdgeMutation ($source_id: Int!, $destination_id: Int!, $profile_id: Int!){\n  insert_callbackgraphedge_one(object: {c2_profile_id: $profile_id, destination_id: $destination_id, direction: 1, source_id: $source_id}) {\n    id\n  }\n}\n"]))),sd=Object(be.a)(Jl||(Jl=Object(v.a)(["\nmutation unlockCallback($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: false}) {\n    status\n    error\n  }\n}\n"]))),ld=Object(be.a)(Yl||(Yl=Object(v.a)(["\nmutation lockCallack($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: true}) {\n    status\n    error\n  }\n}\n"]))),dd=Object(be.a)(Zl||(Zl=Object(v.a)(["\nmutation updateDescriptionCallack($callback_id: Int!, $description: String!){\n  updateCallback(input: {callback_id: $callback_id, description: $description}) {\n    status\n    error\n  }\n}\n"]))),ud=Object(be.a)(Xl||(Xl=Object(v.a)(["\nmutation updateSleepInfoCallback($callback_id: Int!, $sleep_info: String!){\n  update_callback_by_pk(pk_columns: {id: $callback_id}, _set: {sleep_info: $sleep_info}){\n    id\n    sleep_info\n  }\n}\n"]))),bd=a(518),jd=a.n(bd),pd=a(366),md=a.n(pd),hd=a(517),fd=a.n(hd),Od=a(242),gd=Object(be.a)(ed||(ed=Object(v.a)(["\nquery GetCallbackDetails($callback_id: Int!) {\n  callback_by_pk(id: $callback_id){\n    payload {\n      uuid\n      payloadtype{\n          ptype\n          id\n          commands(where: {script_only: {_eq: true}, deleted: {_eq: false}}){\n            id\n            cmd\n            version\n          }\n      }\n      filemetum {\n        filename_text\n        agent_file_id\n        id\n        md5\n        sha1\n      }\n      buildparameterinstances {\n        parameter\n        id\n        buildparameter {\n          description\n        }\n      }\n      os\n    }\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n    loadedcommands{\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    last_checkin\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n  }\n  \n}\n"])));function xd(e){var t=Object(ee.a)(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(je.a)(gd,{variables:{callback_id:e.callback_id},onCompleted:function(e){var t=e.callback_by_pk.loadedcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})),a=e.callback_by_pk.payload.payloadtype.commands.reduce((function(e,t){return[].concat(Object(y.a)(e),[{cmd:t.cmd,mythic:t.version,payload:t.version}])}),Object(y.a)(t)).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));r(a);var n=e.callback_by_pk.payload.buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));d(n);var i=e.callback_by_pk.c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.c2profile.name,[].concat(Object(y.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),c=Object.keys(i).reduce((function(e,t){return[].concat(Object(y.a)(e),[{c2_profile:t,parameters:i[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);h(c)}}),O=f.loading,x=f.error,v=f.data;return O?Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}}):x?(console.error(x),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Callback Configuration"}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Callback Information"})}),Object(g.jsx)(Yc,Object(_.a)({},v.callback_by_pk)),Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Payload Information"})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Payload Info"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsxs)(w.a,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Payload Type"}),Object(g.jsx)(C.a,{children:v.callback_by_pk.payload.payloadtype.ptype})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Selected OS"}),Object(g.jsx)(C.a,{children:v.callback_by_pk.payload.os})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"UUID"}),Object(g.jsx)(C.a,{children:v.callback_by_pk.payload.uuid})]}),v.callback_by_pk.payload.filemetum?Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Filename"}),Object(g.jsx)(C.a,{children:v.callback_by_pk.payload.filemetum.filename_text})]},"filename_text"):null,Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Download URL"}),Object(g.jsx)(C.a,{children:window.location.origin+"/direct/download/"+v.callback_by_pk.payload.filemetum.agent_file_id})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"SHA1"}),Object(g.jsx)(C.a,{children:v.callback_by_pk.payload.filemetum.sha1})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"MD5"}),Object(g.jsx)(C.a,{children:v.callback_by_pk.payload.filemetum.md5})]})]})]}),Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Build Parameters"})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{children:l.map((function(e,t){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:e.description}),Object(g.jsx)(C.a,{children:e.value})]},"buildprop"+t+"for"+v.callback_by_pk.payload.id)}))})]}),m.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:e.c2_profile})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(C.a,{children:"Value"})]})}),Object(g.jsx)(w.a,{style:{whiteSpace:"pre"},children:e.parameters.map((function(t,a){return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:t.description}),Object(g.jsx)(C.a,{children:"Dictionary"===t.parameter_type||"Array"===t.parameter_type?JSON.stringify(JSON.parse(t.value),null,2):t.value})]},"c2frag"+v.callback_by_pk.payload.id+e.c2_profile+a)}))})]})]},"c2frag"+v.callback_by_pk.payload.id+e.c2_profile)})),Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Loaded Commands"})}),Object(g.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Command Name"}),Object(g.jsx)(C.a,{children:"Mythic Version"}),Object(g.jsx)(C.a,{children:"Loaded Version"}),Object(g.jsx)(C.a,{children:"Documentation"})]})}),Object(g.jsx)(w.a,{children:i.map((function(e){return Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:e.cmd}),Object(g.jsx)(C.a,{children:e.mythic}),Object(g.jsx)(C.a,{children:e.payload}),Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+v.callback_by_pk.payload.payloadtype.ptype+"/commands/"+e.cmd,children:"Docs"})})]},e.cmd+v.callback_by_pk.payload.id)}))})]})]}),Object(g.jsx)(U.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var yd=Object(be.a)(td||(td=Object(v.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    id\n    last_checkin\n  }\n}\n "])));function _d(e){var t=s.a.useRef(null),a=Object(ee.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState(!1),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState(a.palette.success.main),h=Object(u.a)(m,2),f=h[0],x=h[1],v=s.a.useState(!0),k=Object(u.a)(v,2),w=k[0],S=k[1],D=s.a.useState(!1),I=Object(u.a)(D,2),$=I[0],P=I[1],A=s.a.useState(!1),E=Object(u.a)(A,2),L=E[0],F=E[1],q=s.a.useState(!1),N=Object(u.a)(q,2),R=N[0],B=N[1],z=s.a.useState(!1),W=Object(u.a)(z,2),M=W[0],H=W[1],U=s.a.useState([]),G=Object(u.a)(U,2),V=G[0],K=G[1],Q=s.a.useState([]),J=Object(u.a)(Q,2),Z=J[0],X=J[1],te=s.a.useState([]),ae=Object(u.a)(te,2),ne=ae[0],ie=ae[1],re=s.a.useState(!0),ce=Object(u.a)(re,2),oe=ce[0],se=ce[1];Object(o.useEffect)((function(){void 0===e.shownColumns?ie([]):ie(e.shownColumns)}),[e.shownColumns]);var le=function(t){w||O.b.warning("Agent has no egress route! Re-link before tasking"),"interact"===t?e.onOpenTab({tabType:t,tabID:e.id+t,callbackID:e.id}):"processBrowser"===t?e.onOpenTab({tabType:t,tabID:e.host,callbackID:e.id}):e.onOpenTab({tabType:t,tabID:e.id+t,callbackID:e.id})};Object(o.useEffect)((function(){var t=Z.filter((function(t){return!t.c2profile.is_p2p&&t.source.id===e.id&&t.destination.id===e.id})).length;t>0&&!oe?se(!0):0===t&&oe&&se(!1)}),[Z]),Object(o.useEffect)((function(){var t=function(t){for(var a=e.callbackgraphedges.filter((function(a){return(a.source.id===e.id||a.destination.id===e.id)&&(!t||null===a.end_timestamp)})),n=!0;n;){var i=e.callbackgraphedges.reduce((function(e,a){return e.includes(a)?Object(y.a)(e):e.filter((function(e){return(e.source.id===a.source.id||e.source.id===a.destination.id||e.destination.id===a.source.id)&&(!t||null===a.end_timestamp)})).length>0?[].concat(Object(y.a)(e),[a]):Object(y.a)(e)}),Object(y.a)(a));n=i.length>a,a=Object(y.a)(i)}return a},a=t(!0),n=t(!1);V.length!==a.length&&K(a),Z.length!==n.length&&X(n)}),[e.callbackgraphedges,e.id]),Object(o.useEffect)((function(){0===V.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(x(a.palette.error.main),S(!1)):(x(a.palette.success.main),S(!0))}),[V,a.palette.success.main,a.palette.error.main]);var de=function(e){t.current&&t.current.contains(e.target)||P(!1)},ue=Object(pe.a)(id,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Hiding callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e)}}),be=Object(u.a)(ue,1)[0],je=s.a.useCallback((function(){H(!0)}),[]),me=Object(o.useCallback)((function(){switch(e.payload.os.toLowerCase()){case"windows":return Object(g.jsx)(zt.a,{icon:Od.d,size:"2x",style:{cursor:"pointer"},onClick:je});case"linux":return Object(g.jsx)(zt.a,{icon:Od.c,size:"2x",style:{cursor:"pointer"},onClick:je});case"macos":return Object(g.jsx)(zt.a,{icon:Od.a,size:"2x",style:{cursor:"pointer"},onClick:je});case"chrome":return Object(g.jsx)(zt.a,{icon:Od.b,size:"2x",style:{cursor:"pointer"},onClick:je});default:return Object(g.jsx)(zt.a,{icon:Wt.z,size:"2x",style:{cursor:"pointer"},onClick:je})}}),[]),he=[{name:"Hide Callback",icon:Object(g.jsx)(_s.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),be({variables:{callback_id:e.id}})}},{name:"File Browser",icon:Object(g.jsx)(md.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),le("fileBrowser")}},{name:"Process Browser",icon:Object(g.jsx)(md.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),le("processBrowser")}},{name:e.locked?"Unlock (Locked by "+e.locked_operator.username+")":"Lock Callback",icon:e.locked?Object(g.jsx)(zc.a,{style:{paddingRight:"5px"}}):Object(g.jsx)(qc.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),e.toggleLock({id:e.id,locked:e.locked})}},{name:"Edit Description",icon:Object(g.jsx)(vi.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),c(!0)}},{name:"Expand Callback",icon:Object(g.jsx)(fd.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),window.open("/new/callbacks/"+e.id,"_blank").focus()}},{name:"View Metadata",icon:Object(g.jsx)(fn.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),p(!0)}}];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Wl,{id:e.id,handleClick:e.handleClick,isItemSelected:e.isItemSelected(e.id),children:[Object(g.jsxs)(C.a,{children:[Object(g.jsxs)(Qe.a,{variant:"contained",color:e.integrity_level>2?"secondary":"primary",ref:t,"aria-label":"split button",children:[Object(g.jsxs)(b.a,{size:"small",onClick:function(e){e.stopPropagation(),le("interact")},children:[e.locked?Object(g.jsx)(qc.a,{}):Object(g.jsx)(nd.a,{})," ",e.id]}),Object(g.jsx)(b.a,{style:{padding:0},size:"small","aria-controls":$?"split-button-menu":void 0,"aria-expanded":$?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),P((function(e){return!e}))},children:Object(g.jsx)(Ye.a,{})})]}),Object(g.jsx)(et.a,{open:$,anchorEl:t.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:200},children:function(e){var t=e.TransitionProps,n=e.placement;return Object(g.jsx)(Xe.a,Object(_.a)(Object(_.a)({},t),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(g.jsx)(T.a,{style:{backgroundColor:"dark"===a.palette.type?a.palette.primary.dark:a.palette.primary.light,color:"white"},children:Object(g.jsx)(Ze.a,{onClickAway:de,children:Object(g.jsx)(at.a,{id:"split-button-menu",children:he.map((function(e,t){return Object(g.jsxs)(tt.a,{onClick:function(e){return function(e,t){he[t].click(e),P(!1)}(e,t)},children:[e.icon,e.name]},e.name)}))})})})}))}})]}),ne.includes("ip")?Object(g.jsx)(C.a,{children:e.ip}):null,ne.includes("host")?Object(g.jsx)(C.a,{children:e.host}):null,ne.includes("user")?Object(g.jsx)(C.a,{children:e.user}):null,ne.includes("domain")?Object(g.jsx)(C.a,{children:e.domain}):null,ne.includes("os")?Object(g.jsxs)(C.a,{children:[me(),Object(g.jsx)(Ul,{onClose:function(){H(!1)},title:"Operating System Information",maxWidth:"md",fullWidth:!0,value:e.os,open:M})]}):null,ne.includes("arch")?Object(g.jsx)(C.a,{children:e.architecture}):null,ne.includes("pid")?Object(g.jsx)(C.a,{children:e.pid}):null,ne.includes("last_checkin")?Object(g.jsx)(C.a,{children:Object(g.jsx)(wd,{callback_id:e.id})}):null,ne.includes("description")?Object(g.jsx)(C.a,{children:e.description}):null,ne.includes("sleep")?Object(g.jsx)(C.a,{children:Object(g.jsx)(jd.a,{onClick:function(e){e.stopPropagation(),B(!0)},style:{color:""===e.sleep_info?a.palette.warning.main:a.palette.info.main,cursor:"pointer"}})}):null,ne.includes("type")?Object(g.jsx)(C.a,{children:e.payload.payloadtype.ptype}):null,ne.includes("c2")?Object(g.jsx)(C.a,{children:oe?Object(g.jsx)(Ke.a,{onClick:function(e){e.stopPropagation(),F(!0)},style:{color:f,cursor:"pointer"}}):Object(g.jsx)(Rc.a,{onClick:function(e){e.stopPropagation(),F(!0)},style:{color:f,cursor:"pointer"}})}):null,ne.includes("process_name")?Object(g.jsx)(C.a,{children:e.process_name}):null,ne.includes("external_ip")?Object(g.jsx)(C.a,{children:e.external_ip}):null]}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:L,onClose:function(){F(!1)},innerDialog:Object(g.jsx)(Gc,Object(_.a)(Object(_.a)({onClose:function(){F(!1)}},e),{},{callbackgraphedges:w?V:Z}))}),j&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:j,onClose:function(){p(!1)},innerDialog:Object(g.jsx)(xd,{onClose:function(){p(!1)},callback_id:e.id})}),Object(g.jsx)(Y.a,{fullWidth:!0,open:r,onClose:function(){c(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Callback's Description",onClose:function(){c(!1)},value:e.description,onSubmit:function(t){e.updateDescription({description:t,id:e.id})}})}),Object(g.jsx)(Y.a,{fullWidth:!0,open:R,onClose:function(){B(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Sleep Information",onClose:function(){B(!1)},value:e.sleep_info,onSubmit:function(t){e.updateSleepInfo({sleep_info:t,id:e.id})}})})]})}var vd=s.a.memo(_d);function kd(e){var t=e.callback_id,a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1];Object(ze.a)(yd,{variables:{callback_id:t},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;d(t.data.callback_by_pk.last_checkin)}});return Object(Z.c)((function(){var e;e=l,r(Object(Z.a)(e))})),i}var wd=s.a.memo(kd),Cd=a(926),Sd=a(519),Dd=a.n(Sd),Id=Object(Se.a)((function(e){return{root:{minHeight:"unset",marginTop:"10px"},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Co.e)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{}}})),Td=function(e){var t=Id(),a=Object(ee.a)(),n=e.numSelected;return Object(g.jsx)(s.a.Fragment,{children:n>1?Object(g.jsx)(Cd.a,{className:Object(Na.default)(t.root,Object(jt.a)({},t.highlight,n>1)),children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(L.a,{className:t.title,color:"inherit",variant:"subtitle1",component:"div",children:[n," selected"]}),Object(g.jsx)(oo.a,{title:"Hide Selected",children:Object(g.jsx)(E.a,{"aria-label":"hide",onClick:e.onHideSelected,children:Object(g.jsx)(Dd.a,{})})}),Object(g.jsx)(oo.a,{title:"Task Selected",children:Object(g.jsx)(E.a,{"aria-label":"hide",onClick:e.onTaskSelected,children:Object(g.jsx)(zt.a,{icon:Wt.D,title:"Task All"})})})]})}):Object(g.jsxs)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",width:"100%"},variant:"elevation",children:[Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Active Callbacks"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"70px"},onClick:function(t){t.stopPropagation(),e.openDialog()},children:"Show/Hide Columns"})]})})},$d=Object(Se.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Pd(e){var t=$d(),a=s.a.useState("asc"),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("interact"),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),x=Object(u.a)(f,2),v=x[0],C=x[1],D=s.a.useState([]),I=Object(u.a)(D,2),$=I[0],P=I[1],A=s.a.useState(["user","host","domain","description","last_checkin","type","c2","ip","os"]),E=Object(u.a)(A,2),L=E[0],F=E[1],q=function(e,t){var a=m.indexOf(t),n=[];-1===a?n=n.concat(m,t):0===a?n=n.concat(m.slice(1)):a===m.length-1?n=n.concat(m.slice(0,-1)):a>0&&(n=n.concat(m.slice(0,a),m.slice(a+1))),h(n)},N=function(e){return-1!==m.indexOf(e)},R=Object(pe.a)(id,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Hiding callback"):O.b.warning(a.updateCallback.error)},onError:function(e){O.b.warning(e),console.log(e)}}),B=Object(u.a)(R,1)[0],z=Object(pe.a)(ld,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Locked callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e),O.b.warning(e)}}),W=Object(u.a)(z,1)[0],M=Object(pe.a)(sd,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Unlocked callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e),O.b.warning(e)}}),H=Object(u.a)(M,1)[0],U=Object(pe.a)(dd,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Updated Callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e),O.b.warning(e)}}),G=Object(u.a)(U,1)[0],V=Object(pe.a)(ud,{update:function(e,t){t.data;O.b.success("Updated Callback")},onError:function(e){console.log(e),O.b.warning(e)}}),K=Object(u.a)(V,1)[0],Q=Object(o.useMemo)((function(){return[{id:"id",numeric:!0,disablePadding:!1,label:"Interact"},{id:"ip",numeric:!1,disablePadding:!1,label:"IP"},{id:"host",numeric:!1,disablePadding:!1,label:"Host"},{id:"user",numeric:!1,disablePadding:!1,label:"User"},{id:"domain",numeric:!1,disablePadding:!1,label:"Domain"},{id:"os",numeric:!1,disablePadding:!1,label:"OS"},{id:"arch",numberic:!1,disablePadding:!1,label:"Arch"},{id:"pid",numeric:!0,disablePadding:!1,label:"PID"},{id:"last_checkin",numeric:!0,disablePadding:!1,label:"Last Checkin"},{id:"description",numeric:!1,disablePadding:!1,label:"Description"},{id:"sleep",numeric:!1,disablePadding:!0,label:"Sleep"},{id:"type",numeric:!1,disablePadding:!1,label:"Type"},{id:"c2",numeric:!1,disablePadding:!0,label:"C2"},{id:"process_name",numeric:!1,disablePadding:!0,label:"Process Name"},{id:"external_ip",numberic:!1,disablePadding:!0,label:"External IP"}]}),[]);Object(o.useEffect)((function(){var e=Q.map((function(e){return e.id})).filter((function(e){return"id"!==e}));P(e);var t=localStorage.getItem("callbacks_table_columns");null!==t&&F(JSON.parse(t))}),[Q]);var J=s.a.useCallback((function(e){var t=e.id;e.locked?H({variables:{callback_id:t}}):W({variables:{callback_id:t}})}),[]),Z=s.a.useCallback((function(e){var t=e.id,a=e.description;G({variables:{callback_id:t,description:a}})}),[]),X=s.a.useCallback((function(e){var t=e.id,a=e.sleep_info;K({variables:{callback_id:t,sleep_info:a}})}),[]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Td,{numSelected:m.length,onHideSelected:function(){for(var t=Object(y.a)(m),a=function(a){t.includes(e.callbacks[a].id)&&(B({variables:{callback_id:e.callbacks[a].id}}),t=t.filter((function(t){return t!==e.callbacks[a].id})))},n=0;n<e.callbacks.length;n++)a(n);h(t)},onTaskSelected:function(){O.b.warning("Not Implemented Yet")},openDialog:function(){return C(!0)}}),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{maxWidth:"100%",marginRight:"5px",overflow:"auto"},children:Object(g.jsxs)(k.a,{size:"small",children:[Object(g.jsx)(zl,{shownColumns:L,numSelected:m.length,rowCount:e.callbacks.length,classes:t,headCells:Q,onSelectAllClick:function(t){if(t.target.checked)if(m.length>0)h([]);else{var a=e.callbacks.map((function(e){return e.id}));h(a)}else h([])},onRequestSort:function(e,t){r(d===t&&"asc"===i?"desc":"asc"),b(t)},orderBy:d,order:i}),Object(g.jsx)(w.a,{children:Bl(e.callbacks,Rl(i,d)).map((function(t,a){return Object(g.jsx)(vd,Object(_.a)(Object(_.a)({shownColumns:L,handleClick:q,isItemSelected:N,onOpenTab:e.onOpenTab},t),{},{callbackgraphedges:e.callbackgraphedges,toggleLock:J,updateDescription:Z,updateSleepInfo:X}),"callback"+t.id)}))})]})}),v&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:v,onClose:function(){C(!1)},innerDialog:Object(g.jsx)(Hl,{onClose:function(){C(!1)},onSubmit:function(e){e.left;var t=e.right;F(t),localStorage.setItem("callbacks_table_columns",JSON.stringify(t))},right:L,rightTitle:"Show these columns",leftTitle:"Hidden Columns",left:$,dialogTitle:"Edit which columns are shown"})})]})}var Ad,Ed,Ld=a(520),Fd=Object(be.a)(Ad||(Ad=Object(v.a)(["\nquery getP2PProfilesAndCallbacks($operation_id: Int!){\n  c2profile(where: {is_p2p: {_eq: true}}) {\n    callbackc2profiles(where: {callback: {operation_id: {_eq: $operation_id}}}) {\n      id\n      callback {\n        id\n        description\n      }\n    }\n    name\n    id\n  }\n}\n"]))),qd=Object(Se.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120,width:"97%"},selectEmpty:{marginTop:e.spacing(2)}}}));function Nd(e){var t=qd(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(""),m=Object(u.a)(p,2),O=m[0],x=m[1],y=s.a.useState(""),_=Object(u.a)(y,2),v=_[0],k=_[1],w=Object(o.useRef)(null),C=Object(f.a)(h.b),S=Object(je.a)(Fd,{variables:{operation_id:C.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.filter((function(t){var a=!1;return e.source.callbackc2profiles.forEach((function(e){e.c2profile.name===t.name&&(a=!0)})),a}));if(j(a),a.length>0){k(a[0]);var n=a[0].callbackc2profiles.filter((function(t){return t.callback.id!==e.source.id}));r(n),n.length>0&&x(n[0])}},fetchPolicy:"network-only"}),D=S.loading,I=S.error;return D?Object(g.jsx)(Ae.a,{style:{marginTop:"10px"}}):I?(console.error(I),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(K.a,{children:["Manually Add Edge From Callback ",e.source.id]}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsxs)(s.a.Fragment,{children:["Manually add an edge from Callback ",e.source.id," to another callback via a P2P C2 Profile they both share.",Object(g.jsx)("br",{}),Object(g.jsxs)(mt.a,{className:t.formControl,children:[Object(g.jsx)($t.a,{id:"demo-dialog-select-label-profile",children:"Profile"}),Object(g.jsxs)(ht.a,{labelId:"demo-dialog-select-label-profile",id:"demo-dialog-select",value:v,onChange:function(e){k(e.target.value)},style:{minWidth:"30%"},children:[Object(g.jsx)(tt.a,{value:"",children:Object(g.jsx)("em",{children:"None"})}),d.map((function(e){return Object(g.jsx)(tt.a,{value:e,children:e.name},"profile:"+e.id)}))]})]}),Object(g.jsx)("br",{}),Object(g.jsxs)(mt.a,{className:t.formControl,children:[Object(g.jsx)($t.a,{ref:w,children:"Destination"}),Object(g.jsxs)(ht.a,{labelId:"demo-dialog-select-label-destination",id:"demo-dialog-select-destination",value:O,onChange:function(e){x(e.target.value)},input:Object(g.jsx)(Ot.a,{}),children:[Object(g.jsx)(tt.a,{value:"",children:Object(g.jsx)("em",{children:"None"})}),i.map((function(e){return Object(g.jsxs)(tt.a,{value:e,children:[e.callback.id," (",e.callback.description,")"]},"callback:"+e.callback.id)}))]})]})]})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit(e.source.id,v,O.callback),e.onClose()},variant:"contained",style:{backgroundColor:Ir.a.palette.success.main},children:"Add"})]})]})}var Rd,Bd,zd=Object(be.a)(Ed||(Ed=Object(v.a)(['\nquery loadedLinkCommandsQuery ($callback_id: Int!){\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_ilike: "graph_view:link"}, deleted: {_eq: false}}}) {\n    command {\n        id\n        cmd\n        help_cmd\n        description\n        needs_admin\n    }\n  }\n}\n'])));function Wd(e){var t=e.onOpenTab,a=e.callbackgraphedges,n=Object(ee.a)(),i=Object(o.useRef)(null),r=s.a.useRef(null),c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=Object(o.useState)(!0),m=Object(u.a)(p,2),h=m[0],f=m[1],x=s.a.useState([]),v=Object(u.a)(x,2),k=v[0],w=v[1],C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],$=s.a.useState(!1),P=Object(u.a)($,2),A=P[0],E=P[1],L=Object(o.useState)(),F=Object(u.a)(L,2),q=F[0],N=F[1],R=Object(o.useState)(),B=Object(u.a)(R,2),z=B[0],W=B[1],M=Object(o.useState)(!1),H=Object(u.a)(M,2),U=H[0],G=H[1],V=Object(o.useState)(!1),K=Object(u.a)(V,2),Q=K[0],J=K[1],Z=Object(o.useState)([]),X=Object(u.a)(Z,2),te=X[0],ae=X[1],ne=Object(o.useState)(null),ie=Object(u.a)(ne,2),re=ie[0],ce=ie[1],oe=Object(pt.a)(zd,{fetchPolicy:"network-only",onCompleted:function(e){if(1===e.loadedcommands.length)N(e.loadedcommands[0].command),I(!0);else if(0===e.loadedcommands.length)O.b.warning("No commands loaded that are 'link' commands");else{var t=e.loadedcommands.map((function(e){return Object(_.a)(Object(_.a)({},e),{},{display:e.command.cmd})}));w(t),N(t[0].command),E(!0)}}}),se=Object(u.a)(oe,1)[0],le=Object(pe.a)(Xc.c,{update:function(e,t){var a=t.data;"error"===a.createTask.status?O.b.error(a.createTask.error):O.b.success("task created")}}),de=Object(u.a)(le,1)[0],ue=s.a.useState({rankDir:"LR",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!1}),be=Object(u.a)(ue,2),je=be[0],me=be[1],he=Object(pe.a)(id,{update:function(e,t){t.data}}),fe=Object(u.a)(he,1)[0],Oe=Object(pe.a)(cd,{update:function(e,t){t.data}}),ge=Object(u.a)(Oe,1)[0],xe=Object(pe.a)(od,{update:function(e,t){t.data}}),ye=Object(u.a)(xe,1)[0],_e=Object(o.useMemo)((function(){return{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[{title:"Hide Callback",action:function(e,t){fe({variables:{callback_id:t.node.id}})}},{title:"Interact",action:function(e,a){t({tabType:"interact",tabID:a.node.id+"interact",callbackID:a.node.id})}},{title:"Manually Remove Edge",action:function(e,t){var a=function(e,t){return e.nodeEdges(t)}(e,t.node.id).reduce((function(t,a){var n=e.edge(a.v,a.w,a.name);return null===n.end_timestamp?1===n.direction?je.packet_flow_view?[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},n),{},{display:a.v+" --\x3e "+a.name+" --\x3e "+a.w})]):[].concat(Object(y.a)(t),[Object(_.a)(Object(_.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):Object(y.a)(t)}),[]);ae(a),G(!0)}},{title:"Manually Add Edge",action:function(e,t){ce(t.node),J(!0)}},{title:"Task Callback for Edge",action:function(e,t){w([]),N(null),W(null),se({variables:{callback_id:t.node.id}}),W(t.node)}}]}}),[se,fe,je,t]),ve=[{name:je.include_disconnected?"Show Only Active Edges":"Show All Edges",click:function(){var e=Object(_.a)(Object(_.a)({},je),{},{include_disconnected:!je.include_disconnected});Kc(Object(y.a)(a),i,!0,e,_e,n),me(e)}},{name:je.show_all_nodes?"Hide inactive callbacks":"Show All Callbacks",click:function(){var e=Object(_.a)(Object(_.a)({},je),{},{show_all_nodes:!je.show_all_nodes});Kc(Object(y.a)(a),i,!0,e,_e,n),me(e)}},{name:"Autosize",click:function(){Kc(Object(y.a)(a),i,!0,je,_e,n)}},{name:"LR"===je.rankDir?"Change Layout to Top-Bottom":"Change Layout to Left-Right",click:function(){if("LR"===je.rankDir){var e=Object(_.a)(Object(_.a)({},je),{},{rankDir:"BT"});Kc(Object(y.a)(a),i,!0,e,_e,n),me(e)}else{var t=Object(_.a)(Object(_.a)({},je),{},{rankDir:"LR"});Kc(Object(y.a)(a),i,!0,t,_e,n),me(t)}}},{name:je.packet_flow_view?"View Connection Directions":"View Egress Routes",click:function(){var e=Object(_.a)(Object(_.a)({},je),{},{packet_flow_view:!je.packet_flow_view});Kc(Object(y.a)(a),i,!0,e,_e,n),me(e)}},{name:"Download Graph",click:function(){Object(Ld.saveSvgAsPng)(document.getElementById("callbacksgraph"),"diagram.png")}}],ke=function(e){r.current&&r.current.contains(e.target)||j(!1)};return Object(o.useEffect)((function(){var e=Object(y.a)(a);Kc(e,i,h,je,_e,n),f(!1)}),[a,h,je,n]),Object(g.jsxs)("div",{style:{maxWidth:"100%",overflow:"auto",height:"100%"},children:[Object(g.jsx)(Qe.a,{variant:"contained",ref:r,"aria-label":"split button",style:{marginTop:"10px"},color:"primary",children:Object(g.jsxs)(b.a,{size:"small",color:"primary","aria-controls":d?"split-button-menu":void 0,"aria-expanded":d?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),j((function(e){return!e}))},children:["Actions ",Object(g.jsx)(Ye.a,{})]})}),function(){var e="";return e+=je.include_disconnected?"Showing All Edges, ":"Showing Only Active Edges, ",e+=je.show_all_nodes?"Showing All Callbacks, ":"Showing Active Callbacks, ",e+="Layout: "+je.rankDir+", ",e+=je.packet_flow_view?"Showing Egress Routes":"Showing Connections Paths"}(),Object(g.jsx)(et.a,{open:d,anchorEl:r.current,role:void 0,transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,a=e.placement;return Object(g.jsx)(Xe.a,Object(_.a)(Object(_.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(g.jsx)(T.a,{style:{backgroundColor:"dark"===n.palette.type?n.palette.primary.dark:n.palette.primary.light,color:"white"},children:Object(g.jsx)(Ze.a,{onClickAway:ke,children:Object(g.jsx)(at.a,{id:"split-button-menu",children:ve.map((function(e,t){return Object(g.jsx)(tt.a,{onClick:function(e){return function(e,t){ve[t].click(),j(!1)}(0,t)},children:e.name},e.name)}))})})})}))}}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:U,onClose:function(){G(!1)},innerDialog:Object(g.jsx)(Oo.a,{onClose:function(){G(!1)},identifier:"edge_id",display:"display",onSubmit:function(e){""!==e?ge({variables:{edge_id:e.edge_id,end_timestamp:(new Date).toISOString()}}):O.b.warning("No edge selected")},options:te,title:"Manually Remove Edge",action:"remove"})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:Q,onClose:function(){J(!1)},innerDialog:Object(g.jsx)(Nd,{onClose:function(){J(!1)},onSubmit:function(e,t,a){""!==t&&""!==a?ye({variables:{source_id:e,profile_id:t.id,destination_id:a.id}}):O.b.warning("Profile or Destination Callback not provided")},source:re})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:D,onClose:function(){I(!1)},innerDialog:Object(g.jsx)(wo.a,{command:q,callback:z,onSubmit:function(e,t,a){I(!1),de({variables:{callback_id:z.id,command:e,params:t,files:a}})},onClose:function(){I(!1)}})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:A,onClose:function(){E(!1)},innerDialog:Object(g.jsx)(Oo.a,{onClose:function(){E(!1)},onSubmit:function(e){N(e.command),I(!0)},options:k,title:"Select Link Command",action:"select",display:"display",identifier:"display"})}),Object(g.jsx)("svg",{id:"callbacksgraph",ref:i,width:"100%",height:"90%"})]})}var Md=Object(be.a)(Rd||(Rd=Object(v.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n  }\n}\n "]))),Hd=Object(be.a)(Bd||(Bd=Object(v.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function Ud(e){var t=e.onOpenTab,a=e.topDisplay,n=e.heights,i=Object(f.a)(h.b),r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState([]),b=Object(u.a)(d,2),j=b[0],p=b[1];Object(ze.a)(Md,{variables:{operation_id:i.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;l(t.data.callback)}}),Object(ze.a)(Hd,{variables:{operation_id:i.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;p(t.data.callbackgraphedge)}});var m=function(e){for(var a=e.tabType,n=e.tabID,i=e.callbackID,r=0;r<o.length;r++)if(o[r].id===i){var c={tabID:n,tabType:a,callbackID:i,payloadtype:o[r].payload.payloadtype.ptype,payloadtype_id:o[r].payload.payloadtype.id,operation_id:o[r].operation_id,payloadDescription:o[r].payload.tag,callbackDescription:o[r].description,host:o[r].host,os:o[r].payload.os};t(c)}};return Object(g.jsx)("div",{style:{height:"100%",maxHeight:"100%",overflow:"auto"},children:"graph"===a?Object(g.jsx)(Wd,{maxHeight:"100%",topHeight:n.top,onOpenTab:m,callbacks:o,callbackgraphedges:j},"callbacksgraph"):Object(g.jsx)(Pd,{onOpenTab:m,callbacks:o,callbackgraphedges:j},"callbackstable")})}var Gd=Object(Se.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{bottom:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{top:e.spacing(2),right:e.spacing(2)}},tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function Vd(){var e=s.a.useState("table"),t=Object(u.a)(e,2),a=t[0],n=t[1],i=s.a.useState([]),r=Object(u.a)(i,2),c=r[0],l=r[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState({top:"30%",bottom:"68%"}),h=Object(u.a)(m,2),f=h[0],O=h[1];Object(o.useEffect)((function(){var e=localStorage.getItem("openTabs");if(void 0!==e&&null!==e)try{var t=JSON.parse(e);l(t);var a=localStorage.getItem("clickedTab");void 0!==a&&null!==a&&p(a)}catch(r){console.log("failed to parse oldTabs",r)}var n=localStorage.getItem("heights");if(void 0!==n&&null!==n)try{var i=JSON.parse(n);O(i)}catch(r){console.log("failed to parse oldHeights",r)}}),[]);var x=s.a.useCallback((function(){p("")}),[]),v=s.a.useCallback((function(e){O(e),localStorage.setItem("heights",JSON.stringify(e))}),[]);return Object(g.jsx)("div",{style:{maxWidth:"100%",height:"100%",display:"flex",flexDirection:"column"},children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Zd,{setTopDisplay:n,heights:f,onSubmitHeights:v}),Object(g.jsx)("div",{style:{flexGrow:1,flexBasis:f.top,height:f.top},children:Object(g.jsx)(Ud,{topDisplay:a,onOpenTab:function(e){var t=!1;if(c.forEach((function(a){a.tabID===e.tabID&&(t=!0)})),!t){var a=[].concat(Object(y.a)(c),[Object(_.a)({},e)]);localStorage.setItem("openTabs",JSON.stringify(a)),l(a)}localStorage.setItem("clickedTab",e.tabID),p(e.tabID)},heights:f})}),Object(g.jsx)("div",{style:{flexGrow:1,flexBasis:f.bottom,height:f.bottom},children:Object(g.jsx)(Dl,{onCloseTab:function(e){var t=e.tabID,a=(e.index,c.filter((function(e){return e.tabID!==t})));localStorage.setItem("openTabs",JSON.stringify(a)),l(a)},onEditTabDescription:function(e,t){var a=c.map((function(a){return a.tabID===e.tabID?Object(_.a)(Object(_.a)({},a),{},{customDescription:t}):Object(_.a)({},a)}));l(a),localStorage.setItem("openTabs",JSON.stringify(a))},clearSelectedTab:x,tabHeight:f.bottom,maxHeight:f.bottom,clickedTabId:j,openTabs:c},"callbackstabs")})]})})}function Kd(e){var t=e.setTopDisplay,a=e.onSubmitHeights,n=e.heights,i=s.a.useState(!1),r=Object(u.a)(i,2),c=r[0],o=r[1],l=Gd(),d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useMemo((function(){return[{icon:Object(g.jsx)(Ll.a,{}),name:"Table layout",onClick:function(){t("table")}},{icon:Object(g.jsx)(Fi.a,{}),name:"Graph layout",onClick:function(){t("graph")}},{icon:Object(g.jsx)(Al.a,{}),name:"Adjust Top/Bottom Size",onClick:function(){p(!0),o(!1)}}]}),[]);return Object(g.jsxs)(s.a.Fragment,{children:[j&&Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:j,onClose:function(){p(!1),o(!1)},innerDialog:Object(g.jsx)(Fl,{onClose:function(){p(!1),o(!1)},heights:n,onSubmit:function(e){o(!1),a(e)}})}),Object(g.jsx)(Il.a,{ariaLabel:"SpeedDial example",className:l.speedDial,icon:Object(g.jsx)(Tl.a,{}),onClose:function(){o(!1)},onOpen:function(){o(!0)},FabProps:{color:"secondary"},open:c,style:{marginTop:"35px"},direction:"down",children:m.map((function(e){return Object(g.jsx)($l.a,{arrow:!0,TooltipClasses:{tooltip:l.tooltip,arrow:l.arrow},icon:e.icon,tooltipTitle:e.name,onClick:e.onClick},e.name)}))})]})}var Qd,Jd,Yd,Zd=s.a.memo(Kd),Xd=a(207),eu=a(523),tu=a.n(eu),au=a(851),nu=a(79),iu=a.n(nu),ru=a(874),cu=20,ou=Object(be.a)(Qd||(Qd=Object(v.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_escape: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_escape: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),Xc.d),su=Object(be.a)(Jd||(Jd=Object(v.a)(["\n","\nquery parametersQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),Xc.d),lu=Object(be.a)(Yd||(Yd=Object(v.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),Xc.d);function du(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"Tasks",iconComponent:Object(g.jsx)(tu.a,{})},e))}var uu,bu,ju,pu=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Output"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Output","Parameters","Comment"],p=s.a.useState(""),m=Object(u.a)(p,2),h=m[0],f=m[1],O=function(t,a,n,r){var c=a||i,o=r||h;switch(n||l){case"Output":e.onOutputSearch({search:c,offset:0,taskStatus:o});break;case"Parameters":e.onParameterSearch({search:c,offset:0,taskStatus:o});break;case"Comment":e.onCommentSearch({search:c,offset:0,taskStatus:o})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Output",i="";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Output"),e.onChangeSearchField("Output"),e.changeSearchParam("searchField","Output")),t.has("taskStatus")&&(f(t.get("taskStatus")),e.onChangeTaskStatus(t.get("taskStatus")),i=t.get("taskStatus")),O(0,a,n,i)}}),[e.value,e.index]),Object(g.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:O,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(oo.a,{title:"Search",children:Object(g.jsx)(E.a,{onClick:O,children:Object(g.jsx)(iu.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(ft.a,{item:!0,xs:3,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search Task's"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(g.jsx)(ft.a,{item:!0,xs:2,children:Object(g.jsx)(j.a,{placeholder:"Filter Task Status...",value:h,onChange:function(t,a,n){f(a),e.changeSearchParam("taskStatus",a)},onEnter:O,name:"Filter Task Status..."})})]})},mu=function(e){var t=s.a.useState({task:[]}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Output"),x=Object(u.a)(m,2),y=x[0],v=x[1],k=s.a.useState(""),w=Object(u.a)(k,2),C=w[0],S=w[1],D=Object(f.a)(h.b),I=function(e){O.b.dismiss(),l(e.task_aggregate.aggregate.count),i({task:e.task})},T=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},$=Object(pt.a)(ou,{fetchPolicy:"no-cache",onCompleted:I,onError:T}),P=Object(u.a)($,1)[0],A=Object(pt.a)(su,{fetchPolicy:"no-cache",onCompleted:I,onError:T}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(lu,{fetchPolicy:"no-cache",onCompleted:I,onError:T}),q=Object(u.a)(F,1)[0],N=function(e){var t=e.search,a=e.offset,n=e.taskStatus;O.b.info("Searching...",{persist:!0}),p(t);var i=t;""===t&&(i="_");var r=n;""===r&&(r="_"),P({variables:{operation_id:D.user.current_operation_id,offset:a,fetchLimit:cu,search:"%"+i+"%",status:"%"+r+"%"}})},R=function(e){var t=e.search,a=e.offset,n=e.taskStatus;O.b.info("Searching...",{persist:!0}),p(t);var i=t;""===t&&(i="_");var r=n;""===r&&(r="_"),E({variables:{operation_id:D.user.current_operation_id,offset:a,fetchLimit:cu,search:"%"+i+"%",status:"%"+r+"%"}})},B=function(e){var t=e.search,a=e.offset,n=e.taskStatus;O.b.info("Searching...",{persist:!0});var i=t;console.log("search",t),""===t&&(i="_");var r=n;""===r&&(r="_"),p(t),q({variables:{operation_id:D.user.current_operation_id,offset:a,fetchLimit:cu,search:"%"+i+"%",status:"%"+r+"%"}})};return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)(pu,{onChangeSearchField:function(e){v(e)},onOutputSearch:N,value:e.value,index:e.index,onChangeTaskStatus:function(e){S(e)},onParameterSearch:R,onCommentSearch:B,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.task.length>0?n.task.map((function(e){return Object(g.jsx)(Xd.a,{task:e,command_id:null==e.command?0:e.command.id},"taskinteractdisplay"+e.id)})):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(o/cu),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Output":N({search:j,offset:0,taskStatus:C});break;case"Parameters":R({search:j,offset:0,taskStatus:C});break;case"Comment":B({search:j,offset:0,taskStatus:C})}else switch(y){case"Output":N({search:j,offset:(t-1)*cu,taskStatus:C});break;case"Parameters":R({search:j,offset:(t-1)*cu,taskStatus:C});break;case"Comment":B({search:j,offset:(t-1)*cu,taskStatus:C})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},hu=a(313),fu=a.n(hu),Ou=Object(Se.a)((function(e){return{root:Object(jt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),gu=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=Ou(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)(qa.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ie.a,{style:{backgroundColor:a.palette.success.main},children:[Object(g.jsxs)(Ra.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(L.a,{variant:"subtitle2",className:n.typography,children:e.title}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(E.a,{"aria-label":"Show more",className:Object(Na.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(Ma.a,{})}),Object(g.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(za.a,{})})]})]}),Object(g.jsx)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(g.jsxs)(T.a,{className:n.collapse,children:[Object(g.jsx)(L.a,{gutterBottom:!0,children:e.innerText}),Object(g.jsxs)(b.a,{size:"small",className:n.button,download:!0,href:e.downloadLink,children:[Object(g.jsx)(Ua.a,{className:n.checkIcon}),"Download now"]})]})})]})})})),xu=a(367),yu=a.n(xu),_u=a(298),vu=Object(be.a)(uu||(uu=Object(v.a)(["\nmutation downloadBulkMutation($files: [String!]!){\n    download_bulk(files: $files){\n        status\n        error\n        file_id\n    }\n}\n"]))),ku=Object(be.a)(bu||(bu=Object(v.a)(["\nmutation updateFileMutation($file_id: Int!){\n    deleteFile(file_id: $file_id) {\n        status\n        error\n        file_ids\n    }\n}\n"]))),wu=Object(be.a)(ju||(ju=Object(v.a)(["\nmutation updateCommentMutation($file_id: Int!, $comment: String!){\n    update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function Cu(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=function(e,t){i(Object(_.a)(Object(_.a)({},n),{},Object(jt.a)({},e,t)))};Object(o.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.id,!1))}),{});i(t),d(Object(y.a)(e.files))}),[e.files]);var p=Object(pe.a)(vu,{onCompleted:function(e){O.b.dismiss(),"success"===e.download_bulk.status?O.b.success("",{persist:!0,content:function(t){return Object(g.jsx)(gu,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):O.b.error(e.error)},onError:function(e){console.log(e),O.b.error("Failed to zip up files")}}),m=Object(u.a)(p,1)[0],h=function(e){var t=e.file_ids,a=l.map((function(e){return t.includes(e.id)?Object(_.a)(Object(_.a)({},e),{},{deleted:!0}):Object(_.a)({},e)}));d(a)},f=function(e){var t=e.id,a=e.comment,n=l.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{comment:a}):Object(_.a)({},e)}));d(n)};return Object(g.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(g.jsxs)(b.a,{size:"small",onClick:function(){O.b.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var r=Object(u.a)(i[a],2),c=r[0];if(r[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(c)&&t.push(e.files[o].agent_file_id)}m({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(g.jsx)(yu.a,{}),"Zip & Download Selected"]}),Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"}}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(C.a,{children:"File"}),Object(g.jsx)(C.a,{children:"Time"}),Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:"Comment"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"More"})]})}),Object(g.jsx)(w.a,{children:l.map((function(e){return Object(g.jsx)(Su,Object(_.a)({onToggleSelection:j,onEditComment:f,selected:n,onDelete:h},e),"file"+e.id)}))})]})]})}function Su(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(f.a)(h.b),x=Object(ee.a)(),y=Object(pe.a)(ku,{onCompleted:function(t){O.b.dismiss(),e.onDelete(t.deleteFile)},onError:function(e){console.log(e),O.b.error("Failed to delete file")}}),_=Object(u.a)(y,1)[0],v=Object(pe.a)(wu,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),F=Object(u.a)(v,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(ha,{onClose:function(){i(!1)},onSubmit:function(){_({variables:{file_id:e.id}})},open:n}),Object(g.jsx)(C.a,{children:e.deleted?null:Object(g.jsx)(oo.a,{title:"Toggle to download multiple files at once",children:Object(g.jsx)($.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(g.jsx)(C.a,{children:e.deleted?null:Object(g.jsx)(E.a,{size:"small",onClick:function(){i(!0)},style:{color:x.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})})}),Object(g.jsx)(C.a,{children:e.deleted?Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(g.jsxs)(L.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,m.user.view_utc_time)})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(g.jsxs)(C.a,{children:[e.comment,Object(g.jsx)(E.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit File Comment",onSubmit:function(t){F({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(E.a,{size:"small","aria-label":"expand row",onClick:function(){return l(!o)},children:o?Object(g.jsx)(R.a,{className:"mythicElement"}):Object(g.jsx)(q.a,{className:"mythicElement"})})})]}),o?Object(g.jsx)(I.a,{children:Object(g.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(g.jsx)(A.a,{in:o,children:Object(g.jsx)(P.a,{margin:1,children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"16rem"},children:"md5"}),Object(g.jsx)(C.a,{style:{width:"20rem"},children:"sha1"}),Object(g.jsx)(C.a,{style:{width:"20rem"},children:"UUID"}),Object(g.jsx)(C.a,{children:"Operator"}),Object(g.jsx)(C.a,{style:{width:"6rem"},children:"Task"}),Object(g.jsx)(C.a,{children:"Task Comment"}),Object(g.jsx)(C.a,{children:"Command"})]})}),Object(g.jsx)(w.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(g.jsx)(C.a,{children:null===e.task?null:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(C.a,{children:null!==e.task?Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(g.jsx)(C.a,{children:null===e.task?null:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function Du(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=function(e,t){i(Object(_.a)(Object(_.a)({},n),{},Object(jt.a)({},e,t)))};Object(o.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(_.a)(Object(_.a)({},e),{},Object(jt.a)({},t.id,!1))}),{});i(t),d(Object(y.a)(e.files))}),[e.files]);var p=Object(pe.a)(vu,{onCompleted:function(e){O.b.dismiss(),"success"===e.download_bulk.status?O.b.success("",{persist:!0,content:function(t){return Object(g.jsx)(gu,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):O.b.error(e.error)},onError:function(e){console.log(e),O.b.error("Failed to zip up files")}}),m=Object(u.a)(p,1)[0],h=function(e){var t=e.file_ids,a=l.map((function(e){return t.includes(e.id)?Object(_.a)(Object(_.a)({},e),{},{deleted:!0}):Object(_.a)({},e)}));d(a)},f=function(e){var t=e.id,a=e.comment,n=l.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{comment:a}):Object(_.a)({},e)}));d(n)};return Object(g.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(g.jsxs)(b.a,{size:"small",onClick:function(){O.b.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var r=Object(u.a)(i[a],2),c=r[0];if(r[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(c)&&t.push(e.files[o].agent_file_id)}m({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(g.jsx)(yu.a,{}),"Zip & Download Selected"]}),Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"}}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(C.a,{children:"Source"}),Object(g.jsx)(C.a,{children:"Destination"}),Object(g.jsx)(C.a,{children:"Time"}),Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:"Comment"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"More"})]})}),Object(g.jsx)(w.a,{children:l.map((function(e){return Object(g.jsx)(Iu,Object(_.a)({onToggleSelection:j,onEditComment:f,selected:n,onDelete:h},e),"file"+e.id)}))})]})]})}function Iu(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(f.a)(h.b),x=Object(ee.a)(),y=Object(pe.a)(ku,{onCompleted:function(t){O.b.dismiss(),e.onDelete(t.deleteFile)},onError:function(e){console.log(e),O.b.error("Failed to delete file")}}),_=Object(u.a)(y,1)[0],v=Object(pe.a)(wu,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),F=Object(u.a)(v,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(ha,{onClose:function(){i(!1)},onSubmit:function(){_({variables:{file_id:e.id}})},open:n}),Object(g.jsx)(C.a,{children:e.deleted?null:Object(g.jsx)(oo.a,{title:"Toggle to download multiple files at once",children:Object(g.jsx)($.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(g.jsx)(C.a,{children:e.deleted?null:Object(g.jsx)(E.a,{size:"small",onClick:function(){i(!0)},style:{color:x.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",download:!0,underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.filename_text})}),Object(g.jsx)(C.a,{style:{wordBreak:"break-all"},children:e.deleted?Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(g.jsxs)(L.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,m.user.view_utc_time)})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(g.jsxs)(C.a,{children:[e.comment,Object(g.jsx)(E.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit File Comment",onSubmit:function(t){F({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(E.a,{size:"small","aria-label":"expand row",onClick:function(){return l(!o)},children:o?Object(g.jsx)(R.a,{className:"mythicElement"}):Object(g.jsx)(q.a,{className:"mythicElement"})})})]}),o?Object(g.jsx)(I.a,{children:Object(g.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(g.jsx)(A.a,{in:o,children:Object(g.jsx)(P.a,{margin:1,children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"md5"}),Object(g.jsx)(C.a,{children:"sha1"}),Object(g.jsx)(C.a,{children:"UUID"}),Object(g.jsx)(C.a,{children:"Operator"}),Object(g.jsx)(C.a,{style:{width:"6rem"},children:"Task"}),Object(g.jsx)(C.a,{children:"Task Comment"}),Object(g.jsx)(C.a,{children:"Command"})]})}),Object(g.jsx)(w.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(g.jsx)(C.a,{children:null===e.task?null:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(C.a,{children:null!==e.task?Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(g.jsx)(C.a,{children:null===e.task?null:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function Tu(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.files))}),[e.files]);var r=function(e){var t=e.id,a=e.comment,r=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{comment:a}):Object(_.a)({},e)}));i(r)};return Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"400px"},children:"Thumbnail"}),Object(g.jsx)(C.a,{children:"Filename"}),Object(g.jsx)(C.a,{children:"Time"}),Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:"Comment"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"More"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)($u,Object(_.a)({onEditComment:r},e),"file"+e.id)}))})]})})}function $u(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(f.a)(h.b),c=s.a.useState(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],x=Object(pe.a)(wu,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),y=Object(u.a)(x,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsxs)(C.a,{children:[Object(g.jsx)("img",{onClick:function(){return d(!0)},src:"/api/v1.4/files/screencaptures/"+e.agent_file_id,style:{width:"350px",cursor:"pointer"}}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"xl",open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(_u.a,{href:"/api/v1.4/files/screencaptures/"+e.agent_file_id,onClose:function(){d(!1)}})}),e.chunks_received<e.total_chunks?Object(g.jsxs)(L.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]}):null]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.filename_text})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,r.user.view_utc_time)})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(g.jsxs)(C.a,{children:[e.comment,Object(g.jsx)(E.a,{onClick:function(){return m(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit File Comment",onSubmit:function(t){y({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){m(!1)}})})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(E.a,{size:"small","aria-label":"expand row",onClick:function(){return i(!n)},children:n?Object(g.jsx)(R.a,{className:"mythicElement"}):Object(g.jsx)(q.a,{className:"mythicElement"})})})]}),n?Object(g.jsx)(I.a,{children:Object(g.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(g.jsx)(A.a,{in:n,children:Object(g.jsx)(P.a,{margin:1,children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"md5"}),Object(g.jsx)(C.a,{children:"sha1"}),Object(g.jsx)(C.a,{children:"UUID"}),Object(g.jsx)(C.a,{children:"Operator"}),Object(g.jsx)(C.a,{style:{width:"6rem"},children:"Task"}),Object(g.jsx)(C.a,{children:"Task Comment"}),Object(g.jsx)(C.a,{children:"Command"})]})}),Object(g.jsx)(w.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(g.jsx)(C.a,{children:null===e.task?null:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(C.a,{children:null!==e.task?Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(g.jsx)(C.a,{children:null===e.task?null:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}var Pu,Au,Eu,Lu,Fu,qu,Nu,Ru,Bu,zu,Wu,Mu,Hu,Uu,Gu=a(524),Vu=a.n(Gu),Ku=Object(be.a)(Pu||(Pu=Object(v.a)(["\nmutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!){\n    update_filebrowserobj_by_pk(pk_columns: {id: $filebrowserobj_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function Qu(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.files))}),[e.files]);var r=function(e){var t=e.id,a=e.comment,r=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{comment:a}):Object(_.a)({},e)}));i(r)};return Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Host / Path"}),Object(g.jsx)(C.a,{children:"Modify Time"}),Object(g.jsx)(C.a,{children:"Comment"}),Object(g.jsx)(C.a,{style:{width:"7rem"},children:"Permissions"}),Object(g.jsx)(C.a,{style:{width:"7rem"},children:"Downloads"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)(Ju,Object(_.a)({onEditComment:r},e),"file"+e.id)}))})]})})}function Ju(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=Object(pe.a)(Ku,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filebrowserobj_by_pk)}}),f=Object(u.a)(h,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(g.jsx)(Y.c,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:e.permissions,onClose:function(){i(!1)}})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:o,onClose:function(){l(!1)},innerDialog:Object(g.jsx)(Ho,{title:"Download History",value:e.filemeta,onClose:function(){l(!1)}})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit File Browser Comment",onSubmit:function(t){f({variables:{filebrowserobj_id:e.id,comment:t}})},value:e.comment,onClose:function(){m(!1)}})}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host}),Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",textDecoration:e.deleted?"strike-through":""},children:e.full_path_text})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.modify_time})}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(E.a,{onClick:function(){return m(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(b.a,{color:"primary",variant:"outlined",onClick:function(){return i(!0)},children:Object(g.jsx)(Vu.a,{})})}),Object(g.jsx)(C.a,{children:e.filemeta.length>0?Object(g.jsx)(oo.a,{title:"View Download History and Download Files",children:Object(g.jsx)(b.a,{color:"primary",variant:"contained",onClick:function(){return l(!0)},children:Object(g.jsx)(as.a,{})})}):null})]})})}var Yu=Object(be.a)(Au||(Au=Object(v.a)(["\nfragment filemetaData on filemeta{\n    agent_file_id\n    chunk_size\n    chunks_received\n    complete\n    deleted\n    filename_text\n    full_remote_path_text\n    host\n    id\n    is_download_from_agent\n    is_payload\n    is_screenshot\n    md5\n    operator {\n        id\n        username\n    }\n    comment\n    sha1\n    timestamp\n    total_chunks\n    task {\n        id\n        comment\n        command {\n            cmd\n            id\n        }\n    }\n}\n"]))),Zu=Object(be.a)(Eu||(Eu=Object(v.a)(["\nfragment filebrowserData on filebrowserobj{\n    comment\n    deleted\n    full_path_text\n    host\n    id\n    is_file\n    modify_time\n    permissions\n    size\n    filemeta {\n        id\n        agent_file_id\n        chunks_received\n        complete\n        total_chunks\n        timestamp\n        task {\n            id\n            comment\n        }\n    }\n}\n"]))),Xu=20,eb=Object(be.a)(Lu||(Lu=Object(v.a)(["\n","\nquery filenameFileMetaUploadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),tb=Object(be.a)(Fu||(Fu=Object(v.a)(["\n","\nquery filenameFileMetaDownloadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),ab=Object(be.a)(qu||(qu=Object(v.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {full_path_text: {_ilike: $filename}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, full_path_text: {_ilike: $filename}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),Zu),nb=Object(be.a)(Nu||(Nu=Object(v.a)(["\n","\nquery hashFileMetaUploadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),ib=Object(be.a)(Ru||(Ru=Object(v.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),rb=Object(be.a)(Bu||(Bu=Object(v.a)(["\n","\nquery commentFileMetaUploadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),cb=Object(be.a)(zu||(zu=Object(v.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),ob=Object(be.a)(Wu||(Wu=Object(v.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),Zu),sb=Object(be.a)(Mu||(Mu=Object(v.a)(["\n","\nquery filenameFileMetaScreenshotQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),lb=Object(be.a)(Hu||(Hu=Object(v.a)(["\n","\nquery hashFileMetaScreenshotQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu),db=Object(be.a)(Uu||(Uu=Object(v.a)(["\n","\nquery commentFileMetaScreenshotQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),Yu);function ub(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"Files",iconComponent:Object(g.jsx)(fu.a,{})},e))}var bb,jb,pb,mb,hb,fb=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1],p=s.a.useState("Filename"),m=Object(u.a)(p,2),h=m[0],f=m[1],x=["Filename","Hash","Comment"],y=s.a.useState("Downloads"),_=Object(u.a)(y,2),v=_[0],k=_[1],w=["Uploads","Downloads","FileBrowser","Screenshots"],C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],T=function(t,a,n,r,c){var o=a||l,s=n||i,d=c||v;switch(r||h){case"Filename":e.onFilenameSearch({search:o,searchHost:s,offset:0,adjustedSearchLocation:d});break;case"Hash":e.onHashSearch({search:o,searchHost:s,offset:0,adjustedSearchLocation:d});break;case"Comment":e.onCommentSearch({search:o,searchHost:s,offset:0,adjustedSearchLocation:d})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="",i="Filename",c="Downloads";t.has("search")&&(d(t.get("search")),a=t.get("search")),t.has("searchField")&&x.includes(t.get("searchField"))?(f(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),i=t.get("searchField")):(f("Filename"),e.onChangeSearchField("Filename"),e.changeSearchParam("searchField","Filename")),t.has("location")&&w.includes(t.get("location"))&&(k(t.get("location")),c=t.get("location"),e.onChangeSearchLocation(t.get("location"))),t.has("host")&&(r(t.get("host")),n=t.get("host")),I(!D),T(0,a,n,i,c)}}),[e.value,e.index]),Object(g.jsxs)(ft.a,{container:!0,spacing:1,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(ft.a,{item:!0,xs:2,children:Object(g.jsx)(j.a,{placeholder:"Host Name Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("host",a)},onEnter:T,name:"Host Name Search..."})}),Object(g.jsx)(ft.a,{item:!0,xs:3,children:Object(g.jsx)(j.a,{placeholder:"Search...",value:l,onChange:function(t,a,n){d(a),e.changeSearchParam("search",a)},onEnter:T,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(oo.a,{title:"Search",children:Object(g.jsx)(E.a,{onClick:T,children:Object(g.jsx)(iu.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(ft.a,{item:!0,xs:2,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search File's"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:h,onChange:function(t){f(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:x.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(g.jsxs)(ft.a,{item:!0,xs:2,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search Location"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:v,onChange:function(t){k(t.target.value),e.onChangeSearchLocation(t.target.value),e.changeSearchParam("location",t.target.value)},children:w.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchlocopt"+e)}))})]}),Object(g.jsx)(ft.a,{item:!0,xs:2,children:Object(g.jsxs)(b.a,{variant:"contained",color:"primary",component:"label",children:["Host File in Mythic ",Object(g.jsx)("input",{onChange:function(e){!function(e){try{var t=new XMLHttpRequest,a=new FormData;t.open("POST",window.location.origin+"/api/v1.4/files/manual",!0),t.setRequestHeader("Authorization","Bearer "+localStorage.getItem("access_token")),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status)try{var e=JSON.parse(t.responseText);"success"===e.status?O.b.success("Successfuly hosted file! Now searchable on the 'Uploads' search"):O.b.error("Failed to host file! "+e.error)}catch(n){O.b.error("Failed to process response from upload: "+n),console.log(n)}else 4!==t.readyState||302!==t.status&&405!==t.status?4===t.readyState&&(console.log("httpGetAsync Error with data: "+a),O.b.error("Mythic hit an error trying to hos the file: "+t.status+": "+t.statusText)):(console.log("httpGetAsync was 302 or 405 from url "),O.b.error("Got HTTP 302 or 405 when trying to host file"))},a.append("upload_file",e),t.send(a)}catch(n){O.b.error("HTTP Browser error trying to upload file: "+n.toString()),console.error("HTTP Browser error: "+n.toString())}}(e.target.files[0])},type:"file",hidden:!0})]})})]})},Ob=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(0),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState(""),x=Object(u.a)(m,2),y=x[0],v=x[1],k=s.a.useState(""),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState("Filename"),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState("Downloads"),A=Object(u.a)(P,2),E=A[0],F=A[1],q=Object(f.a)(h.b),N=function(e){O.b.dismiss(),p(e.filemeta_aggregate.aggregate.count),l([]),i(e.filemeta)},R=function(e){O.b.dismiss(),p(e.filebrowserobj_aggregate.aggregate.count),l(e.filebrowserobj),i([])},B=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},z=Object(pt.a)(eb,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),W=Object(u.a)(z,1)[0],M=Object(pt.a)(tb,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),H=Object(u.a)(M,1)[0],U=Object(pt.a)(ab,{fetchPolicy:"no-cache",onCompleted:R,onError:B}),G=Object(u.a)(U,1)[0],V=Object(pt.a)(sb,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),K=Object(u.a)(V,1)[0],Q=Object(pt.a)(nb,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),J=Object(u.a)(Q,1)[0],Y=Object(pt.a)(ib,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),Z=Object(u.a)(Y,1)[0],X=Object(pt.a)(lb,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),ee=Object(u.a)(X,1)[0],te=Object(pt.a)(rb,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),ae=Object(u.a)(te,1)[0],ne=Object(pt.a)(cb,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),ie=Object(u.a)(ne,1)[0],re=Object(pt.a)(ob,{fetchPolicy:"no-cache",onCompleted:R,onError:B}),ce=Object(u.a)(re,1)[0],oe=Object(pt.a)(db,{fetchPolicy:"no-cache",onCompleted:N,onError:B}),se=Object(u.a)(oe,1)[0],le=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;O.b.info("Searching...",{persist:!0}),v(t),S(a),"FileBrowser"===i?G({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,filename:"%"+t+"%",host:"%"+a+"%"}}):"Uploads"===i?W({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,filename:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===i?H({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,filename:"%"+t+"%",host:"%"+a+"%"}}):K({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,filename:"%"+t+"%",host:"%"+a+"%"}})},de=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;O.b.info("Searching...",{persist:!0}),v(t),S(a),"FileBrowser"===i?(O.b.dismiss(),O.b.warning("FileBrowser doesn't currently track file hashes")):"Uploads"===i?J({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,hash:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===i?Z({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,hash:"%"+t+"%",host:"%"+a+"%"}}):ee({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,hash:"%"+t+"%",host:"%"+a+"%"}})},ue=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;O.b.info("Searching...",{persist:!0});var r=t;""===t&&(r="_"),v(r),S(a),"FileBrowser"===i?ce({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,comment:"%"+r+"%",host:"%"+a+"%"}}):"Uploads"===i?ae({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,comment:"%"+r+"%",host:"%"+a+"%"}}):"Downloads"===i?ie({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,comment:"%"+r+"%",host:"%"+a+"%"}}):se({variables:{operation_id:q.user.current_operation_id,offset:n,fetchLimit:Xu,comment:"%"+r+"%",host:"%"+a+"%"}})};return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)(fb,{onChangeSearchField:function(e){$(e)},onFilenameSearch:le,value:e.value,index:e.index,queryParams:e.queryParams,onHashSearch:de,onCommentSearch:ue,onChangeSearchLocation:function(e){F(e),i([]),l([])},changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?"Uploads"===E?Object(g.jsx)(Du,{files:n}):"Downloads"===E?Object(g.jsx)(Cu,{files:n}):Object(g.jsx)(Tu,{files:n}):o.length>0?Object(g.jsx)(Qu,{files:o}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(j/Xu),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(T){case"Filename":le({search:y,searchHost:C,offset:0});break;case"Hash":de({search:y,searchHost:C,offset:0});break;case"Comments":ue({search:y,offset:0})}else switch(T){case"Filename":le({search:y,searchHost:C,offset:(t-1)*Xu});break;case"Hash":de({search:y,offset:(t-1)*Xu});break;case"Comments":ue({search:y,offset:(t-1)*Xu})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",j]})]})]}))},gb=a(525),xb=a.n(gb),yb=a(212),_b=a.n(yb),vb=Object(be.a)(bb||(bb=Object(v.a)(["\nmutation updateCommentMutation($credential_id: Int!, $comment: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {comment: $comment}) {\n        comment\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),kb=Object(be.a)(jb||(jb=Object(v.a)(["\nmutation updateAccountMutation($credential_id: Int!, $account: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {account: $account}) {\n        account\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),wb=Object(be.a)(pb||(pb=Object(v.a)(["\nmutation updateAccountMutation($credential_id: Int!, $realm: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {realm: $realm}) {\n        realm\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),Cb=Object(be.a)(mb||(mb=Object(v.a)(["\nmutation updateAccountMutation($credential_id: Int!, $credential: bytea!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {credential_raw: $credential}) {\n        credential_text\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),Sb=Object(be.a)(hb||(hb=Object(v.a)(["\nmutation updateAccountMutation($credential_id: Int!, $deleted: Boolean!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n        operator {\n            username\n        }\n    }\n}\n"])));function Db(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.credentials))}),[e.credentials]);var r=function(e){var t=e.id,a=e.comment,r=e.operator,c=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{comment:a,operator:r}):Object(_.a)({},e)}));i(c)},c=function(e){var t=e.id,a=e.account,r=e.operator,c=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{account:a,operator:r}):Object(_.a)({},e)}));i(c)},l=function(e){var t=e.id,a=e.realm,r=e.operator,c=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{realm:a,operator:r}):Object(_.a)({},e)}));i(c)},d=function(e){var t=e.id,a=e.credential_text,r=e.operator,c=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{credential_text:a,operator:r}):Object(_.a)({},e)}));i(c)},b=function(e){var t=e.id,a=e.deleted,r=e.operator,c=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{deleted:a,operator:r}):Object(_.a)({},e)}));i(c)};return Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(C.a,{children:"Account"}),Object(g.jsx)(C.a,{children:"Realm"}),Object(g.jsx)(C.a,{children:"Credential"}),Object(g.jsx)(C.a,{children:"Comment"}),Object(g.jsx)(C.a,{children:"Timestamp"}),Object(g.jsx)(C.a,{children:"Task / Operator"}),Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Type"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)(Ib,Object(_.a)({onEditComment:r,onEditAccount:c,onEditRealm:l,onEditCredential:d,onEditDeleted:b},e),"cred"+e.id)}))})]})})}function Ib(e){var t=Object(f.a)(h.b),a=Object(ee.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState(!1),l=Object(u.a)(o,2),d=l[0],b=l[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],x=p[1],y=s.a.useState(!1),_=Object(u.a)(y,2),v=_[0],k=_[1],w=s.a.useState(!1),S=Object(u.a)(w,2),D=S[0],T=S[1],$=Object(pe.a)(vb,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_credential_by_pk)}}),P=Object(u.a)($,1)[0],A=Object(pe.a)(kb,{onCompleted:function(t){O.b.success("updated account"),e.onEditAccount(t.update_credential_by_pk)}}),F=Object(u.a)(A,1)[0],q=Object(pe.a)(wb,{onCompleted:function(t){O.b.success("updated realm"),e.onEditRealm(t.update_credential_by_pk)}}),N=Object(u.a)(q,1)[0],R=Object(pe.a)(Cb,{onCompleted:function(t){O.b.success("updated credential"),e.onEditCredential(t.update_credential_by_pk)}}),B=Object(u.a)(R,1)[0],W=Object(pe.a)(Sb,{onCompleted:function(t){O.b.success("updated deleted status"),e.onEditDeleted(t.update_credential_by_pk)}}),M=Object(u.a)(W,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(ha,{onClose:function(){c(!1)},onSubmit:function(){M({variables:{credential_id:e.id,deleted:!e.deleted}})},open:r,acceptText:e.deleted?"Restore":"Remove"}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:d,onClose:function(){b(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Credential Comment",onSubmit:function(t){P({variables:{credential_id:e.id,comment:t}})},value:e.comment,onClose:function(){b(!1)}})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){x(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Credential Account",onSubmit:function(t){F({variables:{credential_id:e.id,account:t}})},value:e.account,onClose:function(){x(!1)}})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:v,onClose:function(){k(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Credential Realm",onSubmit:function(t){N({variables:{credential_id:e.id,realm:t}})},value:e.realm,onClose:function(){k(!1)}})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:D,onClose:function(){T(!1)},innerDialog:Object(g.jsx)(Y.b,{title:"Edit Credential Credential",onSubmit:function(t){B({variables:{credential_id:e.id,credential:t}})},value:e.credential_text,onClose:function(){T(!1)}})}),Object(g.jsxs)(C.a,{children:[e.deleted?Object(g.jsx)(oo.a,{title:"Restore Credential for use in Tasking",children:Object(g.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(g.jsx)(_b.a,{})})}):Object(g.jsx)(oo.a,{title:"Delete Credential so it can't be used in Tasking",children:Object(g.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})})})," "]}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(E.a,{onClick:function(){return x(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.account})]}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(E.a,{onClick:function(){return k(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.realm})]}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(E.a,{onClick:function(){return T(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",maxWidth:"40rem"},children:e.credential_text})]}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(E.a,{onClick:function(){return b(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,t.user.view_utc_time)})}),Object(g.jsx)(C.a,{children:null!==e.task_id?e.task_id:e.operator.username}),Object(g.jsx)(C.a,{children:e.type})]})})}var Tb,$b,Pb,Ab,Eb,Lb,Fb=a(169),qb=Object(be.a)(Tb||(Tb=Object(v.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),Nb=20,Rb=Object(be.a)($b||($b=Object(v.a)(["\n","\nquery accountQuery($operation_id: Int!, $account: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),qb),Bb=Object(be.a)(Pb||(Pb=Object(v.a)(["\n","\nquery accountQuery($operation_id: Int!, $realm: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),qb),zb=Object(be.a)(Ab||(Ab=Object(v.a)(["\n","\nquery accountQuery($operation_id: Int!, $credential: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),qb),Wb=Object(be.a)(Eb||(Eb=Object(v.a)(["\n","\nquery accountQuery($operation_id: Int!, $comment: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),qb),Mb=Object(be.a)(Lb||(Lb=Object(v.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      id\n    }\n  }\n"])),qb);function Hb(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"Credentials",iconComponent:Object(g.jsx)(xb.a,{})},e))}var Ub,Gb,Vb,Kb,Qb,Jb,Yb,Zb=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Account"),o=Object(u.a)(c,2),l=o[0],d=o[1],p=["Account","Realm","Comment","Credential"],m=s.a.useState(!1),h=Object(u.a)(m,2),f=h[0],x=h[1],y=Object(pe.a)(Mb,{fetchPolicy:"no-cache",onCompleted:function(e){O.b.success("Successfully created new credential")},onError:function(e){O.b.error("Failed to create credential"),console.log(e)}}),_=Object(u.a)(y,1)[0],v=function(t,a,n){var r=a||i;switch(n||l){case"Account":e.onAccountSearch({search:r,offset:0});break;case"Realm":e.onRealmSearch({search:r,offset:0});break;case"Comment":e.onCommentSearch({search:r,offset:0});break;case"Credential":e.onCredentialSearch({search:r,offset:0});break;case"Type":e.OnTypeSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Account";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&p.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Account"),e.onChangeSearchField("Account"),e.changeSearchParam("searchField","Account")),v(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(ft.a,{item:!0,xs:5,children:Object(g.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:v,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(oo.a,{title:"Search",children:Object(g.jsx)(E.a,{onClick:v,children:Object(g.jsx)(iu.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(ft.a,{item:!0,xs:2,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search Credential's"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:p.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(g.jsxs)(ft.a,{item:!0,xs:2,children:[Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:f,onClose:function(){x(!1)},innerDialog:Object(g.jsx)(Fb.a,{onSubmit:function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,r=e.credential;_({variables:{type:t,account:a,realm:n,comment:i,credential:r}})},onClose:function(){x(!1)}})}),Object(g.jsx)(b.a,{size:"small",color:"primary",onClick:function(){x(!0)},variant:"contained",children:"New Credential"})]})]})},Xb=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Account"),x=Object(u.a)(m,2),y=x[0],v=x[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.credential_aggregate.aggregate.count),i(e.credential)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(Rb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(Bb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(zb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(Wb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Nb,account:"%"+t+"%"}})},q=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Nb,realm:"%"+t+"%"}})},N=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Nb,credential:"%"+t+"%"}})},R=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Nb,comment:"%"+n+"%"}})};return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)(Zb,{onChangeSearchField:function(e){v(e),i([])},onAccountSearch:F,value:e.value,index:e.index,onRealmSearch:q,onCredentialSearch:N,onCommentSearch:R,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(Db,{credentials:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(o/Nb),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Account":F({search:j,offset:0});break;case"Realm":q({search:j,offset:0});break;case"Credential":N({search:j,offset:0});break;case"Comment":R({search:j,offset:0})}else switch(y){case"Account":F({search:j,offset:(t-1)*Nb});break;case"Realm":q({search:j,offset:(t-1)*Nb});break;case"Credential":N({search:j,offset:(t-1)*Nb});break;case"Comment":R({search:j,offset:(t-1)*Nb})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))};function ej(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(o.useEffect)((function(){for(var t=e.keylogs.reduce((function(e,t){return void 0===e[t.user]?e[t.user]=Object(jt.a)({},t.task.callback.host,Object(jt.a)({},t.window,[Object(_.a)({},t)])):"undefined"===e[t.user][t.task.callback.host]?e[t.user][t.task.callback.host]=Object(jt.a)({},t.window,[Object(_.a)({},t)]):void 0===e[t.user][t.task.callback.host][t.window]?e[t.user][t.task.callback.host][t.window]=[Object(_.a)({},t)]:e[t.user][t.task.callback.host][t.window].push(Object(_.a)({},t)),Object(_.a)({},e)}),{}),a=[],n=0,r=Object.entries(t);n<r.length;n++){for(var c=Object(u.a)(r[n],2),o=c[0],s=c[1],l=[],d=0,b=Object.entries(s);d<b.length;d++){for(var j=Object(u.a)(b[d],2),p=j[0],m=j[1],h=[],f=0,O=Object.entries(m);f<O.length;f++){var g=Object(u.a)(O[f],2),x=g[0],y=g[1];h.push({name:x,value:y})}l.push({name:p,value:h})}a.push({name:o,value:l})}i([].concat(a))}),[e.keylogs]),Object(g.jsx)(ft.a,{container:!0,spacing:0,direction:"row",columns:12,children:n.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(ft.a,{item:!0,xs:2,style:{borderBottom:"2px solid grey"},children:e.name}),Object(g.jsx)(ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:"2px solid grey"},children:e.value.map((function(t,a){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(ft.a,{item:!0,xs:2,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.name}),Object(g.jsx)(ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.value.map((function(a,n){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(ft.a,{item:!0,xs:2,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:[" ",a.name," "]}),Object(g.jsx)(ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:Object(g.jsx)(ft.a,{item:!0,xs:12,children:a.value.map((function(n,i){return Object(g.jsx)("span",{children:n.keystrokes_text},e.name+t.name+a.name+i)}))})})]},e.name+t.name+a.name)}))})]},e.name+t.name)}))})]},e.name)}))})}var tj=Object(be.a)(Ub||(Ub=Object(v.a)(["\nfragment keylogData on keylog{\n    keystrokes_text\n    task {\n        id\n        callback {\n            host\n            id\n        }\n    }\n    user\n    window\n    timestamp\n    id\n}\n"]))),aj=200,nj=Object(be.a)(Gb||(Gb=Object(v.a)(["\n","\nquery keylogQuery($operation_id: Int!, $keylog: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),tj),ij=Object(be.a)(Vb||(Vb=Object(v.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: user, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: user, offset: $offset, order_by: {user: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),tj),rj=Object(be.a)(Kb||(Kb=Object(v.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),tj),cj=Object(be.a)(Qb||(Qb=Object(v.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),tj),oj=Object(be.a)(Jb||(Jb=Object(v.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: window, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: window, offset: $offset, order_by: {window: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),tj),sj=Object(be.a)(Yb||(Yb=Object(v.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),tj);function lj(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"Keylogs",iconComponent:Object(g.jsx)(nd.a,{})},e))}var dj,uj,bj,jj,pj=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Keystroke"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Keystroke","User","Program","Host"],p=function(t,a,n){var r=a||i;switch(n||l){case"Keystroke":e.onKeylogSearch({search:r,offset:0});break;case"User":e.onUserSearch({search:r,offset:0});break;case"Program":e.onProgramSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Keystroke";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Keystroke"),e.onChangeSearchField("Keystroke"),e.changeSearchParam("searchField","Keystroke")),p(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(oo.a,{title:"Search",children:Object(g.jsx)(E.a,{onClick:p,children:Object(g.jsx)(iu.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(ft.a,{item:!0,xs:2,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search Keylog's"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},mj=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Keystroke"),x=Object(u.a)(m,2),y=x[0],v=x[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(nj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(rj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(ij,{fetchPolicy:"no-cache",onCompleted:function(e){O.b.dismiss(),0===e.keylog_aggregate.aggregate.count?O.b.info("No Results"):O.b.success("Showing One Entry for Each Unique User"),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),P=Object(u.a)($,1)[0],A=Object(pt.a)(cj,{fetchPolicy:"no-cache",onCompleted:w,onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(oj,{fetchPolicy:"no-cache",onCompleted:function(e){O.b.dismiss(),0===e.keylog_aggregate.aggregate.count?O.b.info("No Results"):O.b.success("Showing One Entry for Each Unique Program"),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),q=Object(u.a)(F,1)[0],N=Object(pt.a)(sj,{fetchPolicy:"no-cache",onCompleted:w,onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),R=Object(u.a)(N,1)[0],B=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:aj,keylog:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),""===t?P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:aj,user:"%_%"}}):T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:aj,user:"%"+t+"%"}})},W=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),""===t?q({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:aj,program:"%_%"}}):E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:aj,program:"%"+t+"%"}})},M=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),R({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:aj,host:"%"+n+"%"}})};return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)(pj,{onChangeSearchField:function(e){v(e),i([])},onKeylogSearch:B,value:e.value,index:e.index,onUserSearch:z,onProgramSearch:W,onHostSearch:M,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(ej,{keylogs:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(o/aj),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Keystroke":B({search:j,offset:0});break;case"User":z({search:j,offset:0});break;case"Program":W({search:j,offset:0});break;case"Host":M({search:j,offset:0})}else switch(y){case"Keystroke":B({search:j,offset:(t-1)*aj});break;case"User":z({search:j,offset:(t-1)*aj});break;case"Program":W({search:j,offset:(t-1)*aj});break;case"Host":M({search:j,offset:(t-1)*aj})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},hj=a(209),fj=a.n(hj),Oj=a(300),gj=Object(be.a)(dj||(dj=Object(v.a)(["\nmutation updateComment ($token_id: Int!, $description: String) {\n  update_token_by_pk(pk_columns: {id: $token_id}, _set: {description: $description}) {\n    description\n    id\n  }\n}\n"]))),xj=Object(be.a)(uj||(uj=Object(v.a)(["\nquery getCommentQuery ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    description\n    id\n  }\n}\n"])));function yj(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(je.a)(xj,{variables:{token_id:e.token_id},onCompleted:function(e){i(e.token_by_pk.description)},fetchPolicy:"network-only"});var r=Object(pe.a)(gj,{onCompleted:function(t){console.log("udpated"),e.onClose()},onError:function(t){console.error(t),e.onClose()}}),c=Object(u.a)(r,1)[0],l=function(){c({variables:{token_id:e.token_id,description:n}})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Edit Token Description"}),Object(g.jsx)(G.a,{dividers:!0,children:Object(g.jsx)(j.a,{autoFocus:!0,onEnter:l,onChange:function(e,t,a){i(t)},value:n})}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:l,variant:"contained",color:"secondary",children:"Submit"})]})]})}var _j,vj,kj,wj,Cj,Sj=Object(be.a)(bj||(bj=Object(v.a)(["\nmutation updateCredentialDeletedMutation($token_id: Int!, $deleted: Boolean!){\n    update_token_by_pk(pk_columns: {id: $token_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n    }\n}\n"]))),Dj=Object(be.a)(jj||(jj=Object(v.a)(["\nmutation updateCallbacksOfDeletedTokenMutation($token_id: Int!, $deleted: Boolean!){\n    update_callbacktoken(where: {token_id: {_eq: $token_id}}, _set: {deleted: $deleted}) {\n        affected_rows\n    }\n}\n"])));function Ij(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.tokens))}),[e.credentials]);var r=function(e){var t=e.id,a=e.deleted,r=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{deleted:a}):Object(_.a)({},e)}));i(r)};return Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(C.a,{children:"User"}),Object(g.jsx)(C.a,{children:"Groups"}),Object(g.jsx)(C.a,{children:"TokenId"}),Object(g.jsx)(C.a,{children:"Logon Session"}),Object(g.jsx)(C.a,{children:"Description"}),Object(g.jsx)(C.a,{children:"Task"}),Object(g.jsx)(C.a,{children:"Callbacks With Handles"}),Object(g.jsx)(C.a,{children:"Host"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)(Tj,Object(_.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function Tj(e){var t,a=Object(ee.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState(!1),l=Object(u.a)(o,2),d=l[0],b=l[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(pe.a)(Dj,{onCompleted:function(e){O.b.success("Removed token from callback")},onError:function(e){O.b.error("Operation not allowed")}}),x=Object(u.a)(f,1)[0],y=Object(pe.a)(Sj,{onCompleted:function(t){O.b.success("Updated deleted status"),null===e.callbacktokens||e.deleted||x({variables:{token_id:e.id,deleted:!0}}),e.onEditDeleted(t.update_token_by_pk)},onError:function(e){O.b.error("Operation not allowed")}}),_=Object(u.a)(y,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(ha,{onClose:function(){c(!1)},onSubmit:function(){_({variables:{token_id:e.id,deleted:!e.deleted}})},open:r,acceptText:e.deleted?"Restore":"Remove"}),Object(g.jsxs)(C.a,{children:[e.deleted?Object(g.jsx)(oo.a,{title:"Restore Token for use in Tasking",children:Object(g.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(g.jsx)(_b.a,{})})}):Object(g.jsx)(oo.a,{title:"Delete Token so it can't be used in Tasking",children:Object(g.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})})})," "]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.User})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.Groups})}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.TokenId}),Object(g.jsx)(oo.a,{title:"View Token Information",children:Object(g.jsx)(E.a,{size:"small",color:"primary",onClick:function(){b(!0)},children:Object(g.jsx)(fj.a,{})})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:d,onClose:function(){b(!1)},innerDialog:Object(g.jsx)(Oj.a,{token_id:e.id,onClose:function(){b(!1)}})})]}),Object(g.jsx)(C.a,{children:null===e.logonsession?Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:"No Logon Session Data"}):Object(g.jsxs)(s.a.Fragment,{children:[e.logonsession.LogonId," ",null!==e.logonsession.LogonType?" ("+e.logonsession.LogonType+")":null]})}),Object(g.jsxs)(C.a,{children:[Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description}),Object(g.jsx)(E.a,{onClick:function(){return h(!0)},size:"small",children:Object(g.jsx)(vi.a,{})}),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){h(!1)},innerDialog:Object(g.jsx)(yj,{token_id:e.id,onClose:function(){h(!1)}})})]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(C.a,{children:(null===(t=e.callbacktokens)||void 0===t?void 0:t.map((function(e){return e.callback_id})))||null}),Object(g.jsx)(C.a,{children:e.host})]})})}var $j=Object(be.a)(_j||(_j=Object(v.a)(["\nfragment tokenData on token{\n    id\n    User\n    Groups\n    TokenId\n    logonsession {\n        LogonType\n        UserName\n        LogonDomain\n        id\n        LogonId\n        authenticationpackages(where: {deleted: {_eq: false}}) {\n            Name\n            id\n        }\n    }\n    task {\n        id\n    }\n    host\n    deleted\n    description\n    callbacktokens(where: {deleted: {_eq: false}}) {\n        callback_id\n        id\n    }\n}\n"]))),Pj=20,Aj=Object(be.a)(vj||(vj=Object(v.a)(["\n","\nquery usergroupQuery($operation_id: Int!, $name: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      ...tokenData\n    }\n}\n"])),$j),Ej=Object(be.a)(kj||(kj=Object(v.a)(["\n","\nquery sidQuery($operation_id: Int!, $sid: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      ...tokenData\n    }\n}\n"])),$j),Lj=Object(be.a)(wj||(wj=Object(v.a)(["\n","\nquery logontypeQuery($operation_id: Int!, $logontype: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n  }\n"])),$j),Fj=Object(be.a)(Cj||(Cj=Object(v.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n}\n"])),$j);function qj(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"Tokens",iconComponent:Object(g.jsx)(fj.a,{})},e))}var Nj,Rj,Bj,zj,Wj,Mj,Hj=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("User/Group"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["User/Group","SID","LogonType","Host"],p=function(t,a,n){var r=a||i;switch(n||l){case"User/Group":e.onUserGroupSearch({search:r,offset:0});break;case"SID":e.onSIDSearch({search:r,offset:0});break;case"LogonType":e.onLogonTypeSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User/Group";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User/Group"),e.onChangeSearchField("User/Group"),e.changeSearchParam("searchField","User/Group")),p(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(oo.a,{title:"Search",children:Object(g.jsx)(E.a,{onClick:p,children:Object(g.jsx)(iu.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(ft.a,{item:!0,xs:2,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search Tokens by"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},Uj=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("User/Group"),x=Object(u.a)(m,2),y=x[0],v=x[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.token_aggregate.aggregate.count),i(e.token)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(Aj,{fetchPolicy:"network-only",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(Ej,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(Lj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(Fj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Pj,name:"%"+n+"%"}})},q=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Pj,logontype:"%"+n+"%"}})},N=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Pj,host:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Pj,sid:"%"+n+"%"}})};return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)(Hj,{onChangeSearchField:function(e){v(e),i([])},onUserGroupSearch:F,value:e.value,index:e.index,onLogonTypeSearch:q,onHostSearch:N,onSIDSearch:R,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(Ij,{tokens:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(o/Pj),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"User/Group":F({search:j,offset:0});break;case"SID":R({search:j,offset:0});break;case"LogonType":q({search:j,offset:0});break;case"Host":N({search:j,offset:0})}else switch(y){case"User/Group":F({search:j,offset:(t-1)*Pj});break;case"SID":R({search:j,offset:(t-1)*Pj});break;case"LogonType":q({search:j,offset:(t-1)*Pj});break;case"Host":N({search:j,offset:(t-1)*Pj})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},Gj=a(238),Vj=a.n(Gj);function Kj(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.callbacks))}),[e.callbacks]);var r=function(e){var t=e.id,a=e.active,r=n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{active:a}):Object(_.a)({},e)}));i(r)};return Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"auto"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Hide"}),Object(g.jsx)(C.a,{children:"User"}),Object(g.jsx)(C.a,{children:"Domain"}),Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:"Description"}),Object(g.jsx)(C.a,{children:"IP"}),Object(g.jsx)(C.a,{children:"Process Name"}),Object(g.jsx)(C.a,{children:"ID"}),Object(g.jsx)(C.a,{children:"Checkin Times"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)(Qj,Object(_.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function Qj(e){var t=Object(f.a)(h.b),a=Object(ee.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=Object(pe.a)(rd,{onCompleted:function(t){O.b.success("Updated active status"),e.onEditDeleted({id:e.id,active:!e.active})},onError:function(e){O.b.error("Operation not allowed")}}),l=Object(u.a)(o,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(ha,{onClose:function(){c(!1)},onSubmit:function(){l({variables:{callback_id:e.id,active:!e.active}})},open:r,acceptText:e.active?"Hide":"Restore"}),Object(g.jsxs)(C.a,{children:[e.active?Object(g.jsx)(oo.a,{title:"Hide Callback so it can't be used in Tasking",children:Object(g.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})})}):Object(g.jsx)(oo.a,{title:"Restore Callback for Tasking",children:Object(g.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(g.jsx)(_b.a,{})})})," "]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(g.jsx)(C.a,{children:e.host}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(g.jsx)(C.a,{children:e.ip}),Object(g.jsx)(C.a,{children:e.process_name}),Object(g.jsx)(C.a,{children:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})}),Object(g.jsxs)(C.a,{children:[Object(g.jsxs)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Initial: ",Object(Z.b)(e.init_callback,t.user.view_utc_time)]}),Object(g.jsxs)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Latest: ",Object(Z.b)(e.last_checkin,t.user.view_utc_time)]})]})]})})}var Jj=Object(be.a)(Nj||(Nj=Object(v.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n}\n"]))),Yj=50,Zj=Object(be.a)(Rj||(Rj=Object(v.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      ...callbackData\n    }\n}\n"])),Jj),Xj=Object(be.a)(Bj||(Bj=Object(v.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Jj),ep=Object(be.a)(zj||(zj=Object(v.a)(["\n","\nquery domainQuery($operation_id: Int!, $domain: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Jj),tp=Object(be.a)(Wj||(Wj=Object(v.a)(["\n","\nquery domainQuery($operation_id: Int!, $description: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Jj),ap=Object(be.a)(Mj||(Mj=Object(v.a)(["\n","\nquery domainQuery($operation_id: Int!, $ip: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Jj);function np(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"Callbacks",iconComponent:Object(g.jsx)(Vj.a,{})},e))}var ip,rp,cp,op,sp,lp,dp,up=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("User"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["User","Domain","Host","Description","IP"],p=function(t,a,n){var r=a||i;switch(n||l){case"User":e.onUserSearch({search:r,offset:0});break;case"Domain":e.onDomainSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0});break;case"Description":e.onDescriptionSearch({search:r,offset:0});break;case"IP":e.onIPSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User";t.has("search")&&(r(t.get("search")),a=t.get("search")),console.log(t.get("searchField")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User"),e.onChangeSearchField("User"),e.changeSearchParam("searchField","User")),p(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(oo.a,{title:"Search",children:Object(g.jsx)(E.a,{onClick:p,children:Object(g.jsx)(iu.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(ft.a,{item:!0,xs:6,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search Callbacks by"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},bp=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("User"),x=Object(u.a)(m,2),y=x[0],v=x[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.callback_aggregate.aggregate.count),i(e.callback)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(Zj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(ep,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(tp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(Xj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(ap,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),q=Object(u.a)(F,1)[0],N=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Yj,user:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Yj,domain:"%"+n+"%"}})},B=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Yj,host:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Yj,description:"%"+n+"%"}})},W=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),q({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Yj,ip:"%"+n+"%"}})};return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)(up,{onChangeSearchField:function(e){v(e),i([])},onUserSearch:N,onIPSearch:W,value:e.value,index:e.index,onDomainSearch:R,onHostSearch:B,onDescriptionSearch:z,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(Kj,{callbacks:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"5px",paddingBottom:"5px"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(o/Yj),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"User":N({search:j,offset:0});break;case"Domain":R({search:j,offset:0});break;case"Description":z({search:j,offset:0});break;case"Host":B({search:j,offset:0});break;case"IP":W({search:j,offset:0})}else switch(y){case"User":N({search:j,offset:(t-1)*Yj});break;case"Domain":R({search:j,offset:(t-1)*Yj});break;case"Description":z({search:j,offset:(t-1)*Yj});break;case"Host":B({search:j,offset:(t-1)*Yj});break;case"IP":W({search:j,offset:(t-1)*Yj})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},jp=a(314),pp=a.n(jp);function mp(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(o.useEffect)((function(){i(Object(y.a)(e.artifacts))}),[e.artifacts]),Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{},children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Type"}),Object(g.jsx)(C.a,{children:"Command"}),Object(g.jsx)(C.a,{children:"Task"}),Object(g.jsx)(C.a,{children:"Callback"}),Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:"Artifact"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)(hp,Object(_.a)({},e),"cred"+e.id)}))})]})})}function hp(e){return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.artifact.name})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.task.callback_id,children:e.task.callback_id})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.host})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.artifact_instance_text})})]})})}var fp=Object(be.a)(ip||(ip=Object(v.a)(["\nfragment artifactData on taskartifact{\n    id\n    artifact_instance_text\n    host\n    id\n    timestamp\n    artifact {\n        name\n        description\n    }\n    task {\n        id\n        callback_id\n        command {\n            cmd\n        }\n    }\n}\n"]))),Op=100,gp=Object(be.a)(rp||(rp=Object(v.a)(["\n","\nquery artifactQuery($operation_id: Int!, $artifact: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      ...artifactData\n    }\n}\n"])),fp),xp=Object(be.a)(cp||(cp=Object(v.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),fp),yp=Object(be.a)(op||(op=Object(v.a)(["\n","\nquery commandQuery($operation_id: Int!, $command: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),fp),_p=Object(be.a)(sp||(sp=Object(v.a)(["\n","\nquery typeQuery($operation_id: Int!, $type: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),fp),vp=Object(be.a)(lp||(lp=Object(v.a)(["\n","\nquery taskQuery($operation_id: Int!, $task_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),fp),kp=Object(be.a)(dp||(dp=Object(v.a)(["\n","\nquery taskQuery($operation_id: Int!, $callback_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),fp);function wp(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"Artifacts",iconComponent:Object(g.jsx)(pp.a,{})},e))}var Cp,Sp,Dp,Ip=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Artifact"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Artifact","Command","Host","Type","Task","Callback"],p=function(t,a,n){var r=a||i;switch(n||l){case"Artifact":e.onArtifactSearch({search:r,offset:0});break;case"Command":e.onCommandSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0});break;case"Type":e.onTypeSearch({search:r,offset:0});break;case"Task":e.onTaskSearch({search:r,offset:0});break;case"Callback":e.onCallbackSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Artifact";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Artifact"),e.onChangeSearchField("Artifact"),e.changeSearchParam("searchField","Artifact")),p(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(ft.a,{item:!0,xs:6,children:Object(g.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(oo.a,{title:"Search",children:Object(g.jsx)(E.a,{onClick:p,children:Object(g.jsx)(iu.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(ft.a,{item:!0,xs:6,children:[Object(g.jsx)(au.a,{component:"legend",children:"Search Artifacts by"}),Object(g.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},Tp=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Artifact"),x=Object(u.a)(m,2),y=x[0],v=x[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.taskartifact_aggregate.aggregate.count),i(e.taskartifact)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(gp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(yp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(_p,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(xp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(vp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),q=Object(u.a)(F,1)[0],N=Object(pt.a)(kp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),R=Object(u.a)(N,1)[0],B=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Op,artifact:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Op,command:"%"+n+"%"}})},W=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Op,host:"%"+n+"%"}})},M=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Op,type:"%"+n+"%"}})},H=function(e){var t=e.search,a=e.offset;""!==t?(O.b.info("Searching...",{persist:!0}),p(t),q({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Op,task_id:parseInt(t)}})):O.b.warning("Must specify a task number")},U=function(e){var t=e.search,a=e.offset;""!==t?(O.b.info("Searching...",{persist:!0}),p(t),R({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Op,callback_id:t}})):O.b.warning("Must specify a callback number")};return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)(Ip,{onChangeSearchField:function(e){v(e),i([])},onArtifactSearch:B,onTaskSearch:H,value:e.value,index:e.index,onCommandSearch:z,onHostSearch:W,onTypeSearch:M,onCallbackSearch:U,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(mp,{artifacts:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"5px",paddingBottom:"10px"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(o/Op),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Artifact":B({search:j,offset:0});break;case"Command":z({search:j,offset:0});break;case"Type":M({search:j,offset:0});break;case"Host":W({search:j,offset:0});break;case"Task":H({search:j,offset:0});break;case"Callback":U({search:j,offset:0})}else switch(y){case"Artifact":B({search:j,offset:(t-1)*Op});break;case"Command":z({search:j,offset:(t-1)*Op});break;case"Type":M({search:j,offset:(t-1)*Op});break;case"Host":W({search:j,offset:(t-1)*Op});break;case"Task":H({search:j,offset:(t-1)*Op});break;case"Callback":U({search:j,offset:(t-1)*Op})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},$p=Object(be.a)(Cp||(Cp=Object(v.a)(["\nmutation StopSocksMutation($callback_id: Int!){\n    stop_socks(callback_id: $callback_id){\n        status\n        error\n    }\n}\n"])));function Pp(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.callbacks))}),[e.callbacks]);var r=function(e){var t=e.id,a=(e.active,n.map((function(e){return e.id===t?Object(_.a)(Object(_.a)({},e),{},{port:null}):Object(_.a)({},e)})));i(a)};return Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(g.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"5rem"},children:"Stop"}),Object(g.jsx)(C.a,{children:"User"}),Object(g.jsx)(C.a,{children:"Domain"}),Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:"Description"}),Object(g.jsx)(C.a,{children:"ID"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsx)(Ap,Object(_.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function Ap(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(pe.a)($p,{onCompleted:function(t){O.b.success("Stopped Socks on that Port"),e.onEditDeleted({id:e.id})},onError:function(e){O.b.error("Operation not allowed")}}),o=Object(u.a)(c,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(ha,{onClose:function(){r(!1)},onSubmit:function(){o({variables:{callback_id:e.id}})},open:i,acceptText:"Stop Socks"}),Object(g.jsxs)(C.a,{children:[e.port?Object(g.jsx)(oo.a,{title:"Stop Socks Port on Mythic Server",children:Object(g.jsx)(E.a,{size:"small",onClick:function(){r(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(g.jsx)(z.a,{})})}):null," "]}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(g.jsx)(C.a,{children:e.host}),Object(g.jsx)(C.a,{children:Object(g.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(g.jsx)(C.a,{children:Object(g.jsx)(no.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})})]})})}var Ep=Object(be.a)(Sp||(Sp=Object(v.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n    port\n}\n"]))),Lp=Object(be.a)(Dp||(Dp=Object(v.a)(["\n","\nquery userQuery($operation_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      ...callbackData\n    }\n}\n"])),Ep);function Fp(e){return Object(g.jsx)(fo.a,Object(_.a)({label:"SOCKS",iconComponent:Object(g.jsx)(zt.a,{icon:Wt.B,size:"lg"})},e))}var qp=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(f.a)(h.b),j=Object(pt.a)(Lp,{fetchPolicy:"network-only",onCompleted:function(e){O.b.dismiss(),0===e.callback_aggregate.aggregate.count&&O.b.info("No Socks Running"),d(e.callback_aggregate.aggregate.count),i(e.callback)},onError:function(e){O.b.error("Failed to fetch data for socks"),console.log(e)}}),p=Object(u.a)(j,1)[0];Object(o.useEffect)((function(){e.value===e.index&&p({variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}})}),[e.value,e.index]);return Object(g.jsxs)(fo.c,Object(_.a)(Object(_.a)({},e),{},{children:[Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(Pp,{callbacks:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(ru.a,{count:Math.ceil(l/20),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){p(1===t?{variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}}:{variables:{offset:20*(t-1),operation_id:b.user.current_operation_id,fetchLimit:20}})},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",l]})]})]}))},Np=Object(Se.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function Rp(e){var t=Np(),a=["callbacks","tasks","files","credentials","keylogs","artifacts","tokens","socks"],n=new URLSearchParams(window.location.search),i=n.get("tab"),r=a.findIndex((function(e){return e===i})),c=-1===r?0:r,o=function(t,a){n.set(t,a);var i=window.location.pathname+"?"+n.toString();e.history.push(i)};return Object(g.jsxs)("div",{className:t.root,style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(g.jsx)(mo.a,{position:"static",color:"default",children:Object(g.jsx)(ho.a,{value:c,onChange:function(t,i){n.set("tab",a[i]);var r=window.location.pathname+"?"+n.toString();e.history.push(r)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e){case"tasks":return Object(g.jsx)(du,{},"taskstab");case"files":return Object(g.jsx)(ub,{},"filestab");case"credentials":return Object(g.jsx)(Hb,{},"credentialstab");case"keylogs":return Object(g.jsx)(lj,{},"keylogstab");case"tokens":return Object(g.jsx)(qj,{},"tokenstab");case"callbacks":return Object(g.jsx)(np,{},"callbackstab");case"artifacts":return Object(g.jsx)(wp,{},"artifactstab");case"socks":return Object(g.jsx)(Fp,{},"sockstab");default:return null}}))})}),a.map((function(e,t){switch(e){case"tasks":return Object(g.jsx)(mu,{index:t,value:c,changeSearchParam:o},"taskspanel");case"callbacks":return Object(g.jsx)(bp,{index:t,value:c,changeSearchParam:o},"callbackspanel");case"files":return Object(g.jsx)(Ob,{index:t,value:c,changeSearchParam:o},"filespanel");case"credentials":return Object(g.jsx)(Xb,{index:t,value:c,changeSearchParam:o},"credentialspanel");case"keylogs":return Object(g.jsx)(mj,{index:t,value:c,changeSearchParam:o},"keylogspanel");case"tokens":return Object(g.jsx)(Uj,{index:t,value:c,changeSearchParam:o},"tokenspanel");case"artifacts":return Object(g.jsx)(Tp,{index:t,value:c,changeSearchParam:o},"artifactspanel");case"socks":return Object(g.jsx)(qp,{index:t,value:c,changeSearchParam:o},"sockspanel");default:return null}}))]})}var Bp,zp,Wp=a(527),Mp=a.n(Wp),Hp=a(529),Up=a.n(Hp),Gp=a(44),Vp=a(934),Kp=a(531),Qp=a.n(Kp),Jp=a(532),Yp=a.n(Jp),Zp=a(535),Xp=a.n(Zp),em=a(526),tm=a.n(em),am=Object(be.a)(Bp||(Bp=Object(v.a)(['\nsubscription MySubscription($operation_id: Int!) {\n  operationeventlog_aggregate(where: {deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}, operation_id: {_eq: $operation_id}}) {\n    aggregate{\n        count\n    }\n  }\n}\n ']))),nm=Object(Se.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function im(e){var t,a=Object(f.a)(h.b),n=nm(),i=Object(ze.a)(am,{variables:{operation_id:(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.current_operation_id)||0},onError:function(e){O.b.error("Mythic encountered an error getting event log messages: "+e.toString()),console.error(e)}}),r=i.loading,c=i.error,o=i.data;return Object(g.jsx)(E.a,{color:"inherit",component:Gp.b,to:"/new/EventFeed",style:{float:"right"},children:Object(g.jsx)(oo.a,{title:"Event Feed",arrow:!0,classes:{tooltip:n.tooltip,arrow:n.arrow},children:r?Object(g.jsx)(Pe.a,{color:"secondary",badgeContent:0,children:Object(g.jsx)(oa.a,{size:20,thickness:4})}):c?Object(g.jsx)(Pe.a,{color:"secondary",badgeContent:0,children:Object(g.jsx)(Fo.a,{})}):Object(g.jsx)(Pe.a,{badgeContent:o.operationeventlog_aggregate.aggregate.count,color:"error",children:Object(g.jsx)(tm.a,{})})})})}var rm=Object(be.a)(zp||(zp=Object(v.a)(["\nsubscription EventFeedNotificationSubscription($fromNow: timestamp!, $operation_id: Int!) {\n  operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    operator {\n        username\n    }\n    message\n    level\n    resolved\n    source\n  }\n}\n "])));function cm(e){var t,a=Object(f.a)(h.b),n=s.a.useRef((new Date).toISOString()),i=Object(ze.a)(rm,{variables:{fromNow:n.current,operation_id:(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onError:function(e){O.b.warning("Failed to get event notifications")}}),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){if(!r&&!c&&l&&l.operationeventlog.length>0){if("debug"===l.operationeventlog[0].source)return;if(l.operationeventlog[0].operator){var e=l.operationeventlog[0].operator.username+":"+l.operationeventlog[0].message;O.b.toast(e,l.operationeventlog[0].level,{autoHideDuration:2e3})}else l.operationeventlog[0].operator||O.b.toast(l.operationeventlog[0].message,l.operationeventlog[0].level,{autoHideDuration:3e3})}else c&&(console.error(c),O.b.warning("Mythic encountered an error getting operational event stream",{autoHideDuration:2e3}))}),[r,l,c,a.user]),null}var om,sm=a(530),lm=a.n(sm),dm=["title","titleId"];function um(){return(um=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function bm(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function jm(e,t){var a=e.title,n=e.titleId,i=bm(e,dm);return o.createElement("svg",um({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"80px",height:"66px",viewBox:"0 0 80 66",enableBackground:"new 0 0 80 66",xmlSpace:"preserve",ref:t,"aria-labelledby":n},i),a?o.createElement("title",{id:n},a):null,om||(om=o.createElement("image",{id:"image0",width:80,height:66,x:0,y:0,href:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABCCAYAAADAD1E9AAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAA CXBIWXMAAC4jAAAuIwF4pT92AAAAAW9yTlQBz6J3mgAAJBNJREFUeNrtnHmUHFd97z+/e6uql9k0 I41leZG1L9MaLR7JeMMeYyDGduwQkCAsTgwBAu+FlxwekDxMmBDgASEJO4hgjDHbk4JZYgwOCRov eJ2xZNmjfbMlaxstM+qZ6e6quvf3/uhuebRhY3iBd05+59Q56pqqunW/97d+768E/4miYACGpl7e uobu4D9z7P/vRVluAY5mF08bjBa/sXquCuh/yfNIHTyAg+GS7xzkwlnV8/+lhc8rSlfYU9O0A/kL 7zxgFn2ier4Q/bbf7XdalOV2K7My9d/7sxfesd8s2vHbfq/fWVEQBaN0B6vguMnunNY9Ya9d+LMj LNbDLDyveu1/me5xqYLWFeo40AAGm5bOffaci3ueDReVR1ii+8LFy6rXd4W/7Xf+TYq82BsVzAYK QYGBuH5uX+OSdkp6nce/UZXLz/Vh9lni2Ib28inJuscGKETjr689R3rptt1AP0WhC+iHHOXj71Yi q130OwH/2wbsNyLjTVDB7GbhNbtN5x17pPPwEIt1iEVaYonukc6+vdklFwAMjAsaCrKG7mB8dH4h sqanJ/hdS31+JQ3U6vUi4Pc3LjwrHeNt6vWmHGaOBUooIVARBZF/ONevf6+AKl2h0J8ArGK5hdWs AAewna4WE7rpQVJucRe0WX/eBGu2Hw79YGmSd36yNAexP7ZrZ5mhRzrhAEAfhEsh+W2D9ysBWAMP Ad1tFv13VD8xQU1+VDwV1ThCokCEEvoLCXjP+cn6R6qT7QqX1sBbQ3dwFb0pwC4KV3kx7wKutNAe KkhgIGOQksd6xTSFaPEw/mVLqPz+1aPp/Q9/K7jzm399PhxRsFJbhN+mvGBz6KXbCugus+CjE735 nKrmD5OOOvU0Y6IK/omK6vKpuv7y85P1j/TV8r86eFoDby9d+e0s+E4W+/NmNa8V1fZUNRlD47HU VcZG48qId/EwPj5ajpOj5NLhzXvidPBwvmXm9LeXmb1he/PiZQKu7gL01/Dlv668oIHrJvi07Xxb m7dfOURaUbBt2GCoQbaLas8Fo098sz6ZfrqCOnDwnOZtZUm7Ibl/EsHcQdIUiDNIPotBzfHBSNRT RknRVCIxuTg2whZSzqOx+SyOHCsPuabGWfOLjx7eyqzMbLZVlOVWWP2frpHPC2B98jsyC+dK7DcC qCp5sVLJysenjq37XyKidaChPxXQ58DHCHilx2yVf3m8Te2iI+JGUc23iJWi1S14fiBnZTdp6kI9 VFmkxlys6MImNYFTT7k1+JYsPP9bfvMB44+OfURSzm6ZZGadfWD96IkLjYwf+7cuCtJTM/MdsuCe QRbpNhZU9ppFurPpwpufu64rPJMZ1VmXrRT+6QiLdAuF0S0U9GnTqTsaF3/gTGNvb148e1O28+NH 7GLdYhb8z/r5TZMv/Ket4YI3AwxQmLqBwhc2NSz6+ObswpcC9PwuRem+WtK7LVh4zT4W6nYWlA/K It3VvOSWKiizMr/shesVyWY6522Rgm6Wgm6mkOwxC3VH24Vvq183QCGqH30nJdobmxf97SYpPACw feKSl+9vvPQsgIEZl099SjqKu8JO3di4uGdT2+Lle+ma9DsFYj3n2ioL7nmWTt3JAt1mFmw4+e91 TT25jKuDsZnCP+6nUzfSMbKPTt2WXXh7DeDodLxgD5itzMrUtXqDLfzrQKYwa0O285Ynmxa+9cnc gtdtiTp1gyns2XPRqydubl68bHtr19QXMT8Zf/CbDEZ1IDZGnZ1bqWrOflmo28NFNwPsZ2FDzxlW evx5BdlIx+btFHSADt0khXR38+LZ1b/98rKuvgADYcdLNuYXXf8Ec6c/aToOPSnzKxuY//XdXJJ7 bpyeX6p1PWBWgV1Dd1BN4k8PloKpJ/m/VnQfKFQrhy3M/fABWaibpaO0Sxbo5uzCnj44PvE1EAxA 4+Y53ZM2ZDqv3RIWFsNzlccG5s8eoCMZYL7bSUE30HHfySD/Mjm58lAwe+nKP/f7zGDUF6HvDAv1 4HmX5B5h3sRHmDdxgELbzmnd2ZPH6nueRT4tK6IgDAwkAH5ay42lXWMoGpbw2ljmQy5a8JaBOL5D 2dIVdHbPwphs8MT+c72VYmB4KcAww7UcTc4OIYghthBJ3m5iDK6ny/bQ/7y1bTWCVyP5quPJc//Y GrqDQXpVaon5ybIKbDvdspTe4+nU2sz82b4iL1H0EkQWsnf4AjCNoJTwWnrm4EifdGxDdU2M/lDY 9CT0+/HFwAsCcBtEs6GygRnvyux6dOEY850iFuBYoC6K/fmNmP9lP/RRSoeOkP3xQwwhX2+8qPld 5z/0UEnB9DM5hT14vEUsioIKkglSxl6I7p0IIsAKcArytyBXnQG46thdtjrhXvronCe41yFc52IW N2FCCySqxKr46psBYL22RZipFnnZEP7vHqXjRyn2lqX0P6lg/hboOYnQOAXAu2uJ6Tq4KnPx7C/o K9+Cfn616JESBAEYbJljLlnW4YIjR71+YVV2FL7cwe538lDVpITetK/mQ02YGY7TFFVjYoRkKJn3 q8F3CpjKaXK9VSy3BTZYYSCGfv9YtnMGcfpRfLqiCWNSVUoow6QJ1TpaaxScqdm/JiK+jFcgEIga kRtGSG54SOa+X/zmT9YXaDwrdIJ/6aMrvJZtlY0XXzPNEvzIXlggHhpK/ZHdRhsiNFU09hC0WPfY 7qj8uU9lHY1k58/+OMBOurN1k7qLfgeQJrolVd1nIBgh9SJctfGsiy5ZSn/SN86XvVhZxXK7ikK0 gtWuwEC8c1p39tGg8DdaTjY1efN6j5ohfFLEl1O0DBJkMPkmCRomSJBtMUHUZIKoSWymGZPLKnmn zjp8MkwapyitGnziQeatrFtDzzjcjjvfesWxc1p3dmTX/vUNE7KzR4eKibI9lFwnlBwgqvX7BLQp SBtHfDAm+qVO99S7+ugKu8ZVInXfsdYU/nmCmj89ihvLqeRLWdmdOWfC5YUdDzxTDQDdFtoVViug Z6omnks1lksvg9JNrzs+VmtXixup3ITz72lVc8GwOrwQA4KqzWFMJMIonlR0lyjrxcpmacscJLAV LSXZdLgyXY25osGbQuqVCpqAWpC0FRsdxX35Uja+cxXYOpskJ6vlelnwswliXj7kkwrGZHRyFvaV qKm8BAgpqtXJqCJCI1ZKefOWhaNP3DYAUQekdae/AtzazPzZPmaLKChUskimbGRII/sXS8vrbz8J JNNPlx1PqEKVVN1Bv19xEgPzaENhsa/ozeL1j5rUtMfqKYsm1YITm1djnYHE8pA1cqd4u6bt3IkD 03f1ls+k1Q9NWHKDK8afbnQ6fQSfUM064laCaNi4913qN/59XTlkfP24ziz4Uqs3f3aUtIKQUSPg PIhQu7Ai1uwUp/PGgehFMQGGtD37J0sG+2+vAlEt7usD9Zn572z19otHcV4hDiCbw1AUP+Atd0jG 3NMwjQ2FgRMZ69OZ7LRoYJ5TfaV4XW49lzRgGFVPIpoqOAGTVROGYigb32ubgg9dOPTkfeOf0wPm SroNQBNFKdKk3bRrnZAYKCyPDm/b8K9NFX1lUXwCahVMgCCBufDSZMPaPrpCqWvfOlP4YIPKh+uI SzVoplUwNGnTIFc0/quxYWZTylXH8CnPBSEHahujiNKE8FNLDva/F6q5YIGBuK6JjzD//S2Yj5fw JGgZkCwmkxXDsHg8bEN4SoSNzvKMzUdF3xSKJK7BHy5PUefniGcR6PwWrKQKIzivSCyIAQ2yGBNh GMFtiaz50IVu4Lt1wK6ny+6g3y8HXw8cp1kjuZtZ0bVsqwD0BvPXNKR0j+ITAW3ARGOi916hm7qp Kl9VHreF+yZ5+9JDmnhA1EilwUu2ukKWQevul8bodoYrX03QuGb+luPlnHpFtZXADgW6Jp+X1xaO DRwZoBB1MJD8bbXc8w/bwmvF+5Ut2LYxPDG+DKSo5jOIicQgVP2Jr/Hfte0+VCFBKaN4tCSI92g2 wtgMQoySivZbYz6/zHXcUdMm6TuJXnthwakQrWAg/llrV0s0PLrFes5KUAdKg1ibWr3m0nTTPdID pgf8PZMXNkw6lHwXxyvymEzJco9X/0P18jKLbgpasw+WRyrfbEpoq8fwSo2zq4FoVERRkiZMVDR6 UIxdflH65H09YK7s7jb0wlX0pvfT2RqZ+K+ccnMTtl2AMTwpJKjUCFg1PBfkaqmLqKICZDKIyWJI UcbQA8ZwV8bwjQvTjcdN9eSg9qvK3czKXMu2yr3ZjjfmK/rNojoH4hoxUQm980o2vUbG+yuAvuyC R9rLXHTUsnKxe+rP6g97WObfNV3D63aH6TZNOapKhOX8vJe2snpSUSe1vWEgjpRIBeJQ3n9JvPGT 9QkB1LXhfjpbA5vcgJcbVLnYIufka5h5OCHJNYBBUIFRPB7daYV7ReyPMy789yWsG6qbYB9dwa8D 3OnkP8y8J7NeFpTExxYiD8da1c0SqPqHHvBruruD/H0HNjRhZpu2aNm8Q2v7FMzaSUvO1lH33mwQ 3Fkqjqhe0LxY89kJfuOhkJxt0cTd3JhKc4xSEfWCGF+NxEGLWooTwh/lr+34k4Xf/vbRVSy3y4F+ dpgTWetCY0QyX61dKKrzVZmm0CyKVSERI8NGeVrEbLCGda1JZePsmp+q3t8dNFGUX9VUn0/q6d1/ BHM/0OTMR4bVJYqaPMYaeFU9jZHVYFaAe5h5X74gyL7j6Fm2q2Nv/+NrmJa9il3lxyZ3zogPlD9i zm18Xf7Z3SblELnJF1I+MPo/4saoRWO/xHudk00plPGeqlP3Cq7J2HCkyRzR4eTPL2fTt+vF/2ow M+gyL3bPdxXYo3SZVmb4Ff+P6Pw6gP/eWLgqGHU/r6gHiJvERono/wygntBV1T2g4c93+9Gj5mg4 E3j8KnaVH2TuNcmB5O6JjXkZfHYtlSuuTcy5Z8uR73xN7Dld/83tLeZEbIXArCkFvpRNZWkJ70As gjnmXWyH07YGCb51v86dL2z+YA+YD4GXWsVSX8QZdBmAIk06SK8uB10N0k63NFEUgHGR1EG/U/rN 8/Ub3kuv7/l1Nuaj6EC5NOaME+sF9YDzTDw+aI31EKE/wfPXd5eqjUH3h/O6bGp+Io2WweLGUst7 P5DNdnaEQfskBjMh/usr52TOX4rZPUqa+FkuY/51TP2wddLiRL1WXVekCBX1TCG65T4zL3uF3/Te 5RSiVXS4FayuVxSOGqCnSu8pZ/roCos01RiZ3ucFZxWFaAMD6YsBMvVxqIr1aFXbBNQgJ6xaTRPr u2oVAJNwW9BgGSk+XWm4/tU5n4nYc9MbaXjtm2n5g2vZ9/WVzuwbgYzxQcWHLnEXY2QP0FJTazXV 0u9QYvj5vqxuNTYaW1tcPKHAuiEYYBWFaDkDyQt1+mvoDu6l19f9XR9d4RAj8731BVWZJl5zABIE Ra9staFb//Lylh0ram0lK+kK3/ECfeUggwbAl3VBI4YRSV299giRA6clIusJ8H1m/jubvfniMeNi 9S60Myf6ePvDYphtHFtp/9+f4th9DxH/5HuYpgIUUwTURHanS/xUVAMDmEwwCPpgEvtA8ZNAQlWa xMjq5iVX9Czt/0qta6HK4dXfo5t2XQ20MygAWyjKPvpdXYP+LZh7maT6BkVeATq7QSy2FsXrK5Gg jOIrwGNi9BtPu6avv4P+pD7WmWixk4G+2859MOu4ZAxNQSWLsXmk+xQA65XJPZMXNmQOVjZHKudW 8GSNxfoK5UmN+LJ3QdcFNmybQGXHHtwTOyHMI6kqqkLGljVrheE4oyKISCJewxzmOBflUCIxFAO/ i3zwyahlwndf+swDR1+IVvwsmPd73ukHQuSlGQwxnriaXDtUfNWQ6kaFMWAzGKwIRdwOY8z7rnGb vlddtEJ0lKy2MsNTW6xBBs1RsloH767MvE/lK/qeMXyqggSIVfSZV2k0+xQA67Vrr5n31y3efGwY lxiRBCsbNWOOKdodjO4W87rXuNzcmfbwh/8GE8wF1apnrZbIUvcHSA0xAUUd481UVUMkzIqhaPUw gb3HGelVa54yiezPFaaUx8bGCHcczbtQztNK2qHw6lzKK1BlDO+pkgv1klRUTqH3a29W3buOVIIQ YUz89zNnN/zl1fvWPn2mhfphw4LJJo4/nUvl9WPqHCJWVSsTCDIp+sGr2fyREwbrqeWD97d0trpi ss16bfOhqM2Fe+Ji5RjGbKYhfECbg1tkz9q21o990sdDx8zQJz+CnbQQDtUIjrxVP5aIiKm+fh3E 4yLHf6rgRcUFEOawqEBJPIlqSbImJlU08dlITCaL4FQZwTmqm/kn+PAThlCtrxumivLxaA/4JmxQ DHyJjP2cj5PvhhdM2eNarNrdh1rccNqhibtOlTc0qmkq4pxUy9ZyBpN16I5rieYLA/EJANZ93380 FD7eMpq+fxiNRSQSBKNKCwGHiR+yhcnf1IGHv2Aue5m2v+tm2f3Gd2Dy56BjMWQjKBcxjS24kXSc Bsopk9RxM1JRp1plUoDghDpOBFe9ulbmEVYfW4tSp9GeOngYSRCKeSdtJfE4iIFIIbZKlMdUK5tA hgiMauwbc0oYqFTLSyExaKhQCZAMoBODYOklycbHV9IVnrCHu5gnkn9vWLBQYndHpT0rGnvjnRcv 4ET9mLjKRILplcHiI27ebA3W3jujYcXr00o+Zyp9/4aZPovk0Hqa3/w6ggXTKa27B2mZglYcKlK1 7tNojFaRMghWBPGCqqh3gnpBvVbvVAjqnbA67qh7Oz3pAFUB6wNzb2r5gfN6SaOaIMbHCoEHXwGn otZ6zUrqc6jaWLyviKYqqCjiUdeAiRLRUrMNX355uvHheoAxddNdSn+yEkLS5BuZpCzJgScSn1RE A4NWY4PxKmYMcOglprmxDyAZGvL5hQVSwGeq6zHhZVdQGavuHGnqahSznjrB+r9r2qSqOFVRVeMV q7XDg1UwKtXsuX4891vxqrX3HPdvwKlqJtZrXKottiG38Jj4+xvFRpGIQRQVRVWTVDROhdihiao4 VcQrQYgEjQRhLPS2Zxo7rkw33jc+OhuAOrE4PTv/9Y2VZFF5Rnt81kc/EZrL5uDSQ2hzhEdURSxW 8JDXcmXMA/HBQTKT2/GA27SP3NW/T9DWSnnVQ8D5aKIn7ATVJ+j15ElXc5M6p38qUCdefwJQOu75 9f6C6n2iAmPi3EQvb/MjY295tW69YljdWyvqN0dqbIOaMIcNM2qiSCXKYsM8JsxjAkAd3CdWXnO9 br3qkvK6XX0n5ZAnlj+TGqake/aQv+hKSgcPEf9iPRK140dTF4AFOTRmvMHJqCvHzQGQDA2Ty1Ub BDxPE86+kTRJSNlKEM3Fez+uUDzJ5E7jt07n1E6bXdd9ayDV+Bu7uivgpMcIIAdwaQv2L3/M3H+7 js1fW0Xhm5BcXUJfKWgHRiYJYkT1mAo7A+SxZs+al7N1Q20TQdbQbcfvM58CoDs4OslkpjL03V4c O7HMRlOv4rEqQpgxt5Uq6ftzmLWlcnyJADZJDMYcr41UwJUrVToqNFCuuX8ZP7dfAaRTQK6vhEIu QEspniLGtqDOj3uSGd/sZhRcBcUF8gFSflqrSn5SO04s7sa9TA+YKXTZd9CfnC7pNgCD9FYDovMz 0ooDAgnOWQxG1HvVSIR8Nvjr0dQtzogImF0+SS8bBSQIAxfHtfEvoLRxO25sDOFs/GipaoKcbHYn mtx4s6sex33TCff5Wp7uFTQKcKUYUBouvRB1Hjm/GZk9CZk5EVoiVNNxz9dgDOes18vvaVpwPcA3 WNhwuj6ZVWBXUYhWVrts/S8r+wLgeMO3ep2TAN6KZ+9IAqJ5TJQY+lzqi5NTc82RQB92vjw1l23I HAUXtLbY5FgRB0Rzz2ast5ehmRdgF8wkfWonomEVFTlVx/Qkuz7VpE9SQan6UAktPjJovIspt3yY Qw88QsoO/O7n/GgI2GlL0CMl9FgMiAho4j2V0cqngLtuYv1oD5huTuzVWQEeBl4QPRbUS7efZgqz 0jiePYZqzplMJAHHtGb81myKnVvmsWDZk6YyKxNYFIjaJ3Fs565qdlqOESYzdOt3EDMJkTzq/Sno nJgLnr4v6GSzxwjqEkxrHm3LUdrez7x//AzFAwcZ6v0xLRe/nKZLuzSc3C5pqczQLx6l+LMfVYGc uhj/zBCIDSqqcaOXuXcGsz/5h+nW93VQCKrdDC+OvTZfocsCOJfOasFmQxHxkdw5Eum7nGFbhCAT s5s1MusBJAxSscHZ6bESBsREESNrn8QC/uAoKgINZ+G9e85cFTxy/NBxB5yav+n49EbAq8e7MjJj IqkqI9v7mf/ZLyITJrD3Ex8l2zo/ToeKcenQYR+Xy3HjnNlJR89fsfjHPyG4/JWUn1mHXjCBVBO8 aDhM6nH63h9l5rxqBQPx3eO+6fuVAazb93Xp5p8eEfcXPpDDbRMa3ndtZfOXpDVzW4NYdN/oWOn6 zs8cFYf3Pu+sZP1o1S2kpTLp4WGUyfiyx6vgxxwqpg6SesTrGYDyosd95AnpDYpa0Mgg7Tlkejul Hf34oY10feu7hOdM0U1v+eM0YDq5lCizaW9U/sZX7bEP3RLteMPrwr7L/iAtPrtXF//DR2h+483E T6/DTJ+I1nYcYlVGEr/6rpbOGdeyrbLqRX49erzDFOBGv/UzNkmX7D88UvhBOKcvPVp+136tkA/t gytWr3aj6nekSTpZ47TEhCwpkBSL2LMn4ThQddw1z1YDzFsjYsBUS7UTQRqvoePTG5oCaAnR1OPK T1MaHKC883HOefd7WPbzXh2L42Tta19NM1MD05YlLiZ3udamD9iZy97uFr303XRe1tsgLcFTb38r G7/0VTfnLTcRdl5KvHMtem4zTl2QGJLAa8PwSOnnPy1c0raCgfjFgDie0pfVFMLfY2A3jt3f05mX TdHofaWc+cvLSwMPAzj4VOr4pEH6k3ICIMPrN9AwZyZFwGTt8cCgio9EjEb239NKujijMimGFPS0 BIDWeuxVPa64+Xgtm1t2FVN+70rOWrYUctlk0+o7ZeRLnw1b2jrwGfut/L7KXaORmV46Gl+lR0vt iu4zjH0uOefs708+96rP7P/6V2zQ3OTm/s177OPLHyTzbBEm5uBwKawYG2cdFxzafOiBNe3dF101 2DtyG9OyN7Or/ALxO9WDj/+a6Ad23u9nm+wz1wwNPFEPNt8PZ/+5wbwuSZLLNB94P7bbTPiTmxjb spP4wT4kPwnGHICLEJsKm8Km6CPlYuV2q9i0SnqZk0mFaqmsYpsiclcsoGH+HBqmTdXMxDbS1LmD /Y8z/OlPBRFgZ190f26s8qEjzx5bmop5f4uaiSlVJiJAMAqj6CeCXOYxM63pX4Y3PsyMj37CZdon 2Q1vfysBzdjJ56MHSqhQyavJVEI2TJzY1H3t/rWDK+kKW0/Th/OCAKybdC/dtg5kT43mOg4icy5C /CMJJKgPoCx25rmk2wdBbI3OVBRJJmDCUSu3uow8mBtzt45WW0LseN5Oqry/U6/etGTJXlbATJpA Uhwx5fuesHp4YzWazujqzzfm//d16+//HsAdZuZwozfNRVxJkLCaPZI0YrPGyO1lY76SppXu6Jym jw7vXc+0v/lwnJ18VvT0p79KZWsflgsQsSgkWZWwYhjUXHDTzaObf1qf9xSw0MV4Jvx5AazLyTv7 NQAV0P/DzB+2E9xw0LoyYLwrBcZmRZ3Wt0rrIyQt2LCSMW8qO3dDUyorjuETVMPjtLGIy6qxph5x 2Qe1NtaY1iSaM6s3f277F65bc/cP649dVShE5Y2VR63XRc9ptbpmAhsE5rNHfJo0Yt7zGj8r+zW7 5Y9apjTeVtzzBE1/9MfxhMULZfipDUHxPx4Rt7eIWAtOY4tEVoTY6Lex5qNvibdtGI/H6T7kecFd 6HUG4tvMmRcY/2ObC98Rj5bf1kKwwlkoi5KmHhU8SI0lVoNiMhgS9KkoF72tVIofkloxp+AjxGog T6F8xqnvRk2LZE0SNEX7o+b8460TW+698pGfba2/x2dnzcq8e9u2yqrC8mhsy9qNUaIzYqn1rGBt YMwdx9RVJqj500YbXHl1rdXjVqbfYM5r+mK0Z/25MInoDdeD8+lo/4Am2w4YsZFRpw68aZDAjKkj YddPDPwgKFz+yO6BB57sOb5zeWLMe16pmzDAd+zMR9ucXXbE+D0mE/yFw0VU/B+o15cipj2EIKTK /ZVRvGGfUabk1ZAj6DwQJq9oScw/HsPFChEoBvEzco1TLy098eyZxq/Xoz10Bz30pl/LzTxfKrrJ ePIOkhwShtbcNYovNTmzPBfYa16VbrpnJV3hPvq1B9KVkM/OXvrmZNvhNyS68yVNnJsxzU0kx8pV Og5URZxRX8ksviDbMmuqHdn+DKW1DyBndXz/LQef+sOTNfEFfWpQp7u+aWd9ocGZZYOko9ZzHuX0 X5zX/2by4cAkGhdnM+EsaYyuqGTkbaWs+TrWEKjs0HzwJiuGkSB9603Jtn8asv7hDBIpmnhIchjz bFJ6D8Bna18/9UCwikK0hu6gZ1w92lHbZpRM5hVZL/kUjQMIjTUPFPH5vOM4eKsoRFXQSasWxNgf b+1b+ae688qJL//9OTHmDaPHxr6cWNvnMMUAK3mCICtRQ+WJZ+3gjqfH8i9dFmdedSPu4FOvvvsl V3cArGb5qS2+Z5J6m9c37MzXN3jznTGt9wVqKUBy+eoa/MWNbP3Myffedk7nvOzB0rf+KN3WdWsw 65UZuOPsyW0du+PR0Bwu78GrVSEJVEIVtrxJzy8IvekqltvTtWrU+wy/+ZJXNVcGtm+0I/E5KZAP 7EDs1QWehWcFUfcr0033fpZZmXeP652pa/KVdJvTdSncmp97jo99wad+ieTMErVcHY48017Guem3 fDAZ+tm92eSRn//lTfDpNRBcRbV38pcCWPd738rOmeHKboOFjIfUoy6PyThh7/lh+HuXxRufAmQV mA10S11LVjAQ/2uuMNWWKqVr2TZ4WzhjmbX2hpbmzOePHIvfmS/7D43WTDlCyAf2ytekW+8708Z3 HcCv2hnfyzv+sIjzjVG0P/FqSX3r9DB78ZXJhrX1RX8+tzSlVsaebqxbmdTkpp33edm17qbo6usq 7Z0dmd2f/vvH3wFdPMdGnhnA8XZ+u8x4LKdmaQlfVjRsJrCp6H3LWhpvnD60buhMyed4IMZPaiWE jVM7G0t7RrZbT2sKlSZMJkE/8WZ2/FUPBD21FT7ZEv7ZzHx33stnirg0H4apCW02GYv3Ls42Xbak vG7X6TTv+aT67Um3hUEzhazWfSbAl9o7VgeDu19rL76oYvYezgTP7Lj2TRz7yQl7IlrVHttT9Ymi IJ9jVgRwu5nxD03YpWPiR1XINom1GP3CCt125fShdUN9dIVnytxr/ue4Nq6kK1xVy6ve+MyTRzWy d2eqi5kmKA59We1W3/McTye3MS27goH4y+GcRer1MyN4FSTNpJp1Y3H/Fa0TOl4seDUt0h560x4G 4nfQn3SAfoOFDQCMpH+fNpxN8eG1pvLMUUaDSe+pza3apd8zLsLWzaTW+aS3N81/dTgS31lWH0dI pEAz8vYb2f7PcGLV8nwy/tOAuny1ae6/ZIvpa8aqLcORgdGzCRZez5YdJ9+3sqsr1CeOPhWmOqeM 960SGC+sfpPfvuJkbf915OT3/Hx+1oUylva7SNQnXgKFRoLL/4Ttv1hJVxjUwftaMPPSxvPadqzY 9dh+gFub59/kRir/nKj3kdgIkScavXn7jWx5tAeCamvaCwOvp9Z7eCtzmzzpMpnevF2Plq90Q5U/ GEFdrXWXRrENEzPGf6x8dntbrnHWn5W2PbQC3FfbL5yVPDF0h3XMqQiasUEs3v7dm/yWj/0mwYMq ufxpps8NQtvw35Ntj7tU3x0I+NhXvKjmJcghvhvPL/ZRFvkChcYspXsmYS89FOiIivbh/JxWDc4Z 1ZQsBpsLv/2a0qY3Vlfo+R306Vb0S0zrFszPWjBBKYSMg8T76k66AgbaovBN++Jkcs7LP2CFUcs6 RdOsk6WRUyooYmR46fkTlyx6+tGd1G79TfyHPMvBrgb3j+aCv2tWe0tZPLFQavSSS2rf1GUx2MDe c/PczA0yMBArSBCF5bkk2jZI+gtJNW/gfIWhIZKnAaPiozma/QBAtVt14AUzFSfJxeCfPobfQyIN MaS1BnyMSONZQeaDN5Y3fv+LZvqqMfRJdVrEMcmAxGh/jIwqnNtqw88uevrRnfXA9Zv6Qno1uFVg 93ouHMGtF2XMog0lzKiCVSQtCW3nNuY+JgNPxqsoRMJA/H8BtvEYyTM8EcEAAADoZVhJZk1NACoA AAAIAAcBEgADAAAAAQABAAABGgAFAAAAAQAAAGIBGwAFAAAAAQAAAGoBKAADAAAAAQACAAABMQAC AAAAJAAAAHIBMgACAAAAFAAAAJaHaQAEAAAAAQAAAKoAAAAAAAABLAAAAAEAAAEsAAAAAUFkb2Jl IElsbHVzdHJhdG9yIENDIDIzLjAgKFdpbmRvd3MpADIwMjA6MDI6MTMgMDI6MTA6MDMAAAOQBAAC AAAAFAAAANSgAgAEAAAAAQAAAFCgAwAEAAAAAQAAAEIAAAAAMjAyMDowMjoxMyAwOToxMDowMgB/ /K2cAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTEwLTI3VDE3OjE4OjU4KzAwOjAwCRQNHwAAACV0 RVh0ZGF0ZTptb2RpZnkAMjAyMC0xMC0yN1QxNzoxODo1OCswMDowMHhJtaMAAAAhdEVYdGV4aWY6 RGF0ZVRpbWUAMjAyMDowMjoxMyAwMjoxMDowM+QYGrMAAAAqdEVYdGV4aWY6RGF0ZVRpbWVEaWdp dGl6ZWQAMjAyMDowMjoxMyAwOToxMDowMhsP+NkAAAATdEVYdGV4aWY6RXhpZk9mZnNldAAxNzDS Dd5MAAAAF3RFWHRleGlmOlBpeGVsWERpbWVuc2lvbgA4MIVW3/AAAAAXdEVYdGV4aWY6UGl4ZWxZ RGltZW5zaW9uADY2LyCOzgAAADF0RVh0ZXhpZjpTb2Z0d2FyZQBBZG9iZSBJbGx1c3RyYXRvciBD QyAyMy4wIChXaW5kb3dzKV8EztAAAAAASUVORK5CYII="})))}var pm=o.forwardRef(jm),mm=(a.p,a(533)),hm=a.n(mm),fm=a(935),Om=a(243),gm=a.n(Om),xm=a(534),ym=a.n(xm),_m=a(322),vm=a.n(_m),km=a(536),wm=a.n(km),Cm=a(537),Sm=a.n(Cm),Dm=a(528),Im=a.n(Dm),Tm=a(301),$m=a.n(Tm),Pm=240,Am=Object(Se.a)((function(e){return{root:{width:"100%"},title:{flexGrow:1},hide:{display:"none"},drawer:{width:Pm,flexShrink:0},drawerPaper:{width:Pm},drawerHeader:Object(_.a)(Object(_.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),appBar:{width:"100%",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{maxWidth:"calc(100% - ".concat(Pm,"px)"),marginLeft:Pm,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},nested:{paddingLeft:e.spacing(4)},mythicElement:{}}}));function Em(e){var t,a,n,i,r=Object(ee.a)(),c=Am(r),o=s.a.useRef(null),l=s.a.useRef(null),d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],O=j[1],x=s.a.useState(!1),y=Object(u.a)(x,2),_=y[0],v=y[1],k=Object(f.a)(h.b),w=Object(f.a)(h.c),C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useState(!1),P=Object(u.a)(T,2),F=P[0],q=P[1],N=s.a.useState(!1),R=Object(u.a)(N,2),B=R[0],z=R[1],W=s.a.useState(!1),M=Object(u.a)(W,2),H=M[0],U=M[1],G=function(){Object(h.c)(!1)},V=function(e){O(!1)},K=function(e){v(!1)};return Object(g.jsxs)(s.a.Fragment,{children:[(null===k||void 0===k||null===(t=k.user)||void 0===t?void 0:t.current_operation_id)?Object(g.jsx)(cm,{}):null,Object(g.jsx)(mo.a,{className:Object(Na.default)(c.appBar,Object(jt.a)({},c.appBarShift,w)),children:(null===k||void 0===k?void 0:k.loggedIn)?Object(g.jsxs)(Cd.a,{variant:"dense",children:[Object(g.jsx)(E.a,{edge:"start",className:Object(Na.default)(c.menuButton,w&&c.hide),color:"inherit","aria-label":"menu",onClick:function(){Object(h.c)(!0)},children:Object(g.jsx)(Mp.a,{})}),Object(g.jsxs)("div",{style:{width:"100%"},children:[Object(g.jsx)(tc.a,{title:"C2 Profiles and Payload Types",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/payloadtypes",color:"inherit",children:Object(g.jsx)(Im.a,{className:"mythicElement"})})}),Object(g.jsx)(tc.a,{title:"Payloads",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/payloads",color:"inherit",children:Object(g.jsx)(zt.a,{icon:Wt.a})})}),Object(g.jsx)(tc.a,{title:"Search Operation",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/search",color:"inherit",children:Object(g.jsx)(iu.a,{className:"mythicElement"})})}),Object(g.jsx)(tc.a,{title:"Files",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/search?searchField=Filename&tab=files&location=Downloads",color:"inherit",children:Object(g.jsx)(fu.a,{className:"mythicElement"})})}),Object(g.jsx)(tc.a,{title:"Artifacts",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/search?searchField=Artifact&tab=artifacts",color:"inherit",children:Object(g.jsx)(pp.a,{className:"mythicElement"})})}),Object(g.jsx)(tc.a,{title:"SOCKS",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/search?tab=socks",color:"inherit",children:Object(g.jsx)(zt.a,{icon:Wt.B})})}),Object(g.jsx)(tc.a,{title:"Screenshots",arrow:!0,children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/search?searchField=Filename&tab=files&location=Screenshots",color:"inherit",children:Object(g.jsx)(zt.a,{icon:Wt.d})})}),Object(g.jsx)(tc.a,{title:"Active Callbacks",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/callbacks",color:"inherit",children:Object(g.jsx)(Vj.a,{className:"mythicElement"})})}),Object(g.jsx)(tc.a,{title:"Reporting",children:Object(g.jsx)(E.a,{component:Gp.b,to:"/new/reporting",color:"inherit",children:Object(g.jsx)(zt.a,{icon:Wt.s})})}),Object(g.jsx)(b.a,{style:{display:"inline-flex",alignItems:"center",paddingRight:"10px",color:"white"},component:Gp.b,to:"/new/operations",children:Object(g.jsx)(L.a,{children:(null===k||void 0===k||null===(a=k.user)||void 0===a?void 0:a.current_operation)||"No Operation Set"})}),Object(g.jsxs)(Fn.a,{id:"menu-appbar",nodeRef:o,anchorEl:function(){return o.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:p,onClose:V,MenuListProps:{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"}},children:[Object(g.jsx)(tt.a,{component:Gp.b,to:"/new/settings",onClick:V,name:"settings",children:"User Management"}),Object(g.jsx)(tt.a,{component:Gp.b,to:"/new/login",onClick:function(){Object(h.c)(!1),console.log("clicked logout, calling FailedRefresh"),Object(h.a)()},children:"Logout"})]}),Object(g.jsxs)("div",{style:{display:"inline-flex",justifyContent:"flex-end",float:"right"},children:[Object(g.jsx)(E.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){O(!0)},ref:o,color:"inherit",style:{float:"right"},children:Object(g.jsx)(tc.a,{title:"Settings or Logout",children:Object(g.jsx)(Up.a,{})})}),Object(g.jsx)(E.a,{"aria-label":"documentation links","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){v(!0)},ref:l,color:"inherit",style:{float:"right"},children:Object(g.jsx)(tc.a,{title:"Help Documentation",children:Object(g.jsx)(lm.a,{})})}),Object(g.jsxs)(Fn.a,{id:"menu-appbar",nodeRef:l,anchorEl:function(){return l.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:_,onClose:K,MenuListProps:{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"}},children:[Object(g.jsx)(tt.a,{component:Gp.b,target:"_blank",to:"/docs/agents",onClick:K,children:"Agent Documentation"}),Object(g.jsx)(tt.a,{component:Gp.b,target:"_blank",to:"/docs/wrappers",onClick:K,children:"Wrapper Documentation"}),Object(g.jsx)(tt.a,{component:Gp.b,target:"_blank",to:"/docs/c2-profiles",onClick:K,children:"C2 Profile Documentation"}),Object(g.jsx)(tt.a,{component:Gp.b,href:"https://docs.mythic-c2.net",target:"_blank",onClick:K,children:"Mythic Documentation"})]}),Object(g.jsx)(im,{}),(null===k||void 0===k||null===(n=k.user)||void 0===n?void 0:n.username)?Object(g.jsx)(L.a,{style:{display:"flex",alignItems:"center",paddingRight:"10px"},children:null===k||void 0===k||null===(i=k.user)||void 0===i?void 0:i.username}):Object(g.jsx)(m.a,{to:"/new/login"})]})]})]}):null}),Object(g.jsxs)(Vp.a,{className:c.drawer,anchor:"left",open:w,classes:{paper:c.drawerPaper},onEscapeKeyDown:G,children:[Object(g.jsxs)("div",{className:c.drawerHeader,role:"presentation",children:[Object(g.jsx)(pm,{style:{width:"90%"}}),"v",Sh,Object(g.jsx)(E.a,{onClick:G,children:"ltr"===r.direction?Object(g.jsx)(Qp.a,{className:"mythicElement"}):Object(g.jsx)(Yp.a,{className:"mythicElement"})})]}),Object(g.jsx)(ka.a,{}),Object(g.jsx)(Oa.a,{subheader:Object(g.jsx)(fm.a,{component:"div",id:"nested-list-subheader",children:"Home"}),children:Object(g.jsxs)(ga.a,{button:!0,component:Gp.b,to:"/new",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(hm.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"Home"})]},"home")}),Object(g.jsx)(ka.a,{}),Object(g.jsxs)(Oa.a,{subheader:Object(g.jsx)(fm.a,{component:"div",id:"nested-list-subheader",children:"Global Configurations"}),children:[Object(g.jsxs)(ga.a,{button:!0,onClick:function(){I(!D)},children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(ym.a,{})}),Object(g.jsx)(ya.a,{children:"Services"}),D?Object(g.jsx)(gm.a,{}):Object(g.jsx)(Ma.a,{})]}),Object(g.jsx)(A.a,{in:D,unmountOnExit:!0,children:Object(g.jsxs)(Oa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/payloadtypes",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(Xp.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"Payload Types"})]},"payloadtypes"),Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/c2profiles",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(Ke.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"C2 Profiles"})]},"c2profiles")]})}),Object(g.jsxs)(ga.a,{button:!0,onClick:function(){q(!F)},children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(vm.a,{})}),Object(g.jsx)(ya.a,{children:"Create"}),F?Object(g.jsx)(gm.a,{}):Object(g.jsx)(Ma.a,{})]}),Object(g.jsx)(A.a,{in:F,unmountOnExit:!0,children:Object(g.jsxs)(Oa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/createpayload",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(vm.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"Create Payload"})]},"createpayload"),Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/createwrapper",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(vm.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"Create Wrapped Payload"})]},"createwrapper")]})}),Object(g.jsxs)(ga.a,{button:!0,onClick:function(){z(!B)},children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(wm.a,{})}),Object(g.jsx)(ya.a,{children:"Operations"}),B?Object(g.jsx)(gm.a,{}):Object(g.jsx)(Ma.a,{})]}),Object(g.jsx)(A.a,{in:B,unmountOnExit:!0,children:Object(g.jsxs)(Oa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/operations",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(vi.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"Modify Operations"})]},"modifyoperations"),Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/browserscripts",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)($m.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"BrowserScripts"})]},"browserscripts")]})})]}),Object(g.jsx)(ka.a,{}),Object(g.jsxs)(Oa.a,{subheader:Object(g.jsx)(fm.a,{component:"div",id:"nested-list-subheader",children:"Operational Views"}),children:[Object(g.jsxs)(ga.a,{button:!0,onClick:function(){U(!H)},children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(Sm.a,{})}),Object(g.jsx)(ya.a,{children:"Operational Data"}),H?Object(g.jsx)(gm.a,{}):Object(g.jsx)(Ma.a,{})]}),Object(g.jsx)(A.a,{in:H,unmountOnExit:!0,children:Object(g.jsxs)(Oa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/payloads",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(zt.a,{icon:Wt.a,size:"lg"})}),Object(g.jsx)(ya.a,{primary:"Payloads"})]},"payloads"),Object(g.jsxs)(ga.a,{button:!0,className:c.nested,component:Gp.b,to:"/new/search",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(iu.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"Search"})]},"search")]})}),Object(g.jsxs)(ga.a,{button:!0,component:Gp.b,to:"/new/callbacks",onClick:G,children:[Object(g.jsx)(xa.a,{children:Object(g.jsx)(Vj.a,{className:"mythicElement"})}),Object(g.jsx)(ya.a,{primary:"Active Callbacks"})]},"callbacks")]}),Object(g.jsxs)(ga.a,{children:[Object(g.jsx)($.a,{checked:"dark"===e.theme,onChange:e.toggleTheme,color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"darkMode"}),Object(g.jsx)("div",{style:{display:"inline-block"},children:" Enable Dark Mode "})]}),Object(g.jsxs)(ga.a,{children:["UI Version: ",Dh]})]})]})}var Lm;function Fm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t.taskartifacts))}),[]);t.sort((function(e,t){return e.task_id>t.task_id?1:t.task_id>e.task_id?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Artifact Tasks"})}),Object(g.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Task ID"}),Object(g.jsx)(C.a,{children:"Artifact Type"}),Object(g.jsx)(C.a,{children:"Host"}),Object(g.jsx)(C.a,{children:"Artifact"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:e.task_id}),Object(g.jsx)(C.a,{children:e.artifact.name}),Object(g.jsx)(C.a,{children:e.host}),Object(g.jsx)(C.a,{children:e.artifact_instance_text})]},"artifact"+e.id)}))})]})})})]})}function qm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){var a=t.attacktasks.reduce((function(t,a){return e.find((function(e){return e.attack.t_num===a.attack.t_num}))?Object(y.a)(t):[].concat(Object(y.a)(t),[a])}),[]);return[].concat(Object(y.a)(e),Object(y.a)(a))}),[]);t.sort((function(e,t){return e.attack.t_num>t.attack.t_num?1:t.attack.t_num>e.attack.t_num?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"MITRE ATT&CK Mappings"})}),Object(g.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Technique ID"}),Object(g.jsx)(C.a,{children:"Technique"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:e.attack.t_num}),Object(g.jsx)(C.a,{children:e.attack.name})]},"attack"+e.attack.id)}))})]})})})]})}function Nm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t.filemeta))}),[]);i(t),t.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0}))}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Files / Screenshots"})}),Object(g.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Filename"}),Object(g.jsx)(C.a,{children:"Type"}),Object(g.jsx)(C.a,{children:"Remote Path"}),Object(g.jsx)(C.a,{children:"Comment"}),Object(g.jsx)(C.a,{children:"Hashes"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:!e.deleted&&e.complete?Object(g.jsx)(no.a,{href:window.origin+"/api/v1.4/files/download/"+e.agent_file_id,style:{textDecoration:"underline",color:"inherit"},children:e.filename_text}):e.complete?e.filename_text:e.filename_text+" ("+e.chunks_received+"/"+e.total_chunks+")"}),Object(g.jsx)(C.a,{children:e.is_screenshot?"Screenshot":e.is_payload?"Payload":e.is_download_from_agent?"Download":"Upload"}),Object(g.jsx)(C.a,{children:""===e.full_remote_path_text?"":e.host+":"+e.full_remote_path_text}),Object(g.jsx)(C.a,{children:e.comment}),Object(g.jsxs)(C.a,{children:["MD5:",Object(g.jsx)("br",{}),e.md5,Object(g.jsx)("br",{}),"SHA1:",Object(g.jsx)("br",{}),e.sha1]})]},"file"+e.id)}))})]})})})]})}function Rm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t.credentials))}),[]);i(t)}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Credentials"})}),Object(g.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Task"}),Object(g.jsx)(C.a,{children:"Type"}),Object(g.jsx)(C.a,{children:"Realm"}),Object(g.jsx)(C.a,{children:"Account"}),Object(g.jsx)(C.a,{children:"Credentials"}),Object(g.jsx)(C.a,{children:"Comment"})]})}),Object(g.jsx)(w.a,{children:n.map((function(e){return Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:e.task_id}),Object(g.jsx)(C.a,{children:e.type}),Object(g.jsx)(C.a,{children:e.realm}),Object(g.jsx)(C.a,{children:e.account}),Object(g.jsx)(C.a,{children:e.credential_text}),Object(g.jsx)(C.a,{children:e.comment})]},"cred"+e.id)}))})]})})})]})}var Bm,zm,Wm,Mm,Hm,Um=Object(be.a)(Lm||(Lm=Object(v.a)(["\nquery taskMetadataQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}) {\n      credentials {\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n        task_id\n      }\n      filemeta {\n        agent_file_id\n        complete\n        deleted\n        filename_text\n        full_remote_path_text\n        host\n        id\n        comment\n        total_chunks\n        chunks_received\n        is_download_from_agent\n        is_payload\n        is_screenshot\n        md5\n        sha1\n        task {\n            comment\n            id\n        }\n      }\n      taskartifacts {\n        artifact_instance_text\n        host\n        task_id\n        artifact{\n            id\n            name\n        }\n        id\n      }\n      tokens {\n        TokenId\n        id\n        host\n      }\n      attacktasks(distinct_on: attack_id) {\n        attack {\n          name\n          os\n          id\n          t_num\n          tactic\n        }\n        id\n      }\n      id\n    }\n  }"])));function Gm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(pt.a)(Um,{onCompleted:function(e){i(e.task)},onError:function(e){console.log("error!",e)}}),c=Object(u.a)(r,1)[0];return Object(o.useEffect)((function(){c({variables:{task_range:e.taskIDs}})}),[e.taskIDs,c]),Object(g.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(g.jsx)(Fm,{tasks:n}),Object(g.jsx)(qm,{tasks:n}),Object(g.jsx)(Nm,{tasks:n}),Object(g.jsx)(Rm,{tasks:n})]})}function Vm(e){var t=Object(o.useState)(0),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)([]),c=Object(u.a)(r,2),l=c[0],d=c[1],p=Object(o.useState)(10),m=Object(u.a)(p,2),h=m[0],f=m[1],O=Object(o.useState)(10),x=Object(u.a)(O,2),y=x[0],_=x[1],v=Object(o.useState)("all"),k=Object(u.a)(v,2),w=k[0],C=k[1],S=Object(o.useState)(""),D=Object(u.a)(S,2),I=D[0],T=D[1],$=Object(o.useRef)(null);return Object(o.useEffect)((function(){d(e.taskOptions),e.taskOptions.length>0&&i(e.taskOptions[0])}),[e.tasks,e.taskOptions]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{id:"form-dialog-title",children:"Add More Tasks to View"}),Object(g.jsxs)(G.a,{dividers:!0,children:[Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(mt.a,{style:{width:"100%"},children:[Object(g.jsx)($t.a,{ref:$,children:"View More Tasks Around Task:"}),Object(g.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:n,onChange:function(e){i(e.target.value)},input:Object(g.jsx)(Ot.a,{}),children:l.map((function(e){return Object(g.jsx)(tt.a,{value:e,children:e},"selectiontask:"+e)}))})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{})]}),Object(g.jsx)(j.a,{type:"number",value:h,onChange:function(e,t,a){return f(t)},name:"Number of tasks before"}),Object(g.jsx)(j.a,{type:"number",value:y,onChange:function(e,t,a){return _(t)},name:"Number of tasks after"}),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(mt.a,{style:{width:"100%"},children:[Object(g.jsx)($t.a,{ref:$,children:"Search Type"}),Object(g.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:w,onChange:function(e){C(e.target.value)},input:Object(g.jsx)(Ot.a,{}),children:[{type:"all",text:"All Callbacks"},{type:"callback",text:"This Callack"},{type:"operator",text:"All callbacks but limited by operator"}].map((function(e){return Object(g.jsx)(tt.a,{value:e.type,children:e.text},"selectiontype:"+e.type)}))})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{})]}),"operator"===w?Object(g.jsx)(j.a,{multiline:!1,onChange:function(e,t,a){T(t)},value:I,name:"Operator Username"}):null]}),Object(g.jsxs)(U.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.submitFetchTasks({taskSelected:n,beforeCount:parseInt(h),afterCount:parseInt(y),search:"operator"===w?I:w}),e.onClose()},variant:"contained",color:"secondary",children:"Fetch Tasks"})]})]})}var Km=Object(be.a)(Bm||(Bm=Object(v.a)(["\nfragment TaskData on task {\n    comment\n    callback_id\n    commentOperator{\n        username\n    }\n    completed\n    id\n    operator{\n        username\n    }\n    display_params\n    original_params\n    command_name\n    status\n    timestamp\n    command {\n        cmd\n        id\n    }\n    callback {\n        id\n        host\n        user\n        integrity_level\n        domain\n    }\n    responses_aggregate{\n        aggregate{\n            count\n        }\n    }\n    parent_task_id\n    opsec_pre_blocked\n    opsec_pre_bypassed\n    opsec_post_blocked\n    opsec_post_bypassed\n    tasks {\n        id\n    }\n    token {\n        id\n    }\n}\n"]))),Qm=Object(be.a)(zm||(zm=Object(v.a)(["\n","\nquery tasksQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Km),Jm=Object(be.a)(Wm||(Wm=Object(v.a)(["\n","\nquery tasksAcrossAllCallbacks($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, order_by: {id: desc}, limit: $beforeCount) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Km),Ym=Object(be.a)(Mm||(Mm=Object(v.a)(["\n","\nquery tasksAcrossACallbacks($callback_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Km),Zm=Object(be.a)(Hm||(Hm=Object(v.a)(["\n","\nquery tasksAcrossAllCallbacksByOperator($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!, $operator: String!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Km);function Xm(e){var t=Object(f.a)(h.b),a=Object(m.g)().taskId,n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState([]),d=Object(u.a)(l,2),j=d[0],p=d[1],x=s.a.useState([]),v=Object(u.a)(x,2),k=v[0],w=v[1],C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],P=s.a.useState(!1),A=Object(u.a)(P,2),E=A[0],F=A[1],q=Object(ee.a)(),N=function(e){var t=e.filter((function(e){return null===e.parent_task_id})),a=[],n=-1;0===t.length&&(t=Object(y.a)(e));var i=k.reduce((function(e,t){return"task"===t.type&&null===t.parent_task_id?e.find((function(e){return e.id===t.id}))?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(_.a)(Object(_.a)({},t),{},{checked:!1})]):Object(y.a)(e)}),Object(y.a)(t));i.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0})),i.forEach((function(e){e.callback.id!==n&&a.push(Object(_.a)(Object(_.a)({type:"callback"},e.callback),{},{checked:!1})),n=e.callback.id,a.push(Object(_.a)(Object(_.a)({type:"task"},e),{},{checked:!1}))})),w(a);var o=e.reduce((function(e,t){var a=t.tasks.filter((function(t){return!e.includes(t.id)})).map((function(e){return e.id}));return e.includes(t.id)?[].concat(Object(y.a)(e),Object(y.a)(a)):[].concat(Object(y.a)(e),[t.id],Object(y.a)(a))}),Object(y.a)(r));c(o)},R=Object(pt.a)(Jm,{onCompleted:function(e){O.b.success("Successfully fetched tasks"),N([].concat(Object(y.a)(e.before),Object(y.a)(e.after)))}}),B=Object(u.a)(R,1)[0],z=Object(pt.a)(Ym,{onCompleted:function(e){O.b.success("Successfully fetched tasks"),N([].concat(Object(y.a)(e.before),Object(y.a)(e.after)))}}),W=Object(u.a)(z,1)[0],M=Object(pt.a)(Zm,{onCompleted:function(e){O.b.success("Successfully fetched tasks"),N([].concat(Object(y.a)(e.before),Object(y.a)(e.after)))}}),H=Object(u.a)(M,1)[0],U=Object(pt.a)(Qm,{onCompleted:function(e){N(e.task)}}),G=Object(u.a)(U,1)[0],V=function(e){var t=k.map((function(t){return"task"===t.type&&"task"+t.id===e.target.name?Object(_.a)(Object(_.a)({},t),{},{checked:e.target.checked}):Object(_.a)({},t)}));w(t)};return Object(o.useEffect)((function(){if(window.location.pathname.includes("/new/tasks/by_range")){var e=new URLSearchParams(window.location.search);if(e.has("tasks")){console.log(e.get("tasks"));var t=function(e){for(var t=[],a=e.split(","),n=0;n<a.length;n++)a[n].includes("-")?function(){var e=a[n].split("-");e=e.map((function(e){return parseInt(e)})),t.push.apply(t,Object(y.a)(Object(y.a)(Array(e[1]-e[0]+1).keys()).map((function(t){return t+e[0]}))))}():t.push(parseInt(a[n]));return t.sort((function(e,t){return e-t})),t}(e.get("tasks"));G({variables:{task_range:t}})}else O.b.warning("URL Query missing '?tasks=' with a range of tasks")}else G({variables:{task_range:[parseInt(a)]}})}),[G,a]),Object(g.jsxs)("div",{style:{marginTop:"10px",maxHeight:"calc(94vh)",width:"100%",marginBottom:"10px"},children:[Object(g.jsxs)(T.a,{elevation:5,style:{backgroundColor:q.pageHeader.main,color:q.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Task View"}),Object(g.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:q.palette.success.main},onClick:function(){var e=function(e){e.sort((function(e,t){return e-t}));for(var t,a,n=[],i=0;i<e.length;i++){for(a=t=e[i];e[i+1]-e[i]===1;)a=e[i+1],i++;n.push(t===a?t+"":t+"-"+a)}return n.join(",")}(Object(y.a)(r));Object(ls.a)(window.origin+"/new/tasks/by_range?tasks="+e),O.b.success("Copied link to clipboard!")},children:"Get Shareable link"}),Object(g.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:q.palette.warning.main},onClick:function(){I(!D);var e=k.filter((function(e){return!e.checked}));w(e);var t=e.reduce((function(e,t){return"task"===t.type?[].concat(Object(y.a)(e),[t.id]):Object(y.a)(e)}),[]);c(t)},children:"Remove Tasks From View"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(e){e.stopPropagation(),O.b.warning("Not implemented yet")},children:"Add Tags To All"})]}),k.map((function(e){return"task"===e.type?Object(g.jsxs)(ft.a,{container:!0,alignItems:"stretch",style:{marginRight:"5px"},children:[Object(g.jsx)(ft.a,{item:!0,style:{display:"inline-flex",width:D?"96%":"100%"},children:Object(g.jsx)(Xd.a,{task:e,command_id:null===e.command?0:e.command.id})}),Object(g.jsx)(ft.a,{item:!0,style:{display:"inline-flex"},children:D?Object(g.jsx)($.a,{checked:e.checked,onChange:V,name:"task"+e.id,inputProps:{"aria-label":"checkbox",color:q.palette.error.main}}):null})]},"taskdisplay:"+e.id):Object(g.jsxs)(T.a,{elevation:5,style:{marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(g.jsxs)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:[""===e.domain?null:e.domain+"\\",e.user,e.integrity_level>2?"*":null,"@",e.host," (",e.id,")"]}),Object(g.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:q.palette.info.main},onClick:function(){!function(e){var t=k.reduce((function(t,a){return"task"===a.type&&a.callback.id===e?[].concat(Object(y.a)(t),[a.id]):Object(y.a)(t)}),[]);p(t),F(!0)}(e.id)},children:"Include More Tasks"})]},"taskdisplayforcallback:"+e.id)})),Object(g.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:E,onClose:function(){F(!1)},innerDialog:Object(g.jsx)(Vm,{submitFetchTasks:function(e){var a=e.taskSelected,n=e.beforeCount,i=e.afterCount,r=e.search;switch(O.b.info("Searching for tasks..."),r){case"all":B({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i}});break;case"callback":W({variables:{}});break;default:H({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i,operator:r}})}},taskOptions:j,onClose:function(){F(!1)}})}),Object(g.jsx)(Gm,{taskIDs:r})]})}var eh,th,ah,nh=a(369),ih=a(936),rh=a(538),ch=Object(rh.a)(eh||(eh=Object(v.a)(["\nbody {\n    margin: 0\n}\nhtml, body, #root {\n    height: 100%;\n}\n.MuiAccordionDetails-root{\n\n    padding-bottom: 0;\n    padding-top: 0;\n}\n.MuiAccordionSummary-content.Mui-expanded{\n    margin: 0px 0px 0px 0px !important;\n    min-height: unset;\n}\n.MuiAccordionSummary-root.Mui-expanded{\n    min-height: unset;\n}\n// placeholder/helper text for input boxes\n.MuiFormLabel-root {\n    background: transparent;\n}\n.MuiTableCell-head {\n\n    font-weight: bold;\n}\n.MuiSelect-select.MuiSelect-select{\n    padding-left: 10px\n}\n.ReactVirtualized__Table__row {\n    &:hover,\n    &--hovered {\n        background-color: "," !important;\n        color: "," !important;\n        \n    }\n}\n.menuEntry {\n  cursor: pointer;\n}\n\ntspan {\n  font-size: 15px;\n  stroke: none;\n}\n\n.ReactVirtualized__Table__headerTruncatedText {\n\n  }\n.ReactVirtualized__Table__headerColumn {\n\n    padding: 0;\n  }\n.MuiTab-root {\n    max-width: unset;\n}\n.MuiSpeedDialAction-staticTooltipLabel {\n    white-space: nowrap;\n    max-width: none;\n}\n.MuiTreeItem-root.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label{\n    background-color: transparent;\n}\n.MuiTreeItem-root.Mui-selected:hover > .MuiTreeItem-content .MuiTreeItem-label{\n    background-color: transparent;\n}\n.MuiTreeItem-root:hover > .MuiTreeItem-content .MuiTreeItem-label {\n    background-color: transparent;\n}\n.MuiAppBar-root{\n    z-index: 1\n}\n.ace-monokai .ace_invalid {\n    color: #F8F8F0;\n    background-color: #52524d;\n}\n"])),(function(e){return e.theme.tableHover}),(function(e){return e.theme.palette.text.primary})),oh=a(937),sh=Object(be.a)(th||(th=Object(v.a)(["\nmutation generateReportMutation($outputFormat: String!, $includeMITREPerTask: Boolean!, $includeMITREOverall: Boolean!, $excludedUsers: String!, $excludedHosts: String!, $excludedIDs: String!, $includeOutput: Boolean!){\n    generateReport(outputFormat: $outputFormat, includeMITREPerTask: $includeMITREPerTask, includeMITREOverall: $includeMITREOverall, excludedUsers: $excludedUsers, excludedHosts: $excludedHosts, excludedIDs: $excludedIDs, includeOutput: $includeOutput){\n        status\n        error\n    }\n}\n"]))),lh=Object(be.a)(ah||(ah=Object(v.a)(['\nsubscription generatedReportEventSubscription($fromNow: timestamp!, $operation_id: Int!){\n    operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}, operation_id: {_eq: $operation_id}, source: {_eq: "generated_report"}}, order_by: {id: desc}) {\n        operator {\n            username\n        }\n        message\n        level\n      }\n}\n'])));function dh(e){var t,a=Object(ee.a)(),n=Object(f.a)(h.b),i=s.a.useRef((new Date).toISOString()),r=s.a.useState("pdf"),c=Object(u.a)(r,2),l=c[0],d=c[1],p=s.a.useState(!1),m=Object(u.a)(p,2),x=m[0],y=m[1],_=s.a.useState(!1),v=Object(u.a)(_,2),P=v[0],A=v[1],E=s.a.useState(!1),L=Object(u.a)(E,2),F=L[0],q=L[1],N=s.a.useState(!1),R=Object(u.a)(N,2),B=(R[0],R[1]),z=s.a.useState(""),W=Object(u.a)(z,2),M=W[0],H=W[1],U=s.a.useState(""),G=Object(u.a)(U,2),V=G[0],K=G[1],Q=s.a.useState(""),J=Object(u.a)(Q,2),Y=J[0],Z=J[1],X=Object(pe.a)(sh,{onCompleted:function(e){"success"===e.generateReport.status?(O.b.info("Generating report..."),O.b.info("Final reports are always available via the 'Uploads' tab within 'Search'")):O.b.error(e.generateReport.error)},onError:function(e){O.b.error(e)}}),te=Object(u.a)(X,1)[0],ae=Object(ze.a)(lh,{variables:{fromNow:i.current,operation_id:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onError:function(e){O.b.warning("Failed to get notifications for generated payloads")}}).data;return Object(o.useEffect)((function(){var e;if(console.log(ae),(null===ae||void 0===ae||null===(e=ae.operationeventlog)||void 0===e?void 0:e.length)>0){var t=ae.operationeventlog[0].message.split(":").pop().trim();O.b.success("",{persist:!0,content:function(e){return Object(g.jsx)(gu,{id:e,title:"Download Generated Report",downloadLink:window.location.origin+"/api/v1.4/files/download/"+t})}})}}),[ae]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(g.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(D.a,{children:Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"25rem"},children:"Report Option"}),Object(g.jsx)(C.a,{children:"Selected Values"})]})}),Object(g.jsxs)(w.a,{children:[Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Output Format"}),Object(g.jsx)(C.a,{children:Object(g.jsx)(ht.a,{autoFocus:!0,style:{width:"100%",marginBottom:"10px"},value:l,label:"Select an Output Format",onChange:function(e){d(e.target.value),"json"!==e.target.value&&q(!1),"json"===e.target.value&&B(!1)},children:["pdf","latex","json"].map((function(e,t){return Object(g.jsx)(tt.a,{value:e,children:e},"outputformat"+t)}))})})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Include MITRE ATT&CK Coverage Per Task"}),Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:x,onChange:function(e){return y(!x)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Include MITRE ATT&CK Coverage Overview"}),Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:P,onChange:function(e){return A(!P)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),"json"===l&&Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Include Command Output"}),Object(g.jsx)(C.a,{children:Object(g.jsx)($.a,{checked:F,onChange:function(e){return q(!F)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),Object(g.jsxs)(I.a,{hover:!0,children:[Object(g.jsx)(C.a,{children:"Exclude Callbacks With Matching Values"}),Object(g.jsx)(C.a,{children:Object(g.jsxs)(k.a,{children:[Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{style:{width:"10rem"},children:"Exclude Users"}),Object(g.jsx)(C.a,{children:Object(g.jsx)(j.a,{onChange:function(e,t,a){K(t)},value:V,name:"Excluded Usernames"})})]}),Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Exclude Hosts"}),Object(g.jsx)(C.a,{children:Object(g.jsx)(j.a,{onChange:function(e,t,a){H(t)},value:M,name:"Excluded Hostnames"})})]}),Object(g.jsxs)(I.a,{children:[Object(g.jsx)(C.a,{children:"Exclude IDs"}),Object(g.jsx)(C.a,{children:Object(g.jsx)(j.a,{onChange:function(e,t,a){Z(t)},value:Y,name:"Excluded Callback IDs"})})]})]})})]})]})]})}),Object(g.jsx)(b.a,{variant:"contained",style:{marginTop:"10px",backgroundColor:a.palette.success.main,color:"white"},onClick:function(){te({variables:{outputFormat:l,includeMITREOverall:P,includeMITREPerTask:x,includeOutput:F,excludedUsers:V,excludedHosts:M,excludedIDs:Y}})},children:"Generate"})]})}function uh(){var e=Object(ee.a)();return Object(g.jsxs)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:[Object(g.jsx)(T.a,{elevation:5,style:{backgroundColor:e.pageHeader.main,color:e.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Mythic Report Generation"})}),Object(g.jsx)(dh,{})]})}function bh(e){var t=Object(f.a)(h.b),a=function(){var e=Object(o.useState)("light"),t=Object(u.a)(e,2),a=t[0],n=t[1],i=Object(o.useState)(!1),r=Object(u.a)(i,2),c=r[0],s=r[1],l=function(e){window.localStorage.setItem("theme",e),n(e)};return Object(o.useEffect)((function(){var e=window.localStorage.getItem("theme");e?n(e):l("light"),s(!0)}),[]),[a,function(){l("light"===a?"dark":"light")},c]}(),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useMemo((function(){return Object(nh.a)({palette:{primary:{main:"#7f93c0"},secondary:{main:"#a791c3"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"},type:i,background:{default:"dark"===i?"rgb(37, 41, 51)":"#ffffff",paper:"dark"===i?"rgb(50, 60, 69)":"#ffffff",contrast:"dark"===i?"#ffffff":"rgb(37, 41, 51)"},text:{primary:"dark"===i?"#fff":"#000",secondary:"dark"===i?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.54)",contrast:"dark"===i?"#000":"#fff"},textBackgroundColor:"dark"===i?"#74828b":"#d9dbdc",textBackgroundColorMythic:"dark"===i?"#436b9f":"#aadcf5",textBackgroundColorSuccess:"dark"===i?"#09a21a":"#70e373",textBackgroundColorError:"dark"===i?"#9f1616":"#f19da3",graphGroup:"dark"===i?"#394c5d":"#d3d7e8"},folderColor:"#f1d592",tableHeader:"#484848",tableBorder:"dark"===i?"rgba(81,81,81,1)":"rgba(224,224,224,1)",tableHover:"dark"===i?"rgba(61, 69, 75)":"rgba(245, 245, 245)",pageHeader:{main:"#827E80"},pageHeaderText:{main:"white"}})}),[i]);return Object(g.jsxs)(ih.a,{theme:c,children:[Object(g.jsx)(ch,{theme:c}),Object(g.jsx)(oh.a,{}),Object(g.jsxs)(qa.b,{maxSnack:5,anchorOrigin:{vertical:"top",horizontal:"center"},children:[Object(g.jsx)(O.a,{}),Object(g.jsxs)("div",{style:{maxHeight:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[Object(g.jsx)("div",{style:{minHeight:"54px",flexGrow:0},children:t.loggedIn&&void 0!==t.user&&null!==t.user?Object(g.jsx)(Em,{theme:i,toggleTheme:r}):null}),Object(g.jsx)("div",{style:{margin:"0px 16px 0px 16px",flexGrow:1,display:"flex",flexDirection:"column",height:"calc(100% - 54px)",maxHeight:"calc(100% - 54px)"},children:Object(g.jsxs)(m.d,{children:[Object(g.jsx)(po,{exact:!0,path:"/new",component:uo}),Object(g.jsx)(m.b,{exact:!0,path:"/new/login",component:x}),Object(g.jsx)(po,{exact:!0,path:"/new/settings",component:we}),Object(g.jsx)(po,{exact:!0,path:"/new/payloadtypes",component:aa}),Object(g.jsx)(po,{exact:!0,path:"/new/eventfeed",component:hi}),Object(g.jsx)(po,{exact:!0,path:"/new/createpayload",component:en}),Object(g.jsx)(po,{exact:!0,path:"/new/createwrapper",component:$n}),Object(g.jsx)(po,{exact:!0,path:"/new/payloads",component:Lc}),Object(g.jsx)(po,{exact:!0,path:"/new/c2profiles",component:aa}),Object(g.jsx)(po,{exact:!0,path:"/new/services/",component:aa}),Object(g.jsx)(po,{exact:!0,path:"/new/callbacks",component:Vd}),Object(g.jsx)(po,{path:"/new/search",component:Rp}),Object(g.jsx)(po,{exact:!0,path:"/new/browserscripts",component:zr}),Object(g.jsx)(po,{exact:!0,path:"/new/task/:taskId",component:Xm}),Object(g.jsx)(po,{exact:!0,path:"/new/tasks/by_range",component:Xm}),Object(g.jsx)(po,{exact:!0,path:"/new/operations",component:hr}),Object(g.jsx)(po,{exact:!0,path:"/new/callbacks/:callbackId",component:to}),Object(g.jsx)(po,{exact:!0,path:"/new/reporting",component:uh})]})})]})]})]})}var jh=a(848),ph=a(940),mh=a(16),hh=a(357),fh=a(846),Oh=a(545),gh=a(544),xh=a(943),yh=a(239),_h=a(170),vh=a(543),kh=a(358),wh=a.n(kh),Ch=a(368),Sh="2.3.4",Dh="0.0.5",Ih=new jh.a({typePolicies:{Query:{fields:{operationeventlog:{},callback:{}}}}}),Th=new xh.a({delay:{initial:20,max:300,jitter:!0},attempts:{max:2,retryIf:function(e,t){return!!e}}}),$h=new ph.a({uri:window.location.origin+"/graphql/",options:{reconnect:!0,connectionParams:{headers:{Authorization:function(){return"Bearer ".concat(localStorage.getItem("access_token"))}}}}}),Ph=function(){var e=localStorage.getItem("access_token");if(e){var t=Object(Ch.a)(e);return!(Date.now()>1e3*t.exp)}return!1},Ah=Object(vh.a)(function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.headers,!(n=localStorage.getItem("access_token"))){e.next=21;break}if(i=Object(Ch.a)(n),c=Math.abs(Date.now()-1e3*i.exp),72e5,!(c<72e5)&&Ph()){e.next=19;break}return console.log("token is at its half life or less, try to get a new token"),e.next=10,Lh();case 10:if(!e.sent){e.next=15;break}return e.abrupt("return",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});case 15:console.log("update failed!"),Object(h.a)();case 17:e.next=19;break;case 19:e.next=21;break;case 21:return e.abrupt("return",{Authorization:"Bearer ".concat(localStorage.getItem("access_token")),headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});case 22:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Eh=Object(gh.a)((function(e){var t=e.graphQLErrors,a=e.networkError;console.log("errors?");try{if(t){console.log("[graphQLError]",t);var i,r=Object(n.a)(t);try{for(r.s();!(i=r.n()).done;){var c=i.value;switch(c.extensions.code){case"forbidden":O.b.error(c.message);break;case"access-denied":case"start-failed":console.log("got start-failed error in graphql"),console.log("would have asked for new token, but auth link will handle it");case"validation-failed":return void console.log(c);default:console.log(c),O.b.error(c.message)}}}catch(c){r.e(c)}finally{r.f()}}if(a){if(console.log("[Network error]",a),void 0===a.extensions)return O.b.error("Failed to connect to Mythic, please refresh"),Object(h.a)(),Bh(),void(window.location="/new/login");switch(a.extensions.code){case"access-denied":O.b.warning("Access Denied");break;case"start-failed":console.log("got start-failed error in network"),Object(h.a)(),Bh(),window.location="/new/login";break;default:console.log(a)}}}catch(o){return O.b.error("Failed to connect to Mythic, please refresh"),console.log(o),Bh(),void(window.location="/new/login")}})),Lh=function(){var e=Object(c.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:localStorage.getItem("refresh_token"),access_token:localStorage.getItem("access_Token")})},e.next=3,fetch("/refresh",t);case 3:return a=e.sent,n=a.json().then((function(e){return console.log(e),"access_token"in e?(Object(h.e)(e),console.log("successfully got new access_token"),!0):(console.log("calling FailedRefresh from GetNewToken call"),Object(h.a)(),!1)})).catch((function(e){return console.log("Error trying to get json response in GetNewToken",e),console.log(a),Object(h.a)(),!1})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Fh=new yh.SubscriptionClient("https:"===window.location.protocol?"wss://"+window.location.host+"/graphql/":"ws://"+window.location.host+"/graphql/",{reconnect:!0,reconnectionAttempts:10,connectionParams:function(){return{Authorization:"Bearer ".concat(localStorage.getItem("access_token")),headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),qh=new Oh.a(Fh),Nh=Object(mh.split)((function(e){var t=e.query,a=Object(_h.e)(t);return"OperationDefinition"===a.kind&&"subscription"===a.operation}),qh,$h),Rh=new hh.a({link:Object(mh.from)([Ah,Eh,Th,Ah.concat(Nh)]),cache:Ih});function Bh(){var e=Object.assign({},Fh.operations);Fh.close(!0),Fh.connect(),Object.keys(e).forEach((function(t){Fh.sendMessage(t,wh.a.GQL_START,e[t].options)}))}null!==localStorage.getItem("access_token")&&(Ph(localStorage.getItem("access_token"))?null!==localStorage.getItem("user")&&Object(h.b)({loggedIn:!0,access_token:localStorage.getItem("access_token"),refresh_token:localStorage.getItem("refresh_token"),user:JSON.parse(localStorage.getItem("user"))}):(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"))),d.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(fh.a,{client:Rh,children:Object(g.jsx)(Gp.a,{children:Object(g.jsx)(bh,{},"App")})})}),document.getElementById("root"))},92:function(e,t,a){"use strict";a.d(t,"a",(function(){return me})),a.d(t,"d",(function(){return he})),a.d(t,"c",(function(){return fe})),a.d(t,"b",(function(){return xe}));var n,i=a(6),r=a(7),c=a(3),o=a(2),s=a(50),l=a(1),d=a.n(l),u=a(67),b=a(221),j=a(876),p=a(249),m=a(207),h=a(4),f=a(14),O=a(139),g=a(62),x=a(218),y=a(294),_=a.n(y),v=a(849),k=a(296),w=a.n(k),C=a(69),S=a(124),D=a(123),I=a(131),T=a(18),$=a(921),P=a(378),A=a(947),E=a(372),L=a(374),F=a(376),q=a(373),N=a(558),R=a(143),B=a(875),z=a(219),W=a(19),M=a(324),H=a(0),U={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},G=Object(R.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}})),V=Object(u.a)(n||(n=Object(r.a)(["\nquery operatorQuery($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    operators {\n      username\n      id\n    }\n  }\n}"])));function K(e){var t=Object(M.a)(W.b),a=d.a.useState([]),n=Object(o.a)(a,2),i=n[0],r=n[1],c=d.a.useState([]),s=Object(o.a)(c,2),u=s[0],b=s[1],j=d.a.useState(!1),p=Object(o.a)(j,2),m=p[0],h=p[1],f=d.a.useState([]),O=Object(o.a)(f,2),g=O[0],x=O[1],y=d.a.useState([]),_=Object(o.a)(y,2),v=_[0],k=_[1],w=d.a.useState(""),R=Object(o.a)(w,2),K=R[0],Q=R[1],J=d.a.useState([]),Y=Object(o.a)(J,2),Z=Y[0],X=Y[1],ee=G();Object(z.a)(V,{variables:{operation_id:t.user.current_operation_id},onCompleted:function(e){b(e.operation_by_pk.operators.map((function(e){return e.username})))}}),Object(l.useEffect)((function(){if(void 0!==e.filterOptions.operatorsList&&r(e.filterOptions.operatorsList),void 0!==e.filterOptions.commentsFlag&&h(e.filterOptions.commentsFlag),void 0!==e.filterOptions.commandsList&&x(e.filterOptions.commandsList),void 0!==e.filterOptions.parameterString&&Q(e.filterOptions.parameterString),void 0!==e.filterOptions.everythingButList&&k(e.filterOptions.everythingButList),e.filterCommandOptions){var t=e.filterCommandOptions.map((function(e){return e.cmd}));X(t)}}),[e.filterOptions]);return Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsx)(I.a,{id:"form-dialog-title",children:"Filter Which Tasks Are Visible"}),Object(H.jsx)(D.a,{dividers:!0,style:{overflow:"hidden"},children:Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsxs)(q.a,{className:ee.formControl,children:[Object(H.jsx)(L.a,{id:"operator-chip-label",children:"Only Show Tasks by the Following Operators"}),Object(H.jsx)(P.a,{labelId:"operator-chip-label",multiple:!0,id:"operator-chip",value:i,onChange:function(e){r(e.target.value)},input:Object(H.jsx)(E.a,{}),renderValue:function(e){return Object(H.jsx)("div",{className:ee.chips,children:e.map((function(e){return Object(H.jsx)(A.a,{label:e,className:ee.chip},e)}))})},MenuProps:U,children:u.map((function(e){return Object(H.jsxs)(F.a,{value:e,children:[Object(H.jsx)(B.a,{color:"primary",checked:i.indexOf(e)>-1}),Object(H.jsx)(N.a,{primary:e})]},e)}))})]}),"Only Show Tasks with Comments: ",Object(H.jsx)($.a,{checked:m,onChange:function(e){h(e.target.checked)},color:"primary",name:"Only Comments",inputProps:{"aria-label":"primary checkbox"}}),Object(H.jsxs)(q.a,{className:ee.formControl,children:[Object(H.jsx)(L.a,{id:"include-chip-label",children:"Only Show These Commands"}),Object(H.jsx)(P.a,{labelId:"include-chip-label",multiple:!0,id:"include-chip",value:g,onChange:function(e){x(e.target.value),e.target.value.length>0&&k([])},input:Object(H.jsx)(E.a,{}),renderValue:function(e){return Object(H.jsx)("div",{className:ee.chips,children:e.map((function(e){return Object(H.jsx)(A.a,{label:e,className:ee.chip},e)}))})},MenuProps:U,children:Z.map((function(e){return Object(H.jsxs)(F.a,{value:e,children:[Object(H.jsx)(B.a,{color:"primary",checked:g.indexOf(e)>-1}),Object(H.jsx)(N.a,{primary:e})]},e)}))})]}),Object(H.jsxs)(q.a,{className:ee.formControl,children:[Object(H.jsx)(L.a,{id:"exclude-chip-label",children:"Do Not Show These Commands"}),Object(H.jsx)(P.a,{labelId:"exclude-chip-label",multiple:!0,id:"exclude-chip",value:v,onChange:function(e){k(e.target.value),e.target.value.length>0&&x([])},input:Object(H.jsx)(E.a,{}),renderValue:function(e){return Object(H.jsx)("div",{className:ee.chips,children:e.map((function(e){return Object(H.jsx)(A.a,{label:e,className:ee.chip},e)}))})},MenuProps:U,children:Z.map((function(e){return Object(H.jsxs)(F.a,{value:e,children:[Object(H.jsx)(B.a,{color:"primary",checked:v.indexOf(e)>-1}),Object(H.jsx)(N.a,{primary:e})]},e)}))})]}),Object(H.jsx)(T.a,{value:K,onChange:function(e,t,a){Q(t)},name:"Only Show Tasks with the Following Parameter Regex"})]})}),Object(H.jsxs)(S.a,{children:[Object(H.jsx)(C.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(H.jsx)(C.a,{onClick:function(){e.onSubmit({operatorsList:i,commentsFlag:m,commandsList:g,everythingButList:v,parameterString:K}),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}function Q(e){var t=d.a.useState([]),a=Object(o.a)(t,2),n=a[0],r=a[1],c=d.a.useState(""),s=Object(o.a)(c,2),u=s[0],b=s[1],j=Object(l.useRef)(null);Object(l.useEffect)((function(){var t=Object(i.a)(e.options);r(t),t.length,b("Default Token"),e.changeSelectedToken("Default Token")}),[e.options]);return Object(H.jsxs)(q.a,{style:{width:"20%"},children:[Object(H.jsx)(L.a,{ref:j,children:"Tokens"}),Object(H.jsxs)(P.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:u,onChange:function(t){b(t.target.value),e.changeSelectedToken(t.target.value)},variant:"filled",renderValue:function(e){return"Default Token"===e?"Default Token":null===e.User?e.tokenId:e.User},input:Object(H.jsx)(E.a,{style:{width:"100%"}}),children:[Object(H.jsx)(F.a,{value:"Default Token",children:"Default Token"},0),n.map((function(e){return Object(H.jsx)(F.a,{value:e.token,children:null===e.token.User?e.token.TokenId+" - "+e.token.description:e.token.User+" - "+e.token.description},e.token.id)}))]})]})}var J,Y,Z,X=a(505),ee=a.n(X),te=a(830),ae=Object(u.a)(J||(J=Object(r.a)(["\nsubscription GetLoadedCommandsSubscription($callback_id: Int!){\n    loadedcommands(where: {callback_id: {_eq: $callback_id}}){\n        id\n        command {\n            cmd\n            id\n            attributes\n            commandparameters {\n                id\n                parameter_type: type \n                required\n                name\n                ui_position\n                parameter_group_name\n                cli_name\n                display_name\n            }\n        }\n    }\n    \n}\n"]))),ne=Object(u.a)(Y||(Y=Object(r.a)(["\nsubscription subscriptionCallbackTokens ($callback_id: Int!){\n  callbacktoken(where: {deleted: {_eq: false}, callback_id: {_eq: $callback_id}}) {\n    token {\n      TokenId\n      id\n      User\n      description\n    }\n    id\n  }\n}\n"]))),ie=Object(u.a)(Z||(Z=Object(r.a)(["\nsubscription tasksSubscription($callback_id: Int!){\n    task(where: {callback_id: {_eq: $callback_id}}, order_by: {id: desc}){\n        id\n        original_params\n        display_params\n        command_name\n        comment\n        tasking_location\n        parameter_group_name\n        status\n        operator{\n            username\n        }\n        command {\n            commandparameters {\n                id\n                type\n                name\n            }\n        }\n    }\n}\n"])));function re(e){var t={anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:2e3,preventDuplicate:!0,maxSnack:1,style:{marginBottom:"50px"}},a={anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:1e3,preventDuplicate:!0,maxSnack:1,style:{marginBottom:"100px"}},n=d.a.useState(""),r=Object(o.a)(n,2),s=r[0],l=r[1],u=d.a.useState([]),b=Object(o.a)(u,2),p=b[0],m=b[1],O=d.a.useState([]),y=Object(o.a)(O,2),k=y[0],C=y[1],S=d.a.useState(-1),D=Object(o.a)(S,2),I=D[0],T=D[1],$=d.a.useState([]),P=Object(o.a)($,2),A=P[0],E=P[1],L=d.a.useState([]),F=Object(o.a)(L,2),q=F[0],N=F[1],R=d.a.useState(-1),B=Object(o.a)(R,2),z=B[0],U=B[1],G=d.a.useState(!1),V=Object(o.a)(G,2),J=V[0],Y=V[1],Z=d.a.useState([]),X=Object(o.a)(Z,2),re=X[0],ce=X[1],oe=d.a.useState("parsed_cli"),se=Object(o.a)(oe,2),le=se[0],de=se[1],ue=d.a.useState(!1),be=Object(o.a)(ue,2),je=be[0],pe=be[1],me=d.a.useState(""),he=Object(o.a)(me,2),fe=he[0],Oe=he[1],ge=d.a.useState([]),xe=Object(o.a)(ge,2),ye=xe[0],_e=xe[1],ve=d.a.useState(-1),ke=Object(o.a)(ve,2),we=ke[0],Ce=ke[1],Se=Object(M.a)(W.b);Object(j.a)(ne,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;ce(t.data.callbacktoken)}}),Object(j.a)(ie,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;C(t.data.task);var a=t.data.task.filter((function(e){return De(e)}));E(a)}}),Object(j.a)(ae,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData.data.loadedcommands.map((function(e){var t=Object(c.a)({},e.command);return t.attributes=JSON.parse(t.attributes),t}));t.push({cmd:"help",description:"Get help for a command or info about loaded commands",commandparameters:[],attributes:{supported_os:[]}}),t.push({cmd:"clear",description:"Clear 'submitted' jobs from being pulled down by an agent",commandparameters:[],attributes:{supported_os:[]}}),t.sort((function(e,t){return e.cmd>t.cmd?1:-1})),m(t)}}),d.a.useEffect((function(){var e=k.filter((function(e){return De(e)}));E(e)}),[e.filterOptions]);var De=function(t){if(t.display_params.includes("help")&&t.operator.username!==Se.user.username)return!1;if(void 0===e.filterOptions)return!0;if(e.filterOptions.operatorsList.length>0&&!e.filterOptions.operatorsList.includes(t.operator.username))return!1;if(e.filterOptions.commentsFlag&&""===t.comment)return!1;if(e.filterOptions.commandsList.length>0&&!e.filterOptions.commandsList.includes(t.command_name))return!1;if(e.filterOptions.everythingButList.length>0&&null!==t.command&&e.filterOptions.everythingButList.includes(t.command_name))return!1;if(""!==e.filterOptions.parameterString&&!new RegExp(e.filterOptions.parameterString).test(t.display_params))return!1;return!0},Ie=function(e,a){for(var n=[],i=[],r=[],c=[],o=0;o<a.commandparameters.length;o++)switch(a.commandparameters[o].parameter_type){case"Choice":case"String":n.push(a.commandparameters[o].cli_name);case"Number":c.push(a.commandparameters[o].cli_name);break;case"Boolean":i.push(a.commandparameters[o].cli_name);break;case"Array":case"ChoiceMultiple":r.push(a.commandparameters[o].cli_name);break;default:n.push(a.commandparameters[o].cli_name)}try{var s=te(e);return ee()(s,{string:n,boolean:i,number:c,array:r,configuration:{"short-option-groups":!1,"camel-case-expansion":!1,"dot-notation":!1,"unknown-options-as-args":!1,"greedy-arrays":!0}})}catch(l){return void h.b.warning("Failed to parse command line: "+l,t)}},Te=function(e,t){if(0===e.commandparameters.length)return[];for(var a=e.commandparameters.reduce((function(e,t){return e.includes(t.parameter_group_name)?Object(i.a)(e):[].concat(Object(i.a)(e),[t.parameter_group_name])}),[]),n=0,r=Object.keys(t);n<r.length;n++){var c=r[n];if("_"!==c){var o=function(){for(var t=[],n=0;n<e.commandparameters.length;n++)e.commandparameters[n].cli_name===c&&t.push(e.commandparameters[n].parameter_group_name);var r=a.reduce((function(e,a){return t.includes(a)?[].concat(Object(i.a)(e),[a]):Object(i.a)(e)}),[]);if(0===r.length)return{v:[]};a=Object(i.a)(r)}();if("object"===typeof o)return o.v}}return a},$e=function(a,n){a.preventDefault(),a.stopPropagation();var i=s.split(" "),r=p.find((function(e){return e.cmd===i[0]}));if(void 0!==r){var o="Default",d={};if(le.includes("modal")||le.includes("browserscript"))try{var u=i.slice(1).join(" ");d=JSON.parse(u),o=Te(r,d)}catch(j){return void h.b.warning("Failed to parse modified JSON value",t)}else{var b=Ie(s,r);if(!b)return;if(o=Te(r,b),r.commandparameters.length>0){if((d=function(e,t,a){var n=Object(c.a)({},t);if(n._.shift(),0===e.commandparameters.length)return n;if(0===a.length)return n;var i=e.commandparameters.filter((function(e){return e.parameter_group_name===a[0]}));i.sort((function(e,t){return e.ui_position<t.ui_position?-1:1}));for(var r=[],o=0;o<i.length;o++)i[o].cli_name in n||r.push(i[o]);for(var s=0;s<r.length-1;s++)n._.length>0&&(n[i[s].cli_name]=n._.shift());return r.length>0&&n._.length>0&&(n[r[r.length-1].cli_name]=n._.join(" "),n._=[]),n}(r,b,o))._.length>0)return void h.b.warning("Too many positional arguments given. Did you mean to quote some of them?",t)}else d=b}if(void 0!==o){if(o.length>1){if(Boolean(n))e.onSubmitCommandLine(s,r,d,Boolean(n),o,le);else{if(!o.includes("Default"))return void h.b.warning("Passed arguments are ambiguous, use shift+enter for modal or provide more parameters",t);e.onSubmitCommandLine(s,r,d,Boolean(n),["Default"],le)}return l(""),T(-1),Ce(-1),pe(!1),void de("parsed_cli")}e.onSubmitCommandLine(s,r,d,Boolean(n),o,le),l(""),T(-1),Ce(-1),pe(!1),de("parsed_cli")}else h.b.warning("Two or more of the specified parameters can't be used together",t)}else h.b.warning("Unknown command",t)};return Object(H.jsxs)(d.a.Fragment,{children:[je&&Object(H.jsx)(v.a,{placeholder:"Search previous commands",onKeyDown:function(e){if("Escape"===e.key)pe(!1),Ce(0),_e([]);else if("Tab"===e.key)pe(!1),Ce(0),_e([]);else if("Enter"===e.key)pe(!1),Ce(0),_e([]),$e(e);else if("ArrowUp"===e.key){if(0===ye.length)return void h.b.warning("No matching options",a);var t=(we+1)%ye.length;Ce(t),l(ye[t].command_name+" "+ye[t].original_params)}else if("ArrowDown"===e.key){if(0===ye.length)return void h.b.warning("No matching options",a);var n=(we-1)%ye.length;n<0&&(n=ye.length-1),Ce(n),l(ye[n].command_name+" "+ye[n].original_params)}},onChange:function(e){if(Oe(e.target.value),0===e.target.value.length)return l(""),_e([]),void Ce(0);var t=e.target.value.toLowerCase(),a=k.filter((function(e){return(e.command_name+" "+e.original_params).toLowerCase().includes(t)})).filter((function(e){return De(e)}));_e(a),a.length>0&&l(a[0].command_name+" "+a[0].original_params)},size:"small",autoFocus:!0,variant:"outlined",value:fe,fullWidth:!0,InputProps:{type:"search",startAdornment:Object(H.jsx)(d.a.Fragment,{children:Object(H.jsx)(g.a,{style:{width:"10%"},children:"reverse-i-search:"})})}}),Object(H.jsx)(v.a,{placeholder:"Task an agent...",onKeyDown:function(a){if("r"===a.key&&a.ctrlKey&&(pe(!0),l(""),Oe(""),de("parsed_cli")),"Tab"===a.key)if(a.stopPropagation(),a.preventDefault(),de("parsed_cli"),s.includes(" ")){var n=p.find((function(e){return e.cmd===s.split(" ")[0]}));if(n.commandparameters.length>0){if(" "!==s[s.length-1]){if(q.length>0){var r=(z+1)%q.length;U(r);var c=s.split(" ").slice(0,-1).join(" ")+" -"+q[r];return void l(c)}var d=s.split(" "),u=d.slice(-1)[0];if(u.startsWith("-")){var b=Ie(d.slice(0,-1).join(" "),n),j=Te(n,b);if(void 0===j)return void h.b.warning("Two or more of the specified parameters can't be used together",t);var m=[];if(n.commandparameters.find((function(e){return j.includes(e.parameter_group_name)&&e.cli_name===u.slice(1)&&!(e.cli_name in b)}))?(m=n.commandparameters.reduce((function(e,t){return j.includes(t.parameter_group_name)&&t.cli_name!==u.slice(1)&&!(t.cli_name in b)?[].concat(Object(i.a)(e),[t.cli_name]):Object(i.a)(e)}),[])).push(u.slice(1)):m=n.commandparameters.reduce((function(e,t){return j.includes(t.parameter_group_name)&&t.cli_name.toLowerCase().startsWith(u.slice(1).toLocaleLowerCase())&&!(t.cli_name in b)?[].concat(Object(i.a)(e),[t.cli_name]):Object(i.a)(e)}),[]),m.length>0){if(1===m.length){N([]),U(0);var f=d.slice(0,-1).join(" ")+" -"+m[0];l(f)}else{N(m),U(0);var O=d.slice(0,-1).join(" ")+" -"+m[0];l(O)}return}return void h.b.warning("Unknown Parameter Name",t)}return}var g=Ie(s,n),x=Te(n,g);if(void 0===x)return void h.b.warning("Two or more of the specified parameters can't be used together",t);console.log("cmdGroupNames in tab",x);for(var y=0,_=Object.entries(g);y<_.length;y++){var v=Object(o.a)(_[y],2),k=v[0],w=v[1];if("_"!==k){if(w!==w||void 0===w)return void h.b.warning(k+" needs a valid value",t);if(void 0===w){if(s.endsWith(" -"+k)){for(var C=0;C<n.commandparameters.length;C++)if(n.commandparameters[C].required&&!(n.commandparameters[C].cli_name in g)&&(x.includes(n.commandparameters[C].parameter_group_name)||0===x.length)){var S=s.trim().slice(0,-1*k.length)+n.commandparameters[C].cli_name;return void l(S)}for(var D=0;D<n.commandparameters.length;D++)if(!n.commandparameters[D].required&&!(n.commandparameters[D].cli_name in g)&&(x.includes(n.commandparameters[D].parameter_group_name)||0===x.length)){var $=s.trim().slice(0,-1*k.length)+n.commandparameters[D].cli_name;return void l($)}}return void h.b.warning(k+" needs a value",t)}}}for(var P=0;P<n.commandparameters.length;P++)if(n.commandparameters[P].required&&!(n.commandparameters[P].cli_name in g)&&(x.includes(n.commandparameters[P].parameter_group_name)||0===x.length)){var E=s.trim()+" -"+n.commandparameters[P].cli_name;return void l(E)}for(var L=0;L<n.commandparameters.length;L++)if(!n.commandparameters[L].required&&!(n.commandparameters[L].cli_name in g)&&(x.includes(n.commandparameters[L].parameter_group_name)||0===x.length)){var F=s.trim()+" -"+n.commandparameters[L].cli_name;return void l(F)}h.b.info("No more arguments for command",t)}else h.b.info("No arguments for command",t)}else if(0===q.length){var R=p.filter((function(t){return t.cmd.toLowerCase().startsWith(s.toLocaleLowerCase())&&(0===t.attributes.supported_os.length||t.attributes.supported_os.includes(e.callback_os))}));N(R),U(0),R.length>0&&l(R[0].cmd)}else U((z+1)%q.length),l(q[(z+1)%q.length].cmd);else if("Enter"===a.key)a.shiftKey?$e(a,!0):$e(a,!1);else if("ArrowUp"===a.key){if(0===A.length)return void h.b.warning("No previous tasks",t);var B=I+1;B>A.length-1&&(B=A.length-1),T(B),l(A[B].command_name+" "+A[B].original_params),de(A[B].tasking_location)}else if("ArrowDown"===a.key){if(0===A.length)return void h.b.warning("No previous tasks",t);var W=I-1;W<0&&(W=0),T(W),l(A[W].command_name+" "+A[W].original_params),de(A[W].tasking_location)}else N([]),U(0),-1!==I&&T(-1)},onChange:function(e){N([]),U(0),l(e.target.value),0===e.target.value.length&&de("parsed_cli")},size:"small",variant:"outlined",disabled:je,value:s,autoFocus:!0,fullWidth:!0,style:{marginBottom:"10px"},InputProps:{type:"search",endAdornment:Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsx)(x.a,{color:"primary",variant:"contained",onClick:$e,children:Object(H.jsx)(_.a,{})}),Object(H.jsx)(x.a,{color:"secondary",variant:"contained",onClick:function(){Y(!0)},children:Object(H.jsx)(w.a,{})})]}),startAdornment:Object(H.jsx)(d.a.Fragment,{children:re.length>0?Object(H.jsx)(Q,{options:re,changeSelectedToken:e.changeSelectedToken}):null})}}),J&&Object(H.jsx)(f.a,{fullWidth:!0,maxWidth:"md",open:J,onClose:function(){Y(!1)},innerDialog:Object(H.jsx)(K,{filterCommandOptions:p,onSubmit:e.onSubmitFilter,filterOptions:e.filterOptions,onClose:function(){Y(!1)}})})]})}var ce,oe,se,le,de=d.a.memo(re),ue=a(248),be=a(506),je=a.n(be),pe=a(47);function me(e){var t=d.a.useState(e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?e.tabInfo.callbackDescription:"Callback: "+e.tabInfo.callbackID),a=Object(o.a)(t,2),n=a[0],i=a[1],r=d.a.useState(!1),u=Object(o.a)(r,2),b=u[0],j=u[1];Object(l.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?i(e.tabInfo.callbackDescription):i("Callback: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsx)(s.b,Object(c.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),j(!0)}},e)),b&&Object(H.jsx)(f.a,{fullWidth:!0,open:b,onClose:function(){j(!1)},innerDialog:Object(H.jsx)(f.b,{title:"Edit Tab's Description",onClose:function(){j(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var he=Object(u.a)(ce||(ce=Object(r.a)(["\n    fragment taskData on task {\n        comment\n        callback_id\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        display_params\n        status\n        timestamp\n        command {\n          cmd\n          id\n        }\n        command_name\n        responses_aggregate {\n            aggregate{\n              count\n              max {\n                timestamp\n              }\n            }\n          }\n        opsec_pre_blocked\n        opsec_pre_bypassed\n        opsec_post_blocked\n        opsec_post_bypassed\n        tasks {\n            id\n        }\n        token {\n            id\n        }\n    }\n"]))),fe=Object(u.a)(oe||(oe=Object(r.a)(["\nmutation createTasking($callback_id: Int!, $command: String!, $params: String!, $files: String, $token_id: Int, $tasking_location: String, $original_params: String, $parameter_group_name: String) {\n  createTask(callback_id: $callback_id, command: $command, params: $params, files: $files, token: $token_id, tasking_location: $tasking_location, original_params: $original_params, parameter_group_name: $parameter_group_name) {\n    status\n    id\n    error\n  }\n}\n"]))),Oe=Object(u.a)(se||(se=Object(r.a)(["\n","\nsubscription getTasking($callback_id: Int!, $fromNow: timestamp!, $limit: Int){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}, timestamp: {_gt: $fromNow}}, order_by: {id: desc}, limit: $limit) {\n        ...taskData\n    }\n}\n "])),he),ge=Object(u.a)(le||(le=Object(r.a)(["\n","\nquery getBatchTasking($callback_id: Int!, $offset: Int!, $fetchLimit: Int!){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}}, order_by: {id: desc}, limit: $fetchLimit, offset: $offset) {\n        ...taskData\n    }\n    callback(where: {id: {_eq: $callback_id}}){\n        id\n    }\n}\n"])),he),xe=function(e){var t=e.tabInfo,a=e.index,n=e.value,r=e.onCloseTab,u=d.a.useState(10),g=Object(o.a)(u,2),y=g[0],_=g[1],v=d.a.useState(!1),k=Object(o.a)(v,2),w=k[0],C=k[1],S=d.a.useState({}),D=Object(o.a)(S,2),I=D[0],T=D[1],$=d.a.useState({task:[]}),P=Object(o.a)($,2),A=P[0],E=P[1],L=d.a.useRef({task:[]}),F=d.a.useState((new Date).toISOString()),q=Object(o.a)(F,2),N=q[0],R=(q[1],d.a.useState({})),B=Object(o.a)(R,2),z=B[0],W=B[1],M=d.a.useState({operatorsList:[],commentsFlag:!1,commandsList:[],parameterString:"",everythingButList:[]}),U=Object(o.a)(M,2),G=U[0],V=U[1],K=d.a.useState(!0),Q=Object(o.a)(K,2),J=Q[0],Y=Q[1];Object(l.useEffect)((function(){L.current=A}),[A]);var Z=d.a.useState(!1),X=Object(o.a)(Z,2),ee=X[0],te=X[1],ae=d.a.useState(!1),ne=Object(o.a)(ae,2),ie=ne[0],re=ne[1],ce=Object(l.useRef)(null),oe=Object(b.a)(fe,{update:function(e,t){var a=t.data;"error"===a.createTask.status?h.b.error(a.createTask.error):h.b.success("Task created",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),se=Object(o.a)(oe,1)[0],le=Object(l.useCallback)((function(e){var t=e.subscriptionData;ee||te(!0);var a=L.current.task.length,n=t.data.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):[].concat(Object(i.a)(e),[t])}),Object(i.a)(L.current.task));n.sort((function(e,t){return e.id<t.id?-1:1})),function(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++){if(e[a].comment!==t[a].comment)return!1;if(e[a].commentOperator!==t[a].commentOperator)return!1;if(e[a].completed!==t[a].completed)return!1;if(e[a].display_params!==t[a].display_params)return!1;if(e[a].original_params!==t[a].original_params)return!1;if(e[a].status!==t[a].status)return!1;if(e[a].timestamp!==t[a].timestamp)return!1;if(e[a].responses_aggregate.aggregate.count!==t[a].responses_aggregate.aggregate.count)return!1;if(e[a].opsec_pre_blocked!==t[a].opsec_pre_blocked)return!1;if(e[a].opsec_pre_bypassed!==t[a].opsec_pre_bypassed)return!1;if(e[a].opsec_post_blocked!==t[a].opsec_post_blocked)return!1;if(e[a].opsec_post_bypassed!==t[a].opsec_post_bypassed)return!1;if(e[a].tasks.length!==t[a].tasks.length)return!1}return!0}(L.current.task,n)||E({task:n}),n.length>a&&Y(!0),n.length>y&&_(n.length)}),[ee,te,Y,y]);Object(j.a)(Oe,{variables:{callback_id:t.callbackID,fromNow:N,limit:y},onError:function(e){console.error(e)},fetchPolicy:"no-cache",onSubscriptionData:le});var be=Object(l.useCallback)((function(){A&&ce.current&&ce.current.scrollIntoView({behavior:"smooth"})}),[A,ce]);Object(l.useLayoutEffect)((function(){J&&(be(),Y(!1))}),[J,be]);var me=Object(p.a)(ge,{onError:function(e){console.error(e)},onCompleted:function(e){var a=!1;if(0!==e.callback.length){var n=e.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):(a=!0,[].concat(Object(i.a)(e),[t]))}),Object(i.a)(A.task));n.sort((function(e,t){return e.id<t.id?-1:1})),E({task:n}),a?e.task.length<10?re(!0):re(!1):re(!0)}else r(t)},fetchPolicy:"no-cache"}),he=Object(o.a)(me,2),xe=he[0],ye=he[1].loading;Object(l.useEffect)((function(){xe({variables:{callback_id:t.callbackID,offset:A.task.length,fetchLimit:10}}),Y(!0)}),[]);var _e=function(e){var t=e.callback_id,a=e.command,n=e.params,i=e.files,r=e.tasking_location,c=e.original_params,o=e.parameter_group_name;void 0!==z.id?se({variables:{callback_id:t,command:a,params:n,files:i,token_id:z.TokenId,tasking_location:r,original_params:c,parameter_group_name:o}}):se({variables:{callback_id:t,command:a,params:n,files:i,tasking_location:r,original_params:c,parameter_group_name:o}})};return Object(H.jsxs)(s.c,{index:a,value:n,children:[!ie&&Object(H.jsx)(pe.a,{title:"Fetch Older Tasks",children:Object(H.jsx)(x.a,{onClick:function(){xe({variables:{callback_id:t.callbackID,offset:A.task.length,fetchLimit:10}})},variant:"contained",color:"primary",style:{marginLeft:"50%"},children:Object(H.jsx)(je.a,{})})}),!ee&&Object(H.jsx)(ue.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}}),ye&&Object(H.jsx)(ue.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}}),Object(H.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:A.task.map((function(e){return Object(H.jsx)(m.a,{task:e,command_id:null==e.command?0:e.command.id,filterOptions:G},"taskinteractdisplay"+e.id)}))}),Object(H.jsx)("div",{ref:ce}),Object(H.jsx)(de,{onSubmitFilter:function(e){V(e)},onSubmitCommandLine:function(e,a,n,i,r,o){var s=e.split(" ");delete s[0],s=s.join(" ").trim();var l="parsed_cli";if(o.includes("modal")?l="modal_modified":o.includes("browserscript")&&(l="browserscript_modified"),0===a.commandparameters.length)_e({callback_id:t.callbackID,command:a.cmd,params:s,parameter_group_name:"Default"});else{var d=a.commandparameters.find((function(e){return"File"===e.parameter_type&&r.includes(e.parameter_group_name)})),u=!1;if(1===r.length)a.commandparameters.filter((function(e){return e.required&&e.parameter_group_name===r[0]&&!(e.cli_name in n)})).length>0&&(u=!0);else r>1&&!i&&(i=!0);if(d||i||u)return r.length>0?T(Object(c.a)(Object(c.a)({},a),{},{parsedParameters:n,groupName:r[0]})):T(Object(c.a)(Object(c.a)({},a),{},{parsedParameters:n})),void C(!0);delete n._,_e({callback_id:t.callbackID,command:a.cmd,params:JSON.stringify(n),tasking_location:l,original_params:s,parameter_group_name:r[0]})}},changeSelectedToken:function(e){"Default Token"!==e?e.TokenId!==z.TokenId&&W(e):W("Default Token")},filterOptions:G,callback_id:t.callbackID,callback_os:t.os}),w&&Object(H.jsx)(f.a,{fullWidth:!0,maxWidth:"md",open:w,onClose:function(){C(!1)},innerDialog:Object(H.jsx)(O.a,{command:I,callback_id:t.callbackID,payloadtype_id:t.payloadtype_id,operation_id:t.operation_id,onSubmit:function(e,a,n,i){C(!1),_e({callback_id:t.callbackID,command:e,params:a,files:n,tasking_location:"modal",parameter_group_name:i})},onClose:function(){C(!1)}})})]})}}},[[847,1,2]]]);
//# sourceMappingURL=main.026c9797.chunk.js.map