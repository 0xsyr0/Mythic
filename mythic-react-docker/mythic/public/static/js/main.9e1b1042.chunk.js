(this.webpackJsonpmythic=this.webpackJsonpmythic||[]).push([[0],{770:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=770},782:function(e,t,a){"use strict";a.r(t),a.d(t,"mythicVersion",(function(){return qg})),a.d(t,"mythicUIVersion",(function(){return Ng})),a.d(t,"isJWTValid",(function(){return Wg})),a.d(t,"apolloClient",(function(){return Qg})),a.d(t,"restartWebsockets",(function(){return Jg}));var n=a(432),i=a(115),r=a.n(i),c=a(326),o=a(1),s=a.n(o),l=a(37),d=a.n(l),u=a(2),b=a(796),j=a(433),p=a(434),m=a(491),h=a(490),f=a(846),O=a(12),g=a(0),x=Object(O.a)({root:{"& input:valid + fieldset":{borderColor:"grey",borderWidth:1},"& input:invalid + fieldset":{borderColor:"red",borderWidth:2},"& input:valid:focus + fieldset":{borderLeftWidth:6,padding:"4px !important"}}})(f.a),y=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(j.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).onChange=function(t){var a=e.props.name,n=t.target.value,i=!!e.props.validate&&e.props.validate(n);e.props.onChange(a,n,i)},e.checkError=function(){return!!e.props.validate&&e.props.validate(e.props.value)},e.onKeyPress=function(t){"Enter"===t.key?void 0!==e.props.onEnter&&e.props.onEnter():e.onChange(t)},e}return Object(p.a)(a,[{key:"render",value:function(){return Object(g.jsx)("div",{style:{width:this.props.width?this.props.width+"rem":"100%"},children:Object(g.jsx)(x,{fullWidth:!0,placeholder:this.props.placeholder,value:this.props.value,onChange:this.onChange,onKeyPress:this.onKeyPress,label:this.props.name,autoFocus:!!this.props.autoFocus,variant:"outlined",disabled:void 0!==this.props.disabled&&this.props.disabled,required:!!this.props.requiredValue&&this.props.requiredValue,InputLabelProps:this.props.inputLabelProps,multiline:!!this.props.multiline&&this.props.multiline,error:this.checkError(),type:void 0===this.props.type?"text":this.props.type,InputProps:this.props.InputProps,helperText:this.checkError()?this.props.errorText:this.props.helperText,style:{padding:0,marginBottom:this.props.marginBottom?this.props.marginBottom:"10px"}})})}}]),a}(s.a.Component),_=a.p+"static/media/mythic.7189479f.svg",v=a(68),k=a(3),w=a(160),C=Object(w.c)({loggedIn:!1,user:null,access_token:null,refresh_token:null}),S=Object(w.c)(!1),D=function(e){localStorage.setItem("access_token",e.access_token),C(Object(k.a)({loggedIn:!0,access_token:localStorage.getItem("access_token")},C()))},I=function(){console.log("failed refresh"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),C({loggedIn:!1,access_token:null,refresh_token:null,user:null})},T=a(847),$=a(75),P=null,A=function(){return P=Object($.c)(),null},E={success:function(e,t){this.toast(e,"success",t)},warning:function(e,t){this.toast(e,"warning",t)},info:function(e,t){this.toast(e,"info",t)},error:function(e,t){this.toast(e,"error",t)},dismiss:function(){P.closeSnackbar()},toast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",a=arguments.length>2?arguments[2]:void 0;P.enqueueSnackbar(e,Object(k.a)({variant:t},a))}};function L(e){var t=Object(T.a)(C),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),l=Object(u.a)(c,2),d=l[0],j=l[1];Object(o.useEffect)((function(){Wg()||(console.log("calling FailedRefresh on the login page to remove old data"),I())}),[]);var p=function(e){if(e.preventDefault(),""!==i&&""!==d){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:d})};fetch("/auth",t).then((function(e){e.json().then((function(e){console.log(e),"access_token"in e?(!function(e){localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),localStorage.setItem("user",JSON.stringify(e.user)),C(Object(k.a)({loggedIn:!0},e))}(e),Jg()):(E.warning("Invalid Username or Password"),console.log("Error",e))})).catch((function(e){E.warning("Error getting JSON from server"),console.log("Error trying to get json response",e.toString())}))})).catch((function(e){E.warning("Error talking to server"),console.log("There was an error!",e.toString())}))}else E.warning("Username and Password required")};return Object(g.jsx)("div",{style:{justifyContent:"center",display:"flex"},children:t.loggedIn?Object(g.jsx)(v.a,{to:function(){var t=e.location.state;return t&&t.from?t.from.pathname:"/new/"}()}):Object(g.jsxs)("div",{children:[Object(g.jsx)("img",{src:_,height:"400px",alt:"Mythic logo"}),Object(g.jsxs)("form",{onSubmit:p,children:[Object(g.jsx)(y,{name:"username",value:i,onChange:function(e,t,a){r(t)},width:30}),Object(g.jsx)(y,{name:"password",type:"password",value:d,onChange:function(e,t,a){j(t)},width:30}),Object(g.jsx)(b.a,{type:"submit",color:"primary",onClick:p,variant:"contained",style:{marginRight:"10px"},children:"Login"})]})]})})}var F=a(5),q=a(6),N=a(856),R=a(858),B=a(849),z=a(855),W=a(857),M=a(848),H=a(221),U=a(859),V=a(895),G=a(496),K=a(499),Q=a(99),J=a(193),Y=a.n(J),Z=a(192),X=a.n(Z),ee=a(44),te=a.n(ee),ae=a(89),ne=a.n(ae);function ie(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{size:"small",onClick:function(){e.onDeleteAPIToken(e.id)},startIcon:Object(g.jsx)(te.a,{}),color:"secondary",variant:"contained",children:"Delete"})}),Object(g.jsx)(B.a,{children:e.token_value})]},"apitokenRow"+e.id)}var re=a(853),ce=a(851),oe=a(852),se=a(850);function le(e){var t=s.a.useState(e.username?e.username:""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),j=Object(u.a)(d,2),p=j[0],m=j[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:e.title}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(oe.a,{children:"Use this dialog to update some information about an operator."}),Object(g.jsx)(y,{autoFocus:!0,placeholder:e.username,value:n,onChange:function(e,t,a){i(t)},margin:"dense",id:"username",name:"username"}),Object(g.jsx)(y,{margin:"dense",id:"passwordOld",onChange:function(e,t,a){l(t)},name:"old password",type:"password"}),Object(g.jsx)(y,{margin:"dense",id:"passwordNew",onChange:function(e,t,a){m(t)},name:"new password",type:"password"})]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.handleClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){e.onAccept(e.id,n,o,p)},variant:"contained",color:"primary",children:"Update"})]})]})}function de(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Delete Operator"}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(oe.a,{children:"This deletes an operator and prevents them from permanently logging in again. If you want a temporary solution, disable the operator instead."}),Object(g.jsxs)(oe.a,{children:['Are you sure you want to delete operator "',e.username,'"?']})]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){e.onAccept(e.id)},variant:"contained",color:"secondary",children:"Delete"})]})]})}var ue=a(854);function be(e){var t=s.a.useRef(null);return s.a.useEffect((function(){if(e.open){var a=t.current;null!==a&&a.focus()}}),[e.open]),Object(g.jsx)(ue.a,{open:e.open,onClose:e.onClose,scroll:"paper",maxWidth:e.maxWidth,fullWidth:e.fullWidth,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:e.innerDialog})}function je(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=function(){e.onSubmit(n),e.onClose()};return Object(o.useEffect)((function(){i(e.value)}),[e.value]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{autoFocus:!0,onEnter:r,onChange:function(e,t,a){i(t)},value:n})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:r,variant:"contained",color:"secondary",children:"Submit"})]})]})}function pe(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState("dictionary"),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1];return Object(o.useEffect)((function(){var t=[];try{var a;if((a=e.value.constructor===Object?e.value:JSON.parse(e.value)).constructor===Object)for(var n in a)a[n].constructor===Object||Array.isArray(a[n])?t.push({name:n,value:JSON.stringify(a[n],null,2)}):t.push({name:n,value:a[n]}),h([e.leftColumn,e.rightColumn]);else d("array"),a.length>0?(h(Object.keys(a[0])),t=a):h([])}catch(r){console.log(r)}i(t)}),[e.value,e.leftColumn,e.rightColumn]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(H.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsx)(M.a,{children:m.map((function(e,t){return Object(g.jsx)(B.a,{children:e},"header"+t)}))})}),Object(g.jsx)(R.a,{children:"dictionary"===l?n.map((function(e,t){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:e.name}),Object(g.jsx)(B.a,{style:{wordBreak:"break-all",whiteSpace:"pre-wrap"},children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)})):n.map((function(e,t){return Object(g.jsx)(M.a,{hover:!0,children:Object.keys(e).map((function(a){return Object(g.jsx)(B.a,{children:e[a]},"row"+t+"cell"+a)}))},"row"+t)}))})]})})})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function me(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(o.useEffect)((function(){var t=e.keys.reduce((function(t,a){return void 0!==e.value[a]&&null!==e.value[a]&&""!==e.value[a]?[].concat(Object(F.a)(t),[{name:a,value:e.value[a]}]):Object(F.a)(t)}),[]);i(t)}),[e.value,e.keys]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(H.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.leftColumn}),Object(g.jsx)(B.a,{children:e.rightColumn})]})}),Object(g.jsx)(R.a,{children:n.map((function(e,t){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.name}),Object(g.jsx)(B.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function he(e,t){try{if(null===e)return"N/A";var a=new Date(e);return t?e+" UTC":a.toDateString()+" "+a.toTimeString().substring(0,8)}catch(n){console.log("warning","Failed to get local time converted: "+n.toString())}}function fe(e){var t=new Date,a=t.getTime()+6e4*t.getTimezoneOffset(),n=Math.abs(a-new Date(e).getTime()),i=Math.trunc(n/1e3%60),r=Math.trunc(n/6e4%60),c=Math.trunc(n/36e5%24),o=Math.trunc(n/864e5%365),s="";return 0!==o&&(s+=o+"d"),0!==c&&(s+=c+"h"),0!==r&&(s+=r+"m"),s+=i+"s"}function Oe(e,t){var a=Object(o.useRef)();Object(o.useEffect)((function(){a.current=e})),Object(o.useEffect)((function(){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}),[t])}function ge(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(T.a)(C);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(M.a,{children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){h(!0)},startIcon:Object(g.jsx)(te.a,{}),color:"secondary",variant:"contained",children:"Delete"}),Object(g.jsx)(be,{open:m,onClose:function(){h(!1)},innerDialog:Object(g.jsx)(de,Object(k.a)({onClose:function(){h(!1)},onAccept:function(t){e.onDeleteOperator(t),h(!1)}},e))})]}),Object(g.jsx)(B.a,{children:e.username}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Update"}),Object(g.jsx)(be,{open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(le,Object(k.a)({onAccept:function(t,a,n,i){a!==e.username&&e.onUsernameChanged(t,a),i.length>0&&e.onPasswordChanged({user_id:t,old_password:n,new_password:i}),d(!1)},handleClose:function(){d(!1)},title:"Update Operator"},e))})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:e.view_utc_time,onChange:function(t){var a=e.id;e.onViewUTCChanged(a,!e[t.target.name])},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"view_utc_time"})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:e.active,onChange:function(t){var a=e.id;e.onActiveChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"active"})}),Object(g.jsx)(B.a,{children:he(e.last_login,f.user.view_utc_time)}),Object(g.jsx)(B.a,{children:he(e.creation_time,f.user.view_utc_time)}),Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:e.admin,onChange:function(t){var a=e.id;e.onAdminChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"admin"})}),Object(g.jsx)(B.a,{children:e.id===f.user.id&&Object(g.jsx)(K.a,{"aria-label":"expand row",size:"small",onClick:function(){return i(!n)},children:n?Object(g.jsx)(X.a,{className:"mythicElement"}):Object(g.jsx)(Y.a,{className:"mythicElement"})})})]},e.id),Object(g.jsx)(M.a,{children:e.id===f.user.id&&Object(g.jsx)(B.a,{style:{paddingBottom:0,paddingTop:0},colSpan:9,children:Object(g.jsx)(G.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(g.jsxs)(V.a,{margin:1,children:[Object(g.jsx)(Q.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"API Tokens"}),Object(g.jsx)(b.a,{size:"small",onClick:e.onCreateAPIToken,style:{float:"right"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"New"}),Object(g.jsxs)(N.a,{size:"small","aria-label":"tokens",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"10rem"},children:"Delete"}),Object(g.jsx)(B.a,{children:"Token"})]})}),Object(g.jsx)(R.a,{children:e.apitokens.map((function(t){return Object(o.createElement)(ie,Object(k.a)(Object(k.a)({},t),{},{key:"token"+t.id,onDeleteAPIToken:e.onDeleteAPIToken}))}))})]})]})})})})]})}var xe=a(63);function ye(e){var t=Object(xe.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Settings"})}),Object(g.jsxs)(z.a,{component:H.a,className:"mythicElement",children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{float:"right"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"New Operator"}),Object(g.jsx)(be,{open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(le,Object(k.a)({title:"New Operator",onAccept:function(t,a,n,i){n!==i?E.error("Passwords don't match"):0===i.length?E.error("Password must not be empty"):0===a.length?E.error("Username must not be empty"):(e.onNewOperator(a,i),r(!1))},handleClose:function(){r(!1)}},e))}),Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"9rem"},children:"Delete Account"}),Object(g.jsx)(B.a,{children:"Username"}),Object(g.jsx)(B.a,{style:{width:"6rem"},children:"Modify"}),Object(g.jsx)(B.a,{style:{width:"10rem"},children:"UTC Timestamps"}),Object(g.jsx)(B.a,{style:{width:"9rem"},children:"Account Active"}),Object(g.jsx)(B.a,{children:"Last Login"}),Object(g.jsx)(B.a,{children:"Account Creation Date"}),Object(g.jsx)(B.a,{style:{width:"9rem"},children:"Admin Status"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"More..."})]})}),Object(g.jsx)(R.a,{children:e.operators.map((function(t){return Object(g.jsx)(ge,Object(k.a)({onViewUTCChanged:e.onViewUTCChanged,onAdminChanged:e.onAdminChanged,onActiveChanged:e.onActiveChanged,onDeleteOperator:e.onDeleteOperator,onUsernameChanged:e.onUsernameChanged,onPasswordChanged:e.onPasswordChanged,onDeleteAPIToken:e.onDeleteAPIToken,onCreateAPIToken:e.onCreateAPIToken},t),"operator"+t.id)}))})]})]})]})}var _e,ve,ke,we,Ce,Se,De,Ie,Te,$e,Pe=a(176),Ae=a(860),Ee=a(903),Le=Object(Pe.a)(_e||(_e=Object(q.a)(["\nquery GetOperators {\n  operator(where: {deleted: {_eq: false}}, order_by: {username: asc}) {\n    active\n    admin\n    creation_time\n    deleted\n    id\n    last_login\n    username\n    view_utc_time\n    apitokens {\n      token_value\n      token_type\n      active\n      id\n    }\n  }\n}\n"]))),Fe=Object(Pe.a)(ve||(ve=Object(q.a)(["\nmutation SettingsUpdateOperatorViewUTCTime($id: Int!, $view_utc_time: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {view_utc_time: $view_utc_time}) {\n    id\n    view_utc_time\n  }\n}\n"]))),qe=Object(Pe.a)(ke||(ke=Object(q.a)(["\nmutation SettingsUpdateOperatorAdminMutation($id: Int!, $admin: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {admin: $admin}) {\n      id\n      admin\n  }\n}\n"]))),Ne=Object(Pe.a)(we||(we=Object(q.a)(["\nmutation SettingsUpdateOperatorActiveMutation($id: Int!, $active: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {active: $active}) {\n      id\n      active\n  }\n}\n"]))),Re=Object(Pe.a)(Ce||(Ce=Object(q.a)(["\nmutation SettingsDeleteOperatorMutation($id: Int!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {deleted: true}) {\n      id\n      deleted\n  }\n}\n"]))),Be=Object(Pe.a)(Se||(Se=Object(q.a)(["\nmutation SettingsUsernameOperatorMutation($id: Int!, $username: String!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {username: $username}) {\n      id\n      username\n  }\n}\n"]))),ze=Object(Pe.a)(De||(De=Object(q.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    active\n    creation_time\n    deleted\n    error\n    id\n    last_login\n    status\n    username\n    view_utc_time\n  }\n}\n"]))),We=Object(Pe.a)(Ie||(Ie=Object(q.a)(["\nmutation operatorsUpdatePasswordMutation($user_id: Int!, $new_password: String!, $old_password: String){\n  updatePassword(user_id: $user_id, new_password: $new_password, old_password: $old_password){\n    status\n    error\n  }\n}\n"]))),Me=Object(Pe.a)(Te||(Te=Object(q.a)(['\nmutation createAPITokenMutation{\n  createAPIToken(token_type: "User"){\n    id\n    token_value\n    status\n    error\n    operator_id\n  }\n}\n']))),He=Object(Pe.a)($e||($e=Object(q.a)(["\nmutation deleteAPIToken($id: Int!){\n  delete_apitokens_by_pk(id: $id){\n    id\n    operator_id\n  }\n}\n"])));function Ue(e){var t=Object(T.a)(C),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1];Object(Ae.a)(Le,{fetchPolicy:"no-cache",onCompleted:function(e){r(e.operator)}});var c=Object(Ee.a)(Fe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var a=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(k.a)(Object(k.a)({},t),{},{view_utc_time:e.update_operator_by_pk.view_utc_time}):Object(k.a)({},t)}));if(e.update_operator_by_pk.id===t.user.id){var n=C();n.user.view_utc_time=e.update_operator_by_pk.view_utc_time,C(n)}r(a),E.success("Successfully updated")}else E.warning("Cannot update another user's data without Admin permissions")},onError:function(e){console.log(e),E.error("Unable to update operator timestamps without Admin permissions")}}),o=Object(u.a)(c,1)[0],l=Object(Ee.a)(Re,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.filter((function(t){return t.id!==e.update_operator_by_pk.id}));r(t),E.success("Successfully updated")}else E.warning("Cannot update another user's data without Admin permissions")},onError:function(){E.warning("Unable to delete operator without Admin permissions")}}),d=Object(u.a)(l,1)[0],b=Object(Ee.a)(qe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(k.a)(Object(k.a)({},t),{},{admin:e.update_operator_by_pk.admin}):Object(k.a)({},t)}));r(t),E.success("Successfully updated")}else E.warning("Cannot update another user's data without Admin permissions")},onError:function(){E.warning("Unable to update operator admin status without Admin permissions")}}),j=Object(u.a)(b,1)[0],p=Object(Ee.a)(Ne,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(k.a)(Object(k.a)({},t),{},{active:e.update_operator_by_pk.active}):Object(k.a)({},t)}));r(t),E.success("Successfully updated")}else E.warning("Cannot update another user's data without Admin permissions")},onError:function(){E.warning("Unable to update operator active status without Admin permissions")}}),m=Object(u.a)(p,1)[0],h=Object(Ee.a)(Me,{onCompleted:function(e){if("success"===e.createAPIToken.status){E.success("Successfully created new API Token");var t=i.map((function(t){return t.id===e.createAPIToken.operator_id?Object(k.a)(Object(k.a)({},t),{},{apitokens:[].concat(Object(F.a)(t.apitokens),[Object(k.a)({},e.createAPIToken)])}):Object(k.a)({},t)}));r(t)}else E.error(e.createAPIToken.error)},onError:function(e){console.log(e)}}),f=Object(u.a)(h,1)[0],O=Object(Ee.a)(He,{onCompleted:function(e){var t=i.map((function(t){return t.id===e.delete_apitokens_by_pk.operator_id?Object(k.a)(Object(k.a)({},t),{},{apitokens:t.apitokens.filter((function(t){return t.id!==e.delete_apitokens_by_pk.id}))}):Object(k.a)({},t)}));r(t)},onError:function(e){}}),x=Object(u.a)(O,1)[0],y=Object(Ee.a)(ze,{onCompleted:function(e){if("success"===e.createOperator.status){var t=e.createOperator;r([].concat(Object(F.a)(i),[t]))}else E.error(e.createOperator.error)},onError:function(e){E.warning("Unable to create new operator"),console.log(e)}}),_=Object(u.a)(y,1)[0],v=Object(Ee.a)(Be,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(k.a)(Object(k.a)({},t),{},{username:e.update_operator_by_pk.username}):Object(k.a)({},t)}));r(t),E.success("Successfully updated")}else E.warning("Cannot update another user's data without Admin permissions")},onError:function(){E.warning("Unable to update operator's username without Admin permissions")}}),w=Object(u.a)(v,1)[0],S=Object(Ee.a)(We,{onCompleted:function(e){"success"===e.updatePassword.status?E.success("Successfully updated password"):E.warning(e.updatePassword.error)},onError:function(){E.warning("Unable to update operator's password without Admin permissions")}}),D=Object(u.a)(S,1)[0];return Object(g.jsx)("div",{style:{height:"calc(94vh)",marginTop:"10px",marginRight:"5px"},children:Object(g.jsx)(ye,{onViewUTCChanged:function(e,t){o({variables:{id:e,view_utc_time:t}})},onAdminChanged:function(e,t){j({variables:{id:e,admin:t}})},onActiveChanged:function(e,t){m({variables:{id:e,active:t}})},onNewOperator:function(e,t){_({variables:{username:e,password:t}})},onDeleteOperator:function(e){d({variables:{id:e}})},onUsernameChanged:function(e,t){w({variables:{id:e,username:t}})},onPasswordChanged:function(e){var t=e.user_id,a=e.old_password,n=e.new_password;D({variables:{user_id:t,new_password:n,old_password:a}})},onCreateAPIToken:function(){f({variables:{}})},onDeleteAPIToken:function(e){x({variables:{id:e}})},operators:i})})}var Ve,Ge=a(795),Ke=a(864),Qe=a(865),Je=a(866),Ye=a(863),Ze=a(862),Xe=Object(Pe.a)(Ve||(Ve=Object(q.a)(["\nquery GetPayloadDetails($payload_name: String!) {\n  payloadtype(where: {ptype: {_eq: $payload_name}}) {\n    buildparameters (where: {deleted: {_eq: false} } ){\n      description\n      name\n      id\n      parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function et(e){var t=Object(o.useState)([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(Xe,{variables:{payload_name:e.payload_name},onCompleted:function(e){console.log(e),i(e.payloadtype[0].buildparameters)}}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ze.a,{}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(oe.a,{children:"These are the build parameters associated with this payload"}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.description}),Object(g.jsxs)(B.a,{children:["Scripting/Building Name:",Object(g.jsx)("br",{}),e.name,Object(g.jsx)("br",{}),"Parameter Type:",Object(g.jsx)("br",{}),e.parameter_type,Object(g.jsx)("br",{}),"Default Parameter:",Object(g.jsx)("br",{}),e.parameter,Object(g.jsx)("br",{}),"Required value?",Object(g.jsx)("br",{}),e.required?"Yes":"No",Object(g.jsx)("br",{}),"Verifier Regex:",Object(g.jsx)("br",{}),e.verifier_regex,Object(g.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.handleClose,color:"primary",children:"Close"})})]})}var tt=Object(Ge.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),at=Object(O.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Ye.a);function nt(e){var t=tt(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(""),m=Object(u.a)(p,2),h=m[0],f=m[1],O=new Date,x=(O.getTime()+6e4*O.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(o.useEffect)((function(){if(e.wrap_these_payload_types.length>0){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));r(t.join(", "))}else r("");f(e.supported_os.split(",").join(", "))}),[e.wrap_these_payload_types,e.supported_os]),Object(g.jsxs)(Ke.a,{className:t.root,elevation:5,children:[Object(g.jsx)(at,{overlap:"circle",classes:{badge:t[x]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(g.jsx)(Qe.a,{className:t.media,component:"img",style:{width:"125px",height:"125",padding:"10px",objectFit:"unset"},src:"/static/"+e.ptype+".svg"})}),Object(g.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(g.jsx)(Q.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.ptype}),Object(g.jsxs)(Je.a,{style:{textAlign:"left"},children:[Object(g.jsxs)(Q.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Author:"})," ",e.author]}),Object(g.jsxs)(Q.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Supported Operating Systems:"})," ",h]}),0===e.wrap_these_payload_types.length?null:Object(g.jsxs)(Q.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Wrapped Payload Types:"})," ",i]}),Object(g.jsx)(Q.a,{variant:"body2",component:"p",children:e.note})]})]}),Object(g.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(g.jsx)(b.a,{size:"small",variant:"contained",color:"primary",href:e.wrapper?"/docs/wrappers/"+e.ptype:"/docs/agents/"+e.ptype,target:"_blank",children:"Docs"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){j(!0)},color:"primary",variant:"contained",children:"Building Info"}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:d,onClose:function(){j(!1)},innerDialog:Object(g.jsx)(et,Object(k.a)(Object(k.a)({},e),{},{payload_name:e.ptype}))})]})]})}var it,rt,ct=a(904),ot=Object(Pe.a)(it||(it=Object(q.a)(["\n subscription getPayloadTypesSubscription {\n  payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n    author\n    container_running\n    id\n    last_heartbeat\n    note\n    ptype\n    supported_os\n    wrapper\n    translationcontainer {\n        id\n        name\n        last_heartbeat\n        container_running\n    }\n    wrap_these_payload_types {\n        id\n        wrapped {\n          ptype\n        }\n    }\n  }\n}\n "])));function st(e){var t=Object(xe.a)(),a=Object(ct.a)(ot).data,n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1];return Object(o.useEffect)((function(){c(void 0!==a?a.payloadtype:[])}),[a]),Object(g.jsxs)("div",{style:{flexDirection:"column",alignItems:"stretch"},children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payload Types"})}),r.map((function(e){return Object(g.jsx)(nt,Object(k.a)({},e),"payloadtype"+e.id)}))]})}var lt=Object(Pe.a)(rt||(rt=Object(q.a)(["\nquery GetPC2Details($payload_name: String!) {\n  c2profile(where: {name: {_eq: $payload_name}}) {\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      name\n      parameter_type\n      id\n      randomize\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function dt(e){var t=Object(o.useState)([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(lt,{variables:{payload_name:e.payload_name},onCompleted:function(e){i(e.c2profile[0].c2profileparameters)}}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ze.a,{}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(oe.a,{children:"These are the build parameters associated with this payload"}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.description}),Object(g.jsxs)(B.a,{children:["Scripting/Building Name:",Object(g.jsx)("br",{}),e.name,Object(g.jsx)("br",{}),"Parameter Type:",Object(g.jsx)("br",{}),e.parameter_type,Object(g.jsx)("br",{}),"Default Parameter:",Object(g.jsx)("br",{}),e.default_value,Object(g.jsx)("br",{}),"Required value?",Object(g.jsx)("br",{}),e.required?"Yes":"No",Object(g.jsx)("br",{}),"Verifier Regex:",Object(g.jsx)("br",{}),e.verifier_regex,Object(g.jsx)("br",{}),"Randomize value?: ",Object(g.jsx)("br",{}),e.randomize?"Yes":"No",Object(g.jsx)("br",{}),"Random Format String: ",Object(g.jsx)("br",{}),e.format_string,Object(g.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var ut,bt=a(143),jt=a.n(bt),pt=a(872),mt=a(162),ht=a.n(mt),ft=a(794),Ot=a(494),gt=a(801),xt=a(870),yt=a(791),_t=Object(Pe.a)(ut||(ut=Object(q.a)(["\nquery getProfileOutput($id: Int!) {\n  getProfileOutput(id: $id) {\n    status\n    error\n    output\n  }\n}\n"])));function vt(e){var t=Object(Ae.a)(_t,{variables:{id:e.profile_id},onCompleted:function(e){},fetchPolicy:"network-only"}),a=t.loading,n=t.error,i=t.data;return a?Object(g.jsx)(Ze.a,{}):n?(console.error(n),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(oe.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(g.jsx)(y,{multiline:!0,onChange:function(){},value:i.getProfileOutput.output})]}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var kt,wt=a(121),Ct=a.n(wt),St=(a(298),a(226),a(299),Object(Pe.a)(kt||(kt=Object(q.a)(["\nquery getProfileConfigOutput($id: Int!, $filename: String!) {\n  downloadContainerFile(id: $id, filename: $filename) {\n    status\n    error\n    filename\n    data\n  }\n}\n"]))));function Dt(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(St,{variables:{id:e.profile_id,filename:"config.json"},onCompleted:function(e){"error"===e.downloadContainerFile.status?i("Errored trying to read file from container\n"+e.downloadContainerFile.error):(console.log(e),i(atob(e.downloadContainerFile.data)))},fetchPolicy:"network-only"}),c=r.loading,l=r.error;if(c)return Object(g.jsx)(Ze.a,{});if(l)return console.error(l),Object(g.jsx)("div",{children:"Error!"});return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Configuration"]}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(Ct.a,{mode:"json",theme:"monokai",onChange:function(e,t){i(e)},fontSize:14,showGutter:!0,highlightActiveLine:!0,value:n,focus:!0,width:"100%",setOptions:{showLineNumbers:!0,tabSize:4}})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:function(){e.onConfigSubmit(btoa(n)),e.onClose()},color:"secondary",children:"Submit"})]})]})}function It(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(oe.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(g.jsx)(y,{multiline:!0,value:e.output,onChange:function(){}})]}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Tt=a(439),$t=a.n(Tt),Pt=a(20),At=a(871),Et=a(786),Lt=a(805),Ft=a(867),qt=a(784),Nt=a(161),Rt=a.n(Nt),Bt=a(84),zt=a(894),Wt=a(284),Mt=a(789);function Ht(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,r=e.required,c=e.verifier_regex,l=e.id,d=e.description,j=e.value,p=(e.returnAllDictValues,s.a.useState("")),m=Object(u.a)(p,2),h=m[0],f=m[1],O=Object(xe.a)(),x=s.a.useState([]),_=Object(u.a)(x,2),v=_[0],w=_[1],C=s.a.useState([]),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useState([]),$=Object(u.a)(T,2),P=$[0],A=$[1],E=s.a.useState(""),L=Object(u.a)(E,2),q=L[0],N=L[1],R=s.a.useState([]),z=Object(u.a)(R,2),W=z[0],H=z[1],V=s.a.useState(new Date),G=Object(u.a)(V,2),J=G[0],Y=G[1],Z=function(e){var a=e.reduce((function(e,t){return""!==t.value?[].concat(Object(F.a)(e),[{custom:"*"===t.name,key:t.key,name:t.name,value:t.value}]):Object(F.a)(e)}),[]);t(i,a,!1)};Object(o.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");f(e[0]),H(e)}""!==j&&void 0!==j&&(f(j),t(i,j,""))}else if("Date"===a){if(""!==n){var r=new Date;r.setDate(r.getDate()+parseInt(n)),ie(r),f(-1)}""!==j&&void 0!==j&&j.includes("-")&&(console.log("passed date value: ",j),Y(new Date(j)),f(-1),t(i,new Date(j).toISOString().slice(0,10),""))}else if("Dictionary"===a)if(""!==j&&void 0!==j&&"object"===typeof j){console.log("passed dictionaryvalue",j);var c=j.reduce((function(e,t){return t.default_show?[].concat(Object(F.a)(e),[Object(k.a)({},t)]):Object(F.a)(e)}),[]);Z(c),w(c),I(j);var o=j.reduce((function(e,t){var a=c.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(F.a)(e),[Object(k.a)({},t)]):Object(F.a)(e)}),[]);A(o),o.length>0&&N(o[0])}else{var s=JSON.parse(n);I(s);var l=s.reduce((function(e,t){return t.default_show?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(F.a)(e)}),[]);Z(l),w(l);var d=s.reduce((function(e,t){var a=l.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(F.a)(e)}),[]);A(d),d.length>0&&N(d[0])}else"Boolean"===a?(f(void 0===n||"true"===n.toLowerCase()),""!==j&&void 0!==j&&(console.log(j,!0),f(j))):(void 0!==n&&f(n),""!==j&&void 0!==j&&(f(j),t(i,j,"")))}),[n,a,i]);var X=function(e){f(e.target.value),t(i,e.target.value,!1)},ee=function(e,a,n){f(a),t(e,a,n)},ae=function(e){return(r&&""!==c||""!==c&&""!==e)&&!RegExp(c).test(e)},ne=function(){var e=Object(k.a)({},q);"*"===e.name&&(e.key="",e.value="");var t=[].concat(Object(F.a)(v),[Object(k.a)(Object(k.a)({},e),{},{default_show:!0})]);w(t);var a=P.reduce((function(a,n){var i=t.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return e.name===n.name&&(i+=1),-1===n.max||n.max>i?[].concat(Object(F.a)(a),[Object(k.a)({},n)]):Object(F.a)(a)}),[]);Z(t),A(a),a.length>0&&N(a[0])},ie=function(e){Y(e),t(i,e.toISOString().slice(0,10),"")},re=function(e){var a=!h;f(a),t(i,a,!1)},ce=s.a.useState(null),oe=Object(u.a)(ce,2),se=oe[0],le=oe[1],de=Boolean(se),ue=function(){le(null)};return Object(g.jsxs)(M.a,{children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(Q.a,{"aria-haspopup":"true",onMouseEnter:function(e){le(e.currentTarget)},onMouseLeave:ue,"aria-owns":de?"taskparam"+l+"popover":void 0,children:d}),Object(g.jsx)(Mt.a,{id:"taskparam"+l+"popover",open:de,anchorEl:se,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:ue,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===O.palette.type?O.palette.primary.dark:O.palette.primary.light,color:"white"},variant:"outlined"},children:Object(g.jsx)(Q.a,{children:i.length>0?i:"No Description"})})]}),Object(g.jsx)(B.a,{children:function(){switch(a){case"Date":return Object(g.jsx)(Bt.a,{utils:Wt.a,children:Object(g.jsx)(Ft.a,{container:!0,justify:"flex-start",children:Object(g.jsx)(zt.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:J,onChange:ie,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:h,onChange:X,children:W.map((function(e,t){return Object(g.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(g.jsxs)(s.a.Fragment,{children:[v.map((function(e,t){return Object(g.jsxs)("div",{children:[Object(g.jsxs)(K.a,{onClick:function(e){!function(e){var t=v[e],a=v.filter((function(t,a){return e!==a}));w(a);var n=D.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(F.a)(e),[Object(k.a)({},n)]):Object(F.a)(e)}),[]);Z(a),A(n),n.length>0&&N(n[0])}(t)},children:[Object(g.jsx)(te.a,{style:{color:O.palette.error.main}})," "]}),"*"===e.name?Object(g.jsx)(qt.a,{style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=v.map((function(a,n){return n===t?Object(k.a)(Object(k.a)({},a),{},{key:e.target.value}):Object(k.a)({},a)}));Z(a),w(a)}(e,t)}}):Object(g.jsx)(qt.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"key"}),value:e.key}),Object(g.jsx)(qt.a,{style:{width:"75%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=v.map((function(a,n){return n===t?Object(k.a)(Object(k.a)({},a),{},{value:e.target.value}):Object(k.a)({},a)}));Z(a),w(a)}(e,t)}})]},"dictval"+t)})),P.length>0?Object(g.jsxs)("div",{children:[Object(g.jsxs)(K.a,{onClick:ne,children:[" ",Object(g.jsx)(Rt.a,{style:{color:O.palette.success.main}})," "]}),Object(g.jsx)(Lt.a,{size:"small",value:q,onChange:function(e){return N(e.target.value)},children:P.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+t)}))})]}):null]});case"String":return Object(g.jsx)(y,{required:r,value:h,multiline:!0,onChange:ee,display:"inline-block",name:i,validate:ae,errorText:"Must match: "+c});case"Boolean":return Object(g.jsx)(U.a,{checked:h,onChange:re,inputProps:{"aria-label":"primary checkbox"}});default:return null}}()})]},"buildparam"+l)}function Ut(e){var t=function(t,a,n){e.onChange(e.name,t,a,n)};return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"auto"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"20%"},children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:e.c2profileparameters.map((function(a){return Object(g.jsx)(Ht,Object(k.a)({returnAllDictValues:e.returnAllDictValues,onChange:t},a),"c2paramtablerow"+a.id)}))})]})})}var Vt,Gt,Kt,Qt,Jt=a(787),Yt=a(264),Zt=Object(Pe.a)(Vt||(Vt=Object(q.a)(["\nquery getProfileParameters($id: Int!, $operation_id: Int!) {\n  c2profile_by_pk(id: $id) {\n    c2profileparameters(where: {deleted: {_eq: false}}, order_by: {name: asc}){\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n      instance_name\n    }\n  }\n}\n"]))),Xt=Object(Pe.a)(Gt||(Gt=Object(q.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    id\n    value\n  }\n}\n"]))),ea=Object(Pe.a)(Kt||(Kt=Object(q.a)(["\nmutation deleteSavedInstance($name: String!, $operation_id: Int!){\n  delete_c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}){\n    affected_rows\n  }\n}\n"]))),ta=Object(Pe.a)(Qt||(Qt=Object(q.a)(["\nmutation createNewC2Instance($instance_name: String!, $c2_instance: String!, $c2profile_id: Int!){\n  create_c2_instance(c2_instance: $c2_instance, instance_name: $instance_name, c2profile_id: $c2profile_id){\n    status\n    error\n  }\n}\n"])));function aa(e){var t=Object(xe.a)(),a=Object(T.a)(C),n=Object(o.useState)(""),i=Object(u.a)(n,2),r=i[0],c=i[1],l=Object(o.useState)(""),d=Object(u.a)(l,2),j=d[0],p=d[1],m=Object(o.useState)([]),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(o.useState)([]),_=Object(u.a)(x,2),v=_[0],w=_[1],S=Object(o.useState)([]),D=Object(u.a)(S,2),I=D[0],$=D[1],P=Object(Ae.a)(Zt,{variables:{id:e.id,operation_id:a.user.current_operation_id},onCompleted:function(e){var t=e.c2profile_by_pk.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Yt(e.format_string).gen();return Object(k.a)(Object(k.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(k.a)(Object(k.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return t.default_show?[].concat(Object(F.a)(e),[{value:t.default_value,key:"*"===t.name?"":t.name,name:t.name,custom:"*"===t.name}]):Object(F.a)(e)}),[]);return Object(k.a)(Object(k.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return n.setDate(n.getDate()+parseInt(e.default_value)),Object(k.a)(Object(k.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(k.a)(Object(k.a)({},e),{},{value:e.default_value})}return Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value})}));t.sort((function(e,t){return-t.description.localeCompare(e.description)})),w(Object(F.a)(t)),$(Object(F.a)(t)),O(e.c2profile_by_pk.c2profileparametersinstances)},onError:function(e){},fetchPolicy:"network-only"}).loading,A=Object(At.a)(Xt,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(k.a)(Object(k.a)({},e),e.c2profileparameter);return"Dictionary"!==t.parameter_type&&"Array"!==t.parameter_type||(t.value=JSON.parse(t.value)),t}));t.sort((function(e,t){return e.name<t.name?-1:1})),$(t)},onError:function(e){E.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),L=Object(u.a)(A,1)[0],q=Object(Ee.a)(ea,{onCompleted:function(e){p(""),c(""),$(Object(F.a)(v));var t=f.filter((function(e){return e.instance_name!==j}));O(t),E.success("Sucessfully deleted instance")},onError:function(e){E.error("Failed to delete instance: "+e)}}),N=Object(u.a)(q,1)[0],R=Object(Ee.a)(ta,{onCompleted:function(t){"success"===t.create_c2_instance.status?E.success("Successfully created instance"):E.error("Failed to create instance: "+t.create_c2_instance.error),e.onClose()},onError:function(e){E.error("Failed to create instance: "+e)}}),B=Object(u.a)(R,1)[0];if(P)return Object(g.jsx)(Ze.a,{});return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:["Save an Instance of ",e.name,"'s Parameters"]}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(Q.a,{style:{paddingBottom:"10px"},children:"Saving an instance of the parameters allows you to select them from a dropdown when creating agents later, saving time and typos."}),f.length>0?Object(g.jsxs)(Ft.a,{container:!0,spacing:2,style:{paddingTop:"10px"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsxs)(Et.a,{style:{width:"100%"},children:[Object(g.jsx)(Jt.a,{children:"Select an Existing Instance"}),Object(g.jsxs)(Lt.a,{style:{width:"100%",marginBottom:"10px"},value:j,label:"Select an Existing Instance",onChange:function(e){p(e.target.value),c(e.target.value),""===e.target.value?$(Object(F.a)(v)):($([]),L({variables:{name:e.target.value,operation_id:a.user.current_operation_id}}))},children:[Object(g.jsx)(xt.a,{value:"",children:"New Instance"}),f.map((function(e,t){return Object(g.jsx)(xt.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]})}),Object(g.jsx)(Ft.a,{item:!0,xs:6,children:j.length>0?Object(g.jsx)(b.a,{style:{backgroundColor:t.palette.error.main,color:"white"},variant:"contained",onClick:function(){$([]),N({variables:{name:j,operation_id:a.user.current_operation_id}})},children:" Delete Instance"}):null})]}):null,Object(g.jsx)(y,{name:"Instance Name",onChange:function(e,t,a){c(t)},value:r,style:{paddingTop:"10px"}}),Object(g.jsx)(Ut,Object(k.a)(Object(k.a)({},e),{},{returnAllDictValues:!0,c2profileparameters:I,onChange:function(e,t,a,n){var i=I.map((function(e){return e.name===t?Object(k.a)(Object(k.a)({},e),{},{error:n,value:a}):e}));console.log(i),$(i)}}))]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:function(){if(0!==r.length){var t=I.reduce((function(e,t){return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,t.value))}),{});B({variables:{operation_id:a.user.current_operation_id,instance_name:r,c2profile_id:e.id,c2_instance:JSON.stringify(t)}})}else E.warning("Must supply an instance name")},color:"secondary",children:j.length>0?"Update":"Create"})]})]})}var na,ia,ra,ca=a(54),oa=a(38),sa=Object(Ge.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"},successButton:{backgroundColor:e.palette.success.main,color:"white","&:hover":{backgroundColor:e.palette.success.dark}},errorButton:{backgroundColor:e.palette.error.main,color:"white","&:hover":{backgroundColor:e.palette.error.dark}}}})),la=Object(O.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Ye.a),da=Object(Pe.a)(na||(na=Object(q.a)(["\nmutation StartStopProfile($id: Int!, $action: String) {\n  startStopProfile(id: $id, action: $action) {\n    status\n    error\n    output\n  }\n}\n"]))),ua=Object(Pe.a)(ia||(ia=Object(q.a)(["\nmutation setProfileConfiguration($id: Int!, $file_path: String!, $data: String!) {\n  uploadContainerFile(id: $id, file_path: $file_path, data: $data) {\n    status\n    error\n    filename\n  }\n}\n"])));function ba(e){var t=new Date,a=Object(xe.a)(),n=sa(a),i=(t.getTime()+6e4*t.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning",r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useRef(null),f=function(){m((function(e){return!e}))},O=function(e){h.current&&h.current.contains(e.target)||m(!1)},x=Object(Ee.a)(da,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){F(e.startStopProfile.output),B(!0)}}),y=Object(u.a)(x,1)[0],_=function(){e.running?E.info("Submitting stop task..."):E.info("Submitting start task..."),y({variables:{id:e.id,action:e.running?"stop":"start"}})},v=s.a.useState(!1),w=Object(u.a)(v,2),C=w[0],S=w[1],D=s.a.useState(!1),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState(""),A=Object(u.a)(P,2),L=A[0],F=A[1],q=s.a.useState(!1),N=Object(u.a)(q,2),R=N[0],B=N[1],z=s.a.useState(!1),W=Object(u.a)(z,2),M=W[0],U=W[1],V=Object(Ee.a)(ua,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){"success"===e.uploadContainerFile.status?E.success("Updated file"):E.error("Error updating: "+e.uploadContainerFile.error)}}),G=Object(u.a)(V,1)[0];return Object(g.jsxs)(Ke.a,{className:n.root,elevation:5,style:{maxWidth:"100%"},children:[Object(g.jsx)(la,{overlap:"circle",classes:{badge:n[i]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.is_p2p?Object(g.jsx)(ca.a,{icon:oa.x,size:"6x",style:{width:"125px",height:"125px"}}):Object(g.jsx)(jt.a,{style:{width:"125px",height:"125px"}})}),Object(g.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(g.jsx)(Q.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block"},children:e.name}),!e.is_p2p&&e.running&&Object(g.jsx)(Q.a,{variant:"h6",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block",color:a.palette.success.main},children:"(Server Running)"}),!e.is_p2p&&!e.running&&Object(g.jsx)(Q.a,{variant:"h6",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block",color:a.palette.error.main},children:"(Server Not Running)"}),Object(g.jsxs)(Je.a,{style:{textAlign:"left"},children:[Object(g.jsxs)(Q.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Author:"})," ",e.author]}),Object(g.jsxs)(Q.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Supported Agents:"})," ",e.payloadtypec2profiles.map((function(e){return e.payloadtype.ptype+" "}))]}),Object(g.jsx)(Q.a,{variant:"body2",component:"p",children:e.description}),Object(g.jsx)(Q.a,{variant:"body2",component:"p"})]})]}),Object(g.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(g.jsx)(b.a,{size:"small",variant:"contained",color:"primary",href:"/docs/c2-profiles/"+e.name.toLowerCase(),target:"_blank",children:"Docs"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){l(!0)},color:"primary",variant:"contained",children:"Build Info"}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:o,onClose:function(){l(!1)},innerDialog:Object(g.jsx)(dt,Object(k.a)(Object(k.a)({},e),{},{onClose:function(){l(!1)},payload_name:e.name}))}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:R,onClose:function(){B(!1)},innerDialog:Object(g.jsx)(It,{output:L,onClose:function(){B(!1)},payload_name:e.name})}),e.container_running?e.running?Object(g.jsxs)(pt.a,{variant:"contained",ref:h,"aria-label":"split button",children:[Object(g.jsx)(b.a,{size:"small",className:e.running?n.successButton:n.errorButton,onClick:_,style:{width:"100%"},children:"Stop Profile"}),Object(g.jsx)(b.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",className:e.running?n.successButton:n.errorButton,onClick:f,children:Object(g.jsx)(ht.a,{})})]}):e.is_p2p?null:Object(g.jsxs)(pt.a,{variant:"contained",ref:h,"aria-label":"split button",children:[Object(g.jsx)(b.a,{size:"small",onClick:_,className:e.running?n.successButton:n.errorButton,style:{width:"100%"},children:"Start Profile"}),Object(g.jsx)(b.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",className:e.running?n.successButton:n.errorButton,onClick:f,children:Object(g.jsx)(ht.a,{})})]}):Object(g.jsx)(b.a,{disabled:!0,color:"secondary",children:"Container Offline"}),Object(g.jsxs)(b.a,{size:"small",variant:"contained",color:"primary",onClick:function(){U(!0)},children:[Object(g.jsx)($t.a,{})," Saved Instances"]}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:C,onClose:function(){S(!1)},innerDialog:Object(g.jsx)(vt,Object(k.a)(Object(k.a)({},e),{},{payload_name:e.name,onClose:function(){S(!1)},profile_id:e.id}))}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:T,onClose:function(){$(!1)},innerDialog:Object(g.jsx)(Dt,Object(k.a)(Object(k.a)({},e),{},{onConfigSubmit:function(t){G({variables:{id:e.id,file_path:"config.json",data:t}})},payload_name:e.name,onClose:function(){$(!1)},profile_id:e.id}))}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:M,onClose:function(){U(!1)},innerDialog:Object(g.jsx)(aa,Object(k.a)(Object(k.a)({},e),{},{onClose:function(){U(!1)}}))}),Object(g.jsx)(gt.a,{open:p,anchorEl:h.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var n=t.TransitionProps,i=t.placement;return Object(g.jsx)(Ot.a,Object(k.a)(Object(k.a)({},n),{},{style:{transformOrigin:"bottom"===i?"center top":"center bottom"},children:Object(g.jsx)(H.a,{style:{backgroundColor:"dark"===a.palette.type?a.palette.primary.dark:a.palette.primary.light,color:"white"},children:Object(g.jsx)(ft.a,{onClickAway:O,children:Object(g.jsxs)(yt.a,{id:"split-button-menu",children:[Object(g.jsx)(xt.a,{onClick:function(){$(!0)},children:"View/Edit Config"},"dropdownprofile"+e.id+"menu1"),e.running?Object(g.jsx)(xt.a,{onClick:function(){S(!0)},children:"View Stdout/Stderr"},"dropdownprofile"+e.id+"menu2"):null]})})})}))}})]})]})}var ja=Object(Pe.a)(ra||(ra=Object(q.a)(["\nsubscription getPayloadTypesSubscription {\n   c2profile(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   author\n   id\n   container_running\n   description\n   is_p2p\n   last_heartbeat\n   name\n   running\n   payloadtypec2profiles(order_by: {payloadtype: {ptype: asc}}) {\n     payloadtype {\n       ptype\n     }\n   }\n }\n}\n"])));function pa(e){var t=Object(ct.a)(ja,{fetchPolicy:"network-only"}).data,a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(xe.a)();return Object(o.useEffect)((function(){r(void 0!==t?t.c2profile:[])}),[t]),Object(g.jsxs)("div",{style:{flexDirection:"column",alignItems:"stretch",paddingLeft:"10px"},children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"C2 Profiles"})}),i.map((function(e){return Object(g.jsx)(ba,Object(k.a)({},e),"c2prof"+e.id)}))]})}var ma,ha=Object(Ge.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),fa=Object(O.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Ye.a);function Oa(e){var t=ha(),a=new Date,n=(a.getTime()+6e4*a.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(g.jsxs)(Ke.a,{className:t.root,elevation:5,children:[Object(g.jsx)(fa,{overlap:"circle",classes:{badge:t[n]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(g.jsx)(ca.a,{icon:oa.w,size:"6x",style:{width:"125px",height:"125px"}})}),Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.name}),e.payloadtypes.length>0?Object(g.jsxs)(Q.a,{variant:"body1",component:"p",children:[Object(g.jsx)("b",{children:"Translated Payload Types:"})," ",e.payloadtypes.map((function(e){return e.ptype})).join(", ")]}):null]})]})}var ga=Object(Pe.a)(ma||(ma=Object(q.a)(["\nsubscription getTranslationContainersSubscription {\n translationcontainer(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   name\n   id\n   container_running\n   last_heartbeat\n   payloadtypes(order_by: {ptype: asc}) {\n       ptype\n       id\n   }\n }\n}\n"])));function xa(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(ct.a)(ga).data,j=Object(xe.a)();return Object(o.useEffect)((function(){if(void 0!==b){var e=b.translationcontainer.filter((function(e){return 0===e.payloadtypes.length})),t=b.translationcontainer.filter((function(e){return e.payloadtypes.length>0}));i(e),d(t)}else i([])}),[b]),Object(g.jsxs)("div",{style:{width:"100%",display:"inline-flex",flexDirection:"column",alignItems:"stretch"},children:[n.length>0?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:j.pageHeader.main,color:j.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers Not Assigned to Payload Types"})}),n.map((function(e){return Object(g.jsx)(Oa,Object(k.a)({},e),"translation_container"+e.id)}))]}):null,l.length>0?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:j.pageHeader.main,color:j.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers"})}),l.map((function(e){return Object(g.jsx)(Oa,Object(k.a)({},e),"translation_container"+e.id)}))]}):null]})}function ya(e){return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(Ft.a,{container:!0,spacing:0,children:[Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsx)(st,{})}),Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsx)(pa,{})}),Object(g.jsx)(Ft.a,{item:!0,xs:12,children:Object(g.jsx)(xa,{})})]})})}var _a,va=a(905),ka=a(879),wa=a(899),Ca=a(868),Sa=a(793);function Da(e){return Object(g.jsxs)("div",{children:[Object(g.jsx)(b.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",onClick:e.finished,children:e.last?"Create Payload":"Next"})]})}var Ia,Ta=Object(Pe.a)(_a||(_a=Object(q.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    id\n    supported_os\n  }\n}\n "])));function $a(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];if(Object(Ae.a)(Ta,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(F.a)(t),[a])}),[]);return[].concat(Object(F.a)(e),Object(F.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),l(a)},onError:function(e){console.error(e)}}).loading)return Object(g.jsx)("div",{children:Object(g.jsx)(Ca.a,{})});return Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(g.jsx)("br",{}),Object(g.jsxs)(Et.a,{children:[Object(g.jsx)(Lt.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(g.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(g.jsx)(Sa.a,{children:"Target Operating System"})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(Da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){e.finished(n)}})]})}function Pa(e){return Object(g.jsxs)(z.a,{component:H.a,className:"mythicElement",children:[Object(g.jsx)(Q.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Build Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:e.buildParameters.map((function(t){return Object(g.jsx)(Ht,Object(k.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var Aa=Object(Pe.a)(Ia||(Ia=Object(q.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function Ea(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(Ae.a)(Aa,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){console.log(e.prevData),i(e.prevData.payload_type),l(e.prevData.file_extension),p(e.prevData.supports_dynamic_loading);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(k.a)(Object(k.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(F.a)(t),Object(F.a)(n))}return Object(F.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(a)}else{i(t.payloadtype[0].ptype),l(t.payloadtype[0].file_extension),p(t.payloadtype[0].supports_dynamic_loading);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):"Boolean"===e.parameter_type?Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:"true"===e.default_value.toLowerCase()}):Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(F.a)(e),Object(F.a)(n))}return Object(F.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(n),console.log(n)}}}),y=x.loading,_=x.error,v=x.data;return y?Object(g.jsx)("div",{children:Object(g.jsx)(Ca.a,{})}):_?(console.error(_),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(g.jsx)(Lt.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=v.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){l(a.file_extension),p(a.supports_dynamic_loading);var n=a.buildparameters.map((function(e){return console.log(e),"ChooseOne"===e.parameter_type?Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):"Boolean"===e.parameter_type?Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:"true"===e.default_value.toLowerCase()}):Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(F.a)(t),Object(F.a)(n))}return Object(F.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(t)},children:v.payloadtype.map((function(e){return Object(g.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(g.jsx)("br",{}),Object(g.jsx)(Pa,{onChange:function(e,t,a){var n=f.map((function(n){return n.name===e?Object(k.a)(Object(k.a)({},n),{},{value:t,error:a}):Object(k.a)({},n)}));O(n)},buildParameters:f}),Object(g.jsx)(Da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=f.map((function(e){return{name:e.name,value:e.value}}));e.finished({payload_type:n,parameters:t,file_extension:o,supports_dynamic_loading:j,os:e.buildOptions})}})]})}function La(e){var t=Object(xe.a)();return Object(g.jsx)(be,{fullWidth:!1,maxWidth:"sm",open:e.open,onClose:function(){e.onClose()},innerDialog:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{children:e.title?e.title:"Are you sure?"}),void 0===e.dialogText?null:Object(g.jsx)(ce.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:Object(g.jsx)(oe.a,{children:e.dialogText})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:e.cancelText?e.cancelText:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit(),e.onClose()},autoFocus:!0,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:e.acceptText?e.acceptText:"Remove"})]})]})})}var Fa,qa=a(792),Na=a(800),Ra=a(875),Ba=a(876),za=a(900),Wa=a(873),Ma=a(874),Ha=Object(Ge.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}})),Ua=Object(Pe.a)(Fa||(Fa=Object(q.a)(["\nquery getCommands($payloadType: String!) {\n  command(where: {payloadtype: {ptype: {_eq: $payloadType}}, deleted: {_eq: false}}, order_by: {cmd: asc}) {\n    cmd\n    attributes\n    id\n    supported_ui_features\n    help_cmd\n    description\n    needs_admin\n  }\n}\n "])));function Va(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(Ae.a)(Ua,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type},onCompleted:function(){if(e.buildOptions.supports_dynamic_loading){var t=m.command.reduce((function(t,a){try{var n=JSON.parse(a.attributes);if(0===n.supported_os.length||n.supported_os.includes(e.buildOptions.os)){if(void 0!==n.builtin&&n.builtin)return[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},a),{},{disabled:!0,selected:!0,reason:"This command is builtin and must be included"})]);try{if(void 0!==n.load_only&&n.load_only)return[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},a),{},{disabled:!0,selected:!1,reason:"This command can only be loaded in once a callback is established"})]);var i=!0,r={};if(void 0!==n.filter_by_build_parameter)for(var c=0,o=Object.entries(n.filter_by_build_parameter);c<o.length;c++)for(var s=Object(u.a)(o[c],2),l=s[0],d=s[1],b=0;b<e.buildOptions.parameters.length;b++)e.buildOptions.parameters[b].name===l&&e.buildOptions.parameters[b].value!==d&&(i=!1,r.name=l,r.value=d);return i?void 0!==n.suggested_command&&n.suggested_command?[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},a),{},{disabled:!1,selected:!0,reason:"This command is suggested to be included"})]):[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},a),{},{disabled:!1,selected:!1,reason:""})]):[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},a),{},{disabled:!0,selected:!1,reason:'Not available when build option "'+r.name+'" is not "'+r.value+'"'})])}catch(j){console.error(j)}}return[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},a),{},{disabled:!0,selected:!1,reason:"This command isn't supported by the selected OS"})])}catch(j){return[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},a),{},{disabled:!1,selected:!1,reason:"Failed to parse command attributes"})])}}),[]);if(l(t),void 0!==e.prevData){var a=t.map((function(t){return e.prevData.includes(t.cmd)?Object(k.a)(Object(k.a)({},t),{},{selected:!0}):Object(k.a)(Object(k.a)({},t),{},{selected:!1})}));l(a)}}else{var n=m.command.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{selected:!0,disabled:!0,reason:"Agent doesn't support dynamic loading"})}));l(n)}}}).data;return Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Build Commands Into Agent"})," ",Object(g.jsx)("br",{}),Object(g.jsx)(Ga,{commands:o,payload_type:e.buildOptions.payload_type,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){for(var a=!1,n=0;n<t.length;n++)if(t[n].supported_ui_features.includes("callback_table:exit")){a=!0;break}if(a){var r=t.map((function(e){return e.cmd}));e.finished(r)}else p(!0),i(t)}}),Object(g.jsx)(La,{open:j,title:"No exit command selected, continue?",onClose:function(){return p(!1)},acceptText:"Accept",onSubmit:function(){var t=n.map((function(e){return e.cmd}));e.finished(t)}})]})}function Ga(e){var t=Ha(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=S(i,d),x=S(i,h),y=s.a.useState({}),_=Object(u.a)(y,2),v=_[0],w=_[1];function C(e,t){return e.filter((function(e){return void 0===t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}function S(e,t){return e.filter((function(e){return void 0!==t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}var D=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(F.a)(i);-1===a?n.push(t):n.splice(a,1),r(n)}};Object(o.useEffect)((function(){var t=e.commands.reduce((function(e,t){return t.selected?Object(F.a)(e):[].concat(Object(F.a)(e),[Object(k.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.selected?[].concat(Object(F.a)(e),[Object(k.a)({},t)]):Object(F.a)(e)}),[]);j(t),f(a)}),[e.commands]);var I=function(t){var a=e.commands.filter((function(e){return e.cmd===t.target.innerText}));a.length>0&&w(a[0])},T=function(e,a){return Object(g.jsxs)(H.a,{className:t.paper,style:{width:"100%",height:"calc(40vh)",overflow:"auto"},elevation:5,children:[Object(g.jsx)(Wa.a,{className:t.cardHeader,title:e}),Object(g.jsx)(Ma.a,{classes:{root:t.divider}}),Object(g.jsxs)(qa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[a.map((function(e){var t=e.cmd,a="transfer-list-item-".concat(t,"-label");return Object(g.jsx)("div",{onMouseEnter:I,children:Object(g.jsxs)(Na.a,{style:{padding:0},disabled:e.disabled,role:"listitem",button:!0,onClick:D(e),children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(za.a,{disabled:e.disabled,checked:-1!==i.findIndex((function(e){return e.cmd===t})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":a}})}),Object(g.jsx)(Ba.a,{id:a,primary:t})]},t)},"commandtransfer"+t)})),Object(g.jsx)(Na.a,{})]})]})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(g.jsx)(Ft.a,{item:!0,xs:5,children:T("Available Commands",d)}),Object(g.jsx)(Ft.a,{item:!0,children:Object(g.jsxs)(Ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&!t.selected?[].concat(Object(F.a)(e),[Object(k.a)({},t)]):Object(F.a)(e)}),[]),a=e.commands.reduce((function(e,t){return!t.disabled||t.selected?[].concat(Object(F.a)(e),[Object(k.a)({},t)]):Object(F.a)(e)}),[]);j(t),f(a)},disabled:0===d.length,"aria-label":"move all right",children:"\u226b"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(O)),j(C(d,O)),r(C(i,O))},disabled:0===O.length,"aria-label":"move selected right",children:">"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(x)),f(C(h,x)),r(C(i,x))},disabled:0===x.length,"aria-label":"move selected left",children:"<"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&t.selected?Object(F.a)(e):[].concat(Object(F.a)(e),[Object(k.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.disabled&&t.selected?[].concat(Object(F.a)(e),[Object(k.a)({},t)]):Object(F.a)(e)}),[]);j(t),f(a)},disabled:0===h.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(g.jsx)(Ft.a,{item:!0,xs:5,children:T("Commands Included",h)})]}),Object(g.jsx)(Ft.a,{container:!0,justify:"center",alignItems:"flex-start",className:t.root,children:Object(g.jsx)(Ft.a,{item:!0,xs:12,style:{height:"100%",marginBottom:"10px"},children:void 0!==v.cmd&&Object(g.jsxs)(H.a,{className:t.paper,style:{width:"100%"},elevation:5,children:[Object(g.jsx)(Wa.a,{className:t.cardHeader,title:Object(g.jsxs)(s.a.Fragment,{children:[v.cmd,Object(g.jsx)(b.a,{variant:"contained",color:"primary",href:"/docs/agents/"+e.payload_type+"/commands/"+v.cmd,style:{marginLeft:"10px",float:"right"},target:"_blank",children:"Documentation"})]})}),Object(g.jsx)(Ma.a,{classes:{root:t.divider}}),""!==v.reason?Object(g.jsxs)(Q.a,{variant:"body1",align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsxs)("b",{children:[v.disabled?"Disabled Reason: ":"Information: "," "]}),v.reason]}):null,Object(g.jsx)("br",{}),Object(g.jsxs)(Q.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsx)("b",{children:"Commandline Help: "}),v.help_cmd]}),Object(g.jsxs)(Q.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsx)("b",{children:"Needs Admin Permissions: "}),v.needs_admin?"True":"False"]}),Object(g.jsxs)(Q.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(g.jsx)("b",{children:"Description: "}),v.description]})]})})}),Object(g.jsx)(Da,{first:e.first,last:e.last,canceled:e.canceled,finished:function(){e.finished(h)}})]})}var Ka,Qa,Ja=a(877),Ya=Object(Pe.a)(Ka||(Ka=Object(q.a)(["\nquery getPayloadTypesC2ProfilesQuery($payloadType: String!, $operation_id: Int!) {\n  c2profile(where: {payloadtypec2profiles: {payloadtype: {ptype: {_eq: $payloadType}}}, deleted: {_eq: false}}) {\n    name\n    is_p2p\n    description\n    id\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n        instance_name\n    }\n  }\n}\n "]))),Za=Object(Pe.a)(Qa||(Qa=Object(q.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n      c2profile {\n          name\n      }\n    }\n    id\n    value\n  }\n}\n"])));function Xa(e){var t=Object(T.a)(C),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1],b=Object(Ae.a)(Ya,{variables:{payloadType:e.buildOptions.payload_type,operation_id:t.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.map((function(t){if(void 0!==e.prevData){console.log(e.prevData);for(var a=0;a<e.prevData.length;a++)if(e.prevData[a].name===t.name){var n=e.prevData[a].c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=JSON.parse(e.default_value),a=e.value.map((function(e){var a=t.find((function(t){return t.name===e.name}));return void 0!==a?Object(k.a)(Object(k.a)(Object(k.a)({},a),e),{},{default_show:""!==e.value}):Object(k.a)(Object(k.a)({},e),{},{default_show:!1})})),n=t.reduce((function(e,t){return e.findIndex((function(e){return e.name===t.name}))>-1?Object(F.a)(e):[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{default_show:!1,key:"*"===t.name?"":t.name,value:t.default_value})])}),Object(F.a)(a));return Object(k.a)(Object(k.a)({},e),{},{value:n})}return e}));return n.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(k.a)(Object(k.a)({},t),{},{selected:e.prevData[a].selected,c2profileparameters:n})}}var i=t.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Yt(e.format_string).gen();return Object(k.a)(Object(k.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(k.a)(Object(k.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name,default_show:t.default_show})])}),[]);return Object(k.a)(Object(k.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return""!==e.default_value&&n.setDate(n.getDate()+parseInt(e.default_value)),Object(k.a)(Object(k.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(k.a)(Object(k.a)({},e),{},{value:e.default_value})}return Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value})}));return i.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(k.a)(Object(k.a)({},t),{},{selected:!1,c2profileparameters:i})}));a.sort((function(e,t){return-t.name.localeCompare(e.name)})),r(a)},fetchPolicy:"no-cache"}),j=b.loading,p=b.error,m=function(e,t,a,n){var c=i.map((function(i){if(i.name===e){var r=i.c2profileparameters.map((function(e){return e.name===t?Object(k.a)(Object(k.a)({},e),{},{error:n,value:a}):e}));return Object(k.a)(Object(k.a)({},i),{},{c2profileparameters:r})}return i}));r(c)},h=Object(At.a)(Za,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(k.a)(Object(k.a)({},e),e.c2profileparameter);return"Dictionary"!==t.parameter_type&&"Array"!==t.parameter_type||(t.value=JSON.parse(t.value)),t}));t.sort((function(e,t){return e.name<t.name?-1:1}));var a=i.map((function(e){return t[0].c2profile.name===e.name?Object(k.a)(Object(k.a)({},e),{},{c2profileparameters:t}):e}));r(a)},onError:function(e){E.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),f=Object(u.a)(h,1)[0];return j?Object(g.jsx)("div",{children:Object(g.jsx)(Ca.a,{})}):p?(console.error(p),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Select C2 Profiles"}),i.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Ja.a,{value:"top",control:Object(g.jsx)(U.a,{checked:e.selected,onChange:function(t){return function(e,t){var a=i.map((function(e){return t.name===e.name?Object(k.a)(Object(k.a)({},e),{},{selected:!e.selected}):e}));r(a)}(0,e)},inputProps:{"aria-label":"primary checkbox"},name:"active"}),label:e.name,labelPlacement:"top",style:{display:"inline"}}),e.c2profileparametersinstances.length>0&&e.selected?Object(g.jsxs)(Et.a,{style:{width:"100%"},children:[Object(g.jsx)(Jt.a,{children:"Select an Existing Instance"}),Object(g.jsxs)(Lt.a,{style:{width:"100%",marginBottom:"10px"},value:l,label:"Select an Existing Instance",onChange:function(a){return function(e,a){if(d(e.target.value),""!==e.target.value){var n=i.map((function(e){return a.name===e.name&&(e.c2profileparameters=[]),e}));r(n),f({variables:{name:e.target.value,operation_id:t.user.current_operation_id}})}}(a,e)},children:[Object(g.jsx)(xt.a,{value:"",children:"New Instance"}),e.c2profileparametersinstances.map((function(e,t){return Object(g.jsx)(xt.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]}):null,Object(g.jsx)(Q.a,{variant:"body1",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:e.description},"step4desc"+e.id),e.selected?Object(g.jsx)(Ut,Object(k.a)(Object(k.a)({returnAllDictValues:!1},e),{},{onChange:m}),"step4table"+e.id):null]},"step4c2switch"+e.id)})),Object(g.jsx)("br",{}),Object(g.jsx)(Da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=!0,a=!1,n=i.reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=e.value.filter((function(e){return""!==e.value}));return Object(k.a)(Object(k.a)({},e),{},{value:t})}return Object(k.a)({},e)}));return[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{c2profileparameters:a})])}return[].concat(Object(F.a)(e),[Object(k.a)({},t)])}),[]);if(i.forEach((function(e){e.selected&&(a=!0,e.c2profileparameters.forEach((function(a){a.error&&(E.warning(e.name+"'s parameter "+a.name+" is invalid"),t=!1)})))})),t){if(!a)return void E.warning("Must select at least one C2 to include");e.finished(n)}}}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{})]})}var en,tn,an=a(7),nn=a(878),rn=a(123),cn=a.n(rn),on=a(80),sn=a.n(on),ln=a(82),dn=a.n(ln),un=Object(Pe.a)(en||(en=Object(q.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),bn=Object(Ge.a)((function(e){return{root:Object(Pt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),jn=s.a.forwardRef((function(e,t){var a=Object(xe.a)(),n=bn(a),i=Object($.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)($.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ke.a,{style:{backgroundColor:a.palette.success.main},children:[Object(g.jsxs)(nn.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(Q.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(K.a,{"aria-label":"Show more",className:Object(an.default)(n.expand,Object(Pt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(sn.a,{})}),Object(g.jsx)(K.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(cn.a,{})})]})]}),Object(g.jsxs)(G.a,{in:s,timeout:"auto",unmountOnExit:!0,children:[Object(g.jsxs)(H.a,{className:n.collapse,children:[Object(g.jsx)(Q.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(g.jsxs)(b.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(g.jsx)(dn.a,{className:n.checkIcon}),"Download now"]})]}),Object(g.jsx)(H.a,{className:n.collapse,children:Object(g.jsx)(b.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),pn=s.a.forwardRef((function(e,t){var a=Object(xe.a)(),n=bn(a),i=Object($.c)().closeSnackbar,r=Object(o.useState)(!1),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)($.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ke.a,{style:{backgroundColor:a.palette.error.main},children:[Object(g.jsxs)(nn.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(Q.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(K.a,{"aria-label":"Show more",className:Object(an.default)(n.expand,Object(Pt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(sn.a,{})}),Object(g.jsx)(K.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(cn.a,{})})]})]}),Object(g.jsx)(G.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(g.jsx)(H.a,{className:n.collapse,children:e.display})})]})})}));function mn(e){var t=s.a.useState((new Date).toISOString()),a=Object(u.a)(t,2),n=a[0],i=(a[1],Object(ct.a)(un,{variables:{fromNow:n}})),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){console.log(l),!r&&!c&&l&&l.payload.length>0?"success"===l.payload[0].build_phase?(E.dismiss(),E.success(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(jn,{id:e,file_id:l.payload[0].filemetum.agent_file_id})}})):"building"===l.payload[0].build_phase||(""!==l.payload[0].build_stderr?E.error(l.payload[0].build_stderr,{persist:!0,content:function(e){return Object(g.jsx)(pn,{id:e,display:l.payload[0].build_stderr})}}):E.error(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(pn,{id:e,display:l.payload[0].build_message})}})):c&&(console.log(c),E.error("Mythic encountered an error: "+c.toString()))}),[r,l,c]),null}var hn,fn=Object(Pe.a)(tn||(tn=Object(q.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function On(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(Ee.a)(fn,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?E.info("Submitted payload to build pipeline"):E.error(a.createPayload.error)}}),j=Object(u.a)(b,1)[0];Object(o.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);return Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(g.jsx)("br",{}),Object(g.jsx)(y,{required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(g.jsx)(y,{required:!1,placeholder:"description",value:l,multiline:!1,onChange:function(e,t,a){d(t)},display:"inline-block"}),Object(g.jsx)(Da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a=e.buildOptions[3].reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.reduce((function(e,t){if("Dictionary"===t.parameter_type){var a=t.value.map((function(e){return{name:e.name,key:e.key,value:e.value,custom:e.custom}}));return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,a))}return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,t.value))}),{});return[].concat(Object(F.a)(e),[{c2_profile:t.name,c2_profile_parameters:a}])}return e}),[]),i={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:l,commands:e.buildOptions[2],build_parameters:t,c2_profiles:a};j({variables:{payload:JSON.stringify(i)}}).catch((function(e){console.log(e)}))}}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(mn,{})]})}function gn(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=function(e){i(Object(k.a)(Object(k.a)({},n),{},Object(Pt.a)({},o,e))),p()},b=function(){m()},j=["Select Target OS","Payload Type","Select Commands","Select C2 Profiles","Build"],p=function(){l((function(e){return e+1}))},m=function(){l((function(e){return e-1}))};return Object(g.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(g.jsx)(va.a,{activeStep:o,alternativeLabel:!0,children:j.map((function(e,t){return Object(g.jsx)(ka.a,{children:Object(g.jsx)(wa.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(g.jsx)($a,{buildOptions:n,prevData:n[0],finished:d,canceled:b,first:!0,last:!1});case 1:return Object(g.jsx)(Ea,{buildOptions:n[0],prevData:n[1],finished:d,canceled:b,first:!1,last:!1});case 2:return Object(g.jsx)(Va,{buildOptions:n[1],prevData:n[2],finished:d,canceled:b,first:!1,last:!1});case 3:return Object(g.jsx)(Xa,{buildOptions:n[1],prevData:n[3],finished:d,canceled:b,first:!1,last:!1});case 4:return Object(g.jsx)(On,{buildOptions:n,canceled:b,first:!1,last:!0});default:return"Unknown step"}}(o)]})}function xn(e){return Object(g.jsxs)("div",{children:[Object(g.jsx)(b.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",onClick:e.finished,disabled:e.disableNext,children:e.last?"Create Payload":"Next"})]})}var yn,_n=Object(Pe.a)(hn||(hn=Object(q.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    id\n    supported_os\n  }\n}\n "])));function vn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];if(Object(Ae.a)(_n,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(F.a)(t),[a])}),[]);return[].concat(Object(F.a)(e),Object(F.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),l(a),0===a.length&&E.warning("No Wrappers exist within Mythic. Try importing one first via the mythic-cli binary")},onError:function(e){console.error(e)}}).loading)return Object(g.jsx)("div",{children:Object(g.jsx)(Ca.a,{})});return Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(g.jsx)("br",{}),Object(g.jsxs)(Et.a,{children:[Object(g.jsx)(Lt.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(g.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(g.jsx)(Sa.a,{children:"Target Operating System"})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(xn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){0!==o.length?e.finished(n):E.warning("No Wrappers exist within Mythic. Try importing one first via the mythic-cli binary")}})]})}function kn(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,r=e.required,c=e.verifier_regex,l=e.id,d=e.description,j=e.value,p=e.returnAllDictValues,m=s.a.useState(""),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(xe.a)(),_=s.a.useState([]),v=Object(u.a)(_,2),w=v[0],C=v[1],S=s.a.useState([]),D=Object(u.a)(S,2),I=D[0],T=D[1],$=s.a.useState([]),P=Object(u.a)($,2),A=P[0],E=P[1],L=s.a.useState(""),q=Object(u.a)(L,2),N=q[0],R=q[1],z=s.a.useState([]),W=Object(u.a)(z,2),H=W[0],U=W[1],V=s.a.useState(new Date),G=Object(u.a)(V,2),J=G[0],Y=G[1],Z=function(e){var a=e.map((function(e){return p?{custom:"*"===e.name,key:e.key,name:e.name,value:e.value}:Object(Pt.a)({},e.key,e.value)}));t(i,a,!1)};Object(o.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");O(e[0]),U(e)}""!==j&&void 0!==j&&(O(j),t(i,j,""))}else if("Date"===a){if(""!==n){var r=new Date;r.setDate(r.getDate()+parseInt(n)),ie(r),O(-1)}""!==j&&void 0!==j&&j.includes("-")&&(console.log("passed date value: ",j),Y(new Date(j)),O(-1),t(i,new Date(j).toISOString().slice(0,10),""))}else if("Dictionary"===a){var c=JSON.parse(n);T(c);var o=c.reduce((function(e,t){return t.default_show?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(F.a)(e)}),[]);Z(o),C(o);var s=c.reduce((function(e,t){var a=o.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(F.a)(e)}),[]);E(s),s.length>0&&R(s[0]),""!==j&&void 0!==j&&"object"===typeof j&&(C(j),Z(j))}else void 0!==n&&O(n),""!==j&&void 0!==j&&(O(j),t(i,j,""))}),[n,a,i]);var X=function(e){O(e.target.value),t(i,e.target.value,!1)},ee=function(e,a,n){O(a),t(e,a,n)},ae=function(e){return(r&&""!==c||""!==c&&""!==e)&&!RegExp(c).test(e)},ne=function(){var e=N;C([].concat(Object(F.a)(w),[e]));var t=A.reduce((function(t,a){var n=w.reduce((function(e,t){return t.name===a.name?e+1:e}),0);return e.name===a.name&&(n+=1),-1===a.max||a.max>n?[].concat(Object(F.a)(t),[Object(k.a)({},a)]):Object(F.a)(t)}),[]);Z(t),E(t),t.length>0&&R(t[0])},ie=function(e){Y(e),t(i,e.toISOString().slice(0,10),"")},re=s.a.useState(null),ce=Object(u.a)(re,2),oe=ce[0],se=ce[1],le=Boolean(oe),de=function(){se(null)};return Object(g.jsxs)(M.a,{children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(Q.a,{"aria-haspopup":"true",onMouseEnter:function(e){se(e.currentTarget)},onMouseLeave:de,"aria-owns":le?"taskparam"+l+"popover":void 0,children:d}),Object(g.jsx)(Mt.a,{id:"taskparam"+l+"popover",open:le,anchorEl:oe,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:de,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===x.palette.type?x.palette.primary.dark:x.palette.primary.light,color:"white"},variant:"outlined"},children:Object(g.jsx)(Q.a,{children:i.length>0?i:"No Description"})})]}),Object(g.jsx)(B.a,{children:function(){switch(a){case"Date":return Object(g.jsx)(Bt.a,{utils:Wt.a,children:Object(g.jsx)(Ft.a,{container:!0,justify:"flex-start",children:Object(g.jsx)(zt.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:J,onChange:ie,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:f,onChange:X,children:H.map((function(e,t){return Object(g.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(g.jsxs)(s.a.Fragment,{children:[w.map((function(e,t){return Object(g.jsxs)("div",{children:[Object(g.jsxs)(K.a,{onClick:function(e){!function(e){var t=w[e],a=w.filter((function(t,a){return e!==a}));C(a);var n=I.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},n),{},{value:n.default_value,key:"*"===n.name?"":n.name})]):Object(F.a)(e)}),[]);Z(n),E(n),n.length>0&&R(n[0])}(t)},children:[Object(g.jsx)(te.a,{style:{color:x.palette.error.main}})," "]}),"*"===e.name?Object(g.jsx)(qt.a,{style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=w.map((function(a,n){return n===t?Object(k.a)(Object(k.a)({},a),{},{key:e.target.value}):Object(k.a)({},a)}));Z(a),C(a)}(e,t)}}):Object(g.jsx)(qt.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"key"}),value:e.key}),Object(g.jsx)(qt.a,{style:{width:"75%"},startAdornment:Object(g.jsx)(b.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=w.map((function(a,n){return n===t?Object(k.a)(Object(k.a)({},a),{},{value:e.target.value}):Object(k.a)({},a)}));Z(a),C(a)}(e,t)}})]},"dictval"+t)})),A.length>0?Object(g.jsxs)("div",{children:[Object(g.jsxs)(K.a,{onClick:ne,children:[" ",Object(g.jsx)(Rt.a,{style:{color:x.palette.success.main}})," "]}),Object(g.jsx)(Lt.a,{size:"small",value:N,onChange:function(e){return R(e.target.value)},children:A.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+"i")}))})]}):null]});case"String":return Object(g.jsx)(y,{required:r,value:f,multiline:!0,onChange:ee,display:"inline-block",name:i,validate:ae,errorText:"Must match: "+c});default:return null}}()})]},"buildparam"+l)}function wn(e){return Object(g.jsxs)(z.a,{component:H.a,className:"mythicElement",children:[Object(g.jsx)(Q.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Build Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:e.buildParameters.map((function(t){return Object(g.jsx)(kn,Object(k.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var Cn,Sn=Object(Pe.a)(yn||(yn=Object(q.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function Dn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(Ae.a)(Sn,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){i(e.prevData.payload_type),l(e.prevData.payload_type_id),p(e.prevData.file_extension);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(k.a)(Object(k.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(F.a)(t),Object(F.a)(n))}return Object(F.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(a),0===a.length&&E.warning("No available payload types exist for the selected OS")}else{i(t.payloadtype[0].ptype),l(t.payloadtype[0].id),p(t.payloadtype[0].file_extension);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(F.a)(e),Object(F.a)(n))}return Object(F.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(n)}}}),y=x.loading,_=x.error,v=x.data;return y?Object(g.jsx)("div",{children:Object(g.jsx)(Ca.a,{})}):_?(console.error(_),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(g.jsx)(Lt.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=v.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){p(a.file_extension),l(a.id);var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(k.a)(Object(k.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(F.a)(t),Object(F.a)(n))}return Object(F.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(t)},children:v.payloadtype.map((function(e){return Object(g.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(g.jsx)("br",{}),Object(g.jsx)(wn,{onChange:function(e,t,a){var n=f.map((function(n){return n.name===e?Object(k.a)(Object(k.a)({},n),{},{value:t,error:a}):Object(k.a)({},n)}));O(n)},buildParameters:f}),Object(g.jsx)(xn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=f.map((function(e){return{name:e.name,value:e.value}}));""!==n?e.finished({payload_type:n,parameters:t,payload_type_id:o,file_extension:j,os:e.buildOptions}):E.warning("No payload type selected")}})]})}var In=Object(Pe.a)(Cn||(Cn=Object(q.a)(["\nquery GetPayloadDetails($payload_id: Int!, $operation_id: Int!) {\n  payload(where: {id: {_eq: $payload_id}, operation_id: {_eq: $operation_id}}) {\n    uuid\n    wrapped_payload_id\n    payloadtype{\n        ptype\n    }\n    payloadcommands {\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    filemetum {\n      filename_text\n      agent_file_id\n      id\n      md5\n      sha1\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        description\n      }\n    }\n    os\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n  }\n}\n"])));function Tn(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Payload Configuration"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)($n,Object(k.a)({},e))}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function $n(e){var t=Object(T.a)(C),a=Object(xe.a)(),n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState([]),l=Object(u.a)(o,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=Object(Ae.a)(In,{variables:{payload_id:e.payload_id,operation_id:t.user.current_operation_id},onCompleted:function(e){var t=e.payload[0].payloadcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));c(t);var a=e.payload[0].buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));j(a);var n=e.payload[0].c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[].concat(Object(F.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),i=Object.keys(n).reduce((function(e,t){return[].concat(Object(F.a)(e),[{c2_profile:t,parameters:n[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);f(i)}}),x=O.loading,y=O.error,_=O.data;return x?Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}}):y?(console.error(y),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Payload Information"})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Payload Info"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsxs)(R.a,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Payload Type"}),Object(g.jsx)(B.a,{children:_.payload[0].payloadtype.ptype})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Selected OS"}),Object(g.jsx)(B.a,{children:_.payload[0].os})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"UUID"}),Object(g.jsx)(B.a,{children:_.payload[0].uuid})]}),_.payload[0].filemetum?Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Filename"}),Object(g.jsx)(B.a,{children:_.payload[0].filemetum.filename_text})]},"filename_text"):null,Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Download URL"}),Object(g.jsx)(B.a,{children:window.location.origin+"/direct/download/"+_.payload[0].filemetum.agent_file_id})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"SHA1"}),Object(g.jsx)(B.a,{children:_.payload[0].filemetum.sha1})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"MD5"}),Object(g.jsx)(B.a,{children:_.payload[0].filemetum.md5})]})]})]}),Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Build Parameters"})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:d.map((function(t,a){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:t.description}),Object(g.jsx)(B.a,{children:t.value})]},"buildprop"+a+"for"+e.payload_id)}))})]}),h.map((function(t){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:t.c2_profile})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{style:{whiteSpace:"pre"},children:t.parameters.map((function(a,n){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:a.description}),Object(g.jsxs)(B.a,{children:["Dictionary"===a.parameter_type?JSON.stringify(JSON.parse(a.value),null,2):a.value,null===a.enc_key?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Encryption Key: "})," ",a.enc_key]}),null===a.dec_key?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("br",{}),Object(g.jsx)("b",{children:"Decryption Key: "})," ",a.dec_key]})]})]},"c2frag"+e.payload_id+t.c2_profile+n)}))})]})]},"c2frag"+e.payload_id+t.c2_profile)})),r.length>0&&Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Loaded Commands"})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Command Name"}),Object(g.jsx)(B.a,{children:"Mythic Version"}),Object(g.jsx)(B.a,{children:"Loaded Version"}),Object(g.jsx)(B.a,{children:"Documentation"})]})}),Object(g.jsx)(R.a,{children:r.map((function(t){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:t.cmd}),Object(g.jsx)(B.a,{children:t.mythic}),Object(g.jsx)(B.a,{children:t.payload}),Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+_.payload[0].payloadtype.ptype+"/commands/"+t.cmd,children:"Docs"})})]},t.cmd+e.payload_id)}))})]})]}),null!==_.payload[0].wrapped_payload_id&&Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Wrapped Payload Information"})}),Object(g.jsx)($n,{payload_id:_.payload[0].wrapped_payload_id})]})]})}var Pn,An,En=a(180),Ln=a.n(En),Fn=Object(Ge.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}})),qn=Object(Pe.a)(Pn||(Pn=Object(q.a)(['\nquery getWrappablePayloads($payloadType: Int!) {\n  payloadtype_by_pk(id: $payloadType) {\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n        payloads(where: {auto_generated: {_eq: false}, build_phase: {_eq: "success"}, deleted: {_eq: false}}) {\n          id\n          tag\n          uuid\n          creation_time\n          filemetum {\n            agent_file_id\n            filename_text\n            id\n          }\n        }\n      }\n    }\n  }\n}\n '])));function Nn(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(qn,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type_id},onCompleted:function(){if(r.payloadtype_by_pk.wrap_these_payload_types.length>0){for(var e=[],t=0;t<r.payloadtype_by_pk.wrap_these_payload_types.length;t++)for(var a=0;a<r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads.length;a++)e.push(Object(k.a)({ptype:r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.ptype},r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads[a]));i(e)}else E.warning("No supported payload for that wrapper")}}).data;return Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Wrap Agent Into New Payload"})," ",Object(g.jsx)("br",{}),Object(g.jsx)(Rn,{payloadOptions:n,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){void 0!==t.uuid?e.finished(t.uuid):E.error("Can't continue without selecting a payload")}})]})}function Rn(e){Fn();var t=function(t){e.finished(t)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(z.a,{component:H.a,children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"4rem"},children:" Select"}),Object(g.jsx)(B.a,{style:{width:"15rem"},children:"Timestamp"}),Object(g.jsx)(B.a,{children:"File"}),Object(g.jsx)(B.a,{children:"Description"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Details"})]})}),Object(g.jsx)(R.a,{children:e.payloadOptions.map((function(e){return Object(g.jsx)(Bn,{onSelected:t,payload:e},"payload"+e.id)}))})]})}),Object(g.jsx)("div",{style:{paddingTop:"20px"},children:Object(g.jsx)(xn,{disableNext:!0,first:e.first,last:e.last,canceled:e.canceled,finished:t})})]})}function Bn(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(T.a)(C);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{size:"small",onClick:function(){e.onSelected(e.payload)},color:"primary",variant:"contained",children:"Select"})}),Object(g.jsx)(B.a,{children:he(e.payload.creation_time,r.user.view_utc_time)}),Object(g.jsx)(B.a,{children:e.payload.filemetum.filename_text}),Object(g.jsx)(B.a,{children:e.payload.tag}),Object(g.jsx)(B.a,{children:Object(g.jsx)(K.a,{size:"small",color:"primary",onClick:function(){return i(!0)},children:Object(g.jsx)(Ln.a,{})})})]},"payload"+e.payload.uuid),Object(g.jsx)(M.a,{children:n?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(g.jsx)(Tn,Object(k.a)(Object(k.a)({},e),{},{payload_id:e.payload.id,onClose:function(){i(!1)}}))}):null})]})}var zn,Wn=Object(Pe.a)(An||(An=Object(q.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),Mn=Object(Ge.a)((function(e){return{root:Object(Pt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),Hn=s.a.forwardRef((function(e,t){var a=Object(xe.a)(),n=Mn(a),i=Object($.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)($.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ke.a,{style:{backgroundColor:a.palette.success.main},children:[Object(g.jsxs)(nn.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(Q.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(K.a,{"aria-label":"Show more",className:Object(an.default)(n.expand,Object(Pt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(sn.a,{})}),Object(g.jsx)(K.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(cn.a,{})})]})]}),Object(g.jsxs)(G.a,{in:s,timeout:"auto",unmountOnExit:!0,children:[Object(g.jsxs)(H.a,{className:n.collapse,children:[Object(g.jsx)(Q.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(g.jsxs)(b.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(g.jsx)(dn.a,{className:n.checkIcon}),"Download now"]})]}),Object(g.jsx)(H.a,{className:n.collapse,children:Object(g.jsx)(b.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),Un=s.a.forwardRef((function(e,t){var a=Object(xe.a)(),n=Mn(a),i=Object($.c)().closeSnackbar,r=Object(o.useState)(!1),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)($.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ke.a,{style:{backgroundColor:a.palette.error.main},children:[Object(g.jsxs)(nn.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(Q.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(K.a,{"aria-label":"Show more",className:Object(an.default)(n.expand,Object(Pt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(sn.a,{})}),Object(g.jsx)(K.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(cn.a,{})})]})]}),Object(g.jsx)(G.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(g.jsx)(H.a,{className:n.collapse,children:e.display})})]})})}));function Vn(e){var t=s.a.useState((new Date).toISOString()),a=Object(u.a)(t,2),n=a[0],i=(a[1],Object(ct.a)(Wn,{variables:{fromNow:n}})),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){!r&&!c&&l&&l.payload.length>0?"success"===l.payload[0].build_phase?(E.dismiss(),E.success(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(Hn,{id:e,file_id:l.payload[0].filemetum.agent_file_id})}})):"building"===l.payload[0].build_phase?E.info("Building payload ".concat(l.payload[0].uuid,"..."),{autoHideDuration:5e3}):""!==l.payload[0].build_error?E.error(l.payload[0].build_stderr,{persist:!0,content:function(e){return Object(g.jsx)(Un,{id:e,display:l.payload[0].build_stderr})}}):E.error(l.payload[0].build_message,{persist:!0,content:function(e){return Object(g.jsx)(Un,{id:e,display:l.payload[0].build_message})}}):c&&(console.log(c),E.error("Mythic encountered an error: "+c.toString()))}),[r,l,c]),null}var Gn=Object(Pe.a)(zn||(zn=Object(q.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function Kn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(Ee.a)(Gn,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?E.info("Submitted payload to build pipeline"):E.error(a.createPayload.error)}}),j=Object(u.a)(b,1)[0];Object(o.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);return Object(g.jsxs)("div",{children:[Object(g.jsx)(Q.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(g.jsx)("br",{}),Object(g.jsx)(y,{required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(g.jsx)(y,{required:!1,placeholder:"description",value:l,multiline:!1,onChange:function(e,t,a){d(t)},display:"inline-block"}),Object(g.jsx)(xn,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:l,commands:[],build_parameters:t,c2_profiles:[],wrapper:!0,wrapped_payload:e.buildOptions[2]};j({variables:{payload:JSON.stringify(a)}}).catch((function(e){console.log(e)}))}}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)(Vn,{})]})}function Qn(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=function(e){i(Object(k.a)(Object(k.a)({},n),{},Object(Pt.a)({},o,e))),p()},b=function(){m()},j=["Select Target OS","Payload Type","Select Payload","Build"],p=function(){l((function(e){return e+1}))},m=function(){l((function(e){return e-1}))};return Object(g.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(g.jsx)(va.a,{activeStep:o,alternativeLabel:!0,children:j.map((function(e,t){return Object(g.jsx)(ka.a,{children:Object(g.jsx)(wa.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(g.jsx)(vn,{buildOptions:n,prevData:n[0],finished:d,canceled:b,first:!0,last:!1});case 1:return Object(g.jsx)(Dn,{buildOptions:n[0],prevData:n[1],finished:d,canceled:b,first:!1,last:!1});case 2:return Object(g.jsx)(Nn,{buildOptions:n[1],prevData:n[2],finished:d,canceled:b,first:!1,last:!1});case 3:return Object(g.jsx)(Kn,{buildOptions:n,canceled:b,first:!1,last:!0});default:return"Unknown step"}}(o)]})}var Jn=a(881),Yn=a(908),Zn=a(441),Xn=a.n(Zn),ei=a(435),ti=a(880);function ai(e){var t=s.a.useState(null),a=Object(u.a)(t,2),n=a[0],i=a[1],r=function(){c(),e.onUpdateResolution({id:e.id,resolved:!e.resolved})},c=function(){i(null)},o=s.a.useCallback((function(e){i(e.currentTarget)}),[]);return Object(g.jsxs)(ti.a,{children:[Object(g.jsx)(K.a,{"aria-controls":"eventmenu"+e.id,"aria-haspopup":"true",onClick:o,children:Object(g.jsx)(Xn.a,{})}),Object(g.jsxs)(ei.a,{elevation:5,id:"eventmenu"+e.id,anchorEl:n,open:Boolean(n),onClose:c,children:["warning"===e.level&&e.resolved?Object(g.jsx)(xt.a,{onClick:r,children:"Unresolve"}):"warning"!==e.level||e.resolved?Object(g.jsx)(xt.a,{onClick:function(){c(),e.onUpdateLevel({id:e.id})},children:"Make Warning"}):Object(g.jsx)(xt.a,{onClick:r,children:"Resolve"}),Object(g.jsx)(xt.a,{onClick:function(){c(),e.getSurroundingEvents({id:e.id})},children:"Get Surrounding Events"}),Object(g.jsxs)(xt.a,{onClick:function(){c(),e.onUpdateDeleted({id:e.id})},children:[Object(g.jsx)(te.a,{}),"Delete"]})]})]})}var ni=Object(Ge.a)((function(e){return{root:{width:"100%",maxWidth:"36ch"},inline:{display:"inline"}}}));function ii(e){var t=ni(),a=Object(xe.a)(),n=Object(T.a)(C);return Object(g.jsxs)(Na.a,{alignItems:"flex-start",style:Object(k.a)({},e.style),children:[Object(g.jsx)(Jn.a,{children:Object(g.jsx)(Yn.a,{children:e.operator?e.operator.username[0]:"M"})}),Object(g.jsx)(Ba.a,{disableTypography:!0,primary:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Q.a,{component:"span",variant:"body1",className:t.inline,style:{fontWeight:"bold",margin:0,padding:0},children:[e.operator?e.operator.username:"Mythic",e.count>1?" ( "+e.count+" )":""]}),Object(g.jsx)(Q.a,{component:"span",variant:"caption",className:t.inline,style:{margin:"0 0 0 10px"},children:he(e.timestamp,n.user.view_utc_time)})]}),secondary:Object(g.jsx)("pre",{style:{overflowX:"auto",width:"max-content",maxWidth:"97%",margin:"0 0 0 0",borderRadius:"9px",padding:"5px",backgroundColor:"warning"===e.level&&e.resolved?a.palette.textBackgroundColorSuccess:"warning"!==e.level||e.resolved?e.operator?a.palette.textBackgroundColor:a.palette.textBackgroundColorMythic:a.palette.textBackgroundColorError},children:e.message}),style:{}}),Object(g.jsx)(ai,{id:e.id,level:e.level,onUpdateDeleted:e.onUpdateDeleted,onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,getSurroundingEvents:e.getSurroundingEvents,resolved:e.resolved})]})}var ri=a(265),ci=a.n(ri);function oi(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=function(t){t.preventDefault(),n&&n.length>0&&(e.onSubmitMessage(n),i(""))};return Object(g.jsx)("div",{style:{padding:"0",margin:"0",position:"absolute",bottom:0,width:"100%"},children:Object(g.jsx)("form",{onSubmit:r,children:Object(g.jsx)(f.a,{InputProps:{endAdornment:Object(g.jsx)(K.a,{color:"primary",variant:"contained",onClick:r,children:Object(g.jsx)(ci.a,{})})},fullWidth:!0,size:"small",style:{padding:0,margin:0},variant:"outlined",value:n,onChange:function(e){e.preventDefault(),i(e.target.value)},label:"Type Message..."})})})}var si,li,di,ui,bi,ji,pi,mi,hi,fi,Oi=a(190),gi=a(181),xi=function(e){var t=e.data,a=e.index,n=e.style,i=t[t.length-a-1];return Object(g.jsx)("div",{style:n,children:Object(g.jsx)(ii,Object(k.a)({},i))})},yi=function(e){var t=e.onUpdateDeleted,a=e.onUpdateLevel,n=e.onUpdateResolution,i=e.getSurroundingEvents,r=e.operationeventlog,c=s.a.createRef(),l=function(e){return 75+20*(r[r.length-e-1].message.match(/\n/g)||[]).length},d=r.map((function(e){return Object(k.a)({onUpdateDeleted:t,onUpdateLevel:a,onUpdateResolution:n,getSurroundingEvents:i},e)}));return Object(o.useEffect)((function(){c.current&&c.current.resetAfterIndex(0)}),[r]),Object(g.jsx)(gi.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(Oi.b,{ref:c,height:t-50,itemData:d,itemCount:r.length,width:a,itemSize:l,overscanCount:20,children:xi})}})};function _i(e){var t=Object(o.useRef)(null),a=Object(xe.a)(),n=function(){t.current.scrollIntoView({behavior:"smooth"})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operational Event Messages"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.loadMore()},children:"Load More Events"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.loadNextError()},children:"Load All Errors"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.resolveViewableErrors()},children:"Resolve Viewable Errors"}),Object(g.jsx)(b.a,{variant:"contained",color:"secondary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(t){t.stopPropagation(),e.resolveAllErrors()},children:"Resolve All Errors"})]}),Object(g.jsxs)(H.a,{elevation:5,style:{position:"relative",height:"calc(90vh)",backgroundColor:a.body},variant:"elevation",children:[Object(g.jsx)(yi,{onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,onUpdateDeleted:e.onUpdateDeleted,getSurroundingEvents:e.getSurroundingEvents,operationeventlog:e.operationeventlog}),Object(g.jsx)("div",{ref:t}),Object(g.jsx)(oi,{onSubmitMessage:function(t){t&&t.length>0&&(e.onSubmitMessage({level:"info",message:t}),n())}})]})]})}var vi=Object(Pe.a)(si||(si=Object(q.a)(["\nquery GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),ki=Object(Pe.a)(li||(li=Object(q.a)(["\nsubscription GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),wi=Object(Pe.a)(di||(di=Object(q.a)(["\nquery GetSurroundingOperationEventLogs($operation_id: Int!, $lower_id: Int!, $upper_id: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, id: {_gt: $lower_id, _lt: $upper_id}}, order_by: {id: desc}) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),Ci=Object(Pe.a)(ui||(ui=Object(q.a)(["\nmutation CreateOperationEventLog($message: String!, $level: String!) {\n  insert_operationeventlog_one(object:{level: $level, message: $message}) {\n    id\n  }\n}\n "]))),Si=Object(Pe.a)(bi||(bi=Object(q.a)(['\n query GetOperationEventLogError($operation_id: Int!) {\n   operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}}, order_by: {id: desc}) {\n     id\n     level\n     message\n     resolved\n     timestamp\n     count\n     operator {\n       id\n       username\n     }\n   }\n }\n  ']))),Di=Object(Pe.a)(ji||(ji=Object(q.a)(["\nmutation UpdateDeletedOperationEventLog($id: Int!) {\n  update_operationeventlog(where:{id: {_eq: $id}}, _set: {deleted: true}) {\n    returning{\n        id\n        deleted\n    }\n  }\n}\n "]))),Ii=Object(Pe.a)(pi||(pi=Object(q.a)(["\nmutation UpdateResolutionOperationEventLog($id: Int!, $resolved: Boolean!) {\n  update_operationeventlog_by_pk(pk_columns:{id: $id}, _set: {resolved: $resolved}) {\n    id\n    resolved\n  }\n}\n "]))),Ti=Object(Pe.a)(mi||(mi=Object(q.a)(['\nmutation UpdateLevelOperationEventLog($id: Int!) {\n  update_operationeventlog_by_pk(pk_columns: {id: $id}, _set: {level: "warning"}) {\n    id\n    level\n  }\n}\n ']))),$i=Object(Pe.a)(hi||(hi=Object(q.a)(["\n mutation UpdateResolveViewableErrorsOperationEventLog($ids: [Int]!) {\n   update_operationeventlog(where:{id: {_in: $ids}}, _set: {resolved: true}) {\n     returning{\n         id\n         resolved\n     }\n   }\n }\n  "]))),Pi=Object(Pe.a)(fi||(fi=Object(q.a)(["\n  mutation UpdateResolveAllErrorsOperationEventLog($operation_id: Int!) {\n    update_operationeventlog(where: {resolved: {_eq: false}, operation_id: {_eq: $operation_id}}, _set: {resolved: true}) {\n      returning{\n          id\n          resolved\n      }\n    }\n  }\n   "])));function Ai(e){var t=Object(T.a)(C),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(0),o=Object(u.a)(c,2),l=o[0],d=o[1];Object(ct.a)(ki,{variables:{operation_id:t.user.current_operation_id,offset:0,eventQuerySize:100},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;0===l&&d(t.data.operationeventlog.length);var a=t.data.operationeventlog.reduce((function(e,t){if(e.find((function(e){return e.id===t.id}))){var a=e.findIndex((function(e){return e.id===t.id})),n=Object(F.a)(e);return n[a]=t,Object(F.a)(n)}return[].concat(Object(F.a)(e),[t])}),Object(F.a)(i));a.sort((function(e,t){return e.id>t.id?-1:t.id>e.id?1:0})),r(a)}});var b=Object(At.a)(vi,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(E.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(F.a)(e):[].concat(Object(F.a)(e),[t])}),Object(F.a)(i));d(l+100),r(t),E.success("Successfully fetched more events")}else E.info("No more events")}}),j=Object(u.a)(b,1)[0],p=Object(At.a)(wi,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){E.dismiss();var t=!1,a=e.operationeventlog.reduce((function(e,a){return e.find((function(e){return e.id===a.id}))?Object(F.a)(e):(t=!0,[].concat(Object(F.a)(e),[a]))}),Object(F.a)(i));r(a),t?E.success("Successfully fetched surrounding events"):E.info("No additional surrounding events")}}),m=Object(u.a)(p,1)[0],h=Object(At.a)(Si,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(E.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(F.a)(e):[].concat(Object(F.a)(e),[t])}),Object(F.a)(i));r(t),E.success("Successfully fetched more errors")}else E.info("No more events")}}),f=Object(u.a)(h,1)[0],O=Object(Ee.a)(Ci),x=Object(u.a)(O,1)[0],y=Object(Ee.a)(Di,{update:function(e,t){var a=t.data.update_operationeventlog.returning[0],n=i.filter((function(e){return e.id!==a.id}));r(n),E.success("Successfully deleted event log")}}),_=Object(u.a)(y,1)[0],v=Object(Ee.a)(Ii,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(k.a)(Object(k.a)({},e),{},{resolved:a.resolved}):e}));r(n)}}),w=Object(u.a)(v,1)[0],S=Object(Ee.a)(Ti,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(k.a)(Object(k.a)({},e),{},{level:a.level}):e}));r(n)}}),D=Object(u.a)(S,1)[0],I=Object(Ee.a)($i,{update:function(e,t){var a=t.data;if(E.dismiss(),a.update_operationeventlog.returning.length>0){E.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),c=i.map((function(e){return n.includes(e.id)?Object(k.a)(Object(k.a)({},e),{},{resolved:!0}):Object(k.a)({},e)}));r(c)}else E.info("No Viewable Errors to Resolve")}}),$=Object(u.a)(I,1)[0],P=Object(Ee.a)(Pi,{update:function(e,t){var a=t.data;if(E.dismiss(),a.update_operationeventlog.returning.length>0){E.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),c=i.map((function(e){return n.includes(e.id)?Object(k.a)(Object(k.a)({},e),{},{resolved:!0}):Object(k.a)({},e)}));r(c)}else E.info("No Errors to Resolve")}}),A=Object(u.a)(P,1)[0];return Object(g.jsx)(_i,{onSubmitMessage:function(e){var t=e.level,a=e.message;x({variables:{level:t,message:a}})},operationeventlog:i,loadMore:function(){E.info("Loading more events..."),j({variables:{operation_id:t.user.current_operation_id,offset:l,eventQuerySize:100}})},loadNextError:function(){E.info("Loading more errors..."),f({variables:{operation_id:t.user.current_operation_id}})},onUpdateDeleted:function(e){var t=e.id;E.info("Deleting event log..."),_({variables:{id:t}})},onUpdateResolution:function(e){var t=e.id,a=e.resolved;w({variables:{id:t,resolved:a}})},onUpdateLevel:function(e){var t=e.id;D({variables:{id:t}})},getSurroundingEvents:function(e){var a=e.id;E.info("Loading surrounding events..."),m({variables:{lower_id:a-5,upper_id:a+5,operation_id:t.user.current_operation_id}})},resolveViewableErrors:function(){E.info("Resolving Errors...");var e=i.reduce((function(e,t){return"warning"!==t.level||t.resolved?Object(F.a)(e):[].concat(Object(F.a)(e),[t.id])}),[]);$({variables:{ids:e}})},resolveAllErrors:function(){E.info("Resolving Errors..."),A({variables:{operation_id:t.user.current_operation_id}})}})}var Ei,Li,Fi,qi,Ni,Ri=a(64),Bi=a.n(Ri);function zi(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState("operator"),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState({}),j=Object(u.a)(b,2),p=j[0],m=j[1],h=Object(o.useRef)(null);Object(o.useEffect)((function(){i(e.operator.checked),d(e.operator.view_mode),console.log(e.operator),e.operator.disabledcommandsprofile?m(e.operator.disabledcommandsprofile.name):m("")}),[e.operator]);return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:n,onChange:function(t){i(t.target.checked),e.updateOperator(Object(k.a)(Object(k.a)({},e.operator),{},{checked:t.target.checked,view_mode:l}))},color:"secondary"})}),Object(g.jsx)(B.a,{children:e.operator.username}),Object(g.jsx)(B.a,{children:n?Object(g.jsxs)(Et.a,{style:{width:"100%"},children:[Object(g.jsx)(Jt.a,{ref:h,children:"Options"}),Object(g.jsx)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:l,onChange:function(t){d(t.target.value),e.updateOperator(Object(k.a)(Object(k.a)({},e.operator),{},{checked:n,view_mode:t.target.value}))},input:Object(g.jsx)(qt.a,{style:{width:"100%"}}),children:["operator","spectator","lead"].map((function(e){return Object(g.jsx)(xt.a,{value:e,children:e},e)}))})]}):null}),Object(g.jsx)(B.a,{children:n?Object(g.jsxs)(Et.a,{style:{width:"100%"},children:[Object(g.jsx)(Jt.a,{ref:h,children:"Block List Options"}),Object(g.jsxs)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:p,onChange:function(t){m(t.target.value);var a=e.commandBlockLists.findIndex((function(e){return e.name===t.target.value}));a>-1?e.updateOperator(Object(k.a)(Object(k.a)({},e.operator),{},{checked:n,disabledcommandsprofile:e.commandBlockLists[a]})):e.updateOperator(Object(k.a)(Object(k.a)({},e.operator),{},{checked:n,disabledcommandsprofile:null}))},input:Object(g.jsx)(qt.a,{style:{width:"100%"}}),children:[Object(g.jsx)(xt.a,{value:-1,children:"None"},"None"),e.commandBlockLists.map((function(t){return Object(g.jsx)(xt.a,{value:t.name,children:t.name},e.operator.username+t.name)}))]})]}):null})]})})}var Wi=Object(Pe.a)(Ei||(Ei=Object(q.a)(["\nquery GetOperation($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      disabledcommandsprofile {\n        name\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n  disabledcommandsprofile(where: {operation_id: {_eq: $operation_id}}, distinct_on: name, order_by: {name: asc}) {\n    name\n    id\n  }\n}\n"]))),Mi=Object(Pe.a)(Li||(Li=Object(q.a)(["\nmutation updateLeadMutation($operation_id: Int!, $admin_id: Int!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {admin_id: $admin_id}) {\n    admin {\n      id\n      username\n    }\n    id\n  }\n}\n"]))),Hi=Object(Pe.a)(Fi||(Fi=Object(q.a)(["\nmutation updateOperatorViewMode($operatoroperation_id: Int!, $view_mode: String!, $disabledcommandsprofile: Int) {\n  update_operatoroperation_by_pk(pk_columns: {id: $operatoroperation_id}, _set: {view_mode: $view_mode, base_disabled_commands_id: $disabledcommandsprofile}) {\n    id\n    view_mode\n  }\n}"]))),Ui=Object(Pe.a)(qi||(qi=Object(q.a)(["\nmutation removeOperatorsFromOperation($operatoroperation_ids: [Int!]!) {\n  delete_operatoroperation(where: {id: {_in: $operatoroperation_ids}}) {\n    returning {\n      id\n    }\n  }\n}"]))),Vi=Object(Pe.a)(Ni||(Ni=Object(q.a)(["\nmutation addNewOperators($operators: [operatoroperation_insert_input!]!) {\n  insert_operatoroperation(objects: $operators) {\n    returning {\n      id\n    }\n  }\n}"])));function Gi(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState({}),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState([]),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState([]),f=Object(u.a)(h,2),O=f[0],x=f[1];Object(Ae.a)(Wi,{variables:{operation_id:e.id},fetchPolicy:"network-only",onCompleted:function(e){var t=e.operator.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{checked:!1})}));m(e.operation_by_pk.operatoroperations),l(e.operation_by_pk.admin);var a=t.map((function(t){var a=e.operation_by_pk.operatoroperations.find((function(e){return e.operator.id===t.id}));return a?a.operator.id===e.operation_by_pk.admin.id?Object(k.a)(Object(k.a)({},t),{},{checked:!0,view_mode:"lead",operatoroperation_id:a.id,disabledcommandsprofile:a.disabledcommandsprofile}):Object(k.a)(Object(k.a)({},t),{},{checked:!0,view_mode:a.view_mode,operatoroperation_id:a.id,disabledcommandsprofile:a.disabledcommandsprofile}):Object(k.a)(Object(k.a)({},t),{},{view_mode:"operator"})}));a.sort((function(e,t){return e.username>t.username?1:-1})),i(a);var n=Object(F.a)(e.disabledcommandsprofile);x(n)},onError:function(e){E.error("Failed to get operational data"),console.error(e)}});var y=Object(Ee.a)(Mi,{onCompleted:function(e){E.success("Successfully updated Lead")},onError:function(e){E.error("Failed to update operation"),console.log("error updating operation",e)}}),_=Object(u.a)(y,1)[0],v=Object(Ee.a)(Vi,{onCompleted:function(e){E.success("Sucessfully added operators")},onError:function(e){E.error("Failed to add operators"),console.error("error adding operators to operation",e)}}),w=Object(u.a)(v,1)[0],C=Object(Ee.a)(Ui,{onCompleted:function(e){E.success("Sucessfully removed operators")},onError:function(e){E.error("Failed to remove operators"),console.error("error removing operators from operation",e)}}),S=Object(u.a)(C,1)[0],D=Object(Ee.a)(Hi,{onCompleted:function(e){E.success("Successfully updated operator view mode")},onError:function(e){E.error("Failed to update operator view mode"),console.error("failed to update view mode: ",e)}}),I=Object(u.a)(D,1)[0],T=function(e){var t=Object(F.a)(n);"lead"===e.view_mode&&(t=t.map((function(e){return"lead"===e.view_mode?Object(k.a)(Object(k.a)({},e),{},{view_mode:"operator"}):Object(k.a)({},e)}))),t=t.map((function(t){return t.id===e.id?Object(k.a)({},e):Object(k.a)({},t)})),i(t)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Modify Operator Assignments"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"8rem"},children:"Assign to Operation"}),Object(g.jsx)(B.a,{style:{width:"8rem"},children:"Operator"}),Object(g.jsx)(B.a,{style:{width:"10rem"},children:"Role"}),Object(g.jsx)(B.a,{children:"Block List"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(zi,{operator:e,updateOperator:T,commandBlockLists:O},"operator"+e.id)}))})]})})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){var t=n.find((function(e){return"lead"===e.view_mode}));if(t){t.id!==o.id&&_({variables:{operation_id:e.id,admin_id:t.id}});var a=[],i=[];n.forEach((function(t){var n=p.find((function(e){return e.operator.id===t.id}));n?t.checked?t.view_mode===n.view_mode&&t.disabledcommandsprofile===n.disabledcommandsprofile||I({variables:{operatoroperation_id:n.id,view_mode:t.view_mode,disabledcommandsprofile:t.disabledcommandsprofile?t.disabledcommandsprofile.id:null}}):i.push(n.id):t.checked&&a.push({operation_id:e.id,operator_id:t.id,view_mode:t.view_mode})})),a.length>0&&w({variables:{operators:a}}),i.length>0&&S({variables:{operatoroperation_ids:i}}),e.onClose()}else E.error("No Lead for the operation is set")},variant:"contained",color:"secondary",children:"Update"})]})]})}var Ki,Qi,Ji=a(443),Yi=a.n(Ji),Zi=a(266),Xi=a.n(Zi),er=a(442),tr=a.n(er),ar=Object(Pe.a)(Ki||(Ki=Object(q.a)(["\nquery GetOperations($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    name\n    id\n    channel\n    display_name\n    icon_emoji\n    icon_url\n    webhook\n    webhook_message\n    complete\n  }\n}\n"])));function nr(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState(""),f=Object(u.a)(h,2),O=f[0],x=f[1],_=s.a.useState(""),v=Object(u.a)(_,2),k=v[0],w=v[1],C=s.a.useState(""),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useState(""),$=Object(u.a)(T,2),P=$[0],A=$[1],L=s.a.useState(!1),F=Object(u.a)(L,2),q=F[0],N=F[1];Object(Ae.a)(ar,{fetchPolicy:"no-cache",variables:{operation_id:e.id},onCompleted:function(e){var t=e.operation_by_pk.webhook_message;try{t=JSON.stringify(JSON.parse(t),null,4)}catch(a){}i(e.operation_by_pk.name),l(e.operation_by_pk.channel),m(e.operation_by_pk.display_name),x(e.operation_by_pk.icon_emoji),w(e.operation_by_pk.icon_url),I(e.operation_by_pk.webhook),A(t),N(e.operation_by_pk.complete)},onError:function(){E.error("Failed to fetch data")}});var R=function(e,t,a){switch(e){case"name":i(t);break;case"Webhook Channel":l(t);break;case"Webhook Display Name":m(t);break;case"Webhook Icon Emoji":x(t);break;case"Webhook Icon URL":w(t);break;case"Webhook URL":I(t);break;case"Webhook POST Message":A(t)}};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:["Modify ",n]}),Object(g.jsxs)(ce.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:[Object(g.jsx)(oe.a,{children:"Use this dialog to update some information about an operation."}),Object(g.jsx)(y,{autoFocus:!0,value:n,onChange:R,margin:"dense",name:"name"}),"Complete Operation? ",Object(g.jsx)(U.a,{checked:q,onChange:function(e){N(e.target.checked)},color:"secondary"}),Object(g.jsx)(y,{margin:"dense",value:o,onChange:R,name:"Webhook Channel"}),Object(g.jsx)(y,{margin:"dense",value:p,onChange:R,name:"Webhook Display Name"}),Object(g.jsx)(y,{margin:"dense",value:O,onChange:R,name:"Webhook Icon Emoji"}),Object(g.jsx)(y,{margin:"dense",value:k,onChange:R,name:"Webhook Icon URL"}),Object(g.jsx)(y,{margin:"dense",value:D,onChange:R,name:"Webhook URL"}),Object(g.jsx)(Ct.a,{mode:"json",theme:"monokai",onChange:function(e,t){A(e)},fontSize:14,showGutter:!0,maxLines:20,highlightActiveLine:!0,value:P,width:"100%",setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(g.jsx)(b.a,{onClick:function(){e.onUpdateOperation({operation_id:e.id,name:n,channel:o,display_name:p,icon_emoji:O,icon_url:k,webhook:D,webhook_message:P,complete:q}),e.onClose()},variant:"contained",color:"secondary",children:"Update"})]})]})}var ir,rr,cr,or=Object(Pe.a)(Qi||(Qi=Object(q.a)(["\nmutation updateCurrentOpertionMutation($operator_id: Int!, $operation_id: Int!) {\n  updateCurrentOperation(user_id: $operator_id, operation_id: $operation_id) {\n    status\n    error\n    operation_id\n  }\n}\n"])));function sr(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=Object(T.a)(C),f=Object(Ee.a)(or,{onCompleted:function(e){"success"===e.updateCurrentOperation.status?(C(Object(k.a)(Object(k.a)({},C),{},{user:Object(k.a)(Object(k.a)({},C.user),{},{current_operation_id:e.updateCurrentOperation.operation_id,current_operation_name:e.updateCurrentOperation.operation_name})})),E.success("Updated current operation")):E.error(e.updateCurrentOperation.error)},onError:function(e){E.error("Failed to update current operation"),console.error(e)}}),O=Object(u.a)(f,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){i(!0)},startIcon:Object(g.jsx)(Bi.a,{}),color:e.complete?"secondary":"primary",variant:"contained",children:"Edit"}),n&&Object(g.jsx)(be,{open:n,fullWidth:!0,maxWidth:"lg",onClose:function(){i(!1)},innerDialog:Object(g.jsx)(nr,{onClose:function(){i(!1)},id:e.id,onUpdateOperation:e.onUpdateOperation})})]}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){l(!0)},startIcon:Object(g.jsx)(tr.a,{}),color:e.complete?"secondary":"primary",variant:"contained",children:"Edit"}),o&&Object(g.jsx)(be,{open:o,maxHeight:"calc(80vh)",fullWidth:!0,maxWidth:"md",onClose:function(){l(!1)},innerDialog:Object(g.jsx)(Gi,{id:e.id,onClose:function(){l(!1)}})})]}),Object(g.jsxs)(B.a,{children:[e.name," ",e.complete?" (Completed) ":""]}),Object(g.jsx)(B.a,{children:e.admin.username}),Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{size:"small",startIcon:Object(g.jsx)(Xi.a,{}),onClick:function(){E.warning("Not Implemented")},color:"primary",variant:"contained",children:"Analysis"})}),Object(g.jsx)(B.a,{children:e.id===h.user.current_operation_id?"Current Operation":Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{size:"small",startIcon:Object(g.jsx)(Yi.a,{}),onClick:function(){m(!0)},color:"primary",variant:"contained",children:"Make Current"}),p&&Object(g.jsx)(La,{onClose:function(){m(!1)},onSubmit:function(){O({variables:{operator_id:h.user.user_id,operation_id:e.id}})},open:p,title:"Change Current Operation?",acceptText:"Update",dialogText:"Changing operations will force you to log in again"})]})})]},e.id)})}var lr,dr=Object(Pe.a)(ir||(ir=Object(q.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    error\n    id\n    status\n  }\n}\n"]))),ur=Object(Pe.a)(rr||(rr=Object(q.a)(["\nmutation MyMutation($operation_id: Int!, $channel: String!, $complete: Boolean!, $display_name: String!, $icon_emoji: String!, $icon_url: String!, $name: String!, $webhook: String!, $webhook_message: String!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {channel: $channel, complete: $complete, display_name: $display_name, icon_emoji: $icon_emoji, icon_url: $icon_url, name: $name, webhook: $webhook, webhook_message: $webhook_message}) {\n    id\n    name\n    complete\n  }\n}\n"]))),br=Object(Pe.a)(cr||(cr=Object(q.a)(["\nmutation newOperationMutation{\n    createOperation{\n        status\n        error\n        operation{\n            name\n            id\n            admin {\n                id\n                username\n            }\n        }\n        \n    }\n}\n"])));function jr(e){var t=Object(xe.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(Ee.a)(dr,{update:function(e,t){var a=t.data;"success"===a.createOperator.status?E.success("Created operator"):E.error(a.createOperator.error)},onError:function(e){E.warning("Unable to create new operator"),console.log(e)}}),o=Object(u.a)(c,1)[0],l=Object(Ee.a)(ur,{onCompleted:function(t){e.onUpdateOperation(t.update_operation_by_pk),E.success("Successfully updated operation")},onError:function(e){E.error("Failed to update operation"),console.log("error updating operation",e)}}),d=Object(u.a)(l,1)[0],j=Object(Ee.a)(br,{onCompleted:function(t){console.log(t),"success"===t.createOperation.status?(E.success("Successfully created operation!"),e.onNewOperation(t.createOperation.operation)):E.error(t.createOperation.error)},onError:function(e){console.log(e)}}),p=Object(u.a)(j,1)[0],m=function(e){var t=e.operation_id,a=e.name,n=e.channel,i=e.display_name,r=e.icon_emoji,c=e.icon_url,o=e.webhook,s=e.webhook_message,l=e.complete;d({variables:{operation_id:t,name:a,channel:n,display_name:i,icon_emoji:r,icon_url:c,webhook:o,webhook_message:s,complete:l}})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operations"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){p()},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"New Operation"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"New Operator"}),i&&Object(g.jsx)(be,{open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(le,Object(k.a)({title:"New Operator",onAccept:function(e,t,a,n){a!==n?E.error("Passwords don't match"):0===n.length?E.error("Password must not be empty"):0===t.length?E.error("Username must not be empty"):(o({variables:{username:t,password:n}}),r(!1))},handleClose:function(){r(!1)}},e))})]}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"8rem"},children:"Configure"}),Object(g.jsx)(B.a,{style:{width:"8rem"},children:"Operators"}),Object(g.jsx)(B.a,{children:"Operation Name"}),Object(g.jsx)(B.a,{children:"Operation Admin"}),Object(g.jsx)(B.a,{style:{width:"10rem"},children:"Analysis"}),Object(g.jsx)(B.a,{style:{width:"12rem"},children:"Operation Status"})]})}),Object(g.jsx)(R.a,{children:e.operations.map((function(t){return Object(g.jsx)(sr,Object(k.a)(Object(k.a)({onUpdateOperation:m},t),{},{operator:e.operator}),"operation"+t.id)}))})]})})]})}var pr=Object(Ge.a)((function(e){return{root:{margin:"auto"},paper:{overflow:"auto",backgroundColor:"rgb(76,80,86) !important"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}}));function mr(e){var t=pr(),a=Object(xe.a)(),n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState([]),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState(""),y=Object(u.a)(x,2),_=y[0],v=y[1],k=s.a.useState(""),w=Object(u.a)(k,2),C=w[0],S=w[1],D=$(r,j),I=$(r,f);function T(t,a){return e.itemKey?t.filter((function(t){return void 0===a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1===a.indexOf(e)}))}function $(t,a){return e.itemKey?t.filter((function(t){return void 0!==a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1!==a.indexOf(e)}))}var P=function(t){return function(){var a=-1;a=e.itemKey?r.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):r.indexOf(t);var n=Object(F.a)(r);-1===a?n.push(t):n.splice(a,1),c(n)}};Object(o.useEffect)((function(){var t=e.left.reduce((function(t,a){return void 0===e.itemKey?e.right.includes(a)?Object(F.a)(t):[].concat(Object(F.a)(t),[a]):e.right.find((function(t){return t[e.itemKey]===a[e.itemKey]}))?Object(F.a)(t):[].concat(Object(F.a)(t),[a])}),[]);p(t),O(e.right),v(e.leftTitle),S(e.rightTitle)}),[e.left,e.right,e.leftTitle,e.rightTitle,e.itemKey]),Object(o.useEffect)((function(){e.onChange({selected:f,ptype:e.ptype})}),[f]);var A=function(a,n){return Object(g.jsx)(H.a,{style:{width:"100%"},children:Object(g.jsxs)(Ke.a,{children:[Object(g.jsx)(Wa.a,{className:t.paper,title:a}),Object(g.jsx)(Ma.a,{classes:{root:t.divider}}),Object(g.jsx)(Je.a,{style:{height:"calc(30vh)",overflow:"auto"},className:t.paper,children:Object(g.jsx)(qa.a,{dense:!0,component:"div",role:"list",style:{padding:0},className:t.paper,children:n.map((function(t){var a=void 0===e.itemKey?t:t[e.itemKey],n="transfer-list-item-".concat(a,"-label");return Object(g.jsxs)(Na.a,{style:{padding:0},role:"listitem",button:!0,onClick:P(t),children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(za.a,{checked:void 0===e.itemKey?-1!==r.indexOf(a):-1!==r.findIndex((function(t){return t[e.itemKey]===a})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(g.jsx)(Ba.a,{id:n,primary:a})]},a)}))})})]})})};return Object(g.jsxs)(Ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(g.jsx)(Ft.a,{item:!0,xs:12,children:Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:e.ptype})})}),Object(g.jsx)(Ft.a,{item:!0,xs:5,children:A(_,j)}),Object(g.jsx)(Ft.a,{item:!0,children:Object(g.jsxs)(Ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){O(f.concat(j)),p([])},disabled:0===j.length,"aria-label":"move all right",children:"\u226b"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){O(f.concat(D)),p(T(j,D)),c(T(r,D))},disabled:0===D.length,"aria-label":"move selected right",children:">"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){p(j.concat(I)),O(T(f,I)),c(T(r,I))},disabled:0===I.length,"aria-label":"move selected left",children:"<"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){p(j.concat(f)),O([])},disabled:0===f.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(g.jsx)(Ft.a,{item:!0,xs:5,children:A(C,f)})]})}var hr=s.a.memo(mr),fr=Object(Pe.a)(lr||(lr=Object(q.a)(["\n  query getPayloadTypesAndCommands{\n    payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n      commands(order_by: {cmd: asc}) {\n        cmd\n        id\n      }\n      id\n      ptype\n    }\n  }\n"])));function Or(e){var t=e.dialogTitle,a=e.onSubmit,n=e.blockListName,i=e.onClose,r=e.currentSelected,c=e.editable,o=s.a.useState([]),l=Object(u.a)(o,2),d=l[0],j=l[1],p=s.a.useState({}),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState(""),x=Object(u.a)(O,2),_=x[0],v=x[1];Object(Ae.a)(fr,{fetchPolicy:"network-only",onCompleted:function(e){n&&v(n);var t=e.payloadtype.map((function(e){var t=[];return void 0!==r[e.ptype]&&(t=Object(F.a)(r[e.ptype])),Object(k.a)(Object(k.a)({},e),{},{selected:t})}));j(t),f(Object(k.a)({},r))},onError:function(e){}});var w=s.a.useCallback((function(e){var t=e.selected,a=e.ptype;f(Object(k.a)(Object(k.a)({},h),{},Object(Pt.a)({},a,t)))}),[h]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:t}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(y,{disabled:!c,onChange:function(e,t,a){v(t)},value:_,name:"Block List Name",autoFocus:!0,requiredValue:!0}),d.map((function(e){return Object(g.jsx)(hr,{leftTitle:"Not Blocked",onChange:w,rightTitle:"Blocked Commands",itemKey:"cmd",right:e.selected,left:e.commands,ptype:e.ptype},e.ptype)}))]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:i,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){if(""!==_.trim()){for(var e=[],t=[],n=0,c=Object.values(h);n<c.length;n++)for(var o=c[n],s=0;s<o.length;s++)e.push({command_id:o[s].id,name:_.trim()});for(var l=function(){for(var a=u[d],n=function(n){var i=e.findIndex((function(e){return e.command_id===a[n].id}));i>-1?e.splice(i,1):t.push({command_id:a[n].id,name:_.trim()})},i=0;i<a.length;i++)n(i)},d=0,u=Object.values(r);d<u.length;d++)l();a({toAdd:e,toRemove:t}),i()}else E.warning("Must supply a block list name")},variant:"contained",color:"secondary",children:"Submit"})]})]})}var gr,xr,yr,_r,vr,kr=a(267),wr=a.n(kr),Cr=Object(Pe.a)(gr||(gr=Object(q.a)(["\nmutation newBlockListsEntries($entries: [disabledcommandsprofile_insert_input!]!) {\n    insert_disabledcommandsprofile(objects: $entries) {\n        returning {\n            id\n            name\n            command{\n              id\n              cmd\n              payloadtype{\n                ptype\n              }\n            }\n        }\n    }\n}\n"]))),Sr=Object(Pe.a)(xr||(xr=Object(q.a)(["\nmutation deleteEntireBlockList($name: String!){\n    deleteBlockList(name: $name){\n        status\n        error\n        name\n    }\n}\n"]))),Dr=Object(Pe.a)(yr||(yr=Object(q.a)(["\nmutation deleteBlockListEntries($name: String!, $entries: [Int!]!){\n    deleteBlockListEntry(name: $name, entries: $entries){\n        status\n        error\n        name\n        deleted_ids\n    }\n}\n"])));function Ir(e){var t=Object(xe.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=Object(Ee.a)(Cr,{onCompleted:function(e){var t=e.insert_disabledcommandsprofile.returning.reduce((function(e,t){return void 0===e[t.command.payloadtype.ptype]&&(e[t.command.payloadtype.ptype]=[]),e[t.command.payloadtype.ptype].push(t),Object(k.a)({},e)}),{}),a=Object(F.a)(l),n=!1,i=a.map((function(a){if(a.name===e.insert_disabledcommandsprofile.returning[0].name){n=!0;for(var i={},r=0,c=Object.entries(t);r<c.length;r++){var o=Object(u.a)(c[r],2),s=o[0],l=o[1];void 0===i[s]?i[s]=Object(F.a)(l):i[s]=[].concat(Object(F.a)(i[s]),Object(F.a)(l))}for(var d=0,b=Object.entries(a.entries);d<b.length;d++){var j=Object(u.a)(b[d],2),p=j[0],m=j[1];void 0===i[p]?i[p]=Object(F.a)(m):i[p]=[].concat(Object(F.a)(i[p]),Object(F.a)(m))}return Object(k.a)(Object(k.a)({},a),{},{entries:i})}return Object(k.a)({},a)}));d(n?Object(F.a)(i):[].concat(Object(F.a)(i),[{name:e.insert_disabledcommandsprofile.returning[0].name,entries:t}]))},onError:function(e){E.warning("Unable to create new block lists"),console.log(e)}}),p=Object(u.a)(j,1)[0],m=Object(Ee.a)(Sr,{onCompleted:function(e){if("success"===e.deleteBlockList.status){var t=l.filter((function(t){return t.name!==e.deleteBlockList.name}));d(t),E.success("Successfully deleted block list")}else E.error(e.deleteBlockList.error)},onError:function(e){E.warning("Unable to delete block list"),console.log(e)}}),h=Object(u.a)(m,1)[0],f=Object(Ee.a)(Dr,{onCompleted:function(e){if("success"===e.deleteBlockListEntry.status){E.success("Successfully deleted block list");var t=Object(F.a)(l).map((function(t){if(t.name===e.deleteBlockListEntry.name){for(var a={},n=0,i=Object.entries(t.entries);n<i.length;n++){var r=Object(u.a)(i[n],2),c=r[0],o=r[1].filter((function(t){return!e.deleteBlockListEntry.deleted_ids.includes(t.id)}));a[c]=o}return Object(k.a)(Object(k.a)({},t),{},{entries:a})}return Object(k.a)({},t)}));d(Object(F.a)(t))}else E.error(e.deleteBlockListEntry.error)},onError:function(e){E.warning("Unable to delete block list"),console.log(e)}}),O=Object(u.a)(f,1)[0];s.a.useEffect((function(){d(e.blockLists)}),[e.blockLists]);var x=function(e){var t=e.toAdd,a=e.toRemove;t.length>0&&p({variables:{entries:t}});var n=a.map((function(e){return e.command_id}));n.length>0&&O({variables:{entries:n,name:a[0].name}})},y=function(e){var t=e.name;h({variables:{name:t}})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Command Block Lists"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"New Block List"}),i&&Object(g.jsx)(be,{open:i,fullWidth:!0,maxWidth:"lg",onClose:function(){r(!1)},innerDialog:Object(g.jsx)(Or,{editable:!0,currentSelected:[],onSubmit:function(e){var t=e.toAdd;p({variables:{entries:t}})},dialogTitle:"Create New Block List",onClose:function(){return r(!1)}})})]}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(B.a,{style:{width:"7rem"},children:"Modify"}),Object(g.jsx)(B.a,{style:{width:"15rem"},children:"Name"}),Object(g.jsx)(B.a,{children:"Blocked Commands"})]})}),Object(g.jsx)(R.a,{children:l.map((function(e){return Object(g.jsx)(Tr,Object(k.a)(Object(k.a)({},e),{},{onAcceptDelete:y,onSubmitEdits:x}),e.name)}))})]})})]})}function Tr(e){var t=Object(xe.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState({}),O=Object(u.a)(f,2),x=O[0],y=O[1];s.a.useEffect((function(){for(var t=[],a={},n=0,i=Object.entries(e.entries);n<i.length;n++){var r=Object(u.a)(i[n],2),c=r[0],o=r[1],s=o.map((function(e){return e.command.cmd})).sort().join(", ");t.push({ptype:c,commands:s}),a[c]=o.map((function(e){return e.command}))}y(a),d(t)}),[e.entries]);return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{size:"small",onClick:function(){r(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})}),Object(g.jsx)(La,{onClose:function(){r(!1)},onSubmit:function(){r(!1),e.onAcceptDelete({name:e.name})},open:i})]}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(b.a,{size:"small",onClick:function(){h(!0)},startIcon:Object(g.jsx)(wr.a,{}),color:"secondary",variant:"contained",children:"Edit"}),m&&Object(g.jsx)(be,{open:m,fullWidth:!0,maxWidth:"lg",onClose:function(){h(!1)},innerDialog:Object(g.jsx)(Or,{editable:!1,blockListName:e.name,currentSelected:x,onSubmit:function(t){var a=t.toAdd,n=t.toRemove;e.onSubmitEdits({toAdd:a,toRemove:n})},dialogTitle:"Edit Block List",onClose:function(){return h(!1)}})})]}),Object(g.jsx)(B.a,{children:e.name}),Object(g.jsx)(B.a,{children:l.map((function(t){return Object(g.jsxs)("div",{children:[t.ptype," - ",t.commands]},e.name+t.ptype)}))})]})}var $r=Object(Pe.a)(_r||(_r=Object(q.a)(["\nquery GetOperations {\n  operation(order_by: {name: asc}) {\n    complete\n    name\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n}\n"]))),Pr=Object(Pe.a)(vr||(vr=Object(q.a)(["\nquery getBlockLists {\n  disabledcommandsprofile(order_by: {name: asc}) {\n    id\n    name\n    command{\n      id\n      cmd\n      payloadtype{\n        ptype\n      }\n    }\n  }\n}\n"])));function Ar(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];Object(Ae.a)($r,{fetchPolicy:"network-only",onCompleted:function(e){l(e.operation)},onError:function(e){}}),Object(Ae.a)(Pr,{fetchPolicy:"network-only",onCompleted:function(e){for(var t=e.disabledcommandsprofile.reduce((function(e,t){return void 0===e[t.name]&&(e[t.name]={}),void 0===e[t.name][t.command.payloadtype.ptype]&&(e[t.name][t.command.payloadtype.ptype]=[]),e[t.name][t.command.payloadtype.ptype].push(t),Object(k.a)({},e)}),{}),a=[],n=0,r=Object.entries(t);n<r.length;n++){var c=Object(u.a)(r[n],2),o=c[0],s=c[1];a.push({name:o,entries:s})}i(a)},onError:function(e){}});return Object(g.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(g.jsx)(jr,{operations:o,onUpdateOperation:function(e){var t=e.id,a=e.name,n=e.complete,i=o.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{name:a,complete:n}):Object(k.a)({},e)}));l(i)},onNewOperation:function(e){var t=e.id,a=e.name,n=e.admin;l([].concat(Object(F.a)(o),[{id:t,name:a,admin:n}]))}}),Object(g.jsx)(Ir,{blockLists:n})]})}a(356),a(357);var Er,Lr=Object(Pe.a)(Er||(Er=Object(q.a)(["\nquery getCommandsAndPayloadTypes{\n  payloadtype(order_by: {ptype: asc}){\n    id\n    ptype\n    commands(order_by: {cmd: asc}){\n      id\n      cmd\n    }\n  }\n}\n"])));function Fr(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(""),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState([]),x=Object(u.a)(O,2),_=x[0],v=x[1],k=s.a.useState([]),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState(""),I=Object(u.a)(D,2),T=I[0],$=I[1],P=Object(o.useRef)(null),A=Object(o.useRef)(null);Object(Ae.a)(Lr,{onCompleted:function(t){if(v(t.payloadtype),void 0!==e.payload_type_id?j(e.payload_type_id):t.payloadtype.length>0&&j(t.payloadtype[0].id),void 0!==e.command_id){f(e.command_id);for(var a=0;a<t.payloadtype.length;a++)e.payload_type_id===t.payloadtype[a].id&&S(t.payloadtype[a].commands)}else t.payloadtype.length>0&&t.payloadtype[0].commands.length>0&&(S(t.payloadtype[0].commands),f(t.payloadtype[0].commands[0].id));void 0!==e.author&&$(e.author)},onError:function(e){}}),Object(o.useEffect)((function(){void 0!==e.script&&r(atob(e.script))}),[e.script]);var E=function(){e.onSubmitEdit({script:btoa(i),command_id:h,payload_type_id:d,author:T}),e.onClose()};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{children:e.title?e.title:"Edit BrowserScript Code"}),Object(g.jsxs)(ce.a,{dividers:!0,style:{height:"calc(80vh)"},children:[Object(g.jsxs)(Et.a,{style:{width:"50%"},children:[Object(g.jsx)(Jt.a,{ref:P,children:"Payload Type"}),Object(g.jsx)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:d,onChange:function(e){j(e.target.value);var t=_.filter((function(t){return t.id===e.target.value}));S(t[0].commands),f(t[0].commands[0].id)},input:Object(g.jsx)(qt.a,{style:{width:"100%"}}),children:_.map((function(e){return Object(g.jsx)(xt.a,{value:e.id,children:e.ptype},"payloadtype"+e.id)}))})]}),Object(g.jsxs)(Et.a,{style:{width:"50%",paddingBottom:"10px"},children:[Object(g.jsx)(Jt.a,{ref:A,children:"Command"}),Object(g.jsx)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:h,onChange:function(e){f(e.target.value)},input:Object(g.jsx)(qt.a,{style:{width:"100%"}}),children:C.map((function(e){return Object(g.jsx)(xt.a,{value:e.id,children:e.cmd},"command"+e.id)}))})]}),Object(g.jsx)(y,{value:T,onChange:function(e,t,a){$(t)},name:"Author",fullWidth:!0}),Object(g.jsx)(Ct.a,{mode:"javascript",theme:"dark"===t.palette.type?"monokai":"github",width:"100%",height:"100%",value:i,focus:!0,onChange:function(e){r(e)},setOptions:{}})]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",style:{backgroundColor:t.palette.primary.main},children:"Close"}),e.new?Object(g.jsx)(b.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Create"}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{onClick:function(){e.onRevert(),e.onClose()},variant:"contained",style:{backgroundColor:t.palette.success.main},children:"Revert"}),Object(g.jsx)(b.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Save"})]})]})]})}function qr(e){var t=Object(xe.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1];Object(o.useEffect)((function(){var t=!1;e.browserscriptoperations.forEach((function(a){a.operation_id===e.operation_id&&(t=!0)})),j(t)}),[e.browserscriptoperations,e.operation_id]);return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{size:"small",onClick:function(){f(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})}),Object(g.jsx)(La,{onClose:function(){f(!1)},onSubmit:function(){e.onDelete({browserscript_id:e.id})},open:h})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:e.active,onChange:function(){e.onToggleActive({browserscript_id:e.id,active:!e.active})},color:"primary",inputProps:{"aria-label":"checkbox",track:"white"},name:"Active"})}),Object(g.jsx)(B.a,{children:e.payloadtype.ptype}),Object(g.jsx)(B.a,{children:e.command.cmd}),Object(g.jsx)(B.a,{children:e.author}),Object(g.jsxs)(B.a,{children:[e.user_modified?"User Modified":""," "]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){r(!0)},color:"primary",children:" Edit "})}),Object(g.jsx)(B.a,{children:d?Object(g.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitRemoveFromOperation({browserscript_id:e.id})},color:"secondary",children:"Remove"}):Object(g.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitApplyToOperation({browserscript_id:e.id})},color:"primary",children:"Apply"})}),i?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"xl",open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(Fr,{onClose:function(){r(!1)},payload_type_id:e.payloadtype.id,command_id:e.command.id,script:e.script,onSubmitEdit:function(t){var a=t.script,n=t.command_id,i=t.payload_type_id,r=t.author;e.onSubmitEdit({browserscript_id:e.id,script:a,command_id:n,payload_type_id:i,author:r})},onRevert:function(){e.onRevert({browserscript_id:e.id,script:e.container_version})},author:e.author})}):null]},"payload"+e.id)})}function Nr(e){var t=Object(xe.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Browser Scripts"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){return r(!0)},style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"New Script"}),i?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:i,onClose:function(){r(!1)},innerDialog:Object(g.jsx)(Fr,{onClose:function(){r(!1)},title:"Create New Browser Script",new:!0,onSubmitEdit:e.onSubmitNew})}):null]}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Active"}),Object(g.jsx)(B.a,{children:"Payload"}),Object(g.jsx)(B.a,{children:"Command"}),Object(g.jsx)(B.a,{children:" Author"}),Object(g.jsx)(B.a,{style:{width:"15em"},children:"User Modified?"}),Object(g.jsx)(B.a,{style:{width:"8em"},children:" Edit"}),Object(g.jsx)(B.a,{style:{width:"15rem"},children:"Apply to Operation"})]})}),Object(g.jsx)(R.a,{children:e.browserscript.map((function(t){return Object(g.jsx)(qr,Object(k.a)({onSubmitApplyToOperation:e.onSubmitApplyToOperation,onSubmitRemoveFromOperation:e.onSubmitRemoveFromOperation,operation_id:e.operation_id,onToggleActive:e.onToggleActive,onSubmitEdit:e.onSubmitEdit,onRevert:e.onRevert,onToggleOperation:e.onToggleOperation,onDelete:e.onDelete},t),"script"+t.id)}))})]})})]})}var Rr,Br,zr,Wr,Mr,Hr,Ur,Vr=a(489),Gr=Object(Vr.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"}}});function Kr(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1];return Object(o.useEffect)((function(){d(null===e.browserscript.command?"Support Script: "+e.browserscript.name:e.browserscript.command.cmd)}),[e.browserscript]),Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.browserscript.payloadtype.ptype}),Object(g.jsx)(B.a,{children:l}),Object(g.jsxs)(B.a,{children:[e.browserscript.user_modified?"User Modified":""," "]}),Object(g.jsx)(B.a,{children:e.operation.admin.username}),Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{size:"small",variant:"contained",style:{color:Gr.palette.info.main},onClick:function(){i(!0)},children:" View "})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(g.jsx)(Ct.a,{mode:"javascript",theme:"github",width:"100%",value:atob(e.browserscript.script),focus:!0,readOnly:!0,onChange:function(){},setOptions:{}})})]},"opscript"+e.browserscript.id)})}function Qr(e){var t=Object(xe.a)();return e.browserscriptoperation.length>0&&Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operation Browser Scripts"})}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{maxHeight:"calc(30vh)"},children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"10em"},children:"Payload"}),Object(g.jsx)(B.a,{style:{},children:"Command"}),Object(g.jsx)(B.a,{style:{width:"5em"},children:"User Modified?"}),Object(g.jsx)(B.a,{style:{},children:"Operator"}),Object(g.jsx)(B.a,{style:{width:"5em"},children:"View Script"})]})}),Object(g.jsx)(R.a,{children:e.browserscriptoperation.map((function(e){return Object(g.jsx)(Kr,Object(k.a)({},e),"opscriptrow"+e.browserscript.id)}))})]})})]})}var Jr,Yr,Zr=Object(Pe.a)(Rr||(Rr=Object(q.a)(["\nsubscription SubscribeBrowserScripts($operator_id: Int!) {\n  browserscript(where: {operator_id: {_eq: $operator_id}, for_new_ui: {_eq: true}}) {\n    active\n    author\n    user_modified\n    script\n    payloadtype {\n      ptype\n      id\n    }\n    name\n    id\n    creation_time\n    container_version_author\n    container_version\n    command {\n      cmd\n      id\n    }\n    browserscriptoperations {\n      operation_id\n      id\n    }\n  }\n}\n "]))),Xr=Object(Pe.a)(Br||(Br=Object(q.a)(["\nsubscription SubscribeOperationBrowserScripts($operation_id: Int!) {\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {for_new_ui: {_eq: true}}}){\n    browserscript{\n        active\n        author\n        user_modified\n        script\n        payloadtype {\n          ptype\n          id\n        }\n        name\n        id\n        creation_time\n        container_version_author\n        container_version\n        command {\n          cmd\n          id\n        }\n      }\n   operation{\n    admin{\n        username\n    }\n   }\n  }\n}\n "]))),ec=Object(Pe.a)(zr||(zr=Object(q.a)(["\nmutation updateBrowserScriptActive($browserscript_id: Int!, $active: Boolean!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {active: $active}) {\n    id\n  }\n}\n"]))),tc=Object(Pe.a)(Wr||(Wr=Object(q.a)(["\nmutation updateBrowserScriptScript($browserscript_id: Int!, $script: String!, $command_id: Int!, $payload_type_id: Int!, $author: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, author: $author, user_modified: true, command_id: $command_id, payload_type_id: $payload_type_id}) {\n    id\n  }\n}\n"]))),ac=Object(Pe.a)(Mr||(Mr=Object(q.a)(["\nmutation updateBrowserScriptRevert($browserscript_id: Int!, $script: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, user_modified: false}) {\n    id\n  }\n}\n"]))),nc=Object(Pe.a)(Hr||(Hr=Object(q.a)(["\nmutation insertNewBrowserScript($script: String!, $author: String!, $payload_type_id: Int!, $command_id: Int!){\n  insert_browserscript_one(object: {script: $script, author: $author, payload_type_id: $payload_type_id, command_id: $command_id}){\n    id\n  }\n}\n"]))),ic=Object(Pe.a)(Ur||(Ur=Object(q.a)(["\nmutation deleteBrowserScriptMutation($browserscript_id: Int!){\n  delete_browserscript_by_pk(id: $browserscript_id){\n    id\n  }\n}\n"])));function rc(e){var t=Object(T.a)(C),a=s.a.useState({browserscript:[]}),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState({browserscriptoperation:[]}),o=Object(u.a)(c,2),l=o[0],d=o[1];Object(ct.a)(Zr,{variables:{operator_id:t.user.id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;console.log(t),r(t.data)}}),Object(ct.a)(Xr,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;d(t.data)}});var b=Object(Ee.a)(ec,{onCompleted:function(e){E.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),j=Object(u.a)(b,1)[0],p=Object(Ee.a)(tc,{onCompleted:function(e){E.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),m=Object(u.a)(p,1)[0],h=Object(Ee.a)(ac,{onCompleted:function(e){E.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),f=Object(u.a)(h,1)[0],O=Object(Ee.a)(nc,{onCompleted:function(e){E.success("Successfully created new browser script!")},onError:function(e){E.error("Failed to create new script: "+e)}}),x=Object(u.a)(O,1)[0],y=Object(Ee.a)(ic,{onCompleted:function(e){E.success("Successfully deleted browser script")},onError:function(e){E.error("Failed to delete browser script: "+e)}}),_=Object(u.a)(y,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Nr,Object(k.a)(Object(k.a)({},i),{},{operation_id:t.user.current_operation_id,onToggleActive:function(e){var t=e.browserscript_id,a=e.active;j({variables:{browserscript_id:t,active:a}})},onSubmitEdit:function(e){var t=e.browserscript_id,a=e.script,n=e.command_id,i=e.payload_type_id,r=e.author;m({variables:{browserscript_id:t,script:a,command_id:n,payload_type_id:i,author:r}})},onRevert:function(e){var t=e.browserscript_id,a=e.script;f({variables:{browserscript_id:t,script:a}})},onSubmitNew:function(e){var t=e.script,a=e.author,n=e.payload_type_id,i=e.command_id;x({variables:{author:a,script:t,payload_type_id:n,command_id:i}})},onDelete:function(e){var t=e.browserscript_id;_({variables:{browserscript_id:t}})},onSubmitApplyToOperation:function(e){e.browserscript_id;E.warning("Not Implemented Yet!",{autoHideDuration:1e3})},onSubmitRemoveFromOperation:function(e){e.browserscript_id;E.warning("Not Implemented Yet!",{autoHideDuration:1e3})}})),Object(g.jsx)(Qr,Object(k.a)({},l))]})}var cc,oc,sc=Object(Pe.a)(Jr||(Jr=Object(q.a)(["\nmutation updateDescription ($payload_id: Int!, $description: String) {\n  update_payload_by_pk(pk_columns: {id: $payload_id}, _set: {tag: $description}) {\n    tag\n    id\n  }\n}\n"]))),lc=Object(Pe.a)(Yr||(Yr=Object(q.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    tag\n    id\n  }\n}\n"])));function dc(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(lc,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.tag)},fetchPolicy:"network-only"}),c=r.loading,l=r.error,d=Object(Ee.a)(sc,{onCompleted:function(e){E.success("Updated Description")}}),j=Object(u.a)(d,1)[0];if(c)return Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}});if(l)return console.error(l),Object(g.jsx)("div",{children:"Error!"});var p=function(){j({variables:{payload_id:e.payload_id,description:n}}),e.onClose()};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Edit Payload Description"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:p})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:p,color:"secondary",children:"Submit"})]})]})}var uc,bc=Object(Pe.a)(cc||(cc=Object(q.a)(["\nmutation updateDescription ($file_id: Int!, $filename: bytea!) {\n  update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {filename: $filename}) {\n    filename_text\n    id\n  }\n}\n"]))),jc=Object(Pe.a)(oc||(oc=Object(q.a)(["\nquery getFilenameQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    filemetum {\n      filename_text\n      id\n    }\n    id\n  }\n}\n"])));function pc(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(),c=Object(u.a)(r,2),l=c[0],d=c[1],j=Object(Ae.a)(jc,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.filemetum.filename_text),d(e.payload_by_pk.filemetum.id)},fetchPolicy:"network-only"}),p=j.loading,m=j.error,h=Object(Ee.a)(bc,{onCompleted:function(e){E.success("Updated filename")}}),f=Object(u.a)(h,1)[0];if(p)return Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}});if(m)return console.error(m),Object(g.jsx)("div",{children:"Error!"});var O=function(){f({variables:{file_id:l,filename:n}}),e.onClose()};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Edit Payload Filename"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:O})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:O,color:"secondary",children:"Submit"})]})]})}var mc=Object(Pe.a)(uc||(uc=Object(q.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    build_message\n    build_stderr\n    build_stdout\n    id\n  }\n}\n"])));function hc(e){var t=Object(o.useState)({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=Object(Ae.a)(mc,{variables:{payload_id:e.payload_id},onCompleted:function(t){d(e.viewError);var a="Message:\n"+t.payload_by_pk.build_message;a+="\nSTDOUT:\n"+t.payload_by_pk.build_stdout,i({message:a,error:"STDERR:\n"+t.payload_by_pk.build_stderr})},fetchPolicy:"network-only"}),p=j.loading,m=j.error;return Object(o.useEffect)((function(){d(e.viewError)}),[e.viewError]),p?Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}}):m?(console.error(m),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Payload Build Messages"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{multiline:!0,onChange:function(){},value:l?n.error:n.message})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var fc=a(214),Oc=a.n(fc),gc=a(802),xc=a(444),yc=a.n(xc);function _c(e){var t=Object(xe.a)();return Object(g.jsx)(s.a.Fragment,{children:e.payloadc2profiles.map((function(a){return Object(g.jsxs)(Q.a,{children:[a.c2profile.is_p2p?a.c2profile.container_running?Object(g.jsx)(gc.a,{title:"C2 Container online",children:Object(g.jsx)(dn.a,{style:{color:t.palette.success.main}})}):Object(g.jsx)(gc.a,{title:"C2 Container offline",children:Object(g.jsx)(Oc.a,{style:{color:t.palette.error.main}})}):a.c2profile.running?Object(g.jsx)(gc.a,{title:"C2 Internal Server Running",children:Object(g.jsx)(dn.a,{style:{color:t.palette.success.main}})}):a.c2profile.container_running?Object(g.jsx)(gc.a,{title:"C2 Internal Server Not Running, but Container Online",children:Object(g.jsx)(yc.a,{style:{color:t.palette.warning.main}})}):Object(g.jsx)(gc.a,{title:"C2 Container offline",children:Object(g.jsx)(Oc.a,{style:{color:t.palette.error.main}})})," - ",a.c2profile.name]},a.c2profile.name+e.uuid)}))})}var vc,kc=a(96),wc=a.n(kc),Cc=a(445),Sc=a.n(Cc);function Dc(e){var t=Object(xe.a)();return Object(g.jsx)(s.a.Fragment,{children:"success"===e.build_phase?Object(g.jsx)(gc.a,{title:"Download payload",children:Object(g.jsx)(K.a,{variant:"contained",target:"_blank",color:"primary",href:window.location.origin+"/direct/download/"+e.filemetum.agent_file_id,download:!0,children:Object(g.jsx)(wc.a,{style:{color:t.palette.success.main}})})}):"building"===e.build_phase?Object(g.jsx)(gc.a,{title:"Payload still building",children:Object(g.jsx)(K.a,{variant:"contained",children:Object(g.jsx)(Ca.a,{size:20,thickness:4,style:{color:t.palette.info.main}})})}):Object(g.jsx)(gc.a,{title:"Failed to build payload",children:Object(g.jsx)(K.a,{variant:"contained",onClick:function(){return E.warning("Payload failed to build, cannot download")},children:Object(g.jsx)(Sc.a,{style:{color:t.palette.error.main}})})})})}var Ic,Tc=Object(Pe.a)(vc||(vc=Object(q.a)(["\nquery checkPayloadConfigurationQuery($uuid: String!) {\n  config_check(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function $c(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(Tc,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.config_check.status?i(e.config_check.output):(E.warning(e.config_check.error),i("Error!\n"+e.config_check.error))},fetchPolicy:"network-only"}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Payload Config Check"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{multiline:!0,onChange:function(){},value:n})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Pc,Ac,Ec=Object(Pe.a)(Ic||(Ic=Object(q.a)(["\nquery generateRedirectRulesMutation($uuid: String!) {\n  redirect_rules(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function Lc(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(Ec,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.redirect_rules.status?i(e.redirect_rules.output):(E.warning(e.redirect_rules.error),i("Error!\n"+e.redirect_rules.error))},fetchPolicy:"network-only"}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Payload Redirect Rules Check"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{multiline:!0,onChange:function(){},value:n})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Fc,qc=Object(Pe.a)(Pc||(Pc=Object(q.a)(["\nmutation triggerRebuildMutation($uuid: String!) {\n  rebuild_payload(uuid: $uuid) {\n      status\n      error\n      uuid\n  }\n}\n"]))),Nc=Object(Pe.a)(Ac||(Ac=Object(q.a)(["\nquery exportPayloadConfigQuery($uuid: String!) {\n  export_payload_config(uuid: $uuid) {\n      status\n      error \n      config \n  }\n}\n"])));function Rc(e){var t=s.a.useState(!0),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),O=Object(u.a)(f,2),x=O[0],y=O[1],_=s.a.useState(!1),v=Object(u.a)(_,2),w=v[0],S=v[1],D=s.a.useState(!1),I=Object(u.a)(D,2),$=I[0],P=I[1],A=s.a.useState(!1),L=Object(u.a)(A,2),F=L[0],q=L[1],N=s.a.useState(!1),R=Object(u.a)(N,2),z=R[0],W=R[1],U=s.a.useState(!1),V=Object(u.a)(U,2),G=V[0],Q=V[1],J=Object(o.useRef)(null),Y=Object(T.a)(C),Z=Object(xe.a)(),X=Object(Ee.a)(qc,{onCompleted:function(e){console.log(e),E.success("Successfully triggered rebuild")},onError:function(e){E.error("Failed to trigger rebuild: "+e)}}),ee=Object(u.a)(X,1)[0],ae=Object(At.a)(Nc,{fetchPolicy:"no-cache",onCompleted:function(t){if("success"===t.export_payload_config.status){var a=new Blob([t.export_payload_config.config],{type:"text/plain"}),n=document.getElementById("download_config");if(null!==n)n.href=URL.createObjectURL(a),n.download=e.filemetum.filename_text+".json",n.click();else{var i=document.createElement("a");i.id="download_config",i.href=URL.createObjectURL(a),i.download=e.filemetum.filename_text+".json",document.body.appendChild(i),i.click()}}else E.error("Failed to export configuration: "+t.export_payload_config.error)},onError:function(e){E.error("Failed to export configuration: "+e)}}),ne=Object(u.a)(ae,1)[0],ie=[{name:"Rename File",click:function(){S(!0)}},{name:"Edit Description",click:function(){y(!0)}},{name:e.callback_alert?"Stop Alerting to New Callbacks":"Start Alerting to New Callbacks",click:function(){!function(){var t=e.id,a=e.callback_alert;e.onAlertChanged(t,!a)}()}},{name:"View Build Message/Stdout",click:function(){i(!1),P(!0)}},{name:"View Build Errors",click:function(){i(!0),P(!0)}},{name:"Trigger New Build",click:function(){ee({variables:{uuid:e.uuid}})}},{name:"Export Payload Config",click:function(){ne({variables:{uuid:e.uuid}})}},{name:"Generate Redirect Rules",click:function(){Q(!0)}},{name:"Check Agent C2 Configuration",click:function(){W(!0)}}],re=function(e){J.current&&J.current.contains(e.target)||d(!1)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{size:"small",onClick:function(){h(!0)},style:{color:Z.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})}),Object(g.jsx)(La,{onClose:function(){h(!1)},onSubmit:function(){e.onDeletePayload(e.filemetum.id),h(!1)},open:m})]}),Object(g.jsx)(B.a,{children:he(e.creation_time,Y.user.view_utc_time)}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(b.a,{ref:J,size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Actions"}),Object(g.jsx)(gt.a,{open:l,anchorEl:J.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var a=t.TransitionProps,n=t.placement;return Object(g.jsx)(Ot.a,Object(k.a)(Object(k.a)({},a),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(g.jsx)(H.a,{variant:"outlined",style:{backgroundColor:"dark"===Z.palette.type?Z.palette.primary.dark:Z.palette.primary.light,color:"white"},children:Object(g.jsx)(ft.a,{onClickAway:re,children:Object(g.jsx)(yt.a,{id:"split-button-menu",children:ie.map((function(t,a){return Object(g.jsx)(xt.a,{onClick:function(e){return function(e,t){ie[t].click(),d(!1)}(0,a)},children:t.name},t.name+e.uuid)}))})})})}))}}),x?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:x,onClose:function(){y(!1)},innerDialog:Object(g.jsx)(dc,{payload_id:e.id,onClose:function(){y(!1)}})}):null,w?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:w,onClose:function(){S(!1)},innerDialog:Object(g.jsx)(pc,{payload_id:e.id,onClose:function(){S(!1)}})}):null,$?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:$,onClose:function(){P(!1)},innerDialog:Object(g.jsx)(hc,{payload_id:e.id,viewError:n,onClose:function(){P(!1)}})}):null,z?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:z,onClose:function(){W(!1)},innerDialog:Object(g.jsx)($c,{uuid:e.uuid,onClose:function(){W(!1)}})}):null,G?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:G,onClose:function(){Q(!1)},innerDialog:Object(g.jsx)(Lc,{uuid:e.uuid,onClose:function(){Q(!1)}})}):null]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Dc,Object(k.a)({},e))}),Object(g.jsx)(B.a,{children:e.filemetum.filename_text}),Object(g.jsx)(B.a,{children:e.tag}),Object(g.jsx)(B.a,{children:Object(g.jsx)(_c,{payloadc2profiles:e.payloadc2profiles,uuid:e.uuid})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(K.a,{size:"small",color:"primary",onClick:function(){return q(!0)},children:Object(g.jsx)(Ln.a,{})})})]},"payload"+e.uuid),Object(g.jsx)(M.a,{children:F?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:F,onClose:function(){q(!1)},innerDialog:Object(g.jsx)(Tn,Object(k.a)(Object(k.a)({},e),{},{payload_id:e.id,onClose:function(){q(!1)}}))}):null})]})}var Bc,zc,Wc,Mc,Hc,Uc=Object(Pe.a)(Fc||(Fc=Object(q.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function Vc(e){var t=s.a.useState({name:""}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ee.a)(Uc,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?E.info("Submitted payload to build pipeline"):E.error(a.createPayload.error)}}),c=Object(u.a)(r,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Import Payload Config to Generate New Payload"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsxs)(b.a,{variant:"contained",component:"label",children:[""===n.name?"Select File":n.name,Object(g.jsx)("input",{onChange:function(e){var t=new FileReader;t.onload=function(t){var a=t.target.result;i({name:e.target.files[0].name,contents:a})},t.readAsBinaryString(e.target.files[0])},type:"file",hidden:!0})]})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(g.jsx)(b.a,{variant:"contained",onClick:function(){c({variables:{payload:n.contents}}).catch((function(e){console.log(e)})),e.onClose()},color:"secondary",children:"Submit"})]})]})}function Gc(e){var t=e.payload,a=e.onDeletePayload,n=e.onUpdateCallbackAlert,i=Object(xe.a)(),r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(H.a,{elevation:5,style:{backgroundColor:i.pageHeader.main,color:i.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payloads"}),Object(g.jsx)(b.a,{size:"small",href:"/new/createpayload",style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"New Payload"}),Object(g.jsx)(b.a,{size:"small",onClick:function(){return l(!0)},style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(g.jsx)(ne.a,{}),color:"primary",variant:"contained",children:"Import Payload Config"}),o?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:o,onClose:function(){l(!1)},innerDialog:Object(g.jsx)(Vc,{onClose:function(){l(!1)}})}):null]}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"4rem"},children:" Delete"}),Object(g.jsx)(B.a,{style:{width:"15rem"},children:"Timestamp"}),Object(g.jsx)(B.a,{style:{width:"6rem"},children:"Modify"}),Object(g.jsx)(B.a,{style:{width:"6rem"},children:"Download"}),Object(g.jsx)(B.a,{children:"File"}),Object(g.jsx)(B.a,{children:"Description"}),Object(g.jsx)(B.a,{children:"C2 Status"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Details"})]})}),Object(g.jsx)(R.a,{children:t.map((function(e){return Object(g.jsx)(Rc,Object(k.a)({onDeletePayload:a,onAlertChanged:n},e),"payload"+e.id)}))})]})})]})}var Kc=Object(Pe.a)(Bc||(Bc=Object(q.a)(["\nfragment payloadData on payload {\n  build_message\n  build_phase\n  build_stderr\n  callback_alert\n  creation_time\n  id\n  operator {\n    id\n    username\n  }\n  uuid\n  tag\n  payloadtype {\n    id\n    ptype\n  }\n  filemetum {\n    agent_file_id\n    filename_text\n    id\n  }\n  payloadc2profiles {\n    c2profile {\n      running\n      name\n      is_p2p\n      container_running\n    }\n  }\n}\n"]))),Qc=Object(Pe.a)(zc||(zc=Object(q.a)(["\n","\nsubscription SubPayloadsQuery($operation_id: Int!) {\n  payload(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, auto_generated: {_eq: false}}, order_by: {id: desc}) {\n    ...payloadData\n  }\n}\n"])),Kc),Jc=Object(Pe.a)(Wc||(Wc=Object(q.a)(["\n","\nquery GetPayloadsQuery($operation_id: Int!) {\n  payload(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, auto_generated: {_eq: false}}, order_by: {id: desc}, limit: 20) {\n    ...payloadData\n  }\n}\n"])),Kc),Yc=Object(Pe.a)(Mc||(Mc=Object(q.a)(["\nmutation PayloadsDeletePayloadMutation($id: Int!) {\n  deleteFile(file_id: $id) {\n      file_ids\n      status\n      error\n      payload_ids\n  }\n}\n"]))),Zc=Object(Pe.a)(Hc||(Hc=Object(q.a)(["\nmutation PayloadsCallbackAlertMutation($id: Int!, $callback_alert: Boolean!) {\n  update_payload_by_pk(pk_columns: {id: $id}, _set: {callback_alert: $callback_alert}) {\n    id\n    callback_alert\n  }\n}\n"])));function Xc(e){var t=Object(T.a)(C),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1];Object(Ae.a)(Jc,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",onCompleted:function(e){var t=e.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(k.a)({},t),Object(F.a)(e)):[t].concat(Object(F.a)(e))}),Object(F.a)(i));t.sort((function(e,t){return e.id>t.id?-1:1})),r(t)}}),Object(ct.a)(Qc,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",onSubscriptionData:function(e){var t=e.subscriptionData.data.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(k.a)({},t),Object(F.a)(e)):[t].concat(Object(F.a)(e))}),Object(F.a)(i));t.sort((function(e,t){return e.id>t.id?-1:1})),r(t)},onError:function(e){E.warning("Failed to get payloads"),console.log(e)}});var c=Object(Ee.a)(Yc,{onCompleted:function(e){if("success"===e.deleteFile.status){var t=i.filter((function(t){return!e.deleteFile.payload_ids.includes(t.id)}));r(t),E.success("Successfully deleted")}else E.error(e.deleteFile.error)},onError:function(e){E.warning("Failed to delete payload"),console.log(e)}}),o=Object(u.a)(c,1)[0],l=Object(Ee.a)(Zc,{onCompleted:function(e){var t=i.map((function(t){return t.id===e.update_payload_by_pk.id?Object(k.a)(Object(k.a)({},t),e.update_payload_by_pk):Object(k.a)({},t)}));e.update_payload_by_pk.callback_alert?E.success("Now Alerting on New Callbacks"):E.success("No Longer Alerting on New Callbacks"),r(t)},onError:function(e){E.warning("Failed to update callback alerting status"),console.log(e)}}),d=Object(u.a)(l,1)[0];return Object(g.jsx)("div",{style:{height:"calc(94vh)",maxHeight:"calc(94vh)",marginTop:"10px"},children:Object(g.jsx)(Gc,{onDeletePayload:function(e){o({variables:{id:e}})},onUpdateCallbackAlert:function(e,t){d({variables:{id:e,callback_alert:t}})},payload:i})})}var eo=a(97),to=a.n(eo),ao=a(268),no=a.n(ao),io=a(144),ro=a.n(io),co=a(78),oo=function(e,t,a,n,i,r){!function(e,t,a,n,i,r){co.select(".contextMenu").remove(),n.length>0&&(co.select(r).append("g").attr("class","contextMenu").selectAll("tmp").data(n).enter().append("g").attr("class","menuEntry").style({cursor:"pointer"}),co.selectAll(".menuEntry").append("rect").attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("rx",2).attr("fill","#ffffff").attr("width",180).attr("height",30).on("click",(function(t){t.action(e,i)})),co.selectAll(".menuEntry").append("text").text((function(e){return e.title})).attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("dy",20).attr("dx",10).on("click",(function(t){t.action(e,i)})),co.select("body").on("click",(function(){co.select(".contextMenu").remove(),co.select(".menuEntry").remove()})))}(e,co.event.pageX,co.event.pageY-80,a,t,r),co.event.preventDefault()},so=a(289),lo=a.n(so);function uo(e){var t=Object(o.useRef)(null),a=Object(o.useState)(!0),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(xe.a)();return Object(o.useEffect)((function(){jo(e.callbackgraphedges,t,i,{rankDir:"LR",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!0},{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[]},c),r(!1)}),[e.callbackgraphedges,i,c]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:["Callback ",e.id,"'s Egress Path"]}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)("svg",{ref:t,id:"nodeTree",style:{width:"100%",height:"calc(78vh)",marginTop:"10px"}})})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var bo,jo=function(e,t,a,n,i,r){var c,o="stroke: ".concat(r.palette.warning.main,"; stroke-width: 3px; stroke-dasharray: 5, 5; fill:none"),s="fill: ".concat(r.palette.warning.main),l="stroke: ".concat(r.palette.info.main,"; fill: none; stroke-width: 1.5px;"),d="stroke: ".concat(r.palette.info.main,"; fill: ").concat(r.palette.info.main,"; stroke-width: 1.5px;"),u="fill: ".concat(r.palette.success.main,","),b='labelStyle: "font-size: 2em"; fill: '.concat(r.palette.text.primary),j='labelStyle: "font-size: 2em"; fill: '.concat(r.palette.text.primary),p=function(e,t,a){(t.source.active||a.show_all_nodes)&&(m(e,t.source,a),e.setEdge(t.source.id,"Mythic",{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name))},m=function(e,t,a){e.setNode(t.id,{label:h(t,a.label_components),node:t,style:u,labelStyle:b,shape:"circle",isParent:!1}),e.setNode(t.host,{label:t.host,clusterLabelPos:"top",style:"fill:".concat(r.palette.graphGroup),node:null,labelStyle:b,isParent:!0}),e.setParent(t.id,t.host),e.setNode(t.host+"mythic_expander",{label:"",shape:"square",node:t,isParent:!1}),e.setParent(t.host+"mythic_expander",t.host)},h=function(e,t){return t.map((function(t){return e[t]})).join(", ")},f=function(e,t,a){if(t.source.active||t.destination.active||a.show_all_nodes){if(a.show_all_nodes)m(e,t.source,a),m(e,t.destination,a);else if(t.source.active&&m(e,t.source,a),t.destination.active&&m(e,t.destination,a),!t.source.active||!t.destination.active)return;1===t.direction?a.packet_flow_view?O(e,t,2):O(e,t,1):(2===t.direction||O(e,t,1),O(e,t,2))}},O=function(e,t,a){1===a?e.setEdge(t.source.id,t.destination.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name):2===a&&e.setEdge(t.destination.id,t.source.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name)},g=new lo.a.graphlib.Graph({compound:!0,multigraph:!0,directed:!0}).setGraph({rankdir:n.rankDir}).setDefaultEdgeLabel((function(){return{}})),x=co.select(t.current),y=x.select("g")._groups[0][0];c=y?x.select("g"):x.append("g");var _=co.zoom().on("zoom",(function(){c.attr("transform",co.event.transform)}));a&&(x.select("g.output").remove(),x.call(_)),g.setNode("Mythic",{label:"",style:u,shape:"circle",node:null,labelStyle:b}),e.forEach((function(e){(n.include_disconnected||null===e.end_timestamp)&&(e.destination.id===e.source.id?g.hasEdge(e.source.id,"Mythic",e.c2profile.name)?e.id>g.edge(e.source.id,"Mythic",e.c2profile.name).edge_id&&p(g,e,n):p(g,e,n):1===e.direction?n.packet_flow_view?g.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>g.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(g,e,n):f(g,e,n):g.hasEdge(e.source.id,e.destination.id,e.c2profile.name)?e.id>g.edge(e.source.id,e.destination.id,e.c2profile.name).edge_id?f(g,e,n):console.log("doing nothing, dropping data"):f(g,e,n):2===e.direction&&(g.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>g.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(g,e,n):f(g,e,n)))}));var v=new lo.a.render,k=x.node().getBoundingClientRect().width,w=x.node().getBoundingClientRect().height;if(v.shapes().circle=function(e,t,a){var n=e.insert("image").attr("class","nodeImage").attr("xlink:href",(function(e){return a.node?"/static/"+a.node.payload.payloadtype.ptype+".svg":"/static/mythic.svg"})).attr("x","-20px").attr("y","-20px").attr("width","40px").attr("height","40px").on("mouseover",(function(t){i.mouseover(e,a,t)})).on("mouseout",(function(t){i.mouseout(e,a,t)})).on("click",(function(t){co.event.preventDefault(),i.click(e,a,t)})).on("contextmenu",(function(e){oo(g,a,i.contextmenu,0,0,"#callbacksgraph")}));return a.intersect=function(e){return lo.a.intersect.circle(a,20,e)},n},v.shapes().square=function(e,t,a){return e.insert("rect").attr("width",(function(e){var t=g.children(a.node.host),i=a.node.host.length;if(void 0!==t&&t.forEach((function(e){g.node(e).label.length>i&&(i=g.node(e).label.length)})),"LR"===n.rankDir)return 9*i+"px";if(void 0!==t){var r=0;return t.forEach((function(e){g.outEdges(e,"Mythic").length>0&&(r+=1)})),(i=9*i-100*r)<0?0:i+"px"}console.log("candidates were undefined")})).attr("height",0)},v(c,g),a){var C=g.graph().width+40,S=g.graph().height+40,D=Math.min(k/C,w/S),I=k/2-C*D/2,T=w/2-S*D/2;x.transition().duration(500).call(_.transform,co.zoomIdentity.translate(I,T).scale(D))}c.selectAll("g.nodes g.label").attr("transform","translate(0,30)")},po=Object(Pe.a)(bo||(bo=Object(q.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function mo(e){var t=Object(xe.a)();return Object(g.jsxs)("div",{style:{maxWidth:"30%",width:"30%",display:"inline-flex",height:"calc(94vh)",flexDirection:"column"},children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsxs)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:["Callback ",e.callback.id]})}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsx)(ho,Object(k.a)({},e.callback))})]})}function ho(e){s.a.useRef(null);var t=Object(xe.a)(),a=Object(T.a)(C),n=s.a.useState(""),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState(!1),d=Object(u.a)(l,2),b=d[0],j=d[1],p=s.a.useState(t.palette.success.main),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState(!0),x=Object(u.a)(O,2),y=x[0],_=x[1],v=s.a.useState(!1),w=Object(u.a)(v,2),S=w[0],D=w[1],I=s.a.useState([]),$=Object(u.a)(I,2),P=$[0],A=$[1],E=s.a.useState([]),L=Object(u.a)(E,2),q=L[0],z=L[1],W=s.a.useState(!0),H=Object(u.a)(W,2),U=H[0],V=H[1],G=s.a.useState([]),K=Object(u.a)(G,2),J=K[0],Y=K[1];Object(ct.a)(po,{variables:{operation_id:a.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;Y(t.data.callbackgraphedge)}});Oe((function(){var t;t=e.last_checkin,c(fe(t))})),Object(o.useEffect)((function(){var t=q.filter((function(t){return!t.c2profile.is_p2p&&t.source.id===e.id&&t.destination.id===e.id})).length;t>0&&!U?V(!0):0===t&&U&&V(!1)}),[q]),Object(o.useEffect)((function(){var t=function(t){for(var a=J.filter((function(a){return(a.source.id===e.id||a.destination.id===e.id)&&(!t||null===a.end_timestamp)})),n=!0;n;){var i=J.reduce((function(e,a){return e.includes(a)?Object(F.a)(e):e.filter((function(e){return(e.source.id===a.source.id||e.source.id===a.destination.id||e.destination.id===a.source.id)&&(!t||null===a.end_timestamp)})).length>0?[].concat(Object(F.a)(e),[a]):Object(F.a)(e)}),Object(F.a)(a));n=i.length>a,a=Object(F.a)(i)}return a},a=t(!0),n=t(!1);A(a),z(n)}),[J,e.id]),Object(o.useEffect)((function(){0===P.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(f(t.palette.error.main),_(!1)):(f(t.palette.success.main),_(!0))}),[P,t.palette.success.main,t.palette.error.main]);e.locked&&e.locked_operator.username,e.locked?ro.a:to.a,Bi.a;return Object(g.jsx)(N.a,{size:"small",style:{overflow:"scroll"},children:Object(g.jsxs)(R.a,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Elevation Level"}),Object(g.jsxs)(B.a,{children:[e.integrity_level,e.integrity_level>2?" ( Elevated Access )":"",2===e.integrity_level?" ( Medium Integrity ) ":"",e.integrity_level<2?" ( Low Integrity )":""]})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Callback Lock Status"}),Object(g.jsx)(B.a,{children:e.locked?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(ro.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(g.jsx)(Q.a,{style:{display:"inline-block"},children:"Unlock (Locked by "+e.locked_operator.username+")"})]}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(to.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(g.jsx)(Q.a,{style:{display:"inline-block"},children:"Lock Callback"})]})})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"IP Address"}),Object(g.jsx)(B.a,{children:e.ip})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"External IP"}),Object(g.jsx)(B.a,{children:e.external_ip})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:e.host})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"User"}),Object(g.jsx)(B.a,{children:e.user})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Domain"}),Object(g.jsx)(B.a,{children:e.domain})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"OS / Architecture"}),Object(g.jsxs)(B.a,{children:[e.os,"(",e.architecture,")"]})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Process ID"}),Object(g.jsx)(B.a,{children:e.pid})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Last Checkin"}),Object(g.jsx)(B.a,{children:r})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Description"}),Object(g.jsx)(B.a,{children:e.description})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Sleep Info"}),Object(g.jsx)(B.a,{children:e.sleep_info})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Agent Type"}),Object(g.jsx)(B.a,{children:e.payload.payloadtype.ptype})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Egress Route"}),Object(g.jsx)(B.a,{children:U?Object(g.jsx)(jt.a,{onClick:function(e){e.stopPropagation(),D(!0)},style:{color:h,cursor:"pointer"}}):Object(g.jsx)(no.a,{onClick:function(e){e.stopPropagation(),D(!0)},style:{color:h,cursor:"pointer"}})})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Process Name"}),Object(g.jsx)(B.a,{children:e.process_name})]}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:S,onClose:function(){D(!1)},innerDialog:Object(g.jsx)(uo,Object(k.a)(Object(k.a)({onClose:function(){D(!1)}},e),{},{callbackgraphedges:y?P:q}))}),Object(g.jsx)(be,{fullWidth:!0,open:b,onClose:function(){j(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Callback's Description",onClose:function(){j(!1)},value:e.description,onSubmit:function(t){e.updateDescription({description:t,id:e.id})}})}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Extra Info"}),Object(g.jsx)(B.a,{children:e.extra_info})]})]})})}var fo=a(195),Oo=a(882),go=["children","value","index","maxHeight","tabInfo","getCallbackData","queryParams","changeSearchParam"],xo=["label","index","fullWidth","maxHeight","onContextMenu","onCloseTab","selectionFollowsFocus","textColor","indicator","tabInfo","onEditTabDescription","getCallbackData"],yo=["label","index","fullWidth","maxHeight","selectionFollowsFocus","textColor","indicator","iconComponent"];function _o(e){var t=e.children,a=e.value,n=e.index,i=(e.maxHeight,e.tabInfo,e.getCallbackData,e.queryParams,e.changeSearchParam,Object(fo.a)(e,go)),r=void 0===e.style?{display:a===n?"flex":"none",flexDirection:"column",overflowY:"auto",flexGrow:1,width:"100%",maxWidth:"100%"}:e.style;return Object(g.jsx)("div",Object(k.a)(Object(k.a)({role:"tabpanel",hidden:a!==n,id:"scrollable-auto-tabpanel-".concat(n),"aria-labelledby":"scrollable-auto-tab-".concat(n),style:r},i),{},{children:Object(g.jsx)(s.a.Fragment,{children:t})}))}function vo(e){return{id:"scrollable-auto-tab-".concat(e),"aria-controls":"scrollable-auto-tabpanel-".concat(e)}}function ko(e){var t=e.label,a=e.index,n=(e.fullWidth,e.maxHeight,e.onContextMenu),i=e.onCloseTab,r=(e.selectionFollowsFocus,e.textColor,e.indicator,e.tabInfo),c=(e.onEditTabDescription,e.getCallbackData,Object(fo.a)(e,xo));return Object(g.jsx)(Oo.a,Object(k.a)(Object(k.a)({label:Object(g.jsxs)("span",{onContextMenu:n,style:{display:"inline-block",zIndex:1},children:[t,Object(g.jsx)(K.a,Object(k.a)(Object(k.a)({component:"div",size:"small",onClick:function(e){e.stopPropagation(),i({tabID:r.tabID,index:a})}},c),{},{children:Object(g.jsx)(cn.a,{})}))]})},vo(a)),c))}function wo(e){var t=e.label,a=e.index,n=(e.fullWidth,e.maxHeight,e.selectionFollowsFocus,e.textColor,e.indicator,e.iconComponent),i=Object(fo.a)(e,yo);return Object(g.jsx)(Oo.a,Object(k.a)(Object(k.a)({label:Object(g.jsxs)("span",{children:[t,Object(g.jsx)("br",{}),n]})},vo(a)),i))}var Co=a(25),So=a(909),Do=a(888),Io=a(887),To=a(451),$o=a.n(To),Po=a(886),Ao=a(885),Eo=a(197);function Lo(e){try{var t=document.createElement("textarea");return t.value=e,""===t.value&&(t.value=" "),t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(a){return console.log("warning","Failed to copy to clipboard: "+a.toString()),!1}}var Fo=a(271),qo=a.n(Fo);function No(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)("img",{onClick:function(){i(!n)},src:e.href,style:{width:n?"":"100%",height:n?"":"100%",cursor:n?"zoom-out":"zoom-in"}})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Ro=Object(Ge.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),Bo=function(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Ro(),c=(new Date).toUTCString();return Object(g.jsxs)(s.a.Fragment,{children:[n&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"xl",open:n,onClose:function(){i(!1)},innerDialog:Object(g.jsx)(No,{href:"/api/v1.4/files/screencaptures/"+e.agent_file_id+"?time="+c,onClose:function(){i(!1)}})}),Object(g.jsx)("pre",{style:{display:"inline-block"},children:(null===e||void 0===e?void 0:e.plaintext)||""}),Object(g.jsx)(gc.a,{title:(null===e||void 0===e?void 0:e.hoverText)||"View Screenshot",arrow:!0,classes:{tooltip:r.tooltip,arrow:r.arrow},children:Object(g.jsx)(b.a,{color:"primary",variant:e.variant?e.variant:"contained",onClick:function(){i(!0)},style:{marginBottom:"10px"},children:e.name})})]})},zo=function(e){var t=Object(xe.a)(),a=s.a.useState(e.plaintext),n=Object(u.a)(a,2),i=n[0],r=n[1];return Object(o.useEffect)((function(){try{var t=JSON.stringify(JSON.parse(e.plaintext),null,4);r(t)}catch(a){r(e.plaintext)}}),[e.plaintext]),Object(g.jsx)(Ct.a,{mode:"json",theme:"dark"===t.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:i,focus:!0,width:"100%",minLines:2,maxLines:50,readOnly:!0,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})},Wo=a(108),Mo=(a(321),a(182)),Ho=a.n(Mo),Uo=a(183),Vo=a.n(Uo),Go=a(184),Ko=a.n(Go);function Qo(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],j=Object(o.useRef)(null),p=Object(xe.a)();return Object(o.useEffect)((function(){var t=Object(F.a)(e.options);i(t),t.length>0?d(t[0]):d("")}),[e.options]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{children:e.title}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(Et.a,{style:{width:"100%"},children:[Object(g.jsx)(Jt.a,{ref:j,children:"Options"}),Object(g.jsxs)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:l,onChange:function(e){d(e.target.value)},input:Object(g.jsx)(qt.a,{style:{width:"100%"}}),children:[Object(g.jsx)(xt.a,{value:"",children:Object(g.jsx)("em",{children:"None"})}),n.map((function(t){return Object(g.jsx)(xt.a,{value:t,children:t[e.display]},t[e.identifier])}))]})]})})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit(l),e.onClose()},variant:"contained",style:{backgroundColor:p.palette.success.main},children:e.action})]})]})}var Jo,Yo,Zo,Xo={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},es=Object(Ge.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}}));function ts(e){var t=s.a.useState("plaintext"),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState(""),f=Object(u.a)(h,2),O=f[0],x=f[1],_=s.a.useState(""),v=Object(u.a)(_,2),k=v[0],w=v[1],C=es();return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Register New Credential"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Et.a,{className:C.formControl,children:[Object(g.jsx)(Jt.a,{id:"operator-chip-label",children:"Which Type of Credential"}),Object(g.jsx)(Lt.a,{labelId:"operator-chip-label",id:"operator-chip",value:n,onChange:function(e){i(e.target.value)},input:Object(g.jsx)(qt.a,{}),MenuProps:Xo,children:["plaintext","ticket","hash","certificate","key","hex"].map((function(e){return Object(g.jsx)(xt.a,{value:e,children:Object(g.jsx)(Ba.a,{primary:e})},e)}))})]}),Object(g.jsx)(y,{value:o,onChange:function(e,t,a){l(t)},name:"Account Name"}),Object(g.jsx)(y,{value:p,onChange:function(e,t,a){m(t)},name:"Realm or Domain"}),Object(g.jsx)(y,{value:k,onChange:function(e,t,a){w(t)},name:"Comment"}),Object(g.jsx)(y,{multiline:!0,value:O,onChange:function(e,t,a){x(t)},name:"Credential"})]})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit({realm:p,account:o,comment:k,credential:O,type:n}),e.onClose()},color:"primary",variant:"contained",children:"Create"})]})]})}var as,ns,is,rs,cs,os,ss,ls,ds,us=Object(Pe.a)(Jo||(Jo=Object(q.a)(["\nmutation getDynamicParamsMutation($callback: Int!, $command: String!, $payload_type: String!, $parameter_name: String!){\n    dynamic_query_function(callback: $callback, command: $command, payload_type: $payload_type, parameter_name: $parameter_name){\n        status\n        error\n        choices\n    }\n}\n"]))),bs=Object(Pe.a)(Yo||(Yo=Object(q.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),js=Object(Pe.a)(Zo||(Zo=Object(q.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      ...credentialData\n    }\n  }\n"])),bs);function ps(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(xe.a)(),c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState([]),x=Object(u.a)(O,2),_=x[0],v=x[1],w=s.a.useState([]),C=Object(u.a)(w,2),S=C[0],D=C[1],I=s.a.useState(""),T=Object(u.a)(I,2),$=T[0],P=T[1],A=s.a.useState([]),L=Object(u.a)(A,2),q=L[0],V=L[1],G=s.a.useState(0),K=Object(u.a)(G,2),J=K[0],Y=K[1],Z=s.a.useState(0),X=Object(u.a)(Z,2),ee=X[0],ae=X[1],ne=s.a.useState([]),ie=Object(u.a)(ne,2),re=ie[0],ce=ie[1],oe=s.a.useState(0),se=Object(u.a)(oe,2),le=se[0],de=se[1],ue=s.a.useState([]),je=Object(u.a)(ue,2),pe=je[0],me=je[1],he=s.a.useState(0),fe=Object(u.a)(he,2),Oe=fe[0],ge=fe[1],ye=s.a.useState(!1),_e=Object(u.a)(ye,2),ve=_e[0],ke=_e[1],we=s.a.useState(!1),Ce=Object(u.a)(we,2),Se=Ce[0],De=Ce[1],Ie=s.a.useState({name:""}),Te=Object(u.a)(Ie,2),$e=Te[0],Pe=Te[1],Ae=Object(Ee.a)(us,{onCompleted:function(t){"success"===t.dynamic_query_function.status?(j(Object(F.a)(t.dynamic_query_function.choices)),"Choice"===e.type&&t.dynamic_query_function.choices.length>0&&(i(t.dynamic_query_function.choices[0]),e.onChange(e.name,t.dynamic_query_function.choices[0],!1))):E.warning("Failed to fetch dynamic parameter query: "+t.dynamic_query_function.error)},onError:function(e){E.warning("Failed to perform dynamic parameter query"),console.log(e)}}),Le=Object(u.a)(Ae,1)[0],Fe=Object(Ee.a)(js,{fetchPolicy:"no-cache",onCompleted:function(e){E.success("Successfully created new credential"),j([].concat(Object(F.a)(d),[Object(k.a)({},e.insert_credential_one)]))},onError:function(e){E.error("Failed to create credential"),console.log(e)}}),qe=Object(u.a)(Fe,1)[0];Object(o.useEffect)((function(){if(null!==e.dynamic_query_function&&0===d.length&&Le({variables:{callback:e.callback_id,parameter_name:e.name,command:e.commandInfo.cmd,payload_type:e.commandInfo.payloadtype.ptype}}),"Boolean"===e.type)""===n&&(f(e.value),i(e.value));else if("Array"===e.type)0===_.length&&e.value.length>0&&v(e.value);else if("ChoiceMultiple"===e.type&&null===e.dynamic_query_function)""===n&&(D(e.value),i(e.value),j(e.choices));else if("AgentConnect"===e.type)if(e.choices.length>0){var t=0;ee<e.choices.length?t=ee:ae(0),V(e.choices);var a=0;le<e.choices[t].length?a=le:de(0),ce(e.choices[t].payloads),e.choices[t].payloads.length>0?e.choices[t].payloads[a].c2info.length>0&&me(e.choices[t].payloads[a].c2info):E.warning("Mythic knows of no host with a P2P payload. Please add one.")}else V([]),me([]),E.warning("Mythic knows of no host with a P2P payload. Please add one.");else""===n&&("Number"===e.type?""===e.value?i(0):i(parseInt(e.value)):i(e.value)),null===e.dynamic_query_function&&""===n&&(j(Object(F.a)(e.choices)),i(e.value))}),[e.choices,e.default_value,e.type,e.value,f,n]);var Ne=function(t,a,n){var i=e.choices[t].payloads[a].c2info[n].parameters.reduce((function(e,t){return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,t.value))}),{}),r={host:e.choices[t].host,agent_uuid:e.choices[t].payloads[a].uuid,c2_profile:{name:e.choices[t].payloads[a].c2info[n].name,parameters:i}};"callback"===e.choices[t].payloads[a].type?r.callback_uuid=e.choices[t].payloads[a].agent_callback_id:r.callback_uuid="",e.onChange(e.name,r,!1)},Re=function(t){i(t.target.value),e.onChange(e.name,t.target.value,!1)},Be=function(t){i(t.target.value),e.onChange(e.name,d[t.target.value],!1)},ze=function(t){for(var a=t.target.options,n=[],r=0,c=a.length;r<c;r+=1)a[r].selected&&n.push(a[r].value);D(n),i(n),e.onChange(e.name,n,!1)},We=function(t,a,n){i(a),e.onChange(e.name,a,n)},Me=function(t,a,n){i(parseInt(a)),e.onChange(e.name,parseInt(a),n)},He=function(t,a){f(a),i(a),e.onChange(t,a)},Ue=function(t){var a=new FileReader;a.onload=function(a){var n=btoa(a.target.result);Pe({name:t.target.files[0].name,contents:n}),e.onChange(e.name,{name:t.target.files[0].name,contents:n})},a.readAsBinaryString(t.target.files[0])},Ve=function(t){ae(t.target.value),ce(e.choices[t.target.value].payloads),e.choices[t.target.value].payloads.length>0?(de(0),e.choices[t.target.value].payloads[0].c2info.length>0?(me(e.choices[0].payloads[0].c2info),ge(0),Ne(t.target.value,0,0)):(me([]),ge(null))):(ce([]),de(null),me([]),ge(null))},Ge=function(t){de(t.target.value),me(e.choices[ee].payloads[t.target.value].c2info),e.choices[ee].payloads[t.target.value].c2info.length>0?(ge(0),Ne(ee,t.target.value,0)):ge(null)},Ke=function(e){ge(e.target.value),Ne(ee,le,e.target.value)},Qe=function(e,t,a){P(t)},Je=function(e){Y(e.target.value)},Ye=function(){""!==$?(e.onAgentConnectAddNewPayloadOnHost($.toUpperCase(),e.payload_choices[J].id),ke(!1)):E.error("Must set a hostname")},Ze=function(){e.choices[ee].payloads[le].payloadOnHostID?e.onAgentConnectRemovePayloadOnHost(e.choices[ee].payloads[le].payloadOnHostID):E.warning("Can't remove a callback")},Xe=function(t){return(e.required&&""!==e.verifier_regex||""!==e.verifier_regex&&""!==t)&&!RegExp(e.verifier_regex).test(t)},et=function(){var t=[].concat(Object(F.a)(_),[""]);v(t),e.onChange(e.name,t,!1)},tt=function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,r=e.credential;qe({variables:{type:t,account:a,realm:n,comment:i,credential:r}})},at=s.a.useState(null),nt=Object(u.a)(at,2),it=nt[0],rt=nt[1],ct=Boolean(it),ot=function(){rt(null)};return Object(g.jsxs)(M.a,{children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)(Q.a,{"aria-haspopup":"true",onMouseEnter:function(e){rt(e.currentTarget)},onMouseLeave:ot,"aria-owns":ct?"taskparam"+e.id+"popover":void 0,children:e.display_name}),e.required?Object(g.jsx)(Q.a,{component:"div",style:{color:r.palette.warning.main},children:"Required"}):null,Object(g.jsx)(Mt.a,{id:"taskparam"+e.id+"popover",open:ct,anchorEl:it,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:ot,disableRestoreFocus:!0,elevation:5,style:{pointerEvents:"none"},PaperProps:{style:{padding:"10px",margin:"5px",backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"},variant:"outlined"},children:Object(g.jsx)(Q.a,{children:e.description.length>0?e.description:"No Description"})})]}),Object(g.jsx)(B.a,{children:function(){switch(e.type){case"Choice":case"ChoiceMultiple":return Object(g.jsx)(Et.a,{style:{width:"100%"},children:Object(g.jsx)(Lt.a,{native:!0,autoFocus:e.autoFocus,multiple:"ChoiceMultiple"===e.type,value:"ChoiceMultiple"===e.type?S:n,onChange:"ChoiceMultiple"===e.type?ze:Re,input:Object(g.jsx)(qt.a,{}),children:d.map((function(t,a){return Object(g.jsx)("option",{value:t,children:t},e.name+a)}))})});case"Array":return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:[Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"}}),Object(g.jsx)(B.a,{})]}),Object(g.jsxs)(R.a,{children:[_.map((function(t,a){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{onClick:function(){return function(t){var a=Object(F.a)(_);a.splice(t,1),v(a),e.onChange(e.name,a,!1)}(a)},color:"secondary",variant:"outlined",size:"small",children:"X"})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(y,{required:e.required,placeholder:"",value:t,multiline:!1,autoFocus:e.autoFocus&&0===a,onChange:function(t,n,i){return function(t,a,n){var i=Object(F.a)(_);i[n]=t,v(i),e.onChange(e.name,i,!1)}(n,0,a)},display:"inline-block",onEnter:et,validate:Xe,errorText:"Must match: "+e.verifier_regex})})]},"array"+e.name+a)})),Object(g.jsx)(M.a,{hover:!0,children:Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{onClick:et,size:"small",variant:"outlined",color:"primary",children:"+"})})})]})]})});case"String":return Object(g.jsx)(y,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,onChange:We,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:Xe,errorText:"Must match: "+e.verifier_regex});case"Number":return Object(g.jsx)(y,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,type:"number",onChange:Me,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:Xe,errorText:"Must match: "+e.verifier_regex});case"Boolean":return Object(g.jsx)(U.a,{checked:h,onChange:He});case"File":return Object(g.jsxs)(b.a,{variant:"contained",component:"label",children:[""===$e.name?"Select File":$e.name,Object(g.jsx)("input",{onChange:Ue,type:"file",hidden:!0})," "]});case"LinkInfo":return Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:function(t){!function(t){var a,n=(a=e.choices[t].source.id===e.callback_id?e.choices[t].source:e.choices[t].destination).c2profileparametersinstances.reduce((function(a,n){return n.c2_profile_id===e.choices[t].c2profile.id?Object(k.a)(Object(k.a)({},a),{},Object(Pt.a)({},n.c2profileparameter.name,n.c2profileparameter.crypto_type?{crypto_type:n.c2profileparameter.crypto_type,enc_key:n.enc_key,dec_key:n.dec_key}:n.value)):Object(k.a)({},a)}),{}),r={host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:e.choices[t].c2profile.name,parameters:n}};e.onChange(e.name,r,!1),i(t)}(t.target.value)},input:Object(g.jsx)(qt.a,{}),children:e.choices.map((function(t,a){return Object(g.jsx)("option",{value:a,children:t.display},e.name+a)}))})});case"PayloadList":return Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Re,input:Object(g.jsx)(qt.a,{}),children:e.choices.map((function(t,a){return Object(g.jsx)("option",{value:t.uuid,children:t.display},e.name+a)}))})});case"AgentConnect":return Object(g.jsxs)(z.a,{component:H.a,className:"mythicElement",children:[Object(g.jsx)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:Object(g.jsxs)(R.a,{children:[ve?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"6em"},children:"Hostname"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(y,{required:!0,placeholder:"hostname",value:$,multiline:!1,autoFocus:e.autoFocus,onChange:Qe,display:"inline-block"})})]}),Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Payload on that host"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:J,onChange:Je,input:Object(g.jsx)(qt.a,{}),children:e.payload_choices?e.payload_choices.map((function(t,a){return Object(g.jsx)("option",{value:a,children:t.display},e.name+"newpayload"+a)})):Object(g.jsx)("option",{value:"-1",children:"No Payloads"},e.name+"nooptionnewpayload")})})})]}),Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsxs)(b.a,{component:"span",style:{color:r.palette.success.main,padding:0},onClick:Ye,children:[Object(g.jsx)(Rt.a,{}),"Add"]})}),Object(g.jsx)(B.a,{children:Object(g.jsxs)(b.a,{component:"span",style:{color:r.palette.warning.main,padding:0},onClick:function(){ke(!1)},children:[Object(g.jsx)(Oc.a,{}),"Cancel"]})})]})]}):null,Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"6em"},children:"Host"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:ee,onChange:Ve,input:Object(g.jsx)(qt.a,{}),children:q.map((function(t,a){return Object(g.jsx)("option",{value:a,children:t.host},e.name+"connecthost"+a)}))})})})]}),Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Payload"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:le,onChange:Ge,input:Object(g.jsx)(qt.a,{}),children:re.map((function(t,a){return Object(g.jsx)("option",{value:a,children:t.display},e.name+"connectagent"+a)}))})})})]}),!ve&&Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsxs)(b.a,{component:"span",style:{color:r.palette.success.main,padding:0},onClick:function(){ke(!0)},children:[Object(g.jsx)(Rt.a,{}),"Add"]})}),Object(g.jsx)(B.a,{children:Object(g.jsxs)(b.a,{component:"span",style:{color:r.palette.error.main,padding:0},onClick:Ze,children:[Object(g.jsx)(te.a,{}),"Remove"]})})]}),Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"C2 Profile"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Et.a,{children:Object(g.jsx)(Lt.a,{native:!0,value:Oe,onChange:Ke,input:Object(g.jsx)(qt.a,{}),children:pe.map((function(t,a){return Object(g.jsx)("option",{value:a,children:t.name},e.name+"connectprofile"+a)}))})})})]})]})}),pe.length>0?Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:pe[Oe].parameters.map((function(t,a){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:t.name}),Object(g.jsx)(B.a,{children:Object(g.jsx)("pre",{children:JSON.stringify(t.value,null,2)})})]},"agentconnectparameters"+e.name+a)}))})]}):null]});case"Credential-JSON":return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:Se,onClose:function(){De(!1)},innerDialog:Object(g.jsx)(ts,{onSubmit:tt,onClose:function(){De(!1)}})}),Object(g.jsx)(Et.a,{style:{width:"100%"},children:Object(g.jsx)(Lt.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Be,input:Object(g.jsx)(qt.a,{}),children:d.map((function(t,a){return Object(g.jsx)("option",{value:a,children:t.account+"@"+t.realm+" - "+t.credential_text.substring(0,10)+" - "+t.comment},e.name+a)}))})}),Object(g.jsx)(b.a,{size:"small",color:"primary",onClick:function(){De(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Account":return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:Se,onClose:function(){De(!1)},innerDialog:Object(g.jsx)(ts,{onSubmit:tt,onClose:function(){De(!1)}})}),Object(g.jsx)(Et.a,{style:{width:"100%"},children:Object(g.jsx)(Lt.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Re,input:Object(g.jsx)(qt.a,{}),children:d.map((function(t,a){return Object(g.jsx)("option",{value:t.account,children:t.comment.length>0?t.comment+" ( "+t.account+" )":t.account},e.name+a)}))})}),Object(g.jsx)(b.a,{size:"small",color:"primary",onClick:function(){De(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Realm":return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:Se,onClose:function(){De(!1)},innerDialog:Object(g.jsx)(ts,{onSubmit:tt,onClose:function(){De(!1)}})}),Object(g.jsx)(Et.a,{style:{width:"100%"},children:Object(g.jsx)(Lt.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Re,input:Object(g.jsx)(qt.a,{}),children:d.map((function(t,a){return Object(g.jsx)("option",{value:t.realm,children:t.comment.length>0?t.comment+" ( "+t.realm+" )":t.realm},e.name+a)}))})}),Object(g.jsx)(b.a,{size:"small",color:"primary",onClick:function(){De(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Type":return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:Se,onClose:function(){De(!1)},innerDialog:Object(g.jsx)(ts,{onSubmit:tt,onClose:function(){De(!1)}})}),Object(g.jsx)(Et.a,{style:{width:"100%"},children:Object(g.jsx)(Lt.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Re,input:Object(g.jsx)(qt.a,{}),children:d.map((function(t,a){return Object(g.jsx)("option",{value:t.type,children:t.type},e.name+a)}))})}),Object(g.jsx)(b.a,{size:"small",color:"primary",onClick:function(){De(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Credential":return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:Se,onClose:function(){De(!1)},innerDialog:Object(g.jsx)(ts,{onSubmit:tt,onClose:function(){De(!1)}})}),Object(g.jsx)(Et.a,{style:{width:"100%"},children:Object(g.jsx)(Lt.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:Re,input:Object(g.jsx)(qt.a,{}),children:d.map((function(t,a){return Object(g.jsx)("option",{value:t.credential_text,style:{textOverflow:"ellipsis"},children:t.comment.length>0?t.comment+" ( "+t.credential_text+" )":t.credential_text},e.name+a)}))})}),Object(g.jsx)(b.a,{size:"small",color:"primary",onClick:function(){De(!0)},variant:"contained",children:"New Credential"})]});default:return null}}()})]},"buildparam"+e.id)}var ms,hs=Object(Pe.a)(as||(as=Object(q.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}}) {\n    id\n    command {\n      cmd\n      attributes\n      id\n    }\n  }\n}\n"]))),fs=Object(Pe.a)(ns||(ns=Object(q.a)(["\nquery getAllCommandsQuery($payload_type_id: Int!){\n    command(where: {payload_type_id: {_eq: $payload_type_id}, deleted: {_eq: false}}) {\n        attributes\n        cmd\n        id\n    }\n}\n"]))),Os=Object(Pe.a)(is||(is=Object(q.a)(["\nquery getAllEdgesQuery($callback_id: Int!){\n    callbackgraphedge(where: {_or: [{source_id:{_eq: $callback_id}}, {destination_id: {_eq: $callback_id}}]}) {\n        id\n        c2profile {\n          id\n          name\n        }\n        direction\n        destination{\n            agent_callback_id\n            host\n            id\n            payload {\n              id\n              uuid\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              value\n              id\n              c2_profile_id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        source{\n            agent_callback_id\n            host\n            id\n            payload {\n              uuid\n              id\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              c2_profile_id\n              value\n              id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        end_timestamp\n      }\n    }\n"]))),gs=Object(Pe.a)(rs||(rs=Object(q.a)(['\nquery getAllPayloadsQuery($operation_id: Int!){\n    payload(where: {deleted: {_eq: false}, build_phase: {_eq: "success"}, operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    uuid\n    payloadc2profiles {\n      id\n      c2profile {\n        name\n        id\n      }\n    }\n    payloadtype{\n        id\n        ptype\n    }\n    filemetum {\n        id\n        filename_text\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        name\n        id\n      }\n    }\n  }\n}\n']))),xs=Object(Pe.a)(cs||(cs=Object(q.a)(["\nquery getAllPayloadsOnHostsQuery($operation_id: Int!){\n    payloadonhost(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, payload: {c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}}) {\n        host\n        id\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n            c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n                c2profile {\n                    name\n                    id\n                }\n                c2profileparameter {\n                    crypto_type\n                    name\n                    id\n                }\n                value\n                enc_key_base64\n                dec_key_base64\n                id\n            }\n        }\n    }\n    callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}, c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}){\n        agent_callback_id\n        host\n        id\n        description\n        crypto_type\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n        }\n        c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n            c2profile {\n                name\n                id\n            }\n            c2profileparameter {\n                crypto_type\n                name\n                id\n            }\n            value\n            enc_key_base64\n            dec_key_base64\n            id\n        }\n    }\n}\n"]))),ys=Object(Pe.a)(os||(os=Object(q.a)(["\n    mutation addPayloadOnHostMutation($host: String!, $payload_id: Int!){\n        insert_payloadonhost(objects: {host: $host, payload_id: $payload_id}) {\n            affected_rows\n          }\n    }\n"]))),_s=Object(Pe.a)(ss||(ss=Object(q.a)(["\n    mutation removePayloadOnHostMutation($payloadOnHostID: Int!){\n        delete_payloadonhost_by_pk(id: $payloadOnHostID) {\n            id\n          }\n    }\n"]))),vs=Object(Pe.a)(ls||(ls=Object(q.a)(["\nquery getCommandQuery($id: Int!){\n  command_by_pk(id: $id) {\n    attributes\n    author\n    cmd\n    description\n    help_cmd\n    id\n    needs_admin\n    version\n    payloadtype{\n        ptype\n    }\n    commandparameters {\n      choice_filter_by_command_attributes\n      choices\n      choices_are_all_commands\n      choices_are_loaded_commands\n      default_value\n      description\n      id\n      name\n      required\n      supported_agent_build_parameters\n      supported_agents\n      type\n      dynamic_query_function\n      ui_position\n      parameter_group_name\n      display_name\n      cli_name\n    }\n    commandopsec {\n      authentication\n      id\n      injection_method\n      process_creation\n    }\n  }\n}\n"]))),ks=Object(Pe.a)(ds||(ds=Object(q.a)(["\nquery getCredentialsQuery($operation_id: Int!){\n    credential(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}}){\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n    }\n}\n"])));function ws(e){var t=Object(o.useState)({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=Object(o.useState)("Default"),p=Object(u.a)(j,2),m=p[0],h=p[1],O=Object(o.useState)([]),x=Object(u.a)(O,2),y=x[0],_=x[1],v=Object(o.useState)(!1),w=Object(u.a)(v,2),C=w[0],S=w[1],D=Object(o.useState)({all:!1,loaded:!1,edges:!1,credentials:!1}),I=Object(u.a)(D,2),T=I[0],$=I[1],P=Object(At.a)(fs,{fetchPolicy:"no-cache"}),A=Object(u.a)(P,2),E=A[0],L=A[1].data,q=Object(At.a)(hs,{fetchPolicy:"no-cache"}),U=Object(u.a)(q,2),V=U[0],G=U[1].data,K=Object(At.a)(Os,{fetchPolicy:"no-cache"}),J=Object(u.a)(K,2),Y=J[0],Z=J[1].data,X=Object(At.a)(gs,{fetchPolicy:"no-cache"}),ee=Object(u.a)(X,2),te=ee[0],ae=ee[1].data,ne=Object(At.a)(xs,{fetchPolicy:"no-cache"}),ie=Object(u.a)(ne,2),oe=ie[0],le=ie[1].data,de=Object(At.a)(ks,{fetchPolicy:"no-cache"}),ue=Object(u.a)(de,2),be=ue[0],je=ue[1].data,pe=Object(Ee.a)(ys,{onCompleted:function(t){oe({variables:{operation_id:e.operation_id}})}}),me=Object(u.a)(pe,1)[0],he=Object(Ee.a)(_s,{onCompleted:function(t){oe({variables:{operation_id:e.operation_id}})}}),fe=Object(u.a)(he,1)[0];Object(Ae.a)(vs,{variables:{id:e.command.id},onCompleted:function(t){var a={all:!1,loaded:!1,edges:!1,credentials:!1},n=[];t.command_by_pk.commandparameters.forEach((function(e){n.includes(e.parameter_group_name)||n.push(e.parameter_group_name),"LinkInfo"===e.type?a.edges=!0:e.choices_are_all_commands?a.all=!0:e.choices_are_loaded_commands?a.loaded=!0:"AgentConnect"===e.type?(a.connect=!0,a.payloads=!0):"PayloadList"===e.type?a.payloads=!0:e.type.includes("Credential")&&(a.credentials=!0)})),n.sort(),d(n),e.command.groupName&&n.includes(e.command.groupName)?h(e.command.groupName):n.includes("Default")||h(n[0]),i(Object(k.a)({},t.command_by_pk)),a.edges&&Y({variables:{callback_id:e.callback_id}}),a.all&&E({variables:{payload_type_id:e.payloadtype_id}}),a.loaded&&V({variables:{callback_id:e.callback_id}}),a.payloads&&te({variables:{operation_id:e.operation_id}}),a.connect&&oe({variables:{operation_id:e.operation_id}}),a.credentials&&be({variables:{operation_id:e.operation_id}}),$(a),S(Object(k.a)({},t))}});var Oe=function(e,t){var a=new Set(t);return Object(F.a)(new Set(e)).filter((function(e){return a.has(e)}))};Object(o.useEffect)((function(){var t=function(t){if(t.length>0){var a=t[0].payloads[0].c2info[0].parameters.reduce((function(e,t){return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,t.value))}),{}),n={host:t[0].host,agent_uuid:t[0].payloads[0].uuid,c2_profile:{name:t[0].payloads[0].c2info[0].name,parameters:a}};return"callback"===t[0].payloads[0].type&&(n.callback_uuid=e.choices[0].payloads[0].agent_callback_id),n}return{}},a=function(t){var a;if(t.length>0){var n=(a=t[0].source.id===e.callback_id?t[0].source:t[0].destination).c2profileparametersinstances.reduce((function(e,a){return a.c2_profile_id===t[0].c2profile.id?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},a.c2profileparameter.name,a.c2profileparameter.crypto_type?{crypto_type:a.c2profileparameter.crypto_type,enc_key:a.enc_key_base64,dec_key:a.dec_key_base64}:a.value)):Object(k.a)({},e)}),{});return{host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:t[0].c2profile.name,parameters:n}}}return{}};if(C&&(!T.loaded||G)&&(!T.all||L)&&(!T.edges||Z)&&(!T.payloads||ae)&&(!T.connect||le)&&(!T.credentials||je)){var n=C.command_by_pk.commandparameters.reduce((function(n,i){if(i.parameter_group_name!==m)return Object(F.a)(n);switch(i.type){case"Boolean":return i.name in e.command.parsedParameters?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):i.default_value?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:"true"===i.default_value.toLowerCase()})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:!1})]);case"String":return i.name in e.command.parsedParameters?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:i.default_value})]);case"Number":return i.name in e.command.parsedParameters?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:""===i.default_value?0:parseInt(i.default_value)})]);case"Array":return i.name in e.command.parsedParameters?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):i.default_value.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:JSON.parse(i.default_value)})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:[]})]);case"Choice":case"ChoiceMultiple":var r=i.choices.split("\n"),c=i.default_value;"ChoiceMultiple"===i.type?c=""!==i.default_value?JSON.parse(i.default_value):[]:r.length>0&&(c=""===i.default_value?r[0]:i.default_value);var o=JSON.parse(i.choice_filter_by_command_attributes);return i.choices_are_all_commands?((r=(r=Object(F.a)(L.command)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.attributes),i=0,r=Object.entries(o);i<r.length;i++){var c=Object(u.a)(r[i],2),s=c[0],l=c[1];"spawn_and_injectable"===s?l!==n[s]&&(a=!1):"supported_os"===s&&l.length>0&&0===Oe(l,n[s]).length&&(a=!1)}return a?[].concat(Object(F.a)(e),[t.cmd]):Object(F.a)(e)}),[])).sort(),r.length>0&&(c="ChoiceMultiple"===i.type?[]:r[0])):i.choices_are_loaded_commands&&(r=(r=Object(F.a)(G.loadedcommands)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.command.attributes),i=0,r=Object.entries(o);i<r.length;i++){var c=Object(u.a)(r[i],2),s=c[0],l=c[1];"spawn_and_injectable"===s?l!==n[s]&&(a=!1):"supported_os"===s&&l.length>0&&0===Oe(l,n[s]).length&&(a=!1)}return a?[].concat(Object(F.a)(e),[t.command.cmd]):Object(F.a)(e)}),[])).length>0&&(c="ChoiceMultiple"===i.type?[]:r[0]),i.name in e.command.parsedParameters?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{choices:r,value:e.command.parsedParameters[i.name]})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{choices:r,default_value:c,value:c})]);case"File":return[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:{}})]);case"Credential-JSON":return je.credential.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:je.credential[0],choices:je.credential})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:{},choices:[]})]);case"Credential-Account":return je.credential.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:je.credential[0].account,choices:je.credential})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:"",choices:[]})]);case"Credential-Realm":return je.credential.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:je.credential[0].realm,choices:je.credential})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:"",choices:[]})]);case"Credential-Type":return je.credential.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:je.credential[0].type,choices:je.credential})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:"",choices:[]})]);case"Credential-Credential":return je.credential.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:je.credential[0].credential_text,choices:je.credential})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{value:"",choices:[]})]);case"AgentConnect":var s=ae.payload.reduce((function(e,t){var a=t.payloadc2profiles.reduce((function(e,t){return[].concat(Object(F.a)(e),[t.c2profile.name])}),[]).join(",");return[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{display:t.filemetum.filename_text+" - "+a+" - "+t.tag})])}),[]),l=le.callback.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;for(var n=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[].concat(Object(F.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),i=[],r=0,c=Object.entries(n);r<c.length;r++){var o=Object(u.a)(c[r],2),s=o[0],l=o[1];i.push({name:s,parameters:l})}var d=Object(k.a)(Object(k.a)(Object(k.a)({},t.registered_payload),{},{c2info:i,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return Object(k.a)(Object(k.a)({},e),{},{payloads:[].concat(Object(F.a)(e.payloads),[d])})}return e}));if(a)return n;for(var i=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[].concat(Object(F.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],c=0,o=Object.entries(i);c<o.length;c++){var s=Object(u.a)(o[c],2),l=s[0],d=s[1];r.push({name:l,parameters:d})}var b=Object(k.a)(Object(k.a)(Object(k.a)({},t.registered_payload),{},{c2info:r,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return[].concat(Object(F.a)(e),[{host:t.host,payloads:[b]}])}),[]),d=le.payloadonhost.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;var n=!1;if(e.payloads.forEach((function(e){e.id===t.payload.id&&(n=!0)})),n)return e;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[].concat(Object(F.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],c=0,o=Object.entries(i);c<o.length;c++){var s=Object(u.a)(o[c],2),l=s[0],d=s[1];r.push({name:l,parameters:d})}var b=Object(k.a)(Object(k.a)({},t.payload),{},{c2info:r,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return Object(k.a)(Object(k.a)({},e),{},{payloads:[].concat(Object(F.a)(e.payloads),[b])})}return e}));if(a)return n;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[].concat(Object(F.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],c=0,o=Object.entries(i);c<o.length;c++){var s=Object(u.a)(o[c],2),l=s[0],d=s[1];r.push({name:l,parameters:d})}var b=Object(k.a)(Object(k.a)({},t.payload),{},{c2info:r,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return[].concat(Object(F.a)(e),[{host:t.host,payloads:[b]}])}),[]),b=l.reduce((function(e,t){var a=e.findIndex((function(e){return e.host===t.host}));return a>-1?(e[a].payloads=[].concat(Object(F.a)(e[a].payloads),Object(F.a)(t.payloads)),Object(F.a)(e)):[].concat(Object(F.a)(e),[Object(k.a)({},t)])}),Object(F.a)(d));return console.log("updating choices and payload choices",b,s),[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{choices:b,payload_choices:s,value:t(d)})]);case"PayloadList":var j=i.supported_agents.split(",");-1!==j.indexOf("")&&j.splice(j.indexOf(""));var p=JSON.parse(i.supported_agent_build_parameters),h=ae.payload.reduce((function(e,t){var a=t.payloadc2profiles.reduce((function(e,t){return[].concat(Object(F.a)(e),[t.c2profile.name])}),[]).join(",");if(j.length>0&&!j.includes(t.payloadtype.ptype))return e;var n=!0;if(t.payloadtype.ptype in p)for(var i=function(){var e=Object(u.a)(c[r],2),a=e[0],i=e[1];t.buildparameterinstances.forEach((function(e){e.buildparameter.name===a&&e.parameter!==i&&(n=!1)}))},r=0,c=Object.entries(p[t.payloadtype.ptype]);r<c.length;r++)i();return n?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{display:t.filemetum.filename_text+" - "+a+" - "+t.tag})]):e}),[]);return h.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{choices:h,default_value:h[0].uuid,value:h[0].uuid})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{choices:h,value:null})]);case"LinkInfo":var f=Z.callbackgraphedge.reduce((function(e,t){return t.source.id===t.destination.id?e:1===t.direction?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{display:"Callback "+t.source.id+" --"+t.c2profile.name+"--\x3e Callback "+t.destination.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):2===t.direction?[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{display:"Callback "+t.destination.id+"-> "+t.c2profile.name+"--\x3e Callback "+t.source.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):e}),[]);return f.length>0?[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{choices:f,value:a(f)})]):[].concat(Object(F.a)(n),[Object(k.a)(Object(k.a)({},i),{},{choices:f,value:{}})]);default:return[].concat(Object(F.a)(n),[Object(k.a)({},i)])}}),[]).sort((function(e,t){return e.ui_position>t.ui_position?1:-1}));n.length>0&&(n[0].autoFocus=!0),_(n)}}),[m,C,G,L,Z,T,ae,je,le,e.callback_id,e.choices]);var ge=function(){var t=y.reduce((function(e,t){switch(t.type){case"String":case"Boolean":case"Number":case"Choice":case"ChoiceMultiple":case"Credential-Account":case"Credential-Realm":case"Credential-Type":case"Credential-Credential":case"AgentConnect":case"PayloadList":case"Array":case"LinkInfo":return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,t.value));case"File":return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,t.value.name));case"Credential-JSON":return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,{account:t.value.account,comment:t.value.comment,credential:t.value.credential_text,realm:t.value.realm,type:t.value.type}));default:return Object(k.a)({},e)}}),{}),a=y.reduce((function(e,t){return"File"===t.type?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.name,t.value.contents)):Object(k.a)({},e)}),{});e.onSubmit(e.command.cmd,JSON.stringify(t),JSON.stringify(a),m)},xe=function(e,t){me({variables:{host:e,payload_id:t}})},ye=function(e){fe({variables:{payloadOnHostID:e}})},_e=function(e,t,a){var n=y.map((function(a){return a.name===e?Object(k.a)(Object(k.a)({},a),{},{value:t}):Object(k.a)({},a)}));_(n)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{id:"form-dialog-title",children:[e.command.cmd,"'s Parameters"]}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsxs)(Q.a,{component:"div",children:[Object(g.jsx)("b",{children:"Help"})," ",Object(g.jsx)("pre",{style:{margin:0},children:e.command.help_cmd}),Object(g.jsx)("b",{children:"Description"})," ",Object(g.jsx)("pre",{style:{margin:0,wordBreak:"break-all",overflow:"word-wrap",whiteSpace:"pre-wrap"},children:e.command.description}),Object(g.jsx)("b",{children:"Requires Admin?"})," ",e.command.needs_admin?"True":"False",l.length>1&&Object(g.jsx)(Et.a,{style:{width:"100%"},children:Object(g.jsx)(f.a,{select:!0,label:"Parameter Group",value:m,onChange:function(e){h(e.target.value)},input:Object(g.jsx)(qt.a,{}),children:l.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"paramgroup"+t)}))})})]}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:y.map((function(t){return Object(g.jsx)(ps,Object(k.a)(Object(k.a)({onSubmit:ge,onChange:_e,commandInfo:n},t),{},{callback_id:e.callback_id,onAgentConnectAddNewPayloadOnHost:xe,onAgentConnectRemovePayloadOnHost:ye}),"taskparameterrow"+t.id)}))})]})})]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:ge,variant:"contained",color:"secondary",children:"Submit"})]})]})}var Cs,Ss,Ds,Is,Ts,$s,Ps=Object(Pe.a)(ms||(ms=Object(q.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $ui_feature: String!) {\n    callback_by_pk(id: $callback_id){\n        operation_id\n        loadedcommands(where: {command: {supported_ui_features: {_ilike: $ui_feature}}}) {\n            id\n            command {\n              cmd\n              help_cmd\n              description\n              id\n              needs_admin\n              payload_type_id\n              attributes\n              commandparameters {\n                id\n                type \n              }\n              supported_ui_features\n            }\n          }\n        payload {\n            payloadtype {\n                id\n                commands(where: {script_only: {_eq: true}, deleted: {_eq: false}, supported_ui_features: {_ilike: $ui_feature }}){\n                    id\n                    cmd\n                    help_cmd\n                    description\n                    needs_admin\n                    attributes\n                    payload_type_id\n                    commandparameters {\n                        id\n                        type\n                    }\n                    supported_ui_features\n                  }\n            }\n        }\n    }\n}\n"]))),As=function(e){var t=e.callback_id,a=e.ui_feature,n=e.parameters,i=e.onTasked,r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState(!1),f=Object(u.a)(h,2),O=f[0],x=f[1],y=s.a.useState({}),_=Object(u.a)(y,2),v=_[0],w=_[1],C=Object(Ee.a)(Ud,{update:function(e,a){var n=a.data;"error"===n.createTask.status?E.error(n.createTask.error):E.success('Issued "'+v.cmd+'" to Callback '+t),i()},onError:function(e){console.error(e),i()}}),S=Object(u.a)(C,1)[0],D=Object(Ae.a)(Ps,{variables:{callback_id:t,ui_feature:"%"+a+"%"},onCompleted:function(e){var t=e.callback_by_pk.loadedcommands.reduce((function(e,t){return[].concat(Object(F.a)(e),[t.command])}),[]),n=e.callback_by_pk.payload.payloadtype.commands.reduce((function(e,t){return[].concat(Object(F.a)(e),[t])}),Object(F.a)(t));d(n),0===n.length?E.warning("No commands currently loaded that support the "+a+" feature"):1===n.length?w(Object(k.a)({},n[0])):(w({}),m(!0))},fetchPolicy:"network-only"}).data;return Object(o.useEffect)((function(){void 0!==v.commandparameters&&(v.commandparameters.length>0?void 0===n||null===n?x(!0):S("string"===typeof n?{variables:{callback_id:t,command:v.cmd,params:n}}:{variables:{callback_id:t,command:v.cmd,params:JSON.stringify(n),tasking_location:"browserscript"}}):S(void 0===n||null===n?{variables:{callback_id:t,command:v.cmd,params:""}}:"string"===typeof n?{variables:{callback_id:t,command:v.cmd,params:n}}:{variables:{callback_id:t,command:v.cmd,params:JSON.stringify(n),tasking_location:"browserscript"}}))}),[v]),Object(g.jsxs)("div",{children:[p&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(Qo,{onClose:function(){m(!1)},onSubmit:function(e){w(e)},options:l,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),O&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:O,onClose:function(){x(!1)},innerDialog:Object(g.jsx)(ws,{command:v,callback_id:t,payloadtype_id:D.callback_by_pk.payload.payloadtype.id,operation_id:D.callback_by_pk.operation_id,onSubmit:function(e,a,n){x(!1),S({variables:{callback_id:t,command:e,params:a,files:n,tasking_location:"modal"}})},onClose:function(){x(!1)}})})]})},Es=Object(Ge.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),Ls=function(e){switch(e.toLowerCase()){case"openfolder":case"folder":return oa.u;case"closedfolder":return oa.t;case"archive":case"zip":return oa.k;case"diskimage":return oa.c;case"executable":return oa.q;case"word":return oa.r;case"excel":return oa.m;case"powerpoint":return oa.p;case"pdf":case"adobe":return oa.o;case"database":return oa.f;case"key":return oa.v;case"code":case"source":return oa.l;case"download":return oa.g;case"upload":return oa.B;case"png":case"jpg":case"image":return oa.n;default:return oa.j}},Fs=function(e){var t=e.cellData,a=(e.rowData,Es());return Object(g.jsxs)("div",{style:Object(k.a)({},t.cellStyle),children:[(null===t||void 0===t?void 0:t.copyIcon)?Object(g.jsx)(K.a,{onClick:function(){Lo(t.plaintext)?E.success("Copied text!"):E.error("Failed to copy text")},children:Object(g.jsx)(ca.a,{icon:oa.e})}):null,(null===t||void 0===t?void 0:t.startIcon)?Object(g.jsx)(gc.a,{title:(null===t||void 0===t?void 0:t.startIconHoverText)||"",arrow:!0,classes:{tooltip:a.tooltip,arrow:a.arrow},children:Object(g.jsx)("span",{children:Object(g.jsx)(ca.a,{icon:Ls(null===t||void 0===t?void 0:t.startIcon),style:{marginRight:"5px"}})})}):null,t.plaintextHoverText?Object(g.jsx)(gc.a,{title:t.plaintextHoverText,arrow:!0,classes:{tooltip:a.tooltip,arrow:a.arrow},children:Object(g.jsx)("pre",{style:{display:"inline-block"},children:(null===t||void 0===t?void 0:t.plaintext)||" "})}):Object(g.jsx)("pre",{style:{display:"inline-block"},children:(null===t||void 0===t?void 0:t.plaintext)||" "}),(null===t||void 0===t?void 0:t.endIcon)?Object(g.jsx)(gc.a,{title:(null===t||void 0===t?void 0:t.endIconHoverText)||"",arrow:!0,classes:{tooltip:a.tooltip,arrow:a.arrow},children:Object(g.jsxs)("span",{children:[Object(g.jsx)(ca.a,{icon:Ls(null===t||void 0===t?void 0:t.endIcon)})," "]})}):null]})},qs=function(e){var t=e.cellData;try{var a=parseInt(t.plaintext);if(""===t.plaintext)return"";if(0===a)return"0 Bytes";var n=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,n)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}catch(i){return(null===t||void 0===t?void 0:t.plaintext)||""}},Ns=function(e){var t=e.cellData,a=Es();return Object(g.jsx)("div",{style:Object(k.a)({},t.cellStyle),children:t.plaintextHoverText?Object(g.jsx)(gc.a,{title:t.plaintextHoverText,arrow:!0,classes:{tooltip:a.tooltip,arrow:a.arrow},children:Object(g.jsx)("pre",{style:{display:"inline-block"},children:qs({cellData:t})})}):Object(g.jsx)("pre",{style:{display:"inline-block"},children:qs({cellData:t})})})},Rs=function(e){var t=e.cellData,a=e.callback_id,n=(e.rowData,Object(xe.a)()),i=s.a.useState(!1),r=Object(u.a)(i,2),c=r[0],l=r[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=Object(o.useRef)(null),f=s.a.useState(!1),O=Object(u.a)(f,2),x=O[0],y=O[1],_=s.a.useState({}),v=Object(u.a)(_,2),w=v[0],C=v[1],S=Es(),D=function(e){h.current&&h.current.contains(e.target)||y(!1)},I=function(){m(!1),C({})},T=function(){l(!1),C({})};return Object(g.jsxs)("div",{style:Object(k.a)({},t.cellStyle),children:[t.plaintext?t.plaintext:null,t.button?function(){var e,i,r,o,d,u,j,f,O,_,v,$;switch(t.button.type.toLowerCase()){case"dictionary":return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(gc.a,{title:(null===t||void 0===t||null===(e=t.button)||void 0===e?void 0:e.hoverText)||"Display Data",arrow:!0,classes:{tooltip:S.tooltip,arrow:S.arrow},children:Object(g.jsx)(b.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return l(!0)},disabled:(null===t||void 0===t||null===(i=t.button)||void 0===i?void 0:i.disabled)||!1,children:(null===t||void 0===t||null===(r=t.button)||void 0===r?void 0:r.name)||" "})}),c&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:c,onClose:function(){l(!1)},innerDialog:Object(g.jsx)(pe,{title:(null===t||void 0===t||null===(o=t.button)||void 0===o?void 0:o.title)||"Title Here",leftColumn:(null===t||void 0===t||null===(d=t.button)||void 0===d?void 0:d.leftColumnTitle)||"Left Column",rightColumn:(null===t||void 0===t||null===(u=t.button)||void 0===u?void 0:u.rightColumnTitle)||"Right Column",value:(null===t||void 0===t||null===(j=t.button)||void 0===j?void 0:j.value)||{},onClose:function(){l(!1)}})})]});case"task":return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(gc.a,{title:(null===t||void 0===t||null===(f=t.button)||void 0===f?void 0:f.hoverText)||"Issues Task to Agent",arrow:!0,classes:{tooltip:S.tooltip,arrow:S.arrow},children:Object(g.jsx)(b.a,{size:"small",onClick:function(){return m(!0)},disabled:(null===t||void 0===t||null===(O=t.button)||void 0===O?void 0:O.disabled)||!1,variant:"contained",color:"secondary",children:(null===t||void 0===t||null===(_=t.button)||void 0===_?void 0:_.name)||" "})}),p&&Object(g.jsx)(As,{ui_feature:(null===t||void 0===t||null===(v=t.button)||void 0===v?void 0:v.ui_feature)||" ",callback_id:a,parameters:(null===t||void 0===t||null===($=t.button)||void 0===$?void 0:$.parameters)||"",onTasked:function(){return m(!1)}})]});case"link":return Object(g.jsx)(s.a.Fragment,{});case"menu":return Object(g.jsxs)(s.a.Fragment,{children:[p&&Object(g.jsx)(As,{ui_feature:w.ui_feature,callback_id:a,parameters:w.parameters,onTasked:I}),c&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:c,onClose:T,innerDialog:Object(g.jsx)(pe,{title:w.title,leftColumn:w.leftColumnTitle,rightColumn:w.rightColumnTitle,value:w.value,onClose:T})}),Object(g.jsx)(b.a,{ref:h,size:"small",onClick:function(){y(!0)},color:"primary",variant:"contained",children:t.button.name}),Object(g.jsx)(gt.a,{open:x,anchorEl:h.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var a=e.TransitionProps,i=e.placement;return Object(g.jsx)(Ot.a,Object(k.a)(Object(k.a)({},a),{},{style:{transformOrigin:"bottom"===i?"center top":"center bottom"},children:Object(g.jsx)(H.a,{variant:"outlined",style:{backgroundColor:"dark"===n.palette.type?n.palette.primary.dark:n.palette.primary.light,color:"white"},children:Object(g.jsx)(ft.a,{onClickAway:D,children:Object(g.jsx)(yt.a,{id:"split-button-menu",children:t.button.value.map((function(e,a){return Object(g.jsx)(xt.a,{disabled:e.disabled,onClick:function(e){return function(e,a){switch(t.button.value[a].type.toLowerCase()){case"task":C(t.button.value[a]),m(!0);break;case"dictionary":C(t.button.value[a]),l(!0)}y(!1)}(0,a)},children:e.name},e.name+a)}))})})})}))}})]})}}():null]})},Bs=function(e){var t=e.columnData,a=e.dataKey,n=e.rowData;return function(){switch(t.format){case"string":return Object(g.jsx)(Fs,{cellData:n[a],rowData:n});case"size":return Object(g.jsx)(Ns,{cellData:n[a],rowData:n});case"button":return Object(g.jsx)(Rs,{callback_id:t.callback_id,cellData:n[a],rowData:n});default:return Object(g.jsx)(Fs,{cellData:n[a],rowData:n})}}()},zs=function(){return Object(g.jsx)("div",{children:"NO DATA"})},Ws=function(e){var t=e.table,a=e.callback_id,n=Object(xe.a)(),i=s.a.useState([]),r=Object(u.a)(i,2),c=r[0],l=r[1],d=s.a.useRef([]),b=s.a.useState(""),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState({}),f=Object(u.a)(h,2),O=f[0],x=f[1],y=s.a.useRef(null),_=s.a.useState("ASC"),v=Object(u.a)(_,2),w=v[0],C=v[1],S=function(e){var t=e.index;return t<0?{backgroundColor:n.pageHeader.main,color:n.pageHeaderText.main}:d.current[t].rowStyle||{}},D=function(e){var a=e.sortBy,n=e.sortDirection,i=Object(F.a)(d.current),r=t.headers.filter((function(e){return e.plaintext===a}))[0].type;"number"===r||"size"===r?i.sort((function(e,t){return parseInt(e[a].plaintext)>parseInt(t[a].plaintext)?1:-1})):"date"===r?i.sort((function(e,t){return new Date(e[a].plaintext)>new Date(t[a].plaintext)?1:-1})):i.sort((function(e,t){return void 0===e[a].plaintext?-1:void 0===t[a].plaintext||e[a].plaintext.toLowerCase()>t[a].plaintext.toLowerCase()?1:-1})),"DESC"===n&&i.reverse(),d.current=Object(F.a)(i),m(a),C(n)},I=function(e){var t=e.index;return d.current[t]},T=s.a.useCallback((function(e){var a,n=e.event,i=e.dataKey,r=e.deltaX;n.preventDefault(),n.stopPropagation();for(var c=Object(k.a)({},O),o=r/y.current.offsetWidth,s="",l=0;l<t.headers.length;l++)t.headers[l].plaintext===i&&l+1<t.headers.length&&(s=t.headers[l+1].plaintext);if(""!==s){var d=Object(k.a)(Object(k.a)({},c),{},(a={},Object(Pt.a)(a,i,c[i]+o),Object(Pt.a)(a,s,c[s]-o),a));x(d)}else console.log("next header not found")}),[O]),$=s.a.useCallback((function(e){e.columnData;var t=e.dataKey,a=(e.disableSort,e.label),n=e.sortBy,i=e.sortDirection;return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)("span",{style:{display:"inline-flex",flexDirection:"row",alignContent:"stretch",justifyContent:"flex-start"},children:[a,n===a?"ASC"===i?Object(g.jsx)(Vo.a,{}):Object(g.jsx)(Ko.a,{}):null]}),Object(g.jsx)(Ho.a,{axis:"x",defaultClassName:"DragHandle",defaultClassNameDragging:"DragHandleActive",onDrag:function(e,a){var n=a.deltaX;return T({event:e,dataKey:t,deltaX:n})},position:{x:0},zIndex:999,children:Object(g.jsx)("span",{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"DragHandleIcon",style:{width:"20px",textAlign:"center"},children:"\u22ee"})})]},"header"+t)}),[T]);return Object(o.useEffect)((function(){var e=t.headers.reduce((function(e,t){return t.width?e:e+1}),0),a=100-t.headers.reduce((function(e,t){return t.width?e+t.width:e}),0),n=t.headers.reduce((function(t,n){return Object(k.a)(Object(k.a)({},t),{},Object(Pt.a)({},n.plaintext,n.width?n.width/100:a/e/100))}),{});x(Object(k.a)({},n))}),[t.headers]),Object(o.useEffect)((function(){d.current=Object(F.a)(t.rows)}),[t.rows]),Object(o.useEffect)((function(){var e=t.headers.map((function(e){return{dataKey:e.plaintext,label:e.plaintext,width:O[e.plaintext]*y.current.offsetWidth,columnData:{format:void 0===e.type?"string":e.type,callback_id:a},cellRenderer:Bs,headerRenderer:$}}));l(e),e.length>0&&m(e[0].dataKey)}),[t.headers,O,y.current]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:n.pageHeader.main,color:n.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:t.title})}),Object(g.jsx)("div",{style:{height:"calc(45vh)",width:"100%"},ref:y,children:Object(g.jsx)(Wo.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(Wo.c,{height:t,width:a,headerHeight:25,noRowsRenderer:zs,rowCount:d.current.length,rowGetter:I,rowHeight:35,rowStyle:S,sort:D,sortBy:p,sortDirection:w,children:c.map((function(e){return Object(g.jsx)(Wo.b,Object(k.a)({},e),"col"+e.dataKey)}))})}})})]})},Ms=Object(Ge.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),Hs=function(e){var t,a,n,i,r=Ms();return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("pre",{style:{display:"inline-block"},children:(null===(t=e.download)||void 0===t?void 0:t.plaintext)||""}),Object(g.jsx)(gc.a,{title:(null===e||void 0===e||null===(a=e.dowload)||void 0===a?void 0:a.hoverText)||"Download payload",arrow:!0,classes:{tooltip:r.tooltip,arrow:r.arrow},children:Object(g.jsx)(b.a,{variant:(null===(n=e.download)||void 0===n?void 0:n.variant)||"contained",component:"a",target:"_blank",color:"primary",href:"/api/v1.4/files/download/"+e.download.agent_file_id,download:!0,startIcon:Object(g.jsx)(wc.a,{}),children:(null===(i=e.download)||void 0===i?void 0:i.name)||""})}),Object(g.jsx)("br",{})]})},Us=a(883),Vs=Object(Ge.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),Gs=function(e){var t,a,n,i=Vs();return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap"},children:(null===(t=e.search)||void 0===t?void 0:t.plaintext)||""}),Object(g.jsx)(gc.a,{title:(null===(a=e.search)||void 0===a?void 0:a.hoverText)||"View on Search Page",arrow:!0,classes:{tooltip:i.tooltip,arrow:i.arrow},children:Object(g.jsx)(Us.a,{component:"a",target:"_blank",href:window.location.origin+"/new/search/?"+e.search.search,children:(null===(n=e.search)||void 0===n?void 0:n.name)||""})}),Object(g.jsx)("br",{})]})},Ks=a(69),Qs=a.n(Ks),Js=Object(Pe.a)(Cs||(Cs=Object(q.a)(["\nsubscription subResponsesQuery($task_id: Int!, $fetchLimit: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, limit: $fetchLimit, order_by: {id: desc}) {\n    id\n    response: response_text\n  }\n}"]))),Ys=Object(Pe.a)(Ss||(Ss=Object(q.a)(["\nquery subResponsesQuery($task_id: Int!, $fetchLimit: Int!, $offset: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}, limit: $fetchLimit, offset: $offset, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),Zs=Object(Pe.a)(Ds||(Ds=Object(q.a)(["\nquery subResponsesQuery($task_id: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_text: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),Xs=Object(Pe.a)(Is||(Is=Object(q.a)(["\nquery getBrowserScriptsQuery($command_id: Int!, $operator_id: Int!, $operation_id: Int!){\n  browserscript(where: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}, operator_id: {_eq: $operator_id}}) {\n    script\n    id\n  }\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}}}) {\n    browserscript {\n      script\n      id\n    }\n  }\n}\n\n"]))),el=function(e){var t,a,n,i,r=Object(xe.a)(),c=s.a.useState(!0),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState(""),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState([]),O=Object(u.a)(f,2),x=O[0],_=O[1],v=s.a.useState({}),w=Object(u.a)(v,2),S=w[0],D=w[1],I=s.a.useRef(),$=Object(T.a)(C),P=s.a.useState(0),A=Object(u.a)(P,2),L=A[0],q=A[1],N=s.a.useState(0),R=Object(u.a)(N,2),B=R[0],z=R[1],W=s.a.useState(""),M=Object(u.a)(W,2),H=M[0],U=M[1],V=s.a.useState(!1),G=Object(u.a)(V,2),Q=G[0],J=G[1];Object(ct.a)(Js,{variables:{task_id:e.task.id,fetchLimit:e.fetchLimit},fetchPolicy:"network_only",onSubscriptionData:function(t){var a=t.subscriptionData;if(0!==B||a.data.response.length!==e.fetchLimit){if(B>=e.fetchLimit)console.log("got more than we can see currently");else if(a.data.response.length>0){var n=a.data.response.filter((function(e){return e.id>L}));n.sort((function(e,t){return e.id>t.id?1:-1}));for(var i=m,r=Object(F.a)(x),c=L,o=B,s=0;s<n.length&&o<e.fetchLimit;s++)i+=n[s].response,r.push(n[s].response),c=n[s].id,o+=1;h(i),_(r),q(c),z(o)}}else te({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%_%"}})}});var Y=function(e){var t=Object(k.a)({},e);if(""===H)return e;if(void 0!==e.plaintext&&(e.plaintext.includes(H)||(t.plaintext="")),void 0!==e.table&&e.table.length>0){var a=e.table.map((function(e){var t=e.rows.filter((function(e){for(var t=!1,a=0,n=Object.values(e);a<n.length;a++){var i=n[a];void 0!==i.plaintext&&String(i.plaintext).includes(H)&&(t=!0),void 0!==i.button&&void 0!==i.button.value&&JSON.stringify(i.button.value).includes(H)&&(t=!0)}return t}));return Object(k.a)(Object(k.a)({},e),{},{rows:t})}));t.table=a}return t};Object(o.useEffect)((function(){if(void 0===I.current)b(!1);else if(b(e.viewBrowserScript),e.viewBrowserScript&&void 0!==I.current)try{var t=I.current(e.task,x);D(Y(t))}catch(a){b(!1)}}),[e.viewBrowserScript]);var Z=Object(At.a)(Xs,{fetchPolicy:"network-only",onCompleted:function(t){if(t.browserscriptoperation.length>0)try{atob(t.browserscriptoperation[0].script);b(!0)}catch(r){E.error(r.toString()),b(!1)}else if(t.browserscript.length>0)try{var a=atob(t.browserscript[0].script),n=Function('"use strict";return('+a+")")();I.current=n,b(!0);var i=I.current(e.task,x);D(Y(i))}catch(r){E.error(r.toString()),b(!1)}else b(!1)},onError:function(e){console.log(e)}}),X=Object(u.a)(Z,1)[0],ee=Object(At.a)(Ys,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.response.reduce((function(e,t){return e+t.response}),""),n=t.response.reduce((function(e,t){return t.id>e?t.id:e}),L);q(n),h(a);var i=t.response.map((function(e){return e.response}));if(_(i),d&&void 0!==I.current)try{var r=I.current(e.task,i);D(Y(r))}catch(c){console.log(c),b(!1)}z(t.response.length),(""!==e.searchText||Q)&&(J(!1),e.changeTotalCount(t.response_aggregate.aggregate.count))},onError:function(e){E.error("Failed to fetch more responses: "+e)}}),te=Object(u.a)(ee,1)[0],ae=Object(At.a)(Zs,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.response.reduce((function(e,t){return e+t.response}),""),n=t.response.reduce((function(e,t){return t.id>e?t.id:e}),L);q(n),h(a);var i=t.response.map((function(e){return e.response}));if(_(i),d&&void 0!==I.current)try{var r=I.current(e.task,i);D(Y(r))}catch(c){b(!1),console.log(c)}z(t.response.length),e.changeTotalCount(0)},onError:function(e){}}),ne=Object(u.a)(ae,1)[0];Object(o.useEffect)((function(){void 0!==e.command_id&&X({variables:{command_id:e.command_id,operator_id:$.user.user_id,operation_id:$.user.current_operation_id}})}),[e.command_id]),Object(o.useEffect)((function(){if(void 0!==I.current)try{var t=I.current(e.task,x);D(Y(t))}catch(a){b(!1),console.log(a)}}),[x]),Object(o.useEffect)((function(){void 0===e.searchText||""===e.searchText?te({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:e.fetchLimit*(e.currentPage-1),search:"%_%"}}):te({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:e.fetchLimit*(e.currentPage-1),search:"%"+e.searchText+"%"}})}),[e.currentPage]),Object(o.useEffect)((function(){void 0===e.searchText||""===e.searchText?te({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%_%"}}):te({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%"+e.searchText+"%"}})}),[e.searchText]),Object(o.useEffect)((function(){e.selectAllOutput?(J(!0),ne({variables:{task_id:e.task.id,search:"%"+e.searchText+"%"}})):(q(0),z(0),te({variables:{task_id:e.task.id,fetchLimit:e.fetchLimit,offset:0,search:"%"+e.searchText+"%"}}))}),[e.selectAllOutput]);var ie=s.a.useCallback((function(){e.onSubmitSearch(H)}),[H]);return Object(g.jsxs)(s.a.Fragment,{children:[e.searchOutput&&Object(g.jsx)(y,{value:H,autoFocus:!0,onEnter:ie,onChange:function(e,t,a){return U(t)},placeholder:"Search Output of This Task",name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:ie,children:Object(g.jsx)(Qs.a,{style:{color:r.palette.info.main}})})})}),style:{padding:0}}}),Object(g.jsx)("div",{style:{overflow:"auto",maxWidth:"100%",width:"100%"},children:d&&S?Object(g.jsxs)(s.a.Fragment,{children:[(null===S||void 0===S||null===(t=S.screenshot)||void 0===t?void 0:t.map((function(t,a){return Object(g.jsx)(Bo,Object(k.a)({},t),"screenshot"+a+"fortask"+e.task.id)})))||null,(null===S||void 0===S?void 0:S.plaintext)&&Object(g.jsx)(zo,{plaintext:S.plaintext}),(null===S||void 0===S||null===(a=S.table)||void 0===a?void 0:a.map((function(t,a){return Object(g.jsx)(Ws,{callback_id:e.task.callback_id,table:t},"tablefortask"+e.task.id+"table"+a)})))||null,(null===S||void 0===S||null===(n=S.download)||void 0===n?void 0:n.map((function(t,a){return Object(g.jsx)(Hs,{download:t},"download"+a+"fortask"+e.task.id)})))||null,(null===S||void 0===S||null===(i=S.search)||void 0===i?void 0:i.map((function(t,a){return Object(g.jsx)(Gs,{search:t},"searchlink"+a+"fortask"+e.task.id)})))||null]}):Object(g.jsx)(zo,{plaintext:m})})]})},tl=a(450),al=a.n(tl),nl=Object(Pe.a)(Ts||(Ts=Object(q.a)(["\nmutation updateComment ($task_id: Int!, $comment: String) {\n  update_task_by_pk(pk_columns: {id: $task_id}, _set: {comment: $comment}) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"]))),il=Object(Pe.a)($s||($s=Object(q.a)(["\nquery getCommentQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"])));function rl(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(il,{variables:{task_id:e.task_id},onCompleted:function(e){i(e.task_by_pk.comment)},fetchPolicy:"network-only"}),c=r.loading,l=r.error,d=Object(Ee.a)(nl,{update:function(e,t){t.data}}),j=Object(u.a)(d,1)[0];if(c)return Object(g.jsx)(Ze.a,{});if(l)return console.error(l),Object(g.jsx)("div",{children:"Error!"});var p=function(){j({variables:{task_id:e.task_id,comment:n}}),e.onClose()};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Edit Task Comment"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{autoFocus:!0,onEnter:p,onChange:function(e,t,a){i(t)},value:n})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:p,variant:"contained",color:"secondary",children:"Submit"})]})]})}var cl,ol,sl,ll,dl,ul=a(448),bl=a.n(ul),jl=Object(Pe.a)(cl||(cl=Object(q.a)(["\nmutation addTaskTag ($task_id: Int!, $tag: String!) {\n  insert_tasktag_one(object: {task_id: $task_id, tag: $tag}){\n    id\n  }\n}\n"]))),pl=Object(Pe.a)(ol||(ol=Object(q.a)(["\nmutation removeTaskTag($tasktag_id: Int!){\n  delete_tasktag_by_pk(id: $tasktag_id){\n    id\n  }\n}\n"]))),ml=Object(Pe.a)(sl||(sl=Object(q.a)(["\nquery getTaskTags ($operation_id: Int!) {\n  tasktag(where: {operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    task_id\n  }\n}\n"]))),hl=Object(Ge.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}}));function fl(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function Ol(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}function gl(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(T.a)(C),c=Object(Ae.a)(ml,{variables:{operation_id:r.user.current_operation_id},onCompleted:function(t){var a=t.tasktag.reduce((function(t,a){return a.task_id===e.task_id?[].concat(Object(F.a)(t),[a]):Object(F.a)(t)}),[]),n=t.tasktag.reduce((function(e,t){return e.find((function(e){return e.tag===t.tag}))||a.find((function(e){return e.tag===t.tag}))?Object(F.a)(e):[].concat(Object(F.a)(e),[t])}),[]);D(n),A(a),R(Object(F.a)(a))},fetchPolicy:"network-only"}),l=c.loading,d=c.error,j=Object(Ee.a)(jl,{update:function(e,t){t.data}}),p=Object(u.a)(j,1)[0],m=Object(Ee.a)(pl,{update:function(e,t){t.data}}),h=Object(u.a)(m,1)[0],f=hl(),O=s.a.useState([]),x=Object(u.a)(O,2),_=x[0],v=x[1],k=s.a.useState([]),w=Object(u.a)(k,2),S=w[0],D=w[1],I=s.a.useState([]),$=Object(u.a)(I,2),P=$[0],A=$[1],L=s.a.useState([]),q=Object(u.a)(L,2),N=q[0],R=q[1],B=Ol(_,S),z=Ol(_,P),W=function(e){return function(){var t=_.indexOf(e),a=Object(F.a)(_);-1===t?a.push(e):a.splice(t,1),v(a)}},M=function(e,t){return Object(g.jsx)(H.a,{className:f.paper,style:{width:"100%"},children:Object(g.jsxs)(Ke.a,{children:[Object(g.jsx)(Wa.a,{className:f.cardHeader,title:e}),Object(g.jsx)(Ma.a,{}),Object(g.jsxs)(qa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[t.map((function(e){var t="transfer-list-item-".concat(e.id,"-label");return Object(g.jsxs)(Na.a,{style:{padding:0},role:"listitem",button:!0,onClick:W(e),children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(za.a,{checked:-1!==_.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":t}})}),Object(g.jsx)(Ba.a,{id:t,primary:e.tag})]},e.id)})),Object(g.jsx)(Na.a,{})]})]})})};if(l)return Object(g.jsx)(Ze.a,{});if(d)return console.error(d),Object(g.jsx)("div",{children:"Error!"});return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Edit Task Tags"}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsxs)(Ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:f.root,children:[Object(g.jsx)(Ft.a,{item:!0,xs:5,children:M("Unused Tags In Operation",S)}),Object(g.jsx)(Ft.a,{item:!0,children:Object(g.jsxs)(Ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){A(P.concat(S)),D([])},disabled:0===S.length,"aria-label":"move all right",children:"\u226b"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){A(P.concat(B)),D(fl(S,B)),v(fl(_,B))},disabled:0===B.length,"aria-label":"move selected right",children:">"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){D(S.concat(z)),A(fl(P,z)),v(fl(_,z))},disabled:0===z.length,"aria-label":"move selected left",children:"<"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:f.button,onClick:function(){D(S.concat(P)),A([])},disabled:0===P.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(g.jsx)(Ft.a,{item:!0,xs:5,children:M("Applied Tags To Task",P)})]}),Object(g.jsx)(y,{autoFocus:!0,multiline:!1,name:"Add New Tag...",onChange:function(e,t,a){i(t)},value:n,style:{display:"inline-block"},InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(K.a,{style:{color:Gr.palette.success.main},variant:"contained",onClick:function(){P.find((function(e){return e.tag===n}))||S.find((function(e){return e.tag===n}))||""!==n&&A([].concat(Object(F.a)(P),[{tag:n,id:0,task_id:0}])),i("")},children:Object(g.jsx)(bl.a,{})})})}})]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){N.forEach((function(e){P.find((function(t){return t.id===e.id}))||h({variables:{tasktag_id:e.id}})})),P.forEach((function(t){N.find((function(e){return e.id===t.id}))||p({variables:{task_id:e.task_id,tag:t.tag}})})),""!==n&&p({variables:{task_id:e.task_id,tag:n}}),E.success("Updated tags"),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}var xl,yl=Object(Pe.a)(ll||(ll=Object(q.a)(["\nmutation requestOpsecBypass ($task_id: Int!) {\n    requestOpsecBypass(task_id: $task_id){\n        status\n        error\n    }\n}\n"]))),_l=Object(Pe.a)(dl||(dl=Object(q.a)(["\nquery getOPSECQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    opsec_pre_blocked\n    opsec_pre_message\n    opsec_pre_bypassed\n    opsec_pre_bypass_user{\n        username\n        id\n    }\n    opsec_post_blocked\n    opsec_pre_bypass_role\n    opsec_post_message\n    opsec_post_bypassed\n    opsec_post_bypass_role\n    opsec_post_bypass_user{\n        username\n        id\n    }\n    id\n  }\n}\n"])));function vl(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)({}),c=Object(u.a)(r,2),l=c[0],d=c[1],j=Object($.c)().enqueueSnackbar,p=Object(Ae.a)(_l,{variables:{task_id:e.task_id},onCompleted:function(e){var t="OPSEC PreCheck Message";console.log(e),null!==e.task_by_pk.opsec_pre_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_pre_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_pre_message+"\n",e.task_by_pk.opsec_post_blocked&&(t+="\nOPSEC PostCheck Message",null!==e.task_by_pk.opsec_post_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_post_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_post_message+"\n"),d(e.task_by_pk),i(t)},fetchPolicy:"network-only"}),m=p.loading,h=p.error,f=Object(Ee.a)(yl,{update:function(e,t){var a=t.data;"success"===a.requestOpsecBypass.status?j("Bypass processed successfully",{variant:"success"}):j(a.requestOpsecBypass.error,{variant:"warning"})}}),O=Object(u.a)(f,1)[0];if(m)return Object(g.jsx)(Ze.a,{});if(h)return console.error(h),Object(g.jsx)("div",{children:"Error!"});return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Request OPSEC Bypass"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{multiline:!0,onChange:function(){},value:n})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),!0===l.opsec_pre_blocked&&!l.opsec_pre_bypassed||!0===l.opsec_post_blocked&&!l.opsec_post_bypassed?Object(g.jsx)(b.a,{onClick:function(){console.log(e.task_id),O({variables:{task_id:e.task_id}}),e.onClose()},variant:"contained",color:"secondary",children:"Submit Bypass Request"}):null]})]})}var kl,wl=Object(Pe.a)(xl||(xl=Object(q.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    display_params\n    original_params\n    params\n    tasking_location\n    parameter_group_name\n    id\n  }\n}\n"])));function Cl(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(wl,{variables:{task_id:e.task_id},onCompleted:function(e){var t="Original Parameters:\n"+e.task_by_pk.original_params;t+="\n\nAgent Parameters:\n"+e.task_by_pk.params,t+="\n\nDisplay Parameters:\n"+e.task_by_pk.display_params,t+="\n\nTasking Location:\n"+e.task_by_pk.tasking_location,t+="\n\nParameter Group:\n"+e.task_by_pk.parameter_group_name,i(t)},fetchPolicy:"network-only"}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ze.a,{}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"View Task Parameters"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{multiline:!0,value:n,onChange:function(){}})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Sl=Object(Pe.a)(kl||(kl=Object(q.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    stdout\n    stderr\n    id\n  }\n}\n"])));function Dl(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(Ae.a)(Sl,{variables:{task_id:e.task_id},onCompleted:function(e){i("[STDOUT]:\n"+e.task_by_pk.stdout+"\n[STDERR]:\n"+e.task_by_pk.stderr)},fetchPolicy:"network-only"}),c=r.loading,l=r.error;return c?Object(g.jsx)(Ze.a,{}):l?(console.error(l),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"View Task Stdout/Stderr"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{multiline:!0,value:n,onChange:function(){}})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Il,Tl,$l=a(449),Pl=a.n($l),Al=a(270),El=a.n(Al),Ll=a(185),Fl=a.n(Ll),ql=a(186),Nl=a.n(ql),Rl=Object(Pe.a)(Il||(Il=Object(q.a)(["\nfragment allTokenData on token {\n    id\n    Address\n    AppContainer\n    AppContainerNumber\n    AppContainerSid\n    AppId\n    AppModelPolicies\n    AppModelPolicyDictionary\n    AttributesFlags\n    AuditPolicy\n    AuthenticationId_id\n    BnoIsolationPrefix\n    CanSynchronize\n    Capabilities\n    CreationTime\n    DefaultDacl\n    DenyOnlyGroups\n    DeviceClaimAttributes\n    DeviceGroups\n    Elevated\n    ElevationType\n    EnabledGroups\n    ExpirationTime\n    Filtered\n    Flags\n    FullPath\n    GrantedAccess\n    GrantedAccessGeneric\n    GrantedAccessMask\n    GroupCount\n    Groups\n    Handle\n    HandleReferenceCount\n    HasRestrictions\n    ImpersonationLevel\n    Inherit\n    IntegrityLevel\n    IntegrityLevelSid\n    IsClosed\n    IsContainer\n    IsPseudoToken\n    IsRestricted\n    IsSandbox\n    LogonSid\n    LowPrivilegeAppContainer\n    MandatoryPolicy\n    ModifiedId\n    Name\n    NoChildProcess\n    NotLow\n    NtType\n    NtTypeName\n    Origin\n    Owner\n    PackageFullName\n    PackageIdentity\n    PackageName\n    PointerReferenceCount\n    PrimaryGroup\n    PrivateNamespace\n    Privileges\n    ProcessUniqueAttribute\n    ProtectFromClose\n    Restricted\n    RestrictedDeviceClaimAttributes\n    RestrictedDeviceGroups\n    RestrictedSids\n    RestrictedSidsCount\n    RestrictedUserClaimAttributes\n    SandboxInert\n    Sddl\n    SecurityAttributes\n    SecurityDescriptor\n    SessionId\n    Source\n    ThreadID\n    TokenId\n    TokenType\n    TrustLevel\n    UIAccess\n    User\n    UserClaimAttributes\n    VirtualizationAllowed\n    VirtualizationEnabled\n    WriteRestricted\n    task_id\n    logonsession {\n      id\n      LogonId\n      UserName\n      LogonDomain\n      LogonType\n      SessionId\n      Sid\n      LogonTime\n      LogonServer\n      DnsDomainName\n      Upn\n      UserFlags\n      LastSuccessfulLogon\n      LastFailedLogon\n      FailedAttemptCountSinceLastSuccessfulLogon\n      LogonScript\n      ProfilePath\n      HomeDirectory\n      HomeDirectoryDrive\n      LogoffTime\n      KickOffTime\n      PasswordLastSet\n      PasswordCanChange\n      PasswordMustChange\n      task_id\n      authenticationpackages {\n        id\n        Name\n        task_id\n      }\n    }\n}\n"]))),Bl=Object(Pe.a)(Tl||(Tl=Object(q.a)(["\n","\nquery getTokenInfo ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    ...allTokenData\n  }\n}\n"])),Rl);function zl(e){var t=Object(xe.a)(),a=Object(o.useState)([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(o.useState)([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=Object(o.useState)([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=["Address","AppContainer","AppContainerNumber","AppContainerSid","AppId","AppModelPolicies","AppModelPolicyDictionary","AttributesFlags","AuditPolicy","AuthenticationId_id","BnoIsolationPrefix","CanSynchronize","Capabilities","CreationTime","DefaultDacl","DenyOnlyGroups","DeviceClaimAttributes","DeviceGroups","Elevated","ElevationType","EnabledGroups","ExpirationTime","Filtered","Flags","FullPath","GrantedAccess","GrantedAccessGeneric","GrantedAccessMask","GroupCount","Groups","Handle","HandleReferenceCount","HasRestrictions","ImpersonationLevel","Inherit","IntegrityLevel","IntegrityLevelSid","IsClosed","IsContainer","IsPseudoToken","IsRestricted","IsSandbox","LogonSid","LowPrivilegeAppContainer","MandatoryPolicy","ModifiedId","Name","NoChildProcess","NotLow","NtType","NtTypeName","Origin","Owner","PackageFullName","PackageIdentity","PackageName","PointerReferenceCount","PrimaryGroup","PrivateNamespace","Privileges","ProcessUniqueAttribute","ProtectFromClose","Restricted","RestrictedDeviceClaimAttributes","RestrictedDeviceGroups","RestrictedSids","RestrictedSidsCount","RestrictedUserClaimAttributes","SandboxInert","Sddl","SecurityAttributes","SecurityDescriptor","SessionId","Source","ThreadID","TokenId","TokenType","TrustLevel","UIAccess","User","UserClaimAttributes","VirtualizationAllowed","VirtualizationEnabled","WriteRestricted","task_id"],x=["LogonId","UserName","LogonDomain","LogonType","SessionId","Sid","LogonTime","LogonServer","DnsDomainName","Upn","UserFlags","LastSuccessfulLogon","LastFailedLogon","FailedAttemptCountSinceLastSuccessfulLogon","LogonScript","ProfilePath","HomeDirectory","HomeDirectoryDrive","LogoffTime","KickOffTime","PasswordLastSet","PasswordCanChange","PasswordMustChange","task_id"],y=["Name","task_id"];return Object(Ae.a)(Bl,{variables:{token_id:e.token_id},onCompleted:function(e){if(null!==e.token_by_pk){r(e.token_by_pk);var t=O.reduce((function(t,a){return void 0!==e.token_by_pk[a]&&null!==e.token_by_pk[a]&&""!==e.token_by_pk[a]?[].concat(Object(F.a)(t),[{name:a,value:e.token_by_pk[a]}]):Object(F.a)(t)}),[]);if(r(t),null!==e.token_by_pk.logonsession){var a=x.reduce((function(t,a){return void 0!==e.token_by_pk.logonsession[a]&&null!==e.token_by_pk.logonsession[a]&&""!==e.token_by_pk.logonsession[a]?[].concat(Object(F.a)(t),[{name:a,value:e.token_by_pk.logonsession[a]}]):Object(F.a)(t)}),[]);if(j(a),e.token_by_pk.logonsession.authenticationpackages.length>0){var n=e.token_by_pk.logonsession.authenticationpackages.map((function(e){return y.reduce((function(t,a){return void 0!==e[a]&&null!==e[a]&&""!==e[a]?[].concat(Object(F.a)(t),[{name:a,value:e[a]}]):Object(F.a)(t)}),[])}));f(n)}}}},onError:function(e){E.error(e)},fetchPolicy:"network-only"}),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Token Information"}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Token Data"})}),Object(g.jsx)(H.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Token Property"}),Object(g.jsx)(B.a,{children:"Token Value"})]})}),Object(g.jsx)(R.a,{children:i.map((function(e,t){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.name}),Object(g.jsx)(B.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})}),d.length>0&&Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Logon Session Data"})}),Object(g.jsx)(H.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Logon Session Property"}),Object(g.jsx)(B.a,{children:"Logon Session Value"})]})}),Object(g.jsx)(R.a,{children:d.map((function(e,t){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.name}),Object(g.jsx)(B.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"logondatarow"+t)}))})]})})})]}),h.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Authentication Package"})}),Object(g.jsx)(H.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Authentication Package Property"}),Object(g.jsx)(B.a,{children:"Authentication Package Value"})]})}),Object(g.jsx)(R.a,{children:e.map((function(t,a){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:t.name}),Object(g.jsx)(B.a,{children:!0===t.value?"True":!1===t.value?"False":t.value})]},"authpackage"+e.id+"row"+a)}))})]})})})]},"authpkg"+e.id)}))]}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Wl,Ml,Hl,Ul,Vl,Gl=a(330),Kl=a.n(Gl),Ql=a(898),Jl=a(906),Yl=a(907),Zl=a(884),Xl=a(498),ed=Object(Pe.a)(Wl||(Wl=Object(q.a)(["\nmutation reissueTaskMutation($task_id: Int!){\n  reissue_task(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),td=Object(Pe.a)(Ml||(Ml=Object(q.a)(["\nmutation reissueTaskHandlerMutation($task_id: Int!){\n  reissue_task_handler(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),ad=Object(Pe.a)(Hl||(Hl=Object(q.a)(["\nquery subResponsesQuery($task_id: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n}"]))),nd=Object(Ge.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{top:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{bottom:e.spacing(1),left:e.spacing(2)},zIndex:3},tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),id=function(e){var t=e.task,a=Object(xe.a)(),n=s.a.useState(0),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState(!0),d=Object(u.a)(l,2),b=d[0],j=d[1],p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState(!1),x=Object(u.a)(O,2),y=x[0],_=x[1],v=s.a.useState(!1),k=Object(u.a)(v,2),w=k[0],C=k[1],S=s.a.useState(!1),D=Object(u.a)(S,2),I=D[0],T=D[1],$=s.a.useState(!1),P=Object(u.a)($,2),A=P[0],L=P[1],F=s.a.useState(!1),q=Object(u.a)(F,2),N=q[0],R=q[1],B=s.a.useState(0),z=Object(u.a)(B,2),W=z[0],M=z[1],H=s.a.useState(""),U=Object(u.a)(H,2),V=U[0],G=U[1],K=s.a.useState(!1),J=Object(u.a)(K,2),Y=J[0],Z=J[1],X=s.a.useState(10),ee=Object(u.a)(X,2),te=ee[0],ae=(ee[1],s.a.useState(1)),ne=Object(u.a)(ae,2),ie=ne[0],re=ne[1],ce=s.a.useState(!1),oe=Object(u.a)(ce,2),se=oe[0],le=oe[1],de=nd(),ue=s.a.useState(!1),je=Object(u.a)(ue,2),pe=je[0],me=je[1],he=Object(At.a)(ad,{fetchPolicy:"network-only",onCompleted:function(e){var a=e.response.reduce((function(e,t){return e+t.response}),""),n=new Blob([a],{type:"text/plain"}),i=document.getElementById("download_config");if(null!==i)i.href=URL.createObjectURL(n),i.download="task_"+t.id+".txt",i.click();else{var r=document.createElement("a");r.id="download_config",r.href=URL.createObjectURL(n),r.download="task_"+t.id+".txt",document.body.appendChild(r),r.click()}},onError:function(e){}}),fe=Object(u.a)(he,1)[0],Oe=Object(Ee.a)(ed,{onCompleted:function(e){"success"===e.reissue_task.status?E.success("Successfully re-issued task to Mythic"):E.error("Failed to re-issue task to Mythic: "+e.reissue_task.error)},onError:function(e){console.log(e),E.error("Failed to re-issue task: "+e)}}),ge=Object(u.a)(Oe,1)[0],ye=Object(Ee.a)(td,{onCompleted:function(e){"success"===e.reissue_task_handler.status?E.success("Successfully resubmitted task for handling"):E.warning("Failed to resubmit task for handling: "+e.reissue_task_handler.error)},onError:function(e){console.log(e),E.error("Error resubmitting task for handling: "+e)}}),_e=Object(u.a)(ye,1)[0];Object(o.useEffect)((function(){M(null===t.command?0:t.command.id),void 0!==t.responses_aggregate&&c(t.responses_aggregate.aggregate.count)}),[t.command,t.responses_aggregate]);var ve=s.a.useCallback((function(e){c(e),re(1)}),[]),ke="top";return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(Ft.a,{container:!0,spacing:0,style:{maxWidth:"100%"},children:[Object(g.jsx)(Xl.a,{open:pe,onClick:function(){me(!1)},style:{zIndex:2,position:"absolute"}}),y?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:y,onClose:function(){_(!1)},innerDialog:Object(g.jsx)(zl,{token_id:void 0===t.token?0:t.token.id,onClose:function(){_(!1)}})}):null,A?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:A,onClose:function(){L(!1)},innerDialog:Object(g.jsx)(vl,{task_id:t.id,onClose:function(){L(!1)}})}):null,w?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:w,onClose:function(){C(!1)},innerDialog:Object(g.jsx)(Cl,{task_id:t.id,onClose:function(){C(!1)}})}):null,I?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:I,onClose:function(){T(!1)},innerDialog:Object(g.jsx)(Dl,{task_id:t.id,onClose:function(){T(!1)}})}):null,N?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:N,onClose:function(){R(!1)},innerDialog:Object(g.jsx)(gl,{task_id:t.id,onClose:function(){R(!1)}})}):null,h?Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:h,onClose:function(){f(!1)},innerDialog:Object(g.jsx)(rl,{task_id:t.id,onClose:function(){f(!1)}})}):null,Object(g.jsx)(Ft.a,{item:!0,xs:12,children:Object(g.jsx)(el,{task:t,command_id:W,viewBrowserScript:b,onSubmitSearch:function(e){G(e),""===e&&(void 0!==t.responses_aggregate?c(t.responses_aggregate.aggregate.count):c(0)),re(1)},searchOutput:Y,fetchLimit:te,currentPage:ie,searchText:V,changeTotalCount:ve,selectAllOutput:se})}),Object(g.jsxs)(Ft.a,{item:!0,xs:12,children:[Object(g.jsxs)(Jl.a,{ariaLabel:"Task Speeddial",className:de.speedDial,icon:Object(g.jsx)(Yl.a,{}),onClick:function(){me(!pe)},FabProps:{color:"primary",size:"small"},open:pe,direction:"right",children:[Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(El.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Toggle BrowserScript",onClick:function(){j(!b),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(ca.a,{icon:oa.h,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"View All Output",onClick:function(){le(!se),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(Qs.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Search Output",onClick:function(){Z(!Y),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(wc.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Download output",onClick:function(){fe({variables:{task_id:t.id}}),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(Pl.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Edit Tags",onClick:function(){R(!0),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(ca.a,{icon:oa.i,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Open Task in New Window",onClick:function(){window.open("/new/task/"+t.id,"_blank")}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(qo.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Copy original params to clipboard",onClick:function(){Lo(t.original_params)?E.success("Copied text!"):E.error("Failed to copy text"),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(al.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Edit Comment",onClick:function(){f(!0),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(Fl.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"View All Parameters",onClick:function(){C(!0),me(!1)}}),Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(ca.a,{icon:oa.b,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"View Stdout/Stderr of Task",onClick:function(){T(!0),me(!1)}}),null===t.opsec_pre_blocked?null:!1===t.opsec_pre_bypassed?Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(to.a,{style:{color:a.palette.error.main}}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Submit OPSEC PreCheck Bypass Request",onClick:function(){L(!0),me(!1)}}):Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(ro.a,{style:{color:a.palette.success.main}}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"View OPSEC PreCheck Data",onClick:function(){L(!0),me(!1)}}),null===t.opsec_post_blocked?null:!1===t.opsec_post_bypassed?Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(to.a,{style:{color:a.palette.error.main}}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Submit OPSEC PostCheck Bypass Request",onClick:function(){L(!0),me(!1)}}):Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(ro.a,{style:{color:a.palette.success.main}}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"View OPSEC PostCheck Data",onClick:function(){L(!0),me(!1)}}),null===t.token?null:Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(Nl.a,{}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"View Token Information",onClick:function(){_(!0),me(!1)}}),t.status.toLowerCase().includes("error: container")?Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(Kl.a,{style:{color:a.palette.warning.main}}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Resubmit Tasking",onClick:function(){ge({variables:{task_id:t.id}})}}):null,t.status.toLowerCase().includes("error: task")?Object(g.jsx)(Zl.a,{icon:Object(g.jsx)(Kl.a,{style:{color:a.palette.warning.main}}),arrow:!0,TooltipClasses:{tooltip:de.tooltip,arrow:de.arrow},tooltipPlacement:ke,tooltipTitle:"Resubmit Task Handler",onClick:function(){_e({variables:{task_id:t.id}})}}):null]}),Object(g.jsx)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Ql.a,{count:Math.ceil(r/te),page:ie,variant:"outlined",color:"primary",boundaryCount:2,onChange:function(e,t){re(t)},style:{margin:"10px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",r]})]})})]})]})})},rd=Object(Pe.a)(Ul||(Ul=Object(q.a)(["\nfragment taskData on task {\n  comment\n  callback_id\n  commentOperator{\n      username\n  }\n  completed\n  id\n  operator{\n      username\n  }\n  original_params\n  display_params\n  status\n  timestamp\n  command {\n    cmd\n    id\n  }\n  command_name\n  responses_aggregate {\n    aggregate{\n      count\n      max {\n        timestamp\n      }\n    }\n  }\n  opsec_pre_blocked\n  opsec_pre_bypassed\n  opsec_post_blocked\n  opsec_post_bypassed\n  tasks {\n      id\n  }\n  token {\n    id\n  }\n}\n"]))),cd=Object(Pe.a)(Vl||(Vl=Object(q.a)(["\n","\nquery getSubTasking($task_id: Int!){\n    task(where: {parent_task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n        ...taskData\n  }\n}\n "])),rd),od=Object(Ge.a)((function(e){return{root:{marginTop:"3px",marginLeft:"3px",marginRight:"0px",height:"auto",width:"99%"},heading:{fontSize:e.typography.pxToRem(15),display:"inline",cursor:"default"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"auto",display:"block",textOverflow:"ellipsis",wordBreak:"break-all",maxWidth:"100%"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",width:"100%",whiteSpace:"nowrap",display:"inline-block"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"100%",whiteSpace:"break-all",wordBreak:"break-all"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center",marginRight:0},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"}}})),sd=Object(Ge.a)((function(e){return{root:{margin:0,padding:0,height:"auto",width:"100%",whiteSpace:"break-all",wordBreak:"break-all"},content:{margin:0,height:"100%",padding:0},expandIcon:{margin:0},expanded:{marginRight:0}}}));function ld(e){return Object(g.jsx)(Eo.a,Object(k.a)(Object(k.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(g.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 11.023h-11.826q-.375 0-.669.281t-.294.682v0q0 .401.294 .682t.669.281h11.826q.375 0 .669-.281t.294-.682v0q0-.401-.294-.682t-.669-.281z"})}))}function dd(e){return Object(g.jsx)(Eo.a,Object(k.a)(Object(k.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(g.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 12.977h-4.923v4.896q0 .401-.281.682t-.682.281v0q-.375 0-.669-.281t-.294-.682v-4.896h-4.923q-.401 0-.682-.294t-.281-.669v0q0-.401.281-.682t.682-.281h4.923v-4.896q0-.401.294-.682t.669-.281v0q.401 0 .682.281t.281.682v4.896h4.923q.401 0 .682.281t.281.682v0q0 .375-.281.669t-.682.294z"})}))}var ud=Object(O.a)((function(e){return{root:{marginRight:0,paddingRight:0,width:"100%","&:hover":{backgroundColor:"none"}},iconContainer:{"& .close":{opacity:.3}},group:{marginLeft:7,paddingLeft:18,borderLeft:"1px dashed ".concat(Object(Co.c)(e.palette.text.primary,.4))}}}))((function(e){return Object(g.jsx)(Ao.a,Object(k.a)({},e))}));function bd(e){var t=e.task,a=e.filterOptions,n=od(),i=s.a.useState([]),r=Object(u.a)(i,2),c=r[0],o=r[1],l=s.a.useCallback((function(e,t){if(t){if(c.includes("treenode:"+e))return;o([].concat(Object(F.a)(c),["treenode:"+e]))}else{var a=c.reduce((function(t,a){return a==="treenode:"+e?Object(F.a)(t):[].concat(Object(F.a)(t),[a])}),[]);o(a)}}),[c]);return Object(g.jsx)(Po.a,{className:n.root,expanded:c,children:Object(g.jsx)(fd,{task:t,filterOptions:a,nodesSelected:c,toggleSelection:l})})}var jd,pd=s.a.memo(bd),md=function(e){var t=e.task,a=e.theme;return t.status.toLowerCase().includes("error")?Object(g.jsx)(Q.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.error.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"cleared"===t.status?Object(g.jsx)(Q.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"cleared"}):t.completed?null:"submitted"===t.status?Object(g.jsx)(Q.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"processing"===t.status?Object(g.jsx)(Q.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):t.opsec_pre_blocked&&!t.opsec_pre_bypassed?Object(g.jsx)(Q.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (PRE)"}):t.opsec_post_blocked&&!t.opsec_post_bypassed?Object(g.jsx)(Q.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (POST)"}):Object(g.jsx)(Q.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()})},hd=function(e){var t=e.task,a=e.theme,n=e.children,i=s.a.useState(a.palette.info.main),r=Object(u.a)(i,2),c=r[0],l=r[1];return Object(o.useEffect)((function(){t.status.toLowerCase().includes("error")?l(a.palette.error.main):"cleared"===t.status.toLowerCase()?l(a.palette.warning.main):t.completed?l(a.palette.success.main):"submitted"===t.status?l(a.palette.info.main):t.opsec_pre_blocked&&!t.opsec_pre_bypassed||t.opsec_post_blocked&&!t.opsec_post_bypassed||"processing"===t.status.toLowerCase()?l(a.palette.warning.main):l(a.palette.info.main)}),[t.status,t.completed]),Object(g.jsx)("span",{style:{display:"flex",margin:0,borderWidth:0,padding:0,minHeight:"48px",alignItems:"center",height:"100%",borderLeft:"6px solid "+c,paddingLeft:"5px",width:"100%"},children:n})},fd=function e(t){var a=t.task,n=t.filterOptions,i=t.nodesSelected,r=t.toggleSelection,c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState({task:[]}),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),O=Object(u.a)(f,2),x=O[0],y=O[1],_=s.a.useState(!0),v=Object(u.a)(_,2),k=v[0],w=v[1],S=Object(T.a)(C),D=Object(At.a)(cd,{onError:function(e){console.error(e)},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,onCompleted:function(e){if(!i.includes("treenode:"+a.id))return E(),void y(!1);A(2e3),h(e)}}),I=Object(u.a)(D,2),$=I[0],P=I[1],A=P.startPolling,E=P.stopPolling,L=s.a.useCallback((function(e){if(!x)return r(a.id,!0),y(!0),void $({variables:{task_id:a.id}});r(a.id,!1)}),[x]);Object(o.useEffect)((function(){if(a.display_params.includes("help")&&a.operator.username!==S.user.username)w(!1);else if(void 0!==n)if(n.operatorsList.length>0&&!n.operatorsList.includes(a.operator.username))k&&w(!1);else if(n.commentsFlag&&""===a.comment)k&&w(!1);else if(n.commandsList.length>0&&!n.commandsList.includes(a.command_name))k&&w(!1);else if(n.everythingButList.length>0&&n.everythingButList.includes(a.command_name))k&&w(!1);else{if(""!==n.parameterString)if(!new RegExp(n.parameterString).test(a.display_params))return void(k&&w(!1));k||w(!0)}else k||w(!0)}),[n,a.comment,a.command,a.display_params,a.operator.username]);var F=s.a.useCallback((function(e,t){b(!d)}),[d]);return Object(o.useEffect)((function(){!x&&a.tasks.length>0&&L()}),[a.tasks]),k?Object(g.jsx)(ud,{nodeId:"treenode:"+a.id,onIconClick:L,icon:i.includes("treenode:"+a.id)?Object(g.jsx)(ld,{}):a.tasks.length>0?Object(g.jsx)(dd,{}):null,label:Object(g.jsx)(Od,{task:a,dropdownOpen:d,toggleTaskDropdown:F}),children:m.task.map((function(t){return Object(g.jsx)(e,{task:t,nodesSelected:i,filterOptions:n,toggleSelection:r},"taskrow: "+t.id)}))}):null},Od=function(e){var t=e.task,a=e.dropdownOpen,n=e.toggleTaskDropdown,i=s.a.useState(new Date),r=Object(u.a)(i,2),c=r[0],l=(r[1],Object(T.a)(C)),d=Object(xe.a)(),b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState(0),f=Object(u.a)(h,2),O=f[0],x=f[1],y=od(),_=sd(),v=Object(o.useRef)(t.responses_aggregate.aggregate.count);Object(o.useLayoutEffect)((function(){k()}),[]),Object(o.useEffect)((function(){a?(v.current=t.responses_aggregate.aggregate.count,x(0)):t.responses_aggregate.aggregate.count>v.current&&(1===t.responses_aggregate.aggregate.count&&new Date(t.responses_aggregate.aggregate.max.timestamp)>c?n():x(t.responses_aggregate.aggregate.count-v.current))}),[t.responses_aggregate.aggregate.count,a]);var k=function(e,a){document.getElementById("scrolltotask".concat(t.id)).scrollIntoView({behavior:"smooth",block:"start",inline:"start"})};return Object(g.jsx)(H.a,{className:y.root,elevation:5,style:{marginRight:0},children:Object(g.jsxs)(So.a,{TransitionProps:{unmountOnExit:!0,onEntered:k},defaultExpanded:!1,onChange:n,expanded:a,children:[Object(g.jsx)(Io.a,{expandIcon:Object(g.jsx)(sn.a,{}),"aria-controls":"panel1c-content-task-".concat(t.id),id:"panel1c-header",classes:_,children:Object(g.jsx)(hd,{task:t,theme:d,children:Object(g.jsxs)("div",{id:"scrolltotask"+t.id,style:{width:"100%"},children:[p?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Q.a,{className:y.secondaryHeading,children:t.commentOperator.username}),Object(g.jsx)(Q.a,{className:y.heading,children:t.comment})]}):null,Object(g.jsxs)(Q.a,{className:y.taskAndTimeDisplay,children:["[",he(t.timestamp,l.user.view_utc_time),"] / ",t.id," / ",t.operator.username,Object(g.jsx)(md,{task:t,theme:d})]}),Object(g.jsxs)("div",{children:[""!==t.comment?Object(g.jsx)("div",{className:y.column,children:Object(g.jsx)(K.a,{size:"small",style:{padding:"0"},color:"primary",onClick:function(e){e.stopPropagation(),m(!p)},children:Object(g.jsx)($o.a,{})})}):null,Object(g.jsx)("div",{className:y.column,children:Object(g.jsx)(Ye.a,{badgeContent:O,color:"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:Object(g.jsx)(Q.a,{className:y.heading,onClick:function(e){e.stopPropagation()},children:t.command_name+" "+t.display_params})})})]})]})})}),Object(g.jsx)(Do.a,{style:{cursor:"default"},children:Object(g.jsx)(id,{task:t})})]})})},gd=a(910),xd={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},yd=Object(Ge.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}})),_d=Object(Pe.a)(jd||(jd=Object(q.a)(["\nquery operatorQuery($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    operators {\n      username\n      id\n    }\n  }\n}"])));function vd(e){var t=Object(T.a)(C),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState([]),x=Object(u.a)(O,2),_=x[0],v=x[1],k=s.a.useState([]),w=Object(u.a)(k,2),S=w[0],D=w[1],I=s.a.useState(""),$=Object(u.a)(I,2),P=$[0],A=$[1],E=s.a.useState([]),L=Object(u.a)(E,2),F=L[0],q=L[1],N=yd();Object(Ae.a)(_d,{variables:{operation_id:t.user.current_operation_id},onCompleted:function(e){j(e.operation_by_pk.operators.map((function(e){return e.username})))}}),Object(o.useEffect)((function(){if(void 0!==e.filterOptions.operatorsList&&r(e.filterOptions.operatorsList),void 0!==e.filterOptions.commentsFlag&&f(e.filterOptions.commentsFlag),void 0!==e.filterOptions.commandsList&&v(e.filterOptions.commandsList),void 0!==e.filterOptions.parameterString&&A(e.filterOptions.parameterString),void 0!==e.filterOptions.everythingButList&&D(e.filterOptions.everythingButList),e.filterCommandOptions){var t=e.filterCommandOptions.map((function(e){return e.cmd}));q(t)}}),[e.filterOptions]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Filter Which Tasks Are Visible"}),Object(g.jsx)(ce.a,{dividers:!0,style:{overflow:"hidden"},children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Et.a,{className:N.formControl,children:[Object(g.jsx)(Jt.a,{id:"operator-chip-label",children:"Only Show Tasks by the Following Operators"}),Object(g.jsx)(Lt.a,{labelId:"operator-chip-label",multiple:!0,id:"operator-chip",value:i,onChange:function(e){r(e.target.value)},input:Object(g.jsx)(qt.a,{}),renderValue:function(e){return Object(g.jsx)("div",{className:N.chips,children:e.map((function(e){return Object(g.jsx)(gd.a,{label:e,className:N.chip},e)}))})},MenuProps:xd,children:d.map((function(e){return Object(g.jsxs)(xt.a,{value:e,children:[Object(g.jsx)(za.a,{color:"primary",checked:i.indexOf(e)>-1}),Object(g.jsx)(Ba.a,{primary:e})]},e)}))})]}),"Only Show Tasks with Comments: ",Object(g.jsx)(U.a,{checked:h,onChange:function(e){f(e.target.checked)},color:"primary",name:"Only Comments",inputProps:{"aria-label":"primary checkbox"}}),Object(g.jsxs)(Et.a,{className:N.formControl,children:[Object(g.jsx)(Jt.a,{id:"include-chip-label",children:"Only Show These Commands"}),Object(g.jsx)(Lt.a,{labelId:"include-chip-label",multiple:!0,id:"include-chip",value:_,onChange:function(e){v(e.target.value),e.target.value.length>0&&D([])},input:Object(g.jsx)(qt.a,{}),renderValue:function(e){return Object(g.jsx)("div",{className:N.chips,children:e.map((function(e){return Object(g.jsx)(gd.a,{label:e,className:N.chip},e)}))})},MenuProps:xd,children:F.map((function(e){return Object(g.jsxs)(xt.a,{value:e,children:[Object(g.jsx)(za.a,{color:"primary",checked:_.indexOf(e)>-1}),Object(g.jsx)(Ba.a,{primary:e})]},e)}))})]}),Object(g.jsxs)(Et.a,{className:N.formControl,children:[Object(g.jsx)(Jt.a,{id:"exclude-chip-label",children:"Do Not Show These Commands"}),Object(g.jsx)(Lt.a,{labelId:"exclude-chip-label",multiple:!0,id:"exclude-chip",value:S,onChange:function(e){D(e.target.value),e.target.value.length>0&&v([])},input:Object(g.jsx)(qt.a,{}),renderValue:function(e){return Object(g.jsx)("div",{className:N.chips,children:e.map((function(e){return Object(g.jsx)(gd.a,{label:e,className:N.chip},e)}))})},MenuProps:xd,children:F.map((function(e){return Object(g.jsxs)(xt.a,{value:e,children:[Object(g.jsx)(za.a,{color:"primary",checked:S.indexOf(e)>-1}),Object(g.jsx)(Ba.a,{primary:e})]},e)}))})]}),Object(g.jsx)(y,{value:P,onChange:function(e,t,a){A(t)},name:"Only Show Tasks with the Following Parameter Regex"})]})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit({operatorsList:i,commentsFlag:h,commandsList:_,everythingButList:S,parameterString:P}),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}function kd(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(o.useRef)(null);Object(o.useEffect)((function(){var t=Object(F.a)(e.options);i(t),t.length,d("Default Token"),e.changeSelectedToken("Default Token")}),[e.options]);return Object(g.jsxs)(Et.a,{style:{maxWidth:"50%"},children:[Object(g.jsx)(Jt.a,{ref:b,children:"Tokens"}),Object(g.jsxs)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:l,onChange:function(t){d(t.target.value),e.changeSelectedToken(t.target.value)},variant:"filled",renderValue:function(e){return"Default Token"===e?"Default Token":null===e.User?e.tokenId:e.User},input:Object(g.jsx)(qt.a,{style:{width:"100%"}}),children:[Object(g.jsx)(xt.a,{value:"Default Token",children:"Default Token"},0),n.map((function(e){return Object(g.jsx)(xt.a,{value:e.token,children:null===e.token.User?e.token.TokenId+" - "+e.token.description:e.token.User+" - "+e.token.description},e.token.id)}))]})]})}var wd,Cd,Sd,Dd=a(452),Id=a.n(Dd),Td=a(771),$d=Object(Pe.a)(wd||(wd=Object(q.a)(["\nsubscription GetLoadedCommandsSubscription($callback_id: Int!){\n    loadedcommands(where: {callback_id: {_eq: $callback_id}}){\n        id\n        command {\n            cmd\n            id\n            attributes\n            commandparameters {\n                id\n                parameter_type: type \n                required\n                name\n                ui_position\n                parameter_group_name\n                cli_name\n                display_name\n            }\n        }\n    }\n    \n}\n"]))),Pd=Object(Pe.a)(Cd||(Cd=Object(q.a)(["\nsubscription subscriptionCallbackTokens ($callback_id: Int!){\n  callbacktoken(where: {deleted: {_eq: false}, callback_id: {_eq: $callback_id}}) {\n    token {\n      TokenId\n      id\n      User\n      description\n    }\n    id\n  }\n}\n"]))),Ad=Object(Pe.a)(Sd||(Sd=Object(q.a)(["\nsubscription tasksSubscription($callback_id: Int!){\n    task(where: {callback_id: {_eq: $callback_id}}, order_by: {id: desc}){\n        id\n        original_params\n        display_params\n        command_name\n        comment\n        tasking_location\n        parameter_group_name\n        status\n        operator{\n            username\n        }\n        command {\n            commandparameters {\n                id\n                type\n                name\n            }\n        }\n    }\n}\n"])));function Ed(e){var t={anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:2e3,preventDuplicate:!0,maxSnack:1,style:{marginBottom:"50px"}},a={anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:1e3,preventDuplicate:!0,maxSnack:1,style:{marginBottom:"100px"}},n=s.a.useState(""),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState([]),l=Object(u.a)(o,2),d=l[0],b=l[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1],O=s.a.useState(-1),x=Object(u.a)(O,2),y=x[0],_=x[1],v=s.a.useState([]),w=Object(u.a)(v,2),S=w[0],D=w[1],I=s.a.useState([]),$=Object(u.a)(I,2),P=$[0],A=$[1],L=s.a.useState(-1),q=Object(u.a)(L,2),N=q[0],R=q[1],B=s.a.useState(!1),z=Object(u.a)(B,2),W=z[0],M=z[1],H=s.a.useState([]),U=Object(u.a)(H,2),V=U[0],G=U[1],J=s.a.useState("parsed_cli"),Y=Object(u.a)(J,2),Z=Y[0],X=Y[1],ee=s.a.useState(!1),te=Object(u.a)(ee,2),ae=te[0],ne=te[1],ie=s.a.useState(""),re=Object(u.a)(ie,2),ce=re[0],oe=re[1],se=s.a.useState([]),le=Object(u.a)(se,2),de=le[0],ue=le[1],je=s.a.useState(-1),pe=Object(u.a)(je,2),me=pe[0],he=pe[1],fe=Object(T.a)(C);Object(ct.a)(Pd,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;G(t.data.callbacktoken)}}),Object(ct.a)(Ad,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;h(t.data.task);var a=t.data.task.filter((function(e){return Oe(e)}));D(a)}}),Object(ct.a)($d,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData.data.loadedcommands.map((function(e){var t=Object(k.a)({},e.command);return t.attributes=JSON.parse(t.attributes),t}));t.push({cmd:"help",description:"Get help for a command or info about loaded commands",commandparameters:[],attributes:{supported_os:[]}}),t.push({cmd:"clear",description:"Clear 'submitted' jobs from being pulled down by an agent",commandparameters:[],attributes:{supported_os:[]}}),t.sort((function(e,t){return e.cmd>t.cmd?1:-1})),b(t)}}),s.a.useEffect((function(){var e=m.filter((function(e){return Oe(e)}));D(e)}),[e.filterOptions]);var Oe=function(t){if(t.display_params.includes("help")&&t.operator.username!==fe.user.username)return!1;if(void 0===e.filterOptions)return!0;if(e.filterOptions.operatorsList.length>0&&!e.filterOptions.operatorsList.includes(t.operator.username))return!1;if(e.filterOptions.commentsFlag&&""===t.comment)return!1;if(e.filterOptions.commandsList.length>0&&!e.filterOptions.commandsList.includes(t.command_name))return!1;if(e.filterOptions.everythingButList.length>0&&null!==t.command&&e.filterOptions.everythingButList.includes(t.command_name))return!1;if(""!==e.filterOptions.parameterString&&!new RegExp(e.filterOptions.parameterString).test(t.display_params))return!1;return!0},ge=function(e,a){for(var n=[],i=[],r=[],c=[],o=0;o<a.commandparameters.length;o++)switch(a.commandparameters[o].parameter_type){case"ChooseOne":case"String":n.push(a.commandparameters[o].cli_name);case"Number":c.push(a.commandparameters[o].cli_name);break;case"Boolean":i.push(a.commandparameters[o].cli_name);break;case"Array":case"ChooseMultiple":r.push(a.commandparameters[o].cli_name);break;default:n.push(a.commandparameters[o].cli_name)}try{var s=Td(e);return Id()(s,{string:n,boolean:i,number:c,array:r,configuration:{"short-option-groups":!1,"camel-case-expansion":!1}})}catch(l){return void E.warning("Failed to parse command line: "+l,t)}},xe=function(e,t){if(0===e.commandparameters.length)return[];for(var a=e.commandparameters.reduce((function(e,t){return e.includes(t.parameter_group_name)?Object(F.a)(e):[].concat(Object(F.a)(e),[t.parameter_group_name])}),[]),n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];if("_"!==r){var c=function(){for(var t=[],n=0;n<e.commandparameters.length;n++)e.commandparameters[n].cli_name===r&&t.push(e.commandparameters[n].parameter_group_name);var i=a.reduce((function(e,a){return t.includes(a)?[].concat(Object(F.a)(e),[a]):Object(F.a)(e)}),[]);if(0===i.length)return{v:void 0};a=Object(F.a)(i)}();if("object"===typeof c)return c.v}}return a},ye=function(a,n){a.preventDefault(),a.stopPropagation();var i=r.split(" "),o=d.find((function(e){return e.cmd===i[0]}));if(void 0!==o){var s="Default",l={};if(Z.includes("modal")||Z.includes("browserscript"))try{var u=i.slice(1).join(" ");l=JSON.parse(u),s=xe(o,l)}catch(j){return void E.warning("Failed to parse modified JSON value",t)}else{var b=ge(r,o);if(!b)return;if(s=xe(o,b),o.commandparameters.length>0){if((l=function(e,t,a){var n=Object(k.a)({},t);if(n._.shift(),0===e.commandparameters.length)return n;if(0===a.length)return n;var i=e.commandparameters.filter((function(e){return e.parameter_group_name===a[0]}));i.sort((function(e,t){return e.ui_position<t.ui_position?-1:1}));for(var r=[],c=0;c<i.length;c++)i[c].cli_name in n||r.push(i[c]);for(var o=0;o<r.length-1;o++)n._.length>0&&(n[i[o].cli_name]=n._.shift());return r.length>0&&n._.length>0&&(n[r[r.length-1].cli_name]=n._.join(" "),n._=[]),n}(o,b,s))._.length>0)return void E.warning("Too many positional arguments given. Did you mean to quote some of them?",t)}else l=b}if(void 0!==s){if(s.length>1){if(console.log("cmdGroupNames > 1"),Boolean(n))e.onSubmitCommandLine(r,o,l,Boolean(n),s,Z);else{if(!s.includes("Default"))return void E.warning("Passed arguments are ambiguous, use shift+enter for modal or provide more parameters",t);e.onSubmitCommandLine(r,o,l,Boolean(n),["Default"],Z)}return c(""),_(-1),he(-1),ne(!1),void X("parsed_cli")}e.onSubmitCommandLine(r,o,l,Boolean(n),s,Z),c(""),_(-1),he(-1),ne(!1),X("parsed_cli")}else E.warning("Two or more of the specified parameters can't be used together",t)}else E.warning("Unknown command",t)};return Object(g.jsxs)(s.a.Fragment,{children:[ae&&Object(g.jsx)(f.a,{placeholder:"Search previous commands",onKeyDown:function(e){if("Escape"===e.key)ne(!1),he(0),ue([]);else if("Tab"===e.key)ne(!1),he(0),ue([]);else if("Enter"===e.key)ne(!1),he(0),ue([]),ye(e);else if("ArrowUp"===e.key){if(0===de.length)return void E.warning("No matching options",a);var t=(me+1)%de.length;he(t),c(de[t].command_name+" "+de[t].original_params)}else if("ArrowDown"===e.key){if(0===de.length)return void E.warning("No matching options",a);var n=(me-1)%de.length;n<0&&(n=de.length-1),he(n),c(de[n].command_name+" "+de[n].original_params)}},onChange:function(e){if(oe(e.target.value),0===e.target.value.length)return c(""),ue([]),void he(0);var t=e.target.value.toLowerCase(),a=m.filter((function(e){return(e.command_name+" "+e.original_params).toLowerCase().includes(t)})).filter((function(e){return Oe(e)}));ue(a),a.length>0&&c(a[0].command_name+" "+a[0].original_params)},size:"small",autoFocus:!0,variant:"outlined",value:ce,fullWidth:!0,InputProps:{type:"search",startAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(Q.a,{style:{width:"10%"},children:"reverse-i-search:"})})}}),Object(g.jsx)(f.a,{placeholder:"Task an agent...",onKeyDown:function(a){if("r"===a.key&&a.ctrlKey&&(ne(!0),c(""),oe(""),X("parsed_cli")),"Tab"===a.key)if(a.stopPropagation(),a.preventDefault(),X("parsed_cli"),r.includes(" ")){var n=d.find((function(e){return e.cmd===r.split(" ")[0]}));if(n.commandparameters.length>0){if(" "!==r[r.length-1]){if(P.length>0){var i=(N+1)%P.length;R(i);var o=r.split(" ").slice(0,-1).join(" ")+" -"+P[i];return void c(o)}var s=r.split(" "),l=s.slice(-1)[0];if(l.startsWith("-")){var b=ge(s.slice(0,-1).join(" "),n),j=xe(n,b);if(void 0===j)return void E.warning("Two or more of the specified parameters can't be used together",t);var p=[];if(n.commandparameters.find((function(e){return j.includes(e.parameter_group_name)&&e.cli_name===l.slice(1)&&!(e.cli_name in b)}))?(p=n.commandparameters.reduce((function(e,t){return j.includes(t.parameter_group_name)&&t.cli_name!==l.slice(1)&&!(t.cli_name in b)?[].concat(Object(F.a)(e),[t.cli_name]):Object(F.a)(e)}),[])).push(l.slice(1)):p=n.commandparameters.reduce((function(e,t){return j.includes(t.parameter_group_name)&&t.cli_name.startsWith(l.slice(1))&&!(t.cli_name in b)?[].concat(Object(F.a)(e),[t.cli_name]):Object(F.a)(e)}),[]),p.length>0){if(1===p.length){A([]),R(0);var m=s.slice(0,-1).join(" ")+" -"+p[0];c(m)}else{A(p),R(0);var h=s.slice(0,-1).join(" ")+" -"+p[0];c(h)}return}return void E.warning("Unknown Parameter Name",t)}return}var f=ge(r,n),O=xe(n,f);if(void 0===O)return void E.warning("Two or more of the specified parameters can't be used together",t);console.log("cmdGroupNames in tab",O);for(var g=0,x=Object.entries(f);g<x.length;g++){var v=Object(u.a)(x[g],2),k=v[0],w=v[1];if("_"!==k){if(w!==w||void 0===w)return void E.warning(k+" needs a valid value",t);if(void 0===w){if(r.endsWith(" -"+k)){for(var C=0;C<n.commandparameters.length;C++)if(n.commandparameters[C].required&&!(n.commandparameters[C].cli_name in f)&&(O.includes(n.commandparameters[C].parameter_group_name)||0===O.length)){var D=r.trim().slice(0,-1*k.length)+n.commandparameters[C].cli_name;return void c(D)}for(var I=0;I<n.commandparameters.length;I++)if(!n.commandparameters[I].required&&!(n.commandparameters[I].cli_name in f)&&(O.includes(n.commandparameters[I].parameter_group_name)||0===O.length)){var T=r.trim().slice(0,-1*k.length)+n.commandparameters[I].cli_name;return void c(T)}}return void E.warning(k+" needs a value",t)}}}for(var $=0;$<n.commandparameters.length;$++)if(n.commandparameters[$].required&&!(n.commandparameters[$].cli_name in f)&&(O.includes(n.commandparameters[$].parameter_group_name)||0===O.length)){var L=r.trim()+" -"+n.commandparameters[$].cli_name;return void c(L)}for(var q=0;q<n.commandparameters.length;q++)if(!n.commandparameters[q].required&&!(n.commandparameters[q].cli_name in f)&&(O.includes(n.commandparameters[q].parameter_group_name)||0===O.length)){var B=r.trim()+" -"+n.commandparameters[q].cli_name;return void c(B)}E.info("No more arguments for command",t)}else E.info("No arguments for command",t)}else if(0===P.length){var z=d.filter((function(t){return t.cmd.startsWith(r)&&(0===t.attributes.supported_os.length||t.attributes.supported_os.includes(e.callback_os))}));A(z),R(0),z.length>0&&c(z[0].cmd)}else R((N+1)%P.length),c(P[(N+1)%P.length].cmd);else if("Enter"===a.key)a.shiftKey?ye(a,!0):ye(a,!1);else if("ArrowUp"===a.key){if(0===S.length)return void E.warning("No previous tasks",t);var W=y+1;W>S.length-1&&(W=S.length-1),_(W),c(S[W].command_name+" "+S[W].original_params),X(S[W].tasking_location)}else if("ArrowDown"===a.key){if(0===S.length)return void E.warning("No previous tasks",t);var M=y-1;M<0&&(M=0),_(M),c(S[M].command_name+" "+S[M].original_params),X(S[M].tasking_location)}else A([]),R(0),-1!==y&&_(-1)},onChange:function(e){A([]),R(0),c(e.target.value),0===e.target.value.length&&X("parsed_cli")},size:"small",variant:"outlined",disabled:ae,value:r,autoFocus:!0,fullWidth:!0,InputProps:{type:"search",endAdornment:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(K.a,{color:"primary",variant:"contained",onClick:ye,children:Object(g.jsx)(ci.a,{})}),Object(g.jsx)(K.a,{color:"secondary",variant:"contained",onClick:function(){M(!0)},children:Object(g.jsx)(wr.a,{})})]}),startAdornment:Object(g.jsx)(s.a.Fragment,{children:V.length>0?Object(g.jsx)(kd,{options:V,changeSelectedToken:e.changeSelectedToken}):null})}}),W&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:W,onClose:function(){M(!1)},innerDialog:Object(g.jsx)(vd,{filterCommandOptions:d,onSubmit:e.onSubmitFilter,filterOptions:e.filterOptions,onClose:function(){M(!1)}})})]})}var Ld,Fd,qd,Nd,Rd=s.a.memo(Ed),Bd=a(453),zd=a.n(Bd);function Wd(e){var t=s.a.useState(e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?e.tabInfo.callbackDescription:"Callback: "+e.tabInfo.callbackID),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1];Object(o.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?i(e.tabInfo.callbackDescription):i("Callback: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(ko,Object(k.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),d(!0)}},e)),l&&Object(g.jsx)(be,{fullWidth:!0,open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Tab's Description",onClose:function(){d(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var Md,Hd=Object(Pe.a)(Ld||(Ld=Object(q.a)(["\n    fragment taskData on task {\n        comment\n        callback_id\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        display_params\n        status\n        timestamp\n        command {\n          cmd\n          id\n        }\n        command_name\n        responses_aggregate {\n            aggregate{\n              count\n              max {\n                timestamp\n              }\n            }\n          }\n        opsec_pre_blocked\n        opsec_pre_bypassed\n        opsec_post_blocked\n        opsec_post_bypassed\n        tasks {\n            id\n        }\n        token {\n            id\n        }\n    }\n"]))),Ud=Object(Pe.a)(Fd||(Fd=Object(q.a)(["\nmutation createTasking($callback_id: Int!, $command: String!, $params: String!, $files: String, $token_id: Int, $tasking_location: String, $original_params: String, $parameter_group_name: String) {\n  createTask(callback_id: $callback_id, command: $command, params: $params, files: $files, token: $token_id, tasking_location: $tasking_location, original_params: $original_params, parameter_group_name: $parameter_group_name) {\n    status\n    id\n    error\n  }\n}\n"]))),Vd=Object(Pe.a)(qd||(qd=Object(q.a)(["\n","\nsubscription getTasking($callback_id: Int!, $fromNow: timestamp!, $limit: Int){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}, timestamp: {_gt: $fromNow}}, order_by: {id: desc}, limit: $limit) {\n        ...taskData\n    }\n}\n "])),Hd),Gd=Object(Pe.a)(Nd||(Nd=Object(q.a)(["\n","\nquery getBatchTasking($callback_id: Int!, $offset: Int!, $fetchLimit: Int!){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}}, order_by: {id: desc}, limit: $fetchLimit, offset: $offset) {\n        ...taskData\n    }\n    callback(where: {id: {_eq: $callback_id}}){\n        id\n    }\n}\n"])),Hd),Kd=function(e){var t=e.tabInfo,a=e.index,n=e.value,i=e.onCloseTab,r=s.a.useState(10),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState({}),f=Object(u.a)(h,2),O=f[0],x=f[1],y=s.a.useState({task:[]}),_=Object(u.a)(y,2),v=_[0],w=_[1],C=s.a.useRef({task:[]}),S=s.a.useState((new Date).toISOString()),D=Object(u.a)(S,2),I=D[0],T=(D[1],s.a.useState({})),$=Object(u.a)(T,2),P=$[0],A=$[1],L=s.a.useState({operatorsList:[],commentsFlag:!1,commandsList:[],parameterString:"",everythingButList:[]}),q=Object(u.a)(L,2),N=q[0],R=q[1],B=s.a.useState(!0),z=Object(u.a)(B,2),W=z[0],M=z[1];Object(o.useEffect)((function(){C.current=v}),[v]);var H=s.a.useState(!1),U=Object(u.a)(H,2),V=U[0],G=U[1],Q=s.a.useState(!1),J=Object(u.a)(Q,2),Y=J[0],Z=J[1],X=Object(o.useRef)(null),ee=Object(Ee.a)(Ud,{update:function(e,t){var a=t.data;"error"===a.createTask.status?E.error(a.createTask.error):E.success("Task created",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),te=Object(u.a)(ee,1)[0],ae=Object(o.useCallback)((function(e){var t=e.subscriptionData;V||G(!0);var a=C.current.task.length,n=t.data.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):[].concat(Object(F.a)(e),[t])}),Object(F.a)(C.current.task));n.sort((function(e,t){return e.id<t.id?-1:1})),function(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++){if(e[a].comment!==t[a].comment)return!1;if(e[a].commentOperator!==t[a].commentOperator)return!1;if(e[a].completed!==t[a].completed)return!1;if(e[a].display_params!==t[a].display_params)return!1;if(e[a].original_params!==t[a].original_params)return!1;if(e[a].status!==t[a].status)return!1;if(e[a].timestamp!==t[a].timestamp)return!1;if(e[a].responses_aggregate.aggregate.count!==t[a].responses_aggregate.aggregate.count)return!1;if(e[a].opsec_pre_blocked!==t[a].opsec_pre_blocked)return!1;if(e[a].opsec_pre_bypassed!==t[a].opsec_pre_bypassed)return!1;if(e[a].opsec_post_blocked!==t[a].opsec_post_blocked)return!1;if(e[a].opsec_post_bypassed!==t[a].opsec_post_bypassed)return!1;if(e[a].tasks.length!==t[a].tasks.length)return!1}return!0}(C.current.task,n)||w({task:n}),n.length>a&&M(!0),n.length>l&&d(n.length)}),[V,G,M,l]);Object(ct.a)(Vd,{variables:{callback_id:t.callbackID,fromNow:I,limit:l},onError:function(e){console.error(e)},fetchPolicy:"no-cache",onSubscriptionData:ae});var ne=Object(o.useCallback)((function(){v&&X.current&&X.current.scrollIntoView({behavior:"smooth"})}),[v,X]);Object(o.useLayoutEffect)((function(){W&&(ne(),M(!1))}),[W,ne]);var ie=Object(At.a)(Gd,{onError:function(e){console.error(e)},onCompleted:function(e){var a=!1;if(0!==e.callback.length){var n=e.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):(a=!0,[].concat(Object(F.a)(e),[t]))}),Object(F.a)(v.task));n.sort((function(e,t){return e.id<t.id?-1:1})),w({task:n}),a?e.task.length<10?Z(!0):Z(!1):Z(!0)}else i(t)},fetchPolicy:"no-cache"}),re=Object(u.a)(ie,2),ce=re[0],oe=re[1].loading;Object(o.useEffect)((function(){ce({variables:{callback_id:t.callbackID,offset:v.task.length,fetchLimit:10}}),M(!0)}),[]);var se=function(e){var t=e.callback_id,a=e.command,n=e.params,i=e.files,r=e.tasking_location,c=e.original_params,o=e.parameter_group_name;void 0!==P.id?te({variables:{callback_id:t,command:a,params:n,files:i,token_id:P.TokenId,tasking_location:r,original_params:c,parameter_group_name:o}}):te({variables:{callback_id:t,command:a,params:n,files:i,tasking_location:r,original_params:c,parameter_group_name:o}})};return Object(g.jsxs)(_o,{index:a,value:n,children:[!Y&&Object(g.jsx)(gc.a,{title:"Fetch Older Tasks",children:Object(g.jsx)(K.a,{onClick:function(){ce({variables:{callback_id:t.callbackID,offset:v.task.length,fetchLimit:10}})},variant:"contained",color:"primary",children:Object(g.jsx)(zd.a,{})})}),!V&&Object(g.jsx)(Ze.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}}),oe&&Object(g.jsx)(Ze.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:v.task.map((function(e){return Object(g.jsx)(pd,{task:e,command_id:null==e.command?0:e.command.id,filterOptions:N},"taskinteractdisplay"+e.id)}))}),Object(g.jsx)("div",{ref:X}),Object(g.jsx)(Rd,{onSubmitFilter:function(e){R(e)},onSubmitCommandLine:function(e,a,n,i,r,c){var o=e.split(" ");delete o[0],o=o.join(" ").trim();var s="parsed_cli";if(c.includes("modal")?s="modal_modified":c.includes("browserscript")&&(s="browserscript_modified"),0===a.commandparameters.length)se({callback_id:t.callbackID,command:a.cmd,params:o,parameter_group_name:"Default"});else{var l=a.commandparameters.find((function(e){return"File"===e.parameter_type&&r.includes(e.parameter_group_name)})),d=!1;if(1===r.length)a.commandparameters.filter((function(e){return e.required&&e.parameter_group_name===r[0]&&!(e.cli_name in n)})).length>0&&(d=!0);else r>1&&!i&&(i=!0);if(l||i||d)return r.length>0?x(Object(k.a)(Object(k.a)({},a),{},{parsedParameters:n,groupName:r[0]})):x(Object(k.a)(Object(k.a)({},a),{},{parsedParameters:n})),void m(!0);delete n._,se({callback_id:t.callbackID,command:a.cmd,params:JSON.stringify(n),tasking_location:s,original_params:o,parameter_group_name:r[0]})}},changeSelectedToken:function(e){"Default Token"!==e?e.TokenId!==P.TokenId&&A(e):A("Default Token")},filterOptions:N,callback_id:t.callbackID,callback_os:t.os}),p&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(ws,{command:O,callback_id:t.callbackID,payloadtype_id:t.payloadtype_id,operation_id:t.operation_id,onSubmit:function(e,a,n,i){m(!1),se({callback_id:t.callbackID,command:e,params:a,files:n,tasking_location:"modal",parameter_group_name:i})},onClose:function(){m(!1)}})})]})},Qd=Object(Pe.a)(Md||(Md=Object(q.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    last_checkin\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n    callbacktokens(where: {deleted: {_eq: false}}) {\n      token {\n        TokenId\n        id\n        User\n        description\n      }\n      callback {\n        id\n      }\n      id\n    }\n  }\n}\n "])));function Jd(e){var t=Object(v.g)().callbackId,a=s.a.useState({payload:{payloadtype:{ptype:""}},callbacktokens:[]}),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState({callbackID:parseInt(t)}),o=Object(u.a)(c,2),l=o[0],d=o[1];return Object(ct.a)(Qd,{variables:{callback_id:t},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var a=e.subscriptionData;null!==a.data.callback_by_pk?(r(a.data.callback_by_pk),d({tabID:"interact",tabType:"interact",callbackID:parseInt(t),payloadtype:a.data.callback_by_pk.payload.payloadtype.ptype,payloadDescription:a.data.callback_by_pk.payload.tag,callbackDescription:a.data.callback_by_pk.description,os:a.data.callback_by_pk.payload.os})):E.error("Unknown Callback")}}),Object(g.jsx)("div",{style:{width:"100%",height:"100%",maxHeight:"100%",display:"flex",flexDirection:"row"},children:void 0!==l.payloadtype?Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(mo,{callback:i}),Object(g.jsx)(Kd,{style:{height:"calc(".concat(96,"vh)"),maxHeight:"calc(".concat(96,"vh)"),width:"69%",maxWidth:"69%",position:"absolute",overflow:"auto",display:"inline-flex",flexDirection:"column"},tabInfo:l,callbacktokens:i.callbacktokens})]}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"Fetching Callback"})})}var Yd,Zd=a(287),Xd=Object(Ge.a)((function(e){return{root:{width:"100%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:Zd.a[500]}}}));function eu(){var e=Xd(),t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(g.jsxs)(Ke.a,{className:e.root,elevation:5,children:[Object(g.jsx)(Wa.a,{avatar:Object(g.jsx)(Yn.a,{className:e.avatar}),title:"Mythic Quick Start Guide",subheader:"Expand this section to learn how to: Generate a Payload, Download the Payload, Get To Callbacks",style:{paddingBottom:0,marginBottom:0}}),Object(g.jsx)(nn.a,{styl:{padding:0,margin:0},children:Object(g.jsx)(K.a,{className:Object(an.default)(e.expand,Object(Pt.a)({},e.expandOpen,n)),onClick:function(){i(!n)},"aria-expanded":n,"aria-label":"show more",children:Object(g.jsx)(sn.a,{})})}),Object(g.jsx)(G.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(g.jsx)(Je.a,{style:{margin:0,paddingTop:0},children:Object(g.jsxs)("ol",{children:[Object(g.jsxs)("li",{children:["Create a payload at ",Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/createpayload",children:"Create -> Create Payload"}),Object(g.jsxs)("ul",{children:[Object(g.jsx)("li",{children:"Select Desired OS"}),Object(g.jsx)("li",{children:"Select Payload Type and Supply Build Parameters"}),Object(g.jsx)("li",{children:"Select Commands You Want Stamped Into The Agent"}),Object(g.jsx)("li",{children:"Select C2 Profiles and Fill Out Parameters"}),Object(g.jsx)("li",{children:"Name Your Payload"}),Object(g.jsx)("li",{children:"Provide a Description"}),Object(g.jsx)("li",{children:"Build Your Payload"})]})]}),Object(g.jsxs)("li",{children:["Download Your Payload at ",Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/payloads",children:"Operational Data -> Payloads"})]}),Object(g.jsxs)("li",{children:["Run Your payload",Object(g.jsx)("ul",{children:Object(g.jsxs)("li",{children:["For More Information About Your Agent, Check Out The ",Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/docs/agents",children:"Internal Documentation"})]})})]}),Object(g.jsxs)("li",{children:["Interact With Your Agent At ",Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks",children:"Active Callbacks"})]})]})})})]})}var tu=Object(Pe.a)(Yd||(Yd=Object(q.a)(["\nquery GetC2AndPayloadType {\n  c2profile(where: {deleted: {_eq: false}}) {\n    name\n    id\n  }\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    id\n    payloadtypec2profiles {\n      c2profile {\n        name\n        id\n      }\n    }\n  }\n  wrappers: payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n      }\n    }\n  }\n}\n"])));function au(e){var t=Object(xe.a)(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],b=s.a.useState([]),j=Object(u.a)(b,2),p=j[0],m=j[1];return Object(Ae.a)(tu,{fetchPolicy:"network-only",onCompleted:function(e){var t=e.c2profile.map((function(e){return e.name})),a=e.payloadtype.map((function(e){var t=e.payloadtypec2profiles.map((function(e){return e.c2profile.name}));return{ptype:e.ptype,payloadtypec2profiles:t}}));t.sort(),a.sort((function(e,t){return e.ptype<t.ptype?-1:1}));var n=e.wrappers.map((function(e){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));return{ptype:e.ptype,wrapped:t}}));n.sort((function(e,t){return e.ptype<t.ptype?-1:1})),m(n),r(t),d(a)},onError:function(e){}}).loading?Object(g.jsx)(Ze.a,{}):Object(g.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Agent / C2 Overview"})}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{}),i.map((function(e){return Object(g.jsx)(B.a,{children:e},e)}))]})}),Object(g.jsx)(R.a,{children:l.map((function(e){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:e.ptype}),i.map((function(a){return Object(g.jsx)(B.a,{children:e.payloadtypec2profiles.includes(a)?Object(g.jsx)(gc.a,{title:e.ptype+" supports "+a,children:Object(g.jsx)(dn.a,{style:{color:t.palette.success.main}})}):""},"payload"+a)}))]},e.ptype)}))})]})}),p.length>0&&Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{marginTop:"10px"},children:Object(g.jsxs)(N.a,{size:"small",children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{}),l.map((function(e){return Object(g.jsx)(B.a,{children:e.ptype},"wrapped"+e.ptype)}))]})}),Object(g.jsx)(R.a,{children:p.map((function(e){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:e.ptype}),l.map((function(a){return Object(g.jsx)(B.a,{children:e.wrapped.includes(a.ptype)?Object(g.jsx)(gc.a,{title:e.ptype+" wraps "+a.ptype,children:Object(g.jsx)(dn.a,{style:{color:t.palette.success.main}})}):""},"payload"+a.ptype)}))]},"wrapper"+e.ptype)}))})]})})]})}function nu(){var e=Object(xe.a)();return Object(g.jsxs)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:e.pageHeader.main,color:e.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Welcome To Mythic"})}),Object(g.jsx)(eu,{}),Object(g.jsx)(au,{})]})}var iu=["component"];function ru(e){var t=e.component,a=Object(fo.a)(e,iu),n=Object(T.a)(C);return Object(g.jsx)(v.b,Object(k.a)(Object(k.a)({},a),{},{render:function(e){return n.loggedIn&&n.user?s.a.createElement(t,e):Object(g.jsx)(v.a,{to:{pathname:"/new/login",state:{from:e.location}}})}}))}var cu=a(889),ou=a(897),su=a(456),lu=a.n(su),du=a(278),uu=a.n(du),bu=a(280),ju=a.n(bu),pu=a(455),mu=a.n(pu),hu=a(275),fu=a.n(hu),Ou=a(454),gu=a.n(Ou),xu=a(274),yu=a.n(xu),_u=a(188),vu=a.n(_u),ku=a(285),wu=Object(Ge.a)((function(e){return{root:{width:"99%",marginTop:"3px",marginBottom:"2px",marginLeft:"3px",marginRight:"0px",height:"auto"},heading:{fontSize:e.typography.pxToRem(15),whiteSpace:"pre-line"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"calc(90vw)",whiteSpace:"break-word"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),Cu=function(e,t,a,n,i){return{data:Object(k.a)({id:e.id.toString(),isLeaf:void 0===e.filebrowserobjs||0===Object.keys(e.filebrowserobjs).length,isOpenByDefault:!0,name:e.name_text,nestingLevel:t,fetchFolderData:a,setTableData:n,theme:i},e),nestingLevel:t,node:e}},Su=function(e){var t=r.a.mark(o),a=e.treeRoot,n=e.fetchFolderData,i=e.setTableData,c=Object(xe.a)();function o(){var e,o,s,l,d;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(!(e<a.length)){t.next=7;break}return t.next=4,Cu(a[e],0,n,i,c);case 4:e++,t.next=1;break;case 7:return void(t.next=10);case 10:o=t.sent,s=0,l=Object.values(o.node.filebrowserobjs);case 12:if(!(s<l.length)){t.next=21;break}if(!(d=l[s]).is_file){t.next=16;break}return t.abrupt("continue",18);case 16:return t.next=18,Cu(d,o.nestingLevel+1,n,i,c);case 18:s++,t.next=12;break;case 21:t.next=7;break;case 23:case"end":return t.stop()}}),t)}return 0===a.length?Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No File Browser Data Collected"}):Object(g.jsx)(gi.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(ku.a,{treeWalker:o,height:t,width:a-10,itemSize:30,overscanCount:20,async:!0,placeholder:Object(g.jsx)("div",{children:"Loading...."}),children:Du})}})},Du=function(e){var t=e.data,a=e.isOpen,n=e.style,i=e.setOpen;return Object(g.jsxs)("div",{style:Object(k.a)(Object(k.a)({},n),{},{width:"calc(100vw)",display:"inline-flex",overflow:"auto"}),children:[Object(F.a)(Array(t.nestingLevel)).map((function(e,a){return Object(g.jsx)("div",{style:{borderLeft:"1px dashed ".concat(Object(Co.c)(t.theme.palette.text.primary,.4)),marginLeft:15,paddingRight:15,height:"100%",display:"inline-block"}},"folder"+t.id+"lines"+a)})),Object(g.jsx)(Iu,{filebrowserobj:t,isOpen:a,setOpen:i})]})},Iu=function(e){var t=wu(),a=Object(xe.a)(),n=function(){E.info("fetching elements...",{persist:!0}),e.filebrowserobj.fetchFolderData(e.filebrowserobj),e.isOpen||e.filebrowserobj.fetchFolderData(e.filebrowserobj)},i=function(t){t.stopPropagation(),n(),e.isOpen||n(),e.setOpen(!e.isOpen)};return Object(g.jsxs)(H.a,{className:t.root,elevation:5,style:{backgroundColor:a.body,color:a.text,alignItems:"center",display:"flex"},onClick:function(){e.filebrowserobj.setTableData(e.filebrowserobj)},children:[null===e.filebrowserobj.parent_id?Object(g.jsx)(gu.a,{style:{marginLeft:"3px",marginRight:"5px"}}):e.filebrowserobj.is_file?Object(g.jsx)(yu.a,{style:{marginLeft:"3px",marginRight:"5px"}}):e.isOpen?Object(g.jsx)(fu.a,{style:{marginLeft:"3px",marginRight:"5px",color:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>0||null!==e.filebrowserobj.success?a.folderColor:"grey"},onClick:i}):Object(g.jsx)(mu.a,{style:{paddingTop:"5px",marginLeft:"3px",marginRight:"5px"},onClick:i}),e.filebrowserobj.nestingLevel>0&&e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>99?Object(g.jsx)(gc.a,{title:"Number of known children",children:Object(g.jsx)(Ye.a,{style:{left:-50},max:99,badgeContent:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count,color:"primary",anchorOrigin:{vertical:"bottom",horizontal:"left"}})}):null,Object(g.jsx)(Q.a,{style:{color:e.filebrowserobj.filebrowserobjs_aggregate.aggregate.count>0||null!==e.filebrowserobj.success?a.palette.text.primary:a.palette.text.secondary},children:null===e.filebrowserobj.parent_id?e.filebrowserobj.host:e.filebrowserobj.name_text}),!0===e.filebrowserobj.success&&e.filebrowserobj.nestingLevel>0?Object(g.jsx)(gc.a,{title:"Successfully listed contents of folder",children:Object(g.jsx)(dn.a,{fontSize:"small",style:{color:a.palette.success.main}})}):!1===e.filebrowserobj.success&&e.filebrowserobj.nestingLevel>0?Object(g.jsx)(gc.a,{title:"Failed to list contents of folder",children:Object(g.jsx)(vu.a,{fontSize:"small",style:{color:a.palette.error.main}})}):null]})};function Tu(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(xe.a)();return Object(o.useEffect)((function(){i(e.value)}),[e.value]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(H.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Download"}),Object(g.jsx)(B.a,{children:"Time"}),Object(g.jsx)(B.a,{children:"Task"}),Object(g.jsx)(B.a,{children:"Comment"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.complete?Object(g.jsx)(K.a,{href:"/api/v1.4/files/download/"+e.agent_file_id,style:{color:r.palette.success.main},children:Object(g.jsx)(wc.a,{})}):e.chunks_received+"/"+e.total_chunks}),Object(g.jsx)(B.a,{children:e.timestamp}),Object(g.jsx)(B.a,{children:e.task.id}),Object(g.jsx)(B.a,{children:e.comment})]},"hist"+e.id)}))})]})})})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var $u,Pu,Au,Eu,Lu,Fu,qu,Nu,Ru,Bu,zu=a(276),Wu=a.n(zu),Mu=a(163),Hu=a.n(Mu),Uu=a(277),Vu=a.n(Uu),Gu=Object(Pe.a)($u||($u=Object(q.a)(["\nquery getPermissionsQuery($filebrowserobj_id: Int!){\n    filebrowserobj_by_pk(id: $filebrowserobj_id){\n        id\n        permissions\n    }\n}\n"]))),Ku=Object(Pe.a)(Pu||(Pu=Object(q.a)(["\nquery getFileDownloadHistory($filebrowserobj_id: Int!){\n    filebrowserobj_by_pk(id: $filebrowserobj_id){\n        filemeta {\n            id\n            comment\n            agent_file_id\n            chunks_received\n            complete\n            total_chunks\n            timestamp\n            task {\n                id\n                comment\n            }\n        }\n    }\n}\n"]))),Qu=Object(Pe.a)(Au||(Au=Object(q.a)(["\nmutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!){\n    update_filebrowserobj_by_pk(pk_columns: {id: $filebrowserobj_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"]))),Ju=function(e){var t=e.columnData,a=e.dataKey,n=e.rowData;return function(){switch(t.format){case"string":return Object(g.jsx)(Xu,{cellData:n[a],rowData:n});case"name":return Object(g.jsx)(Zu,{cellData:n[a],rowData:n});case"size":return Object(g.jsx)(eb,{cellData:n[a]});case"button":return Object(g.jsx)(tb,{rowData:n,onTaskRowAction:t.onTaskRowAction});default:return Object(g.jsx)(Xu,{cellData:n[a],rowData:n})}}()},Yu=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useRef(null),c=s.a.useState("ASC"),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState("name_text"),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState({actions:.065,name_text:.45,size:.08,modify_time:.18,comment:.2}),O=Object(u.a)(f,2),x=O[0],y=O[1],_=s.a.useState([]),v=Object(u.a)(_,2),w=v[0],C=v[1],S=function(e){var t=e.sortBy,a=e.sortDirection,r=Object(F.a)(n),c=w.filter((function(e){return e.dataKey===t}))[0].columnData.format;"number"===c||"size"===c?r.sort((function(e,a){return parseInt(e[t])>parseInt(a[t])?1:-1})):"date"===c?r.sort((function(e,a){return new Date(e[t])>new Date(a[t])?1:-1})):r.sort((function(e,a){return e[t].toLowerCase()>a[t].toLowerCase()?1:-1})),"DESC"===a&&r.reverse(),i(Object(F.a)(r)),h(t),b(a)},D=function(e){var t=e.index;return n[t]},I=s.a.useCallback((function(e){var t,a=e.event,n=e.dataKey,i=e.deltaX;a.preventDefault(),a.stopPropagation();for(var c=Object(k.a)({},x),o=i/r.current.offsetWidth,s="",l=!1,d=0,u=Object.keys(x);d<u.length;d++){var b=u[d];if(l){s=b;break}b===n&&(l=!0)}if(""!==s){var j=Object(k.a)(Object(k.a)({},c),{},(t={},Object(Pt.a)(t,n,c[n]+o),Object(Pt.a)(t,s,c[s]-o),t));y(j)}else console.log("next header not found")}),[x]),T=s.a.useCallback((function(e){var t=e.columnData,a=e.dataKey,n=(e.disableSort,e.label),i=e.sortBy,r=e.sortDirection;return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)("span",{style:{display:"inline-flex",flexDirection:"row",alignContent:"stretch",justifyContent:"flex-start"},children:[n,i===a?"ASC"===r?Object(g.jsx)(Vo.a,{}):Object(g.jsx)(Ko.a,{}):null]}),"button"!==t.format&&"Comment"!==n&&Object(g.jsx)(Ho.a,{axis:"x",defaultClassName:"DragHandle",defaultClassNameDragging:"DragHandleActive",onDrag:function(e,t){var n=t.deltaX;return I({event:e,dataKey:a,deltaX:n})},position:{x:0},zIndex:999,children:Object(g.jsx)("span",{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"DragHandleIcon",style:{width:"20px",textAlign:"center"},children:"\u22ee"})})]},"header"+a)}),[I,w]),$=function(t){var a=t.rowData;a.is_file||(E.info("Fetching contents of folder..."),e.onRowDoubleClick(a))};return Object(o.useEffect)((function(){C([{columnData:{format:"button",onTaskRowAction:e.onTaskRowAction},dataKey:"actions",label:"Actions",cellRenderer:Ju,width:x.actions*r.current.offsetWidth,headerRenderer:T},{columnData:{format:"name"},dataKey:"name_text",label:"Name",cellRenderer:Ju,width:x.name_text*r.current.offsetWidth,headerRenderer:T},{columnData:{format:"size"},dataKey:"size",label:"Size",cellRenderer:Ju,width:x.size*r.current.offsetWidth,headerRenderer:T},{columnData:{format:"date"},dataKey:"modify_time",label:"Last Modified",cellRenderer:Ju,width:x.modify_time*r.current.offsetWidth,headerRenderer:T},{columnData:{format:"string"},dataKey:"comment",label:"Comment",cellRenderer:Ju,width:x.comment*r.current.offsetWidth,headerRenderer:T}])}),[x,e.onTaskRowAction]),Object(o.useEffect)((function(){if(e.showDeletedFiles)i(Object(F.a)(e.selectedFolder));else{var t=e.selectedFolder.filter((function(e){return!e.deleted}));i(Object(F.a)(t))}}),[e.selectedFolder,e.showDeletedFiles]),Object(g.jsx)("div",{ref:r,style:{width:"100%",height:"90%",overflow:"hidden"},children:Object(g.jsx)(Wo.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(Wo.c,{headerHeight:25,rowCount:n.length,rowGetter:D,rowHeight:35,height:t,width:a,sort:S,sortBy:m,onRowDoubleClick:$,sortDirection:d,children:w.map((function(e){return Object(g.jsx)(Wo.b,Object(k.a)({},e),"col"+e.dataKey)}))})}})})},Zu=function(e){var t=e.cellData,a=e.rowData,n=Object(xe.a)();return Object(g.jsxs)("div",{style:{alignItems:"center",display:"flex",textDecoration:a.deleted?"line-through":""},children:[a.is_file?Object(g.jsx)(yu.a,{style:{marginRight:"5px"}}):Object(g.jsx)(fu.a,{style:{marginRight:"5px",color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.folderColor:"grey"}}),a.filemeta.length>0?Object(g.jsx)(wc.a,{style:{color:n.palette.success.main}}):null,Object(g.jsx)(Q.a,{style:{color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.palette.text.primary:n.palette.text.secondary},children:t}),!0===a.success?Object(g.jsx)(gc.a,{title:"Successfully listed contents of folder",children:Object(g.jsx)(dn.a,{fontSize:"small",style:{color:n.palette.success.main}})}):!1===a.success?Object(g.jsx)(gc.a,{title:"Failed to list contents of folder",children:Object(g.jsx)(vu.a,{fontSize:"small",style:{color:n.palette.error.main}})}):null]})},Xu=function(e){return e.cellData},eb=function(e){var t=e.cellData;return Object(g.jsx)("div",{children:function(){try{var e=parseInt(t);if(""===t)return"";if(0===e)return"0 Bytes";var a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}catch(n){return t}}()})},tb=function(e){var t=e.rowData,a=e.onTaskRowAction,n=s.a.useRef(null),i=Object(xe.a)(),r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState(!1),f=Object(u.a)(h,2),O=f[0],x=f[1],y=s.a.useState(!1),_=Object(u.a)(y,2),v=_[0],w=_[1],C=s.a.useState(""),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useState([]),$=Object(u.a)(T,2),P=$[0],A=$[1],L=Object(At.a)(Gu,{onCompleted:function(e){I(e.filebrowserobj_by_pk.permissions),""!==e.filebrowserobj_by_pk.permissions?x(!0):E.warning("No permission data available")},fetchPolicy:"network-only"}),F=Object(u.a)(L,1)[0],q=Object(At.a)(Ku,{onCompleted:function(e){0===e.filebrowserobj_by_pk.filemeta.length?E.warning("File has no download history"):(A(e.filebrowserobj_by_pk.filemeta),w(!0))},fetchPolicy:"network-only"}),N=Object(u.a)(q,1)[0],R=Object(Ee.a)(Qu,{onCompleted:function(e){E.success("updated comment")}}),B=Object(u.a)(R,1)[0],z=function(e,t,a){switch(e){case"A":M[a].click(t);break;case"B":U[a].click(t)}l(!1)},W=function(e){n.current&&n.current.contains(e.target)||l(!1)},M=[{name:"View Permissions",icon:Object(g.jsx)(Hu.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),F({variables:{filebrowserobj_id:t.id}})}},{name:"Download History",icon:Object(g.jsx)(Wu.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),N({variables:{filebrowserobj_id:t.id}})}},{name:"Edit Comment",icon:Object(g.jsx)(Bi.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),m(!0)}},{name:"Copy Path to Clipboard",icon:Object(g.jsx)(qo.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),Lo(t.full_path_text)?E.success("Copied text!"):E.error("Failed to copy text")}}],U=[{name:"Task File Listing",icon:Object(g.jsx)(Vu.a,{style:{paddingRight:"5px",color:i.palette.warning.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:list"})}},{name:"Task Download",icon:Object(g.jsx)(wc.a,{style:{paddingRight:"5px",color:i.palette.success.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:download"})}},{name:"Task File Removal",icon:Object(g.jsx)(te.a,{style:{paddingRight:"5px",color:i.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:remove"})}}];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{style:{padding:0},size:"small","aria-controls":o?"split-button-menu":void 0,"aria-expanded":o?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),l((function(e){return!e}))},color:"primary",variant:"contained",ref:n,children:"Actions"}),Object(g.jsx)(gt.a,{open:o,anchorEl:n.current,role:void 0,transition:!0,style:{zIndex:4e3},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(g.jsx)(Ot.a,Object(k.a)(Object(k.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(g.jsx)(H.a,{style:{backgroundColor:"dark"===i.palette.type?i.palette.primary.dark:i.palette.primary.light,color:"white"},children:Object(g.jsx)(ft.a,{onClickAway:W,children:Object(g.jsxs)(yt.a,{id:"split-button-menu",children:[M.map((function(e,t){return Object(g.jsxs)(xt.a,{onClick:function(e){return z("A",e,t)},children:[e.icon,e.name]},e.name)})),Object(g.jsx)(Ma.a,{}),U.map((function(e,t){return Object(g.jsxs)(xt.a,{onClick:function(e){return z("B",e,t)},children:[e.icon,e.name]},e.name)}))]})})})}))}}),p&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit File Browser Comment",onSubmit:function(e){B({variables:{filebrowserobj_id:t.id,comment:e}})},value:t.comment,onClose:function(){m(!1)}})}),O&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:O,onClose:function(){x(!1)},innerDialog:Object(g.jsx)(pe,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:D,onClose:function(){x(!1)}})}),v&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:v,onClose:function(){w(!1)},innerDialog:Object(g.jsx)(Tu,{title:"Download History",value:P,onClose:function(){w(!1)}})})]})},ab=a(279),nb=a.n(ab),ib=Object(Pe.a)(Eu||(Eu=Object(q.a)(["\nfragment fileObjData on filebrowserobj {\n    access_time\n    comment\n    deleted\n    filemeta {\n        id\n    }\n    host\n    id\n    is_file\n    modify_time\n    parent_id\n    size\n    success\n    task {\n        callback {\n            id\n        }\n        operator {\n            id\n        }\n    }\n    full_path_text\n    name_text\n    timestamp\n    parent_path_text\n    filebrowserobjs_aggregate {\n        aggregate {\n            count\n        }   \n    }\n}\n"]))),rb=Object(Pe.a)(Lu||(Lu=Object(q.a)(["\n","\nquery myRootFolderQuery($operation_id: Int!) {\n    filebrowserobj(where: {operation_id: {_eq: $operation_id}, parent_id: {_is_null: true}}) {\n      ...fileObjData\n    }\n  }\n"])),ib),cb=Object(Pe.a)(Fu||(Fu=Object(q.a)(["\n","\nquery myFolderQuery($filebrowserobj_id: Int!, $operation_id: Int!) {\n    filebrowserobj(where: {parent_id: {_eq: $filebrowserobj_id}, operation_id: {_eq: $operation_id}}, order_by: {is_file: asc, name: asc}) {\n      ...fileObjData\n    }\n  }\n"])),ib),ob=Object(Pe.a)(qu||(qu=Object(q.a)(["\n","\nsubscription liveData($now: timestamp!, $operation_id: Int!){\n    filebrowserobj(distinct_on: id, order_by: {id: desc}, where: {timestamp: {_gt: $now}, operation_id: {_eq: $operation_id}}, limit: 1){\n        ...fileObjData\n    }\n}\n"])),ib),sb=Object(Pe.a)(Nu||(Nu=Object(q.a)(["\n","\nquery myDeltaFilesQuery($lastTime: timestamp!, $now: timestamp!, $operation_id: Int!){\n    filebrowserobj(distinct_on: id, order_by: {id: desc}, where: {_and: [{timestamp: {_gte: $lastTime}}, {timestamp: {_lte: $now}}], operation_id: {_eq: $operation_id}}){\n        ...fileObjData\n    }\n}\n"])),ib),lb=Object(Pe.a)(Ru||(Ru=Object(q.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $payloadtype: String!, $ui_feature: String!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_iregex: $ui_feature}}}) {\n    id\n    command {\n      cmd\n      help_cmd\n      description\n      id\n      needs_admin\n      payload_type_id\n      attributes\n      commandparameters {\n        id\n        type \n      }\n      supported_ui_features\n    }\n  }\n  command(where: {payloadtype: {ptype: {_eq: $payloadtype}}, script_only: {_eq: true}, deleted: {_eq: false}, supported_ui_features: {_iregex: $ui_feature }}){\n      id\n      cmd\n      help_cmd\n      description\n      needs_admin\n      attributes\n      payload_type_id\n      commandparameters {\n          id\n          type\n      }\n      supported_ui_features\n    }\n}\n"]))),db=Object(Pe.a)(Bu||(Bu=Object(q.a)(["\nquery getCallbackDataQuery($callback_id: Int!){\n    callback_by_pk(id: $callback_id){\n        payload {\n            os\n            payloadtype {\n              ptype\n              id\n            }\n            tag\n            id\n        }\n        id\n        operation_id\n        host\n        active\n    }\n}\n"])));function ub(e){var t=s.a.useState("File Browser: "+e.tabInfo.callbackID),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1];Object(o.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("File Browser: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(ko,Object(k.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),d(!0)}},e)),l&&Object(g.jsx)(be,{fullWidth:!0,open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Tab's Description",onClose:function(){d(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var bb,jb,pb,mb,hb,fb,Ob,gb,xb,yb=function(e){var t=e.index,a=e.value,n=e.tabInfo,i=Object(T.a)(C),r=s.a.useRef([]),c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useRef({}),O=s.a.useState({task:{callback:{id:n.callbackID}},host:n.host,full_path_text:"."}),x=Object(u.a)(O,2),y=x[0],_=x[1],v=s.a.useState({}),w=Object(u.a)(v,2),S=w[0],D=w[1],I=s.a.useState(!1),$=Object(u.a)(I,2),P=$[0],A=$[1],L=s.a.useState(!1),q=Object(u.a)(L,2),N=q[0],R=q[1],B=s.a.useState({}),z=Object(u.a)(B,2),W=z[0],M=z[1],H=s.a.useState({}),U=Object(u.a)(H,2),V=U[0],G=U[1],K=s.a.useState({}),Q=Object(u.a)(K,2),J=Q[0],Y=Q[1],Z=s.a.useState(""),X=Object(u.a)(Z,2),ee=X[0],te=X[1],ae=s.a.useRef(),ne=s.a.useState(!1),ie=Object(u.a)(ne,2),re=ie[0],ce=ie[1],oe=s.a.useRef((new Date).toISOString()),se=s.a.useState({}),le=Object(u.a)(se,2),de=le[0],ue=le[1],je=s.a.useState(!1),pe=Object(u.a)(je,2),me=pe[0],he=pe[1],fe=Object(Ae.a)(rb,{variables:{operation_id:i.user.current_operation_id},onCompleted:function(e){var t=e.filebrowserobj.reduce((function(e,t){for(var a=0;a<e.length;a++)if(e[a].host===t.host)return e[a].filebrowserobjs.push(Object(k.a)(Object(k.a)({},t),{},{parent_id:t.host,filebrowserobjs:[]})),Object(F.a)(e);return[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{id:t.host,filebrowserobjs:[Object(k.a)(Object(k.a)({},t),{},{parent_id:t.host,filebrowserobjs:[]})]})])}),[]);b(t)},fetchPolicy:"network-only"}).subscribeToMore,Oe=Object(At.a)(sb,{onCompleted:function(e){var t=Object(F.a)(r.current);e.filebrowserobj.forEach((function(e){var a=!1;if(null===e.parent_id){var n=!1;t.forEach((function(t){t.host===e.host&&(n=!0,t.filebrowserobjs.forEach((function(t){t.name_text===e.name_text&&(a=!0,t.comment=e.comment,t.success=e.success,t.deleted=e.deleted,t.filemeta=e.filemeta)})))})),n?n&&!a&&(a=!0,t.forEach((function(t){t.host===e.host&&t.filebrowserobjs.push(Object(k.a)(Object(k.a)({},e),{},{parent_id:e.host,filebrowserobjs:[]}))}))):a=!1}else t.forEach((function(t){t.host===e.host&&(a=!0,ke(t,e.parent_id,[e]))}));a||null!==e.parent_id||t.push(Object(k.a)(Object(k.a)({},e),{},{id:e.host,filebrowserobjs:[Object(k.a)(Object(k.a)({},e),{},{parent_id:e.host,filebrowserobjs:[]})]}))})),b(t),e.filebrowserobj.length>0&&void 0!==f.current.id&&(e.filebrowserobj[0].parent_id===f.current.id||f.current.host===e.filebrowserobj[0].host)&&h(Object.values(f.current.filebrowserobjs))},onError:function(e){console.log(e)}}),ge=Object(u.a)(Oe,1)[0];Object(o.useEffect)((function(){r.current=d}),[d]),Object(o.useEffect)((function(){f.current=y}),[y]);var xe=Object(At.a)(cb,{onError:function(e){console.error(e)},fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:function(e){var t=!1;if(0===e.filebrowserobj.length)return E.dismiss(),null===y.success?E.info("Folder hasn't been listed yet"):E.info("Empty folder"),void h(Object.values(y.filebrowserobjs));E.dismiss(),E.success("Fetched data");var a=d.map((function(a){if(e.filebrowserobj[0].host===a.host){var n=Object(k.a)({},a);return t=!0,ke(n,e.filebrowserobj[0].parent_id,e.filebrowserobj),n}return Object(k.a)({},a)}));t||(a.push(e.filebrowserobj[0]),ke(e.filebrowserobj[0],e.filebrowserobj[0].parent_id,e.filebrowserobj)),b(a),h(Object.values(y.filebrowserobjs))}}),ye=Object(u.a)(xe,1)[0],_e=Object(At.a)(db,{fetchPolicy:"no-cache",onCompleted:function(e){null!==e.callback_by_pk?e.callback_by_pk.active?G(Object(k.a)(Object(k.a)({},e.callback_by_pk),{},{ui_feature:".*"+ee+".*"},de)):E.warning("That callback isn't active"):E.warning("Failed to find that Callback"),ue({})},onError:function(e){E.error("Failed to fetch callback data for the specified callback")}}),ve=Object(u.a)(_e,1)[0],ke=Object(o.useCallback)((function(e,t,a){if(t===e.id){for(var n=0;n<a.length;n++)void 0===e.filebrowserobjs[a[n].id]?e.filebrowserobjs[a[n].id]=Object(k.a)(Object(k.a)({},a[n]),{},{filebrowserobjs:{}}):e.filebrowserobjs[a[n].id]=Object(k.a)(Object(k.a)({},a[n]),{},{filebrowserobjs:e.filebrowserobjs[a[n].id].filebrowserobjs});return!0}for(var i=0,r=Object.entries(e.filebrowserobjs);i<r.length;i++){var c=Object(u.a)(r[i],2),o=(c[0],c[1]);if(a[0].parent_path_text.startsWith(o.full_path_text))if(ke(o,t,a))return!0}return!1}),[]),we=Object(Ee.a)(Ud,{update:function(e,t){var a=t.data;"error"===a.createTask.status?E.error(a.createTask.error):E.success('Issued "'+W.cmd+'" to Callback '+V.id),M({}),G({}),Y({}),te("")},onError:function(e){console.error(e),M({}),G({}),Y({}),te("")}}),Ce=Object(u.a)(we,1)[0],Se=Object(At.a)(lb,{onCompleted:function(e){var t=e.loadedcommands.reduce((function(e,t){return[].concat(Object(F.a)(e),[t.command])}),[]),a=e.command.reduce((function(e,t){return[].concat(Object(F.a)(e),[t])}),Object(F.a)(t));D(a),0===a.length?E.warning("No commands currently loaded that support that feature"):1===a.length?M(Object(k.a)({},a[0])):(M({}),A(!0))},fetchPolicy:"network-only"}),De=Object(u.a)(Se,1)[0];Object(o.useEffect)((function(){if(void 0!==W.cmd)switch(ee){case"file_browser:list":void 0===J.path?Ce({variables:{callback_id:V.id,command:W.cmd,params:JSON.stringify({host:V.host,path:V.fullPath,file:""}),tasking_location:"file_browser"}}):Ce({variables:{callback_id:ae.current,command:W.cmd,params:JSON.stringify({host:J.host,path:J.path,file:J.filename}),tasking_location:"file_browser"}});break;case"file_browser:upload":R(!0);break;case"file_browser:download":case"file_browser:remove":Ce({variables:{callback_id:ae.current,command:W.cmd,params:JSON.stringify({host:J.host,path:J.path,file:J.filename}),tasking_location:"file_browser"}})}}),[W,Ce,V,y.full_path_text,J.filename,J.host,J.path,ee]),Object(o.useEffect)((function(){void 0!==V.id&&De({variables:{callback_id:V.id,payloadtype:V.payload.payloadtype.ptype,ui_feature:V.ui_feature}})}),[V]);var Ie=Object(o.useCallback)((function(e){h(Object.values(e.filebrowserobjs)),_(e)}),[]),Te=Object(o.useCallback)((function(e){ye({variables:{filebrowserobj_id:e.id,operation_id:i.user.current_operation_id}}),_(e)}),[]),$e=Object(o.useCallback)((function(e){var t=e.path,a=e.host,n=e.filename,i=e.uifeature,r=e.confirmed;"file_browser:remove"!==i||r?(ue({}),ve({variables:{callback_id:ae.current}}),D([]),te(i),Y({path:t,host:a,filename:n})):(ue({path:t,host:a,filename:n,uifeature:i}),ce(!0))}),[]),Pe=Object(o.useCallback)((function(e,t){var a=t.subscriptionData;if(a.data.filebrowserobj.length>0)return ge({variables:{operation_id:i.user.current_operation_id,now:(new Date).toISOString(),lastTime:oe.current}}),void(null!==a.data.filebrowserobj[0]&&void 0!==a.data.filebrowserobj[0]&&(oe.current=a.data.filebrowserobj[0].timestamp))}),[ke]);return Object(g.jsxs)(_o,{index:t,value:a,children:[Object(g.jsxs)("div",{style:{display:"flex",flexGrow:1,overflowY:"auto"},children:[Object(g.jsx)("div",{style:{width:"30%",overflow:"auto",flexGrow:1},children:Object(g.jsx)(Su,{showDeletedFiles:me,treeRoot:d,fetchFolderData:Te,setTableData:Ie})}),Object(g.jsxs)("div",{style:{width:"60%",display:"flex",flexDirection:"column",overflow:"auto",flexGrow:1},children:[Object(g.jsx)(_b,{selectedFolderData:y,onListFilesButton:function(e){var t=e.callbackID,a=e.fullPath;ve({variables:{callback_id:t}}),ue({fullPath:a}),D([]),te("file_browser:list")},onUploadFileButton:function(e){var t=e.callbackID;ve({variables:{callback_id:t}}),D([]),te("file_browser:upload")},onChangeCallbackID:function(e){ae.current=e},toggleShowDeletedFiles:function(e){he(e)},initialCallbackID:n.callbackID,subscribeToNewFileBrowserObjs:function(){return fe({document:ob,variables:{now:(new Date).toISOString(),operation_id:i.user.current_operation_id},updateQuery:Pe})}}),Object(g.jsx)(Yu,{showDeletedFiles:me,onRowDoubleClick:Te,selectedFolder:m,onTaskRowAction:$e})]})]}),P&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:P,onClose:function(){A(!1)},innerDialog:Object(g.jsx)(Qo,{onClose:function(){A(!1)},onSubmit:function(e){M(e)},options:S,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),N&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:N,onClose:function(){R(!1)},innerDialog:Object(g.jsx)(ws,{command:W,callback_id:V.id,payloadtype_id:V.payload.payloadtype.id,operation_id:V.operation_id,onSubmit:function(e,t,a){R(!1),Ce({variables:{callback_id:V.id,command:e,params:t,files:a}})},onClose:function(){R(!1)}})}),re&&Object(g.jsx)(La,{onSubmit:function(){$e(Object(k.a)(Object(k.a)({},de),{},{confirmed:!0}))},onClose:function(){ce(!1)},open:re})]})},_b=function(e){var t=e.selectedFolderData,a=e.onListFilesButton,n=e.initialCallbackID,i=e.onUploadFileButton,r=e.onChangeCallbackID,c=e.subscribeToNewFileBrowserObjs,l=e.toggleShowDeletedFiles,d=Object(xe.a)(),b=s.a.useState(""),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState(""),f=Object(u.a)(h,2),O=f[0],x=f[1],_=s.a.useState(n),v=Object(u.a)(_,2),k=v[0],w=v[1],C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useState(!0),$=Object(u.a)(T,2),P=$[0],A=$[1];Object(o.useEffect)((function(){void 0!==t.host&&m(t.host),void 0!==t.full_path_text&&x(t.full_path_text),P||void 0!==t.task&&w(t.task.callback.id)}),[t,P]);var L=function(){""!==O?k>0?a({callbackID:k,fullPath:O}):E.warning("Must select a folder or set a callback number first"):E.warning("Must provide a path to list")};Object(o.useEffect)((function(){r(k)}),[k]),Object(o.useEffect)((function(){c()}),[]);return Object(g.jsxs)(Ft.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:4,children:Object(g.jsx)(y,{placeholder:"Host Name",value:p,onChange:function(e,t){m(t)},name:"Host Name"})}),Object(g.jsx)(Ft.a,{item:!0,xs:7,children:Object(g.jsx)(y,{placeholder:"Path",value:O,onEnter:L,onChange:function(e,t){x(t)},name:"Path",InputProps:{endAdornment:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(gc.a,{title:"Task callback to list contents",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:L,children:Object(g.jsx)(uu.a,{style:{color:d.palette.info.main}})})}),Object(g.jsx)(gc.a,{title:"Upload file to folder via callback",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){k>0?i({callbackID:k}):E.warning("Must select a folder or set a callback number first")},children:Object(g.jsx)(lu.a,{style:{color:d.palette.info.main}})})}),Object(g.jsx)(gc.a,{title:D?"Hide Deleted Files":"Show Deleted Files",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){I(!D),l(!D)},children:D?Object(g.jsx)(Hu.a,{style:{color:d.palette.info.main}}):Object(g.jsx)(nb.a,{style:{color:d.palette.info.main}})})})]}),style:{padding:0}}})}),Object(g.jsx)(Ft.a,{item:!0,xs:1,children:Object(g.jsx)(y,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t){A(!0),w(parseInt(t))},value:k,InputProps:{endAdornment:P?Object(g.jsx)(gc.a,{title:"Change Callback Based on Data Origin",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){A(!1),t.task?w(t.task.callback.id):(w(0),r(0))},children:Object(g.jsx)(to.a,{style:{color:d.palette.info.main}})})}):Object(g.jsx)(gc.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(g.jsx)(K.a,{style:{padding:"3px"},children:Object(g.jsx)(ju.a,{disabled:!0,style:{color:d.palette.warning.main}})})}),style:{padding:0,margin:0}}})})]})},vb=Object(Ge.a)((function(e){return{root:{width:"99%",marginTop:"3px",marginBottom:"2px",marginLeft:"3px",marginRight:"0px",height:"auto"},heading:{fontSize:e.typography.pxToRem(15),whiteSpace:"pre-line"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"calc(90vw)",whiteSpace:"break-word"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),kb=function(e,t,a){return{data:Object(k.a)({id:e.id.toString(),isLeaf:void 0===e.children||0===e.children.length,isOpenByDefault:!0,name:e.name,nestingLevel:t,theme:a},e),nestingLevel:t,node:e}},wb=function(e){var t=e.treeRoot,a=e.theme,n=Object(o.useCallback)(r.a.mark((function e(){var n,i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=7;break}return e.next=4,kb(t[n],0,a);case 4:n++,e.next=1;break;case 7:return void(e.next=10);case 10:i=e.sent,c=0;case 12:if(!(c<i.node.children.length)){e.next=18;break}return e.next=15,kb(i.node.children[c],i.nestingLevel+1,a);case 15:c++,e.next=12;break;case 18:e.next=7;break;case 20:case"end":return e.stop()}}),e)})),[t,a]);return 0===t.length?Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Process Listing Data"}):Object(g.jsx)(gi.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(ku.a,{treeWalker:n,height:t-10,width:a-10,itemSize:30,async:!0,placeholder:Object(g.jsx)("div",{children:"Loading...."}),children:Cb})}})},Cb=function(e){var t=e.data,a=e.isOpen,n=e.style,i=e.setOpen;return Object(g.jsxs)("div",{style:Object(k.a)(Object(k.a)({},n),{},{width:"calc(100vw)",display:"inline-flex",overflow:"auto"}),children:[Object(F.a)(Array(t.nestingLevel)).map((function(e,a){return Object(g.jsx)("div",{style:{borderLeft:"1px dashed ".concat(Object(Co.c)(t.theme.palette.text.primary,.4)),marginLeft:15,paddingRight:15,height:"100%",display:"inline-block"}},"folder"+t.id+"lines"+a)})),Object(g.jsx)(Sb,{filebrowserobj:t,isOpen:a,setOpen:i})]})},Sb=function(e){var t=vb(),a=Object(xe.a)();return Object(g.jsx)(H.a,{className:t.root,elevation:5,style:{backgroundColor:a.body,color:a.text,alignItems:"center",display:"flex"},children:Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:[e.filebrowserobj.process_id," - ",e.filebrowserobj.name]})})},Db=Object(Pe.a)(bb||(bb=Object(q.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        command_line\n        description\n        signer\n        start_time\n        name\n        bin_path\n    }\n}\n"]))),Ib=Object(Pe.a)(jb||(jb=Object(q.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        tokens(where: {deleted: {_eq: false}}) {\n            Address\n            AppContainer\n            AppContainerNumber\n            AppContainerSid\n            AppId\n            AppModelPolicies\n            AppModelPolicyDictionary\n            AttributesFlags\n            AuditPolicy\n            AuthenticationId_id\n            BnoIsolationPrefix\n            CanSynchronize\n            Capabilities\n            CreationTime\n            DefaultDacl\n            DenyOnlyGroups\n            DeviceClaimAttributes\n            DeviceGroups\n            Elevated\n            ElevationType\n            EnabledGroups\n            ExpirationTime\n            Filtered\n            Flags\n            FullPath\n            GrantedAccess\n            GrantedAccessGeneric\n            GrantedAccessMask\n            GroupCount\n            Groups\n            Handle\n            HandleReferenceCount\n            HasRestrictions\n            ImpersonationLevel\n            Inherit\n            IntegrityLevel\n            IntegrityLevelSid\n            IsClosed\n            IsContainer\n            IsPseudoToken\n            IsRestricted\n            IsSandbox\n            LogonSid\n            LowPrivilegeAppContainer\n            MandatoryPolicy\n            ModifiedId\n            Name\n            NoChildProcess\n            NotLow\n            NtType\n            NtTypeName\n            Owner\n            Origin\n            PackageFullName\n            PackageIdentity\n            PackageName\n            PointerReferenceCount\n            PrimaryGroup\n            PrivateNamespace\n            Privileges\n            ProcessUniqueAttribute\n            ProtectFromClose\n            Restricted\n            RestrictedDeviceClaimAttributes\n            RestrictedDeviceGroups\n            RestrictedSids\n            RestrictedSidsCount\n            RestrictedUserClaimAttributes\n            SandboxInert\n            Sddl\n            SecurityAttributes\n            SecurityDescriptor\n            SessionId\n            Source\n            ThreadID\n            TokenId\n            TokenType\n            TrustLevel\n            UIAccess\n            User\n            UserClaimAttributes\n            VirtualizationAllowed\n            VirtualizationEnabled\n            WriteRestricted\n            callbacktokens {\n                callback_id\n            }\n            logonsession {\n                id\n            }\n            task_id\n            timestamp_created\n        }\n    }\n}\n"]))),Tb=function(){return Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Data Selected"})},$b=function(e){var t=e.columnData,a=e.dataKey,n=e.rowData;return function(){switch(t.format){case"string":return Object(g.jsx)(Ab,{cellData:n[a],rowData:n});case"button":return Object(g.jsx)(Eb,{rowData:n,onTaskRowAction:t.onTaskRowAction,os:t.os});default:return Object(g.jsx)(Ab,{cellData:n[a],rowData:n})}}()},Pb=function(e){var t=s.a.useRef(null),a=s.a.useState("ASC"),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("name"),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState({actions:.065,parent_process_id:.0714,process_id:.0714,architecture:.06,name:.14,user:.14,bin_path:.4}),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState([]),O=Object(u.a)(f,2),x=O[0],y=O[1],_=function(e){var t=e.sortBy,a=e.sortDirection,n=Object(F.a)(I),i=x.filter((function(e){return e.dataKey===t}))[0].columnData.format;"number"===i||"size"===i?n.sort((function(e,a){return parseInt(e[t])>parseInt(a[t])?1:-1})):"date"===i?n.sort((function(e,a){return new Date(e[t])>new Date(a[t])?1:-1})):n.sort((function(e,a){return e[t]>a[t]?1:-1})),"DESC"===a&&n.reverse(),T(Object(F.a)(n)),b(t),r(a)},v=function(e){var t=e.index;return I[t]},w=s.a.useCallback((function(e){var a,n=e.event,i=e.dataKey,r=e.deltaX;n.preventDefault(),n.stopPropagation();for(var c=Object(k.a)({},m),o=r/t.current.offsetWidth,s="",l=!1,d=0,u=Object.keys(m);d<u.length;d++){var b=u[d];if(l){s=b;break}b===i&&(l=!0)}if(""!==s){var j=Object(k.a)(Object(k.a)({},c),{},(a={},Object(Pt.a)(a,i,c[i]+o),Object(Pt.a)(a,s,c[s]-o),a));h(j)}else console.log("next header not found")}),[m]),C=s.a.useCallback((function(e){var t=e.columnData,a=e.dataKey,n=(e.disableSort,e.label),i=e.sortBy,r=e.sortDirection;return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)("span",{style:{display:"inline-flex",flexDirection:"row",alignContent:"stretch",justifyContent:"flex-start"},children:[n,i===a?"ASC"===r?Object(g.jsx)(Vo.a,{}):Object(g.jsx)(Ko.a,{}):null]}),"button"!==t.format&&"Path"!==n&&Object(g.jsx)(Ho.a,{axis:"x",defaultClassName:"DragHandle",defaultClassNameDragging:"DragHandleActive",onDrag:function(e,t){var n=t.deltaX;return w({event:e,dataKey:a,deltaX:n})},position:{x:0},zIndex:999,children:Object(g.jsx)("span",{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"DragHandleIcon",style:{width:"20px",textAlign:"center"},children:"\u22ee"})})]},"header"+a)}),[w,x]),S=s.a.useState([]),D=Object(u.a)(S,2),I=D[0],T=D[1];return Object(o.useEffect)((function(){y([{columnData:{format:"button",onTaskRowAction:e.onTaskRowAction,os:e.os},dataKey:"actions",label:"Actions",cellRenderer:$b,width:m.actions*t.current.offsetWidth,headerRenderer:C},{columnData:{format:"number"},dataKey:"parent_process_id",label:"PPID",cellRenderer:$b,width:m.parent_process_id*t.current.offsetWidth,headerRenderer:C},{columnData:{format:"number"},dataKey:"process_id",label:"PID",cellRenderer:$b,width:m.process_id*t.current.offsetWidth,headerRenderer:C},{columnData:{format:"string"},dataKey:"architecture",label:"Arch",cellRenderer:$b,width:m.architecture*t.current.offsetWidth,headerRenderer:C},{columnData:{format:"string"},dataKey:"name",label:"Name",cellRenderer:$b,width:m.name*t.current.offsetWidth,headerRenderer:C},{columnData:{format:"string"},dataKey:"user",label:"User",cellRenderer:$b,width:m.user*t.current.offsetWidth,headerRenderer:C},{columnData:{format:"string"},dataKey:"bin_path",label:"Path",cellRenderer:$b,width:m.bin_path*t.current.offsetWidth,headerRenderer:C}])}),[m,e.onTaskRowAction,e.os]),Object(o.useEffect)((function(){T(e.selectedFolder)}),[e.selectedFolder]),Object(g.jsx)("div",{ref:t,style:{width:"100%",height:"90%",overflow:"hidden"},children:Object(g.jsx)(Wo.a,{children:function(e){var t=e.height,a=e.width;return Object(g.jsx)(Wo.c,{headerHeight:25,noRowsRenderer:Tb,rowCount:I.length,rowGetter:v,rowHeight:35,height:t,width:a,sort:_,sortBy:d,sortDirection:i,children:x.map((function(e){return Object(g.jsx)(Wo.b,Object(k.a)({},e),"col"+e.dataKey)}))})}})})},Ab=function(e){return e.cellData},Eb=function(e){var t=e.rowData,a=e.onTaskRowAction,n=e.os,i=s.a.useRef(null),r=Object(xe.a)(),c=s.a.useState(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),O=Object(u.a)(f,2),x=(O[0],O[1],s.a.useState({})),y=Object(u.a)(x,2),_=y[0],v=y[1],w=s.a.useState({}),C=Object(u.a)(w,2),S=(C[0],C[1]),D=Object(At.a)(Db,{onCompleted:function(e){v(e.process_by_pk),h(!0)},fetchPolicy:"network-only"}),I=Object(u.a)(D,1)[0],T=Object(At.a)(Ib,{onCompleted:function(e){0===e.process_by_pk.tokens.length?E.warning("No Token Data for Process"):(S(e.process_by_pk.tokens),h(!0))},fetchPolicy:"network-only"}),$=Object(u.a)(T,1)[0],P=function(e,t,a){switch(e){case"A":L[a].click(t);break;case"B":F[a].click(t)}d(!1)},A=function(e){i.current&&i.current.contains(e.target)||d(!1)},L=[{name:"View Detailed Data",icon:Object(g.jsx)(Hu.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),I({variables:{process_id:t.id}})}},{name:"View Tokens",icon:Object(g.jsx)(Hu.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),$({variables:{process_id:t.id}})},os:["Windows"]}],F=[{name:"Task Token Listing",icon:Object(g.jsx)(Vu.a,{style:{paddingRight:"5px",color:r.palette.warning.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:list_tokens"})},os:["Windows"]},{name:"Task Inject",icon:Object(g.jsx)(wc.a,{style:{paddingRight:"5px",color:r.palette.success.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:inject"})}},{name:"Task Steal Token",icon:Object(g.jsx)(te.a,{style:{paddingRight:"5px",color:r.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:steal_token"})},os:["Windows"]},{name:"Task Kill Process",icon:Object(g.jsx)(te.a,{style:{paddingRight:"5px",color:r.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"process_browser:kill"})}}];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(b.a,{style:{padding:0},size:"small","aria-controls":l?"split-button-menu":void 0,"aria-expanded":l?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),d((function(e){return!e}))},color:"primary",variant:"contained",ref:i,children:"Actions"}),Object(g.jsx)(gt.a,{open:l,anchorEl:i.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(g.jsx)(Ot.a,Object(k.a)(Object(k.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(g.jsx)(H.a,{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"},children:Object(g.jsx)(ft.a,{onClickAway:A,children:Object(g.jsxs)(yt.a,{id:"split-button-menu",children:[L.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(g.jsxs)(xt.a,{onClick:function(e){return P("A",e,t)},children:[e.icon,e.name]},e.name):null})),Object(g.jsx)(Ma.a,{}),F.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(g.jsxs)(xt.a,{onClick:function(e){return P("B",e,t)},children:[e.icon,e.name]},e.name):null}))]})})})}))}}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){h(!1)},innerDialog:Object(g.jsx)(me,{title:"View Detailed Data",leftColumn:"Attribute",rightColumn:"Value",value:_,onClose:function(){h(!1)},keys:["name","bin_path","signer","command_line","start_time","description"]})})]})},Lb=a(458),Fb=a.n(Lb),qb=a(457),Nb=a.n(qb),Rb=a(459),Bb=a.n(Rb),zb=Object(Pe.a)(pb||(pb=Object(q.a)(["\nfragment objData on process {\n    name\n    process_id\n    parent_process_id\n    architecture\n    bin_path\n    integrity_level\n    id\n    user\n}\n"]))),Wb=Object(Pe.a)(mb||(mb=Object(q.a)(["\nfragment taskData on task {\n    id\n    callback {\n        id\n        host\n        payload {\n            id\n            os\n            payloadtype{\n                ptype\n            }\n        }\n    }\n}\n"]))),Mb=Object(Pe.a)(hb||(hb=Object(q.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_gt: $task_id}}, order_by: {task_id: asc}, limit: 1) {\n        task {\n            ...taskData\n            processes(order_by: {process_id: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),zb,Wb),Hb=Object(Pe.a)(fb||(fb=Object(q.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_lt: $task_id}}, order_by: {task_id: desc}, limit: 1) {\n        task {\n            ...taskData\n            processes(order_by: {name: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),zb,Wb),Ub=Object(Pe.a)(Ob||(Ob=Object(q.a)(["\nquery getHostsQuery($operation_id: Int!, $host:String!){\n    process_aggregate(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}}, distinct_on: task_id){\n        aggregate {\n            max {\n              task_id\n            }\n        }\n    }\n}\n"]))),Vb=Object(Pe.a)(gb||(gb=Object(q.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $payloadtype: String!, $ui_feature: String!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_iregex: $ui_feature}}}) {\n    id\n    command {\n      cmd\n      help_cmd\n      description\n      id\n      needs_admin\n      payload_type_id\n      attributes\n      commandparameters {\n        id\n        type \n      }\n      supported_ui_features\n    }\n  }\n  command(where: {payloadtype: {ptype: {_eq: $payloadtype}}, script_only: {_eq: true}, deleted: {_eq: false}, supported_ui_features: {_iregex: $ui_feature }}){\n      id\n      cmd\n      help_cmd\n      description\n      needs_admin\n      attributes\n      payload_type_id\n      commandparameters {\n          id\n          type\n      }\n      supported_ui_features\n    }\n}\n"]))),Gb=Object(Pe.a)(xb||(xb=Object(q.a)(["\nquery getCallbackDataQuery($callback_id: Int!){\n    callback_by_pk(id: $callback_id){\n        payload {\n            os\n            payloadtype {\n              ptype\n              id\n            }\n            tag\n            id\n        }\n        id\n        operation_id\n        host\n        active\n    }\n}\n"])));function Kb(e){var t=s.a.useState("Processes: "+e.tabInfo.host),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1];Object(o.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("Processes: "+e.tabInfo.host)}),[e.tabInfo.customDescription]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(ko,Object(k.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),d(!0)}},e)),l&&Object(g.jsx)(be,{fullWidth:!0,open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Tab's Description",onClose:function(){d(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var Qb,Jb=function(e){var t=e.index,a=e.value,n=e.tabInfo,i=Object(xe.a)(),r=Object(T.a)(C),c=s.a.useRef([]),l=s.a.useState([]),d=Object(u.a)(l,2),b=d[0],j=d[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState({}),x=Object(u.a)(O,2),y=x[0],_=x[1],v=s.a.useState(!1),w=Object(u.a)(v,2),S=w[0],D=w[1],I=s.a.useState(!1),$=Object(u.a)(I,2),P=$[0],A=$[1],L=s.a.useState({}),q=Object(u.a)(L,2),N=q[0],R=q[1],B=s.a.useState({}),z=Object(u.a)(B,2),W=z[0],M=z[1],H=s.a.useState({}),U=Object(u.a)(H,2),V=U[0],G=U[1],K=s.a.useState(""),Q=Object(u.a)(K,2),J=Q[0],Y=Q[1],Z=s.a.useRef(),X=s.a.useState(""),ee=Object(u.a)(X,2),te=ee[0],ae=ee[1],ne=Object(At.a)(Gb,{fetchPolicy:"no-cache",onCompleted:function(e){null!==e.callback_by_pk?e.callback_by_pk.active?M(Object(k.a)(Object(k.a)({},e.callback_by_pk),{},{ui_feature:".*"+J+".*"})):E.warning("That callback isn't active"):E.warning("Failed to find that Callback")},onError:function(e){E.error("Failed to fetch callback data for the specified callback")}}),ie=Object(u.a)(ne,1)[0],re=function e(t,a){if(t.process_id===a.parent_process_id)return t.children.push(Object(k.a)(Object(k.a)({},a),{},{children:[]})),!0;for(var n=0;n<t.children.length;n++)if(e(t.children[n],a))return!0;return!1},ce=Object(At.a)(Mb,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{children:[]})]);var a=Object(F.a)(e).map((function(e){return re(e,t),Object(k.a)({},e)}));return Object(F.a)(a)}),[]);j(t),f(e.process[0].task.processes),ae(e.process[0].task.callback.payload.os),G(e.process[0].task),E.dismiss(),E.success("Successfully fetched process data")}else E.dismiss(),E.warning("No Newer Process Sets")}}),oe=Object(u.a)(ce,1)[0],se=Object(At.a)(Hb,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{children:[]})]);var a=Object(F.a)(e).map((function(e){return re(e,t),Object(k.a)({},e)}));return Object(F.a)(a)}),[]);j(t),f(e.process[0].task.processes),ae(e.process[0].task.callback.payload.os),G(e.process[0].task),E.dismiss(),E.success("Successfully fetched process data")}else E.dismiss(),E.warning("No Earlier Process Sets")}}),le=Object(u.a)(se,1)[0];Object(Ae.a)(Ub,{variables:{operation_id:r.user.current_operation_id,host:n.host},onCompleted:function(e){null===e.process_aggregate.aggregate.max.task_id?(E.warning("No Process Data for "+n.host),G({callback:{host:n.host,id:n.callbackID},id:0})):(E.info("Fetching latest process data for "+n.host),oe({variables:{operation_id:r.user.current_operation_id,host:n.host,task_id:e.process_aggregate.aggregate.max.task_id-1}}))},fetchPolicy:"network-only"}),Object(o.useEffect)((function(){c.current=b}),[b]);var de=Object(Ee.a)(Ud,{update:function(e,t){var a=t.data;"error"===a.createTask.status?E.error(a.createTask.error):E.success('Issued "'+N.cmd+'" to Callback '+W.id),R({}),M({}),Y("")},onError:function(e){console.error(e),R({}),M({}),Y("")}}),ue=Object(u.a)(de,1)[0],je=Object(At.a)(Vb,{onCompleted:function(e){var t=e.loadedcommands.reduce((function(e,t){return[].concat(Object(F.a)(e),[t.command])}),[]),a=e.command.reduce((function(e,t){return[].concat(Object(F.a)(e),[t])}),Object(F.a)(t));_(a),0===a.length?E.warning("No commands currently loaded that support that feature"):1===a.length?R(Object(k.a)({},a[0])):(R({}),D(!0))},fetchPolicy:"network-only"}),pe=Object(u.a)(je,1)[0];Object(o.useEffect)((function(){if(void 0!==N.cmd)if(0===N.commandparameters.length)ue({variables:{callback_id:W.id,command:N.cmd,params:""}});else switch(J){case"process_browser:list":A(!0)}}),[N,ue,W,J]),Object(o.useEffect)((function(){void 0!==W.id&&pe({variables:{callback_id:W.id,payloadtype:W.payload.payloadtype.ptype,ui_feature:W.ui_feature}})}),[W,pe]);return Object(g.jsxs)(_o,{index:t,value:a,children:[Object(g.jsxs)("div",{style:{display:"flex",flexGrow:1,overflowY:"auto"},children:[Object(g.jsx)("div",{style:{width:"30%",overflow:"auto",flexGrow:1},children:Object(g.jsx)(wb,{treeRoot:b,theme:i})}),Object(g.jsxs)("div",{style:{width:"60%",display:"flex",flexDirection:"column",overflow:"auto",flexGrow:1},children:[Object(g.jsx)(Yb,{onListFilesButton:function(e){var t=e.callbackID;ie({variables:{callback_id:t}}),_([]),Y("process_browser:list")},onNextButton:function(e){var t=e.task_id;oe({variables:{operation_id:r.user.current_operation_id,host:n.host,task_id:t}})},onPreviousButton:function(e){var t=e.task_id;le({variables:{operation_id:r.user.current_operation_id,host:n.host,task_id:t}})},onDiffButton:function(e){e.task_id},initialCallbackID:n.callbackID,onChangeCallbackID:function(e){Z.current=e},taskInfo:V}),Object(g.jsx)(Pb,{selectedFolder:h,onTaskRowAction:function(e){e.path,e.host,e.filename;var t=e.uifeature;ie({variables:{callback_id:Z.current}}),_([]),Y(t)},os:te})]})]}),S&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:S,onClose:function(){D(!1)},innerDialog:Object(g.jsx)(Qo,{onClose:function(){D(!1)},onSubmit:function(e){R(e)},options:y,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),P&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:P,onClose:function(){A(!1)},innerDialog:Object(g.jsx)(ws,{command:N,callback_id:W.id,payloadtype_id:W.payload.payloadtype.id,operation_id:W.operation_id,onSubmit:function(e,t,a){A(!1),ue({variables:{callback_id:W.id,command:e,params:t,files:a}})},onClose:function(){A(!1)}})})]})},Yb=function(e){var t=e.onListFilesButton,a=e.onNextButton,n=e.onPreviousButton,i=e.initialCallbackID,r=(e.onDiffButton,e.onChangeCallbackID),c=e.taskInfo,l=Object(xe.a)(),d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState(i),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState(!0),_=Object(u.a)(x,2),v=_[0],k=_[1],w=s.a.useState(0),C=Object(u.a)(w,2),S=C[0],D=C[1];Object(o.useEffect)((function(){void 0!==c.callback&&(p(c.callback.host),D(c.id)),v||(void 0!==c.callback?O(c.callback.id):O(0))}),[c,v]);return Object(o.useEffect)((function(){r(f)}),[f,r]),Object(g.jsxs)(Ft.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:10,children:Object(g.jsx)(y,{placeholder:"Host Name",value:j,disabled:!0,onChange:function(){},name:"Host Name",InputProps:{endAdornment:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(gc.a,{title:"Fetch Previous Saved Process Listing",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){E.info("Fetching previous process data..."),n({task_id:c.id})},children:Object(g.jsx)(Nb.a,{style:{color:l.palette.info.main}})})}),Object(g.jsx)(gc.a,{title:"Task Callback to List Processes",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){f>0?t({callbackID:f}):E.warning("Must set a callback number to task first")},children:Object(g.jsx)(uu.a,{style:{color:l.palette.info.main}})})}),Object(g.jsx)(gc.a,{title:"Fetch Next Saved Process Listing",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){E.info("Fetching next process data..."),a({task_id:c.id})},children:Object(g.jsx)(Fb.a,{style:{color:l.palette.info.main}})})}),Object(g.jsx)(gc.a,{title:"Compare Previous Listing",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){f>0?a({callbackID:f}):E.warning("Must select a callback number first")},children:Object(g.jsx)(Bb.a,{style:{color:l.palette.info.main}})})})]})}})}),Object(g.jsx)(Ft.a,{item:!0,xs:1,children:Object(g.jsx)(y,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t,a){k(!0),O(parseInt(t))},value:f,InputProps:{endAdornment:v?Object(g.jsx)(gc.a,{title:"Change Callback Based on Data Origin",children:Object(g.jsx)(K.a,{style:{padding:"3px"},onClick:function(){k(!1),void 0!==c.callback?O(c.callback.id):O(0)},children:Object(g.jsx)(to.a,{style:{color:l.palette.info.main}})})}):Object(g.jsx)(gc.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(g.jsx)(K.a,{style:{padding:"3px"},children:Object(g.jsx)(ju.a,{disabled:!0,style:{color:l.palette.warning.main}})})}),style:{padding:0,margin:0}}})}),Object(g.jsx)(Ft.a,{item:!0,xs:1,children:Object(g.jsx)(y,{type:"number",name:"Task Data",disabled:!0,value:S,onChange:function(){}})})]})},Zb=Object(Pe.a)(Qb||(Qb=Object(q.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbacktoken(where: {deleted: {_eq: false}, callback: {operation_id: {_eq: $operation_id}, active: {_eq: true}}}) {\n    token {\n      TokenId\n      id\n      User\n      description\n    }\n    callback {\n      id\n    }\n    id\n  }\n}\n "]))),Xb=Object(Ge.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function ej(e){var t=e.onCloseTab,a=e.openTabs,n=e.clickedTabId,i=e.clearSelectedTab,r=e.onEditTabDescription,c=Xb(),l=Object(T.a)(C),d=s.a.useState([]),b=Object(u.a)(d,2),j=b[0],p=b[1];Object(ct.a)(Zb,{variables:{operation_id:l.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;p(t.data.callbacktoken)}});var m=s.a.useState(0),h=Object(u.a)(m,2),f=h[0],O=h[1],x=function(e){var a=e.tabID,n=e.index;O(n>0?n-1:0),t({tabID:a,index:n})};return Object(o.useEffect)((function(){for(var e=0;e<a.length;e++)a[e].tabID===n&&O(e);i()}),[n,a,i]),Object(g.jsxs)("div",{className:c.root,style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(g.jsx)(cu.a,{position:"static",color:"default",children:Object(g.jsx)(ou.a,{value:f,onChange:function(e,t){O(t),localStorage.setItem("clickedTab",a[t].tabID)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",style:{maxWidth:"100%",width:"100%"},"aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e.tabType){case"interact":return Object(g.jsx)(Wd,{onEditTabDescription:r,onCloseTab:x,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"fileBrowser":return Object(g.jsx)(ub,{onEditTabDescription:r,onCloseTab:x,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"processBrowser":return Object(g.jsx)(Kb,{onEditTabDescription:r,onCloseTab:x,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);default:return null}}))})}),a.map((function(e,t){switch(e.tabType){case"interact":return Object(g.jsx)(Kd,{style:{position:"relative",height:"100%",maxHeight:"100%"},onCloseTab:x,tabInfo:e,value:f,index:t,callbacktokens:j},"tabpanel"+e.tabID+e.tabType);case"fileBrowser":return Object(g.jsx)(yb,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:x,tabInfo:e,value:f,index:t},"tabpanel"+e.tabID+e.tabType);case"processBrowser":return Object(g.jsx)(Jb,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:x,tabInfo:e,value:f,index:t},"tabpanel"+e.tabID+e.tabType);default:return null}}))]})}var tj=a(465),aj=a.n(tj),nj=a(464),ij=a.n(nj);function rj(e){var t=s.a.useState({top:"0%",bottom:"0%"}),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(e.heights)}),[e.heights]);var r=function(e,t,a){var r=Object(k.a)({},n);r[e]=t,i(r)};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Adjust sizes of Top/Bottom sections"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(y,{autoFocus:!0,value:n.top,onChange:r,name:"top"}),Object(g.jsx)(y,{value:n.bottom,onChange:r,name:"bottom"})]})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit(n),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}var cj=a(911);function oj(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}function sj(e,t){return"desc"===e?function(e,a){return oj(e,a,t)}:function(e,a){return-oj(e,a,t)}}function lj(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))}function dj(e){var t=e.classes,a=e.onSelectAllClick,n=e.order,i=e.orderBy,r=e.numSelected,c=e.onRequestSort;return Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{padding:"checkbox",children:Object(g.jsx)(za.a,{indeterminate:r>0&&r<e.rowCount,checked:e.rowCount>0&&r===e.rowCount,onChange:a,inputProps:{"aria-label":"select all desserts"}})}),e.headCells.map((function(a){return void 0===e.shownColumns||e.shownColumns.includes(a.id)||"id"===a.id?Object(g.jsx)(B.a,{align:"left",padding:a.disablePadding?"none":"default",sortDirection:i===a.id&&n,children:Object(g.jsxs)(cj.a,{active:i===a.id,direction:i===a.id?n:"asc",onClick:(r=a.id,function(e){c(e,r)}),children:[a.label,i===a.id?Object(g.jsx)("span",{className:t.visuallyHidden,children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},a.id):null;var r}))]})})}function uj(e){var t="enhanced-table-checkbox-".concat(e.index);return Object(g.jsxs)(M.a,{hover:!0,role:"checkbox","aria-checked":e.isItemSelected,tabIndex:-1,selected:e.isItemSelected,style:void 0===e.style?{}:e.style,children:[Object(g.jsx)(B.a,{padding:"checkbox",children:Object(g.jsx)(za.a,{onClick:function(t){return e.handleClick(t,e.id)},checked:e.isItemSelected,inputProps:{"aria-labelledby":t}})}),e.children]},e.id)}var bj,jj,pj,mj,hj,fj,Oj,gj,xj=Object(Ge.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}}));function yj(e){var t=xj(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState(""),x=Object(u.a)(O,2),y=x[0],_=x[1],v=s.a.useState(""),k=Object(u.a)(v,2),w=k[0],C=k[1],S=T(i,d),D=T(i,h);function I(t,a){return e.itemKey?t.filter((function(t){return void 0===a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1===a.indexOf(e)}))}function T(t,a){return e.itemKey?t.filter((function(t){return void 0!==a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1!==a.indexOf(e)}))}var $=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(F.a)(i);-1===a?n.push(t):n.splice(a,1),r(n)}};Object(o.useEffect)((function(){var t=e.left.reduce((function(t,a){return void 0===e.itemKey?e.right.includes(a)?Object(F.a)(t):[].concat(Object(F.a)(t),[a]):e.right.find((function(t){return t[e.itemKey]===a[e.itemKey]}))?Object(F.a)(t):[].concat(Object(F.a)(t),[a])}),[]);j(t),f(e.right),_(e.leftTitle),C(e.rightTitle)}),[e.left,e.right,e.leftTitle,e.rightTitle,e.itemKey]);var P=function(a,n){return Object(g.jsx)(H.a,{className:t.paper,style:{width:"100%",height:"calc(50vh)"},children:Object(g.jsxs)(Ke.a,{children:[Object(g.jsx)(Wa.a,{className:t.cardHeader,title:a}),Object(g.jsx)(Ma.a,{}),Object(g.jsxs)(qa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[n.map((function(t){var a=void 0===e.itemKey?t:t[e.itemKey],n="transfer-list-item-".concat(a,"-label");return Object(g.jsxs)(Na.a,{style:{padding:0},role:"listitem",button:!0,onClick:$(t),children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(za.a,{checked:void 0===e.itemKey?-1!==i.indexOf(a):-1!==i.findIndex((function(t){return t[e.itemKey]===a})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(g.jsx)(Ba.a,{id:n,primary:a})]},a)})),Object(g.jsx)(Na.a,{})]})]})})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:e.dialogTitle}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsxs)(Ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(g.jsx)(Ft.a,{item:!0,xs:5,children:P(y,d)}),Object(g.jsx)(Ft.a,{item:!0,children:Object(g.jsxs)(Ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(d)),j([])},disabled:0===d.length,"aria-label":"move all right",children:"\u226b"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(S)),j(I(d,S)),r(I(i,S))},disabled:0===S.length,"aria-label":"move selected right",children:">"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(D)),f(I(h,D)),r(I(i,D))},disabled:0===D.length,"aria-label":"move selected left",children:"<"}),Object(g.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(h)),f([])},disabled:0===h.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(g.jsx)(Ft.a,{item:!0,xs:5,children:P(w,h)})]})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit({left:d,right:h}),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}function _j(e){return Object(g.jsx)(be,{fullWidth:null!==e.fullWidth&&e.fullWidth,maxWidth:null===e.maxWidth?"sm":e.maxWidth,open:e.open,onClose:function(){e.onClose()},innerDialog:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{multiline:!0,value:e.value,onChange:function(){}})}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})})}var vj,kj,wj=Object(Pe.a)(bj||(bj=Object(q.a)(["\nmutation hideCallback ($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, active: false}) {\n    status\n    error\n  }\n}\n"]))),Cj=Object(Pe.a)(jj||(jj=Object(q.a)(["\nmutation hideCallback ($callback_id: Int!, $active: Boolean!){\n  updateCallback(input: {callback_id: $callback_id, active: $active}) {\n    status\n    error\n  }\n}\n"]))),Sj=Object(Pe.a)(pj||(pj=Object(q.a)(["\nmutation removeEdgeMutation ($edge_id: Int!, $end_timestamp: timestamp!){\n    update_callbackgraphedge_by_pk(pk_columns: {id: $edge_id}, _set: {end_timestamp: $end_timestamp}) {\n        end_timestamp\n        id\n      }\n}\n"]))),Dj=Object(Pe.a)(mj||(mj=Object(q.a)(["\nmutation addEdgeMutation ($source_id: Int!, $destination_id: Int!, $profile_id: Int!){\n  insert_callbackgraphedge_one(object: {c2_profile_id: $profile_id, destination_id: $destination_id, direction: 1, source_id: $source_id}) {\n    id\n  }\n}\n"]))),Ij=Object(Pe.a)(hj||(hj=Object(q.a)(["\nmutation unlockCallback($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: false}) {\n    status\n    error\n  }\n}\n"]))),Tj=Object(Pe.a)(fj||(fj=Object(q.a)(["\nmutation lockCallack($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: true}) {\n    status\n    error\n  }\n}\n"]))),$j=Object(Pe.a)(Oj||(Oj=Object(q.a)(["\nmutation updateDescriptionCallack($callback_id: Int!, $description: String!){\n  updateCallback(input: {callback_id: $callback_id, description: $description}) {\n    status\n    error\n  }\n}\n"]))),Pj=Object(Pe.a)(gj||(gj=Object(q.a)(["\nmutation updateSleepInfoCallback($callback_id: Int!, $sleep_info: String!){\n  update_callback_by_pk(pk_columns: {id: $callback_id}, _set: {sleep_info: $sleep_info}){\n    id\n    sleep_info\n  }\n}\n"]))),Aj=a(461),Ej=a.n(Aj),Lj=a(331),Fj=a.n(Lj),qj=a(460),Nj=a.n(qj),Rj=a(219),Bj=Object(Pe.a)(vj||(vj=Object(q.a)(["\nquery GetCallbackDetails($callback_id: Int!) {\n  callback_by_pk(id: $callback_id){\n    payload {\n      uuid\n      payloadtype{\n          ptype\n          id\n          commands(where: {script_only: {_eq: true}, deleted: {_eq: false}}){\n            id\n            cmd\n            version\n          }\n      }\n      filemetum {\n        filename_text\n        agent_file_id\n        id\n        md5\n        sha1\n      }\n      buildparameterinstances {\n        parameter\n        id\n        buildparameter {\n          description\n        }\n      }\n      os\n    }\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n    loadedcommands{\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    last_checkin\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n  }\n  \n}\n"])));function zj(e){var t=Object(xe.a)(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(Ae.a)(Bj,{variables:{callback_id:e.callback_id},onCompleted:function(e){var t=e.callback_by_pk.loadedcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})),a=e.callback_by_pk.payload.payloadtype.commands.reduce((function(e,t){return[].concat(Object(F.a)(e),[{cmd:t.cmd,mythic:t.version,payload:t.version}])}),Object(F.a)(t)).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));r(a);var n=e.callback_by_pk.payload.buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));d(n);var i=e.callback_by_pk.c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[].concat(Object(F.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),c=Object.keys(i).reduce((function(e,t){return[].concat(Object(F.a)(e),[{c2_profile:t,parameters:i[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);h(c)}}),O=f.loading,x=f.error,y=f.data;return O?Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}}):x?(console.error(x),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Callback Configuration"}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Callback Information"})}),Object(g.jsx)(ho,Object(k.a)({},y.callback_by_pk)),Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Payload Information"})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Payload Info"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsxs)(R.a,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Payload Type"}),Object(g.jsx)(B.a,{children:y.callback_by_pk.payload.payloadtype.ptype})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Selected OS"}),Object(g.jsx)(B.a,{children:y.callback_by_pk.payload.os})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"UUID"}),Object(g.jsx)(B.a,{children:y.callback_by_pk.payload.uuid})]}),y.callback_by_pk.payload.filemetum?Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Filename"}),Object(g.jsx)(B.a,{children:y.callback_by_pk.payload.filemetum.filename_text})]},"filename_text"):null,Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Download URL"}),Object(g.jsx)(B.a,{children:window.location.origin+"/direct/download/"+y.callback_by_pk.payload.filemetum.agent_file_id})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"SHA1"}),Object(g.jsx)(B.a,{children:y.callback_by_pk.payload.filemetum.sha1})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"MD5"}),Object(g.jsx)(B.a,{children:y.callback_by_pk.payload.filemetum.md5})]})]})]}),Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Build Parameters"})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{children:l.map((function(e,t){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.description}),Object(g.jsx)(B.a,{children:e.value})]},"buildprop"+t+"for"+y.callback_by_pk.payload.id)}))})]}),m.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:e.c2_profile})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"30%"},children:"Parameter"}),Object(g.jsx)(B.a,{children:"Value"})]})}),Object(g.jsx)(R.a,{style:{whiteSpace:"pre"},children:e.parameters.map((function(t,a){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:t.description}),Object(g.jsx)(B.a,{children:"Dictionary"===t.parameter_type||"Array"===t.parameter_type?JSON.stringify(JSON.parse(t.value),null,2):t.value})]},"c2frag"+y.callback_by_pk.payload.id+e.c2_profile+a)}))})]})]},"c2frag"+y.callback_by_pk.payload.id+e.c2_profile)})),Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Loaded Commands"})}),Object(g.jsxs)(N.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Command Name"}),Object(g.jsx)(B.a,{children:"Mythic Version"}),Object(g.jsx)(B.a,{children:"Loaded Version"}),Object(g.jsx)(B.a,{children:"Documentation"})]})}),Object(g.jsx)(R.a,{children:i.map((function(e){return Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:e.cmd}),Object(g.jsx)(B.a,{children:e.mythic}),Object(g.jsx)(B.a,{children:e.payload}),Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+y.callback_by_pk.payload.payloadtype.ptype+"/commands/"+e.cmd,children:"Docs"})})]},e.cmd+y.callback_by_pk.payload.id)}))})]})]}),Object(g.jsx)(re.a,{children:Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Wj=Object(Pe.a)(kj||(kj=Object(q.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    id\n    last_checkin\n  }\n}\n "])));function Mj(e){var t=s.a.useRef(null),a=Object(xe.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState(!1),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState(a.palette.success.main),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState(!0),y=Object(u.a)(x,2),_=y[0],v=y[1],w=s.a.useState(!1),C=Object(u.a)(w,2),S=C[0],D=C[1],I=s.a.useState(!1),T=Object(u.a)(I,2),$=T[0],P=T[1],A=s.a.useState(!1),L=Object(u.a)(A,2),q=L[0],N=L[1],R=s.a.useState(!1),z=Object(u.a)(R,2),W=z[0],M=z[1],U=s.a.useState([]),V=Object(u.a)(U,2),G=V[0],K=V[1],Q=s.a.useState([]),J=Object(u.a)(Q,2),Y=J[0],Z=J[1],X=s.a.useState([]),ee=Object(u.a)(X,2),te=ee[0],ae=ee[1],ne=s.a.useState(!0),ie=Object(u.a)(ne,2),re=ie[0],ce=ie[1];Object(o.useEffect)((function(){void 0===e.shownColumns?ae([]):ae(e.shownColumns)}),[e.shownColumns]);var oe=function(t){_||E.warning("Agent has no egress route! Re-link before tasking"),"interact"===t?e.onOpenTab({tabType:t,tabID:e.id+t,callbackID:e.id}):"processBrowser"===t?e.onOpenTab({tabType:t,tabID:e.host,callbackID:e.id}):e.onOpenTab({tabType:t,tabID:e.id+t,callbackID:e.id})};Object(o.useEffect)((function(){var t=Y.filter((function(t){return!t.c2profile.is_p2p&&t.source.id===e.id&&t.destination.id===e.id})).length;t>0&&!re?ce(!0):0===t&&re&&ce(!1)}),[Y]),Object(o.useEffect)((function(){var t=function(t){for(var a=e.callbackgraphedges.filter((function(a){return(a.source.id===e.id||a.destination.id===e.id)&&(!t||null===a.end_timestamp)})),n=!0;n;){var i=e.callbackgraphedges.reduce((function(e,a){return e.includes(a)?Object(F.a)(e):e.filter((function(e){return(e.source.id===a.source.id||e.source.id===a.destination.id||e.destination.id===a.source.id)&&(!t||null===a.end_timestamp)})).length>0?[].concat(Object(F.a)(e),[a]):Object(F.a)(e)}),Object(F.a)(a));n=i.length>a,a=Object(F.a)(i)}return a},a=t(!0),n=t(!1);G.length!==a.length&&K(a),Y.length!==n.length&&Z(n)}),[e.callbackgraphedges,e.id]),Object(o.useEffect)((function(){0===G.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(O(a.palette.error.main),v(!1)):(O(a.palette.success.main),v(!0))}),[G,a.palette.success.main,a.palette.error.main]);var se=function(e){t.current&&t.current.contains(e.target)||D(!1)},le=Object(Ee.a)(wj,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?E.success("Hiding callback"):E.warning(a.updateCallback.error)},onError:function(e){console.log(e)}}),de=Object(u.a)(le,1)[0],ue=s.a.useCallback((function(){M(!0)}),[]),pe=Object(o.useCallback)((function(){switch(e.payload.os.toLowerCase()){case"windows":return Object(g.jsx)(ca.a,{icon:Rj.d,size:"2x",style:{cursor:"pointer"},onClick:ue});case"linux":return Object(g.jsx)(ca.a,{icon:Rj.c,size:"2x",style:{cursor:"pointer"},onClick:ue});case"macos":return Object(g.jsx)(ca.a,{icon:Rj.a,size:"2x",style:{cursor:"pointer"},onClick:ue});case"chrome":return Object(g.jsx)(ca.a,{icon:Rj.b,size:"2x",style:{cursor:"pointer"},onClick:ue});default:return Object(g.jsx)(ca.a,{icon:oa.y,size:"2x",style:{cursor:"pointer"},onClick:ue})}}),[]),me=[{name:"Hide Callback",icon:Object(g.jsx)(nb.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),de({variables:{callback_id:e.id}})}},{name:"File Browser",icon:Object(g.jsx)(Fj.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),oe("fileBrowser")}},{name:"Process Browser",icon:Object(g.jsx)(Fj.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),oe("processBrowser")}},{name:e.locked?"Unlock (Locked by "+e.locked_operator.username+")":"Lock Callback",icon:e.locked?Object(g.jsx)(ro.a,{style:{paddingRight:"5px"}}):Object(g.jsx)(to.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),e.toggleLock({id:e.id,locked:e.locked})}},{name:"Edit Description",icon:Object(g.jsx)(Bi.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),c(!0)}},{name:"Expand Callback",icon:Object(g.jsx)(Nj.a,{style:{paddingRight:"5px"}}),click:function(t){t.stopPropagation(),window.open("/new/callbacks/"+e.id,"_blank").focus()}},{name:"View Metadata",icon:Object(g.jsx)(Ln.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),p(!0)}}];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(uj,{id:e.id,handleClick:e.handleClick,isItemSelected:e.isItemSelected(e.id),children:[Object(g.jsxs)(B.a,{children:[Object(g.jsxs)(pt.a,{variant:"contained",color:e.integrity_level>2?"secondary":"primary",ref:t,"aria-label":"split button",children:[Object(g.jsxs)(b.a,{size:"small",onClick:function(e){e.stopPropagation(),oe("interact")},children:[e.locked?Object(g.jsx)(to.a,{}):Object(g.jsx)(Fl.a,{})," ",e.id]}),Object(g.jsx)(b.a,{style:{padding:0},size:"small","aria-controls":S?"split-button-menu":void 0,"aria-expanded":S?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),D((function(e){return!e}))},children:Object(g.jsx)(ht.a,{})})]}),Object(g.jsx)(gt.a,{open:S,anchorEl:t.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:200},children:function(e){var t=e.TransitionProps,n=e.placement;return Object(g.jsx)(Ot.a,Object(k.a)(Object(k.a)({},t),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(g.jsx)(H.a,{style:{backgroundColor:"dark"===a.palette.type?a.palette.primary.dark:a.palette.primary.light,color:"white"},children:Object(g.jsx)(ft.a,{onClickAway:se,children:Object(g.jsx)(yt.a,{id:"split-button-menu",children:me.map((function(e,t){return Object(g.jsxs)(xt.a,{onClick:function(e){return function(e,t){me[t].click(e),D(!1)}(e,t)},children:[e.icon,e.name]},e.name)}))})})})}))}})]}),te.includes("ip")?Object(g.jsx)(B.a,{children:e.ip}):null,te.includes("host")?Object(g.jsx)(B.a,{children:e.host}):null,te.includes("user")?Object(g.jsx)(B.a,{children:e.user}):null,te.includes("domain")?Object(g.jsx)(B.a,{children:e.domain}):null,te.includes("os")?Object(g.jsxs)(B.a,{children:[pe(),Object(g.jsx)(_j,{onClose:function(){M(!1)},title:"Operating System Information",maxWidth:"md",fullWidth:!0,value:e.os,open:W})]}):null,te.includes("arch")?Object(g.jsx)(B.a,{children:e.architecture}):null,te.includes("pid")?Object(g.jsx)(B.a,{children:e.pid}):null,te.includes("last_checkin")?Object(g.jsx)(B.a,{children:Object(g.jsx)(Vj,{callback_id:e.id})}):null,te.includes("description")?Object(g.jsx)(B.a,{children:e.description}):null,te.includes("sleep")?Object(g.jsx)(B.a,{children:Object(g.jsx)(Ej.a,{onClick:function(e){e.stopPropagation(),N(!0)},style:{color:""===e.sleep_info?a.palette.warning.main:a.palette.info.main,cursor:"pointer"}})}):null,te.includes("type")?Object(g.jsx)(B.a,{children:e.payload.payloadtype.ptype}):null,te.includes("c2")?Object(g.jsx)(B.a,{children:re?Object(g.jsx)(jt.a,{onClick:function(e){e.stopPropagation(),P(!0)},style:{color:f,cursor:"pointer"}}):Object(g.jsx)(no.a,{onClick:function(e){e.stopPropagation(),P(!0)},style:{color:f,cursor:"pointer"}})}):null,te.includes("process_name")?Object(g.jsx)(B.a,{children:e.process_name}):null,te.includes("external_ip")?Object(g.jsx)(B.a,{children:e.external_ip}):null]}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:$,onClose:function(){P(!1)},innerDialog:Object(g.jsx)(uo,Object(k.a)(Object(k.a)({onClose:function(){P(!1)}},e),{},{callbackgraphedges:_?G:Y}))}),j&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:j,onClose:function(){p(!1)},innerDialog:Object(g.jsx)(zj,{onClose:function(){p(!1)},callback_id:e.id})}),Object(g.jsx)(be,{fullWidth:!0,open:r,onClose:function(){c(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Callback's Description",onClose:function(){c(!1)},value:e.description,onSubmit:function(t){e.updateDescription({description:t,id:e.id})}})}),Object(g.jsx)(be,{fullWidth:!0,open:q,onClose:function(){N(!1)},innerDialog:Object(g.jsx)(je,{title:"Sleep Information",onClose:function(){N(!1)},value:e.sleep_info,onSubmit:function(t){e.updateSleepInfo({sleep_info:t,id:e.id})}})})]})}var Hj=s.a.memo(Mj);function Uj(e){var t=e.callback_id,a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1];Object(ct.a)(Wj,{variables:{callback_id:t},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;d(t.data.callback_by_pk.last_checkin)}});return Oe((function(){r(fe(l))})),i}var Vj=s.a.memo(Uj),Gj=a(869),Kj=a(462),Qj=a.n(Kj),Jj=Object(Ge.a)((function(e){return{root:{minHeight:"unset",marginTop:"10px"},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Co.e)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{}}})),Yj=function(e){var t=Jj(),a=Object(xe.a)(),n=e.numSelected;return Object(g.jsx)(s.a.Fragment,{children:n>1?Object(g.jsx)(Gj.a,{className:Object(an.default)(t.root,Object(Pt.a)({},t.highlight,n>1)),children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Q.a,{className:t.title,color:"inherit",variant:"subtitle1",component:"div",children:[n," selected"]}),Object(g.jsx)(gc.a,{title:"Hide Selected",children:Object(g.jsx)(K.a,{"aria-label":"hide",onClick:e.onHideSelected,children:Object(g.jsx)(Qj.a,{})})}),Object(g.jsx)(gc.a,{title:"Task Selected",children:Object(g.jsx)(K.a,{"aria-label":"hide",onClick:e.onTaskSelected,children:Object(g.jsx)(ca.a,{icon:oa.A,title:"Task All"})})})]})}):Object(g.jsxs)(H.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",width:"100%"},variant:"elevation",children:[Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Active Callbacks"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"70px"},onClick:function(t){t.stopPropagation(),e.openDialog()},children:"Show/Hide Columns"})]})})},Zj=Object(Ge.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Xj(e){var t=Zj(),a=s.a.useState("asc"),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("interact"),l=Object(u.a)(c,2),d=l[0],b=l[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),O=Object(u.a)(f,2),x=O[0],y=O[1],_=s.a.useState([]),v=Object(u.a)(_,2),w=v[0],C=v[1],S=s.a.useState(["user","host","domain","description","last_checkin","type","c2","ip","os"]),D=Object(u.a)(S,2),I=D[0],T=D[1],$=function(e,t){var a=m.indexOf(t),n=[];-1===a?n=n.concat(m,t):0===a?n=n.concat(m.slice(1)):a===m.length-1?n=n.concat(m.slice(0,-1)):a>0&&(n=n.concat(m.slice(0,a),m.slice(a+1))),h(n)},P=function(e){return-1!==m.indexOf(e)},A=Object(Ee.a)(wj,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?E.success("Hiding callback"):E.warning(a.updateCallback.error)},onError:function(e){E.warning(e),console.log(e)}}),L=Object(u.a)(A,1)[0],q=Object(Ee.a)(Tj,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?E.success("Locked callback"):E.warning(a.updateCallback.error)},onError:function(e){console.log(e),E.warning(e)}}),B=Object(u.a)(q,1)[0],W=Object(Ee.a)(Ij,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?E.success("Unlocked callback"):E.warning(a.updateCallback.error)},onError:function(e){console.log(e),E.warning(e)}}),M=Object(u.a)(W,1)[0],U=Object(Ee.a)($j,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?E.success("Updated Callback"):E.warning(a.updateCallback.error)},onError:function(e){console.log(e),E.warning(e)}}),V=Object(u.a)(U,1)[0],G=Object(Ee.a)(Pj,{update:function(e,t){t.data;E.success("Updated Callback")},onError:function(e){console.log(e),E.warning(e)}}),K=Object(u.a)(G,1)[0],Q=Object(o.useMemo)((function(){return[{id:"id",numeric:!0,disablePadding:!1,label:"Interact"},{id:"ip",numeric:!1,disablePadding:!1,label:"IP"},{id:"host",numeric:!1,disablePadding:!1,label:"Host"},{id:"user",numeric:!1,disablePadding:!1,label:"User"},{id:"domain",numeric:!1,disablePadding:!1,label:"Domain"},{id:"os",numeric:!1,disablePadding:!1,label:"OS"},{id:"arch",numberic:!1,disablePadding:!1,label:"Arch"},{id:"pid",numeric:!0,disablePadding:!1,label:"PID"},{id:"last_checkin",numeric:!0,disablePadding:!1,label:"Last Checkin"},{id:"description",numeric:!1,disablePadding:!1,label:"Description"},{id:"sleep",numeric:!1,disablePadding:!0,label:"Sleep"},{id:"type",numeric:!1,disablePadding:!1,label:"Type"},{id:"c2",numeric:!1,disablePadding:!0,label:"C2"},{id:"process_name",numeric:!1,disablePadding:!0,label:"Process Name"},{id:"external_ip",numberic:!1,disablePadding:!0,label:"External IP"}]}),[]);Object(o.useEffect)((function(){var e=Q.map((function(e){return e.id})).filter((function(e){return"id"!==e}));C(e);var t=localStorage.getItem("callbacks_table_columns");null!==t&&T(JSON.parse(t))}),[Q]);var J=s.a.useCallback((function(e){var t=e.id;e.locked?M({variables:{callback_id:t}}):B({variables:{callback_id:t}})}),[]),Y=s.a.useCallback((function(e){var t=e.id,a=e.description;V({variables:{callback_id:t,description:a}})}),[]),Z=s.a.useCallback((function(e){var t=e.id,a=e.sleep_info;K({variables:{callback_id:t,sleep_info:a}})}),[]);return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Yj,{numSelected:m.length,onHideSelected:function(){for(var t=Object(F.a)(m),a=function(a){t.includes(e.callbacks[a].id)&&(L({variables:{callback_id:e.callbacks[a].id}}),t=t.filter((function(t){return t!==e.callbacks[a].id})))},n=0;n<e.callbacks.length;n++)a(n);h(t)},onTaskSelected:function(){E.warning("Not Implemented Yet")},openDialog:function(){return y(!0)}}),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{maxWidth:"100%",marginRight:"5px",overflow:"auto"},children:Object(g.jsxs)(N.a,{size:"small",children:[Object(g.jsx)(dj,{shownColumns:I,numSelected:m.length,rowCount:e.callbacks.length,classes:t,headCells:Q,onSelectAllClick:function(t){if(t.target.checked)if(m.length>0)h([]);else{var a=e.callbacks.map((function(e){return e.id}));h(a)}else h([])},onRequestSort:function(e,t){r(d===t&&"asc"===i?"desc":"asc"),b(t)},orderBy:d,order:i}),Object(g.jsx)(R.a,{children:lj(e.callbacks,sj(i,d)).map((function(t,a){return Object(g.jsx)(Hj,Object(k.a)(Object(k.a)({shownColumns:I,handleClick:$,isItemSelected:P,onOpenTab:e.onOpenTab},t),{},{callbackgraphedges:e.callbackgraphedges,toggleLock:J,updateDescription:Y,updateSleepInfo:Z}),"callback"+t.id)}))})]})}),x&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"lg",open:x,onClose:function(){y(!1)},innerDialog:Object(g.jsx)(yj,{onClose:function(){y(!1)},onSubmit:function(e){e.left;var t=e.right;T(t),localStorage.setItem("callbacks_table_columns",JSON.stringify(t))},right:I,rightTitle:"Show these columns",leftTitle:"Hidden Columns",left:w,dialogTitle:"Edit which columns are shown"})})]})}var ep,tp,ap=a(463),np=Object(Pe.a)(ep||(ep=Object(q.a)(["\nquery getP2PProfilesAndCallbacks($operation_id: Int!){\n  c2profile(where: {is_p2p: {_eq: true}}) {\n    callbackc2profiles(where: {callback: {operation_id: {_eq: $operation_id}}}) {\n      id\n      callback {\n        id\n        description\n      }\n    }\n    name\n    id\n  }\n}\n"]))),ip=Object(Ge.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120,width:"97%"},selectEmpty:{marginTop:e.spacing(2)}}}));function rp(e){var t=ip(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(""),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState(""),x=Object(u.a)(O,2),y=x[0],_=x[1],v=Object(o.useRef)(null),k=Object(T.a)(C),w=Object(Ae.a)(np,{variables:{operation_id:k.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.filter((function(t){var a=!1;return e.source.callbackc2profiles.forEach((function(e){e.c2profile.name===t.name&&(a=!0)})),a}));if(j(a),a.length>0){_(a[0]);var n=a[0].callbackc2profiles.filter((function(t){return t.callback.id!==e.source.id}));r(n),n.length>0&&f(n[0])}},fetchPolicy:"network-only"}),S=w.loading,D=w.error;return S?Object(g.jsx)(Ze.a,{style:{marginTop:"10px"}}):D?(console.error(D),Object(g.jsx)("div",{children:"Error!"})):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(se.a,{children:["Manually Add Edge From Callback ",e.source.id]}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsxs)(s.a.Fragment,{children:["Manually add an edge from Callback ",e.source.id," to another callback via a P2P C2 Profile they both share.",Object(g.jsx)("br",{}),Object(g.jsxs)(Et.a,{className:t.formControl,children:[Object(g.jsx)(Jt.a,{id:"demo-dialog-select-label-profile",children:"Profile"}),Object(g.jsxs)(Lt.a,{labelId:"demo-dialog-select-label-profile",id:"demo-dialog-select",value:y,onChange:function(e){_(e.target.value)},style:{minWidth:"30%"},children:[Object(g.jsx)(xt.a,{value:"",children:Object(g.jsx)("em",{children:"None"})}),d.map((function(e){return Object(g.jsx)(xt.a,{value:e,children:e.name},"profile:"+e.id)}))]})]}),Object(g.jsx)("br",{}),Object(g.jsxs)(Et.a,{className:t.formControl,children:[Object(g.jsx)(Jt.a,{ref:v,children:"Destination"}),Object(g.jsxs)(Lt.a,{labelId:"demo-dialog-select-label-destination",id:"demo-dialog-select-destination",value:h,onChange:function(e){f(e.target.value)},input:Object(g.jsx)(qt.a,{}),children:[Object(g.jsx)(xt.a,{value:"",children:Object(g.jsx)("em",{children:"None"})}),i.map((function(e){return Object(g.jsxs)(xt.a,{value:e,children:[e.callback.id," (",e.callback.description,")"]},"callback:"+e.callback.id)}))]})]})]})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.onSubmit(e.source.id,y,h.callback),e.onClose()},variant:"contained",style:{backgroundColor:Gr.palette.success.main},children:"Add"})]})]})}var cp,op,sp=Object(Pe.a)(tp||(tp=Object(q.a)(['\nquery loadedLinkCommandsQuery ($callback_id: Int!){\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_ilike: "graph_view:link"}, deleted: {_eq: false}}}) {\n    command {\n        id\n        cmd\n        help_cmd\n        description\n        needs_admin\n    }\n  }\n}\n'])));function lp(e){var t=e.onOpenTab,a=e.callbackgraphedges,n=Object(xe.a)(),i=Object(o.useRef)(null),r=s.a.useRef(null),c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=Object(o.useState)(!0),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState([]),x=Object(u.a)(O,2),y=x[0],_=x[1],v=s.a.useState(!1),w=Object(u.a)(v,2),C=w[0],S=w[1],D=s.a.useState(!1),I=Object(u.a)(D,2),T=I[0],$=I[1],P=Object(o.useState)(),A=Object(u.a)(P,2),L=A[0],q=A[1],N=Object(o.useState)(),R=Object(u.a)(N,2),B=R[0],z=R[1],W=Object(o.useState)(!1),M=Object(u.a)(W,2),U=M[0],V=M[1],G=Object(o.useState)(!1),K=Object(u.a)(G,2),Q=K[0],J=K[1],Y=Object(o.useState)([]),Z=Object(u.a)(Y,2),X=Z[0],ee=Z[1],te=Object(o.useState)(null),ae=Object(u.a)(te,2),ne=ae[0],ie=ae[1],re=Object(At.a)(sp,{fetchPolicy:"network-only",onCompleted:function(e){if(1===e.loadedcommands.length)q(e.loadedcommands[0].command),S(!0);else if(0===e.loadedcommands.length)E.warning("No commands loaded that are 'link' commands");else{var t=e.loadedcommands.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{display:e.command.cmd})}));_(t),q(t[0].command),$(!0)}}}),ce=Object(u.a)(re,1)[0],oe=Object(Ee.a)(Ud,{update:function(e,t){var a=t.data;"error"===a.createTask.status?E.error(a.createTask.error):E.success("task created")}}),se=Object(u.a)(oe,1)[0],le=s.a.useState({rankDir:"LR",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!1}),de=Object(u.a)(le,2),ue=de[0],je=de[1],pe=Object(Ee.a)(wj,{update:function(e,t){t.data}}),me=Object(u.a)(pe,1)[0],he=Object(Ee.a)(Sj,{update:function(e,t){t.data}}),fe=Object(u.a)(he,1)[0],Oe=Object(Ee.a)(Dj,{update:function(e,t){t.data}}),ge=Object(u.a)(Oe,1)[0],ye=Object(o.useMemo)((function(){return{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[{title:"Hide Callback",action:function(e,t){me({variables:{callback_id:t.node.id}})}},{title:"Interact",action:function(e,a){t({tabType:"interact",tabID:a.node.id+"interact",callbackID:a.node.id})}},{title:"Manually Remove Edge",action:function(e,t){var a=function(e,t){return e.nodeEdges(t)}(e,t.node.id).reduce((function(t,a){var n=e.edge(a.v,a.w,a.name);return null===n.end_timestamp?1===n.direction?ue.packet_flow_view?[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},n),{},{display:a.v+" --\x3e "+a.name+" --\x3e "+a.w})]):[].concat(Object(F.a)(t),[Object(k.a)(Object(k.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):Object(F.a)(t)}),[]);ee(a),V(!0)}},{title:"Manually Add Edge",action:function(e,t){ie(t.node),J(!0)}},{title:"Task Callback for Edge",action:function(e,t){_([]),q(null),z(null),ce({variables:{callback_id:t.node.id}}),z(t.node)}}]}}),[ce,me,ue,t]),_e=[{name:ue.include_disconnected?"Show Only Active Edges":"Show All Edges",click:function(){var e=Object(k.a)(Object(k.a)({},ue),{},{include_disconnected:!ue.include_disconnected});jo(Object(F.a)(a),i,!0,e,ye,n),je(e)}},{name:ue.show_all_nodes?"Hide inactive callbacks":"Show All Callbacks",click:function(){var e=Object(k.a)(Object(k.a)({},ue),{},{show_all_nodes:!ue.show_all_nodes});jo(Object(F.a)(a),i,!0,e,ye,n),je(e)}},{name:"Autosize",click:function(){jo(Object(F.a)(a),i,!0,ue,ye,n)}},{name:"LR"===ue.rankDir?"Change Layout to Top-Bottom":"Change Layout to Left-Right",click:function(){if("LR"===ue.rankDir){var e=Object(k.a)(Object(k.a)({},ue),{},{rankDir:"BT"});jo(Object(F.a)(a),i,!0,e,ye,n),je(e)}else{var t=Object(k.a)(Object(k.a)({},ue),{},{rankDir:"LR"});jo(Object(F.a)(a),i,!0,t,ye,n),je(t)}}},{name:ue.packet_flow_view?"View Connection Directions":"View Egress Routes",click:function(){var e=Object(k.a)(Object(k.a)({},ue),{},{packet_flow_view:!ue.packet_flow_view});jo(Object(F.a)(a),i,!0,e,ye,n),je(e)}},{name:"Download Graph",click:function(){Object(ap.saveSvgAsPng)(document.getElementById("callbacksgraph"),"diagram.png")}}],ve=function(e){r.current&&r.current.contains(e.target)||j(!1)};return Object(o.useEffect)((function(){var e=Object(F.a)(a);jo(e,i,h,ue,ye,n),f(!1)}),[a,h,ue,n]),Object(g.jsxs)("div",{style:{maxWidth:"100%",overflow:"auto",height:"100%"},children:[Object(g.jsx)(pt.a,{variant:"contained",ref:r,"aria-label":"split button",style:{marginTop:"10px"},color:"primary",children:Object(g.jsxs)(b.a,{size:"small",color:"primary","aria-controls":d?"split-button-menu":void 0,"aria-expanded":d?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),j((function(e){return!e}))},children:["Actions ",Object(g.jsx)(ht.a,{})]})}),function(){var e="";return e+=ue.include_disconnected?"Showing All Edges, ":"Showing Only Active Edges, ",e+=ue.show_all_nodes?"Showing All Callbacks, ":"Showing Active Callbacks, ",e+="Layout: "+ue.rankDir+", ",e+=ue.packet_flow_view?"Showing Egress Routes":"Showing Connections Paths"}(),Object(g.jsx)(gt.a,{open:d,anchorEl:r.current,role:void 0,transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,a=e.placement;return Object(g.jsx)(Ot.a,Object(k.a)(Object(k.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(g.jsx)(H.a,{style:{backgroundColor:"dark"===n.palette.type?n.palette.primary.dark:n.palette.primary.light,color:"white"},children:Object(g.jsx)(ft.a,{onClickAway:ve,children:Object(g.jsx)(yt.a,{id:"split-button-menu",children:_e.map((function(e,t){return Object(g.jsx)(xt.a,{onClick:function(e){return function(e,t){_e[t].click(),j(!1)}(0,t)},children:e.name},e.name)}))})})})}))}}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:U,onClose:function(){V(!1)},innerDialog:Object(g.jsx)(Qo,{onClose:function(){V(!1)},identifier:"edge_id",display:"display",onSubmit:function(e){""!==e?fe({variables:{edge_id:e.edge_id,end_timestamp:(new Date).toISOString()}}):E.warning("No edge selected")},options:X,title:"Manually Remove Edge",action:"remove"})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:Q,onClose:function(){J(!1)},innerDialog:Object(g.jsx)(rp,{onClose:function(){J(!1)},onSubmit:function(e,t,a){""!==t&&""!==a?ge({variables:{source_id:e,profile_id:t.id,destination_id:a.id}}):E.warning("Profile or Destination Callback not provided")},source:ne})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:C,onClose:function(){S(!1)},innerDialog:Object(g.jsx)(ws,{command:L,callback:B,onSubmit:function(e,t,a){S(!1),se({variables:{callback_id:B.id,command:e,params:t,files:a}})},onClose:function(){S(!1)}})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:T,onClose:function(){$(!1)},innerDialog:Object(g.jsx)(Qo,{onClose:function(){$(!1)},onSubmit:function(e){q(e.command),S(!0)},options:y,title:"Select Link Command",action:"select",display:"display",identifier:"display"})}),Object(g.jsx)("svg",{id:"callbacksgraph",ref:i,width:"100%",height:"90%"})]})}var dp=Object(Pe.a)(cp||(cp=Object(q.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n  }\n}\n "]))),up=Object(Pe.a)(op||(op=Object(q.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function bp(e){var t=e.onOpenTab,a=e.topDisplay,n=e.heights,i=Object(T.a)(C),r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState([]),b=Object(u.a)(d,2),j=b[0],p=b[1];Object(ct.a)(dp,{variables:{operation_id:i.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;l(t.data.callback)}}),Object(ct.a)(up,{variables:{operation_id:i.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;p(t.data.callbackgraphedge)}});var m=function(e){for(var a=e.tabType,n=e.tabID,i=e.callbackID,r=0;r<o.length;r++)if(o[r].id===i){var c={tabID:n,tabType:a,callbackID:i,payloadtype:o[r].payload.payloadtype.ptype,payloadtype_id:o[r].payload.payloadtype.id,operation_id:o[r].operation_id,payloadDescription:o[r].payload.tag,callbackDescription:o[r].description,host:o[r].host,os:o[r].payload.os};t(c)}};return Object(g.jsx)("div",{style:{height:"100%",maxHeight:"100%",overflow:"auto"},children:"graph"===a?Object(g.jsx)(lp,{maxHeight:"100%",topHeight:n.top,onOpenTab:m,callbacks:o,callbackgraphedges:j},"callbacksgraph"):Object(g.jsx)(Xj,{onOpenTab:m,callbacks:o,callbackgraphedges:j},"callbackstable")})}var jp=Object(Ge.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{bottom:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{top:e.spacing(2),right:e.spacing(2)}},tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function pp(){var e=s.a.useState("table"),t=Object(u.a)(e,2),a=t[0],n=t[1],i=s.a.useState([]),r=Object(u.a)(i,2),c=r[0],l=r[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState({top:"30%",bottom:"69%"}),h=Object(u.a)(m,2),f=h[0],O=h[1];Object(o.useEffect)((function(){var e=localStorage.getItem("openTabs");if(void 0!==e&&null!==e)try{var t=JSON.parse(e);l(t);var a=localStorage.getItem("clickedTab");void 0!==a&&null!==a&&p(a)}catch(r){console.log("failed to parse oldTabs",r)}var n=localStorage.getItem("heights");if(void 0!==n&&null!==n)try{var i=JSON.parse(n);O(i)}catch(r){console.log("failed to parse oldHeights",r)}}),[]);var x=s.a.useCallback((function(){p("")}),[]),y=s.a.useCallback((function(e){O(e),localStorage.setItem("heights",JSON.stringify(e))}),[]);return Object(g.jsx)("div",{style:{maxWidth:"100%",height:"100%",maxHeight:"100%",display:"flex",flexDirection:"column"},children:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(gp,{setTopDisplay:n,heights:f,onSubmitHeights:y}),Object(g.jsx)("div",{style:{maxHeight:f.top,height:f.top},children:Object(g.jsx)(bp,{topDisplay:a,onOpenTab:function(e){var t=!1;if(c.forEach((function(a){a.tabID===e.tabID&&(t=!0)})),!t){var a=[].concat(Object(F.a)(c),[Object(k.a)({},e)]);localStorage.setItem("openTabs",JSON.stringify(a)),l(a)}localStorage.setItem("clickedTab",e.tabID),p(e.tabID)},heights:f})}),Object(g.jsx)("div",{style:{maxHeight:f.bottom,height:f.bottom},children:Object(g.jsx)(ej,{onCloseTab:function(e){var t=e.tabID,a=(e.index,c.filter((function(e){return e.tabID!==t})));localStorage.setItem("openTabs",JSON.stringify(a)),l(a)},onEditTabDescription:function(e,t){var a=c.map((function(a){return a.tabID===e.tabID?Object(k.a)(Object(k.a)({},a),{},{customDescription:t}):Object(k.a)({},a)}));l(a),localStorage.setItem("openTabs",JSON.stringify(a))},clearSelectedTab:x,tabHeight:f.bottom,maxHeight:f.bottom,clickedTabId:j,openTabs:c},"callbackstabs")})]})})}function mp(e){var t=e.setTopDisplay,a=e.onSubmitHeights,n=e.heights,i=s.a.useState(!1),r=Object(u.a)(i,2),c=r[0],o=r[1],l=jp(),d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useMemo((function(){return[{icon:Object(g.jsx)(ij.a,{}),name:"Table layout",onClick:function(){t("table")}},{icon:Object(g.jsx)(Xi.a,{}),name:"Graph layout",onClick:function(){t("graph")}},{icon:Object(g.jsx)(aj.a,{}),name:"Adjust Top/Bottom Size",onClick:function(){p(!0),o(!1)}}]}),[]);return Object(g.jsxs)(s.a.Fragment,{children:[j&&Object(g.jsx)(be,{fullWidth:!0,maxWidth:"sm",open:j,onClose:function(){p(!1),o(!1)},innerDialog:Object(g.jsx)(rj,{onClose:function(){p(!1),o(!1)},heights:n,onSubmit:function(e){o(!1),a(e)}})}),Object(g.jsx)(Jl.a,{ariaLabel:"SpeedDial example",className:l.speedDial,icon:Object(g.jsx)(Yl.a,{}),onClose:function(){o(!1)},onOpen:function(){o(!0)},FabProps:{color:"secondary"},open:c,style:{marginTop:"35px"},direction:"down",children:m.map((function(e){return Object(g.jsx)(Zl.a,{arrow:!0,TooltipClasses:{tooltip:l.tooltip,arrow:l.arrow},icon:e.icon,tooltipTitle:e.name,onClick:e.onClick},e.name)}))})]})}var hp,fp,Op,gp=s.a.memo(mp),xp=a(466),yp=a.n(xp),_p=a(788),vp=20,kp=Object(Pe.a)(hp||(hp=Object(q.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_text: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_text: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),Hd),wp=Object(Pe.a)(fp||(fp=Object(q.a)(["\n","\nquery parametersQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),Hd),Cp=Object(Pe.a)(Op||(Op=Object(q.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),Hd);function Sp(e){return Object(g.jsx)(wo,Object(k.a)({label:"Tasks",iconComponent:Object(g.jsx)(yp.a,{})},e))}var Dp,Ip,Tp,$p=function(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Output"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Output","Parameters","Comment"],j=s.a.useState(""),p=Object(u.a)(j,2),m=p[0],h=p[1],f=function(t,a,n,r){var c=a||i,o=r||m;switch(n||l){case"Output":e.onOutputSearch({search:c,offset:0,taskStatus:o});break;case"Parameters":e.onParameterSearch({search:c,offset:0,taskStatus:o});break;case"Comment":e.onCommentSearch({search:c,offset:0,taskStatus:o})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Output",i="";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Output"),e.onChangeSearchField("Output"),e.changeSearchParam("searchField","Output")),t.has("taskStatus")&&(h(t.get("taskStatus")),e.onChangeTaskStatus(t.get("taskStatus")),i=t.get("taskStatus")),f(0,a,n,i)}}),[e.value,e.index]),Object(g.jsxs)(Ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsx)(y,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:f,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:f,children:Object(g.jsx)(Qs.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(Ft.a,{item:!0,xs:2,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search Task's"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(g.jsx)(Ft.a,{item:!0,xs:2,children:Object(g.jsx)(y,{placeholder:"Filter Task Status...",value:m,onChange:function(t,a,n){h(a),e.changeSearchParam("taskStatus",a)},onEnter:f,name:"Filter Task Status..."})})]})},Pp=function(e){var t=s.a.useState({task:[]}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Output"),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState(""),y=Object(u.a)(x,2),_=y[0],v=y[1],w=Object(T.a)(C),S=function(e){E.dismiss(),l(e.task_aggregate.aggregate.count),i({task:e.task})},D=function(e){E.dismiss(),E.error("Failed to fetch data for search"),console.log(e)},I=Object(At.a)(kp,{fetchPolicy:"no-cache",onCompleted:S,onError:D}),$=Object(u.a)(I,1)[0],P=Object(At.a)(wp,{fetchPolicy:"no-cache",onCompleted:S,onError:D}),A=Object(u.a)(P,1)[0],L=Object(At.a)(Cp,{fetchPolicy:"no-cache",onCompleted:S,onError:D}),F=Object(u.a)(L,1)[0],q=function(e){var t=e.search,a=e.offset,n=e.taskStatus;E.info("Searching...",{persist:!0}),p(t);var i=t;""===t&&(i="_");var r=n;""===r&&(r="_"),$({variables:{operation_id:w.user.current_operation_id,offset:a,fetchLimit:vp,search:"%"+i+"%",status:"%"+r+"%"}})},N=function(e){var t=e.search,a=e.offset,n=e.taskStatus;E.info("Searching...",{persist:!0}),p(t);var i=t;""===t&&(i="_");var r=n;""===r&&(r="_"),A({variables:{operation_id:w.user.current_operation_id,offset:a,fetchLimit:vp,search:"%"+i+"%",status:"%"+r+"%"}})},R=function(e){var t=e.search,a=e.offset,n=e.taskStatus;E.info("Searching...",{persist:!0});var i=t;console.log("search",t),""===t&&(i="_");var r=n;""===r&&(r="_"),p(t),F({variables:{operation_id:w.user.current_operation_id,offset:a,fetchLimit:vp,search:"%"+i+"%",status:"%"+r+"%"}})};return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)($p,{onChangeSearchField:function(e){O(e)},onOutputSearch:q,value:e.value,index:e.index,onChangeTaskStatus:function(e){v(e)},onParameterSearch:N,onCommentSearch:R,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.task.length>0?n.task.map((function(e){return Object(g.jsx)(pd,{task:e,command_id:null==e.command?0:e.command.id},"taskinteractdisplay"+e.id)})):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(o/vp),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(f){case"Output":q({search:j,offset:0,taskStatus:_});break;case"Parameters":N({search:j,offset:0,taskStatus:_});break;case"Comment":R({search:j,offset:0,taskStatus:_})}else switch(f){case"Output":q({search:j,offset:(t-1)*vp,taskStatus:_});break;case"Parameters":N({search:j,offset:(t-1)*vp,taskStatus:_});break;case"Comment":R({search:j,offset:(t-1)*vp,taskStatus:_})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},Ap=a(281),Ep=a.n(Ap),Lp=Object(Ge.a)((function(e){return{root:Object(Pt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),Fp=s.a.forwardRef((function(e,t){var a=Object(xe.a)(),n=Lp(a),i=Object($.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(g.jsx)($.a,{ref:t,className:n.root,children:Object(g.jsxs)(Ke.a,{style:{backgroundColor:a.palette.success.main},children:[Object(g.jsxs)(nn.a,{classes:{root:n.actionRoot},children:[Object(g.jsx)(Q.a,{variant:"subtitle2",className:n.typography,children:e.title}),Object(g.jsxs)("div",{className:n.icons,children:[Object(g.jsx)(K.a,{"aria-label":"Show more",className:Object(an.default)(n.expand,Object(Pt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(g.jsx)(sn.a,{})}),Object(g.jsx)(K.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(g.jsx)(cn.a,{})})]})]}),Object(g.jsx)(G.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(g.jsxs)(H.a,{className:n.collapse,children:[Object(g.jsx)(Q.a,{gutterBottom:!0,children:e.innerText}),Object(g.jsxs)(b.a,{size:"small",className:n.button,download:!0,href:e.downloadLink,children:[Object(g.jsx)(dn.a,{className:n.checkIcon}),"Download now"]})]})})]})})})),qp=a(332),Np=a.n(qp),Rp=Object(Pe.a)(Dp||(Dp=Object(q.a)(["\nmutation downloadBulkMutation($files: [String!]!){\n    download_bulk(files: $files){\n        status\n        error\n        file_id\n    }\n}\n"]))),Bp=Object(Pe.a)(Ip||(Ip=Object(q.a)(["\nmutation updateFileMutation($file_id: Int!){\n    deleteFile(file_id: $file_id) {\n        status\n        error\n        file_ids\n    }\n}\n"]))),zp=Object(Pe.a)(Tp||(Tp=Object(q.a)(["\nmutation updateCommentMutation($file_id: Int!, $comment: String!){\n    update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function Wp(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=function(e,t){i(Object(k.a)(Object(k.a)({},n),{},Object(Pt.a)({},e,t)))};Object(o.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.id,!1))}),{});i(t),d(Object(F.a)(e.files))}),[e.files]);var p=Object(Ee.a)(Rp,{onCompleted:function(e){E.dismiss(),"success"===e.download_bulk.status?E.success("",{persist:!0,content:function(t){return Object(g.jsx)(Fp,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):E.error(e.error)},onError:function(e){console.log(e),E.error("Failed to zip up files")}}),m=Object(u.a)(p,1)[0],h=function(e){var t=e.file_ids,a=l.map((function(e){return t.includes(e.id)?Object(k.a)(Object(k.a)({},e),{},{deleted:!0}):Object(k.a)({},e)}));d(a)},f=function(e){var t=e.id,a=e.comment,n=l.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{comment:a}):Object(k.a)({},e)}));d(n)};return Object(g.jsxs)(z.a,{component:H.a,className:"mythicElement",children:[Object(g.jsxs)(b.a,{size:"small",onClick:function(){E.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var r=Object(u.a)(i[a],2),c=r[0];if(r[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(c)&&t.push(e.files[o].agent_file_id)}m({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(g.jsx)(Np.a,{}),"Zip & Download Selected"]}),Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"}}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(B.a,{children:"File"}),Object(g.jsx)(B.a,{children:"Time"}),Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:"Comment"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"More"})]})}),Object(g.jsx)(R.a,{children:l.map((function(e){return Object(g.jsx)(Mp,Object(k.a)({onToggleSelection:j,onEditComment:f,selected:n,onDelete:h},e),"file"+e.id)}))})]})]})}function Mp(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(T.a)(C),h=Object(xe.a)(),f=Object(Ee.a)(Bp,{onCompleted:function(t){E.dismiss(),e.onDelete(t.deleteFile)},onError:function(e){console.log(e),E.error("Failed to delete file")}}),O=Object(u.a)(f,1)[0],x=Object(Ee.a)(zp,{onCompleted:function(t){E.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),y=Object(u.a)(x,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(La,{onClose:function(){i(!1)},onSubmit:function(){O({variables:{file_id:e.id}})},open:n}),Object(g.jsx)(B.a,{children:e.deleted?null:Object(g.jsx)(gc.a,{title:"Toggle to download multiple files at once",children:Object(g.jsx)(U.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(g.jsx)(B.a,{children:e.deleted?null:Object(g.jsx)(K.a,{size:"small",onClick:function(){i(!0)},style:{color:h.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})})}),Object(g.jsx)(B.a,{children:e.deleted?Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(g.jsxs)(Q.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:he(e.timestamp,m.user.view_utc_time)})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(g.jsxs)(B.a,{children:[e.comment,Object(g.jsx)(K.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit File Comment",onSubmit:function(t){y({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(K.a,{size:"small","aria-label":"expand row",onClick:function(){return l(!o)},children:o?Object(g.jsx)(X.a,{className:"mythicElement"}):Object(g.jsx)(Y.a,{className:"mythicElement"})})})]}),o?Object(g.jsx)(M.a,{children:Object(g.jsx)(B.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(g.jsx)(G.a,{in:o,children:Object(g.jsx)(V.a,{margin:1,children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"16rem"},children:"md5"}),Object(g.jsx)(B.a,{style:{width:"20rem"},children:"sha1"}),Object(g.jsx)(B.a,{style:{width:"20rem"},children:"UUID"}),Object(g.jsx)(B.a,{children:"Operator"}),Object(g.jsx)(B.a,{style:{width:"6rem"},children:"Task"}),Object(g.jsx)(B.a,{children:"Task Comment"}),Object(g.jsx)(B.a,{children:"Command"})]})}),Object(g.jsx)(R.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(g.jsx)(B.a,{children:null===e.task?null:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(B.a,{children:null!==e.task?Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(g.jsx)(B.a,{children:null===e.task?null:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function Hp(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=function(e,t){i(Object(k.a)(Object(k.a)({},n),{},Object(Pt.a)({},e,t)))};Object(o.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(k.a)(Object(k.a)({},e),{},Object(Pt.a)({},t.id,!1))}),{});i(t),d(Object(F.a)(e.files))}),[e.files]);var p=Object(Ee.a)(Rp,{onCompleted:function(e){E.dismiss(),"success"===e.download_bulk.status?E.success("",{persist:!0,content:function(t){return Object(g.jsx)(Fp,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):E.error(e.error)},onError:function(e){console.log(e),E.error("Failed to zip up files")}}),m=Object(u.a)(p,1)[0],h=function(e){var t=e.file_ids,a=l.map((function(e){return t.includes(e.id)?Object(k.a)(Object(k.a)({},e),{},{deleted:!0}):Object(k.a)({},e)}));d(a)},f=function(e){var t=e.id,a=e.comment,n=l.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{comment:a}):Object(k.a)({},e)}));d(n)};return Object(g.jsxs)(z.a,{component:H.a,className:"mythicElement",children:[Object(g.jsxs)(b.a,{size:"small",onClick:function(){E.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var r=Object(u.a)(i[a],2),c=r[0];if(r[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(c)&&t.push(e.files[o].agent_file_id)}m({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(g.jsx)(Np.a,{}),"Zip & Download Selected"]}),Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"}}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(B.a,{children:"Source"}),Object(g.jsx)(B.a,{children:"Destination"}),Object(g.jsx)(B.a,{children:"Time"}),Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:"Comment"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"More"})]})}),Object(g.jsx)(R.a,{children:l.map((function(e){return Object(g.jsx)(Up,Object(k.a)({onToggleSelection:j,onEditComment:f,selected:n,onDelete:h},e),"file"+e.id)}))})]})]})}function Up(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(T.a)(C),h=Object(xe.a)(),f=Object(Ee.a)(Bp,{onCompleted:function(t){E.dismiss(),e.onDelete(t.deleteFile)},onError:function(e){console.log(e),E.error("Failed to delete file")}}),O=Object(u.a)(f,1)[0],x=Object(Ee.a)(zp,{onCompleted:function(t){E.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),y=Object(u.a)(x,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(La,{onClose:function(){i(!1)},onSubmit:function(){O({variables:{file_id:e.id}})},open:n}),Object(g.jsx)(B.a,{children:e.deleted?null:Object(g.jsx)(gc.a,{title:"Toggle to download multiple files at once",children:Object(g.jsx)(U.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(g.jsx)(B.a,{children:e.deleted?null:Object(g.jsx)(K.a,{size:"small",onClick:function(){i(!0)},style:{color:h.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",download:!0,underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.filename_text})}),Object(g.jsx)(B.a,{style:{wordBreak:"break-all"},children:e.deleted?Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(g.jsxs)(Q.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:he(e.timestamp,m.user.view_utc_time)})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(g.jsxs)(B.a,{children:[e.comment,Object(g.jsx)(K.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit File Comment",onSubmit:function(t){y({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(K.a,{size:"small","aria-label":"expand row",onClick:function(){return l(!o)},children:o?Object(g.jsx)(X.a,{className:"mythicElement"}):Object(g.jsx)(Y.a,{className:"mythicElement"})})})]}),o?Object(g.jsx)(M.a,{children:Object(g.jsx)(B.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(g.jsx)(G.a,{in:o,children:Object(g.jsx)(V.a,{margin:1,children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"md5"}),Object(g.jsx)(B.a,{children:"sha1"}),Object(g.jsx)(B.a,{children:"UUID"}),Object(g.jsx)(B.a,{children:"Operator"}),Object(g.jsx)(B.a,{style:{width:"6rem"},children:"Task"}),Object(g.jsx)(B.a,{children:"Task Comment"}),Object(g.jsx)(B.a,{children:"Command"})]})}),Object(g.jsx)(R.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(g.jsx)(B.a,{children:null===e.task?null:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(B.a,{children:null!==e.task?Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(g.jsx)(B.a,{children:null===e.task?null:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function Vp(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(F.a)(e.files))}),[e.files]);var r=function(e){var t=e.id,a=e.comment,r=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{comment:a}):Object(k.a)({},e)}));i(r)};return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"400px"},children:"Thumbnail"}),Object(g.jsx)(B.a,{children:"Filename"}),Object(g.jsx)(B.a,{children:"Time"}),Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:"Comment"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"More"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(Gp,Object(k.a)({onEditComment:r},e),"file"+e.id)}))})]})})}function Gp(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(T.a)(C),c=s.a.useState(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],h=Object(Ee.a)(zp,{onCompleted:function(t){E.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),f=Object(u.a)(h,1)[0];return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsxs)(B.a,{children:[Object(g.jsx)("img",{onClick:function(){return d(!0)},src:"/api/v1.4/files/screencaptures/"+e.agent_file_id,style:{width:"350px",cursor:"pointer"}}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"xl",open:l,onClose:function(){d(!1)},innerDialog:Object(g.jsx)(No,{href:"/api/v1.4/files/screencaptures/"+e.agent_file_id,onClose:function(){d(!1)}})}),e.chunks_received<e.total_chunks?Object(g.jsxs)(Q.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]}):null]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.filename_text})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:he(e.timestamp,r.user.view_utc_time)})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(g.jsxs)(B.a,{children:[e.comment,Object(g.jsx)(K.a,{onClick:function(){return m(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit File Comment",onSubmit:function(t){f({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){m(!1)}})})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(K.a,{size:"small","aria-label":"expand row",onClick:function(){return i(!n)},children:n?Object(g.jsx)(X.a,{className:"mythicElement"}):Object(g.jsx)(Y.a,{className:"mythicElement"})})})]}),n?Object(g.jsx)(M.a,{children:Object(g.jsx)(B.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(g.jsx)(G.a,{in:n,children:Object(g.jsx)(V.a,{margin:1,children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"md5"}),Object(g.jsx)(B.a,{children:"sha1"}),Object(g.jsx)(B.a,{children:"UUID"}),Object(g.jsx)(B.a,{children:"Operator"}),Object(g.jsx)(B.a,{style:{width:"6rem"},children:"Task"}),Object(g.jsx)(B.a,{children:"Task Comment"}),Object(g.jsx)(B.a,{children:"Command"})]})}),Object(g.jsx)(R.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(g.jsx)(B.a,{children:null===e.task?null:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(B.a,{children:null!==e.task?Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(g.jsx)(B.a,{children:null===e.task?null:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}var Kp,Qp,Jp,Yp,Zp,Xp,em,tm,am,nm,im,rm,cm,om,sm=a(467),lm=a.n(sm),dm=Object(Pe.a)(Kp||(Kp=Object(q.a)(["\nmutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!){\n    update_filebrowserobj_by_pk(pk_columns: {id: $filebrowserobj_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function um(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(F.a)(e.files))}),[e.files]);var r=function(e){var t=e.id,a=e.comment,r=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{comment:a}):Object(k.a)({},e)}));i(r)};return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Host / Path"}),Object(g.jsx)(B.a,{children:"Modify Time"}),Object(g.jsx)(B.a,{children:"Comment"}),Object(g.jsx)(B.a,{style:{width:"7rem"},children:"Permissions"}),Object(g.jsx)(B.a,{style:{width:"7rem"},children:"Downloads"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(bm,Object(k.a)({onEditComment:r},e),"file"+e.id)}))})]})})}function bm(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=Object(Ee.a)(dm,{onCompleted:function(t){E.success("updated comment"),e.onEditComment(t.update_filebrowserobj_by_pk)}}),f=Object(u.a)(h,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(g.jsx)(pe,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:e.permissions,onClose:function(){i(!1)}})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:o,onClose:function(){l(!1)},innerDialog:Object(g.jsx)(Tu,{title:"Download History",value:e.filemeta,onClose:function(){l(!1)}})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit File Browser Comment",onSubmit:function(t){f({variables:{filebrowserobj_id:e.id,comment:t}})},value:e.comment,onClose:function(){m(!1)}})}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host}),Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",textDecoration:e.deleted?"strike-through":""},children:e.full_path_text})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.modify_time})}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{onClick:function(){return m(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(b.a,{color:"primary",variant:"outlined",onClick:function(){return i(!0)},children:Object(g.jsx)(lm.a,{})})}),Object(g.jsx)(B.a,{children:e.filemeta.length>0?Object(g.jsx)(gc.a,{title:"View Download History and Download Files",children:Object(g.jsx)(b.a,{color:"primary",variant:"contained",onClick:function(){return l(!0)},children:Object(g.jsx)(Wu.a,{})})}):null})]})})}var jm=Object(Pe.a)(Qp||(Qp=Object(q.a)(["\nfragment filemetaData on filemeta{\n    agent_file_id\n    chunk_size\n    chunks_received\n    complete\n    deleted\n    filename_text\n    full_remote_path_text\n    host\n    id\n    is_download_from_agent\n    is_payload\n    is_screenshot\n    md5\n    operator {\n        id\n        username\n    }\n    comment\n    sha1\n    timestamp\n    total_chunks\n    task {\n        id\n        comment\n        command {\n            cmd\n            id\n        }\n    }\n}\n"]))),pm=Object(Pe.a)(Jp||(Jp=Object(q.a)(["\nfragment filebrowserData on filebrowserobj{\n    comment\n    deleted\n    full_path_text\n    host\n    id\n    is_file\n    modify_time\n    permissions\n    size\n    filemeta {\n        id\n        agent_file_id\n        chunks_received\n        complete\n        total_chunks\n        timestamp\n        task {\n            id\n            comment\n        }\n    }\n}\n"]))),mm=20,hm=Object(Pe.a)(Yp||(Yp=Object(q.a)(["\n","\nquery filenameFileMetaUploadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),fm=Object(Pe.a)(Zp||(Zp=Object(q.a)(["\n","\nquery filenameFileMetaDownloadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),Om=Object(Pe.a)(Xp||(Xp=Object(q.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {full_path_text: {_ilike: $filename}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, full_path_text: {_ilike: $filename}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),pm),gm=Object(Pe.a)(em||(em=Object(q.a)(["\n","\nquery hashFileMetaUploadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),xm=Object(Pe.a)(tm||(tm=Object(q.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),ym=Object(Pe.a)(am||(am=Object(q.a)(["\n","\nquery commentFileMetaUploadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),_m=Object(Pe.a)(nm||(nm=Object(q.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),vm=Object(Pe.a)(im||(im=Object(q.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),pm),km=Object(Pe.a)(rm||(rm=Object(q.a)(["\n","\nquery filenameFileMetaScreenshotQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),wm=Object(Pe.a)(cm||(cm=Object(q.a)(["\n","\nquery hashFileMetaScreenshotQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),jm),Cm=Object(Pe.a)(om||(om=Object(q.a)(["\n","\nquery commentFileMetaScreenshotQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),jm);function Sm(e){return Object(g.jsx)(wo,Object(k.a)({label:"Files",iconComponent:Object(g.jsx)(Ep.a,{})},e))}var Dm,Im,Tm,$m,Pm,Am,Em,Lm,Fm,qm,Nm,Rm=function(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState("Filename"),p=Object(u.a)(j,2),m=p[0],h=p[1],f=["Filename","Hash","Comment"],O=s.a.useState("Downloads"),x=Object(u.a)(O,2),_=x[0],v=x[1],k=["Uploads","Downloads","FileBrowser","Screenshots"],w=s.a.useState(!1),C=Object(u.a)(w,2),S=C[0],D=C[1],I=function(t,a,n,r,c){var o=a||l,s=n||i,d=c||_;switch(r||m){case"Filename":e.onFilenameSearch({search:o,searchHost:s,offset:0,adjustedSearchLocation:d});break;case"Hash":e.onHashSearch({search:o,searchHost:s,offset:0,adjustedSearchLocation:d});break;case"Comment":e.onCommentSearch({search:o,searchHost:s,offset:0,adjustedSearchLocation:d})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="",i="Filename",c="Downloads";t.has("search")&&(d(t.get("search")),a=t.get("search")),t.has("searchField")&&f.includes(t.get("searchField"))?(h(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),i=t.get("searchField")):(h("Filename"),e.onChangeSearchField("Filename"),e.changeSearchParam("searchField","Filename")),t.has("location")&&k.includes(t.get("location"))&&(v(t.get("location")),c=t.get("location"),e.onChangeSearchLocation(t.get("location"))),t.has("host")&&(r(t.get("host")),n=t.get("host")),D(!S),I(0,a,n,i,c)}}),[e.value,e.index]),Object(g.jsxs)(Ft.a,{container:!0,spacing:1,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:2,children:Object(g.jsx)(y,{placeholder:"Host Name Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("host",a)},onEnter:I,name:"Host Name Search..."})}),Object(g.jsx)(Ft.a,{item:!0,xs:3,children:Object(g.jsx)(y,{placeholder:"Search...",value:l,onChange:function(t,a,n){d(a),e.changeSearchParam("search",a)},onEnter:I,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:I,children:Object(g.jsx)(Qs.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(Ft.a,{item:!0,xs:2,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search File's"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:m,onChange:function(t){h(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:f.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(g.jsxs)(Ft.a,{item:!0,xs:2,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search Location"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:_,onChange:function(t){v(t.target.value),e.onChangeSearchLocation(t.target.value),e.changeSearchParam("location",t.target.value)},children:k.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchlocopt"+e)}))})]}),Object(g.jsx)(Ft.a,{item:!0,xs:2,children:Object(g.jsxs)(b.a,{variant:"contained",color:"primary",component:"label",children:["Host File in Mythic ",Object(g.jsx)("input",{onChange:function(e){!function(e){try{var t=new XMLHttpRequest,a=new FormData;t.open("POST",window.location.origin+"/api/v1.4/files/manual",!0),t.setRequestHeader("Authorization","Bearer "+localStorage.getItem("access_token")),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status)try{var e=JSON.parse(t.responseText);"success"===e.status?E.success("Successfuly hosted file! Now searchable on the 'Uploads' search"):E.error("Failed to host file! "+e.error)}catch(n){E.error("Failed to process response from upload: "+n),console.log(n)}else 4!==t.readyState||302!==t.status&&405!==t.status?4===t.readyState&&(console.log("httpGetAsync Error with data: "+a),E.error("Mythic hit an error trying to hos the file: "+t.status+": "+t.statusText)):(console.log("httpGetAsync was 302 or 405 from url "),E.error("Got HTTP 302 or 405 when trying to host file"))},a.append("upload_file",e),t.send(a)}catch(n){E.error("HTTP Browser error trying to upload file: "+n.toString()),console.error("HTTP Browser error: "+n.toString())}}(e.target.files[0])},type:"file",hidden:!0})]})})]})},Bm=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(0),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState(""),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState(""),y=Object(u.a)(x,2),_=y[0],v=y[1],w=s.a.useState("Filename"),S=Object(u.a)(w,2),D=S[0],I=S[1],$=s.a.useState("Downloads"),P=Object(u.a)($,2),A=P[0],L=P[1],F=Object(T.a)(C),q=function(e){E.dismiss(),p(e.filemeta_aggregate.aggregate.count),l([]),i(e.filemeta)},N=function(e){E.dismiss(),p(e.filebrowserobj_aggregate.aggregate.count),l(e.filebrowserobj),i([])},R=function(e){E.dismiss(),E.error("Failed to fetch data for search"),console.log(e)},B=Object(At.a)(hm,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),z=Object(u.a)(B,1)[0],W=Object(At.a)(fm,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),M=Object(u.a)(W,1)[0],H=Object(At.a)(Om,{fetchPolicy:"no-cache",onCompleted:N,onError:R}),U=Object(u.a)(H,1)[0],V=Object(At.a)(km,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),G=Object(u.a)(V,1)[0],K=Object(At.a)(gm,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),J=Object(u.a)(K,1)[0],Y=Object(At.a)(xm,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),Z=Object(u.a)(Y,1)[0],X=Object(At.a)(wm,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),ee=Object(u.a)(X,1)[0],te=Object(At.a)(ym,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),ae=Object(u.a)(te,1)[0],ne=Object(At.a)(_m,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),ie=Object(u.a)(ne,1)[0],re=Object(At.a)(vm,{fetchPolicy:"no-cache",onCompleted:N,onError:R}),ce=Object(u.a)(re,1)[0],oe=Object(At.a)(Cm,{fetchPolicy:"no-cache",onCompleted:q,onError:R}),se=Object(u.a)(oe,1)[0],le=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;E.info("Searching...",{persist:!0}),O(t),v(a),"FileBrowser"===i?U({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,filename:"%"+t+"%",host:"%"+a+"%"}}):"Uploads"===i?z({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,filename:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===i?M({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,filename:"%"+t+"%",host:"%"+a+"%"}}):G({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,filename:"%"+t+"%",host:"%"+a+"%"}})},de=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;E.info("Searching...",{persist:!0}),O(t),v(a),"FileBrowser"===i?(E.dismiss(),E.warning("FileBrowser doesn't currently track file hashes")):"Uploads"===i?J({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,hash:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===i?Z({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,hash:"%"+t+"%",host:"%"+a+"%"}}):ee({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,hash:"%"+t+"%",host:"%"+a+"%"}})},ue=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;E.info("Searching...",{persist:!0});var r=t;""===t&&(r="_"),O(r),v(a),"FileBrowser"===i?ce({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,comment:"%"+r+"%",host:"%"+a+"%"}}):"Uploads"===i?ae({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,comment:"%"+r+"%",host:"%"+a+"%"}}):"Downloads"===i?ie({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,comment:"%"+r+"%",host:"%"+a+"%"}}):se({variables:{operation_id:F.user.current_operation_id,offset:n,fetchLimit:mm,comment:"%"+r+"%",host:"%"+a+"%"}})};return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)(Rm,{onChangeSearchField:function(e){I(e)},onFilenameSearch:le,value:e.value,index:e.index,queryParams:e.queryParams,onHashSearch:de,onCommentSearch:ue,onChangeSearchLocation:function(e){L(e),i([]),l([])},changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?"Uploads"===A?Object(g.jsx)(Hp,{files:n}):"Downloads"===A?Object(g.jsx)(Wp,{files:n}):Object(g.jsx)(Vp,{files:n}):o.length>0?Object(g.jsx)(um,{files:o}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(j/mm),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(D){case"Filename":le({search:f,searchHost:_,offset:0});break;case"Hash":de({search:f,searchHost:_,offset:0});break;case"Comments":ue({search:f,offset:0})}else switch(D){case"Filename":le({search:f,searchHost:_,offset:(t-1)*mm});break;case"Hash":de({search:f,offset:(t-1)*mm});break;case"Comments":ue({search:f,offset:(t-1)*mm})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",j]})]})]}))},zm=a(468),Wm=a.n(zm),Mm=a(189),Hm=a.n(Mm),Um=Object(Pe.a)(Dm||(Dm=Object(q.a)(["\nmutation updateCommentMutation($credential_id: Int!, $comment: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {comment: $comment}) {\n        comment\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),Vm=Object(Pe.a)(Im||(Im=Object(q.a)(["\nmutation updateAccountMutation($credential_id: Int!, $account: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {account: $account}) {\n        account\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),Gm=Object(Pe.a)(Tm||(Tm=Object(q.a)(["\nmutation updateAccountMutation($credential_id: Int!, $realm: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {realm: $realm}) {\n        realm\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),Km=Object(Pe.a)($m||($m=Object(q.a)(["\nmutation updateAccountMutation($credential_id: Int!, $credential: bytea!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {credential_raw: $credential}) {\n        credential_text\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),Qm=Object(Pe.a)(Pm||(Pm=Object(q.a)(["\nmutation updateAccountMutation($credential_id: Int!, $deleted: Boolean!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n        operator {\n            username\n        }\n    }\n}\n"])));function Jm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(F.a)(e.credentials))}),[e.credentials]);var r=function(e){var t=e.id,a=e.comment,r=e.operator,c=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{comment:a,operator:r}):Object(k.a)({},e)}));i(c)},c=function(e){var t=e.id,a=e.account,r=e.operator,c=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{account:a,operator:r}):Object(k.a)({},e)}));i(c)},l=function(e){var t=e.id,a=e.realm,r=e.operator,c=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{realm:a,operator:r}):Object(k.a)({},e)}));i(c)},d=function(e){var t=e.id,a=e.credential_text,r=e.operator,c=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{credential_text:a,operator:r}):Object(k.a)({},e)}));i(c)},b=function(e){var t=e.id,a=e.deleted,r=e.operator,c=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{deleted:a,operator:r}):Object(k.a)({},e)}));i(c)};return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(B.a,{children:"Account"}),Object(g.jsx)(B.a,{children:"Realm"}),Object(g.jsx)(B.a,{children:"Credential"}),Object(g.jsx)(B.a,{children:"Comment"}),Object(g.jsx)(B.a,{children:"Timestamp"}),Object(g.jsx)(B.a,{children:"Task / Operator"}),Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Type"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(Ym,Object(k.a)({onEditComment:r,onEditAccount:c,onEditRealm:l,onEditCredential:d,onEditDeleted:b},e),"cred"+e.id)}))})]})})}function Ym(e){var t=Object(T.a)(C),a=Object(xe.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState(!1),l=Object(u.a)(o,2),d=l[0],b=l[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),O=Object(u.a)(f,2),x=O[0],y=O[1],_=s.a.useState(!1),v=Object(u.a)(_,2),k=v[0],w=v[1],S=Object(Ee.a)(Um,{onCompleted:function(t){E.success("updated comment"),e.onEditComment(t.update_credential_by_pk)}}),D=Object(u.a)(S,1)[0],I=Object(Ee.a)(Vm,{onCompleted:function(t){E.success("updated account"),e.onEditAccount(t.update_credential_by_pk)}}),$=Object(u.a)(I,1)[0],P=Object(Ee.a)(Gm,{onCompleted:function(t){E.success("updated realm"),e.onEditRealm(t.update_credential_by_pk)}}),A=Object(u.a)(P,1)[0],L=Object(Ee.a)(Km,{onCompleted:function(t){E.success("updated credential"),e.onEditCredential(t.update_credential_by_pk)}}),F=Object(u.a)(L,1)[0],q=Object(Ee.a)(Qm,{onCompleted:function(t){E.success("updated deleted status"),e.onEditDeleted(t.update_credential_by_pk)}}),N=Object(u.a)(q,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(La,{onClose:function(){c(!1)},onSubmit:function(){N({variables:{credential_id:e.id,deleted:!e.deleted}})},open:r,acceptText:e.deleted?"Restore":"Remove"}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:d,onClose:function(){b(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Credential Comment",onSubmit:function(t){D({variables:{credential_id:e.id,comment:t}})},value:e.comment,onClose:function(){b(!1)}})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){h(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Credential Account",onSubmit:function(t){$({variables:{credential_id:e.id,account:t}})},value:e.account,onClose:function(){h(!1)}})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:x,onClose:function(){y(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Credential Realm",onSubmit:function(t){A({variables:{credential_id:e.id,realm:t}})},value:e.realm,onClose:function(){y(!1)}})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:k,onClose:function(){w(!1)},innerDialog:Object(g.jsx)(je,{title:"Edit Credential Credential",onSubmit:function(t){F({variables:{credential_id:e.id,credential:t}})},value:e.credential_text,onClose:function(){w(!1)}})}),Object(g.jsxs)(B.a,{children:[e.deleted?Object(g.jsx)(gc.a,{title:"Restore Credential for use in Tasking",children:Object(g.jsx)(K.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(g.jsx)(Hm.a,{})})}):Object(g.jsx)(gc.a,{title:"Delete Credential so it can't be used in Tasking",children:Object(g.jsx)(K.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})})})," "]}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{onClick:function(){return h(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.account})]}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{onClick:function(){return y(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.realm})]}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{onClick:function(){return w(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",maxWidth:"40rem"},children:e.credential_text})]}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(K.a,{onClick:function(){return b(!0)},size:"small",style:{display:"inline-block"},children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:he(e.timestamp,t.user.view_utc_time)})}),Object(g.jsx)(B.a,{children:null!==e.task_id?e.task_id:e.operator.username}),Object(g.jsx)(B.a,{children:e.type})]})})}var Zm=Object(Pe.a)(Am||(Am=Object(q.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),Xm=20,eh=Object(Pe.a)(Em||(Em=Object(q.a)(["\n","\nquery accountQuery($operation_id: Int!, $account: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),Zm),th=Object(Pe.a)(Lm||(Lm=Object(q.a)(["\n","\nquery accountQuery($operation_id: Int!, $realm: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),Zm),ah=Object(Pe.a)(Fm||(Fm=Object(q.a)(["\n","\nquery accountQuery($operation_id: Int!, $credential: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),Zm),nh=Object(Pe.a)(qm||(qm=Object(q.a)(["\n","\nquery accountQuery($operation_id: Int!, $comment: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),Zm),ih=Object(Pe.a)(Nm||(Nm=Object(q.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      id\n    }\n  }\n"])),Zm);function rh(e){return Object(g.jsx)(wo,Object(k.a)({label:"Credentials",iconComponent:Object(g.jsx)(Wm.a,{})},e))}var ch,oh,sh,lh,dh,uh,bh,jh=function(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Account"),o=Object(u.a)(c,2),l=o[0],d=o[1],j=["Account","Realm","Comment","Credential"],p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1],O=Object(Ee.a)(ih,{fetchPolicy:"no-cache",onCompleted:function(e){E.success("Successfully created new credential")},onError:function(e){E.error("Failed to create credential"),console.log(e)}}),x=Object(u.a)(O,1)[0],_=function(t,a,n){var r=a||i;switch(n||l){case"Account":e.onAccountSearch({search:r,offset:0});break;case"Realm":e.onRealmSearch({search:r,offset:0});break;case"Comment":e.onCommentSearch({search:r,offset:0});break;case"Credential":e.onCredentialSearch({search:r,offset:0});break;case"Type":e.OnTypeSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Account";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&j.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Account"),e.onChangeSearchField("Account"),e.changeSearchParam("searchField","Account")),_(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(Ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:5,children:Object(g.jsx)(y,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:_,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:_,children:Object(g.jsx)(Qs.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(Ft.a,{item:!0,xs:2,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search Credential's"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:j.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(g.jsxs)(Ft.a,{item:!0,xs:2,children:[Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:h,onClose:function(){f(!1)},innerDialog:Object(g.jsx)(ts,{onSubmit:function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,r=e.credential;x({variables:{type:t,account:a,realm:n,comment:i,credential:r}})},onClose:function(){f(!1)}})}),Object(g.jsx)(b.a,{size:"small",color:"primary",onClick:function(){f(!0)},variant:"contained",children:"New Credential"})]})]})},ph=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Account"),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(T.a)(C),y=function(e){E.dismiss(),l(e.credential_aggregate.aggregate.count),i(e.credential)},_=function(e){E.dismiss(),E.error("Failed to fetch data for search"),console.log(e)},v=Object(At.a)(eh,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),w=Object(u.a)(v,1)[0],S=Object(At.a)(th,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),D=Object(u.a)(S,1)[0],I=Object(At.a)(ah,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),$=Object(u.a)(I,1)[0],P=Object(At.a)(nh,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),A=Object(u.a)(P,1)[0],L=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t),w({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Xm,account:"%"+t+"%"}})},F=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t),D({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Xm,realm:"%"+t+"%"}})},q=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t),$({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Xm,credential:"%"+t+"%"}})},N=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),A({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Xm,comment:"%"+n+"%"}})};return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)(jh,{onChangeSearchField:function(e){O(e),i([])},onAccountSearch:L,value:e.value,index:e.index,onRealmSearch:F,onCredentialSearch:q,onCommentSearch:N,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(Jm,{credentials:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(o/Xm),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(f){case"Account":L({search:j,offset:0});break;case"Realm":F({search:j,offset:0});break;case"Credential":q({search:j,offset:0});break;case"Comment":N({search:j,offset:0})}else switch(f){case"Account":L({search:j,offset:(t-1)*Xm});break;case"Realm":F({search:j,offset:(t-1)*Xm});break;case"Credential":q({search:j,offset:(t-1)*Xm});break;case"Comment":N({search:j,offset:(t-1)*Xm})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))};function mh(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(o.useEffect)((function(){for(var t=e.keylogs.reduce((function(e,t){return void 0===e[t.user]?e[t.user]=Object(Pt.a)({},t.task.callback.host,Object(Pt.a)({},t.window,[Object(k.a)({},t)])):"undefined"===e[t.user][t.task.callback.host]?e[t.user][t.task.callback.host]=Object(Pt.a)({},t.window,[Object(k.a)({},t)]):void 0===e[t.user][t.task.callback.host][t.window]?e[t.user][t.task.callback.host][t.window]=[Object(k.a)({},t)]:e[t.user][t.task.callback.host][t.window].push(Object(k.a)({},t)),Object(k.a)({},e)}),{}),a=[],n=0,r=Object.entries(t);n<r.length;n++){for(var c=Object(u.a)(r[n],2),o=c[0],s=c[1],l=[],d=0,b=Object.entries(s);d<b.length;d++){for(var j=Object(u.a)(b[d],2),p=j[0],m=j[1],h=[],f=0,O=Object.entries(m);f<O.length;f++){var g=Object(u.a)(O[f],2),x=g[0],y=g[1];h.push({name:x,value:y})}l.push({name:p,value:h})}a.push({name:o,value:l})}i([].concat(a))}),[e.keylogs]),Object(g.jsx)(Ft.a,{container:!0,spacing:0,direction:"row",columns:12,children:n.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Ft.a,{item:!0,xs:2,style:{borderBottom:"2px solid grey"},children:e.name}),Object(g.jsx)(Ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:"2px solid grey"},children:e.value.map((function(t,a){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(Ft.a,{item:!0,xs:2,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.name}),Object(g.jsx)(Ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.value.map((function(a,n){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Ft.a,{item:!0,xs:2,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:[" ",a.name," "]}),Object(g.jsx)(Ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:Object(g.jsx)(Ft.a,{item:!0,xs:12,children:a.value.map((function(n,i){return Object(g.jsx)("span",{children:n.keystrokes_text},e.name+t.name+a.name+i)}))})})]},e.name+t.name+a.name)}))})]},e.name+t.name)}))})]},e.name)}))})}var hh=Object(Pe.a)(ch||(ch=Object(q.a)(["\nfragment keylogData on keylog{\n    keystrokes_text\n    task {\n        id\n        callback {\n            host\n            id\n        }\n    }\n    user\n    window\n    timestamp\n    id\n}\n"]))),fh=200,Oh=Object(Pe.a)(oh||(oh=Object(q.a)(["\n","\nquery keylogQuery($operation_id: Int!, $keylog: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),hh),gh=Object(Pe.a)(sh||(sh=Object(q.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: user, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: user, offset: $offset, order_by: {user: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),hh),xh=Object(Pe.a)(lh||(lh=Object(q.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),hh),yh=Object(Pe.a)(dh||(dh=Object(q.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),hh),_h=Object(Pe.a)(uh||(uh=Object(q.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: window, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: window, offset: $offset, order_by: {window: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),hh),vh=Object(Pe.a)(bh||(bh=Object(q.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),hh);function kh(e){return Object(g.jsx)(wo,Object(k.a)({label:"Keylogs",iconComponent:Object(g.jsx)(Fl.a,{})},e))}var wh,Ch,Sh,Dh,Ih=function(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Keystroke"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Keystroke","User","Program","Host"],j=function(t,a,n){var r=a||i;switch(n||l){case"Keystroke":e.onKeylogSearch({search:r,offset:0});break;case"User":e.onUserSearch({search:r,offset:0});break;case"Program":e.onProgramSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Keystroke";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Keystroke"),e.onChangeSearchField("Keystroke"),e.changeSearchParam("searchField","Keystroke")),j(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(Ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsx)(y,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:j,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:j,children:Object(g.jsx)(Qs.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(Ft.a,{item:!0,xs:2,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search Keylog's"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},Th=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Keystroke"),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(T.a)(C),y=function(e){E.dismiss(),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},_=function(e){E.dismiss(),E.error("Failed to fetch data for search"),console.log(e)},v=Object(At.a)(Oh,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),w=Object(u.a)(v,1)[0],S=Object(At.a)(xh,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),D=Object(u.a)(S,1)[0],I=Object(At.a)(gh,{fetchPolicy:"no-cache",onCompleted:function(e){E.dismiss(),0===e.keylog_aggregate.aggregate.count?E.info("No Results"):E.success("Showing One Entry for Each Unique User"),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){E.error("Failed to fetch data for search"),console.log(e)}}),$=Object(u.a)(I,1)[0],P=Object(At.a)(yh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){E.error("Failed to fetch data for search"),console.log(e)}}),A=Object(u.a)(P,1)[0],L=Object(At.a)(_h,{fetchPolicy:"no-cache",onCompleted:function(e){E.dismiss(),0===e.keylog_aggregate.aggregate.count?E.info("No Results"):E.success("Showing One Entry for Each Unique Program"),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){E.error("Failed to fetch data for search"),console.log(e)}}),F=Object(u.a)(L,1)[0],q=Object(At.a)(vh,{fetchPolicy:"no-cache",onCompleted:y,onError:function(e){E.error("Failed to fetch data for search"),console.log(e)}}),N=Object(u.a)(q,1)[0],R=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),w({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:fh,keylog:"%"+n+"%"}})},B=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t),""===t?$({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:fh,user:"%_%"}}):D({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:fh,user:"%"+t+"%"}})},z=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t),""===t?F({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:fh,program:"%_%"}}):A({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:fh,program:"%"+t+"%"}})},W=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),N({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:fh,host:"%"+n+"%"}})};return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)(Ih,{onChangeSearchField:function(e){O(e),i([])},onKeylogSearch:R,value:e.value,index:e.index,onUserSearch:B,onProgramSearch:z,onHostSearch:W,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(mh,{keylogs:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(o/fh),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(f){case"Keystroke":R({search:j,offset:0});break;case"User":B({search:j,offset:0});break;case"Program":z({search:j,offset:0});break;case"Host":W({search:j,offset:0})}else switch(f){case"Keystroke":R({search:j,offset:(t-1)*fh});break;case"User":B({search:j,offset:(t-1)*fh});break;case"Program":z({search:j,offset:(t-1)*fh});break;case"Host":W({search:j,offset:(t-1)*fh})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},$h=Object(Pe.a)(wh||(wh=Object(q.a)(["\nmutation updateComment ($token_id: Int!, $description: String) {\n  update_token_by_pk(pk_columns: {id: $token_id}, _set: {description: $description}) {\n    description\n    id\n  }\n}\n"]))),Ph=Object(Pe.a)(Ch||(Ch=Object(q.a)(["\nquery getCommentQuery ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    description\n    id\n  }\n}\n"])));function Ah(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(Ae.a)(Ph,{variables:{token_id:e.token_id},onCompleted:function(e){i(e.token_by_pk.description)},fetchPolicy:"network-only"});var r=Object(Ee.a)($h,{onCompleted:function(t){console.log("udpated"),e.onClose()},onError:function(t){console.error(t),e.onClose()}}),c=Object(u.a)(r,1)[0],l=function(){c({variables:{token_id:e.token_id,description:n}})};return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Edit Token Description"}),Object(g.jsx)(ce.a,{dividers:!0,children:Object(g.jsx)(y,{autoFocus:!0,onEnter:l,onChange:function(e,t,a){i(t)},value:n})}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:l,variant:"contained",color:"secondary",children:"Submit"})]})]})}var Eh,Lh,Fh,qh,Nh,Rh=Object(Pe.a)(Sh||(Sh=Object(q.a)(["\nmutation updateCredentialDeletedMutation($token_id: Int!, $deleted: Boolean!){\n    update_token_by_pk(pk_columns: {id: $token_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n    }\n}\n"]))),Bh=Object(Pe.a)(Dh||(Dh=Object(q.a)(["\nmutation updateCallbacksOfDeletedTokenMutation($token_id: Int!, $deleted: Boolean!){\n    update_callbacktoken(where: {token_id: {_eq: $token_id}}, _set: {deleted: $deleted}) {\n        affected_rows\n    }\n}\n"])));function zh(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(F.a)(e.tokens))}),[e.credentials]);var r=function(e){var t=e.id,a=e.deleted,r=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{deleted:a}):Object(k.a)({},e)}));i(r)};return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Delete"}),Object(g.jsx)(B.a,{children:"User"}),Object(g.jsx)(B.a,{children:"Groups"}),Object(g.jsx)(B.a,{children:"TokenId"}),Object(g.jsx)(B.a,{children:"Logon Session"}),Object(g.jsx)(B.a,{children:"Description"}),Object(g.jsx)(B.a,{children:"Task"}),Object(g.jsx)(B.a,{children:"Callbacks With Handles"}),Object(g.jsx)(B.a,{children:"Host"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(Wh,Object(k.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function Wh(e){var t,a=Object(xe.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState(!1),l=Object(u.a)(o,2),d=l[0],b=l[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(Ee.a)(Bh,{onCompleted:function(e){E.success("Removed token from callback")},onError:function(e){E.error("Operation not allowed")}}),O=Object(u.a)(f,1)[0],x=Object(Ee.a)(Rh,{onCompleted:function(t){E.success("Updated deleted status"),null===e.callbacktokens||e.deleted||O({variables:{token_id:e.id,deleted:!0}}),e.onEditDeleted(t.update_token_by_pk)},onError:function(e){E.error("Operation not allowed")}}),y=Object(u.a)(x,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(La,{onClose:function(){c(!1)},onSubmit:function(){y({variables:{token_id:e.id,deleted:!e.deleted}})},open:r,acceptText:e.deleted?"Restore":"Remove"}),Object(g.jsxs)(B.a,{children:[e.deleted?Object(g.jsx)(gc.a,{title:"Restore Token for use in Tasking",children:Object(g.jsx)(K.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(g.jsx)(Hm.a,{})})}):Object(g.jsx)(gc.a,{title:"Delete Token so it can't be used in Tasking",children:Object(g.jsx)(K.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})})})," "]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.User})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.Groups})}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.TokenId}),Object(g.jsx)(gc.a,{title:"View Token Information",children:Object(g.jsx)(K.a,{size:"small",color:"primary",onClick:function(){b(!0)},children:Object(g.jsx)(Nl.a,{})})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:d,onClose:function(){b(!1)},innerDialog:Object(g.jsx)(zl,{token_id:e.id,onClose:function(){b(!1)}})})]}),Object(g.jsx)(B.a,{children:null===e.logonsession?Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:"No Logon Session Data"}):Object(g.jsxs)(s.a.Fragment,{children:[e.logonsession.LogonId," ",null!==e.logonsession.LogonType?" ("+e.logonsession.LogonType+")":null]})}),Object(g.jsxs)(B.a,{children:[Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description}),Object(g.jsx)(K.a,{onClick:function(){return h(!0)},size:"small",children:Object(g.jsx)(Bi.a,{})}),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){h(!1)},innerDialog:Object(g.jsx)(Ah,{token_id:e.id,onClose:function(){h(!1)}})})]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(B.a,{children:(null===(t=e.callbacktokens)||void 0===t?void 0:t.map((function(e){return e.callback_id})))||null}),Object(g.jsx)(B.a,{children:e.host})]})})}var Mh=Object(Pe.a)(Eh||(Eh=Object(q.a)(["\nfragment tokenData on token{\n    id\n    User\n    Groups\n    TokenId\n    logonsession {\n        LogonType\n        UserName\n        LogonDomain\n        id\n        LogonId\n        authenticationpackages(where: {deleted: {_eq: false}}) {\n            Name\n            id\n        }\n    }\n    task {\n        id\n    }\n    host\n    deleted\n    description\n    callbacktokens(where: {deleted: {_eq: false}}) {\n        callback_id\n        id\n    }\n}\n"]))),Hh=20,Uh=Object(Pe.a)(Lh||(Lh=Object(q.a)(["\n","\nquery usergroupQuery($operation_id: Int!, $name: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      ...tokenData\n    }\n}\n"])),Mh),Vh=Object(Pe.a)(Fh||(Fh=Object(q.a)(["\n","\nquery sidQuery($operation_id: Int!, $sid: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      ...tokenData\n    }\n}\n"])),Mh),Gh=Object(Pe.a)(qh||(qh=Object(q.a)(["\n","\nquery logontypeQuery($operation_id: Int!, $logontype: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n  }\n"])),Mh),Kh=Object(Pe.a)(Nh||(Nh=Object(q.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n}\n"])),Mh);function Qh(e){return Object(g.jsx)(wo,Object(k.a)({label:"Tokens",iconComponent:Object(g.jsx)(Nl.a,{})},e))}var Jh,Yh,Zh,Xh,ef,tf,af=function(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("User/Group"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["User/Group","SID","LogonType","Host"],j=function(t,a,n){var r=a||i;switch(n||l){case"User/Group":e.onUserGroupSearch({search:r,offset:0});break;case"SID":e.onSIDSearch({search:r,offset:0});break;case"LogonType":e.onLogonTypeSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User/Group";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User/Group"),e.onChangeSearchField("User/Group"),e.changeSearchParam("searchField","User/Group")),j(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(Ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsx)(y,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:j,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:j,children:Object(g.jsx)(Qs.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(Ft.a,{item:!0,xs:2,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search Tokens by"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},nf=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("User/Group"),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(T.a)(C),y=function(e){E.dismiss(),l(e.token_aggregate.aggregate.count),i(e.token)},_=function(e){E.dismiss(),E.error("Failed to fetch data for search"),console.log(e)},v=Object(At.a)(Uh,{fetchPolicy:"network-only",onCompleted:y,onError:_}),w=Object(u.a)(v,1)[0],S=Object(At.a)(Vh,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),D=Object(u.a)(S,1)[0],I=Object(At.a)(Gh,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),$=Object(u.a)(I,1)[0],P=Object(At.a)(Kh,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),A=Object(u.a)(P,1)[0],L=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),w({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Hh,name:"%"+n+"%"}})},F=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),$({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Hh,logontype:"%"+n+"%"}})},q=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),A({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Hh,host:"%"+n+"%"}})},N=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:Hh,sid:"%"+n+"%"}})};return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)(af,{onChangeSearchField:function(e){O(e),i([])},onUserGroupSearch:L,value:e.value,index:e.index,onLogonTypeSearch:F,onHostSearch:q,onSIDSearch:N,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(zh,{tokens:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(o/Hh),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(f){case"User/Group":L({search:j,offset:0});break;case"SID":N({search:j,offset:0});break;case"LogonType":F({search:j,offset:0});break;case"Host":q({search:j,offset:0})}else switch(f){case"User/Group":L({search:j,offset:(t-1)*Hh});break;case"SID":N({search:j,offset:(t-1)*Hh});break;case"LogonType":F({search:j,offset:(t-1)*Hh});break;case"Host":q({search:j,offset:(t-1)*Hh})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},rf=a(215),cf=a.n(rf);function of(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(F.a)(e.callbacks))}),[e.callbacks]);var r=function(e){var t=e.id,a=e.active,r=n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{active:a}):Object(k.a)({},e)}));i(r)};return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"auto"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Hide"}),Object(g.jsx)(B.a,{children:"User"}),Object(g.jsx)(B.a,{children:"Domain"}),Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:"Description"}),Object(g.jsx)(B.a,{children:"IP"}),Object(g.jsx)(B.a,{children:"Process Name"}),Object(g.jsx)(B.a,{children:"ID"}),Object(g.jsx)(B.a,{children:"Checkin Times"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(sf,Object(k.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function sf(e){var t=Object(T.a)(C),a=Object(xe.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=Object(Ee.a)(Cj,{onCompleted:function(t){E.success("Updated active status"),e.onEditDeleted({id:e.id,active:!e.active})},onError:function(e){E.error("Operation not allowed")}}),l=Object(u.a)(o,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(La,{onClose:function(){c(!1)},onSubmit:function(){l({variables:{callback_id:e.id,active:!e.active}})},open:r,acceptText:e.active?"Hide":"Restore"}),Object(g.jsxs)(B.a,{children:[e.active?Object(g.jsx)(gc.a,{title:"Hide Callback so it can't be used in Tasking",children:Object(g.jsx)(K.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})})}):Object(g.jsx)(gc.a,{title:"Restore Callback for Tasking",children:Object(g.jsx)(K.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(g.jsx)(Hm.a,{})})})," "]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(g.jsx)(B.a,{children:e.host}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(g.jsx)(B.a,{children:e.ip}),Object(g.jsx)(B.a,{children:e.process_name}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})}),Object(g.jsxs)(B.a,{children:[Object(g.jsxs)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Initial: ",he(e.init_callback,t.user.view_utc_time)]}),Object(g.jsxs)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Latest: ",he(e.last_checkin,t.user.view_utc_time)]})]})]})})}var lf=Object(Pe.a)(Jh||(Jh=Object(q.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n}\n"]))),df=50,uf=Object(Pe.a)(Yh||(Yh=Object(q.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      ...callbackData\n    }\n}\n"])),lf),bf=Object(Pe.a)(Zh||(Zh=Object(q.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),lf),jf=Object(Pe.a)(Xh||(Xh=Object(q.a)(["\n","\nquery domainQuery($operation_id: Int!, $domain: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),lf),pf=Object(Pe.a)(ef||(ef=Object(q.a)(["\n","\nquery domainQuery($operation_id: Int!, $description: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),lf),mf=Object(Pe.a)(tf||(tf=Object(q.a)(["\n","\nquery domainQuery($operation_id: Int!, $ip: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),lf);function hf(e){return Object(g.jsx)(wo,Object(k.a)({label:"Callbacks",iconComponent:Object(g.jsx)(cf.a,{})},e))}var ff,Of,gf,xf,yf,_f,vf,kf=function(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("User"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["User","Domain","Host","Description","IP"],j=function(t,a,n){var r=a||i;switch(n||l){case"User":e.onUserSearch({search:r,offset:0});break;case"Domain":e.onDomainSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0});break;case"Description":e.onDescriptionSearch({search:r,offset:0});break;case"IP":e.onIPSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User";t.has("search")&&(r(t.get("search")),a=t.get("search")),console.log(t.get("searchField")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User"),e.onChangeSearchField("User"),e.changeSearchParam("searchField","User")),j(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(Ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsx)(y,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:j,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:j,children:Object(g.jsx)(Qs.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(Ft.a,{item:!0,xs:6,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search Callbacks by"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},wf=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("User"),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(T.a)(C),y=function(e){E.dismiss(),l(e.callback_aggregate.aggregate.count),i(e.callback)},_=function(e){E.dismiss(),E.error("Failed to fetch data for search"),console.log(e)},v=Object(At.a)(uf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),w=Object(u.a)(v,1)[0],S=Object(At.a)(jf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),D=Object(u.a)(S,1)[0],I=Object(At.a)(pf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),$=Object(u.a)(I,1)[0],P=Object(At.a)(bf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),A=Object(u.a)(P,1)[0],L=Object(At.a)(mf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),F=Object(u.a)(L,1)[0],q=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),w({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:df,user:"%"+n+"%"}})},N=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:df,domain:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),A({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:df,host:"%"+n+"%"}})},B=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),$({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:df,description:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),F({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:df,ip:"%"+n+"%"}})};return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)(kf,{onChangeSearchField:function(e){O(e),i([])},onUserSearch:q,onIPSearch:z,value:e.value,index:e.index,onDomainSearch:N,onHostSearch:R,onDescriptionSearch:B,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(of,{callbacks:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"5px",paddingBottom:"5px"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(o/df),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(f){case"User":q({search:j,offset:0});break;case"Domain":N({search:j,offset:0});break;case"Description":B({search:j,offset:0});break;case"Host":R({search:j,offset:0});break;case"IP":z({search:j,offset:0})}else switch(f){case"User":q({search:j,offset:(t-1)*df});break;case"Domain":N({search:j,offset:(t-1)*df});break;case"Description":B({search:j,offset:(t-1)*df});break;case"Host":R({search:j,offset:(t-1)*df});break;case"IP":z({search:j,offset:(t-1)*df})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},Cf=a(282),Sf=a.n(Cf);function Df(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(o.useEffect)((function(){i(Object(F.a)(e.artifacts))}),[e.artifacts]),Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{},children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Type"}),Object(g.jsx)(B.a,{children:"Command"}),Object(g.jsx)(B.a,{children:"Task"}),Object(g.jsx)(B.a,{children:"Callback"}),Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:"Artifact"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(If,Object(k.a)({},e),"cred"+e.id)}))})]})})}function If(e){return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.artifact.name})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.task.callback_id,children:e.task.callback_id})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.host})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.artifact_instance_text})})]})})}var Tf=Object(Pe.a)(ff||(ff=Object(q.a)(["\nfragment artifactData on taskartifact{\n    id\n    artifact_instance_text\n    host\n    id\n    timestamp\n    artifact {\n        name\n        description\n    }\n    task {\n        id\n        callback_id\n        command {\n            cmd\n        }\n    }\n}\n"]))),$f=100,Pf=Object(Pe.a)(Of||(Of=Object(q.a)(["\n","\nquery artifactQuery($operation_id: Int!, $artifact: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      ...artifactData\n    }\n}\n"])),Tf),Af=Object(Pe.a)(gf||(gf=Object(q.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Tf),Ef=Object(Pe.a)(xf||(xf=Object(q.a)(["\n","\nquery commandQuery($operation_id: Int!, $command: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Tf),Lf=Object(Pe.a)(yf||(yf=Object(q.a)(["\n","\nquery typeQuery($operation_id: Int!, $type: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Tf),Ff=Object(Pe.a)(_f||(_f=Object(q.a)(["\n","\nquery taskQuery($operation_id: Int!, $task_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Tf),qf=Object(Pe.a)(vf||(vf=Object(q.a)(["\n","\nquery taskQuery($operation_id: Int!, $callback_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),Tf);function Nf(e){return Object(g.jsx)(wo,Object(k.a)({label:"Artifacts",iconComponent:Object(g.jsx)(Sf.a,{})},e))}var Rf,Bf,zf,Wf=function(e){var t=Object(xe.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Artifact"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Artifact","Command","Host","Type","Task","Callback"],j=function(t,a,n){var r=a||i;switch(n||l){case"Artifact":e.onArtifactSearch({search:r,offset:0});break;case"Command":e.onCommandSearch({search:r,offset:0});break;case"Host":e.onHostSearch({search:r,offset:0});break;case"Type":e.onTypeSearch({search:r,offset:0});break;case"Task":e.onTaskSearch({search:r,offset:0});break;case"Callback":e.onCallbackSearch({search:r,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Artifact";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Artifact"),e.onChangeSearchField("Artifact"),e.changeSearchParam("searchField","Artifact")),j(0,a,n)}}),[e.value,e.index]),Object(g.jsxs)(Ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(g.jsx)(Ft.a,{item:!0,xs:6,children:Object(g.jsx)(y,{placeholder:"Search...",value:i,onChange:function(t,a,n){r(a),e.changeSearchParam("search",a)},onEnter:j,name:"Search...",InputProps:{endAdornment:Object(g.jsx)(s.a.Fragment,{children:Object(g.jsx)(gc.a,{title:"Search",children:Object(g.jsx)(K.a,{onClick:j,children:Object(g.jsx)(Qs.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(g.jsxs)(Ft.a,{item:!0,xs:6,children:[Object(g.jsx)(_p.a,{component:"legend",children:"Search Artifacts by"}),Object(g.jsx)(Lt.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"searchopt"+e)}))})]})]})},Mf=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Artifact"),h=Object(u.a)(m,2),f=h[0],O=h[1],x=Object(T.a)(C),y=function(e){E.dismiss(),l(e.taskartifact_aggregate.aggregate.count),i(e.taskartifact)},_=function(e){E.dismiss(),E.error("Failed to fetch data for search"),console.log(e)},v=Object(At.a)(Pf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),w=Object(u.a)(v,1)[0],S=Object(At.a)(Ef,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),D=Object(u.a)(S,1)[0],I=Object(At.a)(Lf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),$=Object(u.a)(I,1)[0],P=Object(At.a)(Af,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),A=Object(u.a)(P,1)[0],L=Object(At.a)(Ff,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),F=Object(u.a)(L,1)[0],q=Object(At.a)(qf,{fetchPolicy:"no-cache",onCompleted:y,onError:_}),N=Object(u.a)(q,1)[0],R=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),w({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:$f,artifact:"%"+n+"%"}})},B=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:$f,command:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),A({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:$f,host:"%"+n+"%"}})},W=function(e){var t=e.search,a=e.offset;E.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),$({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:$f,type:"%"+n+"%"}})},M=function(e){var t=e.search,a=e.offset;""!==t?(E.info("Searching...",{persist:!0}),p(t),F({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:$f,task_id:parseInt(t)}})):E.warning("Must specify a task number")},H=function(e){var t=e.search,a=e.offset;""!==t?(E.info("Searching...",{persist:!0}),p(t),N({variables:{operation_id:x.user.current_operation_id,offset:a,fetchLimit:$f,callback_id:t}})):E.warning("Must specify a callback number")};return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)(Wf,{onChangeSearchField:function(e){O(e),i([])},onArtifactSearch:R,onTaskSearch:M,value:e.value,index:e.index,onCommandSearch:B,onHostSearch:z,onTypeSearch:W,onCallbackSearch:H,changeSearchParam:e.changeSearchParam}),Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(Df,{artifacts:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"5px",paddingBottom:"10px"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(o/$f),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(f){case"Artifact":R({search:j,offset:0});break;case"Command":B({search:j,offset:0});break;case"Type":W({search:j,offset:0});break;case"Host":z({search:j,offset:0});break;case"Task":M({search:j,offset:0});break;case"Callback":H({search:j,offset:0})}else switch(f){case"Artifact":R({search:j,offset:(t-1)*$f});break;case"Command":B({search:j,offset:(t-1)*$f});break;case"Type":W({search:j,offset:(t-1)*$f});break;case"Host":z({search:j,offset:(t-1)*$f});break;case"Task":M({search:j,offset:(t-1)*$f});break;case"Callback":H({search:j,offset:(t-1)*$f})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},Hf=Object(Pe.a)(Rf||(Rf=Object(q.a)(["\nmutation StopSocksMutation($callback_id: Int!){\n    stop_socks(callback_id: $callback_id){\n        status\n        error\n    }\n}\n"])));function Uf(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(F.a)(e.callbacks))}),[e.callbacks]);var r=function(e){var t=e.id,a=(e.active,n.map((function(e){return e.id===t?Object(k.a)(Object(k.a)({},e),{},{port:null}):Object(k.a)({},e)})));i(a)};return Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(g.jsxs)(N.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"5rem"},children:"Stop"}),Object(g.jsx)(B.a,{children:"User"}),Object(g.jsx)(B.a,{children:"Domain"}),Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:"Description"}),Object(g.jsx)(B.a,{children:"ID"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsx)(Vf,Object(k.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function Vf(e){var t=Object(xe.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(Ee.a)(Hf,{onCompleted:function(t){E.success("Stopped Socks on that Port"),e.onEditDeleted({id:e.id})},onError:function(e){E.error("Operation not allowed")}}),o=Object(u.a)(c,1)[0];return Object(g.jsx)(s.a.Fragment,{children:Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(La,{onClose:function(){r(!1)},onSubmit:function(){o({variables:{callback_id:e.id}})},open:i,acceptText:"Stop Socks"}),Object(g.jsxs)(B.a,{children:[e.port?Object(g.jsx)(gc.a,{title:"Stop Socks Port on Mythic Server",children:Object(g.jsx)(K.a,{size:"small",onClick:function(){r(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(g.jsx)(te.a,{})})}):null," "]}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(g.jsx)(B.a,{children:e.host}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Q.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Us.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})})]})})}var Gf=Object(Pe.a)(Bf||(Bf=Object(q.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n    port\n}\n"]))),Kf=Object(Pe.a)(zf||(zf=Object(q.a)(["\n","\nquery userQuery($operation_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      ...callbackData\n    }\n}\n"])),Gf);function Qf(e){return Object(g.jsx)(wo,Object(k.a)({label:"SOCKS",iconComponent:Object(g.jsx)(ca.a,{icon:oa.z,size:"lg"})},e))}var Jf=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(T.a)(C),j=Object(At.a)(Kf,{fetchPolicy:"network-only",onCompleted:function(e){E.dismiss(),0===e.callback_aggregate.aggregate.count&&E.info("No Socks Running"),d(e.callback_aggregate.aggregate.count),i(e.callback)},onError:function(e){E.error("Failed to fetch data for socks"),console.log(e)}}),p=Object(u.a)(j,1)[0];Object(o.useEffect)((function(){e.value===e.index&&p({variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}})}),[e.value,e.index]);return Object(g.jsxs)(_o,Object(k.a)(Object(k.a)({},e),{},{children:[Object(g.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(g.jsx)(Uf,{callbacks:n}):Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(g.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(g.jsx)(Ql.a,{count:Math.ceil(l/20),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){p(1===t?{variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}}:{variables:{offset:20*(t-1),operation_id:b.user.current_operation_id,fetchLimit:20}})},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(g.jsxs)(Q.a,{style:{paddingLeft:"10px"},children:["Total Results: ",l]})]})]}))},Yf=Object(Ge.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function Zf(e){var t=Yf(),a=["callbacks","tasks","files","credentials","keylogs","artifacts","tokens","socks"],n=new URLSearchParams(window.location.search),i=n.get("tab"),r=a.findIndex((function(e){return e===i})),c=-1===r?0:r,o=function(t,a){n.set(t,a);var i=window.location.pathname+"?"+n.toString();e.history.push(i)};return Object(g.jsxs)("div",{className:t.root,style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(g.jsx)(cu.a,{position:"static",color:"default",children:Object(g.jsx)(ou.a,{value:c,onChange:function(t,i){n.set("tab",a[i]);var r=window.location.pathname+"?"+n.toString();e.history.push(r)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e){case"tasks":return Object(g.jsx)(Sp,{},"taskstab");case"files":return Object(g.jsx)(Sm,{},"filestab");case"credentials":return Object(g.jsx)(rh,{},"credentialstab");case"keylogs":return Object(g.jsx)(kh,{},"keylogstab");case"tokens":return Object(g.jsx)(Qh,{},"tokenstab");case"callbacks":return Object(g.jsx)(hf,{},"callbackstab");case"artifacts":return Object(g.jsx)(Nf,{},"artifactstab");case"socks":return Object(g.jsx)(Qf,{},"sockstab");default:return null}}))})}),a.map((function(e,t){switch(e){case"tasks":return Object(g.jsx)(Pp,{index:t,value:c,changeSearchParam:o},"taskspanel");case"callbacks":return Object(g.jsx)(wf,{index:t,value:c,changeSearchParam:o},"callbackspanel");case"files":return Object(g.jsx)(Bm,{index:t,value:c,changeSearchParam:o},"filespanel");case"credentials":return Object(g.jsx)(ph,{index:t,value:c,changeSearchParam:o},"credentialspanel");case"keylogs":return Object(g.jsx)(Th,{index:t,value:c,changeSearchParam:o},"keylogspanel");case"tokens":return Object(g.jsx)(nf,{index:t,value:c,changeSearchParam:o},"tokenspanel");case"artifacts":return Object(g.jsx)(Mf,{index:t,value:c,changeSearchParam:o},"artifactspanel");case"socks":return Object(g.jsx)(Jf,{index:t,value:c,changeSearchParam:o},"sockspanel");default:return null}}))]})}var Xf,eO,tO=a(470),aO=a.n(tO),nO=a(472),iO=a.n(nO),rO=a(40),cO=a(890),oO=a(474),sO=a.n(oO),lO=a(475),dO=a.n(lO),uO=a(478),bO=a.n(uO),jO=a(469),pO=a.n(jO),mO=Object(Pe.a)(Xf||(Xf=Object(q.a)(['\nsubscription MySubscription($operation_id: Int!) {\n  operationeventlog_aggregate(where: {deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}, operation_id: {_eq: $operation_id}}) {\n    aggregate{\n        count\n    }\n  }\n}\n ']))),hO=Object(Ge.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function fO(e){var t,a=Object(T.a)(C),n=hO(),i=Object(ct.a)(mO,{variables:{operation_id:(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.current_operation_id)||0},onError:function(e){E.error("Mythic encountered an error getting event log messages: "+e.toString()),console.error(e)}}),r=i.loading,c=i.error,o=i.data;return Object(g.jsx)(K.a,{color:"inherit",component:rO.b,to:"/new/EventFeed",style:{float:"right"},children:Object(g.jsx)(gc.a,{title:"Event Feed",arrow:!0,classes:{tooltip:n.tooltip,arrow:n.arrow},children:r?Object(g.jsx)(Ye.a,{color:"secondary",badgeContent:0,children:Object(g.jsx)(Ca.a,{size:20,thickness:4})}):c?Object(g.jsx)(Ye.a,{color:"secondary",badgeContent:0,children:Object(g.jsx)(vu.a,{})}):Object(g.jsx)(Ye.a,{badgeContent:o.operationeventlog_aggregate.aggregate.count,color:"error",children:Object(g.jsx)(pO.a,{})})})})}var OO=Object(Pe.a)(eO||(eO=Object(q.a)(["\nsubscription EventFeedNotificationSubscription($fromNow: timestamp!, $operation_id: Int!) {\n  operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    operator {\n        username\n    }\n    message\n    level\n    resolved\n    source\n  }\n}\n "])));function gO(e){var t,a=Object(T.a)(C),n=s.a.useRef((new Date).toISOString()),i=Object(ct.a)(OO,{variables:{fromNow:n.current,operation_id:(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onError:function(e){E.warning("Failed to get event notifications")}}),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){if(!r&&!c&&l&&l.operationeventlog.length>0){if("debug"===l.operationeventlog[0].source)return;if(l.operationeventlog[0].operator){var e=l.operationeventlog[0].operator.username+":"+l.operationeventlog[0].message;E.toast(e,l.operationeventlog[0].level,{autoHideDuration:2e3})}else l.operationeventlog[0].operator||E.toast(l.operationeventlog[0].message,l.operationeventlog[0].level,{autoHideDuration:3e3})}else c&&(console.error(c),E.warning("Mythic encountered an error getting operational event stream",{autoHideDuration:2e3}))}),[r,l,c,a.user]),null}var xO,yO=a(473),_O=a.n(yO),vO=["title","titleId"];function kO(){return(kO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function wO(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function CO(e,t){var a=e.title,n=e.titleId,i=wO(e,vO);return o.createElement("svg",kO({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"80px",height:"66px",viewBox:"0 0 80 66",enableBackground:"new 0 0 80 66",xmlSpace:"preserve",ref:t,"aria-labelledby":n},i),a?o.createElement("title",{id:n},a):null,xO||(xO=o.createElement("image",{id:"image0",width:80,height:66,x:0,y:0,href:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABCCAYAAADAD1E9AAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAA CXBIWXMAAC4jAAAuIwF4pT92AAAAAW9yTlQBz6J3mgAAJBNJREFUeNrtnHmUHFd97z+/e6uql9k0 I41leZG1L9MaLR7JeMMeYyDGduwQkCAsTgwBAu+FlxwekDxMmBDgASEJO4hgjDHbk4JZYgwOCRov eJ2xZNmjfbMlaxstM+qZ6e6quvf3/uhuebRhY3iBd05+59Q56pqqunW/97d+768E/4miYACGpl7e uobu4D9z7P/vRVluAY5mF08bjBa/sXquCuh/yfNIHTyAg+GS7xzkwlnV8/+lhc8rSlfYU9O0A/kL 7zxgFn2ier4Q/bbf7XdalOV2K7My9d/7sxfesd8s2vHbfq/fWVEQBaN0B6vguMnunNY9Ya9d+LMj LNbDLDyveu1/me5xqYLWFeo40AAGm5bOffaci3ueDReVR1ii+8LFy6rXd4W/7Xf+TYq82BsVzAYK QYGBuH5uX+OSdkp6nce/UZXLz/Vh9lni2Ib28inJuscGKETjr689R3rptt1AP0WhC+iHHOXj71Yi q130OwH/2wbsNyLjTVDB7GbhNbtN5x17pPPwEIt1iEVaYonukc6+vdklFwAMjAsaCrKG7mB8dH4h sqanJ/hdS31+JQ3U6vUi4Pc3LjwrHeNt6vWmHGaOBUooIVARBZF/ONevf6+AKl2h0J8ArGK5hdWs AAewna4WE7rpQVJucRe0WX/eBGu2Hw79YGmSd36yNAexP7ZrZ5mhRzrhAEAfhEsh+W2D9ysBWAMP Ad1tFv13VD8xQU1+VDwV1ThCokCEEvoLCXjP+cn6R6qT7QqX1sBbQ3dwFb0pwC4KV3kx7wKutNAe KkhgIGOQksd6xTSFaPEw/mVLqPz+1aPp/Q9/K7jzm399PhxRsFJbhN+mvGBz6KXbCugus+CjE735 nKrmD5OOOvU0Y6IK/omK6vKpuv7y85P1j/TV8r86eFoDby9d+e0s+E4W+/NmNa8V1fZUNRlD47HU VcZG48qId/EwPj5ajpOj5NLhzXvidPBwvmXm9LeXmb1he/PiZQKu7gL01/Dlv668oIHrJvi07Xxb m7dfOURaUbBt2GCoQbaLas8Fo098sz6ZfrqCOnDwnOZtZUm7Ibl/EsHcQdIUiDNIPotBzfHBSNRT RknRVCIxuTg2whZSzqOx+SyOHCsPuabGWfOLjx7eyqzMbLZVlOVWWP2frpHPC2B98jsyC+dK7DcC qCp5sVLJysenjq37XyKidaChPxXQ58DHCHilx2yVf3m8Te2iI+JGUc23iJWi1S14fiBnZTdp6kI9 VFmkxlys6MImNYFTT7k1+JYsPP9bfvMB44+OfURSzm6ZZGadfWD96IkLjYwf+7cuCtJTM/MdsuCe QRbpNhZU9ppFurPpwpufu64rPJMZ1VmXrRT+6QiLdAuF0S0U9GnTqTsaF3/gTGNvb148e1O28+NH 7GLdYhb8z/r5TZMv/Ket4YI3AwxQmLqBwhc2NSz6+ObswpcC9PwuRem+WtK7LVh4zT4W6nYWlA/K It3VvOSWKiizMr/shesVyWY6522Rgm6Wgm6mkOwxC3VH24Vvq183QCGqH30nJdobmxf97SYpPACw feKSl+9vvPQsgIEZl099SjqKu8JO3di4uGdT2+Lle+ma9DsFYj3n2ioL7nmWTt3JAt1mFmw4+e91 TT25jKuDsZnCP+6nUzfSMbKPTt2WXXh7DeDodLxgD5itzMrUtXqDLfzrQKYwa0O285Ynmxa+9cnc gtdtiTp1gyns2XPRqydubl68bHtr19QXMT8Zf/CbDEZ1IDZGnZ1bqWrOflmo28NFNwPsZ2FDzxlW evx5BdlIx+btFHSADt0khXR38+LZ1b/98rKuvgADYcdLNuYXXf8Ec6c/aToOPSnzKxuY//XdXJJ7 bpyeX6p1PWBWgV1Dd1BN4k8PloKpJ/m/VnQfKFQrhy3M/fABWaibpaO0Sxbo5uzCnj44PvE1EAxA 4+Y53ZM2ZDqv3RIWFsNzlccG5s8eoCMZYL7bSUE30HHfySD/Mjm58lAwe+nKP/f7zGDUF6HvDAv1 4HmX5B5h3sRHmDdxgELbzmnd2ZPH6nueRT4tK6IgDAwkAH5ay42lXWMoGpbw2ljmQy5a8JaBOL5D 2dIVdHbPwphs8MT+c72VYmB4KcAww7UcTc4OIYghthBJ3m5iDK6ny/bQ/7y1bTWCVyP5quPJc//Y GrqDQXpVaon5ybIKbDvdspTe4+nU2sz82b4iL1H0EkQWsnf4AjCNoJTwWnrm4EifdGxDdU2M/lDY 9CT0+/HFwAsCcBtEs6GygRnvyux6dOEY850iFuBYoC6K/fmNmP9lP/RRSoeOkP3xQwwhX2+8qPld 5z/0UEnB9DM5hT14vEUsioIKkglSxl6I7p0IIsAKcArytyBXnQG46thdtjrhXvronCe41yFc52IW N2FCCySqxKr46psBYL22RZipFnnZEP7vHqXjRyn2lqX0P6lg/hboOYnQOAXAu2uJ6Tq4KnPx7C/o K9+Cfn616JESBAEYbJljLlnW4YIjR71+YVV2FL7cwe538lDVpITetK/mQ02YGY7TFFVjYoRkKJn3 q8F3CpjKaXK9VSy3BTZYYSCGfv9YtnMGcfpRfLqiCWNSVUoow6QJ1TpaaxScqdm/JiK+jFcgEIga kRtGSG54SOa+X/zmT9YXaDwrdIJ/6aMrvJZtlY0XXzPNEvzIXlggHhpK/ZHdRhsiNFU09hC0WPfY 7qj8uU9lHY1k58/+OMBOurN1k7qLfgeQJrolVd1nIBgh9SJctfGsiy5ZSn/SN86XvVhZxXK7ikK0 gtWuwEC8c1p39tGg8DdaTjY1efN6j5ohfFLEl1O0DBJkMPkmCRomSJBtMUHUZIKoSWymGZPLKnmn zjp8MkwapyitGnziQeatrFtDzzjcjjvfesWxc1p3dmTX/vUNE7KzR4eKibI9lFwnlBwgqvX7BLQp SBtHfDAm+qVO99S7+ugKu8ZVInXfsdYU/nmCmj89ihvLqeRLWdmdOWfC5YUdDzxTDQDdFtoVViug Z6omnks1lksvg9JNrzs+VmtXixup3ITz72lVc8GwOrwQA4KqzWFMJMIonlR0lyjrxcpmacscJLAV LSXZdLgyXY25osGbQuqVCpqAWpC0FRsdxX35Uja+cxXYOpskJ6vlelnwswliXj7kkwrGZHRyFvaV qKm8BAgpqtXJqCJCI1ZKefOWhaNP3DYAUQekdae/AtzazPzZPmaLKChUskimbGRII/sXS8vrbz8J JNNPlx1PqEKVVN1Bv19xEgPzaENhsa/ozeL1j5rUtMfqKYsm1YITm1djnYHE8pA1cqd4u6bt3IkD 03f1ls+k1Q9NWHKDK8afbnQ6fQSfUM064laCaNi4913qN/59XTlkfP24ziz4Uqs3f3aUtIKQUSPg PIhQu7Ai1uwUp/PGgehFMQGGtD37J0sG+2+vAlEt7usD9Zn572z19otHcV4hDiCbw1AUP+Atd0jG 3NMwjQ2FgRMZ69OZ7LRoYJ5TfaV4XW49lzRgGFVPIpoqOAGTVROGYigb32ubgg9dOPTkfeOf0wPm SroNQBNFKdKk3bRrnZAYKCyPDm/b8K9NFX1lUXwCahVMgCCBufDSZMPaPrpCqWvfOlP4YIPKh+uI SzVoplUwNGnTIFc0/quxYWZTylXH8CnPBSEHahujiNKE8FNLDva/F6q5YIGBuK6JjzD//S2Yj5fw JGgZkCwmkxXDsHg8bEN4SoSNzvKMzUdF3xSKJK7BHy5PUefniGcR6PwWrKQKIzivSCyIAQ2yGBNh GMFtiaz50IVu4Lt1wK6ny+6g3y8HXw8cp1kjuZtZ0bVsqwD0BvPXNKR0j+ITAW3ARGOi916hm7qp Kl9VHreF+yZ5+9JDmnhA1EilwUu2ukKWQevul8bodoYrX03QuGb+luPlnHpFtZXADgW6Jp+X1xaO DRwZoBB1MJD8bbXc8w/bwmvF+5Ut2LYxPDG+DKSo5jOIicQgVP2Jr/Hfte0+VCFBKaN4tCSI92g2 wtgMQoySivZbYz6/zHXcUdMm6TuJXnthwakQrWAg/llrV0s0PLrFes5KUAdKg1ibWr3m0nTTPdID pgf8PZMXNkw6lHwXxyvymEzJco9X/0P18jKLbgpasw+WRyrfbEpoq8fwSo2zq4FoVERRkiZMVDR6 UIxdflH65H09YK7s7jb0wlX0pvfT2RqZ+K+ccnMTtl2AMTwpJKjUCFg1PBfkaqmLqKICZDKIyWJI UcbQA8ZwV8bwjQvTjcdN9eSg9qvK3czKXMu2yr3ZjjfmK/rNojoH4hoxUQm980o2vUbG+yuAvuyC R9rLXHTUsnKxe+rP6g97WObfNV3D63aH6TZNOapKhOX8vJe2snpSUSe1vWEgjpRIBeJQ3n9JvPGT 9QkB1LXhfjpbA5vcgJcbVLnYIufka5h5OCHJNYBBUIFRPB7daYV7ReyPMy789yWsG6qbYB9dwa8D 3OnkP8y8J7NeFpTExxYiD8da1c0SqPqHHvBruruD/H0HNjRhZpu2aNm8Q2v7FMzaSUvO1lH33mwQ 3Fkqjqhe0LxY89kJfuOhkJxt0cTd3JhKc4xSEfWCGF+NxEGLWooTwh/lr+34k4Xf/vbRVSy3y4F+ dpgTWetCY0QyX61dKKrzVZmm0CyKVSERI8NGeVrEbLCGda1JZePsmp+q3t8dNFGUX9VUn0/q6d1/ BHM/0OTMR4bVJYqaPMYaeFU9jZHVYFaAe5h5X74gyL7j6Fm2q2Nv/+NrmJa9il3lxyZ3zogPlD9i zm18Xf7Z3SblELnJF1I+MPo/4saoRWO/xHudk00plPGeqlP3Cq7J2HCkyRzR4eTPL2fTt+vF/2ow M+gyL3bPdxXYo3SZVmb4Ff+P6Pw6gP/eWLgqGHU/r6gHiJvERono/wygntBV1T2g4c93+9Gj5mg4 E3j8KnaVH2TuNcmB5O6JjXkZfHYtlSuuTcy5Z8uR73xN7Dld/83tLeZEbIXArCkFvpRNZWkJ70As gjnmXWyH07YGCb51v86dL2z+YA+YD4GXWsVSX8QZdBmAIk06SK8uB10N0k63NFEUgHGR1EG/U/rN 8/Ub3kuv7/l1Nuaj6EC5NOaME+sF9YDzTDw+aI31EKE/wfPXd5eqjUH3h/O6bGp+Io2WweLGUst7 P5DNdnaEQfskBjMh/usr52TOX4rZPUqa+FkuY/51TP2wddLiRL1WXVekCBX1TCG65T4zL3uF3/Te 5RSiVXS4FayuVxSOGqCnSu8pZ/roCos01RiZ3ucFZxWFaAMD6YsBMvVxqIr1aFXbBNQgJ6xaTRPr u2oVAJNwW9BgGSk+XWm4/tU5n4nYc9MbaXjtm2n5g2vZ9/WVzuwbgYzxQcWHLnEXY2QP0FJTazXV 0u9QYvj5vqxuNTYaW1tcPKHAuiEYYBWFaDkDyQt1+mvoDu6l19f9XR9d4RAj8731BVWZJl5zABIE Ra9staFb//Lylh0ram0lK+kK3/ECfeUggwbAl3VBI4YRSV299giRA6clIusJ8H1m/jubvfniMeNi 9S60Myf6ePvDYphtHFtp/9+f4th9DxH/5HuYpgIUUwTURHanS/xUVAMDmEwwCPpgEvtA8ZNAQlWa xMjq5iVX9Czt/0qta6HK4dXfo5t2XQ20MygAWyjKPvpdXYP+LZh7maT6BkVeATq7QSy2FsXrK5Gg jOIrwGNi9BtPu6avv4P+pD7WmWixk4G+2859MOu4ZAxNQSWLsXmk+xQA65XJPZMXNmQOVjZHKudW 8GSNxfoK5UmN+LJ3QdcFNmybQGXHHtwTOyHMI6kqqkLGljVrheE4oyKISCJewxzmOBflUCIxFAO/ i3zwyahlwndf+swDR1+IVvwsmPd73ukHQuSlGQwxnriaXDtUfNWQ6kaFMWAzGKwIRdwOY8z7rnGb vlddtEJ0lKy2MsNTW6xBBs1RsloH767MvE/lK/qeMXyqggSIVfSZV2k0+xQA67Vrr5n31y3efGwY lxiRBCsbNWOOKdodjO4W87rXuNzcmfbwh/8GE8wF1apnrZbIUvcHSA0xAUUd481UVUMkzIqhaPUw gb3HGelVa54yiezPFaaUx8bGCHcczbtQztNK2qHw6lzKK1BlDO+pkgv1klRUTqH3a29W3buOVIIQ YUz89zNnN/zl1fvWPn2mhfphw4LJJo4/nUvl9WPqHCJWVSsTCDIp+sGr2fyREwbrqeWD97d0trpi ss16bfOhqM2Fe+Ji5RjGbKYhfECbg1tkz9q21o990sdDx8zQJz+CnbQQDtUIjrxVP5aIiKm+fh3E 4yLHf6rgRcUFEOawqEBJPIlqSbImJlU08dlITCaL4FQZwTmqm/kn+PAThlCtrxumivLxaA/4JmxQ DHyJjP2cj5PvhhdM2eNarNrdh1rccNqhibtOlTc0qmkq4pxUy9ZyBpN16I5rieYLA/EJANZ93380 FD7eMpq+fxiNRSQSBKNKCwGHiR+yhcnf1IGHv2Aue5m2v+tm2f3Gd2Dy56BjMWQjKBcxjS24kXSc Bsopk9RxM1JRp1plUoDghDpOBFe9ulbmEVYfW4tSp9GeOngYSRCKeSdtJfE4iIFIIbZKlMdUK5tA hgiMauwbc0oYqFTLSyExaKhQCZAMoBODYOklycbHV9IVnrCHu5gnkn9vWLBQYndHpT0rGnvjnRcv 4ET9mLjKRILplcHiI27ebA3W3jujYcXr00o+Zyp9/4aZPovk0Hqa3/w6ggXTKa27B2mZglYcKlK1 7tNojFaRMghWBPGCqqh3gnpBvVbvVAjqnbA67qh7Oz3pAFUB6wNzb2r5gfN6SaOaIMbHCoEHXwGn otZ6zUrqc6jaWLyviKYqqCjiUdeAiRLRUrMNX355uvHheoAxddNdSn+yEkLS5BuZpCzJgScSn1RE A4NWY4PxKmYMcOglprmxDyAZGvL5hQVSwGeq6zHhZVdQGavuHGnqahSznjrB+r9r2qSqOFVRVeMV q7XDg1UwKtXsuX4891vxqrX3HPdvwKlqJtZrXKottiG38Jj4+xvFRpGIQRQVRVWTVDROhdihiao4 VcQrQYgEjQRhLPS2Zxo7rkw33jc+OhuAOrE4PTv/9Y2VZFF5Rnt81kc/EZrL5uDSQ2hzhEdURSxW 8JDXcmXMA/HBQTKT2/GA27SP3NW/T9DWSnnVQ8D5aKIn7ATVJ+j15ElXc5M6p38qUCdefwJQOu75 9f6C6n2iAmPi3EQvb/MjY295tW69YljdWyvqN0dqbIOaMIcNM2qiSCXKYsM8JsxjAkAd3CdWXnO9 br3qkvK6XX0n5ZAnlj+TGqake/aQv+hKSgcPEf9iPRK140dTF4AFOTRmvMHJqCvHzQGQDA2Ty1Ub BDxPE86+kTRJSNlKEM3Fez+uUDzJ5E7jt07n1E6bXdd9ayDV+Bu7uivgpMcIIAdwaQv2L3/M3H+7 js1fW0Xhm5BcXUJfKWgHRiYJYkT1mAo7A+SxZs+al7N1Q20TQdbQbcfvM58CoDs4OslkpjL03V4c O7HMRlOv4rEqQpgxt5Uq6ftzmLWlcnyJADZJDMYcr41UwJUrVToqNFCuuX8ZP7dfAaRTQK6vhEIu QEspniLGtqDOj3uSGd/sZhRcBcUF8gFSflqrSn5SO04s7sa9TA+YKXTZd9CfnC7pNgCD9FYDovMz 0ooDAgnOWQxG1HvVSIR8Nvjr0dQtzogImF0+SS8bBSQIAxfHtfEvoLRxO25sDOFs/GipaoKcbHYn mtx4s6sex33TCff5Wp7uFTQKcKUYUBouvRB1Hjm/GZk9CZk5EVoiVNNxz9dgDOes18vvaVpwPcA3 WNhwuj6ZVWBXUYhWVrts/S8r+wLgeMO3ep2TAN6KZ+9IAqJ5TJQY+lzqi5NTc82RQB92vjw1l23I HAUXtLbY5FgRB0Rzz2ast5ehmRdgF8wkfWonomEVFTlVx/Qkuz7VpE9SQan6UAktPjJovIspt3yY Qw88QsoO/O7n/GgI2GlL0CMl9FgMiAho4j2V0cqngLtuYv1oD5huTuzVWQEeBl4QPRbUS7efZgqz 0jiePYZqzplMJAHHtGb81myKnVvmsWDZk6YyKxNYFIjaJ3Fs565qdlqOESYzdOt3EDMJkTzq/Sno nJgLnr4v6GSzxwjqEkxrHm3LUdrez7x//AzFAwcZ6v0xLRe/nKZLuzSc3C5pqczQLx6l+LMfVYGc uhj/zBCIDSqqcaOXuXcGsz/5h+nW93VQCKrdDC+OvTZfocsCOJfOasFmQxHxkdw5Eum7nGFbhCAT s5s1MusBJAxSscHZ6bESBsREESNrn8QC/uAoKgINZ+G9e85cFTxy/NBxB5yav+n49EbAq8e7MjJj IqkqI9v7mf/ZLyITJrD3Ex8l2zo/ToeKcenQYR+Xy3HjnNlJR89fsfjHPyG4/JWUn1mHXjCBVBO8 aDhM6nH63h9l5rxqBQPx3eO+6fuVAazb93Xp5p8eEfcXPpDDbRMa3ndtZfOXpDVzW4NYdN/oWOn6 zs8cFYf3Pu+sZP1o1S2kpTLp4WGUyfiyx6vgxxwqpg6SesTrGYDyosd95AnpDYpa0Mgg7Tlkejul Hf34oY10feu7hOdM0U1v+eM0YDq5lCizaW9U/sZX7bEP3RLteMPrwr7L/iAtPrtXF//DR2h+483E T6/DTJ+I1nYcYlVGEr/6rpbOGdeyrbLqRX49erzDFOBGv/UzNkmX7D88UvhBOKcvPVp+136tkA/t gytWr3aj6nekSTpZ47TEhCwpkBSL2LMn4ThQddw1z1YDzFsjYsBUS7UTQRqvoePTG5oCaAnR1OPK T1MaHKC883HOefd7WPbzXh2L42Tta19NM1MD05YlLiZ3udamD9iZy97uFr303XRe1tsgLcFTb38r G7/0VTfnLTcRdl5KvHMtem4zTl2QGJLAa8PwSOnnPy1c0raCgfjFgDie0pfVFMLfY2A3jt3f05mX TdHofaWc+cvLSwMPAzj4VOr4pEH6k3ICIMPrN9AwZyZFwGTt8cCgio9EjEb239NKujijMimGFPS0 BIDWeuxVPa64+Xgtm1t2FVN+70rOWrYUctlk0+o7ZeRLnw1b2jrwGfut/L7KXaORmV46Gl+lR0vt iu4zjH0uOefs708+96rP7P/6V2zQ3OTm/s177OPLHyTzbBEm5uBwKawYG2cdFxzafOiBNe3dF101 2DtyG9OyN7Or/ALxO9WDj/+a6Ad23u9nm+wz1wwNPFEPNt8PZ/+5wbwuSZLLNB94P7bbTPiTmxjb spP4wT4kPwnGHICLEJsKm8Km6CPlYuV2q9i0SnqZk0mFaqmsYpsiclcsoGH+HBqmTdXMxDbS1LmD /Y8z/OlPBRFgZ190f26s8qEjzx5bmop5f4uaiSlVJiJAMAqj6CeCXOYxM63pX4Y3PsyMj37CZdon 2Q1vfysBzdjJ56MHSqhQyavJVEI2TJzY1H3t/rWDK+kKW0/Th/OCAKybdC/dtg5kT43mOg4icy5C /CMJJKgPoCx25rmk2wdBbI3OVBRJJmDCUSu3uow8mBtzt45WW0LseN5Oqry/U6/etGTJXlbATJpA Uhwx5fuesHp4YzWazujqzzfm//d16+//HsAdZuZwozfNRVxJkLCaPZI0YrPGyO1lY76SppXu6Jym jw7vXc+0v/lwnJ18VvT0p79KZWsflgsQsSgkWZWwYhjUXHDTzaObf1qf9xSw0MV4Jvx5AazLyTv7 NQAV0P/DzB+2E9xw0LoyYLwrBcZmRZ3Wt0rrIyQt2LCSMW8qO3dDUyorjuETVMPjtLGIy6qxph5x 2Qe1NtaY1iSaM6s3f277F65bc/cP649dVShE5Y2VR63XRc9ptbpmAhsE5rNHfJo0Yt7zGj8r+zW7 5Y9apjTeVtzzBE1/9MfxhMULZfipDUHxPx4Rt7eIWAtOY4tEVoTY6Lex5qNvibdtGI/H6T7kecFd 6HUG4tvMmRcY/2ObC98Rj5bf1kKwwlkoi5KmHhU8SI0lVoNiMhgS9KkoF72tVIofkloxp+AjxGog T6F8xqnvRk2LZE0SNEX7o+b8460TW+698pGfba2/x2dnzcq8e9u2yqrC8mhsy9qNUaIzYqn1rGBt YMwdx9RVJqj500YbXHl1rdXjVqbfYM5r+mK0Z/25MInoDdeD8+lo/4Am2w4YsZFRpw68aZDAjKkj YddPDPwgKFz+yO6BB57sOb5zeWLMe16pmzDAd+zMR9ucXXbE+D0mE/yFw0VU/B+o15cipj2EIKTK /ZVRvGGfUabk1ZAj6DwQJq9oScw/HsPFChEoBvEzco1TLy098eyZxq/Xoz10Bz30pl/LzTxfKrrJ ePIOkhwShtbcNYovNTmzPBfYa16VbrpnJV3hPvq1B9KVkM/OXvrmZNvhNyS68yVNnJsxzU0kx8pV Og5URZxRX8ksviDbMmuqHdn+DKW1DyBndXz/LQef+sOTNfEFfWpQp7u+aWd9ocGZZYOko9ZzHuX0 X5zX/2by4cAkGhdnM+EsaYyuqGTkbaWs+TrWEKjs0HzwJiuGkSB9603Jtn8asv7hDBIpmnhIchjz bFJ6D8Bna18/9UCwikK0hu6gZ1w92lHbZpRM5hVZL/kUjQMIjTUPFPH5vOM4eKsoRFXQSasWxNgf b+1b+ae688qJL//9OTHmDaPHxr6cWNvnMMUAK3mCICtRQ+WJZ+3gjqfH8i9dFmdedSPu4FOvvvsl V3cArGb5qS2+Z5J6m9c37MzXN3jznTGt9wVqKUBy+eoa/MWNbP3Myffedk7nvOzB0rf+KN3WdWsw 65UZuOPsyW0du+PR0Bwu78GrVSEJVEIVtrxJzy8IvekqltvTtWrU+wy/+ZJXNVcGtm+0I/E5KZAP 7EDs1QWehWcFUfcr0033fpZZmXeP652pa/KVdJvTdSncmp97jo99wad+ieTMErVcHY48017Guem3 fDAZ+tm92eSRn//lTfDpNRBcRbV38pcCWPd738rOmeHKboOFjIfUoy6PyThh7/lh+HuXxRufAmQV mA10S11LVjAQ/2uuMNWWKqVr2TZ4WzhjmbX2hpbmzOePHIvfmS/7D43WTDlCyAf2ytekW+8708Z3 HcCv2hnfyzv+sIjzjVG0P/FqSX3r9DB78ZXJhrX1RX8+tzSlVsaebqxbmdTkpp33edm17qbo6usq 7Z0dmd2f/vvH3wFdPMdGnhnA8XZ+u8x4LKdmaQlfVjRsJrCp6H3LWhpvnD60buhMyed4IMZPaiWE jVM7G0t7RrZbT2sKlSZMJkE/8WZ2/FUPBD21FT7ZEv7ZzHx33stnirg0H4apCW02GYv3Ls42Xbak vG7X6TTv+aT67Um3hUEzhazWfSbAl9o7VgeDu19rL76oYvYezgTP7Lj2TRz7yQl7IlrVHttT9Ymi IJ9jVgRwu5nxD03YpWPiR1XINom1GP3CCt125fShdUN9dIVnytxr/ue4Nq6kK1xVy6ve+MyTRzWy d2eqi5kmKA59We1W3/McTye3MS27goH4y+GcRer1MyN4FSTNpJp1Y3H/Fa0TOl4seDUt0h560x4G 4nfQn3SAfoOFDQCMpH+fNpxN8eG1pvLMUUaDSe+pza3apd8zLsLWzaTW+aS3N81/dTgS31lWH0dI pEAz8vYb2f7PcGLV8nwy/tOAuny1ae6/ZIvpa8aqLcORgdGzCRZez5YdJ9+3sqsr1CeOPhWmOqeM 960SGC+sfpPfvuJkbf915OT3/Hx+1oUylva7SNQnXgKFRoLL/4Ttv1hJVxjUwftaMPPSxvPadqzY 9dh+gFub59/kRir/nKj3kdgIkScavXn7jWx5tAeCamvaCwOvp9Z7eCtzmzzpMpnevF2Plq90Q5U/ GEFdrXWXRrENEzPGf6x8dntbrnHWn5W2PbQC3FfbL5yVPDF0h3XMqQiasUEs3v7dm/yWj/0mwYMq ufxpps8NQtvw35Ntj7tU3x0I+NhXvKjmJcghvhvPL/ZRFvkChcYspXsmYS89FOiIivbh/JxWDc4Z 1ZQsBpsLv/2a0qY3Vlfo+R306Vb0S0zrFszPWjBBKYSMg8T76k66AgbaovBN++Jkcs7LP2CFUcs6 RdOsk6WRUyooYmR46fkTlyx6+tGd1G79TfyHPMvBrgb3j+aCv2tWe0tZPLFQavSSS2rf1GUx2MDe c/PczA0yMBArSBCF5bkk2jZI+gtJNW/gfIWhIZKnAaPiozma/QBAtVt14AUzFSfJxeCfPobfQyIN MaS1BnyMSONZQeaDN5Y3fv+LZvqqMfRJdVrEMcmAxGh/jIwqnNtqw88uevrRnfXA9Zv6Qno1uFVg 93ouHMGtF2XMog0lzKiCVSQtCW3nNuY+JgNPxqsoRMJA/H8BtvEYyTM8EcEAAADoZVhJZk1NACoA AAAIAAcBEgADAAAAAQABAAABGgAFAAAAAQAAAGIBGwAFAAAAAQAAAGoBKAADAAAAAQACAAABMQAC AAAAJAAAAHIBMgACAAAAFAAAAJaHaQAEAAAAAQAAAKoAAAAAAAABLAAAAAEAAAEsAAAAAUFkb2Jl IElsbHVzdHJhdG9yIENDIDIzLjAgKFdpbmRvd3MpADIwMjA6MDI6MTMgMDI6MTA6MDMAAAOQBAAC AAAAFAAAANSgAgAEAAAAAQAAAFCgAwAEAAAAAQAAAEIAAAAAMjAyMDowMjoxMyAwOToxMDowMgB/ /K2cAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTEwLTI3VDE3OjE4OjU4KzAwOjAwCRQNHwAAACV0 RVh0ZGF0ZTptb2RpZnkAMjAyMC0xMC0yN1QxNzoxODo1OCswMDowMHhJtaMAAAAhdEVYdGV4aWY6 RGF0ZVRpbWUAMjAyMDowMjoxMyAwMjoxMDowM+QYGrMAAAAqdEVYdGV4aWY6RGF0ZVRpbWVEaWdp dGl6ZWQAMjAyMDowMjoxMyAwOToxMDowMhsP+NkAAAATdEVYdGV4aWY6RXhpZk9mZnNldAAxNzDS Dd5MAAAAF3RFWHRleGlmOlBpeGVsWERpbWVuc2lvbgA4MIVW3/AAAAAXdEVYdGV4aWY6UGl4ZWxZ RGltZW5zaW9uADY2LyCOzgAAADF0RVh0ZXhpZjpTb2Z0d2FyZQBBZG9iZSBJbGx1c3RyYXRvciBD QyAyMy4wIChXaW5kb3dzKV8EztAAAAAASUVORK5CYII="})))}var SO=o.forwardRef(CO),DO=(a.p,a(476)),IO=a.n(DO),TO=a(891),$O=a(220),PO=a.n($O),AO=a(477),EO=a.n(AO),LO=a(290),FO=a.n(LO),qO=a(479),NO=a.n(qO),RO=a(480),BO=a.n(RO),zO=a(471),WO=a.n(zO),MO=240,HO=Object(Ge.a)((function(e){return{root:{width:"100%"},title:{flexGrow:1},hide:{display:"none"},drawer:{width:MO,flexShrink:0},drawerPaper:{width:MO},drawerHeader:Object(k.a)(Object(k.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),appBar:{width:"100%",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{maxWidth:"calc(100% - ".concat(MO,"px)"),marginLeft:MO,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},nested:{paddingLeft:e.spacing(4)},mythicElement:{},tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function UO(e){var t,a,n,i,r=Object(xe.a)(),c=HO(r),o=s.a.useRef(null),l=s.a.useRef(null),d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState(!1),f=Object(u.a)(h,2),O=f[0],x=f[1],y=Object(T.a)(C),_=Object(T.a)(S),k=s.a.useState(!1),w=Object(u.a)(k,2),D=w[0],$=w[1],P=s.a.useState(!1),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useState(!1),q=Object(u.a)(F,2),N=q[0],R=q[1],B=s.a.useState(!1),z=Object(u.a)(B,2),W=z[0],M=z[1],H=function(){S(!1)},V=function(e){m(!1)},J=function(e){x(!1)};return Object(g.jsxs)(s.a.Fragment,{children:[(null===y||void 0===y||null===(t=y.user)||void 0===t?void 0:t.current_operation_id)?Object(g.jsx)(gO,{}):null,Object(g.jsx)(cu.a,{className:Object(an.default)(c.appBar,Object(Pt.a)({},c.appBarShift,_)),children:(null===y||void 0===y?void 0:y.loggedIn)?Object(g.jsxs)(Gj.a,{variant:"dense",children:[Object(g.jsx)(K.a,{edge:"start",className:Object(an.default)(c.menuButton,_&&c.hide),color:"inherit","aria-label":"menu",onClick:function(){S(!0)},children:Object(g.jsx)(aO.a,{})}),Object(g.jsxs)("div",{style:{width:"100%"},children:[Object(g.jsx)(K.a,{component:rO.b,to:"/new/payloadtypes",color:"inherit",children:Object(g.jsx)(gc.a,{title:"C2 Profiles and Payload Types",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(WO.a,{className:"mythicElement"})})}),Object(g.jsx)(gc.a,{title:"Payloads",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(K.a,{component:rO.b,to:"/new/payloads",color:"inherit",children:Object(g.jsx)(ca.a,{icon:oa.a})})}),Object(g.jsx)(K.a,{component:rO.b,to:"/new/search",color:"inherit",children:Object(g.jsx)(gc.a,{title:"Search Operation",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(Qs.a,{className:"mythicElement"})})}),Object(g.jsx)(K.a,{component:rO.b,to:"/new/search?searchField=Filename&tab=files&location=Downloads",color:"inherit",children:Object(g.jsx)(gc.a,{title:"Files",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(Ep.a,{className:"mythicElement"})})}),Object(g.jsx)(K.a,{component:rO.b,to:"/new/search?searchField=Artifact&tab=artifacts",color:"inherit",children:Object(g.jsx)(gc.a,{title:"Artifacts",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(Sf.a,{className:"mythicElement"})})}),Object(g.jsx)(gc.a,{title:"SOCKS",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(K.a,{component:rO.b,to:"/new/search?tab=socks",color:"inherit",children:Object(g.jsx)(ca.a,{icon:oa.z})})}),Object(g.jsx)(gc.a,{title:"Screenshots",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(K.a,{component:rO.b,to:"/new/search?searchField=Filename&tab=files&location=Screenshots",color:"inherit",children:Object(g.jsx)(ca.a,{icon:oa.d})})}),Object(g.jsx)(K.a,{component:rO.b,to:"/new/callbacks",color:"inherit",children:Object(g.jsx)(gc.a,{title:"Active Callbacks",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(cf.a,{className:"mythicElement"})})}),Object(g.jsx)(gc.a,{title:"Reporting",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(K.a,{component:rO.b,to:"/new/reporting",color:"inherit",children:Object(g.jsx)(ca.a,{icon:oa.s})})}),Object(g.jsx)(b.a,{style:{display:"inline-flex",alignItems:"center",paddingRight:"10px",color:"white"},component:rO.b,to:"/new/operations",children:Object(g.jsx)(Q.a,{children:(null===y||void 0===y||null===(a=y.user)||void 0===a?void 0:a.current_operation)||"No Operation Set"})}),Object(g.jsxs)(ei.a,{id:"menu-appbar",nodeRef:o,anchorEl:function(){return o.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:p,onClose:V,MenuListProps:{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"}},children:[Object(g.jsx)(xt.a,{component:rO.b,to:"/new/settings",onClick:V,name:"settings",children:"User Management"}),Object(g.jsx)(xt.a,{component:rO.b,to:"/new/login",onClick:function(){S(!1),console.log("clicked logout, calling FailedRefresh"),I()},children:"Logout"})]}),Object(g.jsxs)("div",{style:{display:"inline-flex",justifyContent:"flex-end",float:"right"},children:[Object(g.jsx)(K.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){m(!0)},ref:o,color:"inherit",style:{float:"right"},children:Object(g.jsx)(gc.a,{title:"Settings or Logout",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(iO.a,{})})}),Object(g.jsx)(K.a,{"aria-label":"documentation links","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){x(!0)},ref:l,color:"inherit",style:{float:"right"},children:Object(g.jsx)(gc.a,{title:"Help Documentation",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(g.jsx)(_O.a,{})})}),Object(g.jsxs)(ei.a,{id:"menu-appbar",nodeRef:l,anchorEl:function(){return l.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:O,onClose:J,MenuListProps:{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"}},children:[Object(g.jsx)(xt.a,{component:rO.b,target:"_blank",to:"/docs/agents",onClick:J,children:"Agent Documentation"}),Object(g.jsx)(xt.a,{component:rO.b,target:"_blank",to:"/docs/wrappers",onClick:J,children:"Wrapper Documentation"}),Object(g.jsx)(xt.a,{component:rO.b,target:"_blank",to:"/docs/c2-profiles",onClick:J,children:"C2 Profile Documentation"}),Object(g.jsx)(xt.a,{component:rO.b,href:"https://docs.mythic-c2.net",target:"_blank",onClick:J,children:"Mythic Documentation"})]}),Object(g.jsx)(fO,{}),(null===y||void 0===y||null===(n=y.user)||void 0===n?void 0:n.username)?Object(g.jsx)(Q.a,{style:{display:"flex",alignItems:"center",paddingRight:"10px"},children:null===y||void 0===y||null===(i=y.user)||void 0===i?void 0:i.username}):Object(g.jsx)(v.a,{to:"/new/login"})]})]})]}):null}),Object(g.jsxs)(cO.a,{className:c.drawer,anchor:"left",open:_,classes:{paper:c.drawerPaper},onEscapeKeyDown:H,children:[Object(g.jsxs)("div",{className:c.drawerHeader,role:"presentation",children:[Object(g.jsx)(SO,{style:{width:"90%"}}),"v",qg,Object(g.jsx)(K.a,{onClick:H,children:"ltr"===r.direction?Object(g.jsx)(sO.a,{className:"mythicElement"}):Object(g.jsx)(dO.a,{className:"mythicElement"})})]}),Object(g.jsx)(Ma.a,{}),Object(g.jsx)(qa.a,{subheader:Object(g.jsx)(TO.a,{component:"div",id:"nested-list-subheader",children:"Home"}),children:Object(g.jsxs)(Na.a,{button:!0,component:rO.b,to:"/new",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(IO.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"Home"})]},"home")}),Object(g.jsx)(Ma.a,{}),Object(g.jsxs)(qa.a,{subheader:Object(g.jsx)(TO.a,{component:"div",id:"nested-list-subheader",children:"Global Configurations"}),children:[Object(g.jsxs)(Na.a,{button:!0,onClick:function(){$(!D)},children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(EO.a,{})}),Object(g.jsx)(Ba.a,{children:"Services"}),D?Object(g.jsx)(PO.a,{}):Object(g.jsx)(sn.a,{})]}),Object(g.jsx)(G.a,{in:D,unmountOnExit:!0,children:Object(g.jsxs)(qa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/payloadtypes",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(bO.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"Payload Types"})]},"payloadtypes"),Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/c2profiles",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(jt.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"C2 Profiles"})]},"c2profiles")]})}),Object(g.jsxs)(Na.a,{button:!0,onClick:function(){L(!E)},children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(FO.a,{})}),Object(g.jsx)(Ba.a,{children:"Create"}),E?Object(g.jsx)(PO.a,{}):Object(g.jsx)(sn.a,{})]}),Object(g.jsx)(G.a,{in:E,unmountOnExit:!0,children:Object(g.jsxs)(qa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/createpayload",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(FO.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"Create Payload"})]},"createpayload"),Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/createwrapper",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(FO.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"Create Wrapped Payload"})]},"createwrapper")]})}),Object(g.jsxs)(Na.a,{button:!0,onClick:function(){R(!N)},children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(NO.a,{})}),Object(g.jsx)(Ba.a,{children:"Operations"}),N?Object(g.jsx)(PO.a,{}):Object(g.jsx)(sn.a,{})]}),Object(g.jsx)(G.a,{in:N,unmountOnExit:!0,children:Object(g.jsxs)(qa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/operations",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(Bi.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"Modify Operations"})]},"modifyoperations"),Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/browserscripts",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(El.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"BrowserScripts"})]},"browserscripts")]})})]}),Object(g.jsx)(Ma.a,{}),Object(g.jsxs)(qa.a,{subheader:Object(g.jsx)(TO.a,{component:"div",id:"nested-list-subheader",children:"Operational Views"}),children:[Object(g.jsxs)(Na.a,{button:!0,onClick:function(){M(!W)},children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(BO.a,{})}),Object(g.jsx)(Ba.a,{children:"Operational Data"}),W?Object(g.jsx)(PO.a,{}):Object(g.jsx)(sn.a,{})]}),Object(g.jsx)(G.a,{in:W,unmountOnExit:!0,children:Object(g.jsxs)(qa.a,{component:"div",disablePadding:!0,children:[Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/payloads",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(ca.a,{icon:oa.a,size:"lg"})}),Object(g.jsx)(Ba.a,{primary:"Payloads"})]},"payloads"),Object(g.jsxs)(Na.a,{button:!0,className:c.nested,component:rO.b,to:"/new/search",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(Qs.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"Search"})]},"search")]})}),Object(g.jsxs)(Na.a,{button:!0,component:rO.b,to:"/new/callbacks",onClick:H,children:[Object(g.jsx)(Ra.a,{children:Object(g.jsx)(cf.a,{className:"mythicElement"})}),Object(g.jsx)(Ba.a,{primary:"Active Callbacks"})]},"callbacks")]}),Object(g.jsxs)(Na.a,{children:[Object(g.jsx)(U.a,{checked:"dark"===e.theme,onChange:e.toggleTheme,color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"darkMode"}),Object(g.jsx)("div",{style:{display:"inline-block"},children:" Enable Dark Mode "})]}),Object(g.jsxs)(Na.a,{children:["UI Version: ",Ng]})]})]})}var VO;function GO(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(xe.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(F.a)(e),Object(F.a)(t.taskartifacts))}),[]);t.sort((function(e,t){return e.task_id>t.task_id?1:t.task_id>e.task_id?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Artifact Tasks"})}),Object(g.jsx)(H.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Task ID"}),Object(g.jsx)(B.a,{children:"Artifact Type"}),Object(g.jsx)(B.a,{children:"Host"}),Object(g.jsx)(B.a,{children:"Artifact"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.task_id}),Object(g.jsx)(B.a,{children:e.artifact.name}),Object(g.jsx)(B.a,{children:e.host}),Object(g.jsx)(B.a,{children:e.artifact_instance_text})]},"artifact"+e.id)}))})]})})})]})}function KO(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(xe.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){var a=t.attacktasks.reduce((function(t,a){return e.find((function(e){return e.attack.t_num===a.attack.t_num}))?Object(F.a)(t):[].concat(Object(F.a)(t),[a])}),[]);return[].concat(Object(F.a)(e),Object(F.a)(a))}),[]);t.sort((function(e,t){return e.attack.t_num>t.attack.t_num?1:t.attack.t_num>e.attack.t_num?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"MITRE ATT&CK Mappings"})}),Object(g.jsx)(H.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Technique ID"}),Object(g.jsx)(B.a,{children:"Technique"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.attack.t_num}),Object(g.jsx)(B.a,{children:e.attack.name})]},"attack"+e.attack.id)}))})]})})})]})}function QO(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(xe.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(F.a)(e),Object(F.a)(t.filemeta))}),[]);i(t),t.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0}))}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Files / Screenshots"})}),Object(g.jsx)(H.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Filename"}),Object(g.jsx)(B.a,{children:"Type"}),Object(g.jsx)(B.a,{children:"Remote Path"}),Object(g.jsx)(B.a,{children:"Comment"}),Object(g.jsx)(B.a,{children:"Hashes"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:!e.deleted&&e.complete?Object(g.jsx)(Us.a,{href:window.origin+"/api/v1.4/files/download/"+e.agent_file_id,style:{textDecoration:"underline",color:"inherit"},children:e.filename_text}):e.complete?e.filename_text:e.filename_text+" ("+e.chunks_received+"/"+e.total_chunks+")"}),Object(g.jsx)(B.a,{children:e.is_screenshot?"Screenshot":e.is_payload?"Payload":e.is_download_from_agent?"Download":"Upload"}),Object(g.jsx)(B.a,{children:""===e.full_remote_path_text?"":e.host+":"+e.full_remote_path_text}),Object(g.jsx)(B.a,{children:e.comment}),Object(g.jsxs)(B.a,{children:["MD5:",Object(g.jsx)("br",{}),e.md5,Object(g.jsx)("br",{}),"SHA1:",Object(g.jsx)("br",{}),e.sha1]})]},"file"+e.id)}))})]})})})]})}function JO(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(xe.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(F.a)(e),Object(F.a)(t.credentials))}),[]);i(t)}),[e.tasks]),0===n.length?null:Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Credentials"})}),Object(g.jsx)(H.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Task"}),Object(g.jsx)(B.a,{children:"Type"}),Object(g.jsx)(B.a,{children:"Realm"}),Object(g.jsx)(B.a,{children:"Account"}),Object(g.jsx)(B.a,{children:"Credentials"}),Object(g.jsx)(B.a,{children:"Comment"})]})}),Object(g.jsx)(R.a,{children:n.map((function(e){return Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:e.task_id}),Object(g.jsx)(B.a,{children:e.type}),Object(g.jsx)(B.a,{children:e.realm}),Object(g.jsx)(B.a,{children:e.account}),Object(g.jsx)(B.a,{children:e.credential_text}),Object(g.jsx)(B.a,{children:e.comment})]},"cred"+e.id)}))})]})})})]})}var YO,ZO,XO,eg,tg,ag=Object(Pe.a)(VO||(VO=Object(q.a)(["\nquery taskMetadataQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}) {\n      credentials {\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n        task_id\n      }\n      filemeta {\n        agent_file_id\n        complete\n        deleted\n        filename_text\n        full_remote_path_text\n        host\n        id\n        comment\n        total_chunks\n        chunks_received\n        is_download_from_agent\n        is_payload\n        is_screenshot\n        md5\n        sha1\n        task {\n            comment\n            id\n        }\n      }\n      taskartifacts {\n        artifact_instance_text\n        host\n        task_id\n        artifact{\n            id\n            name\n        }\n        id\n      }\n      tokens {\n        TokenId\n        id\n        host\n      }\n      attacktasks(distinct_on: attack_id) {\n        attack {\n          name\n          os\n          id\n          t_num\n          tactic\n        }\n        id\n      }\n      id\n    }\n  }"])));function ng(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(At.a)(ag,{onCompleted:function(e){i(e.task)},onError:function(e){console.log("error!",e)}}),c=Object(u.a)(r,1)[0];return Object(o.useEffect)((function(){c({variables:{task_range:e.taskIDs}})}),[e.taskIDs,c]),Object(g.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(g.jsx)(GO,{tasks:n}),Object(g.jsx)(KO,{tasks:n}),Object(g.jsx)(QO,{tasks:n}),Object(g.jsx)(JO,{tasks:n})]})}function ig(e){var t=Object(o.useState)(0),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=Object(o.useState)(10),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(o.useState)(10),O=Object(u.a)(f,2),x=O[0],_=O[1],v=Object(o.useState)("all"),k=Object(u.a)(v,2),w=k[0],C=k[1],S=Object(o.useState)(""),D=Object(u.a)(S,2),I=D[0],T=D[1],$=Object(o.useRef)(null);return Object(o.useEffect)((function(){d(e.taskOptions),e.taskOptions.length>0&&i(e.taskOptions[0])}),[e.tasks,e.taskOptions]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(se.a,{id:"form-dialog-title",children:"Add More Tasks to View"}),Object(g.jsxs)(ce.a,{dividers:!0,children:[Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Et.a,{style:{width:"100%"},children:[Object(g.jsx)(Jt.a,{ref:$,children:"View More Tasks Around Task:"}),Object(g.jsx)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:n,onChange:function(e){i(e.target.value)},input:Object(g.jsx)(qt.a,{}),children:l.map((function(e){return Object(g.jsx)(xt.a,{value:e,children:e},"selectiontask:"+e)}))})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{})]}),Object(g.jsx)(y,{type:"number",value:m,onChange:function(e,t,a){return h(t)},name:"Number of tasks before"}),Object(g.jsx)(y,{type:"number",value:x,onChange:function(e,t,a){return _(t)},name:"Number of tasks after"}),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)(Et.a,{style:{width:"100%"},children:[Object(g.jsx)(Jt.a,{ref:$,children:"Search Type"}),Object(g.jsx)(Lt.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:w,onChange:function(e){C(e.target.value)},input:Object(g.jsx)(qt.a,{}),children:[{type:"all",text:"All Callbacks"},{type:"callback",text:"This Callack"},{type:"operator",text:"All callbacks but limited by operator"}].map((function(e){return Object(g.jsx)(xt.a,{value:e.type,children:e.text},"selectiontype:"+e.type)}))})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{})]}),"operator"===w?Object(g.jsx)(y,{multiline:!1,onChange:function(e,t,a){T(t)},value:I,name:"Operator Username"}):null]}),Object(g.jsxs)(re.a,{children:[Object(g.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(b.a,{onClick:function(){e.submitFetchTasks({taskSelected:n,beforeCount:parseInt(m),afterCount:parseInt(x),search:"operator"===w?I:w}),e.onClose()},variant:"contained",color:"secondary",children:"Fetch Tasks"})]})]})}var rg=Object(Pe.a)(YO||(YO=Object(q.a)(["\nfragment TaskData on task {\n    comment\n    callback_id\n    commentOperator{\n        username\n    }\n    completed\n    id\n    operator{\n        username\n    }\n    display_params\n    original_params\n    command_name\n    status\n    timestamp\n    command {\n        cmd\n        id\n    }\n    callback {\n        id\n        host\n        user\n        integrity_level\n        domain\n    }\n    responses_aggregate{\n        aggregate{\n            count\n        }\n    }\n    parent_task_id\n    opsec_pre_blocked\n    opsec_pre_bypassed\n    opsec_post_blocked\n    opsec_post_bypassed\n    tasks {\n        id\n    }\n    token {\n        id\n    }\n}\n"]))),cg=Object(Pe.a)(ZO||(ZO=Object(q.a)(["\n","\nquery tasksQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),rg),og=Object(Pe.a)(XO||(XO=Object(q.a)(["\n","\nquery tasksAcrossAllCallbacks($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, order_by: {id: desc}, limit: $beforeCount) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),rg),sg=Object(Pe.a)(eg||(eg=Object(q.a)(["\n","\nquery tasksAcrossACallbacks($callback_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),rg),lg=Object(Pe.a)(tg||(tg=Object(q.a)(["\n","\nquery tasksAcrossAllCallbacksByOperator($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!, $operator: String!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),rg);function dg(e){var t=Object(T.a)(C),a=Object(v.g)().taskId,n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState([]),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],x=s.a.useState(!1),y=Object(u.a)(x,2),_=y[0],w=y[1],S=s.a.useState(!1),D=Object(u.a)(S,2),I=D[0],$=D[1],P=Object(xe.a)(),A=function(e){var t=e.filter((function(e){return null===e.parent_task_id})),a=[],n=-1;0===t.length&&(t=Object(F.a)(e));var i=f.reduce((function(e,t){return"task"===t.type&&null===t.parent_task_id?e.find((function(e){return e.id===t.id}))?Object(F.a)(e):[].concat(Object(F.a)(e),[Object(k.a)(Object(k.a)({},t),{},{checked:!1})]):Object(F.a)(e)}),Object(F.a)(t));i.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0})),i.forEach((function(e){e.callback.id!==n&&a.push(Object(k.a)(Object(k.a)({type:"callback"},e.callback),{},{checked:!1})),n=e.callback.id,a.push(Object(k.a)(Object(k.a)({type:"task"},e),{},{checked:!1}))})),O(a);var o=e.reduce((function(e,t){var a=t.tasks.filter((function(t){return!e.includes(t.id)})).map((function(e){return e.id}));return e.includes(t.id)?[].concat(Object(F.a)(e),Object(F.a)(a)):[].concat(Object(F.a)(e),[t.id],Object(F.a)(a))}),Object(F.a)(r));c(o)},L=Object(At.a)(og,{onCompleted:function(e){E.success("Successfully fetched tasks"),A([].concat(Object(F.a)(e.before),Object(F.a)(e.after)))}}),q=Object(u.a)(L,1)[0],N=Object(At.a)(sg,{onCompleted:function(e){E.success("Successfully fetched tasks"),A([].concat(Object(F.a)(e.before),Object(F.a)(e.after)))}}),R=Object(u.a)(N,1)[0],B=Object(At.a)(lg,{onCompleted:function(e){E.success("Successfully fetched tasks"),A([].concat(Object(F.a)(e.before),Object(F.a)(e.after)))}}),z=Object(u.a)(B,1)[0],W=Object(At.a)(cg,{onCompleted:function(e){A(e.task)}}),M=Object(u.a)(W,1)[0],V=function(e){var t=f.map((function(t){return"task"===t.type&&"task"+t.id===e.target.name?Object(k.a)(Object(k.a)({},t),{},{checked:e.target.checked}):Object(k.a)({},t)}));O(t)};return Object(o.useEffect)((function(){if(window.location.pathname.includes("/new/tasks/by_range")){var e=new URLSearchParams(window.location.search);if(e.has("tasks")){console.log(e.get("tasks"));var t=function(e){for(var t=[],a=e.split(","),n=0;n<a.length;n++)a[n].includes("-")?function(){var e=a[n].split("-");e=e.map((function(e){return parseInt(e)})),t.push.apply(t,Object(F.a)(Object(F.a)(Array(e[1]-e[0]+1).keys()).map((function(t){return t+e[0]}))))}():t.push(parseInt(a[n]));return t.sort((function(e,t){return e-t})),t}(e.get("tasks"));M({variables:{task_range:t}})}else E.warning("URL Query missing '?tasks=' with a range of tasks")}else M({variables:{task_range:[parseInt(a)]}})}),[M,a]),Object(g.jsxs)("div",{style:{marginTop:"10px",maxHeight:"calc(94vh)",width:"100%",marginBottom:"10px"},children:[Object(g.jsxs)(H.a,{elevation:5,style:{backgroundColor:P.pageHeader.main,color:P.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(g.jsx)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Task View"}),Object(g.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:P.palette.success.main},onClick:function(){var e=function(e){e.sort((function(e,t){return e-t}));for(var t,a,n=[],i=0;i<e.length;i++){for(a=t=e[i];e[i+1]-e[i]===1;)a=e[i+1],i++;n.push(t===a?t+"":t+"-"+a)}return n.join(",")}(Object(F.a)(r));Lo(window.origin+"/new/tasks/by_range?tasks="+e),E.success("Copied link to clipboard!")},children:"Get Shareable link"}),Object(g.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:P.palette.warning.main},onClick:function(){w(!_);var e=f.filter((function(e){return!e.checked}));O(e);var t=e.reduce((function(e,t){return"task"===t.type?[].concat(Object(F.a)(e),[t.id]):Object(F.a)(e)}),[]);c(t)},children:"Remove Tasks From View"}),Object(g.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(e){e.stopPropagation(),E.warning("Not implemented yet")},children:"Add Tags To All"})]}),f.map((function(e){return"task"===e.type?Object(g.jsxs)(Ft.a,{container:!0,alignItems:"stretch",style:{marginRight:"5px"},children:[Object(g.jsx)(Ft.a,{item:!0,style:{display:"inline-flex",width:_?"96%":"100%"},children:Object(g.jsx)(pd,{task:e,command_id:null===e.command?0:e.command.id})}),Object(g.jsx)(Ft.a,{item:!0,style:{display:"inline-flex"},children:_?Object(g.jsx)(U.a,{checked:e.checked,onChange:V,name:"task"+e.id,inputProps:{"aria-label":"checkbox",color:P.palette.error.main}}):null})]},"taskdisplay:"+e.id):Object(g.jsxs)(H.a,{elevation:5,style:{marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(g.jsxs)(Q.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:[""===e.domain?null:e.domain+"\\",e.user,e.integrity_level>2?"*":null,"@",e.host," (",e.id,")"]}),Object(g.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:P.palette.info.main},onClick:function(){!function(e){var t=f.reduce((function(t,a){return"task"===a.type&&a.callback.id===e?[].concat(Object(F.a)(t),[a.id]):Object(F.a)(t)}),[]);p(t),$(!0)}(e.id)},children:"Include More Tasks"})]},"taskdisplayforcallback:"+e.id)})),Object(g.jsx)(be,{fullWidth:!0,maxWidth:"md",open:I,onClose:function(){$(!1)},innerDialog:Object(g.jsx)(ig,{submitFetchTasks:function(e){var a=e.taskSelected,n=e.beforeCount,i=e.afterCount,r=e.search;switch(E.info("Searching for tasks..."),r){case"all":q({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i}});break;case"callback":R({variables:{}});break;default:z({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i,operator:r}})}},taskOptions:j,onClose:function(){$(!1)}})}),Object(g.jsx)(ng,{taskIDs:r})]})}var ug,bg,jg,pg=a(892),mg=a(481),hg=Object(mg.a)(ug||(ug=Object(q.a)(["\nbody {\n    margin: 0\n}\nhtml, body, #root {\n    height: 100%;\n}\n.MuiAccordionDetails-root{\n\n    padding-bottom: 0;\n    padding-top: 0;\n}\n.MuiAccordionSummary-content.Mui-expanded{\n    margin: 0px 0px 0px 0px !important;\n    min-height: unset;\n}\n.MuiAccordionSummary-root.Mui-expanded{\n    min-height: unset;\n}\n// placeholder/helper text for input boxes\n.MuiFormLabel-root {\n    background: transparent;\n}\n.MuiTableCell-head {\n\n    font-weight: bold;\n}\n.MuiSelect-select.MuiSelect-select{\n    padding-left: 10px\n}\n.ReactVirtualized__Table__row {\n    &:hover,\n    &--hovered {\n        background-color: "," !important;\n        color: "," !important;\n        \n    }\n}\n.menuEntry {\n  cursor: pointer;\n}\n\ntspan {\n  font-size: 15px;\n  stroke: none;\n}\n\n.ReactVirtualized__Table__headerTruncatedText {\n\n  }\n.ReactVirtualized__Table__headerColumn {\n\n    padding: 0;\n  }\n.MuiTab-root {\n    max-width: unset;\n}\n.MuiSpeedDialAction-staticTooltipLabel {\n    white-space: nowrap;\n    max-width: none;\n}\n.MuiTreeItem-root.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label{\n    background-color: transparent;\n}\n.MuiTreeItem-root.Mui-selected:hover > .MuiTreeItem-content .MuiTreeItem-label{\n    background-color: transparent;\n}\n.MuiTreeItem-root:hover > .MuiTreeItem-content .MuiTreeItem-label {\n    background-color: transparent;\n}\n.MuiAppBar-root{\n    z-index: 1\n}\n"])),(function(e){return e.theme.tableHover}),(function(e){return e.theme.palette.text.primary})),fg=a(893),Og=Object(Pe.a)(bg||(bg=Object(q.a)(["\nmutation generateReportMutation($outputFormat: String!, $includeMITREPerTask: Boolean!, $includeMITREOverall: Boolean!, $excludedUsers: String!, $excludedHosts: String!, $excludedIDs: String!, $includeOutput: Boolean!){\n    generateReport(outputFormat: $outputFormat, includeMITREPerTask: $includeMITREPerTask, includeMITREOverall: $includeMITREOverall, excludedUsers: $excludedUsers, excludedHosts: $excludedHosts, excludedIDs: $excludedIDs, includeOutput: $includeOutput){\n        status\n        error\n    }\n}\n"]))),gg=Object(Pe.a)(jg||(jg=Object(q.a)(['\nsubscription generatedReportEventSubscription($fromNow: timestamp!, $operation_id: Int!){\n    operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}, operation_id: {_eq: $operation_id}, source: {_eq: "generated_report"}}, order_by: {id: desc}) {\n        operator {\n            username\n        }\n        message\n        level\n      }\n}\n'])));function xg(e){var t,a=Object(xe.a)(),n=Object(T.a)(C),i=s.a.useRef((new Date).toISOString()),r=s.a.useState("pdf"),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),O=Object(u.a)(f,2),x=O[0],_=O[1],v=s.a.useState(!1),k=Object(u.a)(v,2),w=k[0],S=k[1],D=s.a.useState(!1),I=Object(u.a)(D,2),$=(I[0],I[1]),P=s.a.useState(""),A=Object(u.a)(P,2),L=A[0],F=A[1],q=s.a.useState(""),V=Object(u.a)(q,2),G=V[0],K=V[1],Q=s.a.useState(""),J=Object(u.a)(Q,2),Y=J[0],Z=J[1],X=Object(Ee.a)(Og,{onCompleted:function(e){"success"===e.generateReport.status?(E.info("Generating report..."),E.info("Final reports are always available via the 'Uploads' tab within 'Search'")):E.error(e.generateReport.error)},onError:function(e){E.error(e)}}),ee=Object(u.a)(X,1)[0],te=Object(ct.a)(gg,{variables:{fromNow:i.current,operation_id:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onError:function(e){E.warning("Failed to get notifications for generated payloads")}}).data;return Object(o.useEffect)((function(){var e;if(console.log(te),(null===te||void 0===te||null===(e=te.operationeventlog)||void 0===e?void 0:e.length)>0){var t=te.operationeventlog[0].message.split(":").pop().trim();E.success("",{persist:!0,content:function(e){return Object(g.jsx)(Fp,{id:e,title:"Download Generated Report",downloadLink:window.location.origin+"/api/v1.4/files/download/"+t})}})}}),[te]),Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsx)(z.a,{component:H.a,className:"mythicElement",children:Object(g.jsxs)(N.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(W.a,{children:Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"25rem"},children:"Report Option"}),Object(g.jsx)(B.a,{children:"Selected Values"})]})}),Object(g.jsxs)(R.a,{children:[Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Output Format"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(Lt.a,{autoFocus:!0,style:{width:"100%",marginBottom:"10px"},value:l,label:"Select an Output Format",onChange:function(e){d(e.target.value),"json"!==e.target.value&&S(!1),"json"===e.target.value&&$(!1)},children:["pdf","latex","json"].map((function(e,t){return Object(g.jsx)(xt.a,{value:e,children:e},"outputformat"+t)}))})})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Include MITRE ATT&CK Coverage Per Task"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:m,onChange:function(e){return h(!m)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Include MITRE ATT&CK Coverage Overview"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:x,onChange:function(e){return _(!x)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),"json"===l&&Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Include Command Output"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(U.a,{checked:w,onChange:function(e){return S(!w)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),Object(g.jsxs)(M.a,{hover:!0,children:[Object(g.jsx)(B.a,{children:"Exclude Callbacks With Matching Values"}),Object(g.jsx)(B.a,{children:Object(g.jsxs)(N.a,{children:[Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{style:{width:"10rem"},children:"Exclude Users"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(y,{onChange:function(e,t,a){K(t)},value:G,name:"Excluded Usernames"})})]}),Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Exclude Hosts"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(y,{onChange:function(e,t,a){F(t)},value:L,name:"Excluded Hostnames"})})]}),Object(g.jsxs)(M.a,{children:[Object(g.jsx)(B.a,{children:"Exclude IDs"}),Object(g.jsx)(B.a,{children:Object(g.jsx)(y,{onChange:function(e,t,a){Z(t)},value:Y,name:"Excluded Callback IDs"})})]})]})})]})]})]})}),Object(g.jsx)(b.a,{variant:"contained",style:{marginTop:"10px",backgroundColor:a.palette.success.main,color:"white"},onClick:function(){ee({variables:{outputFormat:l,includeMITREOverall:x,includeMITREPerTask:m,includeOutput:w,excludedUsers:G,excludedHosts:L,excludedIDs:Y}})},children:"Generate"})]})}function yg(){var e=Object(xe.a)();return Object(g.jsxs)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:[Object(g.jsx)(H.a,{elevation:5,style:{backgroundColor:e.pageHeader.main,color:e.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(g.jsx)(Q.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Mythic Report Generation"})}),Object(g.jsx)(xg,{})]})}function _g(e){var t=Object(T.a)(C),a=function(){var e=Object(o.useState)("light"),t=Object(u.a)(e,2),a=t[0],n=t[1],i=Object(o.useState)(!1),r=Object(u.a)(i,2),c=r[0],s=r[1],l=function(e){window.localStorage.setItem("theme",e),n(e)};return Object(o.useEffect)((function(){var e=window.localStorage.getItem("theme");e?n(e):l("light"),s(!0)}),[]),[a,function(){l("light"===a?"dark":"light")},c]}(),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useMemo((function(){return Object(Vr.a)({palette:{primary:{main:"#7f93c0"},secondary:{main:"#a791c3"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"},type:i,background:{default:"dark"===i?"rgb(37, 41, 51)":"#ffffff",paper:"dark"===i?"rgb(50, 60, 69)":"#ffffff",contrast:"dark"===i?"#ffffff":"rgb(37, 41, 51)"},text:{primary:"dark"===i?"#fff":"#000",secondary:"dark"===i?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.54)",contrast:"dark"===i?"#000":"#fff"},textBackgroundColor:"dark"===i?"#74828b":"#d9dbdc",textBackgroundColorMythic:"dark"===i?"#436b9f":"#aadcf5",textBackgroundColorSuccess:"dark"===i?"#09a21a":"#70e373",textBackgroundColorError:"dark"===i?"#9f1616":"#f19da3",graphGroup:"dark"===i?"#394c5d":"#d3d7e8"},folderColor:"#f1d592",tableHeader:"#484848",tableBorder:"dark"===i?"rgba(81,81,81,1)":"rgba(224,224,224,1)",tableHover:"dark"===i?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)",pageHeader:{main:"#827E80"},pageHeaderText:{main:"white"}})}),[i]);return Object(g.jsxs)(pg.a,{theme:c,children:[Object(g.jsx)(hg,{theme:c}),Object(g.jsx)(fg.a,{}),Object(g.jsxs)($.b,{maxSnack:5,anchorOrigin:{vertical:"top",horizontal:"center"},children:[Object(g.jsx)(A,{}),Object(g.jsxs)("div",{style:{maxHeight:"100%",height:"100%"},children:[Object(g.jsx)("div",{style:{height:"48px"},children:t.loggedIn&&void 0!==t.user&&null!==t.user?Object(g.jsx)(UO,{theme:i,toggleTheme:r}):null}),Object(g.jsx)("div",{style:{margin:"0px 16px 0px 16px",height:"calc(100% - 48px)",maxHeight:"calc(100% - 48px)",display:"flex",flexDirection:"column"},children:Object(g.jsxs)(v.d,{children:[Object(g.jsx)(ru,{exact:!0,path:"/new",component:nu}),Object(g.jsx)(v.b,{exact:!0,path:"/new/login",component:L}),Object(g.jsx)(ru,{exact:!0,path:"/new/settings",component:Ue}),Object(g.jsx)(ru,{exact:!0,path:"/new/payloadtypes",component:ya}),Object(g.jsx)(ru,{exact:!0,path:"/new/eventfeed",component:Ai}),Object(g.jsx)(ru,{exact:!0,path:"/new/createpayload",component:gn}),Object(g.jsx)(ru,{exact:!0,path:"/new/createwrapper",component:Qn}),Object(g.jsx)(ru,{exact:!0,path:"/new/payloads",component:Xc}),Object(g.jsx)(ru,{exact:!0,path:"/new/c2profiles",component:ya}),Object(g.jsx)(ru,{exact:!0,path:"/new/services/",component:ya}),Object(g.jsx)(ru,{exact:!0,path:"/new/callbacks",component:pp}),Object(g.jsx)(ru,{path:"/new/search",component:Zf}),Object(g.jsx)(ru,{exact:!0,path:"/new/browserscripts",component:rc}),Object(g.jsx)(ru,{exact:!0,path:"/new/task/:taskId",component:dg}),Object(g.jsx)(ru,{exact:!0,path:"/new/tasks/by_range",component:dg}),Object(g.jsx)(ru,{exact:!0,path:"/new/operations",component:Ar}),Object(g.jsx)(ru,{exact:!0,path:"/new/callbacks/:callbackId",component:Jd}),Object(g.jsx)(ru,{exact:!0,path:"/new/reporting",component:yg})]})})]})]})]})}var vg=a(783),kg=a(896),wg=a(14),Cg=a(323),Sg=a(781),Dg=a(488),Ig=a(487),Tg=a(901),$g=a(216),Pg=a(145),Ag=a(486),Eg=a(324),Lg=a.n(Eg),Fg=a(333),qg="2.3.2",Ng="0.0.2",Rg=new vg.a({typePolicies:{Query:{fields:{operationeventlog:{},callback:{}}}}}),Bg=new Tg.a({delay:{initial:20,max:300,jitter:!0},attempts:{max:2,retryIf:function(e,t){return!!e}}}),zg=new kg.a({uri:window.location.origin+"/graphql/",options:{reconnect:!0,connectionParams:{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),Wg=function(){var e=localStorage.getItem("access_token");if(e){var t=Object(Fg.a)(e);return!(Date.now()>1e3*t.exp)}return!1},Mg=Object(Ag.a)(function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.headers,!(n=localStorage.getItem("access_token"))){e.next=19;break}if(i=Object(Fg.a)(n),c=Math.abs(Date.now()-1e3*i.exp),72e5,!(c<72e5)){e.next=17;break}return console.log("token is at its half life or less, try to get a new token"),e.next=10,Ug();case 10:if(!e.sent){e.next=15;break}return e.abrupt("return",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});case 15:e.next=17;break;case 17:e.next=19;break;case 19:return e.abrupt("return",{Authorization:"Bearer ".concat(localStorage.getItem("access_token")),headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});case 20:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Hg=Object(Ig.a)((function(e){var t=e.graphQLErrors,a=e.networkError;console.log("errors?");try{if(t){console.log("[graphQLError]",t);var i,r=Object(n.a)(t);try{for(r.s();!(i=r.n()).done;){var c=i.value;switch(c.extensions.code){case"forbidden":E.error(c.message);break;case"access-denied":case"start-failed":console.log("got start-failed error in graphql"),console.log("would have asked for new token, but auth link will handle it");case"validation-failed":return void console.log(c);default:console.log(c),E.error(c.message)}}}catch(c){r.e(c)}finally{r.f()}}if(a){if(console.log("[Network error]",a),void 0===a.extensions)return E.error("Failed to connect to Mythic, please refresh"),I(),Jg(),void(window.location="/new/login");switch(a.extensions.code){case"access-denied":E.warning("Access Denied");break;case"start-failed":console.log("got start-failed error in network"),I(),Jg(),window.location="/new/login";break;default:console.log(a)}}}catch(o){return E.error("Failed to connect to Mythic, please refresh"),console.log(o),Jg(),void(window.location="/new/login")}})),Ug=function(){var e=Object(c.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:localStorage.getItem("refresh_token"),access_token:localStorage.getItem("access_Token")})},e.next=3,fetch("/refresh",t);case 3:return a=e.sent,n=a.json().then((function(e){return console.log(e),"access_token"in e?(D(e),console.log("successfully got new access_token"),!0):(console.log("calling FailedRefresh from GetNewToken call"),I(),!1)})).catch((function(e){return console.log("Error trying to get json response in GetNewToken",e),console.log(a),I(),!1})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Vg=new $g.SubscriptionClient("https:"===window.location.protocol?"wss://"+window.location.host+"/graphql/":"ws://"+window.location.host+"/graphql/",{reconnect:!0,reconnectionAttempts:10,connectionParams:function(){return{Authorization:"Bearer ".concat(localStorage.getItem("access_token")),headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),Gg=new Dg.a(Vg),Kg=Object(wg.split)((function(e){var t=e.query,a=Object(Pg.e)(t);return"OperationDefinition"===a.kind&&"subscription"===a.operation}),Gg,zg),Qg=new Cg.a({link:Object(wg.from)([Mg,Hg,Bg,Mg.concat(Kg)]),cache:Rg});function Jg(){var e=Object.assign({},Vg.operations);Vg.close(!0),Vg.connect(),Object.keys(e).forEach((function(t){Vg.sendMessage(t,Lg.a.GQL_START,e[t].options)}))}null!==localStorage.getItem("access_token")&&(Wg(localStorage.getItem("access_token"))?null!==localStorage.getItem("user")&&C({loggedIn:!0,access_token:localStorage.getItem("access_token"),refresh_token:localStorage.getItem("refresh_token"),user:JSON.parse(localStorage.getItem("user"))}):(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"))),d.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(Sg.a,{client:Qg,children:Object(g.jsx)(rO.a,{children:Object(g.jsx)(_g,{},"App")})})}),document.getElementById("root"))}},[[782,1,2]]]);
//# sourceMappingURL=main.9e1b1042.chunk.js.map