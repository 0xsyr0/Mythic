(this.webpackJsonpmythic=this.webpackJsonpmythic||[]).push([[0],{109:function(e,t,a){"use strict";a.d(t,"a",(function(){return pe})),a.d(t,"d",(function(){return me})),a.d(t,"c",(function(){return he})),a.d(t,"b",(function(){return xe}));var n,i=a(6),r=a(7),c=a(3),o=a(2),s=a(48),l=a(1),d=a.n(l),u=a(57),b=a(197),j=a(545),p=a(252),m=a(213),h=a(4),f=a(13),O=a(218),x=a(58),g=a(224),y=a(292),v=a.n(y),_=a(827),k=a(294),w=a.n(k),C=a(54),S=a(97),D=a(96),I=a(111),T=a(17),$=a(899),P=a(368),A=a(924),E=a(363),L=a(365),F=a(366),N=a(364),q=a(542),R=a(142),B=a(856),M=a(195),z=a(16),W=a(318),H=a(0),U={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},G=Object(R.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}})),K=Object(u.a)(n||(n=Object(r.a)(["\nquery operatorQuery($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    operators {\n      username\n      id\n    }\n  }\n}"])));function V(e){var t=Object(W.a)(z.b),a=d.a.useState([]),n=Object(o.a)(a,2),i=n[0],r=n[1],c=d.a.useState([]),s=Object(o.a)(c,2),u=s[0],b=s[1],j=d.a.useState(!1),p=Object(o.a)(j,2),m=p[0],h=p[1],f=d.a.useState([]),O=Object(o.a)(f,2),x=O[0],g=O[1],y=d.a.useState([]),v=Object(o.a)(y,2),_=v[0],k=v[1],w=d.a.useState(""),R=Object(o.a)(w,2),V=R[0],Q=R[1],J=d.a.useState([]),Y=Object(o.a)(J,2),Z=Y[0],X=Y[1],ee=G();Object(M.a)(K,{variables:{operation_id:t.user.current_operation_id},onCompleted:function(e){b(e.operation_by_pk.operators.map((function(e){return e.username})))}}),Object(l.useEffect)((function(){if(void 0!==e.filterOptions.operatorsList&&r(e.filterOptions.operatorsList),void 0!==e.filterOptions.commentsFlag&&h(e.filterOptions.commentsFlag),void 0!==e.filterOptions.commandsList&&g(e.filterOptions.commandsList),void 0!==e.filterOptions.parameterString&&Q(e.filterOptions.parameterString),void 0!==e.filterOptions.everythingButList&&k(e.filterOptions.everythingButList),e.filterCommandOptions){var t=e.filterCommandOptions.map((function(e){return e.cmd}));X(t)}}),[e.filterOptions]);return Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsx)(I.a,{id:"form-dialog-title",children:"Filter Which Tasks Are Visible"}),Object(H.jsx)(D.a,{dividers:!0,style:{overflow:"hidden"},children:Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsxs)(N.a,{className:ee.formControl,children:[Object(H.jsx)(L.a,{id:"operator-chip-label",children:"Only Show Tasks by the Following Operators"}),Object(H.jsx)(P.a,{labelId:"operator-chip-label",multiple:!0,id:"operator-chip",value:i,onChange:function(e){r(e.target.value)},input:Object(H.jsx)(E.a,{}),renderValue:function(e){return Object(H.jsx)("div",{className:ee.chips,children:e.map((function(e){return Object(H.jsx)(A.a,{label:e,className:ee.chip},e)}))})},MenuProps:U,children:u.map((function(e){return Object(H.jsxs)(F.a,{value:e,children:[Object(H.jsx)(B.a,{color:"primary",checked:i.indexOf(e)>-1}),Object(H.jsx)(q.a,{primary:e})]},e)}))})]}),"Only Show Tasks with Comments: ",Object(H.jsx)($.a,{checked:m,onChange:function(e){h(e.target.checked)},color:"primary",name:"Only Comments",inputProps:{"aria-label":"primary checkbox"}}),Object(H.jsxs)(N.a,{className:ee.formControl,children:[Object(H.jsx)(L.a,{id:"include-chip-label",children:"Only Show These Commands"}),Object(H.jsx)(P.a,{labelId:"include-chip-label",multiple:!0,id:"include-chip",value:x,onChange:function(e){g(e.target.value),e.target.value.length>0&&k([])},input:Object(H.jsx)(E.a,{}),renderValue:function(e){return Object(H.jsx)("div",{className:ee.chips,children:e.map((function(e){return Object(H.jsx)(A.a,{label:e,className:ee.chip},e)}))})},MenuProps:U,children:Z.map((function(e){return Object(H.jsxs)(F.a,{value:e,children:[Object(H.jsx)(B.a,{color:"primary",checked:x.indexOf(e)>-1}),Object(H.jsx)(q.a,{primary:e})]},e)}))})]}),Object(H.jsxs)(N.a,{className:ee.formControl,children:[Object(H.jsx)(L.a,{id:"exclude-chip-label",children:"Do Not Show These Commands"}),Object(H.jsx)(P.a,{labelId:"exclude-chip-label",multiple:!0,id:"exclude-chip",value:_,onChange:function(e){k(e.target.value),e.target.value.length>0&&g([])},input:Object(H.jsx)(E.a,{}),renderValue:function(e){return Object(H.jsx)("div",{className:ee.chips,children:e.map((function(e){return Object(H.jsx)(A.a,{label:e,className:ee.chip},e)}))})},MenuProps:U,children:Z.map((function(e){return Object(H.jsxs)(F.a,{value:e,children:[Object(H.jsx)(B.a,{color:"primary",checked:_.indexOf(e)>-1}),Object(H.jsx)(q.a,{primary:e})]},e)}))})]}),Object(H.jsx)(T.a,{value:V,onChange:function(e,t,a){Q(t)},name:"Only Show Tasks with the Following Parameter Regex"})]})}),Object(H.jsxs)(S.a,{children:[Object(H.jsx)(C.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(H.jsx)(C.a,{onClick:function(){e.onSubmit({operatorsList:i,commentsFlag:m,commandsList:x,everythingButList:_,parameterString:V}),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}function Q(e){var t=d.a.useState([]),a=Object(o.a)(t,2),n=a[0],r=a[1],c=d.a.useState(""),s=Object(o.a)(c,2),u=s[0],b=s[1],j=Object(l.useRef)(null);Object(l.useEffect)((function(){var t=Object(i.a)(e.options);r(t),t.length,b("Default Token"),e.changeSelectedToken("Default Token")}),[e.options]);return Object(H.jsxs)(N.a,{style:{width:"20%"},children:[Object(H.jsx)(L.a,{ref:j,children:"Tokens"}),Object(H.jsxs)(P.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:u,onChange:function(t){b(t.target.value),e.changeSelectedToken(t.target.value)},variant:"filled",renderValue:function(e){return"Default Token"===e?"Default Token":null===e.User?e.tokenId:e.User},input:Object(H.jsx)(E.a,{style:{width:"100%"}}),children:[Object(H.jsx)(F.a,{value:"Default Token",children:"Default Token"},0),n.map((function(e){return Object(H.jsx)(F.a,{value:e.token,children:null===e.token.User?e.token.TokenId+" - "+e.token.description:e.token.User+" - "+e.token.description},e.token.id)}))]})]})}var J,Y,Z,X=a(494),ee=a.n(X),te=Object(u.a)(J||(J=Object(r.a)(["\nsubscription GetLoadedCommandsSubscription($callback_id: Int!){\n    loadedcommands(where: {callback_id: {_eq: $callback_id}}){\n        id\n        command {\n            cmd\n            id\n            attributes\n            commandparameters {\n                id\n                parameter_type: type \n                required\n                name\n                ui_position\n                parameter_group_name\n                cli_name\n                display_name\n            }\n        }\n    }\n    \n}\n"]))),ae=Object(u.a)(Y||(Y=Object(r.a)(["\nsubscription subscriptionCallbackTokens ($callback_id: Int!){\n  callbacktoken(where: {deleted: {_eq: false}, callback_id: {_eq: $callback_id}}) {\n    token {\n      TokenId\n      id\n      User\n      description\n    }\n    id\n  }\n}\n"]))),ne=Object(u.a)(Z||(Z=Object(r.a)(["\nsubscription tasksSubscription($callback_id: Int!){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}}, order_by: {id: desc}){\n        id\n        original_params\n        display_params\n        command_name\n        comment\n        tasking_location\n        parameter_group_name\n        status\n        operator{\n            username\n        }\n        command {\n            commandparameters {\n                id\n                type\n                name\n            }\n        }\n    }\n}\n"])));function ie(e){var t={anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:2e3,preventDuplicate:!0,maxSnack:1,style:{marginBottom:"50px"}},a={anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:1e3,preventDuplicate:!0,maxSnack:1,style:{marginBottom:"100px"}},n=d.a.useState(""),r=Object(o.a)(n,2),s=r[0],l=r[1],u=d.a.useState([]),b=Object(o.a)(u,2),p=b[0],m=b[1],O=d.a.useState([]),y=Object(o.a)(O,2),k=y[0],C=y[1],S=d.a.useState(-1),D=Object(o.a)(S,2),I=D[0],T=D[1],$=d.a.useState([]),P=Object(o.a)($,2),A=P[0],E=P[1],L=d.a.useState([]),F=Object(o.a)(L,2),N=F[0],q=F[1],R=d.a.useState(-1),B=Object(o.a)(R,2),M=B[0],U=B[1],G=d.a.useState(!1),K=Object(o.a)(G,2),J=K[0],Y=K[1],Z=d.a.useState([]),X=Object(o.a)(Z,2),ie=X[0],re=X[1],ce=d.a.useState("parsed_cli"),oe=Object(o.a)(ce,2),se=oe[0],le=oe[1],de=d.a.useState(!1),ue=Object(o.a)(de,2),be=ue[0],je=ue[1],pe=d.a.useState(""),me=Object(o.a)(pe,2),he=me[0],fe=me[1],Oe=d.a.useState([]),xe=Object(o.a)(Oe,2),ge=xe[0],ye=xe[1],ve=d.a.useState(-1),_e=Object(o.a)(ve,2),ke=_e[0],we=_e[1],Ce=d.a.useRef(!0),Se=Object(W.a)(z.b);Object(j.a)(ae,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(t){var a=t.subscriptionData;Ce.current&&e.parentMountedRef.current&&re(a.data.callbacktoken)}}),Object(j.a)(ne,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(t){var a=t.subscriptionData;if(Ce.current&&e.parentMountedRef.current){C(a.data.task);var n=a.data.task.filter((function(e){return De(e)}));E(n)}}}),Object(j.a)(te,{variables:{callback_id:e.callback_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(t){var a=t.subscriptionData;if(Ce.current&&e.parentMountedRef.current){var n=a.data.loadedcommands.map((function(e){var t=Object(c.a)({},e.command);return t.attributes=JSON.parse(t.attributes),t}));n.push({cmd:"help",description:"Get help for a command or info about loaded commands",commandparameters:[],attributes:{supported_os:[]}}),n.push({cmd:"clear",description:"Clear 'submitted' jobs from being pulled down by an agent",commandparameters:[],attributes:{supported_os:[]}}),n.sort((function(e,t){return e.cmd>t.cmd?1:-1})),m(n)}}}),d.a.useEffect((function(){var e=k.filter((function(e){return De(e)}));E(e)}),[e.filterOptions]),d.a.useEffect((function(){return function(){Ce.current=!1}}),[]);var De=function(t){if(t.display_params.includes("help")&&t.operator.username!==Se.user.username)return!1;if(void 0===e.filterOptions)return!0;if(e.filterOptions.operatorsList.length>0&&!e.filterOptions.operatorsList.includes(t.operator.username))return!1;if(e.filterOptions.commentsFlag&&""===t.comment)return!1;if(e.filterOptions.commandsList.length>0&&!e.filterOptions.commandsList.includes(t.command_name))return!1;if(e.filterOptions.everythingButList.length>0&&null!==t.command&&e.filterOptions.everythingButList.includes(t.command_name))return!1;if(""!==e.filterOptions.parameterString&&!new RegExp(e.filterOptions.parameterString).test(t.display_params))return!1;return!0},Ie=function(e,a){for(var n=[],i=[],r=[],c=[],o=0;o<a.commandparameters.length;o++)switch(a.commandparameters[o].parameter_type){case"Choice":case"String":n.push(a.commandparameters[o].cli_name);case"Number":c.push(a.commandparameters[o].cli_name);break;case"Boolean":i.push(a.commandparameters[o].cli_name);break;case"Array":case"ChoiceMultiple":r.push(a.commandparameters[o].cli_name);break;default:n.push(a.commandparameters[o].cli_name)}try{var s=function(e){var t=[];if(!e||"string"!==typeof e)return t;var a=!1,n=!1,i=!1,r="";if(e.split("").forEach((function(e,c,o){if(a&&"'"===e)return a=!1,void(r.length>0?r+=e:r+=e+e);if(n&&'"'===e)return n=!1,void(r.length>0?r+=e:r+=e+e);if(!a&&!n){if("'"===e)return a=!0,r.length>0?void(r+=e):void 0;if('"'===e)return n=!0,r.length>0?void(r+=e):void 0;if(["\t"," "].includes(e))return r.length>0&&(["'",'"'].includes(r[r.length-1])?t.push(r.slice(0,-1)):t.push(r),i=!1),void(r="")}if(!a&&n&&'"'===e)return n=!1,void(r.length>0&&(r+=e));r+=e})),(r.length>0||i)&&(["'",'"'].includes(r[r.length-1])?t.push(r.slice(0,-1)):t.push(r),i=!1),n)throw new SyntaxError("unexpected end of string while looking for matching double quote");if(a)throw new SyntaxError("unexpected end of string while looking for matching single quote");return t}(e);return ee()(s,{string:n,boolean:i,number:c,array:r,configuration:{"short-option-groups":!1,"camel-case-expansion":!1,"dot-notation":!1,"unknown-options-as-args":!1,"greedy-arrays":!0}})}catch(l){return void h.b.warning("Failed to parse command line: "+l,t)}},Te=function(e,t){if(0===e.commandparameters.length)return[];for(var a=e.commandparameters.reduce((function(e,t){return e.includes(t.parameter_group_name)?Object(i.a)(e):[].concat(Object(i.a)(e),[t.parameter_group_name])}),[]),n=0,r=Object.keys(t);n<r.length;n++){var c=r[n];if("_"!==c){var o=function(){for(var t=[],n=0;n<e.commandparameters.length;n++)e.commandparameters[n].cli_name===c&&t.push(e.commandparameters[n].parameter_group_name);var r=a.reduce((function(e,a){return t.includes(a)?[].concat(Object(i.a)(e),[a]):Object(i.a)(e)}),[]);if(0===r.length)return{v:[]};a=Object(i.a)(r)}();if("object"===typeof o)return o.v}}return a},$e=function(a,n){a.preventDefault(),a.stopPropagation();var i=s.split(" "),r=p.find((function(e){return e.cmd===i[0]}));if(void 0!==r){var o=["Default"],d={};if(se.includes("modal")||se.includes("browserscript"))try{var u=i.slice(1).join(" ");d=JSON.parse(u),(o=Te(r,d)).sort()}catch(j){return void h.b.warning("Failed to parse modified JSON value",t)}else{var b=Ie(s,r);if(!b)return;if((o=Te(r,b)).sort(),r.commandparameters.length>0){if(d=function(e,t,a){var n=Object(c.a)({},t);if(n._.shift(),0===e.commandparameters.length)return n;if(0===a.length)return n;var i=a[0];a.includes("Default")&&(i="Default");var r=e.commandparameters.filter((function(e){return e.parameter_group_name===i}));r.sort((function(e,t){return e.ui_position<t.ui_position?-1:1}));for(var o=[],s=0;s<r.length;s++)r[s].cli_name in n||o.push(r[s]);for(var l=0;l<o.length-1;l++)n._.length>0&&(n[r[l].cli_name]=n._.shift());return o.length>0&&n._.length>0&&(n._=n._.map((function(e){return"string"===typeof e&&e.includes(" ")?'"'+e+'"':e})),n[o[o.length-1].cli_name]=n._.join(" "),n._=[]),n}(r,b,o),console.log(d),d._.length>0)return void h.b.warning("Too many positional arguments given. Did you mean to quote some of them?",t)}else d=b}if(void 0!==o){if(o.length>1){if(Boolean(n))e.onSubmitCommandLine(s,r,d,Boolean(n),o,se);else{if(!o.includes("Default"))return void h.b.warning("Passed arguments are ambiguous, use shift+enter for modal or provide more parameters",t);e.onSubmitCommandLine(s,r,d,Boolean(n),["Default"],se)}return l(""),T(-1),we(-1),je(!1),void le("parsed_cli")}e.onSubmitCommandLine(s,r,d,Boolean(n),o,se),l(""),T(-1),we(-1),je(!1),le("parsed_cli")}else h.b.warning("Two or more of the specified parameters can't be used together",t)}else h.b.warning("Unknown command",t)};return Object(H.jsxs)(d.a.Fragment,{children:[be&&Object(H.jsx)(_.a,{placeholder:"Search previous commands",onKeyDown:function(e){if("Escape"===e.key)je(!1),we(0),ye([]);else if("Tab"===e.key)je(!1),we(0),ye([]);else if("Enter"===e.key)je(!1),we(0),ye([]),$e(e);else if("ArrowUp"===e.key){if(0===ge.length)return void h.b.warning("No matching options",a);var t=(ke+1)%ge.length;we(t),l(ge[t].command_name+" "+ge[t].original_params)}else if("ArrowDown"===e.key){if(0===ge.length)return void h.b.warning("No matching options",a);var n=(ke-1)%ge.length;n<0&&(n=ge.length-1),we(n),l(ge[n].command_name+" "+ge[n].original_params)}},onChange:function(e){if(fe(e.target.value),0===e.target.value.length)return l(""),ye([]),void we(0);var t=e.target.value.toLowerCase(),a=k.filter((function(e){return(e.command_name+" "+e.original_params).toLowerCase().includes(t)})).filter((function(e){return De(e)}));ye(a),a.length>0&&l(a[0].command_name+" "+a[0].original_params)},size:"small",autoFocus:!0,variant:"outlined",value:he,fullWidth:!0,InputProps:{type:"search",startAdornment:Object(H.jsx)(d.a.Fragment,{children:Object(H.jsx)(x.a,{style:{width:"10%"},children:"reverse-i-search:"})})}}),Object(H.jsx)(_.a,{placeholder:"Task an agent...",onKeyDown:function(a){if("r"===a.key&&a.ctrlKey&&(je(!0),l(""),fe(""),le("parsed_cli")),"Tab"===a.key)if(a.stopPropagation(),a.preventDefault(),le("parsed_cli"),s.includes(" ")){var n=p.find((function(e){return e.cmd===s.split(" ")[0]}));if(n.commandparameters.length>0){if(" "!==s[s.length-1]){if(N.length>0){var r=(M+1)%N.length;U(r);var c=s.split(" ").slice(0,-1).join(" ")+" -"+N[r];return void l(c)}var d=s.split(" "),u=d.slice(-1)[0];if(u.startsWith("-")){var b=Ie(d.slice(0,-1).join(" "),n),j=Te(n,b);if(void 0===j)return void h.b.warning("Two or more of the specified parameters can't be used together",t);var m=[];if(n.commandparameters.find((function(e){return j.includes(e.parameter_group_name)&&e.cli_name===u.slice(1)&&!(e.cli_name in b)}))?(m=n.commandparameters.reduce((function(e,t){return j.includes(t.parameter_group_name)&&t.cli_name!==u.slice(1)&&!(t.cli_name in b)?[].concat(Object(i.a)(e),[t.cli_name]):Object(i.a)(e)}),[])).push(u.slice(1)):m=n.commandparameters.reduce((function(e,t){return j.includes(t.parameter_group_name)&&t.cli_name.toLowerCase().startsWith(u.slice(1).toLocaleLowerCase())&&!(t.cli_name in b)?[].concat(Object(i.a)(e),[t.cli_name]):Object(i.a)(e)}),[]),m.length>0){if(1===m.length){q([]),U(0);var f=d.slice(0,-1).join(" ")+" -"+m[0];l(f)}else{q(m),U(0);var O=d.slice(0,-1).join(" ")+" -"+m[0];l(O)}return}return void h.b.warning("Unknown Parameter Name",t)}return}var x=Ie(s,n),g=Te(n,x);if(void 0===g)return void h.b.warning("Two or more of the specified parameters can't be used together",t);console.log("cmdGroupNames in tab",g);for(var y=0,v=Object.entries(x);y<v.length;y++){var _=Object(o.a)(v[y],2),k=_[0],w=_[1];if("_"!==k){if(w!==w||void 0===w)return void h.b.warning(k+" needs a valid value",t);if(void 0===w){if(s.endsWith(" -"+k)){for(var C=0;C<n.commandparameters.length;C++)if(n.commandparameters[C].required&&!(n.commandparameters[C].cli_name in x)&&(g.includes(n.commandparameters[C].parameter_group_name)||0===g.length)){var S=s.trim().slice(0,-1*k.length)+n.commandparameters[C].cli_name;return void l(S)}for(var D=0;D<n.commandparameters.length;D++)if(!n.commandparameters[D].required&&!(n.commandparameters[D].cli_name in x)&&(g.includes(n.commandparameters[D].parameter_group_name)||0===g.length)){var $=s.trim().slice(0,-1*k.length)+n.commandparameters[D].cli_name;return void l($)}}return void h.b.warning(k+" needs a value",t)}}}for(var P=0;P<n.commandparameters.length;P++)if(n.commandparameters[P].required&&!(n.commandparameters[P].cli_name in x)&&(g.includes(n.commandparameters[P].parameter_group_name)||0===g.length)){var E=s.trim()+" -"+n.commandparameters[P].cli_name;return void l(E)}for(var L=0;L<n.commandparameters.length;L++)if(!n.commandparameters[L].required&&!(n.commandparameters[L].cli_name in x)&&(g.includes(n.commandparameters[L].parameter_group_name)||0===g.length)){var F=s.trim()+" -"+n.commandparameters[L].cli_name;return void l(F)}h.b.info("No more arguments for command",t)}else h.b.info("No arguments for command",t)}else if(0===N.length){var R=p.filter((function(t){return t.cmd.toLowerCase().startsWith(s.toLocaleLowerCase())&&(0===t.attributes.supported_os.length||t.attributes.supported_os.includes(e.callback_os))}));q(R),U(0),R.length>0&&l(R[0].cmd)}else U((M+1)%N.length),l(N[(M+1)%N.length].cmd);else if("Enter"===a.key)a.shiftKey?$e(a,!0):$e(a,!1);else if("ArrowUp"===a.key){if(0===A.length)return void h.b.warning("No previous tasks",t);var B=I+1;B>A.length-1&&(B=A.length-1),T(B),l(A[B].command_name+" "+A[B].original_params),le(A[B].tasking_location)}else if("ArrowDown"===a.key){if(0===A.length)return void h.b.warning("No previous tasks",t);var z=I-1;z<0&&(z=0),T(z),l(A[z].command_name+" "+A[z].original_params),le(A[z].tasking_location)}else q([]),U(0),-1!==I&&T(-1)},onChange:function(e){q([]),U(0),l(e.target.value),0===e.target.value.length&&le("parsed_cli")},size:"small",variant:"outlined",disabled:be,value:s,autoFocus:!0,fullWidth:!0,style:{marginBottom:"10px"},InputProps:{type:"search",endAdornment:Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsx)(g.a,{color:"primary",variant:"contained",onClick:$e,children:Object(H.jsx)(v.a,{})}),Object(H.jsx)(g.a,{color:"secondary",variant:"contained",onClick:function(){Y(!0)},children:Object(H.jsx)(w.a,{})})]}),startAdornment:Object(H.jsx)(d.a.Fragment,{children:ie.length>0?Object(H.jsx)(Q,{options:ie,changeSelectedToken:e.changeSelectedToken}):null})}}),J&&Object(H.jsx)(f.a,{fullWidth:!0,maxWidth:"md",open:J,onClose:function(){Y(!1)},innerDialog:Object(H.jsx)(V,{filterCommandOptions:p,onSubmit:e.onSubmitFilter,filterOptions:e.filterOptions,onClose:function(){Y(!1)}})})]})}var re,ce,oe,se,le=d.a.memo(ie),de=a(225),ue=a(495),be=a.n(ue),je=a(19);function pe(e){var t=d.a.useState(e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?e.tabInfo.callbackDescription:"Callback: "+e.tabInfo.callbackID),a=Object(o.a)(t,2),n=a[0],i=a[1],r=d.a.useState(!1),u=Object(o.a)(r,2),b=u[0],j=u[1];Object(l.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):e.tabInfo.payloadDescription!==e.tabInfo.callbackDescription?i(e.tabInfo.callbackDescription):i("Callback: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(H.jsxs)(d.a.Fragment,{children:[Object(H.jsx)(s.b,Object(c.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),j(!0)}},e)),b&&Object(H.jsx)(f.a,{fullWidth:!0,open:b,onClose:function(){j(!1)},innerDialog:Object(H.jsx)(f.b,{title:"Edit Tab's Description",onClose:function(){j(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var me=Object(u.a)(re||(re=Object(r.a)(["\n    fragment taskData on task {\n        comment\n        callback_id\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        display_params\n        status\n        timestamp\n        command {\n          cmd\n          id\n        }\n        command_name\n        responses(limit: 1, order_by: {id: desc}){\n            id\n            timestamp\n        }\n        opsec_pre_blocked\n        opsec_pre_bypassed\n        opsec_post_blocked\n        opsec_post_bypassed\n        tasks {\n            id\n        }\n        token {\n            id\n        }\n    }\n"]))),he=Object(u.a)(ce||(ce=Object(r.a)(["\nmutation createTasking($callback_id: Int!, $command: String!, $params: String!, $files: [String], $token_id: Int, $tasking_location: String, $original_params: String, $parameter_group_name: String) {\n  createTask(callback_id: $callback_id, command: $command, params: $params, files: $files, token: $token_id, tasking_location: $tasking_location, original_params: $original_params, parameter_group_name: $parameter_group_name) {\n    status\n    id\n    error\n  }\n}\n"]))),fe=Object(u.a)(oe||(oe=Object(r.a)(["\n","\nsubscription getTasking($callback_id: Int!, $fromNow: timestamp!, $limit: Int){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}, timestamp: {_gt: $fromNow}}, order_by: {id: desc}, limit: $limit) {\n        ...taskData\n    }\n}\n "])),me),Oe=Object(u.a)(se||(se=Object(r.a)(["\n","\nquery getBatchTasking($callback_id: Int!, $offset: Int!, $fetchLimit: Int!){\n    task(where: {callback_id: {_eq: $callback_id}, parent_task_id: {_is_null: true}}, order_by: {id: desc}, limit: $fetchLimit, offset: $offset) {\n        ...taskData\n    }\n    callback(where: {id: {_eq: $callback_id}}){\n        id\n    }\n}\n"])),me),xe=function(e){var t=e.tabInfo,a=e.index,n=e.value,r=e.onCloseTab,u=e.parentMountedRef,x=d.a.useState(10),y=Object(o.a)(x,2),v=y[0],_=y[1],k=d.a.useState(!1),w=Object(o.a)(k,2),C=w[0],S=w[1],D=d.a.useState({}),I=Object(o.a)(D,2),T=I[0],$=I[1],P=d.a.useState({task:[]}),A=Object(o.a)(P,2),E=A[0],L=A[1],F=d.a.useRef({task:[]}),N=d.a.useState((new Date).toISOString()),q=Object(o.a)(N,2),R=q[0],B=(q[1],d.a.useState({})),M=Object(o.a)(B,2),z=M[0],W=M[1],U=d.a.useState({operatorsList:[],commentsFlag:!1,commandsList:[],parameterString:"",everythingButList:[]}),G=Object(o.a)(U,2),K=G[0],V=G[1],Q=d.a.useState(!0),J=Object(o.a)(Q,2),Y=J[0],Z=J[1],X=d.a.useRef(!0);Object(l.useEffect)((function(){F.current=E}),[E]);var ee=d.a.useState(!1),te=Object(o.a)(ee,2),ae=te[0],ne=te[1],ie=d.a.useState(!1),re=Object(o.a)(ie,2),ce=re[0],oe=re[1],se=Object(l.useRef)(null),ue=Object(b.a)(he,{update:function(e,t){var a=t.data;"error"===a.createTask.status?h.b.error(a.createTask.error):h.b.success("Task created",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),pe=Object(o.a)(ue,1)[0],me=Object(l.useCallback)((function(e){var t=e.subscriptionData;if(X&&!X.current||u&&!u.current)return null;ae||ne(!0);var a=F.current.task.length,n=t.data.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):[].concat(Object(i.a)(e),[t])}),Object(i.a)(F.current.task));n.sort((function(e,t){return e.id<t.id?-1:1})),function(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++){if(e[a].comment!==t[a].comment)return!1;if(e[a].commentOperator!==t[a].commentOperator)return!1;if(e[a].completed!==t[a].completed)return!1;if(e[a].display_params!==t[a].display_params)return!1;if(e[a].original_params!==t[a].original_params)return!1;if(e[a].status!==t[a].status)return!1;if(e[a].timestamp!==t[a].timestamp)return!1;if(e[a].opsec_pre_blocked!==t[a].opsec_pre_blocked)return!1;if(e[a].opsec_pre_bypassed!==t[a].opsec_pre_bypassed)return!1;if(e[a].opsec_post_blocked!==t[a].opsec_post_blocked)return!1;if(e[a].opsec_post_bypassed!==t[a].opsec_post_bypassed)return!1;if(e[a].tasks.length!==t[a].tasks.length)return!1}return!0}(F.current.task,n)||L({task:n}),n.length>a&&Z(!0),n.length>v&&_(n.length)}),[ae,ne,Z,v]);Object(j.a)(fe,{variables:{callback_id:t.callbackID,fromNow:R,limit:v},onError:function(e){console.error(e)},fetchPolicy:"no-cache",onSubscriptionData:me});var xe=Object(l.useCallback)((function(){E&&se.current&&se.current.scrollIntoView({behavior:"smooth"})}),[E,se]);Object(l.useLayoutEffect)((function(){Y&&(xe(),Z(!1))}),[Y,xe]);var ge=Object(p.a)(Oe,{onError:function(e){console.error(e)},onCompleted:function(e){var a=!1;if(0!==e.callback.length){var n=e.task.reduce((function(e,t){return e.findIndex((function(e){return e.id===t.id}))>-1?e.map((function(e){return e.id===t.id?t:e})):(a=!0,[].concat(Object(i.a)(e),[t]))}),Object(i.a)(E.task));n.sort((function(e,t){return e.id<t.id?-1:1})),L({task:n}),a?e.task.length<10?oe(!0):oe(!1):oe(!0)}else r(t)},fetchPolicy:"no-cache"}),ye=Object(o.a)(ge,2),ve=ye[0],_e=ye[1].loading;Object(l.useEffect)((function(){return ve({variables:{callback_id:t.callbackID,offset:E.task.length,fetchLimit:10}}),Z(!0),function(){X.current=!1}}),[]);var ke=function(e){var t=e.callback_id,a=e.command,n=e.params,i=e.files,r=e.tasking_location,c=e.original_params,o=e.parameter_group_name;void 0!==z.id?pe({variables:{callback_id:t,command:a,params:n,files:i,token_id:z.TokenId,tasking_location:r,original_params:c,parameter_group_name:o}}):pe({variables:{callback_id:t,command:a,params:n,files:i,tasking_location:r,original_params:c,parameter_group_name:o}})};return Object(H.jsxs)(s.c,{index:a,value:n,children:[!ce&&Object(H.jsx)(je.a,{title:"Fetch Older Tasks",children:Object(H.jsx)(g.a,{onClick:function(){ve({variables:{callback_id:t.callbackID,offset:E.task.length,fetchLimit:10}})},variant:"contained",color:"primary",style:{marginLeft:"50%"},children:Object(H.jsx)(be.a,{})})}),!ae&&Object(H.jsx)(de.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}}),_e&&Object(H.jsx)(de.a,{color:"primary",thickness:2,style:{paddingTop:"5px"}}),Object(H.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:E.task.map((function(e){return Object(H.jsx)(m.a,{task:e,command_id:null==e.command?0:e.command.id,filterOptions:K},"taskinteractdisplay"+e.id)}))}),Object(H.jsx)("div",{ref:se}),Object(H.jsx)(le,{onSubmitFilter:function(e){V(e)},onSubmitCommandLine:function(e,a,n,i,r,o){var s=e.split(" ");delete s[0],s=s.join(" ").trim();var l="parsed_cli";if(o.includes("modal")?l="modal_modified":o.includes("browserscript")&&(l="browserscript_modified"),0===a.commandparameters.length)ke({callback_id:t.callbackID,command:a.cmd,params:s,parameter_group_name:"Default"});else{var d=a.commandparameters.find((function(e){return"File"===e.parameter_type&&r.includes(e.parameter_group_name)})),u=!1;if(1===r.length){var b=a.commandparameters.filter((function(e){return e.required&&e.parameter_group_name===r[0]&&!(e.cli_name in n)}));b.length>0&&(u=!0,console.log("missing required params",b,n))}else r>1&&!i&&(console.log("command is ambiguous"),i=!0);if(d||i||u)return r.length>0?$(Object(c.a)(Object(c.a)({},a),{},{parsedParameters:n,groupName:r[0]})):$(Object(c.a)(Object(c.a)({},a),{},{parsedParameters:n})),void S(!0);delete n._,ke({callback_id:t.callbackID,command:a.cmd,params:JSON.stringify(n),tasking_location:l,original_params:s,parameter_group_name:r[0]})}},changeSelectedToken:function(e){"Default Token"!==e?e.TokenId!==z.TokenId&&W(e):W("Default Token")},filterOptions:K,callback_id:t.callbackID,callback_os:t.os,parentMountedRef:X}),C&&Object(H.jsx)(f.a,{fullWidth:!0,maxWidth:"md",open:C,onClose:function(){S(!1)},innerDialog:Object(H.jsx)(O.a,{command:T,callback_id:t.callbackID,payloadtype_id:t.payloadtype_id,operation_id:t.operation_id,onSubmit:function(e,a,n,i){S(!1),ke({callback_id:t.callbackID,command:e,params:a,files:n,tasking_location:"modal",parameter_group_name:i})},onClose:function(){S(!1)}})})]})}},13:function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return v})),a.d(t,"c",(function(){return _})),a.d(t,"d",(function(){return k}));var n=a(6),i=a(2),r=a(1),c=a.n(r),o=a(836),s=a(54),l=a(97),d=a(96),u=a(111),b=a(17),j=a(248),p=a(250),m=a(77),h=a(247),f=a(249),O=a(134),x=a(73),g=a(0);function y(e){var t=c.a.useRef(null);return c.a.useEffect((function(){if(e.open){var a=t.current;null!==a&&a.focus()}}),[e.open]),Object(g.jsx)(o.a,{open:e.open,onClose:e.onClose,scroll:"paper",maxWidth:e.maxWidth,fullWidth:e.fullWidth,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:e.innerDialog})}function v(e){var t=c.a.useState(""),a=Object(i.a)(t,2),n=a[0],o=a[1],j=function(){e.onSubmit(n),e.onClose()};return Object(r.useEffect)((function(){o(e.value)}),[e.value]),Object(g.jsxs)(c.a.Fragment,{children:[Object(g.jsx)(u.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(d.a,{dividers:!0,children:Object(g.jsx)(b.a,{autoFocus:!0,onEnter:j,onChange:function(e,t,a){o(t)},value:n})}),Object(g.jsxs)(l.a,{children:[Object(g.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(g.jsx)(s.a,{onClick:j,variant:"contained",color:"secondary",children:"Submit"})]})]})}function _(e){var t=c.a.useState([]),a=Object(i.a)(t,2),n=a[0],o=a[1],b=c.a.useState("dictionary"),y=Object(i.a)(b,2),v=y[0],_=y[1],k=c.a.useState([]),w=Object(i.a)(k,2),C=w[0],S=w[1];return Object(r.useEffect)((function(){var t=[];try{var a;if((a=e.value.constructor===Object?e.value:JSON.parse(e.value)).constructor===Object)for(var n in a)a[n].constructor===Object||Array.isArray(a[n])?t.push({name:n,value:JSON.stringify(a[n],null,2)}):t.push({name:n,value:a[n]}),S([e.leftColumn,e.rightColumn]);else _("array"),a.length>0?(S(Object.keys(a[0])),t=a):S([])}catch(i){console.log(i)}o(t)}),[e.value,e.leftColumn,e.rightColumn]),Object(g.jsxs)(c.a.Fragment,{children:[Object(g.jsx)(u.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(d.a,{dividers:!0,children:Object(g.jsx)(x.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(g.jsx)(h.a,{component:x.a,className:"mythicElement",children:Object(g.jsxs)(j.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(f.a,{children:Object(g.jsx)(O.a,{children:C.map((function(e,t){return Object(g.jsx)(m.a,{children:e},"header"+t)}))})}),Object(g.jsx)(p.a,{children:"dictionary"===v?n.map((function(e,t){return Object(g.jsxs)(O.a,{hover:!0,children:[Object(g.jsx)(m.a,{children:e.name}),Object(g.jsx)(m.a,{style:{wordBreak:"break-all",whiteSpace:"pre-wrap"},children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)})):n.map((function(e,t){return Object(g.jsx)(O.a,{hover:!0,children:Object.keys(e).map((function(a){return Object(g.jsx)(m.a,{children:e[a]},"row"+t+"cell"+a)}))},"row"+t)}))})]})})})}),Object(g.jsx)(l.a,{children:Object(g.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function k(e){var t=c.a.useState([]),a=Object(i.a)(t,2),o=a[0],b=a[1];return Object(r.useEffect)((function(){var t=e.keys.reduce((function(t,a){return void 0!==e.value[a]&&null!==e.value[a]&&""!==e.value[a]?[].concat(Object(n.a)(t),[{name:a,value:e.value[a]}]):Object(n.a)(t)}),[]);b(t)}),[e.value,e.keys]),Object(g.jsxs)(c.a.Fragment,{children:[Object(g.jsx)(u.a,{id:"form-dialog-title",children:e.title}),Object(g.jsx)(d.a,{dividers:!0,children:Object(g.jsx)(x.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(g.jsx)(h.a,{component:x.a,className:"mythicElement",children:Object(g.jsxs)(j.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(g.jsx)(f.a,{children:Object(g.jsxs)(O.a,{children:[Object(g.jsx)(m.a,{children:e.leftColumn}),Object(g.jsx)(m.a,{children:e.rightColumn})]})}),Object(g.jsx)(p.a,{children:o.map((function(e,t){return Object(g.jsxs)(O.a,{children:[Object(g.jsx)(m.a,{children:e.name}),Object(g.jsx)(m.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})})}),Object(g.jsx)(l.a,{children:Object(g.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},132:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n,i=a(3),r=a(6),c=a(2),o=a(7),s=a(1),l=a.n(s),d=a(57),u=a(197),b=a(195),j=a(4),p=a(13),m=a(222),h=a(109),f=a(218),O=a(71),x=a(0),g=Object(d.a)(n||(n=Object(o.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!, $ui_feature: String!) {\n    callback_by_pk(id: $callback_id){\n        operation_id\n        active\n        payload {\n            payloadtype {\n                id\n            }\n        }\n        loadedcommands(where: {command: {supported_ui_features: {_ilike: $ui_feature}}}) {\n            id\n            command {\n              cmd\n              help_cmd\n              description\n              id\n              needs_admin\n              payload_type_id\n              attributes\n              commandparameters {\n                id\n                type \n              }\n              supported_ui_features\n            }\n        }\n        callbacktokens(where: {deleted: {_eq: false}}) {\n            token {\n              TokenId\n              id\n              User\n              description\n            }\n            id\n        }\n    }\n}\n"]))),y=function(e){var t=e.callback_id,a=e.ui_feature,n=e.parameters,o=e.onTasked,d=e.tasking_location,y=e.getConfirmation,v=e.openDialog,_=l.a.useState([]),k=Object(c.a)(_,2),w=k[0],C=k[1],S=l.a.useState(!1),D=Object(c.a)(S,2),I=D[0],T=D[1],$=l.a.useState(!1),P=Object(c.a)($,2),A=P[0],E=P[1],L=l.a.useState({}),F=Object(c.a)(L,2),N=F[0],q=F[1],R=l.a.useState([]),B=Object(c.a)(R,2),M=B[0],z=B[1],W=l.a.useState({}),H=Object(c.a)(W,2),U=H[0],G=H[1],K=l.a.useState(!1),V=Object(c.a)(K,2),Q=V[0],J=V[1],Y=l.a.useState({}),Z=Object(c.a)(Y,2),X=Z[0],ee=Z[1],te=l.a.useState(!1),ae=Object(c.a)(te,2),ne=ae[0],ie=ae[1],re=l.a.useRef({}),ce=Object(u.a)(h.c,{update:function(e,a){var n=a.data;"error"===n.createTask.status?(j.b.error(n.createTask.error),o({tasked:!1})):(j.b.success('Issued "'+N.cmd+'" to Callback '+t),o({tasked:!0,variables:re.current}))},onError:function(e){console.error(e),o({tasked:!1})}}),oe=Object(c.a)(ce,1)[0],se=Object(b.a)(g,{variables:{callback_id:t,ui_feature:"%"+a+"%"},onCompleted:function(e){if(null===e.callback_by_pk)return j.b.warning("Unknown callback"),void o({tasked:!1});if(!e.callback_by_pk.active)return j.b.warning("Callback isn't active"),void o({tasked:!1});var t=e.callback_by_pk.loadedcommands.reduce((function(e,t){return"string"===typeof n?[].concat(Object(r.a)(e),[Object(i.a)(Object(i.a)({},t.command),{},{parsedParameters:{}})]):(console.log("adding in parsed parameters",n),[].concat(Object(r.a)(e),[Object(i.a)(Object(i.a)({},t.command),{},{parsedParameters:n})]))}),[]),c=e.callback_by_pk.callbacktokens.reduce((function(e,t){return[].concat(Object(r.a)(e),[Object(i.a)(Object(i.a)({},t.token),{},{display:null===t.token.User?t.token.TokenId+" - "+t.token.description:t.token.User+" - "+t.token.description})])}),[]);z(c),C(t),0===t.length?j.b.warning("No commands currently loaded that support the "+a+" feature"):1===t.length?q(Object(i.a)({},t[0])):(q({}),T(!0))},fetchPolicy:"no-cache"}).data,le=function(e){var t=e.variables;if(y)return ee(t),void ie(!0);M.length>0?(J(!0),ee(t)):oe({variables:t})};return Object(s.useEffect)((function(){""===U&&oe({variables:X}),U.TokenId&&oe({variables:Object(i.a)(Object(i.a)({},X),{},{token_id:U.TokenId})})}),[U]),Object(s.useEffect)((function(){if(void 0!==N.commandparameters)if(v&&N.commandparameters.length>0)E(!0);else{var e=d||"browserscript";N.commandparameters.length>0?void 0===n||null===n?E(!0):(re.current=n,le("string"===typeof n?{variables:{callback_id:t,command:N.cmd,params:n,tasking_location:"command_line"}}:{variables:{callback_id:t,command:N.cmd,params:JSON.stringify(n),tasking_location:e}})):void 0===n||null===n?(re.current="",le({variables:{callback_id:t,command:N.cmd,params:""}})):(re.current=n,le("string"===typeof n?{variables:{callback_id:t,command:N.cmd,params:n,tasking_location:"command_line"}}:{variables:{callback_id:t,command:N.cmd,params:JSON.stringify(n),tasking_location:e}}))}}),[N]),Object(x.jsxs)("div",{children:[I&&Object(x.jsx)(p.a,{fullWidth:!0,maxWidth:"sm",open:I,onClose:function(){T(!1),o({tasked:!1})},innerDialog:Object(x.jsx)(m.a,{onClose:function(){T(!1)},onSubmit:function(e){q(e)},options:w,title:"Select Command",action:"select",identifier:"id",display:"cmd"})}),A&&Object(x.jsx)(p.a,{fullWidth:!0,maxWidth:"lg",open:A,onClose:function(){E(!1),o({tasked:!1})},innerDialog:Object(x.jsx)(f.a,{command:N,callback_id:t,payloadtype_id:se.callback_by_pk.payload.payloadtype.id,operation_id:se.callback_by_pk.operation_id,onSubmit:function(e,a,n){E(!1),re.current=a,le({variables:{callback_id:t,command:e,params:a,files:n,tasking_location:"modal"}})},onClose:function(){E(!1)}})}),Q&&Object(x.jsx)(p.a,{fullWidth:!0,maxWidth:"sm",open:Q,onClose:function(){J(!1),o({tasked:!1})},innerDialog:Object(x.jsx)(m.a,{onClose:function(){J(!1),o({tasked:!1})},onSubmit:function(e){G(e)},dontCloseOnSubmit:!0,options:M,title:"Select Token",action:"select",identifier:"id",display:"display"})}),ne&&Object(x.jsx)(O.a,{onClose:function(){ie(!1),o({tasked:!1})},onSubmit:function(){M.length>0?J(!0):oe({variables:X})},open:ne})]})}},139:function(e,t,a){"use strict";function n(e){try{var t=document.createElement("textarea");return t.value=e,""===t.value&&(t.value=" "),t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(a){return console.log("warning","Failed to copy to clipboard: "+a.toString()),!1}}a.d(t,"a",(function(){return n}))},16:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return l}));var n=a(3),i=a(152),r=Object(i.c)({loggedIn:!1,user:null,access_token:null,refresh_token:null}),c=Object(i.c)(!1),o=function(e){localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),localStorage.setItem("user",JSON.stringify(e.user)),r(Object(n.a)({loggedIn:!0},e))},s=function(e){localStorage.setItem("access_token",e.access_token),r(Object(n.a)({loggedIn:!0,access_token:localStorage.getItem("access_token")},r()))},l=function(){console.log("failed refresh"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),r({loggedIn:!1,access_token:null,refresh_token:null,user:null})}},17:function(e,t,a){"use strict";var n=a(464),i=a(465),r=a(532),c=a(531),o=a(1),s=a.n(o),l=a(827),d=a(11),u=a(0),b=Object(d.a)({root:{"& input:valid + fieldset":{borderColor:"grey",borderWidth:1},"& input:invalid + fieldset":{borderColor:"red",borderWidth:2},"& input:valid:focus + fieldset":{borderLeftWidth:6,padding:"4px !important"}}})(l.a),j=function(e){Object(r.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onChange=function(t){var a=e.props.name,n=t.target.value,i=!!e.props.validate&&e.props.validate(n);e.props.onChange(a,n,i)},e.checkError=function(){return!!e.props.validate&&e.props.validate(e.props.value)},e.onKeyPress=function(t){"Enter"===t.key?void 0!==e.props.onEnter&&e.props.onEnter():e.onChange(t)},e}return Object(i.a)(a,[{key:"render",value:function(){return Object(u.jsx)("div",{style:{width:this.props.width?this.props.width+"rem":"100%"},children:Object(u.jsx)(b,{fullWidth:!0,placeholder:this.props.placeholder,value:this.props.value,onChange:this.onChange,onKeyPress:this.onKeyPress,label:this.props.name,autoFocus:!!this.props.autoFocus,variant:"outlined",disabled:void 0!==this.props.disabled&&this.props.disabled,required:!!this.props.requiredValue&&this.props.requiredValue,InputLabelProps:this.props.inputLabelProps,multiline:!!this.props.multiline&&this.props.multiline,error:this.checkError(),type:void 0===this.props.type?"text":this.props.type,InputProps:this.props.InputProps,helperText:this.checkError()?this.props.errorText:this.props.helperText,style:{padding:0,marginBottom:this.props.marginBottom?this.props.marginBottom:"10px"}})})}}]),a}(s.a.Component);t.a=j},170:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(360),i=Object(n.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"}}})},172:function(e,t,a){"use strict";var n=a(3),i=a(6),r=a(2),c=a(86),o=a(1),s=a.n(o),l=a(169),d=a(481),u=a.n(d),b=a(173),j=a(916),p=a(58),m=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250,n=Object(o.useState)(0),i=Object(r.a)(n,2),c=i[0],s=i[1];return Object(o.useEffect)((function(){var n=setTimeout((function(){1===c&&e(),s(0)}),a);return 2===c&&t(),function(){return clearTimeout(n)}}),[a,e,t,c]),function(){return s((function(e){return e+1}))}},h=a(142),f=Object(h.a)((function(e){return{headerCellRow:{display:"flex",flexDirection:"row",position:"sticky",top:"0",left:"0",right:"0",zIndex:1},headerCell:{display:"flex",alignItems:"center",padding:"0 0.25em",boxSizing:"border-box",justifyContent:"space-between",userSelect:"none",backgroundColor:e.palette.background.paper,borderTop:"1px solid "+e.tableHover,borderRight:"1px solid "+e.tableHover,borderBottom:"1px solid  "+e.tableHover,"&:first-child":{borderLeft:"1px solid "+e.tableHover},"&:hover":{backgroundColor:e.tableHover,cursor:"pointer"}},hoveredRow:{backgroundColor:e.tableHover},cell:{display:"flex",alignItems:"center",padding:"0 0.5em",boxSizing:"border-box",fontFamily:"monospace",borderBottom:"1px solid "+e.tableHover,cursor:"default !important"},cellInner:{width:"100%",whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"},draggableHandlesContainer:{position:"absolute",top:0,overflowX:"hidden"},draggableHandlesClickArea:{position:"absolute",top:0,width:"16px",cursor:"col-resize",pointerEvents:"initial"},draggableHandlesIndicator:{position:"absolute",top:0,left:8,width:"1px",backgroundImage:"linear-gradient(#7f93c0, #00000000)"}}})),O=a(41),x=a(30),g=a(536),y=a(842),v=a(366),_=a(832),k=a(834),w=a(73),C=a(51),S=a(0),D=["style","rowIndex","columnIndex","data"],I=function(e){var t=e.onClick,a=void 0===t?function(){}:t,i=e.onDoubleClick,l=void 0===i?function(){}:i,d=e.contextMenuOptions,u=void 0===d?[]:d,b=e.sortIndicatorIndex,h=e.sortDirection,I=e.headerNameKey,T=void 0===I?"name":I,$=e.VariableSizeGridProps,P=$.style,A=$.rowIndex,E=$.columnIndex,L=$.data,F=(Object(c.a)($,D),f()),N=s.a.useRef(null),q=Object(C.a)(),R=L.items[A][E],B=(null===R||void 0===R?void 0:R.filtered)||!1,M=Object(o.useCallback)((function(e){a(e,E)}),[a,E]),z=Object(o.useCallback)((function(e){l(e,E)}),[l,E]),W=s.a.useState(!1),H=Object(r.a)(W,2),U=H[0],G=H[1],K=Object(o.useCallback)((function(e){e.preventDefault(),R.disableFilterMenu||u&&u.length>0&&G(!0)}),[u,E]),V=function(e){N.current&&N.current.contains(e.target)||G(!1)},Q=m(M,z);return Object(S.jsx)("div",{style:P,className:F.headerCell,onClick:Q,onContextMenu:K,ref:N,children:Object(S.jsxs)(j.a,{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",children:[Object(S.jsx)(p.a,{className:F.cellInner,variant:"body1",children:R[T].toUpperCase()}),B?Object(S.jsx)(O.a,{icon:x.s}):null,b===E&&("ASC"===h?Object(S.jsx)("div",{children:"\u2191"}):Object(S.jsx)("div",{children:"\u2193"})),Object(S.jsx)(y.a,{open:U,anchorEl:N.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(S.jsx)(g.a,Object(n.a)(Object(n.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(S.jsx)(w.a,{variant:"outlined",style:{backgroundColor:"dark"===q.palette.type?q.palette.primary.dark:q.palette.primary.light,color:"white"},children:Object(S.jsx)(k.a,{onClickAway:V,children:Object(S.jsx)(_.a,{id:"split-button-menu",children:u.map((function(e,t){return Object(S.jsx)(v.a,{onClick:function(e){return function(e,t){u[t].click({event:e,columnIndex:E}),G(!1)}(e,t)},children:e.name},e.name+t)}))})})})}))}})]})})},T=a(189),$=function(e){var t,a,i,r,c,s=e.VariableSizeGridProps,l=s.style,d=s.rowIndex,u=s.columnIndex,b=s.data,j=b.gridUUID+"row"+d,p=f(),m=Object(o.useCallback)((function(e){b.onDoubleClickRow(e,d-1)}),[b,d]),h=b.items[d][u],O=(null===h||void 0===h||null===(t=h.props)||void 0===t||null===(a=t.cellData)||void 0===a?void 0:a.cellStyle)||{},x=(null===(i=b.items[d][u])||void 0===i||null===(r=i.props)||void 0===r||null===(c=r.rowData)||void 0===c?void 0:c.rowStyle)||{};return Object(S.jsx)("div",{style:Object(n.a)(Object(n.a)(Object(n.a)({},l),O),x),className:"".concat(p.cell," ").concat(j),onDoubleClick:m,onMouseEnter:function(){var e=document.getElementsByClassName(j);if(e.length>0){var t,a=Object(T.a)(e);try{for(a.s();!(t=a.n()).done;){t.value.classList.add(p.hoveredRow)}}catch(n){a.e(n)}finally{a.f()}}},onMouseLeave:function(){var e=document.getElementsByClassName(j);if(e.length>0){var t,a=Object(T.a)(e);try{for(a.s();!(t=a.n()).done;){t.value.classList.remove(p.hoveredRow)}}catch(n){a.e(n)}finally{a.f()}}},children:Object(S.jsx)("div",{className:p.cellInner,children:h})})},P=a(482),A=a.n(P),E=s.a.forwardRef((function(e,t){var a=e.height,n=e.rowHeight,i=e.width,c=e.minColumnWidth,s=e.columnWidths,l=e.onStop,d=f(),u=Object(o.useState)(!1),b=Object(r.a)(u,2),j=b[0],p=b[1];return Object(S.jsx)("div",{ref:t,className:d.draggableHandlesContainer,style:{height:a,width:i,pointerEvents:j?"initial":"none"},children:s.map((function(e,t){var i=s.slice(0,t).reduce((function(e,t){return e+t}),0);return Object(S.jsx)(A.a,{axis:"x",bounds:{left:c-s[t],right:Number.POSITIVE_INFINITY,top:0,bottom:0},position:j?null:{x:0,y:0},onStart:function(){p(t)},onStop:function(e,a){p(!1),l(a.x,t)},children:Object(S.jsx)("div",{className:d.draggableHandlesClickArea,style:{left:i+s[t]-1-8,height:n},children:Object(S.jsx)("div",{className:d.draggableHandlesIndicator,style:{display:j===t?"block":"none",height:a/2}})})},t)}))})})),L=["columns","sortIndicatorIndex","sortDirection","items","headerNameKey","onClickHeader","onDoubleClickRow","contextMenuOptions","rowHeight","widthMeasureKey"],F=["children"],N=100,q=function(e){return 0===e.rowIndex?null:Object(S.jsx)($,{VariableSizeGridProps:e})},R=function(e){var t=e.columns,a=e.sortIndicatorIndex,l=e.sortDirection,d=e.items,j=e.headerNameKey,p=e.onClickHeader,m=e.onDoubleClickRow,h=e.contextMenuOptions,O=e.rowHeight,x=e.widthMeasureKey,g=Object(c.a)(e,L),y=u()().width,v=Object(o.useState)(t.map((function(e){return e.width||N}))),_=Object(r.a)(v,2),k=_[0],w=_[1],C=Object(o.useRef)(null),D=Object(o.useRef)(null),T=Object(o.useCallback)((function(e){return k[e]||N}),[k]),$=s.a.useMemo((function(){return(Math.random()+1).toString(36).substring(2)}),[]),P=Object(o.useCallback)((function(e){return O}),[O]);Object(o.useEffect)((function(){var e=g.width-y,a=t.map((function(e){return e.width||N})),n=e-a.reduce((function(e,t){return e+t}),0);if(n>0){for(var i=[],r=0;r<t.length;r++)t[r].fillWidth&&i.push(r);0===i.length&&i.push(t.length-1);for(var c=0;c<i.length;c++)a[i[c]]+=n/i.length}w(a)}),[y,t]),Object(o.useEffect)((function(){C.current.resetAfterColumnIndex(0,!0)}),[k]);var A=[t].concat(Object(i.a)(d)),R=s.a.forwardRef((function(e,r){var o=e.children,s=Object(c.a)(e,F),u=f();return Object(S.jsxs)("div",Object(n.a)(Object(n.a)({ref:r},s),{},{children:[Object(S.jsx)("div",{className:u.headerCellRow,style:{height:P(0)},children:t.map((function(e,t){var n=k.slice(0,t).reduce((function(e,t){return e+t}),0);return Object(S.jsx)(I,{headerNameKey:j,onClick:p,onDoubleClick:function(t,a){e.disableAutosize||function(e){var t=Math.max.apply(Math,Object(i.a)(d.map((function(t){return"string"===typeof t[e]?t[e].length:x?String(null===(a=t[e])||void 0===a||null===(n=a.props)||void 0===n||null===(i=n.cellData)||void 0===i?void 0:i[x]).length||-1:(null===(r=t[e])||void 0===r||null===(c=r.props)||void 0===c||null===(o=c.cellData)||void 0===o?void 0:o.length)||-1;var a,n,i,r,c,o})))),a=k.map((function(a,n){return e===n?Math.floor(Math.max(8*t+32,N)):Math.floor(a)}));w(a)}(a)},contextMenuOptions:h,sortIndicatorIndex:a,sortDirection:l,VariableSizeGridProps:{style:{position:"absolute",top:0,left:n,height:P(0),width:T(t)},rowIndex:0,columnIndex:t,data:{items:A}}},t)}))}),o]}))}));return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(b.b,{height:g.height,width:g.width,columnCount:t.length,columnWidth:T,headerNameKey:j,rowCount:A.length,rowHeight:P,itemData:{items:A,onDoubleClickRow:m,gridUUID:$},innerElementType:R,overscanRowCount:0,onScroll:function(e){var t=e.scrollLeft;D.current&&D.current.scrollTo({left:t})},ref:C,children:q}),Object(S.jsx)(E,{height:g.height,rowHeight:P(0),width:g.width,minColumnWidth:N,columnWidths:k,onStop:function(e,t){var a=k.map((function(a,n){return t===n?Math.floor(Math.max(a+e,N)):Math.floor(a)}));w(a)},ref:D})]})},B=function(e){var t=e.columns,a=e.sortIndicatorIndex,i=e.sortDirection,r=e.items,c=e.onClickHeader,o=e.headerNameKey,s=e.onDoubleClickRow,d=e.contextMenuOptions,u=e.widthMeasureKey,b=e.rowHeight,j=void 0===b?32:b;return Object(S.jsx)(l.a,{children:function(e){return Object(S.jsx)(R,Object(n.a)({columns:t,headerNameKey:o,sortIndicatorIndex:a,sortDirection:i,items:r,widthMeasureKey:u,rowHeight:j,onClickHeader:c,onDoubleClickRow:s,contextMenuOptions:d},e))}})};t.a=B},176:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),i=a(1),r=a.n(i),c=a(54),o=a(97),s=a(96),l=a(111),d=a(17),u=a(368),b=a(363),j=a(365),p=a(366),m=a(364),h=a(542),f=a(142),O=a(0),x={PaperProps:{style:{maxHeight:224,width:250}},variant:"menu",getContentAnchorEl:function(){return null}},g=Object(f.a)((function(e){return{formControl:{margin:e.spacing(1),width:"100%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},noLabel:{marginTop:e.spacing(2)}}}));function y(e){var t=r.a.useState("plaintext"),a=Object(n.a)(t,2),i=a[0],f=a[1],y=r.a.useState(""),v=Object(n.a)(y,2),_=v[0],k=v[1],w=r.a.useState(""),C=Object(n.a)(w,2),S=C[0],D=C[1],I=r.a.useState(""),T=Object(n.a)(I,2),$=T[0],P=T[1],A=r.a.useState(""),E=Object(n.a)(A,2),L=E[0],F=E[1],N=g();return Object(O.jsxs)(r.a.Fragment,{children:[Object(O.jsx)(l.a,{id:"form-dialog-title",children:"Register New Credential"}),Object(O.jsx)(s.a,{dividers:!0,children:Object(O.jsxs)(r.a.Fragment,{children:[Object(O.jsxs)(m.a,{className:N.formControl,children:[Object(O.jsx)(j.a,{id:"operator-chip-label",children:"Which Type of Credential"}),Object(O.jsx)(u.a,{labelId:"operator-chip-label",id:"operator-chip",value:i,onChange:function(e){f(e.target.value)},input:Object(O.jsx)(b.a,{}),MenuProps:x,children:["plaintext","ticket","hash","certificate","key","hex"].map((function(e){return Object(O.jsx)(p.a,{value:e,children:Object(O.jsx)(h.a,{primary:e})},e)}))})]}),Object(O.jsx)(d.a,{value:S,onChange:function(e,t,a){D(t)},name:"Realm or Domain"}),Object(O.jsx)(d.a,{value:_,onChange:function(e,t,a){k(t)},name:"Account Name"}),Object(O.jsx)(d.a,{multiline:!0,value:$,onChange:function(e,t,a){P(t)},name:"Credential"}),Object(O.jsx)(d.a,{value:L,onChange:function(e,t,a){F(t)},name:"Comment"})]})}),Object(O.jsxs)(o.a,{children:[Object(O.jsx)(c.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(O.jsx)(c.a,{onClick:function(){e.onSubmit({realm:S,account:_,comment:L,credential:$,type:i}),e.onClose()},color:"primary",variant:"contained",children:"Create"})]})]})}},19:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(3),i=a(86),r=(a(1),a(142)),c=a(251),o=a(0),s=["children","title"],l=Object(r.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function d(e){var t=e.children,a=e.title,r=Object(i.a)(e,s),d=l();return Object(o.jsx)(c.a,Object(n.a)(Object(n.a)({title:a,arrow:!0,classes:{tooltip:d.tooltip,arrow:d.arrow}},r),{},{children:Object(o.jsx)("span",{style:{display:"inline-block"},children:t})}))}},193:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(1),i=a.n(n),r=a(54),c=a(97),o=a(96),s=a(111),l=a(13),d=a(17),u=a(0);function b(e){return Object(u.jsx)(l.a,{fullWidth:null!==e.fullWidth&&e.fullWidth,maxWidth:null===e.maxWidth?"sm":e.maxWidth,open:e.open,onClose:function(){e.onClose()},innerDialog:Object(u.jsxs)(i.a.Fragment,{children:[Object(u.jsx)(s.a,{id:"form-dialog-title",children:e.title}),Object(u.jsx)(o.a,{dividers:!0,children:Object(u.jsx)(d.a,{multiline:!0,value:e.value,onChange:function(){}})}),Object(u.jsx)(c.a,{children:Object(u.jsx)(r.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})})}},213:function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n,i,r=a(6),c=a(2),o=a(3),s=a(7),l=a(1),d=a.n(l),u=a(224),b=a(73),j=a(58),p=a(62),m=a(16),h=a(318),f=a(142),O=a(11),x=a(29),g=a(860),y=a(853),v=a(852),_=a(87),k=a.n(_),w=a(493),C=a.n(w),S=a(840),D=a(51),I=a(851),T=a(850),$=a(178),P=a(57),A=a(252),E=a(477),L=a(0),F=Object(P.a)(n||(n=Object(s.a)(["\n    fragment taskData on task {\n        comment\n        callback_id\n        commentOperator{\n            username\n        }\n        completed\n        id\n        operator{\n            username\n        }\n        original_params\n        display_params\n        status\n        timestamp\n        command {\n          cmd\n          id\n        }\n        command_name\n        responses(limit: 1, order_by: {id: desc}){\n            id\n            timestamp\n        }\n        opsec_pre_blocked\n        opsec_pre_bypassed\n        opsec_post_blocked\n        opsec_post_bypassed\n        tasks {\n            id\n        }\n        token {\n            id\n        }\n    }\n"]))),N=Object(P.a)(i||(i=Object(s.a)(["\n","\nquery getSubTasking($task_id: Int!){\n    task(where: {parent_task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n        ...taskData\n  }\n}\n "])),F),q=Object(f.a)((function(e){return{root:{marginTop:"3px",marginLeft:"3px",marginRight:"0px",height:"auto",width:"99%"},heading:{fontSize:e.typography.pxToRem(15),display:"inline",cursor:"default"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"auto",display:"block",textOverflow:"ellipsis",wordBreak:"break-all",maxWidth:"100%"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",width:"100%",whiteSpace:"nowrap",display:"inline-block"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"100%",whiteSpace:"break-all",wordBreak:"break-all"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center",marginRight:0},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"}}})),R=Object(f.a)((function(e){return{root:{margin:0,padding:0,height:"auto",width:"100%",whiteSpace:"break-all",wordBreak:"break-all"},content:{margin:0,height:"100%",padding:0},expandIcon:{margin:0},expanded:{marginRight:0}}}));function B(e){return Object(L.jsx)($.a,Object(o.a)(Object(o.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(L.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 11.023h-11.826q-.375 0-.669.281t-.294.682v0q0 .401.294 .682t.669.281h11.826q.375 0 .669-.281t.294-.682v0q0-.401-.294-.682t-.669-.281z"})}))}function M(e){return Object(L.jsx)($.a,Object(o.a)(Object(o.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(L.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 12.977h-4.923v4.896q0 .401-.281.682t-.682.281v0q-.375 0-.669-.281t-.294-.682v-4.896h-4.923q-.401 0-.682-.294t-.281-.669v0q0-.401.281-.682t.682-.281h4.923v-4.896q0-.401.294-.682t.669-.281v0q.401 0 .682.281t.281.682v4.896h4.923q.401 0 .682.281t.281.682v0q0 .375-.281.669t-.682.294z"})}))}var z=Object(O.a)((function(e){return{root:{marginRight:0,paddingRight:0,width:"100%","&:hover":{backgroundColor:"none"}},iconContainer:{"& .close":{opacity:.3}},group:{marginLeft:7,paddingLeft:18,borderLeft:"1px dashed ".concat(Object(x.c)(e.palette.text.primary,.4))}}}))((function(e){return Object(L.jsx)(T.a,Object(o.a)({},e))}));function W(e){var t=e.task,a=e.filterOptions,n=q(),i=d.a.useState([]),o=Object(c.a)(i,2),s=o[0],l=o[1],u=d.a.useCallback((function(e,t){if(t){if(s.includes("treenode:"+e))return;l([].concat(Object(r.a)(s),["treenode:"+e]))}else{var a=s.reduce((function(t,a){return a==="treenode:"+e?Object(r.a)(t):[].concat(Object(r.a)(t),[a])}),[]);l(a)}}),[s]);return Object(L.jsx)(I.a,{className:n.root,expanded:s,children:Object(L.jsx)(K,{task:t,filterOptions:a,nodesSelected:s,toggleSelection:u})})}var H=d.a.memo(W),U=function(e){var t=e.task,a=e.theme;return t.status.toLowerCase().includes("error")?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.error.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"cleared"===t.status?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"cleared"}):"completed"===t.status?null:"submitted"===t.status?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):"processing"===t.status?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()}):t.opsec_pre_blocked&&!t.opsec_pre_bypassed?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (PRE)"}):t.opsec_post_blocked&&!t.opsec_post_bypassed?Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.warning.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:"OPSEC BLOCKED (POST)"}):Object(L.jsx)(j.a,{size:"small",component:"span",style:{padding:"0",color:a.palette.info.main,marginLeft:"5%",display:"inline-block",fontSize:a.typography.pxToRem(15)},children:t.status.toLowerCase()})},G=function(e){var t=e.task,a=e.theme,n=e.children,i=d.a.useState(a.palette.info.main),r=Object(c.a)(i,2),o=r[0],s=r[1];return Object(l.useEffect)((function(){t.status.toLowerCase().includes("error")?s(a.palette.error.main):"cleared"===t.status.toLowerCase()?s(a.palette.warning.main):"submitted"===t.status?s(a.palette.info.main):t.opsec_pre_blocked&&!t.opsec_pre_bypassed||t.opsec_post_blocked&&!t.opsec_post_bypassed||"processing"===t.status.toLowerCase()?s(a.palette.warning.main):"completed"===t.status?s(a.palette.success.main):s(a.palette.info.main)}),[t.status,t.completed]),Object(L.jsx)("span",{style:{display:"flex",margin:0,borderWidth:0,padding:0,minHeight:"48px",alignItems:"center",height:"100%",borderLeft:"6px solid "+o,paddingLeft:"5px",width:"100%"},children:n})},K=function e(t){var a=t.task,n=t.filterOptions,i=t.nodesSelected,r=t.toggleSelection,o=d.a.useState(!1),s=Object(c.a)(o,2),u=s[0],b=s[1],j=d.a.useState({task:[]}),p=Object(c.a)(j,2),f=p[0],O=p[1],x=d.a.useState(!1),g=Object(c.a)(x,2),y=g[0],v=g[1],_=d.a.useState(!0),k=Object(c.a)(_,2),w=k[0],C=k[1],S=Object(h.a)(m.b),D=Object(A.a)(N,{onError:function(e){console.error(e)},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,onCompleted:function(e){if(!i.includes("treenode:"+a.id))return E(),void v(!1);P(2e3),O(e)}}),I=Object(c.a)(D,2),T=I[0],$=I[1],P=$.startPolling,E=$.stopPolling,F=d.a.useCallback((function(e){if(!y)return r(a.id,!0),v(!0),void T({variables:{task_id:a.id}});r(a.id,!1)}),[y]);Object(l.useEffect)((function(){if(a.display_params.includes("help")&&a.operator.username!==S.user.username)C(!1);else if(void 0!==n)if(n.operatorsList.length>0&&!n.operatorsList.includes(a.operator.username))w&&C(!1);else if(n.commentsFlag&&""===a.comment)w&&C(!1);else if(n.commandsList.length>0&&!n.commandsList.includes(a.command_name))w&&C(!1);else if(n.everythingButList.length>0&&n.everythingButList.includes(a.command_name))w&&C(!1);else{if(""!==n.parameterString)if(!new RegExp(n.parameterString).test(a.display_params))return void(w&&C(!1));w||C(!0)}else w||C(!0)}),[n,a.comment,a.command,a.display_params,a.operator.username]);var q=d.a.useCallback((function(e,t){b(!u)}),[u]);return Object(l.useEffect)((function(){!y&&a.tasks.length>0&&F()}),[a.tasks]),w?Object(L.jsx)(z,{nodeId:"treenode:"+a.id,onIconClick:F,icon:i.includes("treenode:"+a.id)?Object(L.jsx)(B,{}):a.tasks.length>0?Object(L.jsx)(M,{}):null,label:Object(L.jsx)(V,{task:a,dropdownOpen:u,toggleTaskDropdown:q}),children:f.task.map((function(t){return Object(L.jsx)(e,{task:t,nodesSelected:i,filterOptions:n,toggleSelection:r},"taskrow: "+t.id)}))}):null},V=function(e){var t=e.task,a=e.dropdownOpen,n=e.toggleTaskDropdown,i=d.a.useState(new Date),r=Object(c.a)(i,2),o=r[0],s=(r[1],Object(h.a)(m.b)),f=Object(D.a)(),O=d.a.useState(!1),x=Object(c.a)(O,2),_=x[0],w=x[1],I=d.a.useState(0),T=Object(c.a)(I,2),$=T[0],P=T[1],A=q(),F=R(),N=Object(l.useRef)(0);Object(l.useLayoutEffect)((function(){B()}),[]),Object(l.useEffect)((function(){var e,i=(null===t||void 0===t||null===(e=t.responses)||void 0===e?void 0:e.length)>0?t.responses[0]:{id:0,timestamp:0};a?(N.current=i.id,P(0)):new Date(i.timestamp+"Z")>o&&(0===N.current?n():i.id>N.current&&P(1))}),[t.responses,a]);var B=function(e,a){document.getElementById("scrolltotask".concat(t.id)).scrollIntoView({behavior:"smooth",block:"start",inline:"start"})};return Object(L.jsx)(b.a,{className:A.root,elevation:5,style:{marginRight:0},id:"taskHeader-".concat(t.id),children:Object(L.jsxs)(g.a,{TransitionProps:{unmountOnExit:!0,onEntered:B},defaultExpanded:!1,onChange:n,expanded:a,children:[Object(L.jsx)(v.a,{expandIcon:Object(L.jsx)(k.a,{}),"aria-controls":"panel1c-content-task-".concat(t.id),id:"panel1c-header-".concat(t.id),classes:F,children:Object(L.jsx)(G,{task:t,theme:f,children:Object(L.jsxs)("div",{id:"scrolltotask"+t.id,style:{width:"100%"},children:[_?Object(L.jsxs)(d.a.Fragment,{children:[Object(L.jsx)(j.a,{className:A.secondaryHeading,children:t.commentOperator.username}),Object(L.jsx)(j.a,{className:A.heading,children:t.comment})]}):null,Object(L.jsxs)(j.a,{className:A.taskAndTimeDisplay,children:["[",Object(p.b)(t.timestamp,s.user.view_utc_time),"] / ",t.id," / ",t.operator.username,Object(L.jsx)(U,{task:t,theme:f})]}),Object(L.jsxs)("div",{children:[""!==t.comment?Object(L.jsx)("div",{className:A.column,children:Object(L.jsx)(u.a,{size:"small",style:{padding:"0"},color:"primary",onClick:function(e){e.stopPropagation(),w(!_)},children:Object(L.jsx)(C.a,{})})}):null,Object(L.jsx)("div",{className:A.column,children:Object(L.jsx)(S.a,{badgeContent:$,color:"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:Object(L.jsx)(j.a,{className:A.heading,onClick:function(e){e.stopPropagation()},children:t.command_name+" "+t.display_params})})})]})]})})}),Object(L.jsx)(y.a,{style:{cursor:"default"},children:Object(L.jsx)(E.a,{task:t})})]})})}},218:function(e,t,a){"use strict";a.d(t,"a",(function(){return ke}));var n,i,r,c=a(133),o=a.n(c),s=a(189),l=a(190),d=a(26),u=a(6),b=a(3),j=a(2),p=a(7),m=a(1),h=a.n(m),f=a(54),O=a(97),x=a(96),g=a(111),y=a(58),v=a(248),_=a(250),k=a(77),w=a(247),C=a(249),S=a(134),D=a(73),I=a(364),T=a(368),$=a(899),P=a(363),A=a(17),E=a(192),L=a.n(E),F=a(47),N=a.n(F),q=a(51),R=a(239),B=a.n(R),M=a(57),z=a(197),W=a(4),H=a(176),U=a(13),G=a(19),K=a(319),V=a(843),Q=a(0),J=Object(M.a)(n||(n=Object(p.a)(["\nmutation getDynamicParamsMutation($callback: Int!, $command: String!, $payload_type: String!, $parameter_name: String!){\n    dynamic_query_function(callback: $callback, command: $command, payload_type: $payload_type, parameter_name: $parameter_name){\n        status\n        error\n        choices\n    }\n}\n"]))),Y=Object(M.a)(i||(i=Object(p.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),Z=Object(M.a)(r||(r=Object(p.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      ...credentialData\n    }\n  }\n"])),Y);function X(e){var t=h.a.useState(""),a=Object(j.a)(t,2),n=a[0],i=a[1],r=Object(q.a)(),c=h.a.useState([]),o=Object(j.a)(c,2),s=o[0],l=o[1],p=h.a.useState(!1),O=Object(j.a)(p,2),x=O[0],g=O[1],E=h.a.useState([""]),F=Object(j.a)(E,2),R=F[0],M=F[1],Y=h.a.useState([]),X=Object(j.a)(Y,2),ee=X[0],te=X[1],ae=h.a.useState(""),ne=Object(j.a)(ae,2),ie=ne[0],re=ne[1],ce=h.a.useState([]),oe=Object(j.a)(ce,2),se=oe[0],le=oe[1],de=h.a.useState(0),ue=Object(j.a)(de,2),be=ue[0],je=ue[1],pe=h.a.useState(0),me=Object(j.a)(pe,2),he=me[0],fe=me[1],Oe=h.a.useState([]),xe=Object(j.a)(Oe,2),ge=xe[0],ye=xe[1],ve=h.a.useState(0),_e=Object(j.a)(ve,2),ke=_e[0],we=_e[1],Ce=h.a.useState([]),Se=Object(j.a)(Ce,2),De=Se[0],Ie=Se[1],Te=h.a.useState(0),$e=Object(j.a)(Te,2),Pe=$e[0],Ae=$e[1],Ee=h.a.useState(!1),Le=Object(j.a)(Ee,2),Fe=Le[0],Ne=Le[1],qe=h.a.useState(!1),Re=Object(j.a)(qe,2),Be=Re[0],Me=Re[1],ze=h.a.useState({name:""}),We=Object(j.a)(ze,2),He=We[0],Ue=We[1],Ge=h.a.useState(!1),Ke=Object(j.a)(Ge,2),Ve=Ke[0],Qe=Ke[1],Je=h.a.useRef(!1),Ye=Object(z.a)(J,{onCompleted:function(t){if("success"===t.dynamic_query_function.status)try{l(Object(u.a)(t.dynamic_query_function.choices)),Je.current=!0,"Choice"===e.type&&t.dynamic_query_function.choices.length>0&&(i(t.dynamic_query_function.choices[0]),e.onChange(e.name,t.dynamic_query_function.choices[0],!1))}catch(a){Qe(!1),W.b.warning("Failed to parse dynamic parameter results"),l([])}else W.b.warning(t.dynamic_query_function.error);Qe(!1)},onError:function(e){W.b.warning("Failed to perform dynamic parameter query"),console.log(e)}}),Ze=Object(j.a)(Ye,1)[0],Xe=Object(z.a)(Z,{fetchPolicy:"no-cache",onCompleted:function(t){W.b.success("Successfully created new credential"),e.addedCredential();var a=s.length;switch(l([].concat(Object(u.a)(s),[Object(b.a)({},t.insert_credential_one)])),e.type){case"Credential-JSON":i(a),e.onChange(e.name,Object(b.a)({},t.insert_credential_one),!1);break;case"Credential-Account":i(t.insert_credential_one.account),e.onChange(e.name,t.insert_credential_one.account,!1);break;case"Credential-Realm":i(t.insert_credential_one.realm),e.onChange(e.name,t.insert_credential_one.realm,!1);break;case"Credential-Type":i(t.insert_credential_one.type),e.onChange(e.name,t.insert_credential_one.type,!1);break;case"Credential-Credential":i(t.insert_credential_one.credential_text),e.onChange(e.name,t.insert_credential_one.credential_text,!1)}},onError:function(e){W.b.error("Failed to create credential"),console.log(e)}}),et=Object(j.a)(Xe,1)[0];Object(m.useEffect)((function(){if(null!==e.dynamic_query_function&&0===s.length&&(Qe(!0),Ze({variables:{callback:e.callback_id,parameter_name:e.name,command:e.commandInfo.cmd,payload_type:e.commandInfo.payloadtype.ptype}})),"Boolean"===e.type)""===n&&(g(e.value),i(e.value));else if("Array"===e.type)0===R.length&&e.value.length>0&&M(e.value);else if("ChoiceMultiple"===e.type&&null===e.dynamic_query_function)""===n&&(te(e.value),i(e.value),l(e.choices));else if("AgentConnect"===e.type)if(e.choices.length>0){var t=0;he<e.choices.length?t=he:fe(0),le(e.choices);var a=0;ke<e.choices[t].payloads.length?a=ke:we(0),ye(e.choices[t].payloads),e.choices[t].payloads.length>0?e.choices[t].payloads[a].c2info.length>0&&Ie(e.choices[t].payloads[a].c2info):W.b.warning("Mythic knows of no host with a P2P payload. Please add one.")}else le([]),Ie([]),W.b.warning("Mythic knows of no host with a P2P payload. Please add one.");else""===n&&("Number"===e.type?""===e.value?i(0):i(parseInt(e.value)):i(e.value)),null===e.dynamic_query_function&&""===n?(l(Object(u.a)(e.choices)),i(e.value)):e.choices.length!=s.length&&(Je.current||l(Object(u.a)(e.choices)))}),[e.choices,e.default_value,e.type,e.value,g,n]);var tt=function(t,a,n){var i=e.choices[t].payloads[a].c2info[n].parameters.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.name,t.value))}),{}),r={host:e.choices[t].host,agent_uuid:e.choices[t].payloads[a].uuid,c2_profile:{name:e.choices[t].payloads[a].c2info[n].name,parameters:i}};"callback"===e.choices[t].payloads[a].type?r.callback_uuid=e.choices[t].payloads[a].agent_callback_id:r.callback_uuid="",e.onChange(e.name,r,!1)},at=function(t){i(t.target.value),e.onChange(e.name,t.target.value,!1)},nt=function(t){i(t.target.value),e.onChange(e.name,s[t.target.value],!1)},it=function(t){for(var a=t.target.options,n=[],r=0,c=a.length;r<c;r+=1)a[r].selected&&n.push(a[r].value);te(n),i(n),e.onChange(e.name,n,!1)},rt=function(t,a,n){i(a),e.onChange(e.name,a,n)},ct=function(t,a,n){i(parseInt(a)),e.onChange(e.name,parseInt(a),n)},ot=function(t){g(t.target.checked),i(t.target.checked),e.onChange(e.name,t.target.checked)},st=function(t){Ue({name:t.target.files[0].name}),e.onChange(e.name,t.target.files[0])},lt=function(t){fe(t.target.value),ye(e.choices[t.target.value].payloads),e.choices[t.target.value].payloads.length>0?(we(0),e.choices[t.target.value].payloads[0].c2info.length>0?(Ie(e.choices[0].payloads[0].c2info),Ae(0),tt(t.target.value,0,0)):(Ie([]),Ae(null))):(ye([]),we(null),Ie([]),Ae(null))},dt=function(t){we(t.target.value),Ie(e.choices[he].payloads[t.target.value].c2info),e.choices[he].payloads[t.target.value].c2info.length>0?(Ae(0),tt(he,t.target.value,0)):Ae(null)},ut=function(e){Ae(e.target.value),tt(he,ke,e.target.value)},bt=function(e,t,a){re(t)},jt=function(e){je(e.target.value)},pt=function(){""!==ie?(e.onAgentConnectAddNewPayloadOnHost(ie.toUpperCase(),e.payload_choices[be].id),Ne(!1)):W.b.error("Must set a hostname")},mt=function(){e.choices[he].payloads[ke].payloadOnHostID?e.onAgentConnectRemovePayloadOnHost(e.choices[he].payloads[ke].payloadOnHostID):W.b.warning("Can't remove a callback")},ht=function(t){return(e.required&&""!==e.verifier_regex||""!==e.verifier_regex&&""!==t)&&!RegExp(e.verifier_regex).test(t)},ft=function(){var t=[].concat(Object(u.a)(R),[""]);M(t),e.onChange(e.name,t,!1)},Ot=function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,r=e.credential;et({variables:{type:t,account:a,realm:n,comment:i,credential:r}})};return Object(Q.jsxs)(S.a,{children:[Object(Q.jsxs)(k.a,{children:[Object(Q.jsx)(G.a,{title:e.description.length>0?e.description:"No Description",children:e.display_name}),e.required?Object(Q.jsx)(y.a,{component:"div",style:{color:r.palette.warning.main},children:"Required"}):null]}),Object(Q.jsx)(k.a,{children:function(){switch(e.type){case"Choice":case"ChoiceMultiple":return Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsx)(K.a,{open:Ve,style:{zIndex:2,position:"absolute"},invisible:!1,children:Object(Q.jsx)(V.a,{color:"inherit"})}),Object(Q.jsx)(I.a,{style:{width:"100%"},children:Object(Q.jsx)(T.a,{native:!0,autoFocus:e.autoFocus,multiple:"ChoiceMultiple"===e.type,value:"ChoiceMultiple"===e.type?ee:n,onChange:"ChoiceMultiple"===e.type?it:at,input:Object(Q.jsx)(P.a,{}),children:s.map((function(t,a){return Object(Q.jsx)("option",{value:t,children:t},e.name+a)}))})})]});case"Array":return Object(Q.jsx)(w.a,{component:D.a,className:"mythicElement",children:Object(Q.jsx)(v.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:Object(Q.jsxs)(_.a,{children:[R.map((function(t,a){return Object(Q.jsxs)(S.a,{hover:!0,children:[Object(Q.jsx)(k.a,{style:{width:"5rem"},children:Object(Q.jsx)(f.a,{onClick:function(){return function(t){var a=Object(u.a)(R);a.splice(t,1),M(a),e.onChange(e.name,a,!1)}(a)},style:{backgroundColor:r.palette.error.main},size:"small",variant:"contained",children:"x"})}),Object(Q.jsx)(k.a,{children:Object(Q.jsx)(A.a,{required:e.required,fullWidth:!0,placeholder:"",value:t,multiline:!1,autoFocus:e.autoFocus&&0===a,onChange:function(t,n,i){return function(t,a,n){var i=Object(u.a)(R);i[n]=t,M(i),e.onChange(e.name,i,!1)}(n,0,a)},display:"inline-block",onEnter:ft,validate:ht,errorText:"Must match: "+e.verifier_regex})})]},"array"+e.name+a)})),Object(Q.jsxs)(S.a,{hover:!0,children:[Object(Q.jsx)(k.a,{style:{width:"5rem"},children:Object(Q.jsx)(f.a,{onClick:ft,size:"small",variant:"contained",style:{backgroundColor:r.palette.success.main},children:"+"})}),Object(Q.jsx)(k.a,{})]})]})})});case"String":return Object(Q.jsx)(A.a,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,onChange:rt,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:ht,errorText:"Must match: "+e.verifier_regex});case"Number":return Object(Q.jsx)(A.a,{required:e.required,placeholder:e.default_value,value:n,multiline:!1,type:"number",onChange:ct,display:"inline-block",onEnter:e.onSubmit,autoFocus:e.autoFocus,validate:ht,errorText:"Must match: "+e.verifier_regex});case"Boolean":return Object(Q.jsx)($.a,{checked:x,onChange:ot});case"File":return Object(Q.jsxs)(f.a,{variant:"contained",component:"label",children:[""===He.name?"Select File":He.name,Object(Q.jsx)("input",{onChange:st,type:"file",hidden:!0})," "]});case"LinkInfo":return Object(Q.jsx)(I.a,{children:Object(Q.jsx)(T.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:function(t){!function(t){var a,n=(a=e.choices[t].source.id===e.callback_id?e.choices[t].destination:e.choices[t].source).c2profileparametersinstances.reduce((function(a,n){return n.c2_profile_id===e.choices[t].c2profile.id?Object(b.a)(Object(b.a)({},a),{},Object(d.a)({},n.c2profileparameter.name,n.c2profileparameter.crypto_type?{crypto_type:n.c2profileparameter.crypto_type,enc_key:n.enc_key,dec_key:n.dec_key}:n.value)):Object(b.a)({},a)}),{}),r={host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:e.choices[t].c2profile.name,parameters:n}};e.onChange(e.name,r,!1),i(t)}(t.target.value)},input:Object(Q.jsx)(P.a,{}),children:e.choices.map((function(t,a){return Object(Q.jsx)("option",{value:a,children:t.display},e.name+a)}))})});case"PayloadList":return Object(Q.jsx)(I.a,{children:Object(Q.jsx)(T.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:at,input:Object(Q.jsx)(P.a,{}),children:e.choices.map((function(t,a){return Object(Q.jsx)("option",{value:t.uuid,children:t.display},e.name+a)}))})});case"AgentConnect":return Object(Q.jsxs)(w.a,{component:D.a,className:"mythicElement",children:[Object(Q.jsx)(v.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"auto"},children:Object(Q.jsxs)(_.a,{children:[Fe?Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{style:{width:"6em"},children:"Hostname"}),Object(Q.jsx)(k.a,{children:Object(Q.jsx)(A.a,{required:!0,placeholder:"hostname",value:ie,multiline:!1,autoFocus:e.autoFocus,onChange:bt,display:"inline-block"})})]}),Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{children:"Payload on that host"}),Object(Q.jsx)(k.a,{children:Object(Q.jsx)(I.a,{children:Object(Q.jsx)(T.a,{native:!0,value:be,onChange:jt,input:Object(Q.jsx)(P.a,{}),children:e.payload_choices?e.payload_choices.map((function(t,a){return Object(Q.jsx)("option",{value:a,children:t.display},e.name+"newpayload"+a)})):Object(Q.jsx)("option",{value:"-1",children:"No Payloads"},e.name+"nooptionnewpayload")})})})]}),Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{children:Object(Q.jsxs)(f.a,{component:"span",style:{color:r.palette.success.main,padding:0},onClick:pt,children:[Object(Q.jsx)(L.a,{}),"Add"]})}),Object(Q.jsx)(k.a,{children:Object(Q.jsxs)(f.a,{component:"span",style:{color:r.palette.warning.main,padding:0},onClick:function(){Ne(!1)},children:[Object(Q.jsx)(B.a,{}),"Cancel"]})})]})]}):null,Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{style:{width:"6em"},children:"Host"}),Object(Q.jsx)(k.a,{children:Object(Q.jsx)(I.a,{children:Object(Q.jsx)(T.a,{native:!0,value:he,onChange:lt,input:Object(Q.jsx)(P.a,{}),children:se.map((function(t,a){return Object(Q.jsx)("option",{value:a,children:t.host},e.name+"connecthost"+a)}))})})})]}),Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{children:"Payload"}),Object(Q.jsx)(k.a,{children:Object(Q.jsx)(I.a,{children:Object(Q.jsx)(T.a,{native:!0,value:ke,onChange:dt,input:Object(Q.jsx)(P.a,{}),children:ge.map((function(t,a){return Object(Q.jsx)("option",{value:a,children:t.display},e.name+"connectagent"+a)}))})})})]}),!Fe&&Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{children:Object(Q.jsxs)(f.a,{component:"span",style:{color:r.palette.success.main,padding:0},onClick:function(){Ne(!0)},children:[Object(Q.jsx)(L.a,{}),"Add"]})}),Object(Q.jsx)(k.a,{children:Object(Q.jsxs)(f.a,{component:"span",style:{color:r.palette.error.main,padding:0},onClick:mt,children:[Object(Q.jsx)(N.a,{}),"Remove"]})})]}),Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{children:"C2 Profile"}),Object(Q.jsx)(k.a,{children:Object(Q.jsx)(I.a,{children:Object(Q.jsx)(T.a,{native:!0,value:Pe,onChange:ut,input:Object(Q.jsx)(P.a,{}),children:De.map((function(t,a){return Object(Q.jsx)("option",{value:a,children:t.name},e.name+"connectprofile"+a)}))})})})]})]})}),De.length>0?Object(Q.jsxs)(v.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(Q.jsx)(C.a,{children:Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{style:{width:"30%"},children:"Parameter"}),Object(Q.jsx)(k.a,{children:"Value"})]})}),Object(Q.jsx)(_.a,{children:De[Pe].parameters.map((function(t,a){return Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{children:t.name}),Object(Q.jsx)(k.a,{children:Object(Q.jsx)("pre",{children:JSON.stringify(t.value,null,2)})})]},"agentconnectparameters"+e.name+a)}))})]}):null]});case"Credential-JSON":return Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsx)(U.a,{fullWidth:!0,maxWidth:"md",open:Be,onClose:function(){Me(!1)},innerDialog:Object(Q.jsx)(H.a,{onSubmit:Ot,onClose:function(){Me(!1)}})}),Object(Q.jsx)(I.a,{style:{width:"100%"},children:Object(Q.jsx)(T.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:nt,input:Object(Q.jsx)(P.a,{}),children:s.map((function(t,a){return Object(Q.jsx)("option",{value:a,children:t.account+"@"+t.realm+" - "+t.credential_text.substring(0,10)+" - "+t.comment},e.name+a)}))})}),Object(Q.jsx)(f.a,{size:"small",color:"primary",onClick:function(){Me(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Account":return Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsx)(U.a,{fullWidth:!0,maxWidth:"md",open:Be,onClose:function(){Me(!1)},innerDialog:Object(Q.jsx)(H.a,{onSubmit:Ot,onClose:function(){Me(!1)}})}),Object(Q.jsx)(I.a,{style:{width:"100%"},children:Object(Q.jsx)(T.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:at,input:Object(Q.jsx)(P.a,{}),children:s.map((function(t,a){return Object(Q.jsx)("option",{value:t.account,children:t.comment.length>0?t.comment+" ( "+t.account+" )":t.account},e.name+a)}))})}),Object(Q.jsx)(f.a,{size:"small",color:"primary",onClick:function(){Me(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Realm":return Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsx)(U.a,{fullWidth:!0,maxWidth:"md",open:Be,onClose:function(){Me(!1)},innerDialog:Object(Q.jsx)(H.a,{onSubmit:Ot,onClose:function(){Me(!1)}})}),Object(Q.jsx)(I.a,{style:{width:"100%"},children:Object(Q.jsx)(T.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:at,input:Object(Q.jsx)(P.a,{}),children:s.map((function(t,a){return Object(Q.jsx)("option",{value:t.realm,children:t.comment.length>0?t.comment+" ( "+t.realm+" )":t.realm},e.name+a)}))})}),Object(Q.jsx)(f.a,{size:"small",color:"primary",onClick:function(){Me(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Type":return Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsx)(U.a,{fullWidth:!0,maxWidth:"md",open:Be,onClose:function(){Me(!1)},innerDialog:Object(Q.jsx)(H.a,{onSubmit:Ot,onClose:function(){Me(!1)}})}),Object(Q.jsx)(I.a,{style:{width:"100%"},children:Object(Q.jsx)(T.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:at,input:Object(Q.jsx)(P.a,{}),children:s.map((function(t,a){return Object(Q.jsx)("option",{value:t.type,children:t.type},e.name+a)}))})}),Object(Q.jsx)(f.a,{size:"small",color:"primary",onClick:function(){Me(!0)},variant:"contained",children:"New Credential"})]});case"Credential-Credential":return Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsx)(U.a,{fullWidth:!0,maxWidth:"md",open:Be,onClose:function(){Me(!1)},innerDialog:Object(Q.jsx)(H.a,{onSubmit:Ot,onClose:function(){Me(!1)}})}),Object(Q.jsx)(I.a,{style:{width:"100%"},children:Object(Q.jsx)(T.a,{native:!0,value:n,autoFocus:e.autoFocus,onChange:at,input:Object(Q.jsx)(P.a,{}),children:s.map((function(t,a){return Object(Q.jsx)("option",{value:t.credential_text,style:{textOverflow:"ellipsis"},children:t.comment.length>0?t.comment+" ( "+t.credential_text+" )":t.credential_text},e.name+a)}))})}),Object(Q.jsx)(f.a,{size:"small",color:"primary",onClick:function(){Me(!0)},variant:"contained",children:"New Credential"})]});default:return null}}()})]},"buildparam"+e.id)}var ee,te,ae,ne,ie,re,ce,oe,se,le=a(252),de=a(195),ue=a(827),be=a(366),je=function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("file",t),W.b.info("Uploading "+t.name+" to Mythic...",{autoHideDuration:2e3}),e.next=5,fetch("/api/v1.4/task_upload_file_webhook",{method:"POST",body:a,headers:{Authorization:"Bearer ".concat(localStorage.getItem("acess_token"))}});case 5:return n=e.sent,i=n.json().then((function(e){return console.log(e),(null===e||void 0===e?void 0:e.agent_file_id)||(null===e||void 0===e?void 0:e.error)||null})).catch((function(e){return console.log(n),W.b.warning("Error: "+n.statusText+"\nError Code: "+n.status),console.log("Error trying to get json response",e.toString()),null})),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=a(845),me=Object(M.a)(ee||(ee=Object(p.a)(["\nquery GetLoadedCommandsQuery($callback_id: Int!) {\n  loadedcommands(where: {callback_id: {_eq: $callback_id}}) {\n    id\n    command {\n      cmd\n      attributes\n      id\n    }\n  }\n}\n"]))),he=Object(M.a)(te||(te=Object(p.a)(["\nquery getAllCommandsQuery($payload_type_id: Int!){\n    command(where: {payload_type_id: {_eq: $payload_type_id}, deleted: {_eq: false}}) {\n        attributes\n        cmd\n        id\n    }\n}\n"]))),fe=Object(M.a)(ae||(ae=Object(p.a)(["\nquery getAllEdgesQuery($callback_id: Int!){\n    callbackgraphedge(where: {_or: [{source_id:{_eq: $callback_id}}, {destination_id: {_eq: $callback_id}}]}) {\n        id\n        c2profile {\n          id\n          name\n        }\n        direction\n        destination{\n            agent_callback_id\n            host\n            id\n            payload {\n              id\n              uuid\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              value\n              id\n              c2_profile_id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        source{\n            agent_callback_id\n            host\n            id\n            payload {\n              uuid\n              id\n            }\n            c2profileparametersinstances {\n              enc_key_base64\n              dec_key_base64\n              c2_profile_id\n              value\n              id\n              c2profileparameter {\n                crypto_type\n                name\n                id\n              }\n            }\n        }\n        end_timestamp\n      }\n    }\n"]))),Oe=Object(M.a)(ne||(ne=Object(p.a)(['\nquery getAllPayloadsQuery($operation_id: Int!){\n    payload(where: {deleted: {_eq: false}, build_phase: {_eq: "success"}, operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    uuid\n    payloadc2profiles {\n      id\n      c2profile {\n        name\n        id\n        is_p2p\n      }\n    }\n    payloadtype{\n        id\n        ptype\n    }\n    filemetum {\n        id\n        filename_text\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        name\n        id\n      }\n    }\n  }\n}\n']))),xe=Object(M.a)(ie||(ie=Object(p.a)(["\nquery getAllPayloadsOnHostsQuery($operation_id: Int!){\n    payloadonhost(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}, payload: {c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}}) {\n        host\n        id\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n            c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n                c2profile {\n                    name\n                    id\n                }\n                c2profileparameter {\n                    crypto_type\n                    name\n                    id\n                }\n                value\n                enc_key_base64\n                dec_key_base64\n                id\n            }\n        }\n    }\n    callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}, c2profileparametersinstances: {c2profile: {is_p2p: {_eq: true}}}}){\n        agent_callback_id\n        host\n        id\n        description\n        crypto_type\n        payload {\n            auto_generated\n            id\n            tag\n            filemetum {\n                filename_text\n                id\n            }\n            uuid\n        }\n        c2profileparametersinstances(where: {c2profile: {is_p2p: {_eq: true}}}) {\n            c2profile {\n                name\n                id\n            }\n            c2profileparameter {\n                crypto_type\n                name\n                id\n            }\n            value\n            enc_key_base64\n            dec_key_base64\n            id\n        }\n    }\n}\n"]))),ge=Object(M.a)(re||(re=Object(p.a)(["\n    mutation addPayloadOnHostMutation($host: String!, $payload_id: Int!){\n        insert_payloadonhost(objects: {host: $host, payload_id: $payload_id}) {\n            affected_rows\n          }\n    }\n"]))),ye=Object(M.a)(ce||(ce=Object(p.a)(["\n    mutation removePayloadOnHostMutation($payloadOnHostID: Int!){\n        delete_payloadonhost_by_pk(id: $payloadOnHostID) {\n            id\n          }\n    }\n"]))),ve=Object(M.a)(oe||(oe=Object(p.a)(["\nquery getCommandQuery($id: Int!){\n  command_by_pk(id: $id) {\n    attributes\n    author\n    cmd\n    description\n    help_cmd\n    id\n    needs_admin\n    version\n    payloadtype{\n        ptype\n    }\n    commandparameters {\n      choice_filter_by_command_attributes\n      choices\n      choices_are_all_commands\n      choices_are_loaded_commands\n      default_value\n      description\n      id\n      name\n      required\n      supported_agent_build_parameters\n      supported_agents\n      type\n      dynamic_query_function\n      ui_position\n      parameter_group_name\n      display_name\n      cli_name\n    }\n    commandopsec {\n      authentication\n      id\n      injection_method\n      process_creation\n    }\n  }\n}\n"]))),_e=Object(M.a)(se||(se=Object(p.a)(["\nquery getCredentialsQuery($operation_id: Int!){\n    credential(where: {deleted: {_eq: false}, operation_id: {_eq: $operation_id}}){\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n    }\n}\n"])));function ke(e){var t=Object(q.a)(),a=h.a.useState(!1),n=Object(j.a)(a,2),i=n[0],r=n[1],c=Object(m.useState)({}),p=Object(j.a)(c,2),T=p[0],$=p[1],A=Object(m.useState)([]),E=Object(j.a)(A,2),L=E[0],F=E[1],N=Object(m.useState)("Default"),R=Object(j.a)(N,2),B=R[0],M=R[1],W=Object(m.useState)([]),H=Object(j.a)(W,2),U=H[0],G=H[1],J=Object(m.useState)(!1),Y=Object(j.a)(J,2),Z=Y[0],ee=Y[1],te=Object(m.useState)({all:!1,loaded:!1,edges:!1,credentials:!1}),ae=Object(j.a)(te,2),ne=ae[0],ie=ae[1],re=Object(le.a)(he,{fetchPolicy:"no-cache"}),ce=Object(j.a)(re,2),oe=ce[0],se=ce[1].data,ke=Object(le.a)(me,{fetchPolicy:"no-cache"}),we=Object(j.a)(ke,2),Ce=we[0],Se=we[1].data,De=Object(le.a)(fe,{fetchPolicy:"no-cache"}),Ie=Object(j.a)(De,2),Te=Ie[0],$e=Ie[1].data,Pe=Object(le.a)(Oe,{fetchPolicy:"no-cache"}),Ae=Object(j.a)(Pe,2),Ee=Ae[0],Le=Ae[1].data,Fe=Object(le.a)(xe,{fetchPolicy:"no-cache"}),Ne=Object(j.a)(Fe,2),qe=Ne[0],Re=Ne[1].data,Be=Object(le.a)(_e,{fetchPolicy:"no-cache"}),Me=Object(j.a)(Be,2),ze=Me[0],We=Me[1].data,He=Object(z.a)(ge,{onCompleted:function(t){qe({variables:{operation_id:e.operation_id}})}}),Ue=Object(j.a)(He,1)[0],Ge=Object(z.a)(ye,{onCompleted:function(t){qe({variables:{operation_id:e.operation_id}})}}),Ke=Object(j.a)(Ge,1)[0];Object(de.a)(ve,{variables:{id:e.command.id},fetchPolicy:"no-cache",onCompleted:function(t){var a={all:!1,loaded:!1,edges:!1,credentials:!1},n=[];t.command_by_pk.commandparameters.forEach((function(e){n.includes(e.parameter_group_name)||n.push(e.parameter_group_name),"LinkInfo"===e.type?a.edges=!0:e.choices_are_all_commands?a.all=!0:e.choices_are_loaded_commands?a.loaded=!0:"AgentConnect"===e.type?(a.connect=!0,a.payloads=!0):"PayloadList"===e.type?a.payloads=!0:e.type.includes("Credential")&&(a.credentials=!0)})),n.sort(),F(n),e.command.groupName&&n.includes(e.command.groupName)?M(e.command.groupName):n.includes("Default")||M(n[0]),$(Object(b.a)({},t.command_by_pk)),a.edges&&Te({variables:{callback_id:e.callback_id}}),a.all&&oe({variables:{payload_type_id:e.payloadtype_id}}),a.loaded&&Ce({variables:{callback_id:e.callback_id}}),a.payloads&&Ee({variables:{operation_id:e.operation_id}}),a.connect&&qe({variables:{operation_id:e.operation_id}}),a.credentials&&ze({variables:{operation_id:e.operation_id}}),ie(a),ee(Object(b.a)({},t))}});var Ve=function(){ze({variables:{operation_id:e.operation_id}})},Qe=function(e,t){var a=new Set(t);return Object(u.a)(new Set(e)).filter((function(e){return a.has(e)}))};Object(m.useEffect)((function(){var t=function(t){if(t.length>0){var a=t[0].payloads[0].c2info[0].parameters.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.name,t.value))}),{}),n={host:t[0].host,agent_uuid:t[0].payloads[0].uuid,c2_profile:{name:t[0].payloads[0].c2info[0].name,parameters:a}};return"callback"===t[0].payloads[0].type&&(n.callback_uuid=e.choices[0].payloads[0].agent_callback_id),n}return{}},a=function(t){var a;if(t.length>0){var n=(a=t[0].source.id===e.callback_id?t[0].destination:t[0].source).c2profileparametersinstances.reduce((function(e,a){return a.c2_profile_id===t[0].c2profile.id?Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},a.c2profileparameter.name,a.c2profileparameter.crypto_type?{crypto_type:a.c2profileparameter.crypto_type,enc_key:a.enc_key_base64,dec_key:a.dec_key_base64}:a.value)):Object(b.a)({},e)}),{});return{host:a.host,agent_uuid:a.payload.uuid,callback_uuid:a.agent_callback_id,c2_profile:{name:t[0].c2profile.name,parameters:n}}}return{}};if(Z&&(!ne.loaded||Se)&&(!ne.all||se)&&(!ne.edges||$e)&&(!ne.payloads||Le)&&(!ne.connect||Re)&&(!ne.credentials||We)){var n=Z.command_by_pk.commandparameters.reduce((function(n,i){if(i.parameter_group_name!==B)return Object(u.a)(n);switch(i.type){case"Boolean":return i.name in e.command.parsedParameters?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):i.default_value?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:"true"===i.default_value.toLowerCase()})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:!1})]);case"String":return i.name in e.command.parsedParameters?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:i.default_value})]);case"Number":return i.name in e.command.parsedParameters?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:""===i.default_value?0:parseInt(i.default_value)})]);case"Array":return i.name in e.command.parsedParameters?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:e.command.parsedParameters[i.name]})]):i.default_value.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:JSON.parse(i.default_value)})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:[]})]);case"Choice":case"ChoiceMultiple":var r=i.choices.split("\n"),c=i.default_value;"ChoiceMultiple"===i.type?c=""!==i.default_value?JSON.parse(i.default_value):[]:r.length>0&&(c=""===i.default_value?r[0]:i.default_value);var o=JSON.parse(i.choice_filter_by_command_attributes);return i.choices_are_all_commands?((r=(r=Object(u.a)(se.command)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.attributes),i=0,r=Object.entries(o);i<r.length;i++){var c=Object(j.a)(r[i],2),s=c[0],l=c[1];"spawn_and_injectable"===s?l!==n[s]&&(a=!1):"supported_os"===s&&l.length>0&&0===Qe(l,n[s]).length&&(a=!1)}return a?[].concat(Object(u.a)(e),[t.cmd]):Object(u.a)(e)}),[])).sort(),r.length>0&&(c="ChoiceMultiple"===i.type?[]:r[0])):i.choices_are_loaded_commands&&(r=(r=Object(u.a)(Se.loadedcommands)).reduce((function(e,t){for(var a=!0,n=JSON.parse(t.command.attributes),i=0,r=Object.entries(o);i<r.length;i++){var c=Object(j.a)(r[i],2),s=c[0],l=c[1];"spawn_and_injectable"===s?l!==n[s]&&(a=!1):"supported_os"===s&&l.length>0&&0===Qe(l,n[s]).length&&(a=!1)}return a?[].concat(Object(u.a)(e),[t.command.cmd]):Object(u.a)(e)}),[])).length>0&&(c="ChoiceMultiple"===i.type?[]:r[0]),i.name in e.command.parsedParameters?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{choices:r,value:e.command.parsedParameters[i.name]})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{choices:r,default_value:c,value:c})]);case"File":return[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:{}})]);case"Credential-JSON":return We.credential.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:We.credential[0],choices:We.credential})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:{},choices:[]})]);case"Credential-Account":return We.credential.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:We.credential[0].account,choices:We.credential})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:"",choices:[]})]);case"Credential-Realm":return We.credential.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:We.credential[0].realm,choices:We.credential})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:"",choices:[]})]);case"Credential-Type":return We.credential.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:We.credential[0].type,choices:We.credential})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:"",choices:[]})]);case"Credential-Credential":return We.credential.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:We.credential[0].credential_text,choices:We.credential})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{value:"",choices:[]})]);case"AgentConnect":var s=Le.payload.reduce((function(e,t){var a=!1,n=t.payloadc2profiles.reduce((function(e,t){return t.c2profile.is_p2p&&(a=!0),[].concat(Object(u.a)(e),[t.c2profile.name])}),[]).join(",");return a?[].concat(Object(u.a)(e),[Object(b.a)(Object(b.a)({},t),{},{display:t.filemetum.filename_text+" - "+n+" - "+t.tag})]):Object(u.a)(e)}),[]),l=Re.callback.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;for(var n=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[].concat(Object(u.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),i=[],r=0,c=Object.entries(n);r<c.length;r++){var o=Object(j.a)(c[r],2),s=o[0],l=o[1];i.push({name:s,parameters:l})}var p=Object(b.a)(Object(b.a)(Object(b.a)({},t.registered_payload),{},{c2info:i,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return Object(b.a)(Object(b.a)({},e),{},{payloads:[].concat(Object(u.a)(e.payloads),[p])})}return e}));if(a)return n;for(var i=t.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[].concat(Object(u.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],c=0,o=Object.entries(i);c<o.length;c++){var s=Object(j.a)(o[c],2),l=s[0],p=s[1];r.push({name:l,parameters:p})}var m=Object(b.a)(Object(b.a)(Object(b.a)({},t.registered_payload),{},{c2info:r,display:"Callback "+t.id+" - "+t.description},t),{},{type:"callback",payloadOnHostID:null});return[].concat(Object(u.a)(e),[{host:t.host,payloads:[m]}])}),[]),p=Re.payloadonhost.reduce((function(e,t){var a=!1,n=e.map((function(e){if(e.host===t.host){a=!0;var n=!1;if(e.payloads.forEach((function(e){e.id===t.payload.id&&(n=!0)})),n)return e;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[].concat(Object(u.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],c=0,o=Object.entries(i);c<o.length;c++){var s=Object(j.a)(o[c],2),l=s[0],p=s[1];r.push({name:l,parameters:p})}var m=Object(b.a)(Object(b.a)({},t.payload),{},{c2info:r,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return Object(b.a)(Object(b.a)({},e),{},{payloads:[].concat(Object(u.a)(e.payloads),[m])})}return e}));if(a)return n;for(var i=t.payload.c2profileparametersinstances.reduce((function(e,t){var a=t.c2profileparameter.crypto_type?{crypto_type:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64}:t.value;return t.c2profile.name in e?Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[].concat(Object(u.a)(e[t.c2profile.name]),[{name:t.c2profileparameter.name,value:a}]))):Object(b.a)(Object(b.a)({},e),{},Object(d.a)({},t.c2profile.name,[{name:t.c2profileparameter.name,value:a}]))}),{}),r=[],c=0,o=Object.entries(i);c<o.length;c++){var s=Object(j.a)(o[c],2),l=s[0],p=s[1];r.push({name:l,parameters:p})}var m=Object(b.a)(Object(b.a)({},t.payload),{},{c2info:r,display:t.payload.filemetum.filename_text+" - "+t.payload.tag,type:"payload",payloadOnHostID:t.id});return[].concat(Object(u.a)(e),[{host:t.host,payloads:[m]}])}),[]),m=l.reduce((function(e,t){var a=e.findIndex((function(e){return e.host===t.host}));return a>-1?(e[a].payloads=[].concat(Object(u.a)(e[a].payloads),Object(u.a)(t.payloads)),Object(u.a)(e)):[].concat(Object(u.a)(e),[Object(b.a)({},t)])}),Object(u.a)(p));return console.log("updating choices and payload choices",m,s),[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{choices:m,payload_choices:s,value:t(p)})]);case"PayloadList":var h=i.supported_agents.split(",");-1!==h.indexOf("")&&h.splice(h.indexOf(""));var f=JSON.parse(i.supported_agent_build_parameters),O=Le.payload.reduce((function(e,t){var a=t.payloadc2profiles.reduce((function(e,t){return[].concat(Object(u.a)(e),[t.c2profile.name])}),[]).join(",");if(h.length>0&&!h.includes(t.payloadtype.ptype))return e;var n=!0;if(t.payloadtype.ptype in f)for(var i=function(){var e=Object(j.a)(c[r],2),a=e[0],i=e[1];t.buildparameterinstances.forEach((function(e){e.buildparameter.name===a&&e.parameter!==i&&(n=!1)}))},r=0,c=Object.entries(f[t.payloadtype.ptype]);r<c.length;r++)i();return n?[].concat(Object(u.a)(e),[Object(b.a)(Object(b.a)({},t),{},{display:t.filemetum.filename_text+" - "+a+" - "+t.tag})]):e}),[]);return O.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{choices:O,default_value:O[0].uuid,value:O[0].uuid})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{choices:O,value:null})]);case"LinkInfo":var x=$e.callbackgraphedge.reduce((function(e,t){return t.source.id===t.destination.id?e:1===t.direction?[].concat(Object(u.a)(e),[Object(b.a)(Object(b.a)({},t),{},{display:"Callback "+t.source.id+" --"+t.c2profile.name+"--\x3e Callback "+t.destination.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):2===t.direction?[].concat(Object(u.a)(e),[Object(b.a)(Object(b.a)({},t),{},{display:"Callback "+t.destination.id+"-> "+t.c2profile.name+"--\x3e Callback "+t.source.id+(null===t.end_timestamp?"(Active)":"(Dead at "+t.end_timestamp+")")})]):e}),[]);return x.length>0?[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{choices:x,value:a(x)})]):[].concat(Object(u.a)(n),[Object(b.a)(Object(b.a)({},i),{},{choices:x,value:{}})]);default:return[].concat(Object(u.a)(n),[Object(b.a)({},i)])}}),[]).sort((function(e,t){return e.ui_position>t.ui_position?1:-1}));n.length>0&&(n[0].autoFocus=!0),G(n)}}),[B,Z,Se,se,$e,ne,Le,We,Re,e.callback_id,e.choices]);var Je=function(){var t=Object(l.a)(o.a.mark((function t(){var a,n,i,c,l,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=[],n={},i=Object(s.a)(U),t.prev=3,i.s();case 5:if((c=i.n()).done){t.next=29;break}l=c.value,t.t0=l.type,t.next="String"===t.t0||"Boolean"===t.t0||"Number"===t.t0||"Choice"===t.t0||"ChoiceMultiple"===t.t0||"Credential-Account"===t.t0||"Credential-Realm"===t.t0||"Credential-Type"===t.t0||"Credential-Credential"===t.t0||"AgentConnect"===t.t0||"PayloadList"===t.t0||"Array"===t.t0||"LinkInfo"===t.t0?10:"File"===t.t0?12:"Credential-JSON"===t.t0?24:26;break;case 10:return n[l.name]=l.value,t.abrupt("break",27);case 12:return r(!0),t.next=15,je(l.value);case 15:if(!(d=t.sent)){t.next=21;break}a.push(d),n[l.name]=d,t.next=23;break;case 21:return r(!1),t.abrupt("return");case 23:return t.abrupt("break",27);case 24:return n[l.name]={account:l.value.account,comment:l.value.comment,credential:l.value.credential_text,realm:l.value.realm,type:l.value.type},t.abrupt("break",27);case 26:console.log("Unknown parameter type");case 27:t.next=5;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(3),i.e(t.t1);case 34:return t.prev=34,i.f(),t.finish(34);case 37:r(!1),e.onSubmit(e.command.cmd,JSON.stringify(n),a,B);case 39:case"end":return t.stop()}}),t,null,[[3,31,34,37]])})));return function(){return t.apply(this,arguments)}}(),Ye=function(e,t){Ue({variables:{host:e,payload_id:t}})},Ze=function(e){Ke({variables:{payloadOnHostID:e}})},Xe=function(e,t,a){var n=U.map((function(a){return a.name===e?Object(b.a)(Object(b.a)({},a),{},{value:t}):Object(b.a)({},a)}));G(n)};return Object(Q.jsxs)(h.a.Fragment,{children:[Object(Q.jsxs)(g.a,{id:"form-dialog-title",children:[T.cmd,"'s Parameters"]}),Object(Q.jsxs)(x.a,{dividers:!0,children:[Object(Q.jsx)(K.a,{open:i,style:{zIndex:2,position:"absolute"},children:Object(Q.jsx)(V.a,{color:"inherit"})}),Object(Q.jsxs)(y.a,{component:"div",children:[Object(Q.jsx)("b",{children:"Description"})," ",Object(Q.jsx)("pre",{style:{margin:0,wordBreak:"break-all",overflow:"word-wrap",whiteSpace:"pre-wrap"},children:T.description}),Object(Q.jsx)("br",{}),Object(Q.jsx)(pe.a,{}),Object(Q.jsx)("b",{children:"Requires Admin?"}),Object(Q.jsx)("pre",{style:{margin:0},children:T.needs_admin?"True":"False"}),Object(Q.jsx)("br",{}),Object(Q.jsx)(pe.a,{}),L.length>1&&Object(Q.jsx)(I.a,{style:{width:"100%"},children:Object(Q.jsx)(ue.a,{select:!0,label:"Parameter Group",value:B,onChange:function(e){M(e.target.value)},input:Object(Q.jsx)(P.a,{}),children:L.map((function(e,t){return Object(Q.jsx)(be.a,{value:e,children:e},"paramgroup"+t)}))})})]}),Object(Q.jsx)(w.a,{component:D.a,elevation:5,className:"mythicElement",style:{backgroundColor:t.tableHover,marginTop:"10px"},children:Object(Q.jsxs)(v.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(Q.jsx)(C.a,{children:Object(Q.jsxs)(S.a,{children:[Object(Q.jsx)(k.a,{style:{width:"30%"},children:"Parameter"}),Object(Q.jsx)(k.a,{children:"Value"})]})}),Object(Q.jsx)(_.a,{children:U.map((function(t){return Object(Q.jsx)(X,Object(b.a)(Object(b.a)({onSubmit:Je,onChange:Xe,commandInfo:T},t),{},{callback_id:e.callback_id,onAgentConnectAddNewPayloadOnHost:Ye,onAgentConnectRemovePayloadOnHost:Ze,addedCredential:Ve}),"taskparameterrow"+t.id)}))})]})})]}),Object(Q.jsxs)(O.a,{children:[Object(Q.jsx)(f.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(Q.jsx)(f.a,{onClick:Je,variant:"contained",color:"secondary",children:"Submit"})]})]})}},222:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(6),i=a(2),r=a(1),c=a.n(r),o=a(54),s=a(97),l=a(96),d=a(111),u=a(366),b=a(364),j=a(368),p=a(365),m=a(363),h=a(51),f=a(0);function O(e){var t=c.a.useState([]),a=Object(i.a)(t,2),O=a[0],x=a[1],g=c.a.useState(""),y=Object(i.a)(g,2),v=y[0],_=y[1],k=Object(r.useRef)(null),w=Object(h.a)();return Object(r.useEffect)((function(){var t=Object(n.a)(e.options);x(t),t.length>0?_(t[0]):_("")}),[e.options]),Object(f.jsxs)(c.a.Fragment,{children:[Object(f.jsx)(d.a,{children:e.title}),Object(f.jsx)(l.a,{dividers:!0,children:Object(f.jsx)(c.a.Fragment,{children:Object(f.jsxs)(b.a,{style:{width:"100%"},children:[Object(f.jsx)(p.a,{ref:k,children:"Options"}),Object(f.jsxs)(j.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:v,onChange:function(e){_(e.target.value)},input:Object(f.jsx)(m.a,{style:{width:"100%"}}),children:[Object(f.jsx)(u.a,{value:"",children:Object(f.jsx)("em",{children:"None"})}),O.map((function(t){return Object(f.jsx)(u.a,{value:t,children:t[e.display]},t[e.identifier])}))]})]})})}),Object(f.jsxs)(s.a,{children:[Object(f.jsx)(o.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(f.jsx)(o.a,{onClick:function(){e.onSubmit(v),e.dontCloseOnSubmit||e.onClose()},variant:"contained",style:{backgroundColor:w.palette.success.main},children:e.action})]})]})}},296:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(2),i=a(1),r=a.n(i),c=a(54),o=a(97),s=a(96),l=a(847),d=a(297),u=a.n(d),b=a(480),j=a.n(b),p=a(51),m=a(0);function h(e){var t=e.onClose,a=e.images,i=e.startIndex,d=r.a.useState(!1),b=Object(n.a)(d,2),h=b[0],f=b[1],O=Object(p.a)(),x=r.a.useState(i||0),g=Object(n.a)(x,2),y=g[0],v=g[1],_=(null===a||void 0===a?void 0:a.length)||1;return Object(m.jsxs)(r.a.Fragment,{children:[Object(m.jsx)(s.a,{dividers:!0,style:{padding:0},children:Object(m.jsx)("div",{style:{height:"calc(80vh)",display:h?"":"flex",alignItems:h?"":"center",background:"dark"===O.palette.type?"rgb(44, 52, 60)":"grey"},children:Object(m.jsx)("img",{onClick:function(){f(!h)},src:"/api/v1.4/files/screencaptures/"+a[y],style:{width:h?"":"100%",cursor:h?"zoom-out":"zoom-in",overflow:"auto"}})})}),Object(m.jsx)(l.a,{variant:"text",steps:_,position:"static",activeStep:y,nextButton:Object(m.jsxs)(c.a,{size:"small",onClick:function(){v((function(e){return e+1}))},disabled:y===_-1,children:["Next",Object(m.jsx)(u.a,{})]}),backButton:Object(m.jsxs)(c.a,{size:"small",onClick:function(){v((function(e){return e-1}))},disabled:0===y,children:[Object(m.jsx)(j.a,{}),"Back"]})}),Object(m.jsx)(o.a,{children:Object(m.jsx)(c.a,{variant:"contained",onClick:t,color:"primary",children:"Close"})})]})}},298:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n,i,r=a(6),c=a(2),o=a(7),s=a(1),l=a.n(s),d=a(57),u=a(195),b=a(4),j=a(54),p=a(97),m=a(96),h=a(111),f=a(248),O=a(250),x=a(77),g=a(247),y=a(249),v=a(134),_=a(73),k=a(58),w=a(51),C=a(0),S=Object(d.a)(n||(n=Object(o.a)(["\nfragment allTokenData on token {\n    id\n    Address\n    AppContainer\n    AppContainerNumber\n    AppContainerSid\n    AppId\n    AppModelPolicies\n    AppModelPolicyDictionary\n    AttributesFlags\n    AuditPolicy\n    AuthenticationId_id\n    BnoIsolationPrefix\n    CanSynchronize\n    Capabilities\n    CreationTime\n    DefaultDacl\n    DenyOnlyGroups\n    DeviceClaimAttributes\n    DeviceGroups\n    Elevated\n    ElevationType\n    EnabledGroups\n    ExpirationTime\n    Filtered\n    Flags\n    FullPath\n    GrantedAccess\n    GrantedAccessGeneric\n    GrantedAccessMask\n    GroupCount\n    Groups\n    Handle\n    HandleReferenceCount\n    HasRestrictions\n    ImpersonationLevel\n    Inherit\n    IntegrityLevel\n    IntegrityLevelSid\n    IsClosed\n    IsContainer\n    IsPseudoToken\n    IsRestricted\n    IsSandbox\n    LogonSid\n    LowPrivilegeAppContainer\n    MandatoryPolicy\n    ModifiedId\n    Name\n    NoChildProcess\n    NotLow\n    NtType\n    NtTypeName\n    Origin\n    Owner\n    PackageFullName\n    PackageIdentity\n    PackageName\n    PointerReferenceCount\n    PrimaryGroup\n    PrivateNamespace\n    Privileges\n    ProcessUniqueAttribute\n    ProtectFromClose\n    Restricted\n    RestrictedDeviceClaimAttributes\n    RestrictedDeviceGroups\n    RestrictedSids\n    RestrictedSidsCount\n    RestrictedUserClaimAttributes\n    SandboxInert\n    Sddl\n    SecurityAttributes\n    SecurityDescriptor\n    SessionId\n    Source\n    ThreadID\n    TokenId\n    TokenType\n    TrustLevel\n    UIAccess\n    User\n    UserClaimAttributes\n    VirtualizationAllowed\n    VirtualizationEnabled\n    WriteRestricted\n    task_id\n    logonsession {\n      id\n      LogonId\n      UserName\n      LogonDomain\n      LogonType\n      SessionId\n      Sid\n      LogonTime\n      LogonServer\n      DnsDomainName\n      Upn\n      UserFlags\n      LastSuccessfulLogon\n      LastFailedLogon\n      FailedAttemptCountSinceLastSuccessfulLogon\n      LogonScript\n      ProfilePath\n      HomeDirectory\n      HomeDirectoryDrive\n      LogoffTime\n      KickOffTime\n      PasswordLastSet\n      PasswordCanChange\n      PasswordMustChange\n      task_id\n      authenticationpackages {\n        id\n        Name\n        task_id\n      }\n    }\n}\n"]))),D=Object(d.a)(i||(i=Object(o.a)(["\n","\nquery getTokenInfo ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    ...allTokenData\n  }\n}\n"])),S);function I(e){var t=Object(w.a)(),a=Object(s.useState)([]),n=Object(c.a)(a,2),i=n[0],o=n[1],d=Object(s.useState)([]),S=Object(c.a)(d,2),I=S[0],T=S[1],$=Object(s.useState)([]),P=Object(c.a)($,2),A=P[0],E=P[1],L=["Address","AppContainer","AppContainerNumber","AppContainerSid","AppId","AppModelPolicies","AppModelPolicyDictionary","AttributesFlags","AuditPolicy","AuthenticationId_id","BnoIsolationPrefix","CanSynchronize","Capabilities","CreationTime","DefaultDacl","DenyOnlyGroups","DeviceClaimAttributes","DeviceGroups","Elevated","ElevationType","EnabledGroups","ExpirationTime","Filtered","Flags","FullPath","GrantedAccess","GrantedAccessGeneric","GrantedAccessMask","GroupCount","Groups","Handle","HandleReferenceCount","HasRestrictions","ImpersonationLevel","Inherit","IntegrityLevel","IntegrityLevelSid","IsClosed","IsContainer","IsPseudoToken","IsRestricted","IsSandbox","LogonSid","LowPrivilegeAppContainer","MandatoryPolicy","ModifiedId","Name","NoChildProcess","NotLow","NtType","NtTypeName","Origin","Owner","PackageFullName","PackageIdentity","PackageName","PointerReferenceCount","PrimaryGroup","PrivateNamespace","Privileges","ProcessUniqueAttribute","ProtectFromClose","Restricted","RestrictedDeviceClaimAttributes","RestrictedDeviceGroups","RestrictedSids","RestrictedSidsCount","RestrictedUserClaimAttributes","SandboxInert","Sddl","SecurityAttributes","SecurityDescriptor","SessionId","Source","ThreadID","TokenId","TokenType","TrustLevel","UIAccess","User","UserClaimAttributes","VirtualizationAllowed","VirtualizationEnabled","WriteRestricted","task_id"],F=["LogonId","UserName","LogonDomain","LogonType","SessionId","Sid","LogonTime","LogonServer","DnsDomainName","Upn","UserFlags","LastSuccessfulLogon","LastFailedLogon","FailedAttemptCountSinceLastSuccessfulLogon","LogonScript","ProfilePath","HomeDirectory","HomeDirectoryDrive","LogoffTime","KickOffTime","PasswordLastSet","PasswordCanChange","PasswordMustChange","task_id"],N=["Name","task_id"];return Object(u.a)(D,{variables:{token_id:e.token_id},onCompleted:function(e){if(null!==e.token_by_pk){o(e.token_by_pk);var t=L.reduce((function(t,a){return void 0!==e.token_by_pk[a]&&null!==e.token_by_pk[a]&&""!==e.token_by_pk[a]?[].concat(Object(r.a)(t),[{name:a,value:e.token_by_pk[a]}]):Object(r.a)(t)}),[]);if(o(t),null!==e.token_by_pk.logonsession){var a=F.reduce((function(t,a){return void 0!==e.token_by_pk.logonsession[a]&&null!==e.token_by_pk.logonsession[a]&&""!==e.token_by_pk.logonsession[a]?[].concat(Object(r.a)(t),[{name:a,value:e.token_by_pk.logonsession[a]}]):Object(r.a)(t)}),[]);if(T(a),e.token_by_pk.logonsession.authenticationpackages.length>0){var n=e.token_by_pk.logonsession.authenticationpackages.map((function(e){return N.reduce((function(t,a){return void 0!==e[a]&&null!==e[a]&&""!==e[a]?[].concat(Object(r.a)(t),[{name:a,value:e[a]}]):Object(r.a)(t)}),[])}));E(n)}}}},onError:function(e){b.b.error(e)},fetchPolicy:"network-only"}),Object(C.jsxs)(l.a.Fragment,{children:[Object(C.jsx)(h.a,{id:"form-dialog-title",children:"Token Information"}),Object(C.jsxs)(m.a,{dividers:!0,children:[Object(C.jsx)(_.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(C.jsx)(k.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Token Data"})}),Object(C.jsx)(_.a,{elevation:5,style:{position:"relative"},variant:"elevation",children:Object(C.jsx)(g.a,{component:_.a,className:"mythicElement",children:Object(C.jsxs)(f.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(C.jsx)(y.a,{children:Object(C.jsxs)(v.a,{children:[Object(C.jsx)(x.a,{children:"Token Property"}),Object(C.jsx)(x.a,{children:"Token Value"})]})}),Object(C.jsx)(O.a,{children:i.map((function(e,t){return Object(C.jsxs)(v.a,{children:[Object(C.jsx)(x.a,{children:e.name}),Object(C.jsx)(x.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"row"+t)}))})]})})}),I.length>0&&Object(C.jsxs)(l.a.Fragment,{children:[Object(C.jsx)(_.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(C.jsx)(k.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Logon Session Data"})}),Object(C.jsx)(_.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(C.jsx)(g.a,{component:_.a,className:"mythicElement",children:Object(C.jsxs)(f.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(C.jsx)(y.a,{children:Object(C.jsxs)(v.a,{children:[Object(C.jsx)(x.a,{children:"Logon Session Property"}),Object(C.jsx)(x.a,{children:"Logon Session Value"})]})}),Object(C.jsx)(O.a,{children:I.map((function(e,t){return Object(C.jsxs)(v.a,{children:[Object(C.jsx)(x.a,{children:e.name}),Object(C.jsx)(x.a,{children:!0===e.value?"True":!1===e.value?"False":e.value})]},"logondatarow"+t)}))})]})})})]}),A.map((function(e){return Object(C.jsxs)(l.a.Fragment,{children:[Object(C.jsx)(_.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(C.jsx)(k.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Associated Authentication Package"})}),Object(C.jsx)(_.a,{elevation:5,style:{position:"relative",marginTop:"20px"},variant:"elevation",children:Object(C.jsx)(g.a,{component:_.a,className:"mythicElement",children:Object(C.jsxs)(f.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(C.jsx)(y.a,{children:Object(C.jsxs)(v.a,{children:[Object(C.jsx)(x.a,{children:"Authentication Package Property"}),Object(C.jsx)(x.a,{children:"Authentication Package Value"})]})}),Object(C.jsx)(O.a,{children:e.map((function(t,a){return Object(C.jsxs)(v.a,{children:[Object(C.jsx)(x.a,{children:t.name}),Object(C.jsx)(x.a,{children:!0===t.value?"True":!1===t.value?"False":t.value})]},"authpackage"+e.id+"row"+a)}))})]})})})]},"authpkg"+e.id)}))]}),Object(C.jsx)(p.a,{children:Object(C.jsx)(j.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},356:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a(1),r=a.n(i),c=a(75),o=a.n(c),s=(a(157),a(146),a(158),a(51)),l=a(0),d=function(e){var t=Object(s.a)(),a=r.a.useState(String(e.plaintext)),c=Object(n.a)(a,2),d=c[0],u=c[1];return Object(i.useEffect)((function(){try{var t=JSON.stringify(JSON.parse(String(e.plaintext)),null,4);u(t)}catch(a){u(String(e.plaintext))}}),[e.plaintext]),Object(l.jsx)(o.a,{mode:"json",theme:"dark"===t.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:d,width:"100%",minLines:2,maxLines:50,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})}},4:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return o}));var n=a(3),i=a(79),r=null,c=function(){return r=Object(i.c)(),null},o={success:function(e,t){this.toast(e,"success",t)},warning:function(e,t){this.toast(e,"warning",t)},info:function(e,t){this.toast(e,"info",t)},error:function(e,t){this.toast(e,"error",t)},dismiss:function(){r.closeSnackbar()},toast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",a=arguments.length>2?arguments[2]:void 0;r.enqueueSnackbar(e,Object(n.a)({variant:t},a))}}},477:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return re}));var n,i,r,c=a(2),o=a(7),s=a(1),l=a.n(s),d=a(139),u=a(107),b=a.n(u),j=a(300),p=a.n(j),m=a(478),h=a(492),f=a.n(h),O=a(13),x=a(485),g=a(486),y=a(51),v=a(108),_=a.n(v),k=a(175),w=a.n(k),C=a(488),S=a(489),D=a(490),I=a(4),T=a(491),$=a.n(T),P=a(299),A=a.n(P),E=a(214),L=a.n(E),F=a(215),N=a.n(F),q=a(298),R=a(196),B=a(357),M=a.n(B),z=a(57),W=a(252),H=a(197),U=a(41),G=a(30),K=a(72),V=a.n(K),Q=a(857),J=a(858),Y=a(88),Z=a(142),X=a(319),ee=a(0),te=Object(z.a)(n||(n=Object(o.a)(["\nmutation reissueTaskMutation($task_id: Int!){\n  reissue_task(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),ae=Object(z.a)(i||(i=Object(o.a)(["\nmutation reissueTaskHandlerMutation($task_id: Int!){\n  reissue_task_handler(task_id: $task_id){\n    status\n    error\n  }\n}\n"]))),ne=Object(z.a)(r||(r=Object(o.a)(["\nquery subResponsesQuery($task_id: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n}"]))),ie=Object(Z.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{top:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{bottom:e.spacing(1),left:e.spacing(2)},zIndex:3},tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),re=function(e){var t=e.task,a=l.a.useState(!0),n=Object(c.a)(a,2),i=n[0],r=n[1],o=l.a.useState(0),d=Object(c.a)(o,2),u=d[0],b=d[1],j=l.a.useState(!1),p=Object(c.a)(j,2),h=p[0],f=p[1],O=l.a.useState(!1),x=Object(c.a)(O,2),g=x[0],y=x[1];Object(s.useEffect)((function(){b(null===t.command?0:t.command.id)}),[t.command]);var v=l.a.useCallback((function(){r(!i)}),[i]),_=l.a.useCallback((function(){y(!g)}),[g]),k=l.a.useCallback((function(){f(!h)}),[h]);return Object(ee.jsx)(l.a.Fragment,{children:Object(ee.jsxs)(R.a,{container:!0,spacing:0,style:{maxWidth:"100%"},children:[Object(ee.jsx)(ce,{toggleViewBrowserScript:v,toggleSelectAllOutput:_,toggleOpenSearch:k,taskData:t,viewAllOutput:g}),Object(ee.jsx)(R.a,{item:!0,xs:12,children:Object(ee.jsx)(m.a,{task:t,command_id:u,viewBrowserScript:i,searchOutput:h,selectAllOutput:g})})]})})},ce=function(t){var a=t.toggleViewBrowserScript,n=t.toggleSelectAllOutput,i=t.toggleOpenSearch,r=t.taskData,o=t.viewAllOutput,s="top",u=Object(y.a)(),j=ie(),m=l.a.useState(r||{}),h=Object(c.a)(m,2),v=h[0],k=h[1],T=l.a.useState(!1),P=Object(c.a)(T,2),E=P[0],F=P[1],R=l.a.useState(!1),B=Object(c.a)(R,2),z=B[0],K=B[1],Z=l.a.useState(!1),re=Object(c.a)(Z,2),ce=re[0],oe=re[1],se=l.a.useState(!1),le=Object(c.a)(se,2),de=le[0],ue=le[1],be=l.a.useState(!1),je=Object(c.a)(be,2),pe=je[0],me=je[1],he=l.a.useState(!1),fe=Object(c.a)(he,2),Oe=fe[0],xe=fe[1],ge=l.a.useState(!1),ye=Object(c.a)(ge,2),ve=ye[0],_e=ye[1],ke=Object(W.a)(ne,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.response.reduce((function(t,a){return t+e.from(a.response,"base64")}),""),n=new Blob([a],{type:"application/octet-stream"}),i=document.getElementById("download_config");if(null!==i)i.href=URL.createObjectURL(n),i.download="task_"+v.id+".txt",i.click();else{var r=document.createElement("a");r.id="download_config",r.href=URL.createObjectURL(n),r.download="task_"+v.id+".txt",document.body.appendChild(r),r.click()}},onError:function(e){}}),we=Object(c.a)(ke,1)[0];l.a.useEffect((function(){k(r)}),[r.id,r.token,r.original_params,r.opsec_pre_blocked,r.opsec_pre_bypassed,r.opsec_post_blocked,r.opsec_post_bypassed]);var Ce=Object(H.a)(te,{onCompleted:function(e){"success"===e.reissue_task.status?I.b.success("Successfully re-issued task to Mythic"):I.b.error("Failed to re-issue task to Mythic: "+e.reissue_task.error)},onError:function(e){console.log(e),I.b.error("Failed to re-issue task: "+e)}}),Se=Object(c.a)(Ce,1)[0],De=Object(H.a)(ae,{onCompleted:function(e){"success"===e.reissue_task_handler.status?I.b.success("Successfully resubmitted task for handling"):I.b.warning("Failed to resubmit task for handling: "+e.reissue_task_handler.error)},onError:function(e){console.log(e),I.b.error("Error resubmitting task for handling: "+e)}}),Ie=Object(c.a)(De,1)[0];return Object(ee.jsxs)(l.a.Fragment,{children:[Object(ee.jsx)(X.a,{open:E,onClick:function(){F(!1)},style:{zIndex:2,position:"absolute"}}),z?Object(ee.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:z,onClose:function(){K(!1)},innerDialog:Object(ee.jsx)(g.a,{task_id:v.id,onClose:function(){K(!1)}})}):null,ce?Object(ee.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:ce,onClose:function(){oe(!1)},innerDialog:Object(ee.jsx)(x.a,{task_id:v.id,onClose:function(){oe(!1)}})}):null,de?Object(ee.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:de,onClose:function(){ue(!1)},innerDialog:Object(ee.jsx)(S.a,{task_id:v.id,onClose:function(){ue(!1)}})}):null,pe?Object(ee.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:pe,onClose:function(){me(!1)},innerDialog:Object(ee.jsx)(q.a,{token_id:void 0===v.token?0:v.token.id,onClose:function(){me(!1)}})}):null,ve?Object(ee.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:ve,onClose:function(){_e(!1)},innerDialog:Object(ee.jsx)(C.a,{task_id:v.id,onClose:function(){_e(!1)}})}):null,Oe?Object(ee.jsx)(O.a,{fullWidth:!0,maxWidth:"md",open:Oe,onClose:function(){xe(!1)},innerDialog:Object(ee.jsx)(D.a,{task_id:v.id,onClose:function(){xe(!1)}})}):null,Object(ee.jsxs)(Q.a,{ariaLabel:"Task Speeddial",className:j.speedDial,icon:Object(ee.jsx)(J.a,{}),onClick:function(){F(!E)},FabProps:{color:"primary",size:"small"},open:E,direction:"right",children:[Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(A.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Toggle BrowserScript",onClick:function(){a(),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(U.a,{icon:G.i,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:o?"View Paginated Output":"View All Output",onClick:function(){n(),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(V.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Search Output",onClick:function(){i(),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(b.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Download output",onClick:function(){we({variables:{task_id:v.id}}),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)($.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Edit Tags",onClick:function(){K(!0),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(U.a,{icon:G.j,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Open Task in New Window",onClick:function(){window.open("/new/task/"+v.id,"_blank")}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(p.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Copy original params to clipboard",onClick:function(){Object(d.a)(v.original_params)?I.b.success("Copied text!"):I.b.error("Failed to copy text"),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(f.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Edit Comment",onClick:function(){oe(!0),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(L.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"View All Parameters",onClick:function(){ue(!0),F(!1)}}),Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(U.a,{icon:G.b,size:"lg"}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"View Stdout/Stderr of Task",onClick:function(){xe(!0),F(!1)}}),null===v.opsec_pre_blocked?null:!1===v.opsec_pre_bypassed?Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(_.a,{style:{color:u.palette.error.main}}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Submit OPSEC PreCheck Bypass Request",onClick:function(){_e(!0),F(!1)}}):Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(w.a,{style:{color:u.palette.success.main}}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"View OPSEC PreCheck Data",onClick:function(){_e(!0),F(!1)}}),null===v.opsec_post_blocked?null:!1===v.opsec_post_bypassed?Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(_.a,{style:{color:u.palette.error.main}}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Submit OPSEC PostCheck Bypass Request",onClick:function(){_e(!0),F(!1)}}):Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(w.a,{style:{color:u.palette.success.main}}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"View OPSEC PostCheck Data",onClick:function(){_e(!0),F(!1)}}),null===v.token?null:Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(N.a,{}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"View Token Information",onClick:function(){me(!0),F(!1)}}),v.status.toLowerCase().includes("error: container")?Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(M.a,{style:{color:u.palette.warning.main}}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Resubmit Tasking",onClick:function(){Se({variables:{task_id:v.id}})}}):null,v.status.toLowerCase().includes("error: task")?Object(ee.jsx)(Y.a,{icon:Object(ee.jsx)(M.a,{style:{color:u.palette.warning.main}}),arrow:!0,TooltipClasses:{tooltip:j.tooltip,arrow:j.arrow},tooltipPlacement:s,tooltipTitle:"Resubmit Task Handler",onClick:function(){Ie({variables:{task_id:v.id}})}}):null]})]})}}).call(this,a(454).Buffer)},478:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return z}));var n,i,r,c,o,s=a(6),l=a(3),d=a(2),u=a(7),b=a(1),j=a.n(b),p=a(57),m=a(252),h=a(545),f=a(318),O=a(16),x=a(4),g=a(479),y=a(356),v=a(533),_=a(483),k=a(484),w=a(17),C=a(72),S=a.n(C),D=a(51),I=a(224),T=a(19),$=a(855),P=a(58),A=a(319),E=a(843),L=a(0),F=Object(p.a)(n||(n=Object(u.a)(["\nsubscription subResponsesQuery($task_id: Int!, $fetchLimit: Int!) {\n  response(where: {task_id: {_eq: $task_id}}, limit: $fetchLimit, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n}"]))),N=Object(p.a)(i||(i=Object(u.a)(["\nquery subResponsesQuery($task_id: Int!, $fetchLimit: Int!, $offset: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}, limit: $fetchLimit, offset: $offset, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),q=Object(p.a)(r||(r=Object(u.a)(["\nsubscription responseTotalCountSubscription($task_id: Int!){\n  response_aggregate(where: {task_id: {_eq: $task_id}}){\n    aggregate{\n      count\n    }\n  }\n}\n"]))),R=Object(p.a)(c||(c=Object(u.a)(["\nquery subResponsesQuery($task_id: Int!, $search: String!) {\n  response(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}, order_by: {id: asc}) {\n    id\n    response: response_text\n  }\n  response_aggregate(where: {task_id: {_eq: $task_id}, response_escape: {_ilike: $search}}){\n    aggregate{\n      count\n    }\n  }\n}"]))),B=Object(p.a)(o||(o=Object(u.a)(["\nquery getBrowserScriptsQuery($command_id: Int!, $operator_id: Int!, $operation_id: Int!){\n  browserscript(where: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}, operator_id: {_eq: $operator_id}}) {\n    script\n    id\n  }\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {active: {_eq: true}, command_id: {_eq: $command_id}, for_new_ui: {_eq: true}}}) {\n    browserscript {\n      script\n      id\n    }\n  }\n}\n\n"]))),M=10,z=function(t){var a=j.a.useState(""),n=Object(d.a)(a,2),i=n[0],r=n[1],c=j.a.useState([]),o=Object(d.a)(c,2),u=o[0],b=o[1],p=j.a.useRef(0),f=j.a.useState(""),O=Object(d.a)(f,2),g=O[0],y=O[1],v=j.a.useState(0),_=Object(d.a)(v,2),k=_[0],w=_[1],C=j.a.useRef(t.selectAllOutput),S=j.a.useState(!0),D=Object(d.a)(S,2),I=D[0],T=D[1],$=j.a.useRef(!0),P=Object(m.a)(N,{fetchPolicy:"network-only",onCompleted:function(a){var n=a.response.reduce((function(t,a){return t+e.from(a.response,"base64")}),""),i=a.response.reduce((function(e,t){return t.id>e?t.id:e}),p.current);p.current=i,r(n);var c=a.response.map((function(t){return String(e.from(t.response,"base64"))}));b(c),t.selectAllOutput||w(a.response_aggregate.aggregate.count),T(!1)},onError:function(e){x.b.error("Failed to fetch more responses: "+e)}}),q=Object(d.a)(P,1)[0],B=Object(m.a)(R,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.response.reduce((function(t,a){return t+e.from(a.response,"base64")}),""),n=t.response.reduce((function(e,t){return t.id>e?t.id:e}),p.current);p.current=n,r(a);var i=t.response.map((function(t){return String(e.from(t.response,"base64"))}));b(i),w(1),T(!1)},onError:function(e){}}),z=Object(d.a)(B,1)[0];j.a.useEffect((function(){return function(){$.current=!1}}),[]),j.a.useEffect((function(){t.selectAllOutput!==C.current&&t.selectAllOutput&&(T(!0),z(""===g?{variables:{task_id:t.task.id,search:"%%"}}:{variables:{task_id:t.task.id,search:"%"+g+"%"}}))}),[t.selectAllOutput,C]);var G=j.a.useCallback((function(t){var a=t.subscriptionData;if(console.log("fetchLimit",M,"totalCount",k),!$.current)return null;if(k>=M)console.log("got more than we can see currently",k);else if(T(!1),a.data.response.length>0){var n=a.data.response.filter((function(e){return e.id>p.current})).map((function(t){return Object(l.a)(Object(l.a)({},t),{},{response:String(e.from(t.response,"base64"))})}));n.sort((function(e,t){return e.id>t.id?1:-1}));for(var c=i,o=Object(s.a)(u),d=p.current,j=k,m=0;m<n.length&&j<M;m++)c+=n[m].response,o.push(n[m].response),d=n[m].id,j+=1;r(c),b(o),p.current=d}}),[r,i,b,p.current,u,k]);Object(h.a)(F,{variables:{task_id:t.task.id,fetchLimit:M},fetchPolicy:"network_only",onSubscriptionData:G});var K=j.a.useCallback((function(e){y(e),T(!0),void 0===e||""===e?t.selectAllOutput?z({variables:{task_id:t.task.id,search:"%%"}}):q({variables:{task_id:t.task.id,fetchLimit:M,offset:0,search:"%_%"}}):t.selectAllOutput?z({variables:{task_id:t.task.id,search:"%"+e+"%"}}):q({variables:{task_id:t.task.id,fetchLimit:M,offset:0,search:"%"+e+"%"}})}),[]);return Object(L.jsxs)(j.a.Fragment,{children:[Object(L.jsx)(A.a,{open:I,onClick:function(){T(!1)},style:{zIndex:2,position:"absolute"},children:Object(L.jsx)(E.a,{color:"inherit",disableShrink:!0})}),t.searchOutput&&Object(L.jsx)(H,{onSubmitSearch:K}),Object(L.jsx)("div",{style:{overflow:"auto",maxWidth:"100%",width:"100%"},children:Object(L.jsx)(U,{rawResponses:u,viewBrowserScript:t.viewBrowserScript,output:i,command_id:t.command_id,task:t.task,search:g})}),Object(L.jsx)(W,{selectAllOutput:t.selectAllOutput,totalCount:k,onSubmitPageChange:function(e){t.selectAllOutput||(T(!0),q(void 0===g||""===g?{variables:{task_id:t.task.id,fetchLimit:M,offset:M*(e-1),search:"%_%"}}:{variables:{task_id:t.task.id,fetchLimit:M,offset:M*(e-1),search:"%"+g+"%"}}))},task:t.task,search:g,parentMountedRef:$})]})},W=function(e){var t=e.selectAllOutput,a=e.totalCount,n=e.onSubmitPageChange,i=e.task,r=e.search,c=e.parentMountedRef,o=j.a.useState(0),s=Object(d.a)(o,2),l=s[0],u=s[1],b=j.a.useState(0),p=Object(d.a)(b,2),m=p[0],f=p[1],O=j.a.useState(1),x=Object(d.a)(O,2),g=x[0],y=x[1],v=j.a.useRef(!0),_=j.a.useCallback((function(e){var t=e.subscriptionData;v.current&&c.current&&f(t.data.response_aggregate.aggregate.count)}),[m]);Object(h.a)(q,{variables:{task_id:i.id},onSubscriptionData:_});return j.a.useEffect((function(){return function(){v.current=!1}}),[]),j.a.useEffect((function(){v.current&&c.current&&(t?(u(1),y(1)):u(""===r?m:a))}),[a,m,r,t]),Object(L.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:[Object(L.jsx)($.a,{count:Math.ceil(l/M),page:g,variant:"outlined",color:"primary",boundaryCount:2,onChange:function(e,t){v.current&&(y(t),n(t))},style:{margin:"10px"}}),Object(L.jsxs)(P.a,{style:{paddingLeft:"10px"},children:["Total Results: ",l]})]})},H=function(e){var t=e.onSubmitSearch,a=Object(D.a)(),n=j.a.useState(""),i=Object(d.a)(n,2),r=i[0],c=i[1],o=function(){t(r)};return Object(L.jsx)("div",{style:{marginTop:"5px"},children:Object(L.jsx)(w.a,{value:r,autoFocus:!0,onEnter:o,onChange:function(e,t,a){return c(t)},placeholder:"Search Output of This Task",name:"Search...",InputProps:{endAdornment:Object(L.jsx)(j.a.Fragment,{children:Object(L.jsx)(T.a,{title:"Search",children:Object(L.jsx)(I.a,{onClick:o,children:Object(L.jsx)(S.a,{style:{color:a.palette.info.main}})})})}),style:{padding:0}}})})},U=function(t){var a,n,i,r,c=t.rawResponses,o=t.viewBrowserScript,s=t.output,u=t.command_id,p=t.task,h=t.search,w=j.a.useState(!0),C=Object(d.a)(w,2),S=C[0],D=C[1],I=j.a.useState({}),T=Object(d.a)(I,2),$=T[0],P=T[1],A=j.a.useRef(),E=Object(f.a)(O.b);Object(b.useEffect)((function(){if(void 0!==A.current)try{var e=A.current(p,c);P(F(e))}catch(t){D(!1),console.log(t)}}),[c]);var F=function(e){var t=Object(l.a)({},e);if(""===h)return e;if(void 0!==e.plaintext&&(e.plaintext.includes(h)||(t.plaintext="")),void 0!==e.table&&e.table.length>0){var a=e.table.map((function(e){var t=e.rows.filter((function(e){for(var t=!1,a=0,n=Object.values(e);a<n.length;a++){var i=n[a];void 0!==i.plaintext&&String(i.plaintext).includes(h)&&(t=!0),void 0!==i.button&&void 0!==i.button.value&&JSON.stringify(i.button.value).includes(h)&&(t=!0)}return t}));return Object(l.a)(Object(l.a)({},e),{},{rows:t})}));t.table=a}return t};Object(b.useEffect)((function(){if(void 0===A.current)D(!1);else if(D(o),o&&void 0!==A.current)try{var e=A.current(p,c);P(F(e))}catch(t){D(!1)}}),[o]);var N=Object(m.a)(B,{fetchPolicy:"network-only",onCompleted:function(t){if(t.browserscriptoperation.length>0)try{var a=e.from(t.browserscriptoperation[0].script,"base64"),n=Function('"use strict";return('+a+")")();A.current=n,D(!0);var i=A.current(p,c);P(F(i))}catch(l){x.b.error(l.toString()),console.log(l),D(!1)}else if(t.browserscript.length>0)try{var r=e.from(t.browserscript[0].script,"base64"),o=Function('"use strict";return('+r+")")();A.current=o,D(!0);var s=A.current(p,c);P(F(s))}catch(l){x.b.error(l.toString()),console.log(l),D(!1)}else D(!1)},onError:function(e){console.log(e)}}),q=Object(d.a)(N,1)[0];return Object(b.useEffect)((function(){void 0!==u&&q({variables:{command_id:u,operator_id:E.user.user_id,operation_id:E.user.current_operation_id}})}),[u]),S&&$?Object(L.jsxs)(j.a.Fragment,{children:[(null===$||void 0===$||null===(a=$.screenshot)||void 0===a?void 0:a.map((function(e,t){return Object(L.jsx)(g.a,Object(l.a)({},e),"screenshot"+t+"fortask"+p.id)})))||null,(null===$||void 0===$?void 0:$.plaintext)&&Object(L.jsx)(y.a,{plaintext:$.plaintext}),(null===$||void 0===$||null===(n=$.table)||void 0===n?void 0:n.map((function(e,t){return Object(L.jsx)(v.a,{callback_id:p.callback_id,table:e},"tablefortask"+p.id+"table"+t)})))||null,(null===$||void 0===$||null===(i=$.download)||void 0===i?void 0:i.map((function(e,t){return Object(L.jsx)(_.a,{download:e},"download"+t+"fortask"+p.id)})))||null,(null===$||void 0===$||null===(r=$.search)||void 0===r?void 0:r.map((function(e,t){return Object(L.jsx)(k.a,{search:e},"searchlink"+t+"fortask"+p.id)})))||null]}):Object(L.jsx)(y.a,{plaintext:s})}}).call(this,a(454).Buffer)},479:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(2),i=a(1),r=a.n(i),c=a(54),o=a(296),s=a(13),l=a(251),d=a(142),u=a(0),b=Object(d.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),j=function(e){var t=r.a.useState(!1),a=Object(n.a)(t,2),i=a[0],d=a[1],j=b();(new Date).toUTCString();return Object(u.jsxs)(r.a.Fragment,{children:[i&&Object(u.jsx)(s.a,{fullWidth:!0,maxWidth:"xl",open:i,onClose:function(){d(!1)},innerDialog:Object(u.jsx)(o.a,{images:e.agent_file_id,onClose:function(){d(!1)}})}),Object(u.jsx)("pre",{style:{display:"inline-block"},children:(null===e||void 0===e?void 0:e.plaintext)||""}),Object(u.jsx)(l.a,{title:(null===e||void 0===e?void 0:e.hoverText)||"View Screenshot",arrow:!0,classes:{tooltip:j.tooltip,arrow:j.arrow},children:Object(u.jsx)(c.a,{color:"primary",variant:e.variant?e.variant:"contained",onClick:function(){d(!0)},style:{marginBottom:"10px"},children:e.name})})]})}},48:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return O}));var n=a(3),i=a(86),r=a(224),c=a(141),o=a.n(c),s=a(543),l=a(1),d=a.n(l),u=a(0),b=["children","value","index","maxHeight","tabInfo","getCallbackData","queryParams","changeSearchParam"],j=["label","index","fullWidth","maxHeight","onContextMenu","onCloseTab","selectionFollowsFocus","textColor","indicator","tabInfo","onEditTabDescription","getCallbackData"],p=["label","index","fullWidth","maxHeight","selectionFollowsFocus","textColor","indicator","iconComponent"];function m(e){var t=e.children,a=e.value,r=e.index,c=(e.maxHeight,e.tabInfo,e.getCallbackData,e.queryParams,e.changeSearchParam,Object(i.a)(e,b)),o=void 0===e.style?{display:a===r?"flex":"none",flexDirection:"column",flexGrow:1,width:"100%",maxWidth:"100%",overflowY:"auto"}:e.style;return Object(u.jsx)("div",Object(n.a)(Object(n.a)({role:"tabpanel",hidden:a!==r,id:"scrollable-auto-tabpanel-".concat(r),"aria-labelledby":"scrollable-auto-tab-".concat(r),style:o},c),{},{children:Object(u.jsx)(d.a.Fragment,{children:t})}))}function h(e){return{id:"scrollable-auto-tab-".concat(e),"aria-controls":"scrollable-auto-tabpanel-".concat(e)}}function f(e){var t=e.label,a=e.index,c=(e.fullWidth,e.maxHeight,e.onContextMenu),l=e.onCloseTab,d=(e.selectionFollowsFocus,e.textColor,e.indicator,e.tabInfo),b=(e.onEditTabDescription,e.getCallbackData,Object(i.a)(e,j));return Object(u.jsx)(s.a,Object(n.a)(Object(n.a)({label:Object(u.jsxs)("span",{onContextMenu:c,style:{display:"inline-block",zIndex:1},children:[t,Object(u.jsx)(r.a,Object(n.a)(Object(n.a)({component:"div",size:"small",onClick:function(e){e.stopPropagation(),l({tabID:d.tabID,index:a})}},b),{},{children:Object(u.jsx)(o.a,{})}))]})},h(a)),b))}function O(e){var t=e.label,a=e.index,r=(e.fullWidth,e.maxHeight,e.selectionFollowsFocus,e.textColor,e.indicator,e.iconComponent),c=Object(i.a)(e,p);return Object(u.jsx)(s.a,Object(n.a)(Object(n.a)({label:Object(u.jsxs)("span",{children:[t,Object(u.jsx)("br",{}),r]})},h(a)),c))}},483:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(1),i=a.n(n),r=a(107),c=a.n(r),o=a(251),s=a(142),l=a(54),d=a(0),u=Object(s.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),b=function(e){var t,a,n,r,s=u();return Object(d.jsxs)(i.a.Fragment,{children:[Object(d.jsx)("pre",{style:{display:"inline-block"},children:(null===(t=e.download)||void 0===t?void 0:t.plaintext)||""}),Object(d.jsx)(o.a,{title:(null===e||void 0===e||null===(a=e.dowload)||void 0===a?void 0:a.hoverText)||"Download payload",arrow:!0,classes:{tooltip:s.tooltip,arrow:s.arrow},children:Object(d.jsx)(l.a,{variant:(null===(n=e.download)||void 0===n?void 0:n.variant)||"contained",component:"a",target:"_blank",color:"primary",href:"/api/v1.4/files/download/"+e.download.agent_file_id,download:!0,startIcon:Object(d.jsx)(c.a,{}),children:(null===(r=e.download)||void 0===r?void 0:r.name)||""})}),Object(d.jsx)("br",{})]})}},484:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(1),i=a.n(n),r=a(251),c=a(142),o=a(848),s=a(0),l=Object(c.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}})),d=function(e){var t,a,n,c=l();return Object(s.jsxs)(i.a.Fragment,{children:[Object(s.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap"},children:(null===(t=e.search)||void 0===t?void 0:t.plaintext)||""}),Object(s.jsx)(r.a,{title:(null===(a=e.search)||void 0===a?void 0:a.hoverText)||"View on Search Page",arrow:!0,classes:{tooltip:c.tooltip,arrow:c.arrow},children:Object(s.jsx)(o.a,{component:"a",target:"_blank",href:window.location.origin+"/new/search/?"+e.search.search,children:(null===(n=e.search)||void 0===n?void 0:n.name)||""})}),Object(s.jsx)("br",{})]})}},485:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n,i,r=a(2),c=a(7),o=a(1),s=a.n(o),l=a(54),d=a(97),u=a(96),b=a(111),j=a(17),p=a(57),m=a(195),h=a(197),f=a(225),O=a(0),x=Object(p.a)(n||(n=Object(c.a)(["\nmutation updateComment ($task_id: Int!, $comment: String) {\n  update_task_by_pk(pk_columns: {id: $task_id}, _set: {comment: $comment}) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"]))),g=Object(p.a)(i||(i=Object(c.a)(["\nquery getCommentQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    comment\n    commentOperator {\n      username\n    }\n    id\n  }\n}\n"])));function y(e){var t=Object(o.useState)(""),a=Object(r.a)(t,2),n=a[0],i=a[1],c=Object(m.a)(g,{variables:{task_id:e.task_id},onCompleted:function(e){i(e.task_by_pk.comment)},fetchPolicy:"network-only"}),p=c.loading,y=c.error,v=Object(h.a)(x,{update:function(e,t){t.data}}),_=Object(r.a)(v,1)[0];if(p)return Object(O.jsx)(f.a,{});if(y)return console.error(y),Object(O.jsx)("div",{children:"Error!"});var k=function(){_({variables:{task_id:e.task_id,comment:n}}),e.onClose()};return Object(O.jsxs)(s.a.Fragment,{children:[Object(O.jsx)(b.a,{id:"form-dialog-title",children:"Edit Task Comment"}),Object(O.jsx)(u.a,{dividers:!0,children:Object(O.jsx)(j.a,{autoFocus:!0,onEnter:k,onChange:function(e,t,a){i(t)},value:n})}),Object(O.jsxs)(d.a,{children:[Object(O.jsx)(l.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(O.jsx)(l.a,{onClick:k,variant:"contained",color:"secondary",children:"Submit"})]})]})}},486:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));var n,i,r,c=a(6),o=a(2),s=a(7),l=a(1),d=a.n(l),u=a(54),b=a(97),j=a(96),p=a(111),m=a(17),h=a(57),f=a(318),O=a(195),x=a(197),g=a(225),y=a(16),v=a(142),_=a(196),k=a(537),w=a(367),C=a(846),S=a(542),D=a(856),I=a(73),T=a(841),$=a(844),P=a(845),A=a(487),E=a.n(A),L=a(224),F=a(170),N=a(4),q=a(0),R=Object(h.a)(n||(n=Object(s.a)(["\nmutation addTaskTag ($task_id: Int!, $tag: String!) {\n  insert_tasktag_one(object: {task_id: $task_id, tag: $tag}){\n    id\n  }\n}\n"]))),B=Object(h.a)(i||(i=Object(s.a)(["\nmutation removeTaskTag($tasktag_id: Int!){\n  delete_tasktag_by_pk(id: $tasktag_id){\n    id\n  }\n}\n"]))),M=Object(h.a)(r||(r=Object(s.a)(["\nquery getTaskTags ($operation_id: Int!) {\n  tasktag(where: {operation_id: {_eq: $operation_id}}) {\n    id\n    tag\n    task_id\n  }\n}\n"]))),z=Object(v.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}}));function W(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function H(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}function U(e){var t=Object(l.useState)(""),a=Object(o.a)(t,2),n=a[0],i=a[1],r=Object(f.a)(y.b),s=Object(O.a)(M,{variables:{operation_id:r.user.current_operation_id},onCompleted:function(t){var a=t.tasktag.reduce((function(t,a){return a.task_id===e.task_id?[].concat(Object(c.a)(t),[a]):Object(c.a)(t)}),[]),n=t.tasktag.reduce((function(e,t){return e.find((function(e){return e.tag===t.tag}))||a.find((function(e){return e.tag===t.tag}))?Object(c.a)(e):[].concat(Object(c.a)(e),[t])}),[]);ae(n),ce(a),de(Object(c.a)(a))},fetchPolicy:"network-only"}),h=s.loading,v=s.error,A=Object(x.a)(R,{update:function(e,t){t.data}}),U=Object(o.a)(A,1)[0],G=Object(x.a)(B,{update:function(e,t){t.data}}),K=Object(o.a)(G,1)[0],V=z(),Q=d.a.useState([]),J=Object(o.a)(Q,2),Y=J[0],Z=J[1],X=d.a.useState([]),ee=Object(o.a)(X,2),te=ee[0],ae=ee[1],ne=d.a.useState([]),ie=Object(o.a)(ne,2),re=ie[0],ce=ie[1],oe=d.a.useState([]),se=Object(o.a)(oe,2),le=se[0],de=se[1],ue=H(Y,te),be=H(Y,re),je=function(e){return function(){var t=Y.indexOf(e),a=Object(c.a)(Y);-1===t?a.push(e):a.splice(t,1),Z(a)}},pe=function(e,t){return Object(q.jsx)(I.a,{className:V.paper,style:{width:"100%"},children:Object(q.jsxs)(T.a,{children:[Object(q.jsx)($.a,{className:V.cardHeader,title:e}),Object(q.jsx)(P.a,{classes:{root:V.divider}}),Object(q.jsxs)(k.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[t.map((function(e){var t="transfer-list-item-".concat(e.id,"-label");return Object(q.jsxs)(w.a,{style:{padding:0},role:"listitem",button:!0,onClick:je(e),children:[Object(q.jsx)(C.a,{children:Object(q.jsx)(D.a,{checked:-1!==Y.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":t}})}),Object(q.jsx)(S.a,{id:t,primary:e.tag})]},e.id)})),Object(q.jsx)(w.a,{})]})]})})};if(h)return Object(q.jsx)(g.a,{});if(v)return console.error(v),Object(q.jsx)("div",{children:"Error!"});return Object(q.jsxs)(d.a.Fragment,{children:[Object(q.jsx)(p.a,{id:"form-dialog-title",children:"Edit Task Tags"}),Object(q.jsxs)(j.a,{dividers:!0,children:[Object(q.jsxs)(_.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:V.root,children:[Object(q.jsx)(_.a,{item:!0,xs:5,children:pe("Unused Tags In Operation",te)}),Object(q.jsx)(_.a,{item:!0,children:Object(q.jsxs)(_.a,{container:!0,direction:"column",alignItems:"center",children:[Object(q.jsx)(u.a,{variant:"outlined",size:"small",className:V.button,onClick:function(){ce(re.concat(te)),ae([])},disabled:0===te.length,"aria-label":"move all right",children:"\u226b"}),Object(q.jsx)(u.a,{variant:"outlined",size:"small",className:V.button,onClick:function(){ce(re.concat(ue)),ae(W(te,ue)),Z(W(Y,ue))},disabled:0===ue.length,"aria-label":"move selected right",children:">"}),Object(q.jsx)(u.a,{variant:"outlined",size:"small",className:V.button,onClick:function(){ae(te.concat(be)),ce(W(re,be)),Z(W(Y,be))},disabled:0===be.length,"aria-label":"move selected left",children:"<"}),Object(q.jsx)(u.a,{variant:"outlined",size:"small",className:V.button,onClick:function(){ae(te.concat(re)),ce([])},disabled:0===re.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(q.jsx)(_.a,{item:!0,xs:5,children:pe("Applied Tags To Task",re)})]}),Object(q.jsx)(m.a,{autoFocus:!0,multiline:!1,name:"Add New Tag...",onChange:function(e,t,a){i(t)},value:n,style:{display:"inline-block"},InputProps:{endAdornment:Object(q.jsx)(d.a.Fragment,{children:Object(q.jsx)(L.a,{style:{color:F.a.palette.success.main},variant:"contained",onClick:function(){re.find((function(e){return e.tag===n}))||te.find((function(e){return e.tag===n}))||""!==n&&ce([].concat(Object(c.a)(re),[{tag:n,id:0,task_id:0}])),i("")},children:Object(q.jsx)(E.a,{})})})}})]}),Object(q.jsxs)(b.a,{children:[Object(q.jsx)(u.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(q.jsx)(u.a,{onClick:function(){le.forEach((function(e){re.find((function(t){return t.id===e.id}))||K({variables:{tasktag_id:e.id}})})),re.forEach((function(t){le.find((function(e){return e.id===t.id}))||U({variables:{task_id:e.task_id,tag:t.tag}})})),""!==n&&U({variables:{task_id:e.task_id,tag:n}}),N.b.success("Updated tags"),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}},488:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n,i,r=a(2),c=a(7),o=a(1),s=a.n(o),l=a(54),d=a(97),u=a(96),b=a(111),j=a(17),p=a(57),m=a(195),h=a(197),f=a(225),O=a(79),x=a(0),g=Object(p.a)(n||(n=Object(c.a)(["\nmutation requestOpsecBypass ($task_id: Int!) {\n    requestOpsecBypass(task_id: $task_id){\n        status\n        error\n    }\n}\n"]))),y=Object(p.a)(i||(i=Object(c.a)(["\nquery getOPSECQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    opsec_pre_blocked\n    opsec_pre_message\n    opsec_pre_bypassed\n    opsec_pre_bypass_user{\n        username\n        id\n    }\n    opsec_post_blocked\n    opsec_pre_bypass_role\n    opsec_post_message\n    opsec_post_bypassed\n    opsec_post_bypass_role\n    opsec_post_bypass_user{\n        username\n        id\n    }\n    id\n  }\n}\n"])));function v(e){var t=Object(o.useState)(""),a=Object(r.a)(t,2),n=a[0],i=a[1],c=Object(o.useState)({}),p=Object(r.a)(c,2),v=p[0],_=p[1],k=Object(O.c)().enqueueSnackbar,w=Object(m.a)(y,{variables:{task_id:e.task_id},onCompleted:function(e){var t="OPSEC PreCheck Message";console.log(e),null!==e.task_by_pk.opsec_pre_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_pre_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_pre_message+"\n",e.task_by_pk.opsec_post_blocked&&(t+="\nOPSEC PostCheck Message",null!==e.task_by_pk.opsec_post_bypass_user&&(t+=" (bypassed by "+e.task_by_pk.opsec_post_bypass_user.username+")"),t+=":\n\n"+e.task_by_pk.opsec_post_message+"\n"),_(e.task_by_pk),i(t)},fetchPolicy:"network-only"}),C=w.loading,S=w.error,D=Object(h.a)(g,{update:function(e,t){var a=t.data;"success"===a.requestOpsecBypass.status?k("Bypass processed successfully",{variant:"success"}):k(a.requestOpsecBypass.error,{variant:"warning"})}}),I=Object(r.a)(D,1)[0];if(C)return Object(x.jsx)(f.a,{});if(S)return console.error(S),Object(x.jsx)("div",{children:"Error!"});return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(b.a,{id:"form-dialog-title",children:"Request OPSEC Bypass"}),Object(x.jsx)(u.a,{dividers:!0,children:Object(x.jsx)(j.a,{multiline:!0,onChange:function(){},value:n})}),Object(x.jsxs)(d.a,{children:[Object(x.jsx)(l.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),!0===v.opsec_pre_blocked&&!v.opsec_pre_bypassed||!0===v.opsec_post_blocked&&!v.opsec_post_bypassed?Object(x.jsx)(l.a,{onClick:function(){console.log(e.task_id),I({variables:{task_id:e.task_id}}),e.onClose()},variant:"contained",color:"secondary",children:"Submit Bypass Request"}):null]})]})}},489:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n,i=a(2),r=a(7),c=a(1),o=a.n(c),s=a(54),l=a(97),d=a(96),u=a(111),b=a(17),j=a(57),p=a(195),m=a(225),h=a(0),f=Object(j.a)(n||(n=Object(r.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    display_params\n    original_params\n    params\n    tasking_location\n    parameter_group_name\n    id\n  }\n}\n"])));function O(e){var t=Object(c.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],j=Object(p.a)(f,{variables:{task_id:e.task_id},onCompleted:function(e){var t="Original Parameters:\n"+e.task_by_pk.original_params;t+="\n\nAgent Parameters:\n"+e.task_by_pk.params,t+="\n\nDisplay Parameters:\n"+e.task_by_pk.display_params,t+="\n\nTasking Location:\n"+e.task_by_pk.tasking_location,t+="\n\nParameter Group:\n"+e.task_by_pk.parameter_group_name,r(t)},fetchPolicy:"network-only"}),O=j.loading,x=j.error;return O?Object(h.jsx)(m.a,{}):x?(console.error(x),Object(h.jsx)("div",{children:"Error!"})):Object(h.jsxs)(o.a.Fragment,{children:[Object(h.jsx)(u.a,{id:"form-dialog-title",children:"View Task Parameters"}),Object(h.jsx)(d.a,{dividers:!0,children:Object(h.jsx)(b.a,{multiline:!0,value:n,onChange:function(){}})}),Object(h.jsx)(l.a,{children:Object(h.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},490:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n,i=a(2),r=a(7),c=a(1),o=a.n(c),s=a(54),l=a(97),d=a(96),u=a(111),b=a(17),j=a(57),p=a(195),m=a(225),h=a(0),f=Object(j.a)(n||(n=Object(r.a)(["\nquery getParametersQuery ($task_id: Int!) {\n  task_by_pk(id: $task_id) {\n    stdout\n    stderr\n    id\n  }\n}\n"])));function O(e){var t=Object(c.useState)(""),a=Object(i.a)(t,2),n=a[0],r=a[1],j=Object(p.a)(f,{variables:{task_id:e.task_id},onCompleted:function(e){r("[STDOUT]:\n"+e.task_by_pk.stdout+"\n[STDERR]:\n"+e.task_by_pk.stderr)},fetchPolicy:"network-only"}),O=j.loading,x=j.error;return O?Object(h.jsx)(m.a,{}):x?(console.error(x),Object(h.jsx)("div",{children:"Error!"})):Object(h.jsxs)(o.a.Fragment,{children:[Object(h.jsx)(u.a,{id:"form-dialog-title",children:"View Task Stdout/Stderr"}),Object(h.jsx)(d.a,{dividers:!0,children:Object(h.jsx)(b.a,{multiline:!0,value:n,onChange:function(){}})}),Object(h.jsx)(l.a,{children:Object(h.jsx)(s.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}},533:function(e,t,a){"use strict";a.d(t,"a",(function(){return B}));var n=a(6),i=a(2),r=a(3),c=a(1),o=a.n(c),s=a(54),l=a(13),d=a(193),u=a(97),b=a(96),j=a(111),p=a(0);function m(e){var t=e.table,a=e.callback_id,n=e.title,i=e.onClose;return Object(p.jsxs)(o.a.Fragment,{children:[Object(p.jsx)(j.a,{id:"form-dialog-title",children:n}),Object(p.jsx)(b.a,{dividers:!0,children:Object(p.jsx)(B,{table:t,callback_id:a})}),Object(p.jsx)(u.a,{children:Object(p.jsx)(s.a,{variant:"contained",onClick:i,color:"primary",children:"Close"})})]})}var h=a(73),f=a(58),O=a(51),x=(a(347),a(132)),g=a(536),y=a(842),v=a(366),_=a(832),k=a(834),w=a(139),C=a(224),S=a(4),D=a(19),I=a(41),T=a(172),$=a(30),P=function(e){Object(w.a)(e)?S.b.success("Copied text!"):S.b.error("Failed to copy text")},A=function(e){switch(e.toLowerCase()){case"openfolder":case"folder":return $.v;case"closedfolder":return $.u;case"archive":case"zip":return $.l;case"diskimage":return $.c;case"executable":return $.e;case"word":return $.r;case"excel":return $.n;case"powerpoint":return $.q;case"pdf":case"adobe":return $.p;case"database":return $.g;case"key":return $.w;case"code":case"source":return $.m;case"download":return $.h;case"upload":return $.F;case"png":case"jpg":case"image":return $.o;case"list":return $.z;case"delete":return $.E;case"inject":return $.D;case"kill":return $.B;case"camera":return $.d;default:return $.k}},E=function(){},L=function(e){var t,a,n=e.cellData;e.rowData;return Object(p.jsxs)("div",{style:Object(r.a)({},(null===n||void 0===n?void 0:n.cellStyle)||null),children:[(null===n||void 0===n?void 0:n.copyIcon)?Object(p.jsx)(D.a,{title:"Copy to clipboard",children:Object(p.jsx)(C.a,{onClick:function(){return P(n.plaintext)},size:"small",children:Object(p.jsx)(I.a,{icon:$.f})})}):null,(null===n||void 0===n?void 0:n.startIcon)?Object(p.jsx)(D.a,{title:(null===n||void 0===n?void 0:n.startIconHoverText)||"",children:Object(p.jsx)(I.a,{icon:A(null===n||void 0===n?void 0:n.startIcon),style:{marginRight:"5px",color:(null===n||void 0===n?void 0:n.startIconColor)||""}})}):null,(null===n||void 0===n?void 0:n.plaintextHoverText)?Object(p.jsx)(D.a,{title:n.plaintextHoverText,children:Object(p.jsx)("pre",{style:{display:"inline-block"},children:(null===n||void 0===n||null===(t=n.plaintext)||void 0===t?void 0:t.replaceAll("\n",""))||" "})}):Object(p.jsx)("pre",{style:{display:"inline-block"},children:(null===n||void 0===n||null===(a=n.plaintext)||void 0===a?void 0:a.replaceAll("\n",""))||" "}),(null===n||void 0===n?void 0:n.endIcon)?Object(p.jsx)(D.a,{title:(null===n||void 0===n?void 0:n.endIconHoverText)||"",children:Object(p.jsx)(I.a,{icon:A(null===n||void 0===n?void 0:n.endIcon),style:{color:(null===n||void 0===n?void 0:n.endIconColor)||""}})}):null]})},F=function(e){var t=e.cellData;e.rowData;return Object(p.jsxs)("div",{style:Object(r.a)({},(null===t||void 0===t?void 0:t.cellStyle)||null),children:[(null===t||void 0===t?void 0:t.copyIcon)?Object(p.jsx)(D.a,{title:"Copy to clipboard",children:Object(p.jsx)(C.a,{onClick:function(){return P(t.plaintext)},size:"small",children:Object(p.jsx)(I.a,{icon:$.f})})}):null,(null===t||void 0===t?void 0:t.startIcon)?Object(p.jsx)(D.a,{title:(null===t||void 0===t?void 0:t.startIconHoverText)||"",children:Object(p.jsx)(I.a,{icon:A(null===t||void 0===t?void 0:t.startIcon),style:{marginRight:"5px",color:(null===t||void 0===t?void 0:t.startIconColor)||""}})}):null,(null===t||void 0===t?void 0:t.plaintextHoverText)?Object(p.jsx)(D.a,{title:t.plaintextHoverText,children:Object(p.jsx)("pre",{style:{display:"inline-block"},children:(null===t||void 0===t?void 0:t.plaintext)||" "})}):Object(p.jsx)("pre",{style:{display:"inline-block"},children:(null===t||void 0===t?void 0:t.plaintext)||" "}),(null===t||void 0===t?void 0:t.endIcon)?Object(p.jsx)(D.a,{title:(null===t||void 0===t?void 0:t.endIconHoverText)||"",children:Object(p.jsx)(I.a,{icon:A(null===t||void 0===t?void 0:t.endIcon),style:{color:(null===t||void 0===t?void 0:t.endIconColor)||""}})}):null]})},N=function(e){var t=e.cellData;try{var a=parseInt(t.plaintext);if(""===t.plaintext)return"";if(0===a)return"0 Bytes";var n=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,n)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}catch(r){var i;return(null===t||void 0===t||null===(i=t.plaintext)||void 0===i?void 0:i.replaceAll("\n",""))||""}},q=function(e){var t=e.cellData;e.rowData;return Object(p.jsx)("div",{style:Object(r.a)({},(null===t||void 0===t?void 0:t.cellStyle)||null),children:(null===t||void 0===t?void 0:t.plaintextHoverText)?Object(p.jsx)(D.a,{title:t.plaintextHoverText,children:Object(p.jsx)("pre",{style:{display:"inline-block"},children:N({cellData:t})})}):Object(p.jsx)("pre",{style:{display:"inline-block"},children:N({cellData:t})})})},R=function(e){var t=e.cellData,a=e.callback_id,n=e.rowData,u=Object(O.a)(),b=o.a.useState(!1),j=Object(i.a)(b,2),f=j[0],w=j[1],C=o.a.useState(!1),S=Object(i.a)(C,2),T=S[0],$=S[1],P=o.a.useState(!1),E=Object(i.a)(P,2),L=E[0],F=E[1],N=o.a.useState(!1),q=Object(i.a)(N,2),R=q[0],B=q[1],M=o.a.useState(!1),z=Object(i.a)(M,2),W=z[0],H=z[1],U=Object(c.useRef)(null),G=o.a.useState(!1),K=Object(i.a)(G,2),V=K[0],Q=K[1],J=o.a.useState({}),Y=Object(i.a)(J,2),Z=Y[0],X=Y[1],ee=function(e){U.current&&U.current.contains(e.target)||Q(!1)},te=function(){w(!1),$(!1),F(!1),B(!1),H(!1),X({})},ae=function(){w(!1),$(!1),F(!1),B(!1),H(!1),X({})};return Object(p.jsxs)("div",{style:Object(r.a)(Object(r.a)({},(null===n||void 0===n?void 0:n.rowStyle)||null),(null===t||void 0===t?void 0:t.cellStyle)||null),children:[(null===t||void 0===t?void 0:t.plaintext)?t.plaintext:null,(null===t||void 0===t?void 0:t.button)?function(){var e,n,i,c,b,j,O,C,S,P,E,N,q,M,z,G,K,J,Y,ne,ie,re,ce,oe,se,le,de,ue,be,je,pe,me,he,fe,Oe,xe,ge,ye,ve,_e,ke;switch(t.button.type.toLowerCase()){case"dictionary":return Object(p.jsxs)(o.a.Fragment,{children:[Object(p.jsx)(D.a,{title:(null===t||void 0===t||null===(e=t.button)||void 0===e?void 0:e.hoverText)||"Display Data",children:Object(p.jsx)(s.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return w(!0)},disabled:(null===t||void 0===t||null===(n=t.button)||void 0===n?void 0:n.disabled)||!1,startIcon:(null===t||void 0===t||null===(i=t.button)||void 0===i?void 0:i.startIcon)?Object(p.jsx)(I.a,{icon:A(null===t||void 0===t||null===(c=t.button)||void 0===c?void 0:c.startIcon),style:{color:(null===t||void 0===t||null===(b=t.button)||void 0===b?void 0:b.startIconColor)||""}}):null,children:(null===t||void 0===t||null===(j=t.button)||void 0===j?void 0:j.name)||" "})}),f&&Object(p.jsx)(l.a,{fullWidth:!0,maxWidth:"lg",open:f,onClose:function(){w(!1)},innerDialog:Object(p.jsx)(l.c,{title:(null===t||void 0===t||null===(O=t.button)||void 0===O?void 0:O.title)||"Title Here",leftColumn:(null===t||void 0===t||null===(C=t.button)||void 0===C?void 0:C.leftColumnTitle)||"Left Column",rightColumn:(null===t||void 0===t||null===(S=t.button)||void 0===S?void 0:S.rightColumnTitle)||"Right Column",value:(null===t||void 0===t||null===(P=t.button)||void 0===P?void 0:P.value)||{},onClose:function(){w(!1)}})})]});case"string":return Object(p.jsxs)(o.a.Fragment,{children:[Object(p.jsx)(D.a,{title:(null===t||void 0===t||null===(E=t.button)||void 0===E?void 0:E.hoverText)||"Display Data",children:Object(p.jsx)(s.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return w(!0)},disabled:(null===t||void 0===t||null===(N=t.button)||void 0===N?void 0:N.disabled)||!1,startIcon:(null===t||void 0===t||null===(q=t.button)||void 0===q?void 0:q.startIcon)?Object(p.jsx)(I.a,{icon:A(null===t||void 0===t||null===(M=t.button)||void 0===M?void 0:M.startIcon),style:{color:(null===t||void 0===t||null===(z=t.button)||void 0===z?void 0:z.startIconColor)||""}}):null,children:(null===t||void 0===t||null===(G=t.button)||void 0===G?void 0:G.name)||" "})}),f&&Object(p.jsx)(d.a,{fullWidth:!0,maxWidth:"lg",open:f,title:(null===t||void 0===t||null===(K=t.button)||void 0===K?void 0:K.title)||"Title Here",value:(null===t||void 0===t||null===(J=t.button)||void 0===J?void 0:J.value)||"",onClose:function(){w(!1)}})]});case"table":return Object(p.jsxs)(o.a.Fragment,{children:[Object(p.jsx)(D.a,{title:(null===t||void 0===t||null===(Y=t.button)||void 0===Y?void 0:Y.hoverText)||"Display Data",children:Object(p.jsx)(s.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return w(!0)},disabled:(null===t||void 0===t||null===(ne=t.button)||void 0===ne?void 0:ne.disabled)||!1,startIcon:(null===t||void 0===t||null===(ie=t.button)||void 0===ie?void 0:ie.startIcon)?Object(p.jsx)(I.a,{icon:A(null===t||void 0===t||null===(re=t.button)||void 0===re?void 0:re.startIcon),style:{color:(null===t||void 0===t||null===(ce=t.button)||void 0===ce?void 0:ce.startIconColor)||""}}):null,children:(null===t||void 0===t||null===(oe=t.button)||void 0===oe?void 0:oe.name)||" "})}),f&&Object(p.jsx)(l.a,{fullWidth:!0,maxWidth:"xl",open:f,onClose:function(){w(!1)},innerDialog:Object(p.jsx)(m,{title:(null===t||void 0===t||null===(se=t.button)||void 0===se?void 0:se.title)||"Title Here",table:(null===t||void 0===t||null===(le=t.button)||void 0===le?void 0:le.value)||{},callback_id:a,onClose:function(){w(!1)}})})]});case"task":return Object(p.jsxs)(o.a.Fragment,{children:[Object(p.jsx)(D.a,{title:(null===t||void 0===t||null===(de=t.button)||void 0===de?void 0:de.hoverText)||"Issues Task to Agent",children:Object(p.jsx)(s.a,{size:"small",onClick:function(){return $(!0)},disabled:(null===t||void 0===t||null===(ue=t.button)||void 0===ue?void 0:ue.disabled)||!1,variant:"contained",color:"secondary",startIcon:(null===t||void 0===t||null===(be=t.button)||void 0===be?void 0:be.startIcon)?Object(p.jsx)(I.a,{icon:A(null===t||void 0===t||null===(je=t.button)||void 0===je?void 0:je.startIcon),style:{color:(null===t||void 0===t||null===(pe=t.button)||void 0===pe?void 0:pe.startIconColor)||""}}):null,children:(null===t||void 0===t||null===(me=t.button)||void 0===me?void 0:me.name)||" "})}),T&&Object(p.jsx)(x.a,{ui_feature:(null===t||void 0===t||null===(he=t.button)||void 0===he?void 0:he.ui_feature)||" ",callback_id:a,parameters:(null===t||void 0===t||null===(fe=t.button)||void 0===fe?void 0:fe.parameters)||"",openDialog:(null===t||void 0===t||null===(Oe=t.button)||void 0===Oe?void 0:Oe.openDialog)||!1,getConfirmation:(null===t||void 0===t||null===(xe=t.button)||void 0===xe?void 0:xe.getConfirmation)||!1,onTasked:function(){return $(!1)}})]});case"menu":return Object(p.jsxs)(o.a.Fragment,{children:[T&&Object(p.jsx)(x.a,{ui_feature:Z.ui_feature,callback_id:a,parameters:Z.parameters,onTasked:te}),L&&Object(p.jsx)(l.a,{fullWidth:!0,maxWidth:"lg",open:L,onClose:ae,innerDialog:Object(p.jsx)(l.c,{title:Z.title,leftColumn:Z.leftColumnTitle,rightColumn:Z.rightColumnTitle,value:Z.value,onClose:ae})}),R&&Object(p.jsx)(d.a,{fullWidth:!0,maxWidth:"lg",open:R,title:(null===Z||void 0===Z?void 0:Z.title)||"Title Here",value:(null===Z||void 0===Z?void 0:Z.value)||"",onClose:ae}),W&&Object(p.jsx)(l.a,{fullWidth:!0,maxWidth:"xl",open:W,onClose:ae,innerDialog:Object(p.jsx)(m,{title:(null===Z||void 0===Z?void 0:Z.title)||"Title Here",table:(null===Z||void 0===Z?void 0:Z.value)||{},callback_id:a,onClose:ae})}),Object(p.jsx)(s.a,{size:"small",variant:"contained",color:"primary",ref:U,onClick:function(){return Q(!0)},disabled:(null===t||void 0===t||null===(ge=t.button)||void 0===ge?void 0:ge.disabled)||!1,startIcon:(null===t||void 0===t||null===(ye=t.button)||void 0===ye?void 0:ye.startIcon)?Object(p.jsx)(I.a,{icon:A(null===t||void 0===t||null===(ve=t.button)||void 0===ve?void 0:ve.startIcon),style:{color:(null===t||void 0===t||null===(_e=t.button)||void 0===_e?void 0:_e.startIconColor)||""}}):null,children:(null===t||void 0===t||null===(ke=t.button)||void 0===ke?void 0:ke.name)||" "}),Object(p.jsx)(y.a,{open:V,anchorEl:U.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var a=e.TransitionProps,n=e.placement;return Object(p.jsx)(g.a,Object(r.a)(Object(r.a)({},a),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(p.jsx)(h.a,{variant:"outlined",style:{backgroundColor:"dark"===u.palette.type?u.palette.primary.dark:u.palette.primary.light,color:"white"},children:Object(p.jsx)(k.a,{onClickAway:ee,children:Object(p.jsx)(_.a,{id:"split-button-menu",children:t.button.value.map((function(e,a){return Object(p.jsx)(v.a,{disabled:e.disabled,onClick:function(e){return function(e,a){switch(t.button.value[a].type.toLowerCase()){case"task":X(t.button.value[a]),$(!0);break;case"dictionary":X(t.button.value[a]),F(!0);break;case"string":X(t.button.value[a]),B(!0);break;case"table":X(t.button.value[a]),H(!0)}Q(!1)}(0,a)},children:Object(p.jsxs)(D.a,{title:(null===e||void 0===e?void 0:e.hoverText)||("task"===e.type?"Task an Agent":"Display Data"),children:[(null===e||void 0===e?void 0:e.startIcon)?Object(p.jsx)(I.a,{icon:A(null===e||void 0===e?void 0:e.startIcon),style:{color:(null===e||void 0===e?void 0:e.startIconColor)||"",marginRight:"5px"}}):null,e.name]})},e.name+a)}))})})})}))}})]})}}():null]})},B=function(e){var t=e.table,a=e.callback_id,r=Object(O.a)(),s=o.a.useState(530),l=Object(i.a)(s,2),d=l[0],u=l[1],b=Math.floor(d/35),j=o.a.useState([]),m=Object(i.a)(j,2),x=m[0],g=m[1],y=o.a.useState({sortKey:null,sortType:null,sortDirection:"ASC"}),v=Object(i.a)(y,2),_=v[0],k=v[1],w=o.a.useMemo((function(){if(null===_.sortKey||null===_.sortType)return x;var e=Object(n.a)(x);return"number"===_.sortType||"size"===_.sortType?e.sort((function(e,t){return parseInt(e[_.sortKey].plaintext)>parseInt(t[_.sortKey].plaintext)?1:-1})):"date"===_.sortType?e.sort((function(e,t){return new Date(e[_.sortKey].plaintext)>new Date(t[_.sortKey].plaintext)?1:-1})):e.sort((function(e,t){return void 0===e[_.sortKey].plaintext?-1:void 0===t[_.sortKey].plaintext||e[_.sortKey].plaintext.toLowerCase()>t[_.sortKey].plaintext.toLowerCase()?1:-1})),"DESC"===_.sortDirection&&e.reverse(),e}),[x,_]),C=o.a.useMemo((function(){return w.map((function(e){for(var n=[],i=0;i<t.headers.length;i++)switch(t.headers[i].type){case"string":n.push(Object(p.jsx)(L,{cellData:e[t.headers[i].plaintext],rowData:e}));break;case"size":n.push(Object(p.jsx)(q,{cellData:e[t.headers[i].plaintext],rowData:e}));break;case"button":n.push(Object(p.jsx)(R,{callback_id:a,cellData:e[t.headers[i].plaintext],rowData:e}));break;case"number":n.push(Object(p.jsx)(F,{callback_id:a,cellData:e[t.headers[i].plaintext],rowData:e}));break;default:n.push(Object(p.jsx)(L,{cellData:e[t.headers[i].plaintext],rowData:e}))}return[].concat(n)}))}),[w]);Object(c.useEffect)((function(){g(Object(n.a)(t.rows)),t.rows.length<b?u(35*t.rows.length+45):u(530)}),[t.rows]);var S=t.headers.findIndex((function(e){return e.plaintext===_.sortKey}));return Object(p.jsxs)(o.a.Fragment,{children:[(null===t||void 0===t?void 0:t.title)?Object(p.jsx)(h.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(p.jsx)(f.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:t.title})}):null,Object(p.jsx)("div",{style:{height:d,width:"100%"},children:Object(p.jsx)(T.a,{columns:t.headers,sortIndicatorIndex:S,sortDirection:_.sortDirection,items:C,widthMeasureKey:"plaintext",headerNameKey:"plaintext",onDoubleClickRow:E,rowHeight:35,onClickHeader:function(e,a){var n=t.headers[a];n.disableSort||(n.plaintext||k({sortKey:null,sortType:null,sortDirection:"ASC"}),_.sortKey===n.plaintext&&"ASC"===_.sortDirection?k({sortKey:n.plaintext,sortType:n.type,sortDirection:"DESC"}):k({sortKey:n.plaintext,sortType:n.type,sortDirection:"ASC"}))}})})]})}},62:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return c}));var n=a(1);function i(e,t){try{if(null===e)return"N/A";var a=new Date(e);return t?e+" UTC":a.toDateString()+" "+a.toTimeString().substring(0,8)}catch(n){console.log("warning","Failed to get local time converted: "+n.toString())}}function r(e){var t=new Date,a=t.getTime()+6e4*t.getTimezoneOffset(),n=Math.abs(a-new Date(e).getTime()),i=Math.trunc(n/1e3%60),r=Math.trunc(n/6e4%60),c=Math.trunc(n/36e5%24),o=Math.trunc(n/864e5%365),s="";return 0!==o&&(s+=o+"d"),0!==c&&(s+=c+"h"),0!==r&&(s+=r+"m"),s+=i+"s"}function c(e,t,a,i){var r=Object(n.useRef)();Object(n.useEffect)((function(){r.current=e})),Object(n.useEffect)((function(){if(!(a&&!a.current||i&&!i.current)){var e=setInterval((function(){a&&!a.current||i&&!i.current||r.current()}),t);return function(){return clearInterval(e)}}}),[t,a,i])}},71:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(1),i=a.n(n),r=a(54),c=a(97),o=a(111),s=a(13),l=a(835),d=a(96),u=a(51),b=a(0);function j(e){var t=Object(u.a)();return Object(b.jsx)(s.a,{fullWidth:!1,maxWidth:"sm",open:e.open,onClose:function(){e.onClose()},innerDialog:Object(b.jsxs)(i.a.Fragment,{children:[Object(b.jsx)(o.a,{children:e.title?e.title:"Are you sure?"}),void 0===e.dialogText?null:Object(b.jsx)(d.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:Object(b.jsx)(l.a,{children:e.dialogText})}),Object(b.jsxs)(c.a,{children:[Object(b.jsx)(r.a,{onClick:e.onClose,variant:"contained",color:"primary",children:e.cancelText?e.cancelText:"Close"}),Object(b.jsx)(r.a,{onClick:function(){e.onSubmit(),e.onClose()},autoFocus:!0,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:e.acceptText?e.acceptText:"Remove"})]})]})})}},814:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=814},825:function(e,t,a){"use strict";a.r(t),a.d(t,"mythicVersion",(function(){return Lh})),a.d(t,"mythicUIVersion",(function(){return Fh})),a.d(t,"isJWTValid",(function(){return Mh})),a.d(t,"apolloClient",(function(){return Vh})),a.d(t,"restartWebsockets",(function(){return Qh}));var n=a(189),i=a(133),r=a.n(i),c=a(190),o=a(1),s=a.n(o),l=a(44),d=a.n(l),u=a(2),b=a(54),j=a(17),p=a.p+"static/media/mythic.7189479f.svg",m=a(70),h=a(16),f=a(318),O=a(4),x=a(0);function g(e){var t=Object(f.a)(h.b),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),l=Object(u.a)(c,2),d=l[0],g=l[1];Object(o.useEffect)((function(){Mh()||(console.log("calling FailedRefresh on the login page to remove old data"),Object(h.a)())}),[]);var y=function(e){if(e.preventDefault(),""!==i&&""!==d){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:d})};fetch("/auth",t).then((function(e){e.json().then((function(e){console.log(e),"access_token"in e?(Object(h.d)(e),Qh()):(O.b.warning("Invalid Username or Password"),console.log("Error",e))})).catch((function(e){O.b.warning("Error getting JSON from server"),console.log("Error trying to get json response",e.toString())}))})).catch((function(e){O.b.warning("Error talking to server"),console.log("There was an error!",e.toString())}))}else O.b.warning("Username and Password required")};return Object(x.jsx)("div",{style:{justifyContent:"center",display:"flex"},children:t.loggedIn?Object(x.jsx)(m.a,{to:function(){var t=e.location.state;return t&&t.from?t.from.pathname:"/new/"}()}):Object(x.jsxs)("div",{children:[Object(x.jsx)("img",{src:p,height:"400px",alt:"Mythic logo"}),Object(x.jsxs)("form",{onSubmit:y,children:[Object(x.jsx)(j.a,{name:"username",value:i,onChange:function(e,t,a){r(t)},width:30}),Object(x.jsx)(j.a,{name:"password",type:"password",value:d,onChange:function(e,t,a){g(t)},width:30}),Object(x.jsx)(b.a,{type:"submit",color:"primary",onClick:y,variant:"contained",style:{marginRight:"10px"},children:"Login"})]})]})})}var y=a(6),v=a(3),_=a(7),k=a(248),w=a(250),C=a(77),S=a(247),D=a(249),I=a(134),T=a(73),$=a(899),P=a(916),A=a(539),E=a(224),L=a(58),F=a(174),N=a.n(F),q=a(220),R=a.n(q),B=a(47),M=a.n(B),z=a(131),W=a.n(z);function H(e){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{size:"small",onClick:function(){e.onDeleteAPIToken(e.id)},startIcon:Object(x.jsx)(M.a,{}),color:"secondary",variant:"contained",children:"Delete"})}),Object(x.jsx)(C.a,{children:e.token_value})]},"apitokenRow"+e.id)}var U=a(97),G=a(96),K=a(835),V=a(111);function Q(e){var t=s.a.useState(e.username?e.username:""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),p=Object(u.a)(d,2),m=p[0],h=p[1];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:e.title}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(K.a,{children:"Use this dialog to update some information about an operator."}),Object(x.jsx)(j.a,{autoFocus:!0,placeholder:e.username,value:n,onChange:function(e,t,a){i(t)},margin:"dense",id:"username",name:"username"}),Object(x.jsx)(j.a,{margin:"dense",id:"passwordOld",onChange:function(e,t,a){l(t)},name:"old password",type:"password"}),Object(x.jsx)(j.a,{margin:"dense",id:"passwordNew",onChange:function(e,t,a){h(t)},name:"new password",type:"password"})]}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.handleClose,variant:"contained",color:"primary",children:"Cancel"}),Object(x.jsx)(b.a,{onClick:function(){e.onAccept(e.id,n,o,m)},variant:"contained",color:"primary",children:"Update"})]})]})}function J(e){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Delete Operator"}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(K.a,{children:"This deletes an operator and prevents them from permanently logging in again. If you want a temporary solution, disable the operator instead."}),Object(x.jsxs)(K.a,{children:['Are you sure you want to delete operator "',e.username,'"?']})]}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(x.jsx)(b.a,{onClick:function(){e.onAccept(e.id)},variant:"contained",color:"secondary",children:"Delete"})]})]})}var Y=a(13),Z=a(62);function X(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],O=p[1],g=Object(f.a)(h.b);return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(I.a,{children:[Object(x.jsxs)(C.a,{children:[Object(x.jsx)(b.a,{size:"small",onClick:function(){O(!0)},startIcon:Object(x.jsx)(M.a,{}),color:"secondary",variant:"contained",children:"Delete"}),Object(x.jsx)(Y.a,{open:m,onClose:function(){O(!1)},innerDialog:Object(x.jsx)(J,Object(v.a)({onClose:function(){O(!1)},onAccept:function(t){e.onDeleteOperator(t),O(!1)}},e))})]}),Object(x.jsx)(C.a,{children:e.username}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(b.a,{size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Update"}),Object(x.jsx)(Y.a,{open:l,onClose:function(){d(!1)},innerDialog:Object(x.jsx)(Q,Object(v.a)({onAccept:function(t,a,n,i){a!==e.username&&e.onUsernameChanged(t,a),i.length>0&&e.onPasswordChanged({user_id:t,old_password:n,new_password:i}),d(!1)},handleClose:function(){d(!1)},title:"Update Operator"},e))})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:e.view_utc_time,onChange:function(t){var a=e.id;e.onViewUTCChanged(a,!e[t.target.name])},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"view_utc_time"})}),Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:e.active,onChange:function(t){var a=e.id;e.onActiveChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"active"})}),Object(x.jsx)(C.a,{children:Object(Z.b)(e.last_login,g.user.view_utc_time)}),Object(x.jsx)(C.a,{children:Object(Z.b)(e.creation_time,g.user.view_utc_time)}),Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:e.admin,onChange:function(t){var a=e.id;e.onAdminChanged(a,!e[t.target.name])},inputProps:{"aria-label":"primary checkbox"},name:"admin"})}),Object(x.jsx)(C.a,{children:e.id===g.user.id&&Object(x.jsx)(E.a,{"aria-label":"expand row",size:"small",onClick:function(){return i(!n)},children:n?Object(x.jsx)(R.a,{className:"mythicElement"}):Object(x.jsx)(N.a,{className:"mythicElement"})})})]},e.id),Object(x.jsx)(I.a,{children:e.id===g.user.id&&Object(x.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:9,children:Object(x.jsx)(A.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(x.jsxs)(P.a,{margin:1,children:[Object(x.jsx)(L.a,{variant:"h6",gutterBottom:!0,component:"div",style:{display:"inline-block"},children:"API Tokens"}),Object(x.jsx)(b.a,{size:"small",onClick:e.onCreateAPIToken,style:{float:"right"},startIcon:Object(x.jsx)(W.a,{}),color:"primary",variant:"contained",children:"New"}),Object(x.jsxs)(k.a,{size:"small","aria-label":"tokens",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"10rem"},children:"Delete"}),Object(x.jsx)(C.a,{children:"Token"})]})}),Object(x.jsx)(w.a,{children:e.apitokens.map((function(t){return Object(o.createElement)(H,Object(v.a)(Object(v.a)({},t),{},{key:"token"+t.id,onDeleteAPIToken:e.onDeleteAPIToken}))}))})]})]})})})})]})}var ee=a(51);function te(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Settings"})}),Object(x.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(x.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{float:"right"},startIcon:Object(x.jsx)(W.a,{}),color:"primary",variant:"contained",children:"New Operator"}),Object(x.jsx)(Y.a,{open:i,onClose:function(){r(!1)},innerDialog:Object(x.jsx)(Q,Object(v.a)({title:"New Operator",onAccept:function(t,a,n,i){n!==i?O.b.error("Passwords don't match"):0===i.length?O.b.error("Password must not be empty"):0===a.length?O.b.error("Username must not be empty"):(e.onNewOperator(a,i),r(!1))},handleClose:function(){r(!1)}},e))}),Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"9rem"},children:"Delete Account"}),Object(x.jsx)(C.a,{children:"Username"}),Object(x.jsx)(C.a,{style:{width:"6rem"},children:"Modify"}),Object(x.jsx)(C.a,{style:{width:"10rem"},children:"UTC Timestamps"}),Object(x.jsx)(C.a,{style:{width:"9rem"},children:"Account Active"}),Object(x.jsx)(C.a,{children:"Last Login"}),Object(x.jsx)(C.a,{children:"Account Creation Date"}),Object(x.jsx)(C.a,{style:{width:"9rem"},children:"Admin Status"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"More..."})]})}),Object(x.jsx)(w.a,{children:e.operators.map((function(t){return Object(x.jsx)(X,Object(v.a)({onViewUTCChanged:e.onViewUTCChanged,onAdminChanged:e.onAdminChanged,onActiveChanged:e.onActiveChanged,onDeleteOperator:e.onDeleteOperator,onUsernameChanged:e.onUsernameChanged,onPasswordChanged:e.onPasswordChanged,onDeleteAPIToken:e.onDeleteAPIToken,onCreateAPIToken:e.onCreateAPIToken},t),"operator"+t.id)}))})]})]})]})}var ae,ne,ie,re,ce,oe,se,le,de,ue,be=a(57),je=a(195),pe=a(197),me=Object(be.a)(ae||(ae=Object(_.a)(["\nquery GetOperators {\n  operator(where: {deleted: {_eq: false}}, order_by: {username: asc}) {\n    active\n    admin\n    creation_time\n    deleted\n    id\n    last_login\n    username\n    view_utc_time\n    apitokens {\n      token_value\n      token_type\n      active\n      id\n    }\n  }\n}\n"]))),he=Object(be.a)(ne||(ne=Object(_.a)(["\nmutation SettingsUpdateOperatorViewUTCTime($id: Int!, $view_utc_time: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {view_utc_time: $view_utc_time}) {\n    id\n    view_utc_time\n  }\n}\n"]))),fe=Object(be.a)(ie||(ie=Object(_.a)(["\nmutation SettingsUpdateOperatorAdminMutation($id: Int!, $admin: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {admin: $admin}) {\n      id\n      admin\n  }\n}\n"]))),Oe=Object(be.a)(re||(re=Object(_.a)(["\nmutation SettingsUpdateOperatorActiveMutation($id: Int!, $active: Boolean) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {active: $active}) {\n      id\n      active\n  }\n}\n"]))),xe=Object(be.a)(ce||(ce=Object(_.a)(["\nmutation SettingsDeleteOperatorMutation($id: Int!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {deleted: true}) {\n      id\n      deleted\n  }\n}\n"]))),ge=Object(be.a)(oe||(oe=Object(_.a)(["\nmutation SettingsUsernameOperatorMutation($id: Int!, $username: String!) {\n  update_operator_by_pk(pk_columns: {id: $id}, _set: {username: $username}) {\n      id\n      username\n  }\n}\n"]))),ye=Object(be.a)(se||(se=Object(_.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    active\n    creation_time\n    deleted\n    error\n    id\n    last_login\n    status\n    username\n    view_utc_time\n  }\n}\n"]))),ve=Object(be.a)(le||(le=Object(_.a)(["\nmutation operatorsUpdatePasswordMutation($user_id: Int!, $new_password: String!, $old_password: String){\n  updatePassword(user_id: $user_id, new_password: $new_password, old_password: $old_password){\n    status\n    error\n  }\n}\n"]))),_e=Object(be.a)(de||(de=Object(_.a)(['\nmutation createAPITokenMutation{\n  createAPIToken(token_type: "User"){\n    id\n    token_value\n    status\n    error\n    operator_id\n  }\n}\n']))),ke=Object(be.a)(ue||(ue=Object(_.a)(["\nmutation deleteAPIToken($id: Int!){\n  delete_apitokens_by_pk(id: $id){\n    id\n    operator_id\n  }\n}\n"])));function we(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1];Object(je.a)(me,{fetchPolicy:"no-cache",onCompleted:function(e){r(e.operator)}});var c=Object(pe.a)(he,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var a=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(v.a)(Object(v.a)({},t),{},{view_utc_time:e.update_operator_by_pk.view_utc_time}):Object(v.a)({},t)}));if(e.update_operator_by_pk.id===t.user.id){var n=Object(h.b)();n.user.view_utc_time=e.update_operator_by_pk.view_utc_time,Object(h.b)(n)}r(a),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(e){console.log(e),O.b.error("Unable to update operator timestamps without Admin permissions")}}),o=Object(u.a)(c,1)[0],l=Object(pe.a)(xe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.filter((function(t){return t.id!==e.update_operator_by_pk.id}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to delete operator without Admin permissions")}}),d=Object(u.a)(l,1)[0],b=Object(pe.a)(fe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(v.a)(Object(v.a)({},t),{},{admin:e.update_operator_by_pk.admin}):Object(v.a)({},t)}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to update operator admin status without Admin permissions")}}),j=Object(u.a)(b,1)[0],p=Object(pe.a)(Oe,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(v.a)(Object(v.a)({},t),{},{active:e.update_operator_by_pk.active}):Object(v.a)({},t)}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to update operator active status without Admin permissions")}}),m=Object(u.a)(p,1)[0],g=Object(pe.a)(_e,{onCompleted:function(e){if("success"===e.createAPIToken.status){O.b.success("Successfully created new API Token");var t=i.map((function(t){return t.id===e.createAPIToken.operator_id?Object(v.a)(Object(v.a)({},t),{},{apitokens:[].concat(Object(y.a)(t.apitokens),[Object(v.a)({},e.createAPIToken)])}):Object(v.a)({},t)}));r(t)}else O.b.error(e.createAPIToken.error)},onError:function(e){console.log(e)}}),_=Object(u.a)(g,1)[0],k=Object(pe.a)(ke,{onCompleted:function(e){var t=i.map((function(t){return t.id===e.delete_apitokens_by_pk.operator_id?Object(v.a)(Object(v.a)({},t),{},{apitokens:t.apitokens.filter((function(t){return t.id!==e.delete_apitokens_by_pk.id}))}):Object(v.a)({},t)}));r(t)},onError:function(e){}}),w=Object(u.a)(k,1)[0],C=Object(pe.a)(ye,{onCompleted:function(e){if("success"===e.createOperator.status){var t=e.createOperator;r([].concat(Object(y.a)(i),[t]))}else O.b.error(e.createOperator.error)},onError:function(e){O.b.warning("Unable to create new operator"),console.log(e)}}),S=Object(u.a)(C,1)[0],D=Object(pe.a)(ge,{onCompleted:function(e){if(null!==e.update_operator_by_pk){var t=i.map((function(t){return t.id===e.update_operator_by_pk.id?Object(v.a)(Object(v.a)({},t),{},{username:e.update_operator_by_pk.username}):Object(v.a)({},t)}));r(t),O.b.success("Successfully updated")}else O.b.warning("Cannot update another user's data without Admin permissions")},onError:function(){O.b.warning("Unable to update operator's username without Admin permissions")}}),I=Object(u.a)(D,1)[0],T=Object(pe.a)(ve,{onCompleted:function(e){"success"===e.updatePassword.status?O.b.success("Successfully updated password"):O.b.warning(e.updatePassword.error)},onError:function(){O.b.warning("Unable to update operator's password without Admin permissions")}}),$=Object(u.a)(T,1)[0];return Object(x.jsx)("div",{style:{height:"calc(94vh)",marginTop:"10px",marginRight:"5px"},children:Object(x.jsx)(te,{onViewUTCChanged:function(e,t){o({variables:{id:e,view_utc_time:t}})},onAdminChanged:function(e,t){j({variables:{id:e,admin:t}})},onActiveChanged:function(e,t){m({variables:{id:e,active:t}})},onNewOperator:function(e,t){S({variables:{username:e,password:t}})},onDeleteOperator:function(e){d({variables:{id:e}})},onUsernameChanged:function(e,t){I({variables:{id:e,username:t}})},onPasswordChanged:function(e){var t=e.user_id,a=e.old_password,n=e.new_password;$({variables:{user_id:t,new_password:n,old_password:a}})},onCreateAPIToken:function(){_({variables:{}})},onDeleteAPIToken:function(e){w({variables:{id:e}})},operators:i})})}var Ce,Se=a(142),De=a(11),Ie=a(841),Te=a(901),$e=a(902),Pe=a(840),Ae=a(225),Ee=Object(be.a)(Ce||(Ce=Object(_.a)(["\nquery GetPayloadDetails($payload_name: String!) {\n  payloadtype(where: {ptype: {_eq: $payload_name}}) {\n    buildparameters (where: {deleted: {_eq: false} } ){\n      description\n      name\n      id\n      parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function Le(e){var t=Object(o.useState)([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(Ee,{variables:{payload_name:e.payload_name},onCompleted:function(e){console.log(e);var t=e.payloadtype[0].buildparameters.map((function(e){switch(e.parameter_type){case"ChooseOne":return Object(v.a)(Object(v.a)({},e),{},{defaultParameter:e.parameter.split("\n")[0],options:e.parameter.split("\n").join(", ")});default:return Object(v.a)(Object(v.a)({},e),{},{defaultParameter:e.parameter})}}));i(t)}}),c=r.loading,l=r.error;return c?Object(x.jsx)(Ae.a,{}):l?(console.error(l),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(K.a,{children:"These are the build parameters associated with this payload"}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:e.description}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)("b",{children:"Scripting/Building Name: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.name}),Object(x.jsx)("br",{}),Object(x.jsx)("b",{children:"Parameter Type: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.parameter_type}),Object(x.jsx)("br",{}),Object(x.jsx)("b",{children:"Default Parameter: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.defaultParameter}),Object(x.jsx)("br",{}),"ChooseOne"===e.parameter_type?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)("b",{children:"Parameter Options: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.options}),Object(x.jsx)("br",{})]}):null,Object(x.jsx)("b",{children:"Required? "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.required?"Yes":"No"}),Object(x.jsx)("br",{}),Object(x.jsx)("b",{children:"Verifier Regex: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.verifier_regex}),Object(x.jsx)("br",{})]})]},"buildprop"+e.id)}))})]})]}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{variant:"contained",onClick:e.handleClose,color:"primary",children:"Close"})})]})}var Fe=Object(Se.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),Ne=Object(De.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Pe.a);function qe(e){var t=Fe(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(""),m=Object(u.a)(p,2),h=m[0],f=m[1],O=new Date,g=(O.getTime()+6e4*O.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(o.useEffect)((function(){if(e.wrap_these_payload_types.length>0){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));r(t.join(", "))}else r("");f(e.supported_os.split(",").join(", "))}),[e.wrap_these_payload_types,e.supported_os]),Object(x.jsxs)(Ie.a,{className:t.root,elevation:5,children:[Object(x.jsx)(Ne,{overlap:"circle",classes:{badge:t[g]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(x.jsx)(Te.a,{className:t.media,component:"img",style:{width:"125px",height:"125",padding:"10px",objectFit:"unset"},src:"/static/"+e.ptype+".svg"})}),Object(x.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(x.jsx)(L.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.ptype}),Object(x.jsxs)($e.a,{style:{textAlign:"left"},children:[Object(x.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(x.jsx)("b",{children:"Author:"})," ",e.author]}),Object(x.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(x.jsx)("b",{children:"Supported Operating Systems:"})," ",h]}),0===e.wrap_these_payload_types.length?null:Object(x.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(x.jsx)("b",{children:"Wrapped Payload Types:"})," ",i]}),Object(x.jsx)(L.a,{variant:"body2",component:"p",children:e.note})]})]}),Object(x.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(x.jsx)(b.a,{size:"small",variant:"contained",color:"primary",href:e.wrapper?"/docs/wrappers/"+e.ptype:"/docs/agents/"+e.ptype,target:"_blank",children:"Docs"}),Object(x.jsx)(b.a,{size:"small",onClick:function(){j(!0)},color:"primary",variant:"contained",children:"Building Info"}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:d,onClose:function(){j(!1)},innerDialog:Object(x.jsx)(Le,Object(v.a)(Object(v.a)({},e),{},{payload_name:e.ptype}))})]})]})}var Re,Be,Me=a(545),ze=Object(be.a)(Re||(Re=Object(_.a)(["\n subscription getPayloadTypesSubscription {\n  payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n    author\n    container_running\n    id\n    last_heartbeat\n    note\n    ptype\n    supported_os\n    wrapper\n    translationcontainer {\n        id\n        name\n        last_heartbeat\n        container_running\n    }\n    wrap_these_payload_types {\n        id\n        wrapped {\n          ptype\n        }\n    }\n  }\n}\n "])));function We(e){var t=Object(ee.a)(),a=Object(Me.a)(ze).data,n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1];return Object(o.useEffect)((function(){c(void 0!==a?a.payloadtype:[])}),[a]),Object(x.jsxs)("div",{style:{flexDirection:"column",alignItems:"stretch"},children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payload Types"})}),r.map((function(e){return Object(x.jsx)(qe,Object(v.a)({},e),"payloadtype"+e.id)}))]})}var He=Object(be.a)(Be||(Be=Object(_.a)(["\nquery GetPC2Details($payload_name: String!) {\n  c2profile(where: {name: {_eq: $payload_name}}) {\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      name\n      parameter_type\n      id\n      randomize\n      required\n      verifier_regex\n    }\n  }\n}\n"])));function Ue(e){var t=Object(o.useState)([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(He,{variables:{payload_name:e.payload_name},onCompleted:function(e){var t=e.c2profile[0].c2profileparameters.map((function(e){switch(e.parameter_type){case"ChooseOne":return Object(v.a)(Object(v.a)({},e),{},{defaultParameter:e.default_value.split("\n")[0],options:e.default_value.split("\n").join(", ")});case"Date":return Object(v.a)(Object(v.a)({},e),{},{defaultParameter:"Today with an offset of "+e.default_value+" days"});case"Dictionary":return Object(v.a)(Object(v.a)({},e),{},{defaultParameter:JSON.stringify(JSON.parse(e.default_value),null,2)});default:return Object(v.a)(Object(v.a)({},e),{},{defaultParameter:e.default_value})}}));i(t)}}),c=r.loading,l=r.error;return c?Object(x.jsx)(Ae.a,{}):l?(console.error(l),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:[e.payload_name,"'s Build Parameters"]}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(K.a,{children:"These are the build parameters associated with this payload"}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{tableLayout:"fixed",overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:e.description}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)("b",{children:"Scripting/Building Name: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.name}),Object(x.jsx)("br",{}),Object(x.jsx)("b",{children:"Parameter Type: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.parameter_type}),Object(x.jsx)("br",{}),Object(x.jsx)("b",{children:"Default Parameter: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.defaultParameter}),Object(x.jsx)("br",{}),"ChooseOne"===e.parameter_type?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)("b",{children:"Parameter Options: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.options}),Object(x.jsx)("br",{})]}):null,Object(x.jsx)("b",{children:"Required? "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.required?"Yes":"No"}),Object(x.jsx)("br",{}),""===e.verifier_regex?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)("b",{children:"Verifier Regex: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.verifier_regex}),Object(x.jsx)("br",{})]}),Object(x.jsx)("b",{children:"Randomize value?: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.randomize?"Yes":"No"}),Object(x.jsx)("br",{}),""===e.format_string?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)("b",{children:"Random Format String: "}),Object(x.jsx)("pre",{style:{display:"inline-block",whiteSpace:"pre-wrap",margin:0},children:e.format_string}),Object(x.jsx)("br",{})]})]})]},"buildprop"+e.id)}))})]})]}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var Ge,Ke,Ve=a(167),Qe=a.n(Ve),Je=a(904),Ye=a(106),Ze=a.n(Ye),Xe=a(834),et=a(536),tt=a(842),at=a(366),nt=a(832),it=a(75),rt=a.n(it),ct=(a(157),a(146),a(158),Object(be.a)(Ge||(Ge=Object(_.a)(["\nquery getProfileOutput($id: Int!) {\n  getProfileOutput(id: $id) {\n    status\n    error\n    output\n  }\n}\n"]))));function ot(e){var t=Object(ee.a)(),a=Object(je.a)(ct,{variables:{id:e.profile_id},onCompleted:function(e){},fetchPolicy:"network-only"}),n=a.loading,i=a.error,r=a.data;return n?Object(x.jsx)(Ae.a,{}):i?(console.error(i),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(K.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(x.jsx)(rt.a,{mode:"json",theme:"dark"===t.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:r.getProfileOutput.output,width:"100%",minLines:2,maxLines:50,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})]}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var st=Object(be.a)(Ke||(Ke=Object(_.a)(["\nquery getProfileConfigOutput($id: Int!, $filename: String!) {\n  downloadContainerFile(id: $id, filename: $filename) {\n    status\n    error\n    filename\n    data\n  }\n}\n"])));function lt(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)(),c=Object(je.a)(st,{variables:{id:e.profile_id,filename:"config.json"},onCompleted:function(e){"error"===e.downloadContainerFile.status?i("Errored trying to read file from container\n"+e.downloadContainerFile.error):(console.log(e),i(atob(e.downloadContainerFile.data)))},fetchPolicy:"network-only"}),l=c.loading,d=c.error;if(l)return Object(x.jsx)(Ae.a,{});if(d)return console.error(d),Object(x.jsx)("div",{children:"Error!"});return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Configuration"]}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(rt.a,{mode:"json",theme:"dark"===r.palette.type?"monokai":"xcode",onChange:function(e,t){i(e)},fontSize:14,showGutter:!0,highlightActiveLine:!0,value:n,focus:!0,width:"100%",setOptions:{showLineNumbers:!0,tabSize:4}})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(x.jsx)(b.a,{variant:"contained",onClick:function(){e.onConfigSubmit(btoa(n)),e.onClose()},color:"secondary",children:"Submit"})]})]})}function dt(e){var t=Object(ee.a)();return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:[e.payload_name,"'s Current Stdout/Stderr"]}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(K.a,{children:"This is the current Stdout/Stderr for the profile. This goes away once you close this dialog."}),Object(x.jsx)(rt.a,{mode:"json",theme:"dark"===t.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:e.output,width:"100%",minLines:2,maxLines:50,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})]}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var ut=a(471),bt=a.n(ut),jt=a(26),pt=a(252),mt=a(364),ht=a(368),ft=a(196),Ot=a(363),xt=a(192),gt=a.n(xt),yt=a(91),vt=a(915),_t=a(312),kt=a(19);function wt(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,r=e.required,c=e.verifier_regex,l=e.id,d=e.description,p=e.value,m=(e.returnAllDictValues,s.a.useState("")),h=Object(u.a)(m,2),f=h[0],O=h[1],g=Object(ee.a)(),_=s.a.useState([]),k=Object(u.a)(_,2),w=k[0],S=k[1],D=s.a.useState([]),T=Object(u.a)(D,2),P=T[0],A=T[1],L=s.a.useState([]),F=Object(u.a)(L,2),N=F[0],q=F[1],R=s.a.useState(""),B=Object(u.a)(R,2),z=B[0],W=B[1],H=s.a.useState([]),U=Object(u.a)(H,2),G=U[0],K=U[1],V=s.a.useState(new Date),Q=Object(u.a)(V,2),J=Q[0],Y=Q[1],Z=function(e){var a=e.reduce((function(e,t){return""!==t.value?[].concat(Object(y.a)(e),[{custom:"*"===t.name,key:t.key,name:t.name,value:t.value}]):Object(y.a)(e)}),[]);t(i,a,!1)};Object(o.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");O(e[0]),K(e)}""!==p&&void 0!==p&&(O(p),t(i,p,""))}else if("Date"===a){if(""!==n){var r=new Date;r.setDate(r.getDate()+parseInt(n)),ie(r),O(-1)}""!==p&&void 0!==p&&p.includes("-")&&(Y(new Date(p)),O(-1),t(i,new Date(p).toISOString().slice(0,10),""))}else if("Dictionary"===a)if(""!==p&&void 0!==p&&"object"===typeof p){var c=p.reduce((function(e,t){return t.default_show?[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[]);Z(c),S(c),A(p);var o=p.reduce((function(e,t){var a=c.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[]);q(o),o.length>0&&W(o[0])}else{var s=JSON.parse(n);A(s);var l=s.reduce((function(e,t){return t.default_show?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);Z(l),S(l);var d=s.reduce((function(e,t){var a=l.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);q(d),d.length>0&&W(d[0])}else"Boolean"===a?(O(void 0===n||"true"===n.toLowerCase()),""!==p&&void 0!==p&&O(p)):(void 0!==n&&O(n),""!==p&&void 0!==p&&(O(p),t(i,p,"")))}),[n,a,i]);var X=function(e){O(e.target.value),t(i,e.target.value,!1)},te=function(e,a,n){O(a),t(e,a,n)},ae=function(e){return(r&&""!==c||""!==c&&""!==e)&&!RegExp(c).test(e)},ne=function(){var e=Object(v.a)({},z);"*"===e.name&&(e.key="",e.value="");var t=[].concat(Object(y.a)(w),[Object(v.a)(Object(v.a)({},e),{},{default_show:!0})]);S(t);var a=N.reduce((function(a,n){var i=t.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return e.name===n.name&&(i+=1),-1===n.max||n.max>i?[].concat(Object(y.a)(a),[Object(v.a)({},n)]):Object(y.a)(a)}),[]);Z(t),q(a),a.length>0&&W(a[0])},ie=function(e){Y(e),t(i,e.toISOString().slice(0,10),"")},re=function(e){var a=!f;O(a),t(i,a,!1)};return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(kt.a,{title:i.length>0?i:"No Description",children:d})}),Object(x.jsx)(C.a,{children:function(){switch(a){case"Date":return Object(x.jsx)(yt.a,{utils:_t.a,children:Object(x.jsx)(ft.a,{container:!0,justify:"flex-start",children:Object(x.jsx)(vt.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:J,onChange:ie,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(x.jsx)(mt.a,{children:Object(x.jsx)(ht.a,{native:!0,value:f,onChange:X,children:G.map((function(e,t){return Object(x.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(x.jsxs)(s.a.Fragment,{children:[w.map((function(e,t){return Object(x.jsxs)("div",{children:[Object(x.jsxs)(E.a,{onClick:function(e){!function(e){var t=w[e],a=w.filter((function(t,a){return e!==a}));S(a);var n=P.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(y.a)(e),[Object(v.a)({},n)]):Object(y.a)(e)}),[]);Z(a),q(n),n.length>0&&W(n[0])}(t)},children:[Object(x.jsx)(M.a,{style:{color:g.palette.error.main}})," "]}),"*"===e.name?Object(x.jsx)(Ot.a,{style:{width:"20%"},startAdornment:Object(x.jsx)(b.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=w.map((function(a,n){return n===t?Object(v.a)(Object(v.a)({},a),{},{key:e.target.value}):Object(v.a)({},a)}));Z(a),S(a)}(e,t)}}):Object(x.jsx)(Ot.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(x.jsx)(b.a,{disabled:!0,children:"key"}),value:e.key}),Object(x.jsx)(Ot.a,{style:{width:"75%"},startAdornment:Object(x.jsx)(b.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=w.map((function(a,n){return n===t?Object(v.a)(Object(v.a)({},a),{},{value:e.target.value}):Object(v.a)({},a)}));Z(a),S(a)}(e,t)}})]},"dictval"+t)})),N.length>0?Object(x.jsxs)("div",{children:[Object(x.jsxs)(E.a,{onClick:ne,children:[" ",Object(x.jsx)(gt.a,{style:{color:g.palette.success.main}})," "]}),Object(x.jsx)(ht.a,{size:"small",value:z,onChange:function(e){return W(e.target.value)},children:N.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+t)}))})]}):null]});case"String":return Object(x.jsx)(j.a,{required:r,value:f,multiline:!0,onChange:te,display:"inline-block",name:i,validate:ae,errorText:"Must match: "+c});case"Boolean":return Object(x.jsx)($.a,{checked:Boolean(f),onChange:re,inputProps:{"aria-label":"primary checkbox"}});default:return null}}()})]},"buildparam"+l)}function Ct(e){var t=function(t,a,n){e.onChange(e.name,t,a,n)};return Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"auto"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"20%"},children:"Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{children:e.c2profileparameters.map((function(a){return Object(x.jsx)(wt,Object(v.a)({returnAllDictValues:e.returnAllDictValues,onChange:t},a),"c2paramtablerow"+a.id)}))})]})})}var St,Dt,It,Tt,$t=a(365),Pt=a(291),At=Object(be.a)(St||(St=Object(_.a)(["\nquery getProfileParameters($id: Int!, $operation_id: Int!) {\n  c2profile_by_pk(id: $id) {\n    c2profileparameters(where: {deleted: {_eq: false}}, order_by: {name: asc}){\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n      instance_name\n    }\n  }\n}\n"]))),Et=Object(be.a)(Dt||(Dt=Object(_.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    id\n    value\n  }\n}\n"]))),Lt=Object(be.a)(It||(It=Object(_.a)(["\nmutation deleteSavedInstance($name: String!, $operation_id: Int!){\n  delete_c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}){\n    affected_rows\n  }\n}\n"]))),Ft=Object(be.a)(Tt||(Tt=Object(_.a)(["\nmutation createNewC2Instance($instance_name: String!, $c2_instance: String!, $c2profile_id: Int!){\n  create_c2_instance(c2_instance: $c2_instance, instance_name: $instance_name, c2profile_id: $c2profile_id){\n    status\n    error\n  }\n}\n"])));function Nt(e){var t=Object(ee.a)(),a=Object(f.a)(h.b),n=Object(o.useState)(""),i=Object(u.a)(n,2),r=i[0],c=i[1],l=Object(o.useState)(""),d=Object(u.a)(l,2),p=d[0],m=d[1],g=Object(o.useState)([]),_=Object(u.a)(g,2),k=_[0],w=_[1],C=Object(o.useState)([]),S=Object(u.a)(C,2),D=S[0],I=S[1],T=Object(o.useState)([]),$=Object(u.a)(T,2),P=$[0],A=$[1],E=Object(je.a)(At,{variables:{id:e.id,operation_id:a.user.current_operation_id},onCompleted:function(e){var t=e.c2profile_by_pk.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Pt(e.format_string).gen();return Object(v.a)(Object(v.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(v.a)(Object(v.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name,default_show:t.default_show})])}),[]);return Object(v.a)(Object(v.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return""!==e.default_value&&n.setDate(n.getDate()+parseInt(e.default_value)),Object(v.a)(Object(v.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(v.a)(Object(v.a)({},e),{},{value:e.default_value})}return Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value})}));t.sort((function(e,t){return-t.description.localeCompare(e.description)})),I(Object(y.a)(t)),A(Object(y.a)(t)),w(e.c2profile_by_pk.c2profileparametersinstances)},onError:function(e){},fetchPolicy:"network-only"}).loading,F=Object(pt.a)(Et,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(v.a)(Object(v.a)({},e),e.c2profileparameter);if("Dictionary"===t.parameter_type||"Array"===t.parameter_type){t.value=JSON.parse(t.value);var a=JSON.parse(t.default_value),n=t.value.map((function(e){var t=a.find((function(t){return t.name===e.name}));return void 0!==t?Object(v.a)(Object(v.a)(Object(v.a)({},t),e),{},{default_show:""!==e.value}):Object(v.a)(Object(v.a)({},e),{},{default_show:!1})})),i=a.reduce((function(e,t){return e.findIndex((function(e){return e.name===t.name}))>-1?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{default_show:!1,key:"*"===t.name?"":t.name,value:t.default_value})])}),Object(y.a)(n));return Object(v.a)(Object(v.a)({},t),{},{value:i})}return t}));t.sort((function(e,t){return e.name<t.name?-1:1})),A(t)},onError:function(e){O.b.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),N=Object(u.a)(F,1)[0],q=Object(pe.a)(Lt,{onCompleted:function(e){m(""),c(""),A(Object(y.a)(D));var t=k.filter((function(e){return e.instance_name!==p}));w(t),O.b.success("Sucessfully deleted instance")},onError:function(e){O.b.error("Failed to delete instance: "+e)}}),R=Object(u.a)(q,1)[0],B=Object(pe.a)(Ft,{onCompleted:function(t){"success"===t.create_c2_instance.status?O.b.success("Successfully created instance"):O.b.error("Failed to create instance: "+t.create_c2_instance.error),e.onClose()},onError:function(e){O.b.error("Failed to create instance: "+e)}}),M=Object(u.a)(B,1)[0];if(E)return Object(x.jsx)(Ae.a,{});return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:["Save an Instance of ",e.name,"'s Parameters"]}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(L.a,{style:{paddingBottom:"10px"},children:"Saving an instance of the parameters allows you to select them from a dropdown when creating agents later, saving time and typos."}),k.length>0?Object(x.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px"},children:[Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsxs)(mt.a,{style:{width:"100%"},children:[Object(x.jsx)($t.a,{children:"Select an Existing Instance"}),Object(x.jsxs)(ht.a,{style:{width:"100%",marginBottom:"10px"},value:p,label:"Select an Existing Instance",onChange:function(e){m(e.target.value),c(e.target.value),""===e.target.value?A(Object(y.a)(D)):(A([]),N({variables:{name:e.target.value,operation_id:a.user.current_operation_id}}))},children:[Object(x.jsx)(at.a,{value:"",children:"New Instance"}),k.map((function(e,t){return Object(x.jsx)(at.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]})}),Object(x.jsx)(ft.a,{item:!0,xs:6,children:p.length>0?Object(x.jsx)(b.a,{style:{backgroundColor:t.palette.error.main,color:"white"},variant:"contained",onClick:function(){A([]),R({variables:{name:p,operation_id:a.user.current_operation_id}})},children:" Delete Instance"}):null})]}):null,Object(x.jsx)(j.a,{name:"Instance Name",onChange:function(e,t,a){c(t)},value:r,style:{paddingTop:"10px"}}),Object(x.jsx)(Ct,Object(v.a)(Object(v.a)({},e),{},{returnAllDictValues:!0,c2profileparameters:P,onChange:function(e,t,a,n){var i=P.map((function(e){return e.name===t?Object(v.a)(Object(v.a)({},e),{},{error:n,value:a}):e}));A(i)}}))]}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(x.jsx)(b.a,{variant:"contained",onClick:function(){if(0!==r.length){var t=P.reduce((function(e,t){return Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.name,t.value))}),{});M({variables:{operation_id:a.user.current_operation_id,instance_name:r,c2profile_id:e.id,c2_instance:JSON.stringify(t)}})}else O.b.warning("Must supply an instance name")},color:"secondary",children:p.length>0?"Update":"Create"})]})]})}var qt,Rt,Bt,Mt=a(41),zt=a(30),Wt=Object(Se.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"},successButton:{backgroundColor:e.palette.success.main,color:"white","&:hover":{backgroundColor:e.palette.success.dark}},errorButton:{backgroundColor:e.palette.error.main,color:"white","&:hover":{backgroundColor:e.palette.error.dark}}}})),Ht=Object(De.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Pe.a),Ut=Object(be.a)(qt||(qt=Object(_.a)(["\nmutation StartStopProfile($id: Int!, $action: String) {\n  startStopProfile(id: $id, action: $action) {\n    status\n    error\n    output\n  }\n}\n"]))),Gt=Object(be.a)(Rt||(Rt=Object(_.a)(["\nmutation setProfileConfiguration($id: Int!, $file_path: String!, $data: String!) {\n  uploadContainerFile(id: $id, file_path: $file_path, data: $data) {\n    status\n    error\n    filename\n  }\n}\n"])));function Kt(e){var t=new Date,a=Object(ee.a)(),n=Wt(a),i=(t.getTime()+6e4*t.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning",r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useRef(null),f=function(){m((function(e){return!e}))},g=function(e){h.current&&h.current.contains(e.target)||m(!1)},y=Object(pe.a)(Ut,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){q(e.startStopProfile.output),z(!0)}}),_=Object(u.a)(y,1)[0],k=function(){e.running?O.b.info("Submitting stop task..."):O.b.info("Submitting start task..."),_({variables:{id:e.id,action:e.running?"stop":"start"}})},w=s.a.useState(!1),C=Object(u.a)(w,2),S=C[0],D=C[1],I=s.a.useState(!1),$=Object(u.a)(I,2),P=$[0],A=$[1],E=s.a.useState(""),F=Object(u.a)(E,2),N=F[0],q=F[1],R=s.a.useState(!1),B=Object(u.a)(R,2),M=B[0],z=B[1],W=s.a.useState(!1),H=Object(u.a)(W,2),U=H[0],G=H[1],K=Object(pe.a)(Gt,{update:function(e,t){t.data},onError:function(e){console.error(e)},onCompleted:function(e){"success"===e.uploadContainerFile.status?O.b.success("Updated file"):O.b.error("Error updating: "+e.uploadContainerFile.error)}}),V=Object(u.a)(K,1)[0];return Object(x.jsxs)(Ie.a,{className:n.root,elevation:5,style:{maxWidth:"100%"},children:[Object(x.jsx)(Ht,{overlap:"circle",classes:{badge:n[i]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.is_p2p?Object(x.jsx)(Mt.a,{icon:zt.y,style:{width:"100px",height:"100px",marginTop:"25px"}}):Object(x.jsx)(Qe.a,{style:{width:"100px",height:"100px",marginTop:"25px"}})}),Object(x.jsxs)("div",{style:{maxWidth:"60%"},children:[Object(x.jsx)(L.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block"},children:e.name}),!e.is_p2p&&e.running&&Object(x.jsx)(L.a,{variant:"h6",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block",color:a.palette.success.main},children:"(Server Running)"}),!e.is_p2p&&!e.running&&Object(x.jsx)(L.a,{variant:"h6",component:"h1",style:{textAlign:"left",marginLeft:"10px",display:"inline-block",color:a.palette.error.main},children:"(Server Not Running)"}),Object(x.jsxs)($e.a,{style:{textAlign:"left"},children:[Object(x.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(x.jsx)("b",{children:"Author:"})," ",e.author]}),Object(x.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(x.jsx)("b",{children:"Supported Agents:"})," ",e.payloadtypec2profiles.map((function(e){return e.payloadtype.ptype+" "}))]}),Object(x.jsx)(L.a,{variant:"body2",component:"p",children:e.description}),Object(x.jsx)(L.a,{variant:"body2",component:"p"})]})]}),Object(x.jsxs)("div",{style:{display:"inline-flex",paddingRight:"10px",marginLeft:"auto",justifyContent:"space-evenly",alignItems:"stretch",flexDirection:"column",alignContent:"flex-end"},children:[Object(x.jsx)(b.a,{size:"small",variant:"contained",color:"primary",href:"/docs/c2-profiles/"+e.name.toLowerCase(),target:"_blank",children:"Docs"}),Object(x.jsx)(b.a,{size:"small",onClick:function(){l(!0)},color:"primary",variant:"contained",children:"Build Info"}),o&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:o,onClose:function(){l(!1)},innerDialog:Object(x.jsx)(Ue,Object(v.a)(Object(v.a)({},e),{},{onClose:function(){l(!1)},payload_name:e.name}))}),M&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:M,onClose:function(){z(!1)},innerDialog:Object(x.jsx)(dt,{output:N,onClose:function(){z(!1)},payload_name:e.name})}),e.container_running?e.running?Object(x.jsxs)(Je.a,{variant:"contained",ref:h,"aria-label":"split button",children:[Object(x.jsx)(b.a,{size:"small",className:e.running?n.successButton:n.errorButton,onClick:k,style:{width:"100%"},children:"Stop Profile"}),Object(x.jsx)(b.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",className:e.running?n.successButton:n.errorButton,onClick:f,children:Object(x.jsx)(Ze.a,{})})]}):e.is_p2p?null:Object(x.jsxs)(Je.a,{variant:"contained",ref:h,"aria-label":"split button",children:[Object(x.jsx)(b.a,{size:"small",onClick:k,className:e.running?n.successButton:n.errorButton,style:{width:"100%"},children:"Start Profile"}),Object(x.jsx)(b.a,{size:"small","aria-controls":p?"split-button-menu":void 0,"aria-expanded":p?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",className:e.running?n.successButton:n.errorButton,onClick:f,children:Object(x.jsx)(Ze.a,{})})]}):Object(x.jsx)(b.a,{disabled:!0,color:"secondary",children:"Container Offline"}),Object(x.jsxs)(b.a,{size:"small",variant:"contained",color:"primary",onClick:function(){G(!0)},children:[Object(x.jsx)(bt.a,{})," Saved Instances"]}),S&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:S,onClose:function(){D(!1)},innerDialog:Object(x.jsx)(ot,Object(v.a)(Object(v.a)({},e),{},{payload_name:e.name,onClose:function(){D(!1)},profile_id:e.id}))}),P&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:P,onClose:function(){A(!1)},innerDialog:Object(x.jsx)(lt,Object(v.a)(Object(v.a)({},e),{},{onConfigSubmit:function(t){V({variables:{id:e.id,file_path:"config.json",data:t}})},payload_name:e.name,onClose:function(){A(!1)},profile_id:e.id}))}),U&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"xl",open:U,onClose:function(){G(!1)},innerDialog:Object(x.jsx)(Nt,Object(v.a)(Object(v.a)({},e),{},{onClose:function(){G(!1)}}))}),Object(x.jsx)(tt.a,{open:p,anchorEl:h.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var n=t.TransitionProps,i=t.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},n),{},{style:{transformOrigin:"bottom"===i?"center top":"center bottom"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===a.palette.type?a.palette.primary.dark:a.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:g,children:Object(x.jsxs)(nt.a,{id:"split-button-menu",children:[Object(x.jsx)(at.a,{onClick:function(){A(!0)},children:"View/Edit Config"},"dropdownprofile"+e.id+"menu1"),e.running?Object(x.jsx)(at.a,{onClick:function(){D(!0)},children:"View Stdout/Stderr"},"dropdownprofile"+e.id+"menu2"):null]})})})}))}})]})]})}var Vt=Object(be.a)(Bt||(Bt=Object(_.a)(["\nsubscription getPayloadTypesSubscription {\n   c2profile(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   author\n   id\n   container_running\n   description\n   is_p2p\n   last_heartbeat\n   name\n   running\n   payloadtypec2profiles(order_by: {payloadtype: {ptype: asc}}) {\n     payloadtype {\n       ptype\n     }\n   }\n }\n}\n"])));function Qt(e){var t=Object(Me.a)(Vt,{fetchPolicy:"network-only"}).data,a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(ee.a)();return Object(o.useEffect)((function(){r(void 0!==t?t.c2profile:[])}),[t]),Object(x.jsxs)("div",{style:{flexDirection:"column",alignItems:"stretch",paddingLeft:"10px"},children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"C2 Profiles"})}),i.map((function(e){return Object(x.jsx)(Kt,Object(v.a)({},e),"c2prof"+e.id)}))]})}var Jt,Yt=Object(Se.a)((function(e){return{root:{width:"100%",display:"flex",marginBottom:"10px"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},running:{backgroundColor:"#44b700",color:"#44b700"},notrunning:{backgroundColor:"red",color:"red"}}})),Zt=Object(De.a)((function(e){return{badge:{boxShadow:"0 0 0 2px white","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Pe.a);function Xt(e){var t=Yt(),a=new Date,n=(a.getTime()+6e4*a.getTimezoneOffset()-new Date(e.last_heartbeat).getTime())/1e3<30?"running":"notrunning";return Object(x.jsxs)(Ie.a,{className:t.root,elevation:5,children:[Object(x.jsx)(Zt,{overlap:"circle",classes:{badge:t[n]},invisible:!1,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:Object(x.jsx)(Mt.a,{icon:zt.x,size:"6x",style:{width:"125px",height:"125px"}})}),Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h4",component:"h1",style:{textAlign:"left",marginLeft:"10px"},children:e.name}),e.payloadtypes.length>0?Object(x.jsxs)(L.a,{variant:"body1",component:"p",children:[Object(x.jsx)("b",{children:"Translated Payload Types:"})," ",e.payloadtypes.map((function(e){return e.ptype})).join(", ")]}):null]})]})}var ea=Object(be.a)(Jt||(Jt=Object(_.a)(["\nsubscription getTranslationContainersSubscription {\n translationcontainer(where: {deleted: {_eq: false}}, order_by: {name: asc}) {\n   name\n   id\n   container_running\n   last_heartbeat\n   payloadtypes(order_by: {ptype: asc}) {\n       ptype\n       id\n   }\n }\n}\n"])));function ta(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(Me.a)(ea).data,j=Object(ee.a)();return Object(o.useEffect)((function(){if(void 0!==b){var e=b.translationcontainer.filter((function(e){return 0===e.payloadtypes.length})),t=b.translationcontainer.filter((function(e){return e.payloadtypes.length>0}));i(e),d(t)}else i([])}),[b]),Object(x.jsxs)("div",{style:{width:"100%",display:"inline-flex",flexDirection:"column",alignItems:"stretch"},children:[n.length>0?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:j.pageHeader.main,color:j.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers Not Assigned to Payload Types"})}),n.map((function(e){return Object(x.jsx)(Xt,Object(v.a)({},e),"translation_container"+e.id)}))]}):null,l.length>0?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:j.pageHeader.main,color:j.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Translation Containers"})}),l.map((function(e){return Object(x.jsx)(Xt,Object(v.a)({},e),"translation_container"+e.id)}))]}):null]})}function aa(e){return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(ft.a,{container:!0,spacing:0,children:[Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsx)(We,{})}),Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsx)(Qt,{})}),Object(x.jsx)(ft.a,{item:!0,xs:12,children:Object(x.jsx)(ta,{})})]})})}var na,ia=a(922),ra=a(907),ca=a(919),oa=a(843),sa=a(833),la=a(38);function da(e){return Object(x.jsxs)("div",{children:[Object(x.jsx)(b.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(x.jsx)(b.a,{variant:"contained",color:"primary",onClick:e.finished,children:e.last?"Create Payload":"Next"}),e.last&&Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(b.a,{variant:"contained",color:"secondary",onClick:e.startOver,style:{marginLeft:"10px"},children:"Start Over"}),Object(x.jsx)(b.a,{variant:"contained",color:"secondary",component:la.b,style:{marginLeft:"10px"},to:"/new/createwrapper",children:"Create Wrapper"})]})]})}var ua,ba=Object(be.a)(na||(na=Object(_.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    id\n    supported_os\n  }\n}\n "])));function ja(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];if(Object(je.a)(ba,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(y.a)(t),[a])}),[]);return[].concat(Object(y.a)(e),Object(y.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),l(a)},onError:function(e){console.error(e)}}).loading)return Object(x.jsx)("div",{children:Object(x.jsx)(oa.a,{})});return Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(x.jsx)("br",{}),Object(x.jsxs)(mt.a,{children:[Object(x.jsx)(ht.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(x.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(x.jsx)(sa.a,{children:"Target Operating System"})]}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{}),Object(x.jsx)(da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){e.finished(n)}})]})}function pa(e){return Object(x.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(x.jsx)(L.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Build Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{children:e.buildParameters.map((function(t){return Object(x.jsx)(wt,Object(v.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var ma=Object(be.a)(ua||(ua=Object(_.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function ha(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],g=Object(je.a)(ma,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){console.log(e.prevData),i(e.prevData.payload_type),l(e.prevData.file_extension),p(e.prevData.supports_dynamic_loading);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(v.a)(Object(v.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(a)}else{i(t.payloadtype[0].ptype),l(t.payloadtype[0].file_extension),p(t.payloadtype[0].supports_dynamic_loading);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):"Boolean"===e.parameter_type?Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:"true"===e.default_value.toLowerCase()}):Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(e),Object(y.a)(n))}return Object(y.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(n),console.log(n)}}}),_=g.loading,k=g.error,w=g.data;return _?Object(x.jsx)("div",{children:Object(x.jsx)(oa.a,{})}):k?(console.error(k),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(x.jsx)(ht.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=w.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){l(a.file_extension),p(a.supports_dynamic_loading);var n=a.buildparameters.map((function(e){return console.log(e),"ChooseOne"===e.parameter_type?Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):"Boolean"===e.parameter_type?Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:"true"===e.default_value.toLowerCase()}):Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),O(t)},children:w.payloadtype.map((function(e){return Object(x.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(x.jsx)("br",{}),Object(x.jsx)(pa,{onChange:function(e,t,a){var n=f.map((function(n){return n.name===e?Object(v.a)(Object(v.a)({},n),{},{value:t,error:a}):Object(v.a)({},n)}));O(n)},buildParameters:f}),Object(x.jsx)(da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=f.map((function(e){return{name:e.name,value:e.value}}));e.finished({payload_type:n,parameters:t,file_extension:o,supports_dynamic_loading:j,os:e.buildOptions})}})]})}var fa,Oa=a(71),xa=a(537),ga=a(367),ya=a(846),va=a(542),_a=a(856),ka=a(844),wa=a(845),Ca=Object(Se.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}})),Sa=Object(be.a)(fa||(fa=Object(_.a)(["\nquery getCommands($payloadType: String!) {\n  command(where: {payloadtype: {ptype: {_eq: $payloadType}}, deleted: {_eq: false}}, order_by: {cmd: asc}) {\n    cmd\n    attributes\n    id\n    supported_ui_features\n    help_cmd\n    description\n    needs_admin\n  }\n}\n "])));function Da(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(je.a)(Sa,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type},onCompleted:function(){if(e.buildOptions.supports_dynamic_loading){var t=m.command.reduce((function(t,a){try{var n=JSON.parse(a.attributes);if(0===n.supported_os.length||n.supported_os.includes(e.buildOptions.os)){if(void 0!==n.builtin&&n.builtin)return[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},a),{},{disabled:!0,selected:!0,reason:"This command is builtin and must be included"})]);try{if(void 0!==n.load_only&&n.load_only)return[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},a),{},{disabled:!0,selected:!1,reason:"This command can only be loaded in once a callback is established"})]);var i=!0,r={};if(void 0!==n.filter_by_build_parameter)for(var c=0,o=Object.entries(n.filter_by_build_parameter);c<o.length;c++)for(var s=Object(u.a)(o[c],2),l=s[0],d=s[1],b=0;b<e.buildOptions.parameters.length;b++)e.buildOptions.parameters[b].name===l&&e.buildOptions.parameters[b].value!==d&&(i=!1,r.name=l,r.value=d);return i?void 0!==n.suggested_command&&n.suggested_command?[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},a),{},{disabled:!1,selected:!0,reason:"This command is suggested to be included"})]):[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},a),{},{disabled:!1,selected:!1,reason:""})]):[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},a),{},{disabled:!0,selected:!1,reason:'Not available when build option "'+r.name+'" is not "'+r.value+'"'})])}catch(j){console.error(j)}}return[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},a),{},{disabled:!0,selected:!1,reason:"This command isn't supported by the selected OS"})])}catch(j){return[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},a),{},{disabled:!1,selected:!1,reason:"Failed to parse command attributes"})])}}),[]);if(l(t),void 0!==e.prevData){var a=t.map((function(t){return e.prevData.includes(t.cmd)?Object(v.a)(Object(v.a)({},t),{},{selected:!0}):Object(v.a)(Object(v.a)({},t),{},{selected:!1})}));l(a)}}else{var n=m.command.map((function(e){return Object(v.a)(Object(v.a)({},e),{},{selected:!0,disabled:!0,reason:"Agent doesn't support dynamic loading"})}));l(n)}}}).data;return Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Build Commands Into Agent"})," ",Object(x.jsx)("br",{}),Object(x.jsx)(Ia,{commands:o,payload_type:e.buildOptions.payload_type,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){for(var a=!1,n=0;n<t.length;n++)if(t[n].supported_ui_features.includes("callback_table:exit")){a=!0;break}if(a){var r=t.map((function(e){return e.cmd}));e.finished(r)}else p(!0),i(t)}}),Object(x.jsx)(Oa.a,{open:j,title:"No exit command selected, continue?",onClose:function(){return p(!1)},acceptText:"Accept",onSubmit:function(){var t=n.map((function(e){return e.cmd}));e.finished(t)}})]})}function Ia(e){var t=Ca(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=D(i,d),g=D(i,h),_=s.a.useState({}),k=Object(u.a)(_,2),w=k[0],C=k[1];function S(e,t){return e.filter((function(e){return void 0===t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}function D(e,t){return e.filter((function(e){return void 0!==t.find((function(t){return t.cmd===e.cmd&&!t.disabled}))}))}var I=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(y.a)(i);-1===a?n.push(t):n.splice(a,1),r(n)}};Object(o.useEffect)((function(){var t=e.commands.reduce((function(e,t){return t.selected?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(v.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.selected?[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[]);j(t),f(a)}),[e.commands]);var $=function(t){var a=e.commands.filter((function(e){return e.cmd===t.target.innerText}));a.length>0&&C(a[0])},P=function(e,a){return Object(x.jsxs)(T.a,{className:t.paper,style:{width:"100%",height:"calc(40vh)",overflow:"auto"},elevation:5,children:[Object(x.jsx)(ka.a,{className:t.cardHeader,title:e}),Object(x.jsx)(wa.a,{classes:{root:t.divider}}),Object(x.jsxs)(xa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[a.map((function(e){var t=e.cmd,a="transfer-list-item-".concat(t,"-label");return Object(x.jsx)("div",{onMouseEnter:$,children:Object(x.jsxs)(ga.a,{style:{padding:0},disabled:e.disabled,role:"listitem",button:!0,onClick:I(e),children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(_a.a,{disabled:e.disabled,checked:-1!==i.findIndex((function(e){return e.cmd===t})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":a}})}),Object(x.jsx)(va.a,{id:a,primary:t})]},t)},"commandtransfer"+t)})),Object(x.jsx)(ga.a,{})]})]})};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(x.jsx)(ft.a,{item:!0,xs:5,children:P("Available Commands",d)}),Object(x.jsx)(ft.a,{item:!0,children:Object(x.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&!t.selected?[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[]),a=e.commands.reduce((function(e,t){return!t.disabled||t.selected?[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[]);j(t),f(a)},disabled:0===d.length,"aria-label":"move all right",children:"\u226b"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(O)),j(S(d,O)),r(S(i,O))},disabled:0===O.length,"aria-label":"move selected right",children:">"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(g)),f(S(h,g)),r(S(i,g))},disabled:0===g.length,"aria-label":"move selected left",children:"<"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){var t=e.commands.reduce((function(e,t){return t.disabled&&t.selected?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(v.a)({},t)])}),[]),a=e.commands.reduce((function(e,t){return t.disabled&&t.selected?[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[]);j(t),f(a)},disabled:0===h.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(x.jsx)(ft.a,{item:!0,xs:5,children:P("Commands Included",h)})]}),Object(x.jsx)(ft.a,{container:!0,justify:"center",alignItems:"flex-start",className:t.root,children:Object(x.jsx)(ft.a,{item:!0,xs:12,style:{height:"100%",marginBottom:"10px"},children:void 0!==w.cmd&&Object(x.jsxs)(T.a,{className:t.paper,style:{width:"100%"},elevation:5,children:[Object(x.jsx)(ka.a,{className:t.cardHeader,title:Object(x.jsxs)(s.a.Fragment,{children:[w.cmd,Object(x.jsx)(b.a,{variant:"contained",color:"primary",href:"/docs/agents/"+e.payload_type+"/commands/"+w.cmd,style:{marginLeft:"10px",float:"right"},target:"_blank",children:"Documentation"})]})}),Object(x.jsx)(wa.a,{classes:{root:t.divider}}),""!==w.reason?Object(x.jsxs)(L.a,{variant:"body1",align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(x.jsxs)("b",{children:[w.disabled?"Disabled Reason: ":"Information: "," "]}),w.reason]}):null,Object(x.jsx)("br",{}),Object(x.jsxs)(L.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(x.jsx)("b",{children:"Commandline Help: "}),w.help_cmd]}),Object(x.jsxs)(L.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(x.jsx)("b",{children:"Needs Admin Permissions: "}),w.needs_admin?"True":"False"]}),Object(x.jsxs)(L.a,{align:"left",component:"div",style:{marginLeft:"10px"},children:[Object(x.jsx)("b",{children:"Description: "}),w.description]})]})})}),Object(x.jsx)(da,{first:e.first,last:e.last,canceled:e.canceled,finished:function(){e.finished(h)}})]})}var Ta,$a,Pa=a(905),Aa=Object(be.a)(Ta||(Ta=Object(_.a)(["\nquery getPayloadTypesC2ProfilesQuery($payloadType: String!, $operation_id: Int!) {\n  c2profile(where: {payloadtypec2profiles: {payloadtype: {ptype: {_eq: $payloadType}}}, deleted: {_eq: false}}) {\n    name\n    is_p2p\n    description\n    id\n    c2profileparameters(where: {deleted: {_eq: false}}) {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n    }\n    c2profileparametersinstances(where: {instance_name: {_is_null: false}, operation_id: {_eq: $operation_id}}, distinct_on: instance_name, order_by: {instance_name: asc}){\n        instance_name\n    }\n  }\n}\n "]))),Ea=Object(be.a)($a||($a=Object(_.a)(["\nquery getProfileInstanceQuery($name: String!, $operation_id: Int!) {\n  c2profileparametersinstance(where: {instance_name: {_eq: $name}, operation_id: {_eq: $operation_id}}) {\n    c2profileparameter {\n      default_value\n      description\n      format_string\n      id\n      name\n      parameter_type\n      randomize\n      required\n      verifier_regex\n      c2profile {\n          name\n      }\n    }\n    id\n    value\n  }\n}\n"])));function La(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1],b=Object(je.a)(Aa,{variables:{payloadType:e.buildOptions.payload_type,operation_id:t.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.map((function(t){if(void 0!==e.prevData)for(var a=0;a<e.prevData.length;a++)if(e.prevData[a].name===t.name){var n=e.prevData[a].c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=JSON.parse(e.default_value),a=e.value.map((function(e){var a=t.find((function(t){return t.name===e.name}));return void 0!==a?Object(v.a)(Object(v.a)(Object(v.a)({},a),e),{},{default_show:""!==e.value}):Object(v.a)(Object(v.a)({},e),{},{default_show:!1})})),n=t.reduce((function(e,t){return e.findIndex((function(e){return e.name===t.name}))>-1?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{default_show:!1,key:"*"===t.name?"":t.name,value:t.default_value})])}),Object(y.a)(a));return Object(v.a)(Object(v.a)({},e),{},{value:n})}return e}));return n.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(v.a)(Object(v.a)({},t),{},{selected:e.prevData[a].selected,c2profileparameters:n})}var i=t.c2profileparameters.map((function(e){if(""!==e.format_string){var t=new Pt(e.format_string).gen();return Object(v.a)(Object(v.a)({},e),{},{default_value:t,value:t})}if(""!==e.default_value){if("ChooseOne"===e.parameter_type)return Object(v.a)(Object(v.a)({},e),{},{value:e.default_value.split("\n")[0]});if("Dictionary"===e.parameter_type){var a=JSON.parse(e.default_value).reduce((function(e,t){return[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name,default_show:t.default_show})])}),[]);return Object(v.a)(Object(v.a)({},e),{},{value:a})}if("Date"===e.parameter_type){var n=new Date;return""!==e.default_value&&n.setDate(n.getDate()+parseInt(e.default_value)),Object(v.a)(Object(v.a)({},e),{},{value:n.toISOString().slice(0,10)})}return Object(v.a)(Object(v.a)({},e),{},{value:e.default_value})}return Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value})}));return i.sort((function(e,t){return-t.description.localeCompare(e.description)})),Object(v.a)(Object(v.a)({},t),{},{selected:!1,c2profileparameters:i})}));a.sort((function(e,t){return-t.name.localeCompare(e.name)})),r(a)},fetchPolicy:"no-cache"}),j=b.loading,p=b.error,m=function(e,t,a,n){var c=i.map((function(i){if(i.name===e){var r=i.c2profileparameters.map((function(e){return e.name===t?Object(v.a)(Object(v.a)({},e),{},{error:n,value:a}):e}));return Object(v.a)(Object(v.a)({},i),{},{c2profileparameters:r})}return i}));r(c)},g=Object(pt.a)(Ea,{onCompleted:function(e){var t=e.c2profileparametersinstance.map((function(e){var t=Object(v.a)(Object(v.a)({},e),e.c2profileparameter);if("Dictionary"===t.parameter_type||"Array"===t.parameter_type){t.value=JSON.parse(t.value);var a=JSON.parse(t.default_value),n=t.value.map((function(e){var t=a.find((function(t){return t.name===e.name}));return void 0!==t?Object(v.a)(Object(v.a)(Object(v.a)({},t),e),{},{default_show:""!==e.value}):Object(v.a)(Object(v.a)({},e),{},{default_show:!1})})),i=a.reduce((function(e,t){return e.findIndex((function(e){return e.name===t.name}))>-1?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{default_show:!1,key:"*"===t.name?"":t.name,value:t.default_value})])}),Object(y.a)(n));return Object(v.a)(Object(v.a)({},t),{},{value:i})}return t}));t.sort((function(e,t){return e.name<t.name?-1:1}));var a=i.map((function(e){return t[0].c2profile.name===e.name?Object(v.a)(Object(v.a)({},e),{},{c2profileparameters:t}):e}));r(a)},onError:function(e){O.b.error("Failed to fetch instance data: "+e),console.log(e)},fetchPolicy:"no-cache"}),_=Object(u.a)(g,1)[0];return j?Object(x.jsx)("div",{children:Object(x.jsx)(oa.a,{})}):p?(console.error(p),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Select C2 Profiles"}),i.map((function(e){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(Pa.a,{value:"top",control:Object(x.jsx)($.a,{checked:e.selected,onChange:function(t){return function(e,t){var a=i.map((function(e){return t.name===e.name?Object(v.a)(Object(v.a)({},e),{},{selected:!e.selected}):e}));r(a)}(0,e)},inputProps:{"aria-label":"primary checkbox"},name:"active"}),label:e.name,labelPlacement:"top",style:{display:"inline"}}),e.c2profileparametersinstances.length>0&&e.selected?Object(x.jsxs)(mt.a,{style:{width:"100%"},children:[Object(x.jsx)($t.a,{children:"Select an Existing Instance"}),Object(x.jsxs)(ht.a,{style:{width:"100%",marginBottom:"10px"},value:l,label:"Select an Existing Instance",onChange:function(a){return function(e,a){if(d(e.target.value),""!==e.target.value){var n=i.map((function(e){return a.name===e.name&&(e.c2profileparameters=[]),e}));r(n),_({variables:{name:e.target.value,operation_id:t.user.current_operation_id}})}}(a,e)},children:[Object(x.jsx)(at.a,{value:"",children:"New Instance"}),e.c2profileparametersinstances.map((function(e,t){return Object(x.jsx)(at.a,{value:e.instance_name,children:e.instance_name},"buildparamopt"+t)}))]})]}):null,Object(x.jsx)(L.a,{variant:"body1",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:e.description},"step4desc"+e.id),e.selected?Object(x.jsx)(Ct,Object(v.a)(Object(v.a)({returnAllDictValues:!1},e),{},{onChange:m}),"step4table"+e.id):null]},"step4c2switch"+e.id)})),Object(x.jsx)("br",{}),Object(x.jsx)(da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=!0,a=!1,n=i.reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.map((function(e){if("Dictionary"===e.parameter_type){var t=e.value.filter((function(e){return""!==e.value}));return Object(v.a)(Object(v.a)({},e),{},{value:t})}return Object(v.a)({},e)}));return[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{c2profileparameters:a})])}return[].concat(Object(y.a)(e),[Object(v.a)({},t)])}),[]);if(i.forEach((function(e){e.selected&&(a=!0,e.c2profileparameters.forEach((function(a){a.error&&(O.b.warning(e.name+"'s parameter "+a.name+" is invalid"),t=!1)})))})),t){if(!a)return void O.b.warning("Must select at least one C2 to include");e.finished(n)}}}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{})]})}var Fa,Na,qa=a(79),Ra=a(8),Ba=a(906),Ma=a(141),za=a.n(Ma),Wa=a(87),Ha=a.n(Wa),Ua=a(89),Ga=a.n(Ua),Ka=Object(be.a)(Fa||(Fa=Object(_.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),Va=Object(Se.a)((function(e){return{root:Object(jt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),Qa=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=Va(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(x.jsx)(qa.a,{ref:t,className:n.root,children:Object(x.jsxs)(Ie.a,{style:{backgroundColor:a.palette.success.main},children:[Object(x.jsxs)(Ba.a,{classes:{root:n.actionRoot},children:[Object(x.jsx)(L.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(x.jsxs)("div",{className:n.icons,children:[Object(x.jsx)(E.a,{"aria-label":"Show more",className:Object(Ra.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(x.jsx)(Ha.a,{})}),Object(x.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(x.jsx)(za.a,{})})]})]}),Object(x.jsxs)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:[Object(x.jsxs)(T.a,{className:n.collapse,children:[Object(x.jsx)(L.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(x.jsxs)(b.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(x.jsx)(Ga.a,{className:n.checkIcon}),"Download now"]})]}),Object(x.jsx)(T.a,{className:n.collapse,children:Object(x.jsx)(b.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),Ja=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=Va(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!1),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(x.jsx)(qa.a,{ref:t,className:n.root,children:Object(x.jsxs)(Ie.a,{style:{backgroundColor:a.palette.error.main},children:[Object(x.jsxs)(Ba.a,{classes:{root:n.actionRoot},children:[Object(x.jsx)(L.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(x.jsxs)("div",{className:n.icons,children:[Object(x.jsx)(E.a,{"aria-label":"Show more",className:Object(Ra.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(x.jsx)(Ha.a,{})}),Object(x.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(x.jsx)(za.a,{})})]})]}),Object(x.jsx)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(x.jsx)(T.a,{className:n.collapse,children:e.display})})]})})}));function Ya(e){var t=s.a.useState((new Date).toISOString()),a=Object(u.a)(t,2),n=a[0],i=(a[1],Object(Me.a)(Ka,{variables:{fromNow:n}})),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){console.log(l),!r&&!c&&l&&l.payload.length>0?"success"===l.payload[0].build_phase?(O.b.dismiss(),O.b.success(l.payload[0].build_message,{persist:!0,content:function(e){return Object(x.jsx)(Qa,{id:e,file_id:l.payload[0].filemetum.agent_file_id})}})):"building"===l.payload[0].build_phase||(""!==l.payload[0].build_stderr?O.b.error(l.payload[0].build_stderr,{persist:!0,content:function(e){return Object(x.jsx)(Ja,{id:e,display:l.payload[0].build_stderr})}}):O.b.error(l.payload[0].build_message,{persist:!0,content:function(e){return Object(x.jsx)(Ja,{id:e,display:l.payload[0].build_message})}})):c&&(console.log(c),O.b.error("Mythic encountered an error: "+c.toString()))}),[r,l,c]),null}var Za,Xa=Object(be.a)(Na||(Na=Object(_.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function en(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(pe.a)(Xa,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?O.b.info("Submitted payload to build pipeline"):O.b.error(a.createPayload.error)}}),p=Object(u.a)(b,1)[0];Object(o.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);var m=function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a=e.buildOptions[3].reduce((function(e,t){if(t.selected){var a=t.c2profileparameters.reduce((function(e,t){if("Dictionary"===t.parameter_type){var a=t.value.map((function(e){return{name:e.name,key:e.key,value:e.value,custom:e.custom}}));return Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.name,a))}return Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.name,t.value))}),{});return[].concat(Object(y.a)(e),[{c2_profile:t.name,c2_profile_parameters:a}])}return e}),[]),i={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:l,commands:e.buildOptions[2],build_parameters:t,c2_profiles:a};p({variables:{payload:JSON.stringify(i)}}).catch((function(e){console.log(e)}))};return Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(x.jsx)("br",{}),Object(x.jsx)(j.a,{onEnter:m,autoFocus:!0,required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(x.jsx)(j.a,{onEnter:m,required:!1,placeholder:"description",value:l,multiline:!1,onChange:function(e,t,a){d(t)},display:"inline-block"}),Object(x.jsx)(da,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:m,startOver:e.startOver}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{}),Object(x.jsx)(Ya,{})]})}function tn(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=function(e){i(Object(v.a)(Object(v.a)({},n),{},Object(jt.a)({},o,e))),p()},b=function(){m()};s.a.useEffect((function(){h()}),[e.location.key]);var j=["Select Target OS","Payload Type","Select Commands","Select C2 Profiles","Build"],p=function(){l((function(e){return e+1}))},m=function(){l((function(e){return e-1}))},h=function(){l(0)};return Object(x.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(x.jsx)(ia.a,{activeStep:o,alternativeLabel:!0,children:j.map((function(e,t){return Object(x.jsx)(ra.a,{children:Object(x.jsx)(ca.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(x.jsx)(ja,{buildOptions:n,prevData:n[0],finished:d,canceled:b,first:!0,last:!1});case 1:return Object(x.jsx)(ha,{buildOptions:n[0],prevData:n[1],finished:d,canceled:b,first:!1,last:!1});case 2:return Object(x.jsx)(Da,{buildOptions:n[1],prevData:n[2],finished:d,canceled:b,first:!1,last:!1});case 3:return Object(x.jsx)(La,{buildOptions:n[1],prevData:n[3],finished:d,canceled:b,first:!1,last:!1});case 4:return Object(x.jsx)(en,{buildOptions:n,canceled:b,first:!1,last:!0,startOver:h});default:return"Unknown step"}}(o)]})}function an(e){return Object(x.jsxs)("div",{children:[Object(x.jsx)(b.a,{disabled:e.first,color:"primary",onClick:e.canceled,children:"Back"}),Object(x.jsx)(b.a,{variant:"contained",color:"primary",onClick:e.finished,disabled:e.disableNext,children:e.last?"Create Wrapped Payload":"Next"}),e.last&&Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(b.a,{variant:"contained",color:"secondary",style:{marginLeft:"10px"},onClick:e.startOver,children:"Start Over"}),Object(x.jsx)(b.a,{variant:"contained",color:"secondary",component:la.b,style:{marginLeft:"10px"},to:"/new/createpayload",children:"Create Another Payload"})]})]})}var nn,rn=Object(be.a)(Za||(Za=Object(_.a)(["\nquery getPayloadTypesQuery {\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    id\n    supported_os\n  }\n}\n "])));function cn(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];if(Object(je.a)(rn,{fetchPolicy:"network-only",onCompleted:function(t){var a=t.payloadtype.reduce((function(e,t){var a=t.supported_os.split(",").reduce((function(t,a){return e.includes(a)?t:[].concat(Object(y.a)(t),[a])}),[]);return[].concat(Object(y.a)(e),Object(y.a)(a))}),[]).sort();console.log(e.prevData),void 0!==e.prevData?i(e.prevData):""===n&&i(a[0]),l(a),0===a.length&&O.b.warning("No Wrappers exist within Mythic. Try importing one first via the mythic-cli binary")},onError:function(e){console.error(e)}}).loading)return Object(x.jsx)("div",{children:Object(x.jsx)(oa.a,{})});return Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Operating System"})," ",Object(x.jsx)("br",{}),Object(x.jsxs)(mt.a,{children:[Object(x.jsx)(ht.a,{native:!0,value:n,onChange:function(e){return i(e.target.value)},children:o.map((function(e){return Object(x.jsx)("option",{value:e,children:e},"step1"+e)}))}),Object(x.jsx)(sa.a,{children:"Target Operating System"})]}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{}),Object(x.jsx)(an,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){0!==o.length?e.finished(n):O.b.warning("No Wrappers exist within Mythic. Try importing one first via the mythic-cli binary")}})]})}function on(e){var t=e.onChange,a=e.parameter_type,n=e.default_value,i=e.name,r=e.required,c=e.verifier_regex,l=e.id,d=e.description,p=e.value,m=e.returnAllDictValues,h=s.a.useState(""),f=Object(u.a)(h,2),O=f[0],g=f[1],_=Object(ee.a)(),k=s.a.useState([]),w=Object(u.a)(k,2),S=w[0],D=w[1],T=s.a.useState([]),$=Object(u.a)(T,2),P=$[0],A=$[1],L=s.a.useState([]),F=Object(u.a)(L,2),N=F[0],q=F[1],R=s.a.useState(""),B=Object(u.a)(R,2),z=B[0],W=B[1],H=s.a.useState([]),U=Object(u.a)(H,2),G=U[0],K=U[1],V=s.a.useState(new Date),Q=Object(u.a)(V,2),J=Q[0],Y=Q[1],Z=function(e){var a=e.map((function(e){return m?{custom:"*"===e.name,key:e.key,name:e.name,value:e.value}:Object(jt.a)({},e.key,e.value)}));t(i,a,!1)};Object(o.useEffect)((function(){if("ChooseOne"===a){if(n){var e=n.split("\n");g(e[0]),K(e)}""!==p&&void 0!==p&&(g(p),t(i,p,""))}else if("Date"===a){if(""!==n){var r=new Date;r.setDate(r.getDate()+parseInt(n)),ie(r),g(-1)}""!==p&&void 0!==p&&p.includes("-")&&(console.log("passed date value: ",p),Y(new Date(p)),g(-1),t(i,new Date(p).toISOString().slice(0,10),""))}else if("Dictionary"===a){var c=JSON.parse(n);A(c);var o=c.reduce((function(e,t){return t.default_show?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);Z(o),D(o);var s=c.reduce((function(e,t){var a=o.reduce((function(e,a){return a.name===t.name?e+1:e}),0);return-1===t.max||t.max>a?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{value:t.default_value,key:"*"===t.name?"":t.name})]):Object(y.a)(e)}),[]);q(s),s.length>0&&W(s[0]),""!==p&&void 0!==p&&"object"===typeof p&&(D(p),Z(p))}else void 0!==n&&g(n),""!==p&&void 0!==p&&(g(p),t(i,p,""))}),[n,a,i]);var X=function(e){g(e.target.value),t(i,e.target.value,!1)},te=function(e,a,n){g(a),t(e,a,n)},ae=function(e){return(r&&""!==c||""!==c&&""!==e)&&!RegExp(c).test(e)},ne=function(){var e=z;D([].concat(Object(y.a)(S),[e]));var t=N.reduce((function(t,a){var n=S.reduce((function(e,t){return t.name===a.name?e+1:e}),0);return e.name===a.name&&(n+=1),-1===a.max||a.max>n?[].concat(Object(y.a)(t),[Object(v.a)({},a)]):Object(y.a)(t)}),[]);Z(t),q(t),t.length>0&&W(t[0])},ie=function(e){Y(e),t(i,e.toISOString().slice(0,10),"")};return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(kt.a,{title:i.length>0?i:"No Description",children:d})}),Object(x.jsx)(C.a,{children:function(){switch(a){case"Date":return Object(x.jsx)(yt.a,{utils:_t.a,children:Object(x.jsx)(ft.a,{container:!0,justify:"flex-start",children:Object(x.jsx)(vt.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",value:J,onChange:ie,KeyboardButtonProps:{"aria-label":"change date"}})})});case"ChooseOne":return Object(x.jsx)(mt.a,{children:Object(x.jsx)(ht.a,{native:!0,value:O,onChange:X,children:G.map((function(e,t){return Object(x.jsx)("option",{value:e,children:e},"buildparamopt"+t)}))})});case"Dictionary":return Object(x.jsxs)(s.a.Fragment,{children:[S.map((function(e,t){return Object(x.jsxs)("div",{children:[Object(x.jsxs)(E.a,{onClick:function(e){!function(e){var t=S[e],a=S.filter((function(t,a){return e!==a}));D(a);var n=P.reduce((function(e,n){var i=a.reduce((function(e,t){return t.name===n.name?e+1:e}),0);return t.name===n.name&&(i-=1),-1===n.max||n.max>i?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},n),{},{value:n.default_value,key:"*"===n.name?"":n.name})]):Object(y.a)(e)}),[]);Z(n),q(n),n.length>0&&W(n[0])}(t)},children:[Object(x.jsx)(M.a,{style:{color:_.palette.error.main}})," "]}),"*"===e.name?Object(x.jsx)(Ot.a,{style:{width:"20%"},startAdornment:Object(x.jsx)(b.a,{disabled:!0,children:"Key"}),size:"small",value:e.key,onChange:function(e){return function(e,t){var a=S.map((function(a,n){return n===t?Object(v.a)(Object(v.a)({},a),{},{key:e.target.value}):Object(v.a)({},a)}));Z(a),D(a)}(e,t)}}):Object(x.jsx)(Ot.a,{variant:"outlined",size:"small",style:{width:"20%"},startAdornment:Object(x.jsx)(b.a,{disabled:!0,children:"key"}),value:e.key}),Object(x.jsx)(Ot.a,{style:{width:"75%"},startAdornment:Object(x.jsx)(b.a,{disabled:!0,children:"value"}),size:"small",value:e.value,onChange:function(e){return function(e,t){var a=S.map((function(a,n){return n===t?Object(v.a)(Object(v.a)({},a),{},{value:e.target.value}):Object(v.a)({},a)}));Z(a),D(a)}(e,t)}})]},"dictval"+t)})),N.length>0?Object(x.jsxs)("div",{children:[Object(x.jsxs)(E.a,{onClick:ne,children:[" ",Object(x.jsx)(gt.a,{style:{color:_.palette.success.main}})," "]}),Object(x.jsx)(ht.a,{size:"small",value:z,onChange:function(e){return W(e.target.value)},children:N.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:"*"===e.name?"Custom Key":e.name},"selectopt"+i+"i")}))})]}):null]});case"String":return Object(x.jsx)(j.a,{required:r,value:O,multiline:!0,onChange:te,display:"inline-block",name:i,validate:ae,errorText:"Must match: "+c});default:return null}}()})]},"buildparam"+l)}function sn(e){return Object(x.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(x.jsx)(L.a,{variant:"h4",align:"left",id:"SettingsTable",component:"div",style:{display:"inline-block",float:"left",marginLeft:"10px"},children:"Build Parameters"}),Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Build Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{children:e.buildParameters.map((function(t){return Object(x.jsx)(on,Object(v.a)({onChange:e.onChange},t),"buildparamtablerow"+t.id)}))})]})]})}var ln,dn=Object(be.a)(nn||(nn=Object(_.a)(["\nquery getPayloadTypesBuildParametersQuery($os: String!) {\n  payloadtype(where: {supported_os: {_ilike: $os}, deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    file_extension\n    supports_dynamic_loading\n    buildparameters(where: {deleted: {_eq: false} }) {\n      id\n      name\n      description\n      default_value: parameter\n      parameter_type\n      required\n      verifier_regex\n    }\n  }\n}\n "])));function un(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],g=h[1],_=Object(je.a)(dn,{variables:{os:"%"+e.buildOptions+"%"},onCompleted:function(t){if(t.payloadtype.length>0)if(void 0!==e.prevData&&e.prevData.os===e.buildOptions){i(e.prevData.payload_type),l(e.prevData.payload_type_id),p(e.prevData.file_extension);var a=t.payloadtype.reduce((function(t,a){if(a.ptype===e.prevData.payload_type){var n=a.buildparameters.map((function(t){for(var a=0;a<e.prevData.parameters.length;a++)if(e.prevData.parameters[a].name===t.name)return Object(v.a)(Object(v.a)({},t),{},{error:t.required,value:e.prevData.parameters[a].value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);a.sort((function(e,t){return-t.description.localeCompare(e.description)})),g(a),0===a.length&&O.b.warning("No available payload types exist for the selected OS")}else{i(t.payloadtype[0].ptype),l(t.payloadtype[0].id),p(t.payloadtype[0].file_extension);var n=t.payloadtype.reduce((function(e,a){if(a.ptype===t.payloadtype[0].ptype){var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(e),Object(y.a)(n))}return Object(y.a)(e)}),[]);n.sort((function(e,t){return-t.description.localeCompare(e.description)})),g(n)}}}),k=_.loading,w=_.error,C=_.data;return k?Object(x.jsx)("div",{children:Object(x.jsx)(oa.a,{})}):w?(console.error(w),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectospage",component:"div",style:{marginLeft:"10px"},children:"Select Target Payload Type"}),Object(x.jsx)(ht.a,{native:!0,value:n,onChange:function(e){i(e.target.value);var t=C.payloadtype.reduce((function(t,a){if(a.ptype===e.target.value){p(a.file_extension),l(a.id);var n=a.buildparameters.map((function(e){return"ChooseOne"===e.parameter_type?Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value.split("\n")[0]}):Object(v.a)(Object(v.a)({},e),{},{error:e.required,value:e.default_value})}));return[].concat(Object(y.a)(t),Object(y.a)(n))}return Object(y.a)(t)}),[]);t.sort((function(e,t){return-t.description.localeCompare(e.description)})),g(t)},children:C.payloadtype.map((function(e){return Object(x.jsx)("option",{value:e.ptype,children:e.ptype},"step2"+e.ptype)}))}),Object(x.jsx)("br",{}),Object(x.jsx)(sn,{onChange:function(e,t,a){var n=f.map((function(n){return n.name===e?Object(v.a)(Object(v.a)({},n),{},{value:t,error:a}):Object(v.a)({},n)}));g(n)},buildParameters:f}),Object(x.jsx)(an,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(){var t=f.map((function(e){return{name:e.name,value:e.value}}));""!==n?e.finished({payload_type:n,parameters:t,payload_type_id:o,file_extension:j,os:e.buildOptions}):O.b.warning("No payload type selected")}})]})}var bn=Object(be.a)(ln||(ln=Object(_.a)(["\nquery GetPayloadDetails($payload_id: Int!, $operation_id: Int!) {\n  payload(where: {id: {_eq: $payload_id}, operation_id: {_eq: $operation_id}}) {\n    uuid\n    wrapped_payload_id\n    payloadtype{\n        ptype\n    }\n    payloadcommands {\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    filemetum {\n      filename_text\n      agent_file_id\n      id\n      md5\n      sha1\n    }\n    buildparameterinstances {\n      parameter\n      id\n      buildparameter {\n        description\n      }\n    }\n    os\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n  }\n}\n"])));function jn(e){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Payload Configuration"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(pn,Object(v.a)({},e))}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}function pn(e){var t=Object(f.a)(h.b),a=Object(ee.a)(),n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState([]),l=Object(u.a)(o,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),O=m[0],g=m[1],_=Object(je.a)(bn,{variables:{payload_id:e.payload_id,operation_id:t.user.current_operation_id},onCompleted:function(e){var t=e.payload[0].payloadcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));c(t);var a=e.payload[0].buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));j(a);var n=e.payload[0].c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.c2profile.name,[].concat(Object(y.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),i=Object.keys(n).reduce((function(e,t){return[].concat(Object(y.a)(e),[{c2_profile:t,parameters:n[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);g(i)}}),S=_.loading,$=_.error,P=_.data;return S?Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}}):$?(console.error($),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Payload Information"})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Payload Info"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsxs)(w.a,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Payload Type"}),Object(x.jsx)(C.a,{children:P.payload[0].payloadtype.ptype})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Selected OS"}),Object(x.jsx)(C.a,{children:P.payload[0].os})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"UUID"}),Object(x.jsx)(C.a,{children:P.payload[0].uuid})]}),P.payload[0].filemetum?Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Filename"}),Object(x.jsx)(C.a,{children:P.payload[0].filemetum.filename_text})]},"filename_text"):null,Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Download URL"}),Object(x.jsx)(C.a,{children:window.location.origin+"/direct/download/"+P.payload[0].filemetum.agent_file_id})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"SHA1"}),Object(x.jsx)(C.a,{children:P.payload[0].filemetum.sha1})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"MD5"}),Object(x.jsx)(C.a,{children:P.payload[0].filemetum.md5})]})]})]}),Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Build Parameters"})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{children:d.map((function(t,a){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:t.description}),Object(x.jsx)(C.a,{children:t.value})]},"buildprop"+a+"for"+e.payload_id)}))})]}),O.map((function(t){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:t.c2_profile})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{style:{whiteSpace:"pre"},children:t.parameters.map((function(a,n){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:a.description}),Object(x.jsxs)(C.a,{children:["Dictionary"===a.parameter_type?JSON.stringify(JSON.parse(a.value),null,2):a.value,null===a.enc_key?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)("br",{}),Object(x.jsx)("b",{children:"Encryption Key: "})," ",a.enc_key]}),null===a.dec_key?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)("br",{}),Object(x.jsx)("b",{children:"Decryption Key: "})," ",a.dec_key]})]})]},"c2frag"+e.payload_id+t.c2_profile+n)}))})]})]},"c2frag"+e.payload_id+t.c2_profile)})),r.length>0&&Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Loaded Commands"})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Command Name"}),Object(x.jsx)(C.a,{children:"Mythic Version"}),Object(x.jsx)(C.a,{children:"Loaded Version"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Documentation"})]})}),Object(x.jsx)(w.a,{children:r.map((function(t){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:t.cmd}),Object(x.jsx)(C.a,{children:t.mythic}),Object(x.jsx)(C.a,{children:t.payload}),Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+P.payload[0].payloadtype.ptype+"/commands/"+t.cmd,children:"Docs"})})]},t.cmd+e.payload_id)}))})]})]}),null!==P.payload[0].wrapped_payload_id&&Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h5",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:"Wrapped Payload Information"})}),Object(x.jsx)(pn,{payload_id:P.payload[0].wrapped_payload_id})]})]})}var mn,hn,fn=a(168),On=a.n(fn),xn=Object(Se.a)((function(e){return{root:{margin:"auto",width:"100%"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}})),gn=Object(be.a)(mn||(mn=Object(_.a)(['\nquery getWrappablePayloads($payloadType: Int!) {\n  payloadtype_by_pk(id: $payloadType) {\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n        payloads(where: {auto_generated: {_eq: false}, build_phase: {_eq: "success"}, deleted: {_eq: false}}) {\n          id\n          tag\n          uuid\n          creation_time\n          filemetum {\n            agent_file_id\n            filename_text\n            id\n          }\n        }\n      }\n    }\n  }\n}\n '])));function yn(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(gn,{fetchPolicy:"network-only",variables:{payloadType:e.buildOptions.payload_type_id},onCompleted:function(){if(r.payloadtype_by_pk.wrap_these_payload_types.length>0){for(var e=[],t=0;t<r.payloadtype_by_pk.wrap_these_payload_types.length;t++)for(var a=0;a<r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads.length;a++)e.push(Object(v.a)({ptype:r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.ptype},r.payloadtype_by_pk.wrap_these_payload_types[t].wrapped.payloads[a]));i(e)}else O.b.warning("No supported payload for that wrapper")}}).data;return Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectcommands",component:"div",style:{marginLeft:"10px"},children:"Wrap Agent Into New Payload"})," ",Object(x.jsx)("br",{}),Object(x.jsx)(vn,{payloadOptions:n,first:e.first,last:e.last,canceled:function(){e.canceled()},finished:function(t){void 0!==t.uuid?e.finished(t.uuid):O.b.error("Can't continue without selecting a payload")}})]})}function vn(e){xn();var t=function(t){e.finished(t)};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(S.a,{component:T.a,children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"4rem"},children:" Select"}),Object(x.jsx)(C.a,{style:{width:"15rem"},children:"Timestamp"}),Object(x.jsx)(C.a,{children:"File"}),Object(x.jsx)(C.a,{children:"Description"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Details"})]})}),Object(x.jsx)(w.a,{children:e.payloadOptions.map((function(e){return Object(x.jsx)(_n,{onSelected:t,payload:e},"payload"+e.id)}))})]})}),Object(x.jsx)("div",{style:{paddingTop:"20px"},children:Object(x.jsx)(an,{disableNext:!0,first:e.first,last:e.last,canceled:e.canceled,finished:t})})]})}function _n(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(f.a)(h.b);return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{size:"small",onClick:function(){e.onSelected(e.payload)},color:"primary",variant:"contained",children:"Select"})}),Object(x.jsx)(C.a,{children:Object(Z.b)(e.payload.creation_time,r.user.view_utc_time)}),Object(x.jsx)(C.a,{children:e.payload.filemetum.filename_text}),Object(x.jsx)(C.a,{children:e.payload.tag}),Object(x.jsx)(C.a,{children:Object(x.jsx)(E.a,{size:"small",color:"primary",onClick:function(){return i(!0)},children:Object(x.jsx)(On.a,{})})})]},"payload"+e.payload.uuid),Object(x.jsx)(I.a,{children:n?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(x.jsx)(jn,Object(v.a)(Object(v.a)({},e),{},{payload_id:e.payload.id,onClose:function(){i(!1)}}))}):null})]})}var kn,wn=Object(be.a)(hn||(hn=Object(_.a)(["\nsubscription NewPayloadsSubscription($fromNow: timestamp!) {\n  payload(limit: 1, where: {deleted: {_eq: false}, creation_time: {_gte: $fromNow}}, order_by: {creation_time: desc}) {\n    build_message\n    build_phase\n    build_stderr\n    build_stdout\n    uuid\n    tag\n    id\n    filemetum{\n        agent_file_id\n    }\n  }\n}\n "]))),Cn=Object(Se.a)((function(e){return{root:Object(jt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),Sn=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=Cn(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(x.jsx)(qa.a,{ref:t,className:n.root,children:Object(x.jsxs)(Ie.a,{style:{backgroundColor:a.palette.success.main},children:[Object(x.jsxs)(Ba.a,{classes:{root:n.actionRoot},children:[Object(x.jsx)(L.a,{variant:"subtitle2",className:n.typography,children:"Payload successfuly built!"}),Object(x.jsxs)("div",{className:n.icons,children:[Object(x.jsx)(E.a,{"aria-label":"Show more",className:Object(Ra.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(x.jsx)(Ha.a,{})}),Object(x.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(x.jsx)(za.a,{})})]})]}),Object(x.jsxs)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:[Object(x.jsxs)(T.a,{className:n.collapse,children:[Object(x.jsx)(L.a,{gutterBottom:!0,children:"Agent ready for download"}),Object(x.jsxs)(b.a,{className:n.button,download:!0,href:window.location.origin+"/direct/download/"+e.file_id,children:[Object(x.jsx)(Ga.a,{className:n.checkIcon}),"Download now"]})]}),Object(x.jsx)(T.a,{className:n.collapse,children:Object(x.jsx)(b.a,{variant:"outlined",color:"primary",href:"/new/payloads",children:"View on Payloads Page"})})]})]})})})),Dn=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=Cn(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!1),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(x.jsx)(qa.a,{ref:t,className:n.root,children:Object(x.jsxs)(Ie.a,{style:{backgroundColor:a.palette.error.main},children:[Object(x.jsxs)(Ba.a,{classes:{root:n.actionRoot},children:[Object(x.jsx)(L.a,{variant:"subtitle2",className:n.typography,style:{color:"white"},children:"Payload Failed to build!"}),Object(x.jsxs)("div",{className:n.icons,children:[Object(x.jsx)(E.a,{"aria-label":"Show more",className:Object(Ra.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(x.jsx)(Ha.a,{})}),Object(x.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(x.jsx)(za.a,{})})]})]}),Object(x.jsx)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(x.jsx)(T.a,{className:n.collapse,children:e.display})})]})})}));function In(e){var t=s.a.useState((new Date).toISOString()),a=Object(u.a)(t,2),n=a[0],i=(a[1],Object(Me.a)(wn,{variables:{fromNow:n}})),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){!r&&!c&&l&&l.payload.length>0?"success"===l.payload[0].build_phase?(O.b.dismiss(),O.b.success(l.payload[0].build_message,{persist:!0,content:function(e){return Object(x.jsx)(Sn,{id:e,file_id:l.payload[0].filemetum.agent_file_id})}})):"building"===l.payload[0].build_phase?O.b.info("Building payload ".concat(l.payload[0].uuid,"..."),{autoHideDuration:5e3}):""!==l.payload[0].build_error?O.b.error(l.payload[0].build_stderr,{persist:!0,content:function(e){return Object(x.jsx)(Dn,{id:e,display:l.payload[0].build_stderr})}}):O.b.error(l.payload[0].build_message,{persist:!0,content:function(e){return Object(x.jsx)(Dn,{id:e,display:l.payload[0].build_message})}}):c&&(console.log(c),O.b.error("Mythic encountered an error: "+c.toString()))}),[r,l,c]),null}var Tn=Object(be.a)(kn||(kn=Object(_.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function $n(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(pe.a)(Tn,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?O.b.info("Submitted payload to build pipeline"):O.b.error(a.createPayload.error)}}),p=Object(u.a)(b,1)[0];Object(o.useEffect)((function(){""!==e.buildOptions[1].file_extension?i(e.buildOptions[1].payload_type+"."+e.buildOptions[1].file_extension):i(e.buildOptions[1].payload_type)}),[e.buildOptions]);var m=function(){var t=e.buildOptions[1].parameters.map((function(e){return e})),a={selected_os:e.buildOptions[0],payload_type:e.buildOptions[1].payload_type,filename:n,tag:l,commands:[],build_parameters:t,c2_profiles:[],wrapper:!0,wrapped_payload:e.buildOptions[2]};p({variables:{payload:JSON.stringify(a)}}).catch((function(e){console.log(e)}))};return Object(x.jsxs)("div",{children:[Object(x.jsx)(L.a,{variant:"h3",align:"left",id:"selectc2profiles",component:"div",style:{marginLeft:"10px"},children:"Payload Review"}),Object(x.jsx)("br",{}),Object(x.jsx)(j.a,{onEnter:m,autoFocus:!0,required:!1,placeholder:"Filename",value:n,multiline:!1,onChange:function(e,t,a){i(t)},display:"inline-block"}),Object(x.jsx)(j.a,{onEnter:m,required:!1,placeholder:"description",value:l,multiline:!1,onChange:function(e,t,a){d(t)},display:"inline-block"}),Object(x.jsx)(an,{first:e.first,last:e.last,canceled:function(){e.canceled()},finished:m,startOver:e.startOver}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{}),Object(x.jsx)(In,{})]})}function Pn(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=function(e){i(Object(v.a)(Object(v.a)({},n),{},Object(jt.a)({},o,e))),p()},b=function(){m()},j=["Select Target OS","Payload Type","Select Payload","Build"],p=function(){l((function(e){return e+1}))},m=function(){l((function(e){return e-1}))},h=function(){l(0)};return s.a.useEffect((function(){h()}),[e.location.key]),Object(x.jsxs)("div",{style:{height:"calc(95vh)"},children:[Object(x.jsx)(ia.a,{activeStep:o,alternativeLabel:!0,children:j.map((function(e,t){return Object(x.jsx)(ra.a,{children:Object(x.jsx)(ca.a,{children:e})},e)}))}),function(e){switch(e){case 0:return Object(x.jsx)(cn,{buildOptions:n,prevData:n[0],finished:d,canceled:b,first:!0,last:!1});case 1:return Object(x.jsx)(un,{buildOptions:n[0],prevData:n[1],finished:d,canceled:b,first:!1,last:!1});case 2:return Object(x.jsx)(yn,{buildOptions:n[1],prevData:n[2],finished:d,canceled:b,first:!1,last:!1});case 3:return Object(x.jsx)($n,{buildOptions:n,canceled:b,first:!1,last:!0,startOver:h});default:return"Unknown step"}}(o)]})}var An=a(909),En=a(923),Ln=a(472),Fn=a.n(Ln),Nn=a(466),qn=a(908);function Rn(e){var t=s.a.useState(null),a=Object(u.a)(t,2),n=a[0],i=a[1],r=function(){c(),e.onUpdateResolution({id:e.id,resolved:!e.resolved})},c=function(){i(null)},o=s.a.useCallback((function(e){i(e.currentTarget)}),[]);return Object(x.jsxs)(qn.a,{children:[Object(x.jsx)(E.a,{"aria-controls":"eventmenu"+e.id,"aria-haspopup":"true",onClick:o,children:Object(x.jsx)(Fn.a,{})}),Object(x.jsxs)(Nn.a,{elevation:5,id:"eventmenu"+e.id,anchorEl:n,open:Boolean(n),onClose:c,children:["warning"===e.level&&e.resolved?Object(x.jsx)(at.a,{onClick:r,children:"Unresolve"}):"warning"!==e.level||e.resolved?Object(x.jsx)(at.a,{onClick:function(){c(),e.onUpdateLevel({id:e.id})},children:"Make Warning"}):Object(x.jsx)(at.a,{onClick:r,children:"Resolve"}),Object(x.jsx)(at.a,{onClick:function(){c(),e.getSurroundingEvents({id:e.id})},children:"Get Surrounding Events"}),Object(x.jsxs)(at.a,{onClick:function(){c(),e.onUpdateDeleted({id:e.id})},children:[Object(x.jsx)(M.a,{}),"Delete"]})]})]})}var Bn=Object(Se.a)((function(e){return{root:{width:"100%",maxWidth:"36ch"},inline:{display:"inline"}}}));function Mn(e){var t=Bn(),a=Object(ee.a)(),n=Object(f.a)(h.b);return Object(x.jsxs)(ga.a,{alignItems:"flex-start",style:Object(v.a)({},e.style),children:[Object(x.jsx)(An.a,{children:Object(x.jsx)(En.a,{children:e.operator?e.operator.username[0]:"M"})}),Object(x.jsx)(va.a,{disableTypography:!0,primary:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(L.a,{component:"span",variant:"body1",className:t.inline,style:{fontWeight:"bold",margin:0,padding:0},children:[e.operator?e.operator.username:"Mythic",e.count>1?" ( "+e.count+" )":""]}),Object(x.jsx)(L.a,{component:"span",variant:"caption",className:t.inline,style:{margin:"0 0 0 10px"},children:Object(Z.b)(e.timestamp,n.user.view_utc_time)})]}),secondary:Object(x.jsx)("pre",{style:{overflowX:"auto",width:"max-content",maxWidth:"97%",margin:"0 0 0 0",borderRadius:"9px",padding:"5px",backgroundColor:"warning"===e.level&&e.resolved?a.palette.textBackgroundColorSuccess:"warning"!==e.level||e.resolved?e.operator?a.palette.textBackgroundColor:a.palette.textBackgroundColorMythic:a.palette.textBackgroundColorError},children:e.message}),style:{}}),Object(x.jsx)(Rn,{id:e.id,level:e.level,onUpdateDeleted:e.onUpdateDeleted,onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,getSurroundingEvents:e.getSurroundingEvents,resolved:e.resolved})]})}var zn=a(292),Wn=a.n(zn),Hn=a(827);function Un(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=function(t){t.preventDefault(),n&&n.length>0&&(e.onSubmitMessage(n),i(""))};return Object(x.jsx)("div",{style:{padding:"0",margin:"0",position:"absolute",bottom:0,width:"100%"},children:Object(x.jsx)("form",{onSubmit:r,children:Object(x.jsx)(Hn.a,{InputProps:{endAdornment:Object(x.jsx)(E.a,{color:"primary",variant:"contained",onClick:r,children:Object(x.jsx)(Wn.a,{})})},fullWidth:!0,size:"small",style:{padding:0,margin:0},variant:"outlined",value:n,onChange:function(e){e.preventDefault(),i(e.target.value)},label:"Type Message..."})})})}var Gn,Kn,Vn,Qn,Jn,Yn,Zn,Xn,ei,ti,ai=a(173),ni=a(169),ii=function(e){var t=e.data,a=e.index,n=e.style,i=t[t.length-a-1];return Object(x.jsx)("div",{style:n,children:Object(x.jsx)(Mn,Object(v.a)({},i))})},ri=function(e){var t=e.onUpdateDeleted,a=e.onUpdateLevel,n=e.onUpdateResolution,i=e.getSurroundingEvents,r=e.operationeventlog,c=s.a.createRef(),l=function(e){return 75+20*(r[r.length-e-1].message.match(/\n/g)||[]).length},d=r.map((function(e){return Object(v.a)({onUpdateDeleted:t,onUpdateLevel:a,onUpdateResolution:n,getSurroundingEvents:i},e)}));return Object(o.useEffect)((function(){c.current&&c.current.resetAfterIndex(0)}),[r]),Object(x.jsx)(ni.a,{children:function(e){var t=e.height,a=e.width;return Object(x.jsx)(ai.c,{ref:c,height:t-50,itemData:d,itemCount:r.length,width:a,itemSize:l,overscanCount:20,children:ii})}})};function ci(e){var t=Object(o.useRef)(null),a=Object(ee.a)(),n=s.a.useRef(null),i=s.a.useState(!1),r=Object(u.a)(i,2),c=r[0],l=r[1],d=function(){t.current.scrollIntoView({behavior:"smooth"})},j=[{name:"Load More Events",click:e.loadMore},{name:"Load All Errors",click:e.loadNextError},{name:"Resolve Viewable Errors",click:e.resolveViewableErrors},{name:"Resolve All Errors",click:e.resolveAllErrors}];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operational Event Messages"}),Object(x.jsx)(Je.a,{variant:"contained",ref:n,"aria-label":"split button",style:{marginRight:"10px",marginTop:"10px",float:"right"},color:"primary",children:Object(x.jsxs)(b.a,{size:"small",color:"primary","aria-controls":c?"split-button-menu":void 0,"aria-expanded":c?"true":void 0,"aria-haspopup":"menu",onClick:function(){return l(!c)},children:["Actions ",Object(x.jsx)(Ze.a,{})]})}),Object(x.jsx)(tt.a,{open:c,anchorEl:n.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:10},children:function(e){var t=e.TransitionProps,n=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===a.palette.type?a.palette.primary.dark:a.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:function(){return l(!1)},children:Object(x.jsx)(nt.a,{id:"split-button-menu",children:j.map((function(e,t){return Object(x.jsx)(at.a,{onClick:function(e){return function(e,t){j[t].click(),l(!1)}(0,t)},children:e.name},e.name)}))})})})}))}})]}),Object(x.jsxs)(T.a,{elevation:5,style:{position:"relative",height:"calc(90vh)",backgroundColor:a.body},variant:"elevation",children:[Object(x.jsx)(ri,{onUpdateResolution:e.onUpdateResolution,onUpdateLevel:e.onUpdateLevel,onUpdateDeleted:e.onUpdateDeleted,getSurroundingEvents:e.getSurroundingEvents,operationeventlog:e.operationeventlog}),Object(x.jsx)("div",{ref:t}),Object(x.jsx)(Un,{onSubmitMessage:function(t){t&&t.length>0&&(e.onSubmitMessage({level:"info",message:t}),d())}})]})]})}var oi=Object(be.a)(Gn||(Gn=Object(_.a)(["\nquery GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),si=Object(be.a)(Kn||(Kn=Object(_.a)(["\nsubscription GetOperationEventLogs($operation_id: Int!, $offset: Int!, $eventQuerySize: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}}, order_by: {id: desc}, limit: $eventQuerySize, offset: $offset) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),li=Object(be.a)(Vn||(Vn=Object(_.a)(["\nquery GetSurroundingOperationEventLogs($operation_id: Int!, $lower_id: Int!, $upper_id: Int!) {\n  operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, id: {_gt: $lower_id, _lt: $upper_id}}, order_by: {id: desc}) {\n    id\n    level\n    message\n    resolved\n    timestamp\n    count\n    operator {\n      id\n      username\n    }\n  }\n}\n "]))),di=Object(be.a)(Qn||(Qn=Object(_.a)(["\nmutation CreateOperationEventLog($message: String!, $level: String!) {\n  insert_operationeventlog_one(object:{level: $level, message: $message}) {\n    id\n  }\n}\n "]))),ui=Object(be.a)(Jn||(Jn=Object(_.a)(['\n query GetOperationEventLogError($operation_id: Int!) {\n   operationeventlog(where: {operation_id: {_eq: $operation_id}, deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}}, order_by: {id: desc}) {\n     id\n     level\n     message\n     resolved\n     timestamp\n     count\n     operator {\n       id\n       username\n     }\n   }\n }\n  ']))),bi=Object(be.a)(Yn||(Yn=Object(_.a)(["\nmutation UpdateDeletedOperationEventLog($id: Int!) {\n  update_operationeventlog(where:{id: {_eq: $id}}, _set: {deleted: true}) {\n    returning{\n        id\n        deleted\n    }\n  }\n}\n "]))),ji=Object(be.a)(Zn||(Zn=Object(_.a)(["\nmutation UpdateResolutionOperationEventLog($id: Int!, $resolved: Boolean!) {\n  update_operationeventlog_by_pk(pk_columns:{id: $id}, _set: {resolved: $resolved}) {\n    id\n    resolved\n  }\n}\n "]))),pi=Object(be.a)(Xn||(Xn=Object(_.a)(['\nmutation UpdateLevelOperationEventLog($id: Int!) {\n  update_operationeventlog_by_pk(pk_columns: {id: $id}, _set: {level: "warning"}) {\n    id\n    level\n  }\n}\n ']))),mi=Object(be.a)(ei||(ei=Object(_.a)(["\n mutation UpdateResolveViewableErrorsOperationEventLog($ids: [Int]!) {\n   update_operationeventlog(where:{id: {_in: $ids}}, _set: {resolved: true}) {\n     returning{\n         id\n         resolved\n     }\n   }\n }\n  "]))),hi=Object(be.a)(ti||(ti=Object(_.a)(["\n  mutation UpdateResolveAllErrorsOperationEventLog($operation_id: Int!) {\n    update_operationeventlog(where: {resolved: {_eq: false}, operation_id: {_eq: $operation_id}}, _set: {resolved: true}) {\n      returning{\n          id\n          resolved\n      }\n    }\n  }\n   "])));function fi(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(0),o=Object(u.a)(c,2),l=o[0],d=o[1];Object(Me.a)(si,{variables:{operation_id:t.user.current_operation_id,offset:0,eventQuerySize:100},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;0===l&&d(t.data.operationeventlog.length);var a=t.data.operationeventlog.reduce((function(e,t){if(e.find((function(e){return e.id===t.id}))){var a=e.findIndex((function(e){return e.id===t.id})),n=Object(y.a)(e);return n[a]=t,Object(y.a)(n)}return[].concat(Object(y.a)(e),[t])}),Object(y.a)(i));a.sort((function(e,t){return e.id>t.id?-1:t.id>e.id?1:0})),r(a)}});var b=Object(pt.a)(oi,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(O.b.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(y.a)(e):[].concat(Object(y.a)(e),[t])}),Object(y.a)(i));d(l+100),r(t),O.b.success("Successfully fetched more events")}else O.b.info("No more events")}}),j=Object(u.a)(b,1)[0],p=Object(pt.a)(li,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){O.b.dismiss();var t=!1,a=e.operationeventlog.reduce((function(e,a){return e.find((function(e){return e.id===a.id}))?Object(y.a)(e):(t=!0,[].concat(Object(y.a)(e),[a]))}),Object(y.a)(i));r(a),t?O.b.success("Successfully fetched surrounding events"):O.b.info("No additional surrounding events")}}),m=Object(u.a)(p,1)[0],g=Object(pt.a)(ui,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(O.b.dismiss(),0!==e.operationeventlog.length){var t=e.operationeventlog.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?Object(y.a)(e):[].concat(Object(y.a)(e),[t])}),Object(y.a)(i));r(t),O.b.success("Successfully fetched more errors")}else O.b.info("No more events")}}),_=Object(u.a)(g,1)[0],k=Object(pe.a)(di),w=Object(u.a)(k,1)[0],C=Object(pe.a)(bi,{update:function(e,t){var a=t.data.update_operationeventlog.returning[0],n=i.filter((function(e){return e.id!==a.id}));r(n),O.b.success("Successfully deleted event log")}}),S=Object(u.a)(C,1)[0],D=Object(pe.a)(ji,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(v.a)(Object(v.a)({},e),{},{resolved:a.resolved}):e}));r(n)}}),I=Object(u.a)(D,1)[0],T=Object(pe.a)(pi,{update:function(e,t){var a=t.data.update_operationeventlog_by_pk,n=i.map((function(e){return e.id===a.id?Object(v.a)(Object(v.a)({},e),{},{level:a.level}):e}));r(n)}}),$=Object(u.a)(T,1)[0],P=Object(pe.a)(mi,{update:function(e,t){var a=t.data;if(O.b.dismiss(),a.update_operationeventlog.returning.length>0){O.b.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),c=i.map((function(e){return n.includes(e.id)?Object(v.a)(Object(v.a)({},e),{},{resolved:!0}):Object(v.a)({},e)}));r(c)}else O.b.info("No Viewable Errors to Resolve")}}),A=Object(u.a)(P,1)[0],E=Object(pe.a)(hi,{update:function(e,t){var a=t.data;if(O.b.dismiss(),a.update_operationeventlog.returning.length>0){O.b.success("Resolved All Errors");var n=a.update_operationeventlog.returning.map((function(e){return e.id})),c=i.map((function(e){return n.includes(e.id)?Object(v.a)(Object(v.a)({},e),{},{resolved:!0}):Object(v.a)({},e)}));r(c)}else O.b.info("No Errors to Resolve")}}),L=Object(u.a)(E,1)[0];return Object(x.jsx)(ci,{onSubmitMessage:function(e){var t=e.level,a=e.message;w({variables:{level:t,message:a}})},operationeventlog:i,loadMore:function(){O.b.info("Loading more events..."),j({variables:{operation_id:t.user.current_operation_id,offset:l,eventQuerySize:100}})},loadNextError:function(){O.b.info("Loading more errors..."),_({variables:{operation_id:t.user.current_operation_id}})},onUpdateDeleted:function(e){var t=e.id;O.b.info("Deleting event log..."),S({variables:{id:t}})},onUpdateResolution:function(e){var t=e.id,a=e.resolved;I({variables:{id:t,resolved:a}})},onUpdateLevel:function(e){var t=e.id;$({variables:{id:t}})},getSurroundingEvents:function(e){var a=e.id;O.b.info("Loading surrounding events..."),m({variables:{lower_id:a-5,upper_id:a+5,operation_id:t.user.current_operation_id}})},resolveViewableErrors:function(){O.b.info("Resolving Errors...");var e=i.reduce((function(e,t){return"warning"!==t.level||t.resolved?Object(y.a)(e):[].concat(Object(y.a)(e),[t.id])}),[]);A({variables:{ids:e}})},resolveAllErrors:function(){O.b.info("Resolving Errors..."),L({variables:{operation_id:t.user.current_operation_id}})}})}var Oi,xi,gi,yi,vi,_i=a(83),ki=a.n(_i);function wi(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState("operator"),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState({}),j=Object(u.a)(b,2),p=j[0],m=j[1],h=Object(o.useRef)(null);Object(o.useEffect)((function(){i(e.operator.checked),d(e.operator.view_mode),console.log(e.operator),e.operator.disabledcommandsprofile?m(e.operator.disabledcommandsprofile.name):m("")}),[e.operator]);return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:n,onChange:function(t){i(t.target.checked),e.updateOperator(Object(v.a)(Object(v.a)({},e.operator),{},{checked:t.target.checked,view_mode:l}))},color:"secondary"})}),Object(x.jsx)(C.a,{children:e.operator.username}),Object(x.jsx)(C.a,{children:n?Object(x.jsxs)(mt.a,{style:{width:"100%"},children:[Object(x.jsx)($t.a,{ref:h,children:"Options"}),Object(x.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:l,onChange:function(t){d(t.target.value),e.updateOperator(Object(v.a)(Object(v.a)({},e.operator),{},{checked:n,view_mode:t.target.value}))},input:Object(x.jsx)(Ot.a,{style:{width:"100%"}}),children:["operator","spectator","lead"].map((function(e){return Object(x.jsx)(at.a,{value:e,children:e},e)}))})]}):null}),Object(x.jsx)(C.a,{children:n?Object(x.jsxs)(mt.a,{style:{width:"100%"},children:[Object(x.jsx)($t.a,{ref:h,children:"Block List Options"}),Object(x.jsxs)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:p,onChange:function(t){m(t.target.value);var a=e.commandBlockLists.findIndex((function(e){return e.name===t.target.value}));a>-1?e.updateOperator(Object(v.a)(Object(v.a)({},e.operator),{},{checked:n,disabledcommandsprofile:e.commandBlockLists[a]})):e.updateOperator(Object(v.a)(Object(v.a)({},e.operator),{},{checked:n,disabledcommandsprofile:null}))},input:Object(x.jsx)(Ot.a,{style:{width:"100%"}}),children:[Object(x.jsx)(at.a,{value:-1,children:"None"},"None"),e.commandBlockLists.map((function(t){return Object(x.jsx)(at.a,{value:t.name,children:t.name},e.operator.username+t.name)}))]})]}):null})]})})}var Ci=Object(be.a)(Oi||(Oi=Object(_.a)(["\nquery GetOperation($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      disabledcommandsprofile {\n        name\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n  disabledcommandsprofile(where: {operation_id: {_eq: $operation_id}}, distinct_on: name, order_by: {name: asc}) {\n    name\n    id\n  }\n}\n"]))),Si=Object(be.a)(xi||(xi=Object(_.a)(["\nmutation updateLeadMutation($operation_id: Int!, $admin_id: Int!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {admin_id: $admin_id}) {\n    admin {\n      id\n      username\n    }\n    id\n  }\n}\n"]))),Di=Object(be.a)(gi||(gi=Object(_.a)(["\nmutation updateOperatorViewMode($operatoroperation_id: Int!, $view_mode: String!, $disabledcommandsprofile: Int) {\n  update_operatoroperation_by_pk(pk_columns: {id: $operatoroperation_id}, _set: {view_mode: $view_mode, base_disabled_commands_id: $disabledcommandsprofile}) {\n    id\n    view_mode\n  }\n}"]))),Ii=Object(be.a)(yi||(yi=Object(_.a)(["\nmutation removeOperatorsFromOperation($operatoroperation_ids: [Int!]!) {\n  delete_operatoroperation(where: {id: {_in: $operatoroperation_ids}}) {\n    returning {\n      id\n    }\n  }\n}"]))),Ti=Object(be.a)(vi||(vi=Object(_.a)(["\nmutation addNewOperators($operators: [operatoroperation_insert_input!]!) {\n  insert_operatoroperation(objects: $operators) {\n    returning {\n      id\n    }\n  }\n}"])));function $i(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState({}),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState([]),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState([]),f=Object(u.a)(h,2),g=f[0],_=f[1];Object(je.a)(Ci,{variables:{operation_id:e.id},fetchPolicy:"network-only",onCompleted:function(e){var t=e.operator.map((function(e){return Object(v.a)(Object(v.a)({},e),{},{checked:!1})}));m(e.operation_by_pk.operatoroperations),l(e.operation_by_pk.admin);var a=t.map((function(t){var a=e.operation_by_pk.operatoroperations.find((function(e){return e.operator.id===t.id}));return a?a.operator.id===e.operation_by_pk.admin.id?Object(v.a)(Object(v.a)({},t),{},{checked:!0,view_mode:"lead",operatoroperation_id:a.id,disabledcommandsprofile:a.disabledcommandsprofile}):Object(v.a)(Object(v.a)({},t),{},{checked:!0,view_mode:a.view_mode,operatoroperation_id:a.id,disabledcommandsprofile:a.disabledcommandsprofile}):Object(v.a)(Object(v.a)({},t),{},{view_mode:"operator"})}));a.sort((function(e,t){return e.username>t.username?1:-1})),i(a);var n=Object(y.a)(e.disabledcommandsprofile);_(n)},onError:function(e){O.b.error("Failed to get operational data"),console.error(e)}});var $=Object(pe.a)(Si,{onCompleted:function(e){O.b.success("Successfully updated Lead")},onError:function(e){O.b.error("Failed to update operation"),console.log("error updating operation",e)}}),P=Object(u.a)($,1)[0],A=Object(pe.a)(Ti,{onCompleted:function(e){O.b.success("Sucessfully added operators")},onError:function(e){O.b.error("Failed to add operators"),console.error("error adding operators to operation",e)}}),E=Object(u.a)(A,1)[0],L=Object(pe.a)(Ii,{onCompleted:function(e){O.b.success("Sucessfully removed operators")},onError:function(e){O.b.error("Failed to remove operators"),console.error("error removing operators from operation",e)}}),F=Object(u.a)(L,1)[0],N=Object(pe.a)(Di,{onCompleted:function(e){O.b.success("Successfully updated operator view mode")},onError:function(e){O.b.error("Failed to update operator view mode"),console.error("failed to update view mode: ",e)}}),q=Object(u.a)(N,1)[0],R=function(e){var t=Object(y.a)(n);"lead"===e.view_mode&&(t=t.map((function(e){return"lead"===e.view_mode?Object(v.a)(Object(v.a)({},e),{},{view_mode:"operator"}):Object(v.a)({},e)}))),t=t.map((function(t){return t.id===e.id?Object(v.a)({},e):Object(v.a)({},t)})),i(t)};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Modify Operator Assignments"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"8rem"},children:"Assign to Operation"}),Object(x.jsx)(C.a,{style:{width:"8rem"},children:"Operator"}),Object(x.jsx)(C.a,{style:{width:"10rem"},children:"Role"}),Object(x.jsx)(C.a,{children:"Block List"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsx)(wi,{operator:e,updateOperator:R,commandBlockLists:g},"operator"+e.id)}))})]})})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(x.jsx)(b.a,{onClick:function(){var t=n.find((function(e){return"lead"===e.view_mode}));if(t){t.id!==o.id&&P({variables:{operation_id:e.id,admin_id:t.id}});var a=[],i=[];n.forEach((function(t){var n=p.find((function(e){return e.operator.id===t.id}));n?t.checked?t.view_mode===n.view_mode&&t.disabledcommandsprofile===n.disabledcommandsprofile||q({variables:{operatoroperation_id:n.id,view_mode:t.view_mode,disabledcommandsprofile:t.disabledcommandsprofile?t.disabledcommandsprofile.id:null}}):i.push(n.id):t.checked&&a.push({operation_id:e.id,operator_id:t.id,view_mode:t.view_mode})})),a.length>0&&E({variables:{operators:a}}),i.length>0&&F({variables:{operatoroperation_ids:i}}),e.onClose()}else O.b.error("No Lead for the operation is set")},variant:"contained",color:"secondary",children:"Update"})]})]})}var Pi,Ai,Ei=a(474),Li=a.n(Ei),Fi=a(293),Ni=a.n(Fi),qi=a(473),Ri=a.n(qi),Bi=Object(be.a)(Pi||(Pi=Object(_.a)(["\nquery GetOperations($operation_id: Int!) {\n  operation_by_pk(id: $operation_id) {\n    name\n    id\n    channel\n    display_name\n    icon_emoji\n    icon_url\n    webhook\n    webhook_message\n    complete\n  }\n}\n"])));function Mi(e){var t=s.a.useState(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),p=Object(u.a)(d,2),m=p[0],h=p[1],f=s.a.useState(""),g=Object(u.a)(f,2),y=g[0],v=g[1],_=s.a.useState(""),k=Object(u.a)(_,2),w=k[0],C=k[1],S=s.a.useState(""),D=Object(u.a)(S,2),I=D[0],T=D[1],P=s.a.useState(""),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useState(!1),N=Object(u.a)(F,2),q=N[0],R=N[1];Object(je.a)(Bi,{fetchPolicy:"no-cache",variables:{operation_id:e.id},onCompleted:function(e){var t=e.operation_by_pk.webhook_message;try{t=JSON.stringify(JSON.parse(t),null,4)}catch(a){}i(e.operation_by_pk.name),l(e.operation_by_pk.channel),h(e.operation_by_pk.display_name),v(e.operation_by_pk.icon_emoji),C(e.operation_by_pk.icon_url),T(e.operation_by_pk.webhook),L(t),R(e.operation_by_pk.complete)},onError:function(){O.b.error("Failed to fetch data")}});var B=function(e,t,a){switch(e){case"name":i(t);break;case"Webhook Channel":l(t);break;case"Webhook Display Name":h(t);break;case"Webhook Icon Emoji":v(t);break;case"Webhook Icon URL":C(t);break;case"Webhook URL":T(t);break;case"Webhook POST Message":L(t)}};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:["Modify ",n]}),Object(x.jsxs)(G.a,{dividers:!0,style:{maxHeight:"calc(70vh)"},children:[Object(x.jsx)(K.a,{children:"Use this dialog to update some information about an operation."}),Object(x.jsx)(j.a,{autoFocus:!0,value:n,onChange:B,margin:"dense",name:"name"}),"Complete Operation? ",Object(x.jsx)($.a,{checked:q,onChange:function(e){R(e.target.checked)},color:"secondary"}),Object(x.jsx)(j.a,{margin:"dense",value:o,onChange:B,name:"Webhook Channel"}),Object(x.jsx)(j.a,{margin:"dense",value:m,onChange:B,name:"Webhook Display Name"}),Object(x.jsx)(j.a,{margin:"dense",value:y,onChange:B,name:"Webhook Icon Emoji"}),Object(x.jsx)(j.a,{margin:"dense",value:w,onChange:B,name:"Webhook Icon URL"}),Object(x.jsx)(j.a,{margin:"dense",value:I,onChange:B,name:"Webhook URL"}),Object(x.jsx)(rt.a,{mode:"json",theme:"monokai",onChange:function(e,t){L(e)},fontSize:14,showGutter:!0,maxLines:20,highlightActiveLine:!0,value:E,width:"100%",setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})]}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Cancel"}),Object(x.jsx)(b.a,{onClick:function(){e.onUpdateOperation({operation_id:e.id,name:n,channel:o,display_name:m,icon_emoji:y,icon_url:w,webhook:I,webhook_message:E,complete:q}),e.onClose()},variant:"contained",color:"secondary",children:"Update"})]})]})}var zi,Wi,Hi,Ui=Object(be.a)(Ai||(Ai=Object(_.a)(["\nmutation updateCurrentOpertionMutation($operator_id: Int!, $operation_id: Int!) {\n  updateCurrentOperation(user_id: $operator_id, operation_id: $operation_id) {\n    status\n    error\n    operation_id\n  }\n}\n"])));function Gi(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=Object(f.a)(h.b),j=Object(pe.a)(Ui,{onCompleted:function(t){"success"===t.updateCurrentOperation.status?(Object(h.b)(Object(v.a)(Object(v.a)({},Object(h.b)()),{},{user:Object(v.a)(Object(v.a)({},Object(h.b)().user),{},{current_operation_id:t.updateCurrentOperation.operation_id,current_operation:e.name})})),localStorage.setItem("user",JSON.stringify(Object(h.b)().user)),O.b.success("Updated current operation")):O.b.error(t.updateCurrentOperation.error)},onError:function(e){O.b.error("Failed to update current operation"),console.error(e)}}),p=Object(u.a)(j,1)[0];return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsxs)(C.a,{children:[Object(x.jsx)(b.a,{size:"small",onClick:function(){i(!0)},startIcon:Object(x.jsx)(ki.a,{}),color:e.complete?"secondary":"primary",variant:"contained",children:"Edit"}),n&&Object(x.jsx)(Y.a,{open:n,fullWidth:!0,maxWidth:"lg",onClose:function(){i(!1)},innerDialog:Object(x.jsx)(Mi,{onClose:function(){i(!1)},id:e.id,onUpdateOperation:e.onUpdateOperation})})]}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(b.a,{size:"small",onClick:function(){l(!0)},startIcon:Object(x.jsx)(Ri.a,{}),color:e.complete?"secondary":"primary",variant:"contained",children:"Edit"}),o&&Object(x.jsx)(Y.a,{open:o,maxHeight:"calc(80vh)",fullWidth:!0,maxWidth:"md",onClose:function(){l(!1)},innerDialog:Object(x.jsx)($i,{id:e.id,onClose:function(){l(!1)}})})]}),Object(x.jsxs)(C.a,{children:[e.name," ",e.complete?" (Completed) ":""]}),Object(x.jsx)(C.a,{children:e.admin.username}),Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{size:"small",startIcon:Object(x.jsx)(Ni.a,{}),onClick:function(){O.b.warning("Not Implemented")},color:"primary",variant:"contained",children:"Analysis"})}),Object(x.jsx)(C.a,{children:e.id===d.user.current_operation_id?"Current Operation":Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(b.a,{size:"small",startIcon:Object(x.jsx)(Li.a,{}),onClick:function(){p({variables:{operator_id:d.user.user_id,operation_id:e.id}})},color:"primary",variant:"contained",children:"Make Current"})})})]},e.id)})}var Ki,Vi=Object(be.a)(zi||(zi=Object(_.a)(["\nmutation NewOperator($username: String!, $password: String!) {\n  createOperator(input: {password: $password, username: $username}) {\n    error\n    id\n    status\n  }\n}\n"]))),Qi=Object(be.a)(Wi||(Wi=Object(_.a)(["\nmutation MyMutation($operation_id: Int!, $channel: String!, $complete: Boolean!, $display_name: String!, $icon_emoji: String!, $icon_url: String!, $name: String!, $webhook: String!, $webhook_message: String!) {\n  update_operation_by_pk(pk_columns: {id: $operation_id}, _set: {channel: $channel, complete: $complete, display_name: $display_name, icon_emoji: $icon_emoji, icon_url: $icon_url, name: $name, webhook: $webhook, webhook_message: $webhook_message}) {\n    id\n    name\n    complete\n  }\n}\n"]))),Ji=Object(be.a)(Hi||(Hi=Object(_.a)(["\nmutation newOperationMutation{\n    createOperation{\n        status\n        error\n        operation{\n            name\n            id\n            admin {\n                id\n                username\n            }\n        }\n        \n    }\n}\n"])));function Yi(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(pe.a)(Vi,{update:function(e,t){var a=t.data;"success"===a.createOperator.status?O.b.success("Created operator"):O.b.error(a.createOperator.error)},onError:function(e){O.b.warning("Unable to create new operator"),console.log(e)}}),o=Object(u.a)(c,1)[0],l=Object(pe.a)(Qi,{onCompleted:function(t){e.onUpdateOperation(t.update_operation_by_pk),O.b.success("Successfully updated operation")},onError:function(e){O.b.error("Failed to update operation"),console.log("error updating operation",e)}}),d=Object(u.a)(l,1)[0],j=Object(pe.a)(Ji,{onCompleted:function(t){console.log(t),"success"===t.createOperation.status?(O.b.success("Successfully created operation!"),e.onNewOperation(t.createOperation.operation)):O.b.error(t.createOperation.error)},onError:function(e){console.log(e)}}),p=Object(u.a)(j,1)[0],m=function(e){var t=e.operation_id,a=e.name,n=e.channel,i=e.display_name,r=e.icon_emoji,c=e.icon_url,o=e.webhook,s=e.webhook_message,l=e.complete;d({variables:{operation_id:t,name:a,channel:n,display_name:i,icon_emoji:r,icon_url:c,webhook:o,webhook_message:s,complete:l}})};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operations"}),Object(x.jsx)(b.a,{size:"small",onClick:function(){p()},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(x.jsx)(W.a,{}),color:"primary",variant:"contained",children:"New Operation"}),Object(x.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(x.jsx)(W.a,{}),color:"primary",variant:"contained",children:"New Operator"}),i&&Object(x.jsx)(Y.a,{open:i,onClose:function(){r(!1)},innerDialog:Object(x.jsx)(Q,Object(v.a)({title:"New Operator",onAccept:function(e,t,a,n){a!==n?O.b.error("Passwords don't match"):0===n.length?O.b.error("Password must not be empty"):0===t.length?O.b.error("Username must not be empty"):(o({variables:{username:t,password:n}}),r(!1))},handleClose:function(){r(!1)}},e))})]}),Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"8rem"},children:"Configure"}),Object(x.jsx)(C.a,{style:{width:"8rem"},children:"Operators"}),Object(x.jsx)(C.a,{children:"Operation Name"}),Object(x.jsx)(C.a,{children:"Operation Admin"}),Object(x.jsx)(C.a,{style:{width:"10rem"},children:"Analysis"}),Object(x.jsx)(C.a,{style:{width:"12rem"},children:"Operation Status"})]})}),Object(x.jsx)(w.a,{children:e.operations.map((function(t){return Object(x.jsx)(Gi,Object(v.a)(Object(v.a)({onUpdateOperation:m},t),{},{operator:e.operator}),"operation"+t.id)}))})]})})]})}var Zi=Object(Se.a)((function(e){return{root:{margin:"auto"},paper:{overflow:"auto",backgroundColor:"rgb(76,80,86) !important"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}}));function Xi(e){var t=Zi(),a=Object(ee.a)(),n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState([]),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState([]),h=Object(u.a)(m,2),f=h[0],O=h[1],g=s.a.useState(""),v=Object(u.a)(g,2),_=v[0],k=v[1],w=s.a.useState(""),C=Object(u.a)(w,2),S=C[0],D=C[1],I=A(r,j),$=A(r,f);function P(t,a){return e.itemKey?t.filter((function(t){return void 0===a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1===a.indexOf(e)}))}function A(t,a){return e.itemKey?t.filter((function(t){return void 0!==a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1!==a.indexOf(e)}))}var E=function(t){return function(){var a=-1;a=e.itemKey?r.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):r.indexOf(t);var n=Object(y.a)(r);-1===a?n.push(t):n.splice(a,1),c(n)}};Object(o.useEffect)((function(){var t=e.left.reduce((function(t,a){return void 0===e.itemKey?e.right.includes(a)?Object(y.a)(t):[].concat(Object(y.a)(t),[a]):e.right.find((function(t){return t[e.itemKey]===a[e.itemKey]}))?Object(y.a)(t):[].concat(Object(y.a)(t),[a])}),[]);p(t),O(e.right),k(e.leftTitle),D(e.rightTitle)}),[e.left,e.right,e.leftTitle,e.rightTitle,e.itemKey]),Object(o.useEffect)((function(){e.onChange({selected:f,ptype:e.ptype})}),[f]);var F=function(a,n){return Object(x.jsx)(T.a,{style:{width:"100%"},children:Object(x.jsxs)(Ie.a,{children:[Object(x.jsx)(ka.a,{className:t.paper,title:a}),Object(x.jsx)(wa.a,{classes:{root:t.divider}}),Object(x.jsx)($e.a,{style:{height:"calc(30vh)",overflow:"auto"},className:t.paper,children:Object(x.jsx)(xa.a,{dense:!0,component:"div",role:"list",style:{padding:0},className:t.paper,children:n.map((function(t){var a=void 0===e.itemKey?t:t[e.itemKey],n="transfer-list-item-".concat(a,"-label");return Object(x.jsxs)(ga.a,{style:{padding:0},role:"listitem",button:!0,onClick:E(t),children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(_a.a,{checked:void 0===e.itemKey?-1!==r.indexOf(a):-1!==r.findIndex((function(t){return t[e.itemKey]===a})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(x.jsx)(va.a,{id:n,primary:a})]},a)}))})})]})})};return Object(x.jsxs)(ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(x.jsx)(ft.a,{item:!0,xs:12,children:Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:e.ptype})})}),Object(x.jsx)(ft.a,{item:!0,xs:5,children:F(_,j)}),Object(x.jsx)(ft.a,{item:!0,children:Object(x.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){O(f.concat(j)),p([])},disabled:0===j.length,"aria-label":"move all right",children:"\u226b"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){O(f.concat(I)),p(P(j,I)),c(P(r,I))},disabled:0===I.length,"aria-label":"move selected right",children:">"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){p(j.concat($)),O(P(f,$)),c(P(r,$))},disabled:0===$.length,"aria-label":"move selected left",children:"<"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){p(j.concat(f)),O([])},disabled:0===f.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(x.jsx)(ft.a,{item:!0,xs:5,children:F(S,f)})]})}var er=s.a.memo(Xi),tr=Object(be.a)(Ki||(Ki=Object(_.a)(["\n  query getPayloadTypesAndCommands{\n    payloadtype(where: {deleted: {_eq: false}}, order_by: {ptype: asc}) {\n      commands(order_by: {cmd: asc}) {\n        cmd\n        id\n      }\n      id\n      ptype\n    }\n  }\n"])));function ar(e){var t=e.dialogTitle,a=e.onSubmit,n=e.blockListName,i=e.onClose,r=e.currentSelected,c=e.editable,o=s.a.useState([]),l=Object(u.a)(o,2),d=l[0],p=l[1],m=s.a.useState({}),h=Object(u.a)(m,2),f=h[0],g=h[1],_=s.a.useState(""),k=Object(u.a)(_,2),w=k[0],C=k[1];Object(je.a)(tr,{fetchPolicy:"network-only",onCompleted:function(e){n&&C(n);var t=e.payloadtype.map((function(e){var t=[];return void 0!==r[e.ptype]&&(t=Object(y.a)(r[e.ptype])),Object(v.a)(Object(v.a)({},e),{},{selected:t})}));p(t),g(Object(v.a)({},r))},onError:function(e){}});var S=s.a.useCallback((function(e){var t=e.selected,a=e.ptype;g(Object(v.a)(Object(v.a)({},f),{},Object(jt.a)({},a,t)))}),[f]);return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:t}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(j.a,{disabled:!c,onChange:function(e,t,a){C(t)},value:w,name:"Block List Name",autoFocus:!0,requiredValue:!0}),d.map((function(e){return Object(x.jsx)(er,{leftTitle:"Not Blocked",onChange:S,rightTitle:"Blocked Commands",itemKey:"cmd",right:e.selected,left:e.commands,ptype:e.ptype},e.ptype)}))]}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:i,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){if(""!==w.trim()){for(var e=[],t=[],n=0,c=Object.values(f);n<c.length;n++)for(var o=c[n],s=0;s<o.length;s++)e.push({command_id:o[s].id,name:w.trim()});for(var l=function(){for(var a=u[d],n=function(n){var i=e.findIndex((function(e){return e.command_id===a[n].id}));i>-1?e.splice(i,1):t.push({command_id:a[n].id,name:w.trim()})},i=0;i<a.length;i++)n(i)},d=0,u=Object.values(r);d<u.length;d++)l();a({toAdd:e,toRemove:t}),i()}else O.b.warning("Must supply a block list name")},variant:"contained",color:"secondary",children:"Submit"})]})]})}var nr,ir,rr,cr,or,sr=a(294),lr=a.n(sr),dr=Object(be.a)(nr||(nr=Object(_.a)(["\nmutation newBlockListsEntries($entries: [disabledcommandsprofile_insert_input!]!) {\n    insert_disabledcommandsprofile(objects: $entries) {\n        returning {\n            id\n            name\n            command{\n              id\n              cmd\n              payloadtype{\n                ptype\n              }\n            }\n        }\n    }\n}\n"]))),ur=Object(be.a)(ir||(ir=Object(_.a)(["\nmutation deleteEntireBlockList($name: String!){\n    deleteBlockList(name: $name){\n        status\n        error\n        name\n    }\n}\n"]))),br=Object(be.a)(rr||(rr=Object(_.a)(["\nmutation deleteBlockListEntries($name: String!, $entries: [Int!]!){\n    deleteBlockListEntry(name: $name, entries: $entries){\n        status\n        error\n        name\n        deleted_ids\n    }\n}\n"])));function jr(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=Object(pe.a)(dr,{onCompleted:function(e){var t=e.insert_disabledcommandsprofile.returning.reduce((function(e,t){return void 0===e[t.command.payloadtype.ptype]&&(e[t.command.payloadtype.ptype]=[]),e[t.command.payloadtype.ptype].push(t),Object(v.a)({},e)}),{}),a=Object(y.a)(l),n=!1,i=a.map((function(a){if(a.name===e.insert_disabledcommandsprofile.returning[0].name){n=!0;for(var i={},r=0,c=Object.entries(t);r<c.length;r++){var o=Object(u.a)(c[r],2),s=o[0],l=o[1];void 0===i[s]?i[s]=Object(y.a)(l):i[s]=[].concat(Object(y.a)(i[s]),Object(y.a)(l))}for(var d=0,b=Object.entries(a.entries);d<b.length;d++){var j=Object(u.a)(b[d],2),p=j[0],m=j[1];void 0===i[p]?i[p]=Object(y.a)(m):i[p]=[].concat(Object(y.a)(i[p]),Object(y.a)(m))}return Object(v.a)(Object(v.a)({},a),{},{entries:i})}return Object(v.a)({},a)}));d(n?Object(y.a)(i):[].concat(Object(y.a)(i),[{name:e.insert_disabledcommandsprofile.returning[0].name,entries:t}]))},onError:function(e){O.b.warning("Unable to create new block lists"),console.log(e)}}),p=Object(u.a)(j,1)[0],m=Object(pe.a)(ur,{onCompleted:function(e){if("success"===e.deleteBlockList.status){var t=l.filter((function(t){return t.name!==e.deleteBlockList.name}));d(t),O.b.success("Successfully deleted block list")}else O.b.error(e.deleteBlockList.error)},onError:function(e){O.b.warning("Unable to delete block list"),console.log(e)}}),h=Object(u.a)(m,1)[0],f=Object(pe.a)(br,{onCompleted:function(e){if("success"===e.deleteBlockListEntry.status){O.b.success("Successfully deleted block list");var t=Object(y.a)(l).map((function(t){if(t.name===e.deleteBlockListEntry.name){for(var a={},n=0,i=Object.entries(t.entries);n<i.length;n++){var r=Object(u.a)(i[n],2),c=r[0],o=r[1].filter((function(t){return!e.deleteBlockListEntry.deleted_ids.includes(t.id)}));a[c]=o}return Object(v.a)(Object(v.a)({},t),{},{entries:a})}return Object(v.a)({},t)}));d(Object(y.a)(t))}else O.b.error(e.deleteBlockListEntry.error)},onError:function(e){O.b.warning("Unable to delete block list"),console.log(e)}}),g=Object(u.a)(f,1)[0];s.a.useEffect((function(){d(e.blockLists)}),[e.blockLists]);var _=function(e){var t=e.toAdd,a=e.toRemove;t.length>0&&p({variables:{entries:t}});var n=a.map((function(e){return e.command_id}));n.length>0&&g({variables:{entries:n,name:a[0].name}})},$=function(e){var t=e.name;h({variables:{name:t}})};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Command Block Lists"}),Object(x.jsx)(b.a,{size:"small",onClick:function(){r(!0)},style:{marginRight:"20px",float:"right",marginTop:"10px"},startIcon:Object(x.jsx)(W.a,{}),color:"primary",variant:"contained",children:"New Block List"}),i&&Object(x.jsx)(Y.a,{open:i,fullWidth:!0,maxWidth:"lg",onClose:function(){r(!1)},innerDialog:Object(x.jsx)(ar,{editable:!0,currentSelected:[],onSubmit:function(e){var t=e.toAdd;p({variables:{entries:t}})},dialogTitle:"Create New Block List",onClose:function(){return r(!1)}})})]}),Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(x.jsx)(C.a,{style:{width:"7rem"},children:"Modify"}),Object(x.jsx)(C.a,{style:{width:"15rem"},children:"Name"}),Object(x.jsx)(C.a,{children:"Blocked Commands"})]})}),Object(x.jsx)(w.a,{children:l.map((function(e){return Object(x.jsx)(pr,Object(v.a)(Object(v.a)({},e),{},{onAcceptDelete:$,onSubmitEdits:_}),e.name)}))})]})})]})}function pr(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState({}),O=Object(u.a)(f,2),g=O[0],y=O[1];s.a.useEffect((function(){for(var t=[],a={},n=0,i=Object.entries(e.entries);n<i.length;n++){var r=Object(u.a)(i[n],2),c=r[0],o=r[1],s=o.map((function(e){return e.command.cmd})).sort().join(", ");t.push({ptype:c,commands:s}),a[c]=o.map((function(e){return e.command}))}y(a),d(t)}),[e.entries]);return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsxs)(C.a,{children:[Object(x.jsx)(E.a,{size:"small",onClick:function(){r(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})}),Object(x.jsx)(Oa.a,{onClose:function(){r(!1)},onSubmit:function(){r(!1),e.onAcceptDelete({name:e.name})},open:i})]}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(b.a,{size:"small",onClick:function(){h(!0)},startIcon:Object(x.jsx)(lr.a,{}),color:"secondary",variant:"contained",children:"Edit"}),m&&Object(x.jsx)(Y.a,{open:m,fullWidth:!0,maxWidth:"lg",onClose:function(){h(!1)},innerDialog:Object(x.jsx)(ar,{editable:!1,blockListName:e.name,currentSelected:g,onSubmit:function(t){var a=t.toAdd,n=t.toRemove;e.onSubmitEdits({toAdd:a,toRemove:n})},dialogTitle:"Edit Block List",onClose:function(){return h(!1)}})})]}),Object(x.jsx)(C.a,{children:e.name}),Object(x.jsx)(C.a,{children:l.map((function(t){return Object(x.jsxs)("div",{children:[t.ptype," - ",t.commands]},e.name+t.ptype)}))})]})}var mr=Object(be.a)(cr||(cr=Object(_.a)(["\nquery GetOperations {\n  operation(order_by: {name: asc}) {\n    complete\n    name\n    id\n    admin {\n      username\n      id\n    }\n    operatoroperations {\n      view_mode\n      operator {\n        username\n        id\n      }\n      id\n    }\n  }\n  operator(where: {active: {_eq: true}, deleted: {_eq: false}}) {\n    id\n    username\n  }\n}\n"]))),hr=Object(be.a)(or||(or=Object(_.a)(["\nquery getBlockLists {\n  disabledcommandsprofile(order_by: {name: asc}) {\n    id\n    name\n    command{\n      id\n      cmd\n      payloadtype{\n        ptype\n      }\n    }\n  }\n}\n"])));function fr(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1];Object(je.a)(mr,{fetchPolicy:"network-only",onCompleted:function(e){l(e.operation)},onError:function(e){}}),Object(je.a)(hr,{fetchPolicy:"network-only",onCompleted:function(e){for(var t=e.disabledcommandsprofile.reduce((function(e,t){return void 0===e[t.name]&&(e[t.name]={}),void 0===e[t.name][t.command.payloadtype.ptype]&&(e[t.name][t.command.payloadtype.ptype]=[]),e[t.name][t.command.payloadtype.ptype].push(t),Object(v.a)({},e)}),{}),a=[],n=0,r=Object.entries(t);n<r.length;n++){var c=Object(u.a)(r[n],2),o=c[0],s=c[1];a.push({name:o,entries:s})}i(a)},onError:function(e){}});return Object(x.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(x.jsx)(Yi,{operations:o,onUpdateOperation:function(e){var t=e.id,a=e.name,n=e.complete,i=o.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{name:a,complete:n}):Object(v.a)({},e)}));l(i)},onNewOperation:function(e){var t=e.id,a=e.name,n=e.admin;l([].concat(Object(y.a)(o),[{id:t,name:a,admin:n}]))}}),Object(x.jsx)(jr,{blockLists:n})]})}a(390),a(391);var Or,xr=Object(be.a)(Or||(Or=Object(_.a)(["\nquery getCommandsAndPayloadTypes{\n  payloadtype(order_by: {ptype: asc}){\n    id\n    ptype\n    commands(order_by: {cmd: asc}){\n      id\n      cmd\n    }\n  }\n}\n"])));function gr(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),l=Object(u.a)(c,2),d=l[0],p=l[1],m=s.a.useState(""),h=Object(u.a)(m,2),f=h[0],O=h[1],g=s.a.useState([]),y=Object(u.a)(g,2),v=y[0],_=y[1],k=s.a.useState([]),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState(""),I=Object(u.a)(D,2),T=I[0],$=I[1],P=Object(o.useRef)(null),A=Object(o.useRef)(null);Object(je.a)(xr,{onCompleted:function(t){if(_(t.payloadtype),void 0!==e.payload_type_id?p(e.payload_type_id):t.payloadtype.length>0&&p(t.payloadtype[0].id),void 0!==e.command_id){O(e.command_id);for(var a=0;a<t.payloadtype.length;a++)e.payload_type_id===t.payloadtype[a].id&&S(t.payloadtype[a].commands)}else t.payloadtype.length>0&&t.payloadtype[0].commands.length>0&&(S(t.payloadtype[0].commands),O(t.payloadtype[0].commands[0].id));void 0!==e.author&&$(e.author)},onError:function(e){}}),Object(o.useEffect)((function(){void 0!==e.script&&r(atob(e.script))}),[e.script]);var E=function(){e.onSubmitEdit({script:btoa(i),command_id:f,payload_type_id:d,author:T}),e.onClose()};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{children:e.title?e.title:"Edit BrowserScript Code"}),Object(x.jsxs)(G.a,{dividers:!0,style:{height:"calc(80vh)"},children:[Object(x.jsxs)(mt.a,{style:{width:"50%"},children:[Object(x.jsx)($t.a,{ref:P,children:"Payload Type"}),Object(x.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:d,onChange:function(e){p(e.target.value);var t=v.filter((function(t){return t.id===e.target.value}));S(t[0].commands),O(t[0].commands[0].id)},input:Object(x.jsx)(Ot.a,{style:{width:"100%"}}),children:v.map((function(e){return Object(x.jsx)(at.a,{value:e.id,children:e.ptype},"payloadtype"+e.id)}))})]}),Object(x.jsxs)(mt.a,{style:{width:"50%",paddingBottom:"10px"},children:[Object(x.jsx)($t.a,{ref:A,children:"Command"}),Object(x.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:f,onChange:function(e){O(e.target.value)},input:Object(x.jsx)(Ot.a,{style:{width:"100%"}}),children:C.map((function(e){return Object(x.jsx)(at.a,{value:e.id,children:e.cmd},"command"+e.id)}))})]}),Object(x.jsx)(j.a,{value:T,onChange:function(e,t,a){$(t)},name:"Author",fullWidth:!0}),Object(x.jsx)(rt.a,{mode:"javascript",theme:"dark"===t.palette.type?"monokai":"github",width:"100%",height:"100%",value:i,focus:!0,onChange:function(e){r(e)},setOptions:{}})]}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",style:{backgroundColor:t.palette.primary.main},children:"Close"}),e.new?Object(x.jsx)(b.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Create"}):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(b.a,{onClick:function(){e.onRevert(),e.onClose()},variant:"contained",style:{backgroundColor:t.palette.success.main},children:"Revert"}),Object(x.jsx)(b.a,{onClick:E,variant:"contained",style:{backgroundColor:t.palette.warning.main},children:"Save"})]})]})]})}function yr(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1];Object(o.useEffect)((function(){var t=!1;e.browserscriptoperations.forEach((function(a){a.operation_id===e.operation_id&&(t=!0)})),j(t)}),[e.browserscriptoperations,e.operation_id]);return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsxs)(C.a,{children:[Object(x.jsx)(E.a,{size:"small",onClick:function(){f(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})}),Object(x.jsx)(Oa.a,{onClose:function(){f(!1)},onSubmit:function(){e.onDelete({browserscript_id:e.id})},open:h})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:e.active,onChange:function(){e.onToggleActive({browserscript_id:e.id,active:!e.active})},color:"primary",inputProps:{"aria-label":"checkbox",track:"white"},name:"Active"})}),Object(x.jsx)(C.a,{children:e.payloadtype.ptype}),Object(x.jsx)(C.a,{children:e.command.cmd}),Object(x.jsx)(C.a,{children:e.author}),Object(x.jsxs)(C.a,{children:[e.user_modified?"User Modified":""," "]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){r(!0)},color:"primary",children:" Edit "})}),Object(x.jsx)(C.a,{children:d?Object(x.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitRemoveFromOperation({browserscript_id:e.id})},color:"secondary",children:"Remove"}):Object(x.jsx)(b.a,{size:"small",variant:"contained",onClick:function(){e.onSubmitApplyToOperation({browserscript_id:e.id})},color:"primary",children:"Apply"})}),i?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"xl",open:i,onClose:function(){r(!1)},innerDialog:Object(x.jsx)(gr,{onClose:function(){r(!1)},payload_type_id:e.payloadtype.id,command_id:e.command.id,script:e.script,onSubmitEdit:function(t){var a=t.script,n=t.command_id,i=t.payload_type_id,r=t.author;e.onSubmitEdit({browserscript_id:e.id,script:a,command_id:n,payload_type_id:i,author:r})},onRevert:function(){e.onRevert({browserscript_id:e.id,script:e.container_version})},author:e.author})}):null]},"payload"+e.id)})}function vr(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Browser Scripts"}),Object(x.jsx)(b.a,{size:"small",onClick:function(){return r(!0)},style:{float:"right",marginTop:"10px",marginRight:"30px"},startIcon:Object(x.jsx)(W.a,{}),color:"primary",variant:"contained",children:"New Script"}),i?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:i,onClose:function(){r(!1)},innerDialog:Object(x.jsx)(gr,{onClose:function(){r(!1)},title:"Create New Browser Script",new:!0,onSubmitEdit:e.onSubmitNew})}):null]}),Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{maxHeight:"calc(50vh)"},children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Active"}),Object(x.jsx)(C.a,{children:"Payload"}),Object(x.jsx)(C.a,{children:"Command"}),Object(x.jsx)(C.a,{children:" Author"}),Object(x.jsx)(C.a,{style:{width:"15em"},children:"User Modified?"}),Object(x.jsx)(C.a,{style:{width:"8em"},children:" Edit"}),Object(x.jsx)(C.a,{style:{width:"15rem"},children:"Apply to Operation"})]})}),Object(x.jsx)(w.a,{children:e.browserscripts.map((function(t){return Object(x.jsx)(yr,Object(v.a)({onSubmitApplyToOperation:e.onSubmitApplyToOperation,onSubmitRemoveFromOperation:e.onSubmitRemoveFromOperation,operation_id:e.operation_id,onToggleActive:e.onToggleActive,onSubmitEdit:e.onSubmitEdit,onRevert:e.onRevert,onToggleOperation:e.onToggleOperation,onDelete:e.onDelete},t),"script"+t.id)}))})]})})]})}var _r,kr,wr,Cr,Sr,Dr,Ir,Tr=a(170);function $r(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],d=c[1];return Object(o.useEffect)((function(){d(null===e.browserscript.command?"Support Script: "+e.browserscript.name:e.browserscript.command.cmd)}),[e.browserscript]),Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:e.browserscript.payloadtype.ptype}),Object(x.jsx)(C.a,{children:l}),Object(x.jsxs)(C.a,{children:[e.browserscript.user_modified?"User Modified":""," "]}),Object(x.jsx)(C.a,{children:e.operation.admin.username}),Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{size:"small",variant:"contained",style:{color:Tr.a.palette.info.main},onClick:function(){i(!0)},children:" View "})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(x.jsx)(rt.a,{mode:"javascript",theme:"github",width:"100%",value:atob(e.browserscript.script),focus:!0,readOnly:!0,onChange:function(){},setOptions:{}})})]},"opscript"+e.browserscript.id)})}function Pr(e){var t=Object(ee.a)();return e.browserscriptoperation.length>0&&Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Operation Browser Scripts"})}),Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{maxHeight:"calc(30vh)"},children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"10em"},children:"Payload"}),Object(x.jsx)(C.a,{style:{},children:"Command"}),Object(x.jsx)(C.a,{style:{width:"5em"},children:"User Modified?"}),Object(x.jsx)(C.a,{style:{},children:"Operator"}),Object(x.jsx)(C.a,{style:{width:"5em"},children:"View Script"})]})}),Object(x.jsx)(w.a,{children:e.browserscriptoperation.map((function(e){return Object(x.jsx)($r,Object(v.a)({},e),"opscriptrow"+e.browserscript.id)}))})]})})]})}var Ar,Er,Lr=Object(be.a)(_r||(_r=Object(_.a)(["\nsubscription SubscribeBrowserScripts($operator_id: Int!) {\n  browserscript(where: {operator_id: {_eq: $operator_id}, for_new_ui: {_eq: true}}, order_by: {payloadtype: {ptype: asc}}) {\n    active\n    author\n    user_modified\n    script\n    payloadtype {\n      ptype\n      id\n    }\n    name\n    id\n    creation_time\n    container_version_author\n    container_version\n    command {\n      cmd\n      id\n    }\n    browserscriptoperations {\n      operation_id\n      id\n    }\n  }\n}\n "]))),Fr=Object(be.a)(kr||(kr=Object(_.a)(["\nsubscription SubscribeOperationBrowserScripts($operation_id: Int!) {\n  browserscriptoperation(where: {operation_id: {_eq: $operation_id}, browserscript: {for_new_ui: {_eq: true}}}){\n    browserscript{\n        active\n        author\n        user_modified\n        script\n        payloadtype {\n          ptype\n          id\n        }\n        name\n        id\n        creation_time\n        container_version_author\n        container_version\n        command {\n          cmd\n          id\n        }\n      }\n   operation{\n    admin{\n        username\n    }\n   }\n  }\n}\n "]))),Nr=Object(be.a)(wr||(wr=Object(_.a)(["\nmutation updateBrowserScriptActive($browserscript_id: Int!, $active: Boolean!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {active: $active}) {\n    id\n  }\n}\n"]))),qr=Object(be.a)(Cr||(Cr=Object(_.a)(["\nmutation updateBrowserScriptScript($browserscript_id: Int!, $script: String!, $command_id: Int!, $payload_type_id: Int!, $author: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, author: $author, user_modified: true, command_id: $command_id, payload_type_id: $payload_type_id}) {\n    id\n  }\n}\n"]))),Rr=Object(be.a)(Sr||(Sr=Object(_.a)(["\nmutation updateBrowserScriptRevert($browserscript_id: Int!, $script: String!) {\n  update_browserscript_by_pk(pk_columns: {id: $browserscript_id}, _set: {script: $script, user_modified: false}) {\n    id\n  }\n}\n"]))),Br=Object(be.a)(Dr||(Dr=Object(_.a)(["\nmutation insertNewBrowserScript($script: String!, $author: String!, $payload_type_id: Int!, $command_id: Int!){\n  insert_browserscript_one(object: {script: $script, author: $author, payload_type_id: $payload_type_id, command_id: $command_id}){\n    id\n  }\n}\n"]))),Mr=Object(be.a)(Ir||(Ir=Object(_.a)(["\nmutation deleteBrowserScriptMutation($browserscript_id: Int!){\n  delete_browserscript_by_pk(id: $browserscript_id){\n    id\n  }\n}\n"])));function zr(e){var t=Object(f.a)(h.b),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState({browserscriptoperation:[]}),o=Object(u.a)(c,2),l=o[0],d=o[1],b=s.a.useRef(!0);Object(Me.a)(Lr,{variables:{operator_id:t.user.id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;if(console.log(t),b.current){var a=Object(y.a)(t.data.browserscript);a.sort((function(e,t){return e.payloadtype.ptype===t.payloadtype.ptype?e.command.cmd.localeCompare(t.command.cmd):0})),r(a)}}}),Object(Me.a)(Fr,{variables:{operation_id:t.user.current_operation_id},fetchPolicy:"no-cache",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;b.current&&d(t.data)}});var j=Object(pe.a)(Nr,{onCompleted:function(e){O.b.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),p=Object(u.a)(j,1)[0],m=Object(pe.a)(qr,{onCompleted:function(e){O.b.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),g=Object(u.a)(m,1)[0],_=Object(pe.a)(Rr,{onCompleted:function(e){O.b.success("Successfully Updated!",{autoHideDuration:1e3})},onError:function(e){console.error(e)}}),k=Object(u.a)(_,1)[0],w=Object(pe.a)(Br,{onCompleted:function(e){O.b.success("Successfully created new browser script!")},onError:function(e){O.b.error("Failed to create new script: "+e)}}),C=Object(u.a)(w,1)[0],S=Object(pe.a)(Mr,{onCompleted:function(e){O.b.success("Successfully deleted browser script")},onError:function(e){O.b.error("Failed to delete browser script: "+e)}}),D=Object(u.a)(S,1)[0];return s.a.useRef((function(){return function(){b.current=!1}}),[]),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(vr,{browserscripts:i,operation_id:t.user.current_operation_id,onToggleActive:function(e){var t=e.browserscript_id,a=e.active;p({variables:{browserscript_id:t,active:a}})},onSubmitEdit:function(e){var t=e.browserscript_id,a=e.script,n=e.command_id,i=e.payload_type_id,r=e.author;g({variables:{browserscript_id:t,script:a,command_id:n,payload_type_id:i,author:r}})},onRevert:function(e){var t=e.browserscript_id,a=e.script;k({variables:{browserscript_id:t,script:a}})},onSubmitNew:function(e){var t=e.script,a=e.author,n=e.payload_type_id,i=e.command_id;C({variables:{author:a,script:t,payload_type_id:n,command_id:i}})},onDelete:function(e){var t=e.browserscript_id;D({variables:{browserscript_id:t}})},onSubmitApplyToOperation:function(e){e.browserscript_id;O.b.warning("Not Implemented Yet!",{autoHideDuration:1e3})},onSubmitRemoveFromOperation:function(e){e.browserscript_id;O.b.warning("Not Implemented Yet!",{autoHideDuration:1e3})}}),Object(x.jsx)(Pr,Object(v.a)({},l))]})}var Wr,Hr,Ur=Object(be.a)(Ar||(Ar=Object(_.a)(["\nmutation updateDescription ($payload_id: Int!, $description: String) {\n  update_payload_by_pk(pk_columns: {id: $payload_id}, _set: {tag: $description}) {\n    tag\n    id\n  }\n}\n"]))),Gr=Object(be.a)(Er||(Er=Object(_.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    tag\n    id\n  }\n}\n"])));function Kr(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(je.a)(Gr,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.tag)},fetchPolicy:"network-only"}),c=r.loading,l=r.error,d=Object(pe.a)(Ur,{onCompleted:function(e){O.b.success("Updated Description")}}),p=Object(u.a)(d,1)[0];if(c)return Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}});if(l)return console.error(l),Object(x.jsx)("div",{children:"Error!"});var m=function(){p({variables:{payload_id:e.payload_id,description:n}}),e.onClose()};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Edit Payload Description"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(j.a,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:m})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(x.jsx)(b.a,{variant:"contained",onClick:m,color:"secondary",children:"Submit"})]})]})}var Vr,Qr=Object(be.a)(Wr||(Wr=Object(_.a)(["\nmutation updateDescription ($file_id: Int!, $filename: bytea!) {\n  update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {filename: $filename}) {\n    filename_text\n    id\n  }\n}\n"]))),Jr=Object(be.a)(Hr||(Hr=Object(_.a)(["\nquery getFilenameQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    filemetum {\n      filename_text\n      id\n    }\n    id\n  }\n}\n"])));function Yr(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(),c=Object(u.a)(r,2),l=c[0],d=c[1],p=Object(je.a)(Jr,{variables:{payload_id:e.payload_id},onCompleted:function(e){i(e.payload_by_pk.filemetum.filename_text),d(e.payload_by_pk.filemetum.id)},fetchPolicy:"network-only"}),m=p.loading,h=p.error,f=Object(pe.a)(Qr,{onCompleted:function(e){O.b.success("Updated filename")}}),g=Object(u.a)(f,1)[0];if(m)return Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}});if(h)return console.error(h),Object(x.jsx)("div",{children:"Error!"});var y=function(){g({variables:{file_id:l,filename:n}}),e.onClose()};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Edit Payload Filename"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(j.a,{autoFocus:!0,onChange:function(e,t,a){i(t)},value:n,onEnter:y})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(x.jsx)(b.a,{variant:"contained",onClick:y,color:"secondary",children:"Submit"})]})]})}var Zr=Object(be.a)(Vr||(Vr=Object(_.a)(["\nquery getDescriptionQuery ($payload_id: Int!) {\n  payload_by_pk(id: $payload_id) {\n    build_message\n    build_stderr\n    build_stdout\n    id\n  }\n}\n"])));function Xr(e){var t=Object(o.useState)({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=Object(ee.a)(),p=Object(je.a)(Zr,{variables:{payload_id:e.payload_id},onCompleted:function(t){d(e.viewError);var a="Message:\n"+t.payload_by_pk.build_message;a+="\nSTDOUT:\n"+t.payload_by_pk.build_stdout,i({message:a,error:"STDERR:\n"+t.payload_by_pk.build_stderr})},fetchPolicy:"network-only"}),m=p.loading,h=p.error;return Object(o.useEffect)((function(){d(e.viewError)}),[e.viewError]),m?Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}}):h?(console.error(h),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Payload Build Messages"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(rt.a,{mode:"json",theme:"dark"===j.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:l?n.error:n.message,width:"100%",minLines:2,maxLines:50,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var ec=a(239),tc=a.n(ec),ac=a(475),nc=a.n(ac);function ic(e){var t=Object(ee.a)();return Object(x.jsx)(s.a.Fragment,{children:e.payloadc2profiles.map((function(a){return Object(x.jsxs)(L.a,{style:{display:"flex"},children:[a.c2profile.is_p2p?a.c2profile.container_running?Object(x.jsx)(kt.a,{title:"C2 Container online",children:Object(x.jsx)(Ga.a,{style:{color:t.palette.success.main}})}):Object(x.jsx)(kt.a,{title:"C2 Container offline",children:Object(x.jsx)(tc.a,{style:{color:t.palette.error.main}})}):a.c2profile.running?Object(x.jsx)(kt.a,{title:"C2 Internal Server Running",children:Object(x.jsx)(Ga.a,{style:{color:t.palette.success.main}})}):a.c2profile.container_running?Object(x.jsx)(kt.a,{title:"C2 Internal Server Not Running, but Container Online",children:Object(x.jsx)(nc.a,{style:{color:t.palette.warning.main}})}):Object(x.jsx)(kt.a,{title:"C2 Container offline",children:Object(x.jsx)(tc.a,{style:{color:t.palette.error.main}})})," - ",a.c2profile.name]},a.c2profile.name+e.uuid)}))})}var rc,cc=a(107),oc=a.n(cc),sc=a(476),lc=a.n(sc);function dc(e){var t=Object(ee.a)();return Object(x.jsx)(s.a.Fragment,{children:"success"===e.build_phase?Object(x.jsx)(kt.a,{title:"Download payload",children:Object(x.jsx)(E.a,{variant:"contained",target:"_blank",color:"primary",href:window.location.origin+"/direct/download/"+e.filemetum.agent_file_id,download:!0,children:Object(x.jsx)(oc.a,{style:{color:t.palette.success.main}})})}):"building"===e.build_phase?Object(x.jsx)(kt.a,{title:"Payload still building",children:Object(x.jsx)(E.a,{variant:"contained",children:Object(x.jsx)(oa.a,{size:20,thickness:4,style:{color:t.palette.info.main}})})}):Object(x.jsx)(kt.a,{title:"Failed to build payload",children:Object(x.jsx)(E.a,{variant:"contained",onClick:function(){return O.b.warning("Payload failed to build, cannot download")},children:Object(x.jsx)(lc.a,{style:{color:t.palette.error.main}})})})})}var uc,bc=Object(be.a)(rc||(rc=Object(_.a)(["\nquery checkPayloadConfigurationQuery($uuid: String!) {\n  config_check(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function jc(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)(),c=Object(je.a)(bc,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.config_check.status?i(e.config_check.output):(O.b.warning(e.config_check.error),i("Error!\n"+e.config_check.error))},fetchPolicy:"network-only"}),l=c.loading,d=c.error;return l?Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}}):d?(console.error(d),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Payload Config Check"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(rt.a,{mode:"json",theme:"dark"===r.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:n,width:"100%",minLines:2,maxLines:50,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var pc=Object(be.a)(uc||(uc=Object(_.a)(["\nquery generateRedirectRulesMutation($uuid: String!) {\n  redirect_rules(uuid: $uuid) {\n      status\n      error\n      output\n  }\n}\n"])));function mc(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)(),c=Object(je.a)(pc,{variables:{uuid:e.uuid},onCompleted:function(e){"success"===e.redirect_rules.status?i(e.redirect_rules.output):(O.b.warning(e.redirect_rules.error),i("Error!\n"+e.redirect_rules.error))},fetchPolicy:"network-only"}),l=c.loading,d=c.error;return l?Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}}):d?(console.error(d),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Payload Redirect Rules Check"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(rt.a,{mode:"json",theme:"dark"===r.palette.type?"monokai":"xcode",fontSize:14,showGutter:!0,height:"100px",highlightActiveLine:!0,value:n,width:"100%",minLines:2,maxLines:50,setOptions:{showLineNumbers:!0,tabSize:4,useWorker:!1}})}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"})})]})}var hc,fc,Oc,xc=a(171),gc=a.n(xc),yc=Object(be.a)(hc||(hc=Object(_.a)(["\nmutation triggerRebuildMutation($uuid: String!) {\n  rebuild_payload(uuid: $uuid) {\n      status\n      error\n      uuid\n  }\n}\n"]))),vc=Object(be.a)(fc||(fc=Object(_.a)(["\nquery exportPayloadConfigQuery($uuid: String!) {\n  export_payload_config(uuid: $uuid) {\n      status\n      error \n      config \n  }\n}\n"])));function _c(e){var t=s.a.useState(!0),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],g=p[1],y=s.a.useState(!1),_=Object(u.a)(y,2),k=_[0],w=_[1],S=s.a.useState(!1),D=Object(u.a)(S,2),$=D[0],P=D[1],A=s.a.useState(!1),L=Object(u.a)(A,2),F=L[0],N=L[1],q=s.a.useState(!1),R=Object(u.a)(q,2),B=R[0],z=R[1],W=s.a.useState(!1),H=Object(u.a)(W,2),U=H[0],G=H[1],K=s.a.useState(!1),V=Object(u.a)(K,2),Q=V[0],J=V[1],X=Object(o.useRef)(null),te=Object(f.a)(h.b),ae=Object(ee.a)(),ne=Object(pe.a)(yc,{onCompleted:function(e){console.log(e),O.b.success("Successfully triggered rebuild")},onError:function(e){O.b.error("Failed to trigger rebuild: "+e)}}),ie=Object(u.a)(ne,1)[0],re=Object(pt.a)(vc,{fetchPolicy:"no-cache",onCompleted:function(t){if("success"===t.export_payload_config.status){var a=new Blob([t.export_payload_config.config],{type:"text/plain"}),n=document.getElementById("download_config");if(null!==n)n.href=URL.createObjectURL(a),n.download=e.filemetum.filename_text+".json",n.click();else{var i=document.createElement("a");i.id="download_config",i.href=URL.createObjectURL(a),i.download=e.filemetum.filename_text+".json",document.body.appendChild(i),i.click()}}else O.b.error("Failed to export configuration: "+t.export_payload_config.error)},onError:function(e){O.b.error("Failed to export configuration: "+e)}}),ce=Object(u.a)(re,1)[0],oe=[{name:"Rename File",click:function(){P(!0)}},{name:"Edit Description",click:function(){w(!0)}},{name:e.callback_alert?"Stop Alerting to New Callbacks":"Start Alerting to New Callbacks",click:function(){!function(){var t=e.id,a=e.callback_alert;e.onAlertChanged(t,!a)}()}},{name:"View Build Message/Stdout",click:function(){i(!1),N(!0)}},{name:"View Build Errors",click:function(){i(!0),N(!0)}},{name:"Trigger New Build",click:function(){ie({variables:{uuid:e.uuid}})}},{name:"Export Payload Config",click:function(){ce({variables:{uuid:e.uuid}})}},{name:"Generate Redirect Rules",click:function(){J(!0)}},{name:"Check Agent C2 Configuration",click:function(){G(!0)}}],se=function(e){X.current&&X.current.contains(e.target)||d(!1)};return s.a.useMemo((function(){return!e.deleted&&!e.auto_generated||(e.deleted&&e.showDeleted?!e.auto_generated||!(!e.auto_generated||!e.showAutoGenerated):!(!e.auto_generated||!e.showAutoGenerated)&&(!e.deleted||!(!e.deleted||!e.showDeleted)))}),[e.deleted,e.showDeleted,e.auto_generated,e.showAutoGenerated])?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:e.deleted?Object(x.jsx)(kt.a,{title:"Mark payload as not deleted so you can get callbacks, but does not recreate the payload on disk",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){e.onRestorePayload(e.id)},style:{color:ae.palette.success.main},variant:"contained",children:Object(x.jsx)(gc.a,{})})}):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(kt.a,{title:"Delete the payload from disk and mark as deleted. No new callbacks can be generated from this payload",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){g(!0)},style:{color:ae.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})})}),m&&Object(x.jsx)(Oa.a,{onClose:function(){g(!1)},onSubmit:function(){e.onDeletePayload(e.filemetum.id),g(!1)},open:m})]})}),Object(x.jsx)(C.a,{children:Object(Z.b)(e.creation_time,te.user.view_utc_time)}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(b.a,{ref:X,size:"small",onClick:function(){d(!0)},color:"primary",variant:"contained",children:"Actions"}),Object(x.jsx)(tt.a,{open:l,anchorEl:X.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:4},children:function(t){var a=t.TransitionProps,n=t.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},a),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(x.jsx)(T.a,{variant:"outlined",style:{backgroundColor:"dark"===ae.palette.type?ae.palette.primary.dark:ae.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:se,children:Object(x.jsx)(nt.a,{id:"split-button-menu",children:oe.map((function(t,a){return Object(x.jsx)(at.a,{onClick:function(e){return function(e,t){oe[t].click(),d(!1)}(0,a)},children:t.name},t.name+e.uuid)}))})})})}))}}),k?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:k,onClose:function(){w(!1)},innerDialog:Object(x.jsx)(Kr,{payload_id:e.id,onClose:function(){w(!1)}})}):null,$?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:$,onClose:function(){P(!1)},innerDialog:Object(x.jsx)(Yr,{payload_id:e.id,onClose:function(){P(!1)}})}):null,F?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:F,onClose:function(){N(!1)},innerDialog:Object(x.jsx)(Xr,{payload_id:e.id,viewError:n,onClose:function(){N(!1)}})}):null,U?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:U,onClose:function(){G(!1)},innerDialog:Object(x.jsx)(jc,{uuid:e.uuid,onClose:function(){G(!1)}})}):null,Q?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:Q,onClose:function(){J(!1)},innerDialog:Object(x.jsx)(mc,{uuid:e.uuid,onClose:function(){J(!1)}})}):null]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(dc,Object(v.a)({},e))}),Object(x.jsx)(C.a,{children:e.filemetum.filename_text}),Object(x.jsx)(C.a,{children:e.tag}),Object(x.jsx)(C.a,{children:Object(x.jsx)(ic,{payloadc2profiles:e.payloadc2profiles,uuid:e.uuid})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(E.a,{size:"small",color:"primary",onClick:function(){return z(!0)},children:Object(x.jsx)(On.a,{})})})]},"payload"+e.uuid),Object(x.jsx)(I.a,{children:B?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:B,onClose:function(){z(!1)},innerDialog:Object(x.jsx)(jn,Object(v.a)(Object(v.a)({},e),{},{payload_id:e.id,onClose:function(){z(!1)}}))}):null})]}):null}var kc,wc,Cc,Sc,Dc,Ic,Tc=Object(be.a)(Oc||(Oc=Object(_.a)(["\n mutation createPayloadMutation($payload: String!) {\n  createPayload(payloadDefinition: $payload) {\n    error\n    status\n    uuid\n  }\n}\n "])));function $c(e){var t=s.a.useState({name:""}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(pe.a)(Tc,{update:function(e,t){var a=t.data;"success"===a.createPayload.status?O.b.info("Submitted payload to build pipeline"):O.b.error(a.createPayload.error)}}),c=Object(u.a)(r,1)[0];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Import Payload Config to Generate New Payload"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsxs)(b.a,{variant:"contained",component:"label",children:[""===n.name?"Select File":n.name,Object(x.jsx)("input",{onChange:function(e){var t=new FileReader;t.onload=function(t){var a=t.target.result;i({name:e.target.files[0].name,contents:a})},t.readAsBinaryString(e.target.files[0])},type:"file",hidden:!0})]})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{variant:"contained",onClick:e.onClose,color:"primary",children:"Close"}),Object(x.jsx)(b.a,{variant:"contained",onClick:function(){c({variables:{payload:n.contents}}).catch((function(e){console.log(e)})),e.onClose()},color:"secondary",children:"Submit"})]})]})}function Pc(e){var t=e.payload,a=e.onDeletePayload,n=e.onUpdateCallbackAlert,i=e.onRestorePayload,r=Object(ee.a)(),c=s.a.useState(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState(!1),p=Object(u.a)(j,2),h=p[0],f=p[1],O=s.a.useState(!1),g=Object(u.a)(O,2),y=g[0],_=g[1],$=s.a.useRef(null),P=s.a.useState(!1),A=Object(u.a)(P,2),E=A[0],F=A[1],N=Object(m.g)(),q=[{name:"Generate New Payload",click:function(){N.push("/new/createpayload")}},{name:"Generate New Wrapper Payload",click:function(){N.push("/new/createwrapper")}},{name:"Import Payload Config",click:function(){_(!0)}},{name:l?"Hide Deleted Payloads":"Show Deleted Payloads",click:function(){d(!l)}},{name:h?"Hide Autogenerated Payloads":"Show Autogenerated Payloads",click:function(){f(!h)}}];return Object(x.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[Object(x.jsxs)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Payloads"}),Object(x.jsx)(Je.a,{variant:"contained",ref:$,"aria-label":"split button",style:{marginRight:"10px",marginTop:"10px",float:"right"},color:"primary",children:Object(x.jsxs)(b.a,{size:"small",color:"primary","aria-controls":E?"split-button-menu":void 0,"aria-expanded":E?"true":void 0,"aria-haspopup":"menu",onClick:function(){return F(!E)},children:["Actions ",Object(x.jsx)(Ze.a,{})]})}),Object(x.jsx)(tt.a,{open:E,anchorEl:$.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:10},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:function(){return F(!1)},children:Object(x.jsx)(nt.a,{id:"split-button-menu",children:q.map((function(e,t){return Object(x.jsx)(at.a,{onClick:function(e){return function(e,t){q[t].click(),F(!1)}(0,t)},children:e.name},e.name)}))})})})}))}}),y&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:y,onClose:function(){_(!1)},innerDialog:Object(x.jsx)($c,{onClose:function(){_(!1)}})})]}),Object(x.jsx)("div",{style:{display:"flex",flexGrow:1,overflow:"auto"},children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"4rem"},children:" Delete"}),Object(x.jsx)(C.a,{style:{width:"15rem"},children:"Timestamp"}),Object(x.jsx)(C.a,{style:{width:"6rem"},children:"Modify"}),Object(x.jsx)(C.a,{style:{width:"6rem"},children:"Download"}),Object(x.jsx)(C.a,{children:"File"}),Object(x.jsx)(C.a,{children:"Description"}),Object(x.jsx)(C.a,{children:"C2 Status"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Details"})]})}),Object(x.jsx)(w.a,{children:t.map((function(e){return Object(x.jsx)(_c,Object(v.a)({onDeletePayload:a,onAlertChanged:n,showDeleted:l,showAutoGenerated:h,onRestorePayload:i},e),"payload"+e.id)}))})]})})})]})}var Ac=Object(be.a)(kc||(kc=Object(_.a)(["\nfragment payloadData on payload {\n  build_message\n  build_phase\n  build_stderr\n  callback_alert\n  creation_time\n  id\n  operator {\n    id\n    username\n  }\n  uuid\n  tag\n  deleted\n  auto_generated\n  payloadtype {\n    id\n    ptype\n  }\n  filemetum {\n    agent_file_id\n    filename_text\n    id\n  }\n  payloadc2profiles {\n    c2profile {\n      running\n      name\n      is_p2p\n      container_running\n    }\n  }\n}\n"]))),Ec=Object(be.a)(wc||(wc=Object(_.a)(["\n","\nsubscription SubPayloadsQuery($operation_id: Int!) {\n  payload(where: { operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    ...payloadData\n  }\n}\n"])),Ac),Lc=Object(be.a)(Cc||(Cc=Object(_.a)(["\n","\nquery GetPayloadsQuery($operation_id: Int!) {\n  payload(where: { operation_id: {_eq: $operation_id}}, order_by: {id: desc}, limit: 20) {\n    ...payloadData\n  }\n}\n"])),Ac),Fc=Object(be.a)(Sc||(Sc=Object(_.a)(["\nmutation PayloadsDeletePayloadMutation($id: Int!) {\n  deleteFile(file_id: $id) {\n      file_ids\n      status\n      error\n      payload_ids\n  }\n}\n"]))),Nc=Object(be.a)(Dc||(Dc=Object(_.a)(["\nmutation PayloadsCallbackAlertMutation($id: Int!, $callback_alert: Boolean!) {\n  update_payload_by_pk(pk_columns: {id: $id}, _set: {callback_alert: $callback_alert}) {\n    id\n    callback_alert\n  }\n}\n"]))),qc=Object(be.a)(Ic||(Ic=Object(_.a)(["\nmutation RestorePayloadToUndeleted($id: Int!){\n  update_payload_by_pk(pk_columns: {id: $id}, _set: {deleted: false}){\n    id\n    deleted\n  }\n}\n"])));function Rc(e){var t,a,n=Object(f.a)(h.b),i=s.a.useState([]),r=Object(u.a)(i,2),c=r[0],o=r[1],l=s.a.useRef(!0);Object(je.a)(Lc,{variables:{operation_id:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onCompleted:function(e){if(!l.current)return null;var t=e.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(v.a)({},t),Object(y.a)(e)):[t].concat(Object(y.a)(e))}),Object(y.a)(c));t.sort((function(e,t){return e.id>t.id?-1:1})),o(t)}}),Object(Me.a)(Ec,{variables:{operation_id:(null===n||void 0===n||null===(a=n.user)||void 0===a?void 0:a.current_operation_id)||0},fetchPolicy:"no-cache",onSubscriptionData:function(e){var t=e.subscriptionData;if(!l.current)return null;var a=t.data.payload.reduce((function(e,t){var a=e.findIndex((function(e){return e.id===t.id}));return a>-1?(e[a]=Object(v.a)({},t),Object(y.a)(e)):[t].concat(Object(y.a)(e))}),Object(y.a)(c));a.sort((function(e,t){return e.id>t.id?-1:1})),o(a)},onError:function(e){O.b.warning("Failed to get payloads"),console.log(e)}});var d=Object(pe.a)(Fc,{onCompleted:function(e){if("success"===e.deleteFile.status){var t=c.map((function(t){return e.deleteFile.payload_ids.includes(t.id)?Object(v.a)(Object(v.a)({},t),{},{deleted:!0}):Object(v.a)({},t)}));o(t),O.b.success("Successfully deleted")}else O.b.error(e.deleteFile.error)},onError:function(e){O.b.warning("Failed to delete payload"),console.log(e)}}),b=Object(u.a)(d,1)[0],j=Object(pe.a)(qc,{onCompleted:function(e){var t=c.map((function(t){return t.id===e.update_payload_by_pk.id?Object(v.a)(Object(v.a)({},t),e.update_payload_by_pk):Object(v.a)({},t)}));o(t),!1===e.update_payload_by_pk.deleted&&O.b.success("Successfully marked payload as not deleted")},onError:function(e){O.b.warning("Failed to mark as not deleted"),console.log(e)}}),p=Object(u.a)(j,1)[0],m=Object(pe.a)(Nc,{onCompleted:function(e){var t=c.map((function(t){return t.id===e.update_payload_by_pk.id?Object(v.a)(Object(v.a)({},t),e.update_payload_by_pk):Object(v.a)({},t)}));e.update_payload_by_pk.callback_alert?O.b.success("Now Alerting on New Callbacks"):O.b.success("No Longer Alerting on New Callbacks"),o(t)},onError:function(e){O.b.warning("Failed to update callback alerting status"),console.log(e)}}),g=Object(u.a)(m,1)[0];return s.a.useEffect((function(){return function(){l.current=!1}}),[]),Object(x.jsx)("div",{style:{display:"flex",flexGrow:1,flexDirection:"column",marginTop:"10px"},children:Object(x.jsx)(Pc,{onDeletePayload:function(e){b({variables:{id:e}})},onUpdateCallbackAlert:function(e,t){g({variables:{id:e,callback_alert:t}})},payload:c,onRestorePayload:function(e){p({variables:{id:e}})}})})}var Bc=a(108),Mc=a.n(Bc),zc=a(295),Wc=a.n(zc),Hc=a(175),Uc=a.n(Hc),Gc=a(85),Kc=function(e,t,a,n,i,r){!function(e,t,a,n,i,r){Gc.select(".contextMenu").remove(),n.length>0&&(Gc.select(r).append("g").attr("class","contextMenu").selectAll("tmp").data(n).enter().append("g").attr("class","menuEntry").style({cursor:"pointer"}),Gc.selectAll(".menuEntry").append("rect").attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("rx",2).attr("fill","#ffffff").attr("width",180).attr("height",30).on("click",(function(t){t.action(e,i)})),Gc.selectAll(".menuEntry").append("text").text((function(e){return e.title})).attr("x",t).attr("y",(function(e,t){return a+30*t})).attr("dy",20).attr("dx",10).on("click",(function(t){t.action(e,i)})),Gc.select("body").on("click",(function(){Gc.select(".contextMenu").remove(),Gc.select(".menuEntry").remove()})))}(e,Gc.event.pageX,Gc.event.pageY-80,a,t,r),Gc.event.preventDefault()},Vc=a(316),Qc=a.n(Vc);function Jc(e){var t=Object(o.useRef)(null),a=Object(o.useState)(!0),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(ee.a)();return Object(o.useEffect)((function(){Zc(e.callbackgraphedges,t,i,{rankDir:"LR",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!0},{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[]},c),r(!1)}),[e.callbackgraphedges,i,c]),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:["Callback ",e.id,"'s Egress Path"]}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)("svg",{ref:t,id:"nodeTree",style:{width:"100%",height:"calc(78vh)",marginTop:"10px"}})})}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Yc,Zc=function(e,t,a,n,i,r){var c,o="stroke: ".concat(r.palette.warning.main,"; stroke-width: 3px; stroke-dasharray: 5, 5; fill:none"),s="fill: ".concat(r.palette.warning.main),l="stroke: ".concat(r.palette.info.main,"; fill: none; stroke-width: 1.5px;"),d="stroke: ".concat(r.palette.info.main,"; fill: ").concat(r.palette.info.main,"; stroke-width: 1.5px;"),u="fill: ".concat(r.palette.success.main,","),b='labelStyle: "font-size: 2em"; fill: '.concat(r.palette.text.primary),j='labelStyle: "font-size: 2em"; fill: '.concat(r.palette.text.primary),p=function(e,t,a){(t.source.active||a.show_all_nodes)&&(m(e,t.source,a),e.setEdge(t.source.id,"Mythic",{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name))},m=function(e,t,a){e.setNode(t.id,{label:h(t,a.label_components),node:t,style:u,labelStyle:b,shape:"circle",isParent:!1}),e.setNode(t.host,{label:t.host,clusterLabelPos:"top",style:"fill:".concat(r.palette.graphGroup),node:null,labelStyle:b,isParent:!0}),e.setParent(t.id,t.host),e.setNode(t.host+"mythic_expander",{label:"",shape:"square",node:t,isParent:!1}),e.setParent(t.host+"mythic_expander",t.host)},h=function(e,t){return t.map((function(t){return e[t]})).join(", ")},f=function(e,t,a){if(t.source.active||t.destination.active||a.show_all_nodes){if(a.show_all_nodes)m(e,t.source,a),m(e,t.destination,a);else if(t.source.active&&m(e,t.source,a),t.destination.active&&m(e,t.destination,a),!t.source.active||!t.destination.active)return;1===t.direction?a.packet_flow_view?O(e,t,2):O(e,t,1):(2===t.direction||O(e,t,1),O(e,t,2))}},O=function(e,t,a){1===a?e.setEdge(t.source.id,t.destination.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name):2===a&&e.setEdge(t.destination.id,t.source.id,{label:t.c2profile.name,edge_id:t.id,end_timestamp:t.end_timestamp,direction:t.direction,style:null===t.end_timestamp?l:o,labelStyle:j,arrowheadStyle:null===t.end_timestamp?d:s},t.c2profile.name)},x=new Qc.a.graphlib.Graph({compound:!0,multigraph:!0,directed:!0}).setGraph({rankdir:n.rankDir}).setDefaultEdgeLabel((function(){return{}})),g=Gc.select(t.current),y=g.select("g")._groups[0][0];c=y?g.select("g"):g.append("g");var v=Gc.zoom().on("zoom",(function(){c.attr("transform",Gc.event.transform)}));a&&(g.select("g.output").remove(),g.call(v)),x.setNode("Mythic",{label:"",style:u,shape:"circle",node:null,labelStyle:b}),e.forEach((function(e){(n.include_disconnected||null===e.end_timestamp)&&(e.destination.id===e.source.id?x.hasEdge(e.source.id,"Mythic",e.c2profile.name)?e.id>x.edge(e.source.id,"Mythic",e.c2profile.name).edge_id&&p(x,e,n):p(x,e,n):1===e.direction?n.packet_flow_view?x.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>x.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(x,e,n):f(x,e,n):x.hasEdge(e.source.id,e.destination.id,e.c2profile.name)?e.id>x.edge(e.source.id,e.destination.id,e.c2profile.name).edge_id?f(x,e,n):console.log("doing nothing, dropping data"):f(x,e,n):2===e.direction&&(x.hasEdge(e.destination.id,e.source.id,e.c2profile.name)?e.id>x.edge(e.destination.id,e.source.id,e.c2profile.name).edge_id&&f(x,e,n):f(x,e,n)))}));var _=new Qc.a.render,k=g.node().getBoundingClientRect().width,w=g.node().getBoundingClientRect().height;if(_.shapes().circle=function(e,t,a){var n=e.insert("image").attr("class","nodeImage").attr("xlink:href",(function(e){return a.node?"/static/"+a.node.payload.payloadtype.ptype+".svg":"/static/mythic.svg"})).attr("x","-20px").attr("y","-20px").attr("width","40px").attr("height","40px").on("mouseover",(function(t){i.mouseover(e,a,t)})).on("mouseout",(function(t){i.mouseout(e,a,t)})).on("click",(function(t){Gc.event.preventDefault(),i.click(e,a,t)})).on("contextmenu",(function(e){Kc(x,a,i.contextmenu,0,0,"#callbacksgraph")}));return a.intersect=function(e){return Qc.a.intersect.circle(a,25,e)},n},_.shapes().square=function(e,t,a){return e.insert("rect").attr("width",(function(e){var t=x.children(a.node.host),i=a.node.host.length;if(void 0!==t&&t.forEach((function(e){x.node(e).label.length>i&&(i=x.node(e).label.length)})),"LR"===n.rankDir)return 9*i+"px";if(void 0!==t){var r=0;return t.forEach((function(e){x.outEdges(e,"Mythic").length>0&&(r+=1)})),(i=9*i-100*r)<0?0:i+"px"}console.log("candidates were undefined")})).attr("height",0)},_(c,x),a){var C=x.graph().width+40,S=x.graph().height+40,D=Math.min(k/C,w/S),I=k/2-C*D/2,T=w/2-S*D/2;g.transition().duration(500).call(v.transform,Gc.zoomIdentity.translate(I,T).scale(D))}c.selectAll("g.nodes g.label").attr("transform","translate(0,30)")},Xc=Object(be.a)(Yc||(Yc=Object(_.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function eo(e){var t=Object(ee.a)();return Object(x.jsxs)("div",{style:{maxWidth:"30%",width:"30%",display:"inline-flex",height:"calc(94vh)",flexDirection:"column"},children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsxs)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:["Callback ",e.callback.id]})}),Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsx)(to,Object(v.a)({},e.callback))})]})}function to(e){s.a.useRef(null);var t=Object(ee.a)(),a=Object(f.a)(h.b),n=s.a.useState(""),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState(!1),d=Object(u.a)(l,2),b=d[0],j=d[1],p=s.a.useState(t.palette.success.main),m=Object(u.a)(p,2),O=m[0],g=m[1],_=s.a.useState(!0),S=Object(u.a)(_,2),D=S[0],T=S[1],$=s.a.useState(!1),P=Object(u.a)($,2),A=P[0],E=P[1],F=s.a.useState([]),N=Object(u.a)(F,2),q=N[0],R=N[1],B=s.a.useState([]),M=Object(u.a)(B,2),z=M[0],W=M[1],H=s.a.useState(!0),U=Object(u.a)(H,2),G=U[0],K=U[1],V=s.a.useState([]),Q=Object(u.a)(V,2),J=Q[0],X=Q[1];Object(Me.a)(Xc,{variables:{operation_id:a.user.current_operation_id},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;X(t.data.callbackgraphedge)}});Object(Z.c)((function(){var t;t=e.last_checkin,c(Object(Z.a)(t))})),Object(o.useEffect)((function(){var t=z.filter((function(t){return!t.c2profile.is_p2p&&t.source.id===e.id&&t.destination.id===e.id})).length;t>0&&!G?K(!0):0===t&&G&&K(!1)}),[z]),Object(o.useEffect)((function(){var t=function(t){for(var a=J.filter((function(a){return(a.source.id===e.id||a.destination.id===e.id)&&(!t||null===a.end_timestamp)})),n=!0;n;){var i=J.reduce((function(e,a){return e.includes(a)?Object(y.a)(e):e.filter((function(e){return(e.source.id===a.source.id||e.source.id===a.destination.id||e.destination.id===a.source.id)&&(!t||null===a.end_timestamp)})).length>0?[].concat(Object(y.a)(e),[a]):Object(y.a)(e)}),Object(y.a)(a));n=i.length>a,a=Object(y.a)(i)}return a},a=t(!0),n=t(!1);R(a),W(n)}),[J,e.id]),Object(o.useEffect)((function(){0===q.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(g(t.palette.error.main),T(!1)):(g(t.palette.success.main),T(!0))}),[q,t.palette.success.main,t.palette.error.main]);e.locked&&e.locked_operator.username,e.locked?Mc.a:Uc.a,ki.a;return Object(x.jsx)(k.a,{size:"small",style:{overflow:"scroll"},children:Object(x.jsxs)(w.a,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Elevation Level"}),Object(x.jsxs)(C.a,{children:[e.integrity_level,e.integrity_level>2?" ( Elevated Access )":"",2===e.integrity_level?" ( Medium Integrity ) ":"",e.integrity_level<2?" ( Low Integrity )":""]})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Callback Lock Status"}),Object(x.jsx)(C.a,{children:e.locked?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(Mc.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(x.jsx)(L.a,{style:{display:"inline-block"},children:"Locked (by "+e.locked_operator.username+")"})]}):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(Uc.a,{style:{paddingRight:"5px",display:"inline-block",paddingTop:"6px"}}),Object(x.jsx)(L.a,{style:{display:"inline-block"},children:"Unlocked"})]})})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"IP Address"}),Object(x.jsx)(C.a,{children:e.ip})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"External IP"}),Object(x.jsx)(C.a,{children:e.external_ip})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:e.host})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"User"}),Object(x.jsx)(C.a,{children:e.user})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Domain"}),Object(x.jsx)(C.a,{children:e.domain})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"OS / Architecture"}),Object(x.jsxs)(C.a,{children:[e.os,"(",e.architecture,")"]})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Process ID"}),Object(x.jsx)(C.a,{children:e.pid})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Last Checkin"}),Object(x.jsx)(C.a,{children:r})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Description"}),Object(x.jsx)(C.a,{children:e.description})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Sleep Info"}),Object(x.jsx)(C.a,{children:e.sleep_info})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Agent Type"}),Object(x.jsx)(C.a,{children:e.payload.payloadtype.ptype})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Egress Route"}),Object(x.jsx)(C.a,{children:G?Object(x.jsx)(Qe.a,{onClick:function(e){e.stopPropagation(),E(!0)},style:{color:O,cursor:"pointer"}}):Object(x.jsx)(Wc.a,{onClick:function(e){e.stopPropagation(),E(!0)},style:{color:O,cursor:"pointer"}})})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Process Name"}),Object(x.jsx)(C.a,{children:e.process_name})]}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:A,onClose:function(){E(!1)},innerDialog:Object(x.jsx)(Jc,Object(v.a)(Object(v.a)({onClose:function(){E(!1)}},e),{},{callbackgraphedges:D?q:z}))}),Object(x.jsx)(Y.a,{fullWidth:!0,open:b,onClose:function(){j(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Callback's Description",onClose:function(){j(!1)},value:e.description,onSubmit:function(t){e.updateDescription({description:t,id:e.id})}})}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Extra Info"}),Object(x.jsx)(C.a,{children:e.extra_info})]})]})})}var ao,no=a(109),io=Object(be.a)(ao||(ao=Object(_.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    last_checkin\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n    callbacktokens(where: {deleted: {_eq: false}}) {\n      token {\n        TokenId\n        id\n        User\n        description\n      }\n      callback {\n        id\n      }\n      id\n    }\n  }\n}\n "])));function ro(e){var t=Object(m.h)().callbackId,a=s.a.useState({payload:{payloadtype:{ptype:""}},callbacktokens:[]}),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState({callbackID:parseInt(t)}),o=Object(u.a)(c,2),l=o[0],d=o[1];return Object(Me.a)(io,{variables:{callback_id:t},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var a=e.subscriptionData;null!==a.data.callback_by_pk?(r(a.data.callback_by_pk),d({tabID:"interact",tabType:"interact",callbackID:parseInt(t),payloadtype:a.data.callback_by_pk.payload.payloadtype.ptype,payloadDescription:a.data.callback_by_pk.payload.tag,callbackDescription:a.data.callback_by_pk.description,os:a.data.callback_by_pk.payload.os})):O.b.error("Unknown Callback")}}),Object(x.jsx)("div",{style:{width:"100%",height:"100%",maxHeight:"100%",display:"flex",flexDirection:"row"},children:void 0!==l.payloadtype?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(eo,{callback:i}),Object(x.jsx)(no.b,{style:{height:"calc(".concat(96,"vh)"),maxHeight:"calc(".concat(96,"vh)"),width:"69%",maxWidth:"69%",position:"absolute",overflow:"auto",display:"inline-flex",flexDirection:"column"},tabInfo:l,callbacktokens:i.callbacktokens})]}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"Fetching Callback"})})}var co=a(314),oo=a(848),so=Object(Se.a)((function(e){return{root:{width:"100%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:co.a[500]}}}));function lo(){var e=so(),t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(x.jsxs)(Ie.a,{className:e.root,elevation:5,children:[Object(x.jsx)(ka.a,{avatar:Object(x.jsx)(En.a,{className:e.avatar}),title:"Mythic Quick Start Guide",subheader:"Expand this section to learn how to: Generate a Payload, Download the Payload, Get To Callbacks",style:{paddingBottom:0,marginBottom:0}}),Object(x.jsx)(Ba.a,{styl:{padding:0,margin:0},children:Object(x.jsx)(E.a,{className:Object(Ra.default)(e.expand,Object(jt.a)({},e.expandOpen,n)),onClick:function(){i(!n)},"aria-expanded":n,"aria-label":"show more",children:Object(x.jsx)(Ha.a,{})})}),Object(x.jsx)(A.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(x.jsx)($e.a,{style:{margin:0,paddingTop:0},children:Object(x.jsxs)("ol",{children:[Object(x.jsxs)("li",{children:["Create a payload at ",Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/createpayload",children:"Create -> Create Payload"}),Object(x.jsxs)("ul",{children:[Object(x.jsx)("li",{children:"Select Desired OS"}),Object(x.jsx)("li",{children:"Select Payload Type and Supply Build Parameters"}),Object(x.jsx)("li",{children:"Select Commands You Want Stamped Into The Agent"}),Object(x.jsx)("li",{children:"Select C2 Profiles and Fill Out Parameters"}),Object(x.jsx)("li",{children:"Name Your Payload"}),Object(x.jsx)("li",{children:"Provide a Description"}),Object(x.jsx)("li",{children:"Build Your Payload"})]})]}),Object(x.jsxs)("li",{children:["Download Your Payload at ",Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/payloads",children:"Operational Data -> Payloads"})]}),Object(x.jsxs)("li",{children:["Run Your payload",Object(x.jsx)("ul",{children:Object(x.jsxs)("li",{children:["For More Information About Your Agent, Check Out The ",Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/docs/agents",children:"Internal Documentation"})]})})]}),Object(x.jsxs)("li",{children:["Interact With Your Agent At ",Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks",children:"Active Callbacks"})]})]})})})]})}var uo,bo=a(251),jo=Object(be.a)(uo||(uo=Object(_.a)(["\nquery GetC2AndPayloadType {\n  c2profile(where: {deleted: {_eq: false}}) {\n    name\n    id\n  }\n  payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: false}}) {\n    ptype\n    id\n    payloadtypec2profiles {\n      c2profile {\n        name\n        id\n      }\n    }\n  }\n  wrappers: payloadtype(where: {deleted: {_eq: false}, wrapper: {_eq: true}}) {\n    ptype\n    id\n    wrap_these_payload_types {\n      wrapped {\n        ptype\n      }\n    }\n  }\n}\n"])));function po(e){var t=Object(ee.a)(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],b=s.a.useState([]),j=Object(u.a)(b,2),p=j[0],m=j[1];return Object(je.a)(jo,{fetchPolicy:"network-only",onCompleted:function(e){var t=e.c2profile.map((function(e){return e.name})),a=e.payloadtype.map((function(e){var t=e.payloadtypec2profiles.map((function(e){return e.c2profile.name}));return{ptype:e.ptype,payloadtypec2profiles:t}}));t.sort(),a.sort((function(e,t){return e.ptype<t.ptype?-1:1}));var n=e.wrappers.map((function(e){var t=e.wrap_these_payload_types.map((function(e){return e.wrapped.ptype}));return{ptype:e.ptype,wrapped:t}}));n.sort((function(e,t){return e.ptype<t.ptype?-1:1})),m(n),r(t),d(a)},onError:function(e){}}).loading?Object(x.jsx)(Ae.a,{}):Object(x.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Agent / C2 Overview"})}),Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{}),i.map((function(e){return Object(x.jsx)(C.a,{children:e},e)}))]})}),Object(x.jsx)(w.a,{children:l.map((function(e){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:e.ptype}),i.map((function(a){return Object(x.jsx)(C.a,{children:e.payloadtypec2profiles.includes(a)?Object(x.jsx)(bo.a,{title:e.ptype+" supports "+a,children:Object(x.jsx)(Ga.a,{style:{color:t.palette.success.main}})}):""},"payload"+a)}))]},e.ptype)}))})]})}),p.length>0&&Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{marginTop:"10px"},children:Object(x.jsxs)(k.a,{size:"small",children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{}),l.map((function(e){return Object(x.jsx)(C.a,{children:e.ptype},"wrapped"+e.ptype)}))]})}),Object(x.jsx)(w.a,{children:p.map((function(e){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:e.ptype}),l.map((function(a){return Object(x.jsx)(C.a,{children:e.wrapped.includes(a.ptype)?Object(x.jsx)(bo.a,{title:e.ptype+" wraps "+a.ptype,children:Object(x.jsx)(Ga.a,{style:{color:t.palette.success.main}})}):""},"payload"+a.ptype)}))]},"wrapper"+e.ptype)}))})]})})]})}function mo(){var e=Object(ee.a)();return Object(x.jsxs)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:e.pageHeader.main,color:e.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Welcome To Mythic"})}),Object(x.jsx)(lo,{}),Object(x.jsx)(po,{})]})}var ho=a(86),fo=["component"];function Oo(e){var t=e.component,a=Object(ho.a)(e,fo),n=Object(f.a)(h.b);return Object(x.jsx)(m.b,Object(v.a)(Object(v.a)({},a),{},{render:function(e){return n.loggedIn&&n.user?s.a.createElement(t,e):Object(x.jsx)(m.a,{to:{pathname:"/new/login",state:{from:e.location}}})}}))}var xo=a(910),go=a(918),yo=a(48),vo=a(498),_o=a.n(vo),ko=a(306),wo=a.n(ko),Co=a(307),So=a.n(Co),Do=a(29),Io=a(497),To=a.n(Io),$o=a(303),Po=a.n($o),Ao=a(496),Eo=a.n(Ao),Lo=a(216),Fo=a.n(Lo),No=a(217),qo=a.n(No),Ro=["onSelectNode","onExpandNode","onCollapseNode"],Bo=Object(Se.a)((function(e){return{rowContainer:{},row:{display:"flex",alignItems:"left",marginLeft:function(t){return e.spacing(3*t.depth)},userSelect:"none",whiteSpace:"nowrap"},rowButtonWrapper:{width:e.spacing(3),textAlign:"center","&:hover":{cursor:"pointer",textDecoration:"underline"}},rowButton:{width:e.spacing(3)},rowLabel:{marginLeft:e.spacing(.5)},heading:{fontSize:e.typography.pxToRem(15),whiteSpace:"pre-line"},secondaryHeading:{fontSize:e.typography.pxToRem(15),overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},taskAndTimeDisplay:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,overflow:"hidden",display:"block",textOverflow:"ellipsis",maxWidth:"calc(90vw)",whiteSpace:"nowrap"},secondaryHeadingExpanded:{fontSize:e.typography.pxToRem(15),display:"block",overflow:"auto",maxWidth:"calc(90vw)",whiteSpace:"break-word"},icon:{verticalAlign:"middle",height:20,width:20},details:{alignItems:"center"},column:{padding:"0 5px 0 0",display:"inline-block",margin:0,height:"auto"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),Mo=function(e){var t=e.onSelectNode,a=e.onExpandNode,n=e.onCollapseNode,i=Object(ho.a)(e,Ro),r=i.data[i.index],c=Object(ee.a)(),o=Bo(),s=function(e){e.stopPropagation(),r.isOpen?n(r.id,r):(O.b.info("fetching elements...",{persist:!0}),a(r.id,r))};return Object(x.jsx)("div",{style:i.style,children:Object(x.jsxs)("div",{style:{display:"flex",marginBottom:"2px",flexGrow:1,width:"100%"},children:[Object(y.a)(Array(r.data.depth)).map((function(e,t){return Object(x.jsx)("div",{style:{borderLeft:"2px dashed ".concat(Object(Do.c)(c.palette.text.primary,.4)),marginLeft:15,paddingRight:15,display:"inline-block"}},"folder"+r.data.id+"lines"+t)})),Object(x.jsxs)("div",{className:o.root,style:{backgroundColor:c.body,color:c.text,alignItems:"center",display:"flex",paddingRight:"10px"},onClick:function(e){t(r.id,r)},children:[null===r.data.parent_id?Object(x.jsx)(Eo.a,{style:{marginLeft:"3px",marginRight:"5px"},onClick:s}):r.data.is_file?Object(x.jsx)(Fo.a,{style:{marginLeft:"3px",marginRight:"5px"}}):r.isOpen?Object(x.jsx)(Po.a,{style:{marginLeft:"3px",marginRight:"5px",color:c.folderColor},onClick:s}):Object(x.jsx)(To.a,{style:{paddingTop:"5px",marginLeft:"3px",marginRight:"5px",color:c.folderColor},onClick:s}),r.data.depth>0&&r.data.filebrowserobjs_aggregate.aggregate.count>99?Object(x.jsx)(kt.a,{title:"Number of known children",children:Object(x.jsx)(Pe.a,{style:{left:-50},max:99,badgeContent:r.data.filebrowserobjs_aggregate.aggregate.count,color:"primary",anchorOrigin:{vertical:"bottom",horizontal:"left"}})}):null,Object(x.jsx)(L.a,{style:{color:r.data.filebrowserobjs_aggregate.aggregate.count>0||null!==r.data.success?c.palette.text.primary:c.palette.text.secondary},children:null===r.data.parent_id?r.data.host:r.data.name_text}),!0===r.data.success&&r.data.depth>0?Object(x.jsx)(kt.a,{title:"Successfully listed contents of folder",children:Object(x.jsx)(Ga.a,{fontSize:"small",style:{color:c.palette.success.main}})}):!1===r.data.success&&r.data.depth>0?Object(x.jsx)(kt.a,{title:"Failed to list contents of folder",children:Object(x.jsx)(qo.a,{fontSize:"small",style:{color:c.palette.error.main}})}):null]})]})})},zo=function(e){var t=e.nodes,a=e.openNodes,n=e.onSelectNode,i=e.onExpandNode,r=e.onCollapseNode,c=e.display_name,s=Object(o.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 0===t||!0===a[e.id]?[{id:e.id,name:e[c],depth:t,isLeaf:!Array.isArray(e.children)||0===e.children.length,isOpen:!0,data:Object(v.a)(Object(v.a)({},e),{},{depth:t})}].concat(Object(y.a)(Object.values(e.children).reduce((function(e,a){return a.is_file?Object(y.a)(e):[].concat(Object(y.a)(e),[s(a,t+1)])}),[]).flat())):[{id:e.id,name:e[c],depth:t,isLeaf:!Array.isArray(e.children)||0===e.children.length,isOpen:!1,data:Object(v.a)(Object(v.a)({},e),{},{depth:t})}]}),[a]),l=Object(o.useMemo)((function(){return t.map((function(e){return s(e)})).flat()}),[s,t]);return Object(x.jsx)(ni.a,{children:function(e){return Object(x.jsx)(ai.a,{itemData:l,direction:"vertical",height:e.height-10,width:e.width-10,itemCount:l.length,itemSize:24,children:function(e){return Object(x.jsx)(Mo,Object(v.a)(Object(v.a)({},e),{},{onSelectNode:n,onExpandNode:i,onCollapseNode:r}))}})}})},Wo=function(e){var t=e.treeRoot,a=e.fetchFolderData,n=e.setTableData,i=s.a.useState({}),r=Object(u.a)(i,2),c=r[0],o=r[1];return 0===t.length?Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No File Browser Data Collected"}):Object(x.jsx)(zo,{nodes:t,display_name:"name_text",openNodes:c,onSelectNode:function(e,t){n(t.data),console.log("onSelectNode",e,t)},onExpandNode:function(e,t){console.log("toggleNodeExpanded",e,t),n(t.data),a(t.data),o(Object(v.a)(Object(v.a)({},c),{},Object(jt.a)({},e,!0)))},onCollapseNode:function(e,t){o(Object(v.a)(Object(v.a)({},c),{},Object(jt.a)({},e,!1)))}})};function Ho(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){i(e.value)}),[e.value]),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:e.title}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Download"}),Object(x.jsx)(C.a,{children:"Time"}),Object(x.jsx)(C.a,{children:"Task"}),Object(x.jsx)(C.a,{children:"Comment"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:e.complete?Object(x.jsx)(E.a,{href:"/api/v1.4/files/download/"+e.agent_file_id,style:{color:r.palette.success.main},children:Object(x.jsx)(oc.a,{})}):e.chunks_received+"/"+e.total_chunks}),Object(x.jsx)(C.a,{children:e.timestamp}),Object(x.jsx)(C.a,{children:e.task.id}),Object(x.jsx)(C.a,{children:e.comment})]},"hist"+e.id)}))})]})})})}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Uo=a(304),Go=a.n(Uo),Ko=a(194),Vo=a.n(Ko),Qo=a(305),Jo=a.n(Qo),Yo=(a(347),a(300)),Zo=a.n(Yo),Xo=a(139),es=a(172);function ts(e){var t=e.filterOptions,a=e.onSubmit,n=e.onClose,i=e.selectedColumn,r=Object(o.useState)(""),c=Object(u.a)(r,2),l=c[0],d=c[1],p=function(){a(Object(v.a)(Object(v.a)({},t),{},Object(jt.a)({},i.key,l))),n()};return s.a.useEffect((function(){t[i.key]&&d(t[i.key])}),[i]),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:["Filter ",i.name," Entries"]}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(j.a,{autoFocus:!0,onChange:function(e,t,a){d(t)},value:l,onEnter:p})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{variant:"contained",onClick:n,color:"primary",children:"Close"}),Object(x.jsx)(b.a,{variant:"contained",onClick:p,color:"secondary",children:"Submit"})]})]})}var as,ns,is,rs=Object(Se.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}}));function cs(e){var t=rs(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState([]),m=Object(u.a)(p,2),h=m[0],f=m[1],O=s.a.useState(""),g=Object(u.a)(O,2),v=g[0],_=g[1],k=s.a.useState(""),w=Object(u.a)(k,2),C=w[0],S=w[1],D=P(i,d),I=P(i,h);function $(t,a){return e.itemKey?t.filter((function(t){return void 0===a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1===a.indexOf(e)}))}function P(t,a){return e.itemKey?t.filter((function(t){return void 0!==a.find((function(a){return a[e.itemKey]===t[e.itemKey]}))})):t.filter((function(e){return-1!==a.indexOf(e)}))}var A=function(t){return function(){var a=-1;a=e.itemKey?i.findIndex((function(a){return a[e.itemKey]===t[e.itemKey]})):i.indexOf(t);var n=Object(y.a)(i);-1===a?n.push(t):n.splice(a,1),r(n)}};Object(o.useEffect)((function(){var t=e.left.reduce((function(t,a){return void 0===e.itemKey?e.right.includes(a)?Object(y.a)(t):[].concat(Object(y.a)(t),[a]):e.right.find((function(t){return t[e.itemKey]===a[e.itemKey]}))?Object(y.a)(t):[].concat(Object(y.a)(t),[a])}),[]);j(t),f(e.right),_(e.leftTitle),S(e.rightTitle)}),[e.left,e.right,e.leftTitle,e.rightTitle,e.itemKey]);var E=function(a,n){return Object(x.jsx)(T.a,{className:t.paper,style:{width:"100%",height:"calc(50vh)"},children:Object(x.jsxs)(Ie.a,{children:[Object(x.jsx)(ka.a,{className:t.cardHeader,title:a}),Object(x.jsx)(wa.a,{classes:{root:t.divider}}),Object(x.jsxs)(xa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[n.map((function(t){var a=void 0===e.itemKey?t:t[e.itemKey],n="transfer-list-item-".concat(a,"-label");return Object(x.jsxs)(ga.a,{style:{padding:0},role:"listitem",button:!0,onClick:A(t),children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(_a.a,{checked:void 0===e.itemKey?-1!==i.indexOf(a):-1!==i.findIndex((function(t){return t[e.itemKey]===a})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(x.jsx)(va.a,{id:n,primary:a})]},a)})),Object(x.jsx)(ga.a,{})]})]})})};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:e.dialogTitle}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsxs)(ft.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:t.root,children:[Object(x.jsx)(ft.a,{item:!0,xs:5,style:{paddingLeft:0,marginLeft:0},children:E(v,d)}),Object(x.jsx)(ft.a,{item:!0,children:Object(x.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(d)),j([])},disabled:0===d.length,"aria-label":"move all right",children:"\u226b"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){f(h.concat(D)),j($(d,D)),r($(i,D))},disabled:0===D.length,"aria-label":"move selected right",children:">"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(I)),f($(h,I)),r($(i,I))},disabled:0===I.length,"aria-label":"move selected left",children:"<"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){j(d.concat(h)),f([])},disabled:0===h.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(x.jsx)(ft.a,{item:!0,xs:5,children:E(C,h)})]})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){e.onSubmit({left:d,right:h}),e.onClose()},variant:"contained",color:"secondary",children:"Submit"})]})]})}var os,ss,ls,ds,us,bs=Object(be.a)(as||(as=Object(_.a)(["\n    query getPermissionsQuery($filebrowserobj_id: Int!) {\n        filebrowserobj_by_pk(id: $filebrowserobj_id) {\n            id\n            permissions\n        }\n    }\n"]))),js=Object(be.a)(ns||(ns=Object(_.a)(["\n    query getFileDownloadHistory($filebrowserobj_id: Int!) {\n        filebrowserobj_by_pk(id: $filebrowserobj_id) {\n            filemeta {\n                id\n                comment\n                agent_file_id\n                chunks_received\n                complete\n                total_chunks\n                timestamp\n                task {\n                    id\n                    comment\n                }\n            }\n        }\n    }\n"]))),ps=Object(be.a)(is||(is=Object(_.a)(["\n    mutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!) {\n        update_filebrowserobj_by_pk(pk_columns: { id: $filebrowserobj_id }, _set: { comment: $comment }) {\n            comment\n            id\n        }\n    }\n"]))),ms=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState({}),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState({}),f=Object(u.a)(h,2),g=f[0],_=f[1],k=s.a.useState({sortKey:null,sortDirection:null,sortType:null}),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState({visible:["Actions","Name","Size","Last Modified"],hidden:["Comment"]}),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState(!1),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useMemo((function(){return[{name:"Actions",width:100,disableAutosize:!0,disableSort:!0,disableFilterMenu:!0},{name:"Name",type:"string",key:"name_text",fillWidth:!0},{name:"Size",type:"number",key:"size",width:100},{name:"Last Modified",type:"date",key:"modify_time",width:220},{name:"Comment",type:"string",key:"comment",width:200}].reduce((function(e,t){return T.visible.includes(t.name)?p[t.key]&&String(p[t.key]).length>0?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{filtered:!0})]):[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[])}),[p,T]),N=s.a.useMemo((function(){if(null===C.sortKey||null===C.sortType)return n;var e=Object(y.a)(n);return"number"===C.sortType||"size"===C.sortType||"date"===C.sortType?e.sort((function(e,t){return parseInt(e[C.sortKey])>parseInt(t[C.sortKey])?1:-1})):"string"===C.sortType&&e.sort((function(e,t){return e[C.sortKey].toLowerCase()>t[C.sortKey].toLowerCase()?1:-1})),"DESC"===C.sortDirection&&e.reverse(),e}),[n,C]),q=s.a.useMemo((function(){return N.reduce((function(t,a){return function(e){for(var t=0,a=Object.entries(p);t<a.length;t++){var n=Object(u.a)(a[t],2),i=n[0],r=n[1];if(!String(e[i]).toLowerCase().includes(r))return!0}return!1}(a)?Object(y.a)(t):[].concat(Object(y.a)(t),[F.map((function(t){switch(t.name){case"Actions":return Object(x.jsx)(gs,{rowData:a,onTaskRowAction:e.onTaskRowAction});case"Name":return Object(x.jsx)(hs,{rowData:a,cellData:a.name_text});case"Size":return xs({cellData:a.size});case"Last Modified":return Os({cellData:a.modify_time});case"Comment":return fs({cellData:a.comment})}}))])}),[])}),[N,e.onTaskRowAction,p,T]);Object(o.useEffect)((function(){if(e.showDeletedFiles)i(Object(y.a)(e.selectedFolder));else{var t=e.selectedFolder.filter((function(e){return!e.deleted}));i(Object(y.a)(t))}}),[e.selectedFolder,e.showDeletedFiles]);var R=[{name:"Filter Column",click:function(e){e.event;var t=e.columnIndex;F[t].disableFilterMenu?O.b.warning("Can't filter that column"):(_(F[t]),d(!0))}},{name:"Show/Hide Columns",click:function(e){e.event;var t=e.columnIndex;F[t].disableFilterMenu?O.b.warning("Can't filter that column"):L(!0)}}],B=F.findIndex((function(e){return e.key===C.sortKey}));return Object(x.jsxs)("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[Object(x.jsx)(es.a,{columns:F,sortIndicatorIndex:B,sortDirection:C.sortDirection,items:q,rowHeight:35,onClickHeader:function(e,t){var a=F[t];a.disableSort||(a.key||S({sortKey:null,sortType:null,sortDirection:"ASC"}),C.sortKey===a.key?"ASC"===C.sortDirection?S(Object(v.a)(Object(v.a)({},C),{},{sortDirection:"DESC"})):S({sortKey:null,sortType:null,sortDirection:"ASC"}):S({sortKey:a.key,sortType:a.type,sortDirection:"ASC"}))},onDoubleClickRow:function(t,a){var i=n[a];i.is_file||(O.b.info("Fetching contents of folder..."),e.onRowDoubleClick(i),S({sortKey:null,sortType:null,sortDirection:"ASC"}))},contextMenuOptions:R}),l&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"xs",open:l,onClose:function(){d(!1)},innerDialog:Object(x.jsx)(ts,{selectedColumn:g,filterOptions:p,onSubmit:function(e){m(e)},onClose:function(){d(!1)}})}),E&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:E,onClose:function(){L(!1)},innerDialog:Object(x.jsx)(cs,{onClose:function(){L(!1)},onSubmit:function(e){var t=e.left,a=e.right;$({visible:a,hidden:t})},right:T.visible,rightTitle:"Show these columns",leftTitle:"Hidden Columns",left:T.hidden,dialogTitle:"Edit which columns are shown"})})]})},hs=function(e){var t=e.cellData,a=e.rowData,n=Object(ee.a)();return Object(x.jsxs)("div",{style:{alignItems:"center",display:"flex",textDecoration:a.deleted?"line-through":""},children:[a.is_file?Object(x.jsx)(Fo.a,{style:{marginRight:"5px"}}):Object(x.jsx)(Po.a,{style:{marginRight:"5px",color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.folderColor:"grey"}}),a.filemeta.length>0?Object(x.jsx)(oc.a,{style:{color:n.palette.success.main}}):null,Object(x.jsx)("pre",{style:{color:a.filebrowserobjs_aggregate.aggregate.count>0||null!==a.success?n.palette.text.primary:n.palette.text.secondary},children:t}),!0===a.success?Object(x.jsx)(kt.a,{title:"Successfully listed contents of folder",children:Object(x.jsx)(Ga.a,{fontSize:"small",style:{color:n.palette.success.main}})}):!1===a.success?Object(x.jsx)(kt.a,{title:"Failed to list contents of folder",children:Object(x.jsx)(qo.a,{fontSize:"small",style:{color:n.palette.error.main}})}):null]})},fs=function(e){return e.cellData},Os=function(e){var t=e.cellData;if(""===t||t<=0)return t;var a=new Date(parseInt(t)).toISOString();return a.slice(0,10)+" "+a.slice(11,-1)},xs=function(e){var t=e.cellData;return function(){try{var e=parseInt(t);if(""===t)return"";if(0===e)return"0 B";var a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}catch(n){return t}}()},gs=function(e){var t=e.rowData,a=e.onTaskRowAction,n=s.a.useRef(null),i=Object(ee.a)(),r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=s.a.useState(!1),f=Object(u.a)(h,2),g=f[0],y=f[1],_=s.a.useState(!1),k=Object(u.a)(_,2),w=k[0],C=k[1],S=s.a.useState(""),D=Object(u.a)(S,2),I=D[0],$=D[1],P=s.a.useState([]),A=Object(u.a)(P,2),E=A[0],L=A[1],F=Object(pt.a)(bs,{onCompleted:function(e){$(e.filebrowserobj_by_pk.permissions),""!==e.filebrowserobj_by_pk.permissions?y(!0):O.b.warning("No permission data available")},fetchPolicy:"network-only"}),N=Object(u.a)(F,1)[0],q=Object(pt.a)(js,{onCompleted:function(e){0===e.filebrowserobj_by_pk.filemeta.length?O.b.warning("File has no download history"):(L(e.filebrowserobj_by_pk.filemeta),C(!0))},fetchPolicy:"network-only"}),R=Object(u.a)(q,1)[0],B=Object(pe.a)(ps,{onCompleted:function(e){O.b.success("updated comment")}}),z=Object(u.a)(B,1)[0],W=function(e,t,a){switch(e){case"A":U[a].click(t);break;case"B":G[a].click(t)}l(!1)},H=function(e){n.current&&n.current.contains(e.target)||l(!1)},U=[{name:"View Permissions",icon:Object(x.jsx)(Vo.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),N({variables:{filebrowserobj_id:t.id}})}},{name:"Download History",icon:Object(x.jsx)(Go.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),R({variables:{filebrowserobj_id:t.id}})}},{name:"Edit Comment",icon:Object(x.jsx)(ki.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),m(!0)}},{name:"Copy Path to Clipboard",icon:Object(x.jsx)(Zo.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),Object(Xo.a)(t.full_path_text)?O.b.success("Copied text!"):O.b.error("Failed to copy text")}}],G=[{name:"Task File Listing",icon:Object(x.jsx)(Jo.a,{style:{paddingRight:"5px",color:i.palette.warning.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:list"})}},{name:"Task Download",icon:Object(x.jsx)(oc.a,{style:{paddingRight:"5px",color:i.palette.success.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:download"})}},{name:"Task File Removal",icon:Object(x.jsx)(M.a,{style:{paddingRight:"5px",color:i.palette.error.main}}),click:function(e){e.stopPropagation(),a({path:t.parent_path_text,host:t.host,filename:t.name_text,uifeature:"file_browser:remove",getConfirmation:!0})}}];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(b.a,{style:{},size:"small","aria-controls":o?"split-button-menu":void 0,"aria-expanded":o?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),l((function(e){return!e}))},color:"primary",variant:"contained",ref:n,children:"Actions"}),Object(x.jsx)(tt.a,{open:o,anchorEl:n.current,role:void 0,transition:!0,style:{zIndex:4e3},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===i.palette.type?i.palette.primary.dark:i.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:H,children:Object(x.jsxs)(nt.a,{id:"split-button-menu",children:[U.map((function(e,t){return Object(x.jsxs)(at.a,{onClick:function(e){return W("A",e,t)},children:[e.icon,e.name]},e.name)})),Object(x.jsx)(wa.a,{}),G.map((function(e,t){return Object(x.jsxs)(at.a,{onClick:function(e){return W("B",e,t)},children:[e.icon,e.name]},e.name)}))]})})})}))}}),p&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit File Browser Comment",onSubmit:function(e){z({variables:{filebrowserobj_id:t.id,comment:e}})},value:t.comment,onClose:function(){m(!1)}})}),g&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:g,onClose:function(){y(!1)},innerDialog:Object(x.jsx)(Y.c,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:I,onClose:function(){y(!1)}})}),w&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:w,onClose:function(){C(!1)},innerDialog:Object(x.jsx)(Ho,{title:"Download History",value:E,onClose:function(){C(!1)}})})]})},ys=a(240),vs=a.n(ys),_s=a(319),ks=a(132),ws=Object(be.a)(os||(os=Object(_.a)(["\n    fragment fileObjData on filebrowserobj {\n        access_time\n        comment\n        deleted\n        filemeta {\n            id\n        }\n        host\n        id\n        is_file\n        modify_time\n        parent_id\n        size\n        success\n        task {\n            callback {\n                id\n            }\n            operator {\n                id\n            }\n        }\n        full_path_text\n        name_text\n        timestamp\n        parent_path_text\n        filebrowserobjs_aggregate {\n            aggregate {\n                count\n            }\n        }\n    }\n"]))),Cs=Object(be.a)(ss||(ss=Object(_.a)(["\n    ","\n    query myRootFolderQuery($operation_id: Int!) {\n        filebrowserobj(where: { operation_id: { _eq: $operation_id }, parent_id: { _is_null: true } }) {\n            ...fileObjData\n        }\n    }\n"])),ws),Ss=Object(be.a)(ls||(ls=Object(_.a)(["\n    ","\n    query myFolderQuery($filebrowserobj_id: Int!, $operation_id: Int!) {\n        filebrowserobj(\n            where: { parent_id: { _eq: $filebrowserobj_id }, operation_id: { _eq: $operation_id } }\n            order_by: { is_file: asc, name: asc }\n        ) {\n            ...fileObjData\n        }\n    }\n"])),ws),Ds=Object(be.a)(ds||(ds=Object(_.a)(["\n    ","\n    subscription liveData($now: timestamp!, $operation_id: Int!) {\n        filebrowserobj(\n            distinct_on: id\n            order_by: { id: desc }\n            where: { timestamp: { _gt: $now }, operation_id: { _eq: $operation_id } }\n            limit: 1\n        ) {\n            ...fileObjData\n        }\n    }\n"])),ws),Is=Object(be.a)(us||(us=Object(_.a)(["\n    ","\n    query myDeltaFilesQuery($lastTime: timestamp!, $now: timestamp!, $operation_id: Int!) {\n        filebrowserobj(\n            distinct_on: id\n            order_by: { id: desc }\n            where: {\n                _and: [{ timestamp: { _gte: $lastTime } }, { timestamp: { _lte: $now } }]\n                operation_id: { _eq: $operation_id }\n            }\n        ) {\n            ...fileObjData\n        }\n    }\n"])),ws);function Ts(e){var t=s.a.useState("File Browser: "+e.tabInfo.callbackID),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1];Object(o.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("File Browser: "+e.tabInfo.callbackID)}),[e.tabInfo.payloadDescription,e.tabInfo.customDescription]);return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(yo.b,Object(v.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),d(!0)}},e)),l&&Object(x.jsx)(Y.a,{fullWidth:!0,open:l,onClose:function(){d(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Tab's Description",onClose:function(){d(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var $s,Ps,As,Es,Ls,Fs,Ns,qs=function(e){var t,a,n,i,r=e.index,c=e.value,l=e.tabInfo,d=Object(f.a)(h.b),b=s.a.useRef([]),j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],g=p[1],_=s.a.useState([]),k=Object(u.a)(_,2),w=k[0],C=k[1],S=s.a.useState([]),D=Object(u.a)(S,2),I=D[0],T=D[1],$=s.a.useRef({}),P=s.a.useState({task:{callback:{id:l.callbackID}},host:l.host,full_path_text:"."}),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useRef(),N=s.a.useRef((new Date).toISOString()),q=s.a.useState(!1),R=Object(u.a)(q,2),B=R[0],M=R[1],z=s.a.useState(!1),W=Object(u.a)(z,2),H=W[0],U=W[1],G=s.a.useRef({parameters:"",ui_feature:"file_browser:list"}),K=s.a.useRef(!0),V=Object(je.a)(Cs,{variables:{operation_id:d.user.current_operation_id},onCompleted:function(e){var t=e.filebrowserobj.reduce((function(e,t){for(var a=0;a<e.length;a++)if(e[a].host===t.host)return e[a].children?e[a].children.push(Object(v.a)(Object(v.a)({},t),{},{parent_id:t.host,children:[]})):e[a].children=[Object(v.a)(Object(v.a)({},t),{},{parent_id:t.host,children:[]})],Object(y.a)(e);return[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{id:t.host,children:[Object(v.a)(Object(v.a)({},t),{},{parent_id:t.host,children:[]})]})])}),[]);C(t)},fetchPolicy:"network-only"}),Q=V.subscribeToMore,J=(V.loading,Object(pt.a)(Is,{onCompleted:function(e){var t=Object(y.a)(b.current);e.filebrowserobj.forEach((function(e){var a=!1;if(null===e.parent_id){var n=!1;t.forEach((function(t){t.host===e.host&&(n=!0,t.children.forEach((function(t){t.name_text===e.name_text&&(a=!0,t.comment=e.comment,t.success=e.success,t.deleted=e.deleted,t.filemeta=e.filemeta)})))})),n?n&&!a&&(a=!0,t.forEach((function(t){t.host===e.host&&t.children.push(Object(v.a)(Object(v.a)({},e),{},{parent_id:e.host,children:[]}))}))):a=!1}else t.forEach((function(t){t.host===e.host&&(a=!0,ee(t,e.parent_id,[e]))}));a||null!==e.parent_id||t.push(Object(v.a)(Object(v.a)({},e),{},{id:e.host,children:[Object(v.a)(Object(v.a)({},e),{},{parent_id:e.host,children:[]})]}))})),C(t),e.filebrowserobj.length>0&&void 0!==$.current.id&&(e.filebrowserobj[0].parent_id===$.current.id||$.current.host===e.filebrowserobj[0].host)&&T(Object.values($.current.children))},onError:function(e){console.log(e)}})),Y=Object(u.a)(J,1)[0];Object(o.useEffect)((function(){b.current=w}),[w]),Object(o.useEffect)((function(){$.current=E}),[E]);var Z=Object(pt.a)(Ss,{onError:function(e){console.error(e)},fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:function(e){var t=!1;if(0===e.filebrowserobj.length)return O.b.dismiss(),null===E.success?O.b.info("Folder hasn't been listed yet"):O.b.info("Empty folder"),T(Object.values(E.children)),void g(!1);O.b.dismiss(),O.b.success("Fetched data");var a=w.map((function(a){if(e.filebrowserobj[0].host===a.host){var n=Object(v.a)({},a);return t=!0,ee(n,e.filebrowserobj[0].parent_id,e.filebrowserobj),n}return Object(v.a)({},a)}));t||(a.push(e.filebrowserobj[0]),ee(e.filebrowserobj[0],e.filebrowserobj[0].parent_id,e.filebrowserobj)),C(a),T(Object.values(E.children)),g(!1)}}),X=Object(u.a)(Z,1)[0],ee=Object(o.useCallback)((function(e,t,a){if(t===e.id){for(var n=0;n<a.length;n++)void 0===e.children[a[n].id]?e.children[a[n].id]=Object(v.a)(Object(v.a)({},a[n]),{},{children:{}}):e.children[a[n].id]=Object(v.a)(Object(v.a)({},a[n]),{},{children:e.children[a[n].id].children});return!0}for(var i=0,r=Object.entries(e.children);i<r.length;i++){var c=Object(u.a)(r[i],2),o=(c[0],c[1]);if(a[0].parent_path_text.startsWith(o.full_path_text))if(ee(o,t,a))return!0}return!1}),[]),te=Object(o.useCallback)((function(e){T(Object.values(e.children)),L(e)}),[]),ae=Object(o.useCallback)((function(e){X({variables:{filebrowserobj_id:e.id,operation_id:d.user.current_operation_id}}),g(!0),L(e)}),[]),ne=Object(o.useCallback)((function(e){var t=e.path,a=e.host,n=e.filename,i=e.uifeature,r=e.openDialog,c=e.getConfirmation;G.current={parameters:{host:a,path:t,file:n},ui_feature:i,openDialog:r,getConfirmation:c},U(!0)}),[]),ie=Object(o.useCallback)((function(e,t){var a=t.subscriptionData;if(K.current)return a.data.filebrowserobj.length>0?(Y({variables:{operation_id:d.user.current_operation_id,now:(new Date).toISOString(),lastTime:N.current}}),void(null!==a.data.filebrowserobj[0]&&void 0!==a.data.filebrowserobj[0]&&(N.current=a.data.filebrowserobj[0].timestamp))):void 0}),[ee]);return s.a.useEffect((function(){return function(){K.current=!1}}),[]),Object(x.jsxs)(yo.c,{index:r,value:c,children:[Object(x.jsxs)("div",{style:{display:"flex",flexGrow:1,overflowY:"auto"},children:[Object(x.jsxs)("div",{style:{width:"30%",overflow:"auto",flexGrow:1},children:[Object(x.jsx)(_s.a,{open:m,style:{zIndex:2,position:"absolute"},invisible:!0,children:Object(x.jsx)(oa.a,{color:"inherit"})}),Object(x.jsx)(Wo,{showDeletedFiles:B,treeRoot:w,fetchFolderData:ae,setTableData:te})]}),Object(x.jsxs)("div",{style:{width:"60%",display:"flex",flexDirection:"column",flexGrow:1},children:[Object(x.jsx)("div",{style:{flexGrow:0},children:Object(x.jsx)(Rs,{selectedFolderData:E,onListFilesButton:function(e){var t=e.fullPath,a=e.hostname;G.current={parameters:{path:t,host:a,file:""},ui_feature:"file_browser:list"},U(!0)},onUploadFileButton:function(e){var t=e.hostname,a=e.fullPath;G.current={parameters:{path:a,host:t},ui_feature:"file_browser:upload",openDialog:!0},U(!0)},onChangeCallbackID:function(e){F.current=e},toggleShowDeletedFiles:function(e){M(e)},initialCallbackID:l.callbackID,subscribeToNewFileBrowserObjs:function(){var e;Q({document:Ds,variables:{now:(new Date).toISOString(),operation_id:(null===d||void 0===d||null===(e=d.user)||void 0===e?void 0:e.current_operation_id)||0},updateQuery:ie})}})}),Object(x.jsxs)("div",{style:{flexGrow:1},children:[Object(x.jsx)(_s.a,{open:m,style:{zIndex:2,position:"absolute"},invisible:!0,children:Object(x.jsx)(oa.a,{color:"inherit"})}),Object(x.jsx)(ms,{showDeletedFiles:B,onRowDoubleClick:ae,selectedFolder:I,onTaskRowAction:ne})]})]})]}),H&&Object(x.jsx)(ks.a,{ui_feature:(null===(t=G.current)||void 0===t?void 0:t.ui_feature)||" ",callback_id:F.current,parameters:(null===(a=G.current)||void 0===a?void 0:a.parameters)||"",tasking_location:"file_browser",openDialog:(null===(n=G.current)||void 0===n?void 0:n.openDialog)||!1,getConfirmation:(null===(i=G.current)||void 0===i?void 0:i.getConfirmation)||!1,onTasked:function(){return U(!1)}})]})},Rs=function(e){var t=e.selectedFolderData,a=e.onListFilesButton,n=e.initialCallbackID,i=e.onUploadFileButton,r=e.onChangeCallbackID,c=e.subscribeToNewFileBrowserObjs,l=e.toggleShowDeletedFiles,d=Object(ee.a)(),b=s.a.useState(""),p=Object(u.a)(b,2),m=p[0],h=p[1],f=s.a.useState(""),g=Object(u.a)(f,2),y=g[0],v=g[1],_=s.a.useState(n),k=Object(u.a)(_,2),w=k[0],C=k[1],S=s.a.useState(!1),D=Object(u.a)(S,2),I=D[0],T=D[1],$=s.a.useState(!0),P=Object(u.a)($,2),A=P[0],L=P[1];Object(o.useEffect)((function(){void 0!==t.host&&h(t.host),void 0!==t.full_path_text&&v(t.full_path_text),A||void 0!==t.task&&C(t.task.callback.id)}),[t,A]);var F=function(){""!==y?w>0?a({callbackID:w,fullPath:y,hostname:m}):O.b.warning("Must select a folder or set a callback number first"):O.b.warning("Must provide a path to list")};Object(o.useEffect)((function(){r(w)}),[w]),Object(o.useEffect)((function(){c()}),[]);return Object(x.jsxs)(ft.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(x.jsx)(ft.a,{item:!0,xs:4,children:Object(x.jsx)(j.a,{placeholder:"Host Name",value:m,onChange:function(e,t){h(t)},name:"Host Name"})}),Object(x.jsx)(ft.a,{item:!0,xs:7,children:Object(x.jsx)(j.a,{placeholder:"Path",value:y,onEnter:F,onChange:function(e,t){v(t)},name:"Path",InputProps:{endAdornment:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(kt.a,{title:"Task callback to list contents",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:F,children:Object(x.jsx)(wo.a,{style:{color:d.palette.info.main}})})}),Object(x.jsx)(kt.a,{title:"Upload file to folder via callback",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){w>0?i({fullPath:y,hostname:m}):O.b.warning("Must select a folder or set a callback number first")},children:Object(x.jsx)(_o.a,{style:{color:d.palette.info.main}})})}),Object(x.jsx)(kt.a,{title:I?"Hide Deleted Files":"Show Deleted Files",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){T(!I),l(!I)},children:I?Object(x.jsx)(Vo.a,{style:{color:d.palette.info.main}}):Object(x.jsx)(vs.a,{style:{color:d.palette.info.main}})})})]}),style:{padding:0}}})}),Object(x.jsx)(ft.a,{item:!0,xs:1,children:Object(x.jsx)(j.a,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t){L(!0),C(parseInt(t))},value:w,InputProps:{endAdornment:A?Object(x.jsx)(kt.a,{title:"Change Callback Based on Data Origin",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){L(!1),t.task?C(t.task.callback.id):(C(0),r(0))},children:Object(x.jsx)(Mc.a,{style:{color:d.palette.info.main}})})}):Object(x.jsx)(kt.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(x.jsx)(E.a,{style:{padding:"3px"},children:Object(x.jsx)(So.a,{disabled:!0,style:{color:d.palette.warning.main}})})}),style:{padding:0,margin:0}}})})]})},Bs=a(297),Ms=a.n(Bs),zs=["onSelectNode","onExpandNode","onCollapseNode"],Ws=function(e){e.onSelectNode;var t=e.onExpandNode,a=e.onCollapseNode,n=Object(ho.a)(e,zs),i=n.data[n.index],r=Object(ee.a)(),c=function(e){e.stopPropagation(),i.isOpen?a(i.id,i):t(i.id,i)};return Object(x.jsx)("div",{style:n.style,children:Object(x.jsxs)("div",{style:{display:"flex",marginBottom:"2px",flexGrow:1},children:[Object(y.a)(Array(i.data.depth)).map((function(e,t){return Object(x.jsx)("div",{style:{borderLeft:"2px dashed ".concat(Object(Do.c)(r.palette.text.primary,.4)),marginLeft:15,paddingRight:15,display:"inline-block"}},"folder"+i.data.id+"lines"+t)})),0===i.data.children.length?Object(x.jsx)(Fo.a,{style:{marginLeft:"3px"}}):i.isOpen?Object(x.jsx)(N.a,{style:{marginLeft:"3px"},onClick:c}):Object(x.jsx)(Ms.a,{style:{marginLeft:"3px"},onClick:c}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},component:"pre",children:[i.data.process_id," - ",i.data.name]})]})})},Hs=function(e){var t=e.nodes,a=e.openNodes,n=e.onSelectNode,i=e.onExpandNode,r=e.onCollapseNode,c=e.display_name,s=Object(o.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!0===a[e.id]?[{id:e.id,name:e[c],depth:t,isLeaf:!Array.isArray(e.children)||0===e.children.length,isOpen:!0,data:Object(v.a)(Object(v.a)({},e),{},{depth:t})}].concat(Object(y.a)(Object.values(e.children).reduce((function(e,a){return a.is_file?Object(y.a)(e):[].concat(Object(y.a)(e),[s(a,t+1)])}),[]).flat())):[{id:e.id,name:e[c],depth:t,isLeaf:!Array.isArray(e.children)||0===e.children.length,isOpen:!1,data:Object(v.a)(Object(v.a)({},e),{},{depth:t})}]}),[a]),l=Object(o.useMemo)((function(){return t.map((function(e){return s(e)})).flat()}),[s,t]);return Object(x.jsx)(ni.a,{children:function(e){return Object(x.jsx)(ai.a,{itemData:l,direction:"vertical",height:e.height-10,width:e.width-10,itemCount:l.length,itemSize:24,children:function(e){return Object(x.jsx)(Ws,Object(v.a)(Object(v.a)({},e),{},{onSelectNode:n,onExpandNode:i,onCollapseNode:r}))}})}})},Us=function(e){var t=e.treeRoot,a=s.a.useState({}),n=Object(u.a)(a,2),i=n[0],r=n[1];return s.a.useEffect((function(){var e={},a=function t(a){var n;e[a.id]=!0,null===a||void 0===a||null===(n=a.children)||void 0===n||n.forEach((function(e){return t(e)}))};t.forEach((function(e){return a(e)})),r(e)}),[t]),0===t.length?Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Process Listing Data"}):Object(x.jsx)(Hs,{nodes:t,display_name:"name",openNodes:i,onSelectNode:function(e,t){console.log("onSelectNode",e,t)},onExpandNode:function(e,t){r(Object(v.a)(Object(v.a)({},i),{},Object(jt.a)({},e,!0)))},onCollapseNode:function(e,t){r(Object(v.a)(Object(v.a)({},i),{},Object(jt.a)({},e,!1)))}})},Gs=Object(be.a)($s||($s=Object(_.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        command_line\n        description\n        signer\n        start_time\n        name\n        bin_path\n    }\n}\n"]))),Ks=Object(be.a)(Ps||(Ps=Object(_.a)(["\nquery getDetailed($process_id: Int!){\n    process_by_pk(id: $process_id){\n        id\n        tokens(where: {deleted: {_eq: false}}) {\n            Address\n            AppContainer\n            AppContainerNumber\n            AppContainerSid\n            AppId\n            AppModelPolicies\n            AppModelPolicyDictionary\n            AttributesFlags\n            AuditPolicy\n            AuthenticationId_id\n            BnoIsolationPrefix\n            CanSynchronize\n            Capabilities\n            CreationTime\n            DefaultDacl\n            DenyOnlyGroups\n            DeviceClaimAttributes\n            DeviceGroups\n            Elevated\n            ElevationType\n            EnabledGroups\n            ExpirationTime\n            Filtered\n            Flags\n            FullPath\n            GrantedAccess\n            GrantedAccessGeneric\n            GrantedAccessMask\n            GroupCount\n            Groups\n            Handle\n            HandleReferenceCount\n            HasRestrictions\n            ImpersonationLevel\n            Inherit\n            IntegrityLevel\n            IntegrityLevelSid\n            IsClosed\n            IsContainer\n            IsPseudoToken\n            IsRestricted\n            IsSandbox\n            LogonSid\n            LowPrivilegeAppContainer\n            MandatoryPolicy\n            ModifiedId\n            Name\n            NoChildProcess\n            NotLow\n            NtType\n            NtTypeName\n            Owner\n            Origin\n            PackageFullName\n            PackageIdentity\n            PackageName\n            PointerReferenceCount\n            PrimaryGroup\n            PrivateNamespace\n            Privileges\n            ProcessUniqueAttribute\n            ProtectFromClose\n            Restricted\n            RestrictedDeviceClaimAttributes\n            RestrictedDeviceGroups\n            RestrictedSids\n            RestrictedSidsCount\n            RestrictedUserClaimAttributes\n            SandboxInert\n            Sddl\n            SecurityAttributes\n            SecurityDescriptor\n            SessionId\n            Source\n            ThreadID\n            TokenId\n            TokenType\n            TrustLevel\n            UIAccess\n            User\n            UserClaimAttributes\n            VirtualizationAllowed\n            VirtualizationEnabled\n            WriteRestricted\n            callbacktokens {\n                callback_id\n            }\n            logonsession {\n                id\n            }\n            task_id\n            timestamp_created\n        }\n    }\n}\n"]))),Vs=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState({sortKey:null,sortDirection:null,sortType:null}),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState({}),f=Object(u.a)(h,2),g=f[0],_=f[1],k=s.a.useState({}),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState({visible:["Actions","PPID","PID","Arch","Name","User"],hidden:["Path"]}),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState(!1),A=Object(u.a)(P,2),E=A[0],L=A[1],F=s.a.useMemo((function(){return[{name:"Actions",width:100,disableAutosize:!0,disableSort:!0,disableFilterMenu:!0},{name:"PPID",type:"number",key:"parent_process_id",width:75},{name:"PID",type:"number",key:"process_id",width:75},{name:"Arch",type:"string",key:"architecture",width:75},{name:"Name",type:"string",key:"name",fillWidth:!0},{name:"User",type:"string",key:"user",fillWidth:!0},{name:"Path",type:"string",key:"bin_path",width:200}].reduce((function(e,t){return T.visible.includes(t.name)?g[t.key]&&String(g[t.key]).length>0?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{filtered:!0})]):[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[])}),[g,T]);Object(o.useEffect)((function(){i(Object(y.a)(e.selectedFolder))}),[e.selectedFolder]);var N=s.a.useMemo((function(){if(null===l.sortKey||null===l.sortType)return n;var e=Object(y.a)(n);return"number"===l.sortType||"size"===l.sortType||"date"===l.sortType?e.sort((function(e,t){return parseInt(e[l.sortKey])>parseInt(t[l.sortKey])?1:-1})):"string"===l.sortType&&e.sort((function(e,t){return e[l.sortKey].toLowerCase()>t[l.sortKey].toLowerCase()?1:-1})),"DESC"===l.sortDirection&&e.reverse(),e}),[n,l]),q=s.a.useMemo((function(){return N.reduce((function(t,a){return function(e){for(var t=0,a=Object.entries(g);t<a.length;t++){var n=Object(u.a)(a[t],2),i=n[0],r=n[1];if(!String(e[i]).toLowerCase().includes(r))return!0}return!1}(a)?Object(y.a)(t):[].concat(Object(y.a)(t),[F.map((function(t){switch(t.name){case"Actions":return Object(x.jsx)(Js,{rowData:a,onTaskRowAction:e.onTaskRowAction});case"PPID":return Object(x.jsx)(Qs,{rowData:a,cellData:a.parent_process_id});case"PID":return Object(x.jsx)(Qs,{rowData:a,cellData:a.process_id});case"Arch":return Object(x.jsx)(Qs,{rowData:a,cellData:a.architecture});case"Name":return Object(x.jsx)(Qs,{rowData:a,cellData:a.name});case"User":return Object(x.jsx)(Qs,{rowData:a,cellData:a.user});case"Path":return Object(x.jsx)(Qs,{rowData:a,cellData:a.bin_path})}}))])}),[])}),[N,e.onTaskRowAction,g,T]),R=s.a.useCallback((function(){}),[]),B=[{name:"Filter Column",click:function(e){e.event;var t=e.columnIndex;F[t].disableFilterMenu?O.b.warning("Can't filter that column"):(S(F[t]),m(!0))}},{name:"Show/Hide Columns",click:function(e){e.event;var t=e.columnIndex;F[t].disableFilterMenu?O.b.warning("Can't filter that column"):L(!0)}}],M=F.findIndex((function(e){return e.key===l.sortKey}));return Object(x.jsxs)("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[Object(x.jsx)(es.a,{columns:F,sortIndicatorIndex:M,sortDirection:l.sortDirection,items:q,rowHeight:35,onClickHeader:function(e,t){var a=F[t];a.disableSort||(a.key||d({sortKey:null,sortType:null,sortDirection:"ASC"}),l.sortKey===a.key?"ASC"===l.sortDirection?d(Object(v.a)(Object(v.a)({},l),{},{sortDirection:"DESC"})):d({sortKey:null,sortType:null,sortDirection:"ASC"}):d({sortKey:a.key,sortType:a.type,sortDirection:"ASC"}))},onDoubleClickRow:R,contextMenuOptions:B}),p&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"xs",open:p,onClose:function(){m(!1)},innerDialog:Object(x.jsx)(ts,{selectedColumn:C,filterOptions:g,onSubmit:function(e){_(e)},onClose:function(){m(!1)}})}),E&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:E,onClose:function(){L(!1)},innerDialog:Object(x.jsx)(cs,{onClose:function(){L(!1)},onSubmit:function(e){var t=e.left,a=e.right;$({visible:a,hidden:t})},right:T.visible,rightTitle:"Show these columns",leftTitle:"Hidden Columns",left:T.hidden,dialogTitle:"Edit which columns are shown"})})]})},Qs=function(e){var t=e.cellData;return Object(x.jsx)("div",{children:t})},Js=function(e){var t=e.rowData,a=e.onTaskRowAction,n=e.os,i=s.a.useRef(null),r=Object(ee.a)(),c=s.a.useState(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=s.a.useState(!1),g=Object(u.a)(f,2),y=(g[0],g[1],s.a.useState({})),_=Object(u.a)(y,2),k=_[0],w=_[1],C=s.a.useState({}),S=Object(u.a)(C,2),D=(S[0],S[1]),I=Object(pt.a)(Gs,{onCompleted:function(e){w(e.process_by_pk),h(!0)},fetchPolicy:"network-only"}),$=Object(u.a)(I,1)[0],P=Object(pt.a)(Ks,{onCompleted:function(e){0===e.process_by_pk.tokens.length?O.b.warning("No Token Data for Process"):(D(e.process_by_pk.tokens),h(!0))},fetchPolicy:"network-only"}),A=Object(u.a)(P,1)[0],E=function(e,t,a){switch(e){case"A":F[a].click(t);break;case"B":N[a].click(t)}d(!1)},L=function(e){i.current&&i.current.contains(e.target)||d(!1)},F=[{name:"View Detailed Data",icon:Object(x.jsx)(Vo.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),$({variables:{process_id:t.id}})}},{name:"View Tokens",icon:Object(x.jsx)(Vo.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),A({variables:{process_id:t.id}})},os:["Windows"]}],N=[{name:"Task Token Listing",icon:Object(x.jsx)(Jo.a,{style:{paddingRight:"5px",color:r.palette.warning.main}}),click:function(e){e.stopPropagation(),a({process_id:t.process_id,architecture:t.architecture,uifeature:"process_browser:list_tokens"})},os:["Windows"]},{name:"Task Inject",icon:Object(x.jsx)(oc.a,{style:{paddingRight:"5px",color:r.palette.success.main}}),click:function(e){e.stopPropagation(),console.log(t),a({process_id:t.process_id,architecture:t.architecture,uifeature:"process_browser:inject"})}},{name:"Task Steal Token",icon:Object(x.jsx)(M.a,{style:{paddingRight:"5px",color:r.palette.error.main}}),click:function(e){e.stopPropagation(),a({process_id:t.process_id,architecture:t.architecture,uifeature:"process_browser:steal_token"})},os:["Windows"]},{name:"Task Kill Process",icon:Object(x.jsx)(M.a,{style:{paddingRight:"5px",color:r.palette.error.main}}),click:function(e){e.stopPropagation(),a({process_id:t.process_id,architecture:t.architecture,uifeature:"process_browser:kill"})}}];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(b.a,{size:"small","aria-controls":l?"split-button-menu":void 0,"aria-expanded":l?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),d((function(e){return!e}))},color:"primary",variant:"contained",ref:i,children:"Actions"}),Object(x.jsx)(tt.a,{open:l,anchorEl:i.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:L,children:Object(x.jsxs)(nt.a,{id:"split-button-menu",children:[F.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(x.jsxs)(at.a,{onClick:function(e){return E("A",e,t)},children:[e.icon,e.name]},e.name):null})),Object(x.jsx)(wa.a,{}),N.map((function(e,t){return void 0===e.os||e.os.includes(n)?Object(x.jsxs)(at.a,{onClick:function(e){return E("B",e,t)},children:[e.icon,e.name]},e.name):null}))]})})})}))}}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){h(!1)},innerDialog:Object(x.jsx)(Y.d,{title:"View Detailed Data",leftColumn:"Attribute",rightColumn:"Value",value:k,onClose:function(){h(!1)},keys:["name","bin_path","signer","command_line","start_time","description"]})})]})},Ys=a(500),Zs=a.n(Ys),Xs=a(499),el=a.n(Xs),tl=a(501),al=a.n(tl),nl=Object(be.a)(As||(As=Object(_.a)(["\nfragment objData on process {\n    name\n    process_id\n    parent_process_id\n    architecture\n    bin_path\n    integrity_level\n    id\n    user\n}\n"]))),il=Object(be.a)(Es||(Es=Object(_.a)(["\nfragment taskDataProcess on task {\n    id\n    callback {\n        id\n        host\n        payload {\n            id\n            os\n            payloadtype{\n                ptype\n            }\n        }\n    }\n}\n"]))),rl=Object(be.a)(Ls||(Ls=Object(_.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_gt: $task_id}}, order_by: {task_id: asc}, limit: 1) {\n        task {\n            ...taskDataProcess\n            processes(order_by: {process_id: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),nl,il),cl=Object(be.a)(Fs||(Fs=Object(_.a)(["\n","\n","\nquery getHostProcessesQuery($operation_id: Int!, $host: String!, $task_id: Int!) {\n    process(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}, task_id: {_lt: $task_id}}, order_by: {task_id: desc}, limit: 1) {\n        task {\n            ...taskDataProcess\n            processes(order_by: {name: asc}) {\n                ...objData\n            }\n        }\n    }\n  }\n"])),nl,il),ol=Object(be.a)(Ns||(Ns=Object(_.a)(["\nquery getHostsQuery($operation_id: Int!, $host:String!){\n    process_aggregate(where: {operation_id: {_eq: $operation_id}, host: {_eq: $host}}, distinct_on: task_id){\n        aggregate {\n            max {\n              task_id\n            }\n        }\n    }\n}\n"])));function sl(e){var t=s.a.useState("Processes: "+e.tabInfo.host),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),l=c[0],d=c[1];Object(o.useEffect)((function(){""!==e.tabInfo.customDescription&&void 0!==e.tabInfo.customDescription?i(e.tabInfo.customDescription):i("Processes: "+e.tabInfo.host)}),[e.tabInfo.customDescription]);return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(yo.b,Object(v.a)({label:n,onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),d(!0)}},e)),l&&Object(x.jsx)(Y.a,{fullWidth:!0,open:l,onClose:function(){d(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Tab's Description",onClose:function(){d(!1)},value:n,onSubmit:function(t){e.onEditTabDescription(e.tabInfo,t)}})})]})}var ll=function(e){var t,a,n,i=e.index,r=e.value,c=e.tabInfo,l=Object(f.a)(h.b),d=s.a.useRef([]),b=s.a.useState([]),j=Object(u.a)(b,2),p=j[0],m=j[1],g=s.a.useState([]),_=Object(u.a)(g,2),k=_[0],w=_[1],C=s.a.useState({}),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useRef(),$=s.a.useState(""),P=Object(u.a)($,2),A=P[0],E=P[1],L=s.a.useState(!1),F=Object(u.a)(L,2),N=F[0],q=F[1],R=s.a.useRef({parameters:"",ui_feature:"process_browser:list"}),B=function e(t,a){if(t.process_id===a.parent_process_id)return t.children.push(Object(v.a)(Object(v.a)({},a),{},{children:[]})),!0;for(var n=0;n<t.children.length;n++)if(e(t.children[n],a))return!0;return!1},M=Object(pt.a)(rl,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{children:[]})]);var a=Object(y.a)(e).map((function(e){return B(e,t),Object(v.a)({},e)}));return Object(y.a)(a)}),[]);m(t),w(e.process[0].task.processes),E(e.process[0].task.callback.payload.os),I(e.process[0].task),O.b.dismiss(),O.b.success("Successfully fetched process data")}else O.b.dismiss(),O.b.warning("No Newer Process Sets")}}),z=Object(u.a)(M,1)[0],W=Object(pt.a)(cl,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){if(e.process.length>0){var t=e.process[0].task.processes.reduce((function(e,t){if(null===t.parent_process_id||t.parent_process_id<=0)return[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{children:[]})]);var a=Object(y.a)(e).map((function(e){return B(e,t),Object(v.a)({},e)}));return Object(y.a)(a)}),[]);m(t),w(e.process[0].task.processes),E(e.process[0].task.callback.payload.os),I(e.process[0].task),O.b.dismiss(),O.b.success("Successfully fetched process data")}else O.b.dismiss(),O.b.warning("No Earlier Process Sets")}}),H=Object(u.a)(W,1)[0];Object(je.a)(ol,{variables:{operation_id:l.user.current_operation_id,host:c.host},onCompleted:function(e){null===e.process_aggregate.aggregate.max.task_id?(O.b.warning("No Process Data for "+c.host),I({callback:{host:c.host,id:c.callbackID},id:0})):(O.b.info("Fetching latest process data for "+c.host),z({variables:{operation_id:l.user.current_operation_id,host:c.host,task_id:e.process_aggregate.aggregate.max.task_id-1}}))},fetchPolicy:"network-only"}),Object(o.useEffect)((function(){d.current=p}),[p]);return Object(x.jsx)(yo.c,{index:i,value:r,children:Object(x.jsxs)("div",{style:{display:"flex",flexGrow:1,overflowY:"auto"},children:[Object(x.jsx)("div",{style:{width:"30%",overflow:"auto",flexGrow:1},children:Object(x.jsx)(Us,{treeRoot:p})}),Object(x.jsxs)("div",{style:{width:"60%",display:"flex",flexDirection:"column",overflow:"auto",flexGrow:1},children:[Object(x.jsx)(dl,{onListFilesButton:function(e){e.callbackID;R.current={parameters:"",ui_feature:"process_browser:list"},q(!0)},onNextButton:function(e){var t=e.task_id;z({variables:{operation_id:l.user.current_operation_id,host:c.host,task_id:t}})},onPreviousButton:function(e){var t=e.task_id;H({variables:{operation_id:l.user.current_operation_id,host:c.host,task_id:t}})},onDiffButton:function(e){e.task_id},initialCallbackID:c.callbackID,onChangeCallbackID:function(e){T.current=e},taskInfo:D}),Object(x.jsx)(Vs,{selectedFolder:k,onTaskRowAction:function(e){var t=e.process_id,a=e.architecture,n=e.uifeature;R.current={parameters:{process_id:t,architecture:a},ui_feature:n,openDialog:!0},q(!0),console.log(t,a,n)},os:A})]}),N&&Object(x.jsx)(ks.a,{ui_feature:(null===(t=R.current)||void 0===t?void 0:t.ui_feature)||" ",callback_id:T.current,parameters:(null===(a=R.current)||void 0===a?void 0:a.parameters)||"",openDialog:(null===(n=R.current)||void 0===n?void 0:n.openDialog)||!1,onTasked:function(){return q(!1)}})]})})},dl=function(e){var t=e.onListFilesButton,a=e.onNextButton,n=e.onPreviousButton,i=e.initialCallbackID,r=(e.onDiffButton,e.onChangeCallbackID),c=e.taskInfo,l=Object(ee.a)(),d=s.a.useState(""),b=Object(u.a)(d,2),p=b[0],m=b[1],h=s.a.useState(i),f=Object(u.a)(h,2),g=f[0],y=f[1],v=s.a.useState(!0),_=Object(u.a)(v,2),k=_[0],w=_[1],C=s.a.useState(0),S=Object(u.a)(C,2),D=S[0],I=S[1];Object(o.useEffect)((function(){void 0!==c.callback&&(m(c.callback.host),I(c.id)),k||(void 0!==c.callback?y(c.callback.id):y(0))}),[c,k]);return Object(o.useEffect)((function(){r(g)}),[g,r]),Object(x.jsxs)(ft.a,{container:!0,spacing:0,style:{paddingTop:"10px"},children:[Object(x.jsx)(ft.a,{item:!0,xs:10,children:Object(x.jsx)(j.a,{placeholder:"Host Name",value:p,disabled:!0,onChange:function(){},name:"Host Name",InputProps:{endAdornment:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(kt.a,{title:"Fetch Previous Saved Process Listing",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){O.b.info("Fetching previous process data..."),n({task_id:c.id})},children:Object(x.jsx)(el.a,{style:{color:l.palette.info.main}})})}),Object(x.jsx)(kt.a,{title:"Task Callback to List Processes",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){g>0?t({callbackID:g}):O.b.warning("Must set a callback number to task first")},children:Object(x.jsx)(wo.a,{style:{color:l.palette.info.main}})})}),Object(x.jsx)(kt.a,{title:"Fetch Next Saved Process Listing",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){O.b.info("Fetching next process data..."),a({task_id:c.id})},children:Object(x.jsx)(Zs.a,{style:{color:l.palette.info.main}})})}),Object(x.jsx)(kt.a,{title:"Compare Previous Listing",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){g>0?a({callbackID:g}):O.b.warning("Must select a callback number first")},children:Object(x.jsx)(al.a,{style:{color:l.palette.info.main}})})})]})}})}),Object(x.jsx)(ft.a,{item:!0,xs:1,children:Object(x.jsx)(j.a,{type:"number",placeholder:"Callback",name:"Callback",onChange:function(e,t,a){w(!0),y(parseInt(t))},value:g,InputProps:{endAdornment:k?Object(x.jsx)(kt.a,{title:"Change Callback Based on Data Origin",children:Object(x.jsx)(E.a,{style:{padding:"3px"},onClick:function(){w(!1),void 0!==c.callback?y(c.callback.id):y(0)},children:Object(x.jsx)(Mc.a,{style:{color:l.palette.info.main}})})}):Object(x.jsx)(kt.a,{title:"Manually Update Callback Number to Prevent Data Origin Tracking",children:Object(x.jsx)(E.a,{style:{padding:"3px"},children:Object(x.jsx)(So.a,{disabled:!0,style:{color:l.palette.warning.main}})})}),style:{padding:0,margin:0}}})}),Object(x.jsx)(ft.a,{item:!0,xs:1,children:Object(x.jsx)(j.a,{type:"number",name:"Task Data",disabled:!0,value:D,onChange:function(){}})})]})},ul=Object(Se.a)((function(e){return{root:{width:"100%"}}}));function bl(e){var t=e.onCloseTab,a=e.openTabs,n=e.clickedTabId,i=e.clearSelectedTab,r=e.onEditTabDescription,c=ul(),l=s.a.useRef(!0),d=s.a.useState(0),b=Object(u.a)(d,2),j=b[0],p=b[1];s.a.useEffect((function(){return function(){l.current=!1}}),[]);var m=function(e){var a=e.tabID,n=e.index;p(n>0?n-1:0),t({tabID:a,index:n})};return Object(o.useEffect)((function(){for(var e=0;e<a.length;e++)a[e].tabID===n&&p(e);i()}),[n,a,i]),Object(x.jsxs)("div",{className:c.root,style:{display:"flex",flexDirection:"column",flexGrow:1,height:"100%"},children:[Object(x.jsx)(xo.a,{color:"default",position:"static",children:Object(x.jsx)(go.a,{value:j,onChange:function(e,t){p(t),localStorage.setItem("clickedTab",a[t].tabID)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",style:{maxWidth:"100%",width:"100%"},"aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e.tabType){case"interact":return Object(x.jsx)(no.a,{onEditTabDescription:r,onCloseTab:m,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"fileBrowser":return Object(x.jsx)(Ts,{onEditTabDescription:r,onCloseTab:m,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);case"processBrowser":return Object(x.jsx)(sl,{onEditTabDescription:r,onCloseTab:m,tabInfo:e,index:t},"tablabel"+e.tabID+e.tabType);default:return null}}))})}),a.map((function(e,t){switch(e.tabType){case"interact":return Object(x.jsx)(no.b,{style:{position:"relative",height:"100%",maxHeight:"100%",overflow:"auto"},onCloseTab:m,tabInfo:e,value:j,index:t,parentMountedRef:l},"tabpanel"+e.tabID+e.tabType);case"fileBrowser":return Object(x.jsx)(qs,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:m,tabInfo:e,value:j,index:t,parentMountedRef:l},"tabpanel"+e.tabID+e.tabType);case"processBrowser":return Object(x.jsx)(ll,{style:{height:"100%",maxHeight:"100%",position:"relative",overflow:"auto"},onCloseTab:m,tabInfo:e,value:j,index:t,parentMountedRef:l},"tabpanel"+e.tabID+e.tabType);default:return null}}))]})}var jl,pl,ml,hl,fl,Ol,xl,gl,yl=a(857),vl=a(858),_l=a(88),kl=a(507),wl=a.n(kl),Cl=a(506),Sl=a.n(Cl);function Dl(e){var t=s.a.useState({top:"0%",bottom:"0%"}),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(e.heights)}),[e.heights]);var r=function(e,t,a){var r=Object(v.a)({},n);r[e]=t,i(r)};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Adjust sizes of Top/Bottom sections"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(j.a,{autoFocus:!0,value:n.top,onChange:r,name:"top"}),Object(x.jsx)(j.a,{value:n.bottom,onChange:r,name:"bottom"})]})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){e.onSubmit(n),e.onClose()},color:"primary",variant:"contained",children:"Submit"})]})]})}var Il,Tl,$l=Object(be.a)(jl||(jl=Object(_.a)(["\nmutation hideCallback ($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, active: false}) {\n    status\n    error\n  }\n}\n"]))),Pl=Object(be.a)(pl||(pl=Object(_.a)(["\nmutation hideCallback ($callback_id: Int!, $active: Boolean!){\n  updateCallback(input: {callback_id: $callback_id, active: $active}) {\n    status\n    error\n  }\n}\n"]))),Al=Object(be.a)(ml||(ml=Object(_.a)(["\nmutation removeEdgeMutation ($edge_id: Int!, $end_timestamp: timestamp!){\n    update_callbackgraphedge_by_pk(pk_columns: {id: $edge_id}, _set: {end_timestamp: $end_timestamp}) {\n        end_timestamp\n        id\n      }\n}\n"]))),El=Object(be.a)(hl||(hl=Object(_.a)(["\nmutation addEdgeMutation ($source_id: Int!, $destination_id: Int!, $profile_id: Int!){\n  insert_callbackgraphedge_one(object: {c2_profile_id: $profile_id, destination_id: $destination_id, direction: 1, source_id: $source_id}) {\n    id\n  }\n}\n"]))),Ll=Object(be.a)(fl||(fl=Object(_.a)(["\nmutation unlockCallback($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: false}) {\n    status\n    error\n  }\n}\n"]))),Fl=Object(be.a)(Ol||(Ol=Object(_.a)(["\nmutation lockCallack($callback_id: Int!){\n  updateCallback(input: {callback_id: $callback_id, locked: true}) {\n    status\n    error\n  }\n}\n"]))),Nl=Object(be.a)(xl||(xl=Object(_.a)(["\nmutation updateDescriptionCallack($callback_id: Int!, $description: String!){\n  updateCallback(input: {callback_id: $callback_id, description: $description}) {\n    status\n    error\n  }\n}\n"]))),ql=Object(be.a)(gl||(gl=Object(_.a)(["\nmutation updateSleepInfoCallback($callback_id: Int!, $sleep_info: String!){\n  update_callback_by_pk(pk_columns: {id: $callback_id}, _set: {sleep_info: $sleep_info}){\n    id\n    sleep_info\n  }\n}\n"]))),Rl=a(193),Bl=a(214),Ml=a.n(Bl),zl=a(504),Wl=a.n(zl),Hl=a(502),Ul=a.n(Hl),Gl=a(503),Kl=a.n(Gl),Vl=a(245),Ql=Object(be.a)(Il||(Il=Object(_.a)(["\nquery GetCallbackDetails($callback_id: Int!) {\n  callback_by_pk(id: $callback_id){\n    payload {\n      uuid\n      payloadtype{\n          ptype\n          id\n          commands(where: {script_only: {_eq: true}, deleted: {_eq: false}}){\n            id\n            cmd\n            version\n          }\n      }\n      filemetum {\n        filename_text\n        agent_file_id\n        id\n        md5\n        sha1\n      }\n      buildparameterinstances {\n        parameter\n        id\n        buildparameter {\n          description\n        }\n      }\n      os\n    }\n    c2profileparametersinstances(order_by: {c2profile: {name: asc}}) {\n      value\n      c2profileparameter {\n        description\n        parameter_type\n      }\n      c2profile {\n        name\n      }\n      enc_key_base64\n      dec_key_base64\n    }\n    loadedcommands{\n      id\n      version\n      command {\n        cmd\n        id\n        version\n      }\n    }\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    last_checkin\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n  }\n  \n}\n"])));function Jl(e){var t=Object(ee.a)(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),o=Object(u.a)(c,2),l=o[0],d=o[1],j=s.a.useState([]),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(je.a)(Ql,{variables:{callback_id:e.callback_id},onCompleted:function(e){var t=e.callback_by_pk.loadedcommands.map((function(e){return{cmd:e.command.cmd,mythic:e.command.version,payload:e.version}})),a=e.callback_by_pk.payload.payloadtype.commands.reduce((function(e,t){return[].concat(Object(y.a)(e),[{cmd:t.cmd,mythic:t.version,payload:t.version}])}),Object(y.a)(t)).sort((function(e,t){return e.cmd>t.cmd?1:t.cmd>e.cmd?-1:0}));r(a);var n=e.callback_by_pk.payload.buildparameterinstances.map((function(e){return{description:e.buildparameter.description,value:e.parameter}})).sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}));d(n);var i=e.callback_by_pk.c2profileparametersinstances.reduce((function(e,t){return t.c2profile.name in e?Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.c2profile.name,[].concat(Object(y.a)(e[t.c2profile.name]),[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))):Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.c2profile.name,[{description:t.c2profileparameter.description,value:t.value,enc_key:t.enc_key_base64,dec_key:t.dec_key_base64,parameter_type:t.c2profileparameter.parameter_type}]))}),{}),c=Object.keys(i).reduce((function(e,t){return[].concat(Object(y.a)(e),[{c2_profile:t,parameters:i[t].sort((function(e,t){return e.description>t.description?1:t.description>e.description?-1:0}))}])}),[]);h(c)}}),O=f.loading,g=f.error,_=f.data;return O?Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}}):g?(console.error(g),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Callback Configuration"}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Callback Information"})}),Object(x.jsx)(to,Object(v.a)({},_.callback_by_pk)),Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Payload Information"})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Payload Info"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsxs)(w.a,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Payload Type"}),Object(x.jsx)(C.a,{children:_.callback_by_pk.payload.payloadtype.ptype})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Selected OS"}),Object(x.jsx)(C.a,{children:_.callback_by_pk.payload.os})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"UUID"}),Object(x.jsx)(C.a,{children:_.callback_by_pk.payload.uuid})]}),_.callback_by_pk.payload.filemetum?Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Filename"}),Object(x.jsx)(C.a,{children:_.callback_by_pk.payload.filemetum.filename_text})]},"filename_text"):null,Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Download URL"}),Object(x.jsx)(C.a,{children:window.location.origin+"/direct/download/"+_.callback_by_pk.payload.filemetum.agent_file_id})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"SHA1"}),Object(x.jsx)(C.a,{children:_.callback_by_pk.payload.filemetum.sha1})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"MD5"}),Object(x.jsx)(C.a,{children:_.callback_by_pk.payload.filemetum.md5})]})]})]}),Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Build Parameters"})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{children:l.map((function(e,t){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:e.description}),Object(x.jsx)(C.a,{children:e.value})]},"buildprop"+t+"for"+_.callback_by_pk.payload.id)}))})]}),m.map((function(e){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:e.c2_profile})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"30%"},children:"Parameter"}),Object(x.jsx)(C.a,{children:"Value"})]})}),Object(x.jsx)(w.a,{style:{whiteSpace:"pre"},children:e.parameters.map((function(t,a){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:t.description}),Object(x.jsx)(C.a,{children:"Dictionary"===t.parameter_type||"Array"===t.parameter_type?JSON.stringify(JSON.parse(t.value),null,2):t.value})]},"c2frag"+_.callback_by_pk.payload.id+e.c2_profile+a)}))})]})]},"c2frag"+_.callback_by_pk.payload.id+e.c2_profile)})),Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:t.pageHeader.main,color:t.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:t.pageHeaderColor},children:"Loaded Commands"})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Command Name"}),Object(x.jsx)(C.a,{children:"Mythic Version"}),Object(x.jsx)(C.a,{children:"Loaded Version"}),Object(x.jsx)(C.a,{children:"Documentation"})]})}),Object(x.jsx)(w.a,{children:i.map((function(e){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:e.cmd}),Object(x.jsx)(C.a,{children:e.mythic}),Object(x.jsx)(C.a,{children:e.payload}),Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+_.callback_by_pk.payload.payloadtype.ptype+"/commands/"+e.cmd,children:"Docs"})})]},e.cmd+_.callback_by_pk.payload.id)}))})]})]}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"})})]})}var Yl,Zl=Object(be.a)(Tl||(Tl=Object(_.a)(['\nquery callbacksAndFeatures($operation_id: Int!) {\n  callback(where: {operation_id: {_eq: $operation_id}, active: {_eq: true}}, order_by: {id: asc}) {\n    loadedcommands(where: {command: {supported_ui_features: {_ilike: "%callback_table%"}}}) {\n      command {\n        supported_ui_features\n      }\n    }\n    id\n    host\n    user\n    process_name\n    pid\n  }\n}']))),Xl=Object(Se.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:500},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}}));function ed(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function td(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}function ad(e){var t,a,n,i,r,c,o=e.onClose,l=Object(f.a)(h.b),d=s.a.useState([]),j=Object(u.a)(d,2),p=j[0],m=j[1],O=s.a.useState(""),g=Object(u.a)(O,2),_=g[0],k=g[1],w=Xl(),C=s.a.useState([]),S=Object(u.a)(C,2),D=S[0],I=S[1],$=s.a.useState([]),P=Object(u.a)($,2),A=P[0],E=P[1],L=s.a.useState([]),F=Object(u.a)(L,2),N=F[0],q=F[1],R=td(D,A),B=td(D,N),M=s.a.useRef(null),z=s.a.useState(!1),W=Object(u.a)(z,2),H=W[0],K=W[1],Q=s.a.useRef({}),J=s.a.useRef([]),Y=s.a.useRef(!1),Z=s.a.useRef(null);Object(je.a)(Zl,{variables:{operation_id:(null===l||void 0===l||null===(t=l.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onCompleted:function(e){var t=e.callback.map((function(e){var t=e.loadedcommands.reduce((function(e,t){var a=t.command.supported_ui_features.split("\n"),n=Object(y.a)(e);return a.forEach((function(e){!n.includes(e)&&e.startsWith("callback_table")&&n.push(e)})),Object(y.a)(n)}),[]),a="".concat(e.id," - ").concat(e.user,"@").concat(e.host," (").concat(e.pid,")");return Object(v.a)(Object(v.a)({},e),{},{features:t,display:a})}));E(t)}}),s.a.useEffect((function(){var e=[];if(N.length>=1){e=Object(y.a)(N[0].features);for(var t=1;t<N.length;t++){for(var a=[],n=0;n<e.length;n++)N[t].features.includes(e[n])&&a.push(e[n]);e=[].concat(a)}}m(e),e.length>0?k(e[0]):k("")}),[N]);var X=function(e){return function(){var t=D.indexOf(e),a=Object(y.a)(D);-1===t?a.push(e):a.splice(t,1),I(a)}},ee=function(){var e=J.current.shift(1);e?(Z.current?Q.current={ui_feature:_,callback_id:e.id,openDialog:!1,parameters:Z.current,tasking_location:"modal"}:Q.current={ui_feature:_,callback_id:e.id,openDialog:!0,parameters:"",tasking_location:"modal"},K(!0)):o()};s.a.useEffect((function(){Y.current&&(H||ee())}),[H,Y]);var te=function(e,t){return Object(x.jsx)(T.a,{className:w.paper,style:{width:"100%"},children:Object(x.jsxs)(Ie.a,{children:[Object(x.jsx)(ka.a,{className:w.cardHeader,title:e}),Object(x.jsx)(wa.a,{classes:{root:w.divider}}),Object(x.jsx)("div",{style:{overflow:"auto"},children:Object(x.jsxs)(xa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[t.map((function(e){var t="transfer-list-item-".concat(e.id,"-label");return Object(x.jsxs)(ga.a,{style:{padding:0},role:"listitem",button:!0,onClick:X(e),children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(_a.a,{checked:-1!==D.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":t}})}),Object(x.jsx)(va.a,{id:t,primary:e.display})]},e.id)})),Object(x.jsx)(ga.a,{})]})})]})})};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Task Multiple Callbacks at Once"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsxs)(ft.a,{container:!0,spacing:0,justify:"center",alignItems:"center",className:w.root,children:[Object(x.jsx)(ft.a,{item:!0,xs:5,children:te("Callbacks Not Being Tasked",A)}),Object(x.jsx)(ft.a,{item:!0,xs:1,children:Object(x.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:w.button,onClick:function(){q(N.concat(A)),E([])},disabled:0===A.length,"aria-label":"move all right",children:"\u226b"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:w.button,onClick:function(){q(N.concat(R)),E(ed(A,R)),I(ed(D,R))},disabled:0===R.length,"aria-label":"move selected right",children:">"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:w.button,onClick:function(){E(A.concat(B)),q(ed(N,B)),I(ed(D,B))},disabled:0===B.length,"aria-label":"move selected left",children:"<"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:w.button,onClick:function(){E(A.concat(N)),q([])},disabled:0===N.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(x.jsx)(ft.a,{item:!0,xs:5,children:te("Callbacks To Task",N)}),Object(x.jsxs)(ft.a,{item:!0,xs:12,children:[Object(x.jsx)("pre",{children:"The following capabilities are loaded into all of the selected callbacks. Select one to issue mass tasking."}),Object(x.jsx)($t.a,{ref:M,children:"Supported UI Features"}),Object(x.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:_,onChange:function(e){k(e.target.value)},disabled:0===p.length,variant:"filled",input:Object(x.jsx)(Ot.a,{style:{width:"100%"}}),children:p.map((function(e){return Object(x.jsx)(at.a,{value:e,children:e.split(":")[1]},e)}))})]})]})}),H&&Object(x.jsx)(ks.a,{ui_feature:(null===(a=Q.current)||void 0===a?void 0:a.ui_feature)||" ",callback_id:(null===Q||void 0===Q||null===(n=Q.current)||void 0===n?void 0:n.callback_id)||0,parameters:(null===(i=Q.current)||void 0===i?void 0:i.parameters)||"",openDialog:(null===(r=Q.current)||void 0===r?void 0:r.openDialog)||!1,tasking_location:(null===(c=Q.current)||void 0===c?void 0:c.tasking_location)||"command_line",onTasked:function(e){var t=e.tasked,a=e.variables;t?(console.log("setting finalTaskedParameters to",a),Z.current=a,K(!1)):o()}}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:o,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){0!==N.length&&""!==_?(Y.current=!0,J.current=Object(y.a)(N),ee()):o()},variant:"contained",color:"secondary",children:"Submit"})]})]})}var nd,id=Object(be.a)(Yl||(Yl=Object(_.a)(["\nquery callbacksAndFeatures($operation_id: Int!) {\n  callback(where: {operation_id: {_eq: $operation_id}, active: {_eq: true}}, order_by: {id: asc}) {\n    id\n    host\n    user\n    process_name\n    pid\n  }\n}"]))),rd=Object(Se.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:500},button:{margin:e.spacing(.5,0)},divider:{backgroundColor:"rgb(100, 170, 204)",border:"2px solid rgba(100, 170, 204)"}}}));function cd(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function od(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}function sd(e){var t,a=e.onClose,n=Object(f.a)(h.b),i=rd(),r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState([]),j=Object(u.a)(d,2),p=j[0],m=j[1],g=s.a.useState([]),_=Object(u.a)(g,2),k=_[0],w=_[1],C=od(o,p),S=od(o,k),D=s.a.useRef(0),I=s.a.useRef(0),$=Object(pe.a)($l,{update:function(e,t){var a=t.data;I.current+=1,"success"===a.updateCallback.status?D.current+=1:O.b.warning(a.updateCallback.error),I.current===k.length&&O.b.success("Successfully updated "+D.current+" callbacks status")},onError:function(e){console.log(e)}}),P=Object(u.a)($,1)[0];Object(je.a)(id,{variables:{operation_id:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onCompleted:function(e){var t=e.callback.map((function(e){var t="".concat(e.id," - ").concat(e.user,"@").concat(e.host," (").concat(e.pid,")");return Object(v.a)(Object(v.a)({},e),{},{display:t})}));m(t)}});var A=function(e){return function(){var t=o.indexOf(e),a=Object(y.a)(o);-1===t?a.push(e):a.splice(t,1),l(a)}},E=function(e,t){return Object(x.jsx)(T.a,{className:i.paper,style:{width:"100%"},children:Object(x.jsxs)(Ie.a,{children:[Object(x.jsx)(ka.a,{className:i.cardHeader,title:e}),Object(x.jsx)(wa.a,{classes:{root:i.divider}}),Object(x.jsx)("div",{style:{overflow:"auto"},children:Object(x.jsxs)(xa.a,{dense:!0,component:"div",role:"list",style:{padding:0},children:[t.map((function(e){var t="transfer-list-item-".concat(e.id,"-label");return Object(x.jsxs)(ga.a,{style:{padding:0},role:"listitem",button:!0,onClick:A(e),children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(_a.a,{checked:-1!==o.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":t}})}),Object(x.jsx)(va.a,{id:t,primary:e.display})]},e.id)})),Object(x.jsx)(ga.a,{})]})})]})})};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Hide Multiple Callbacks at Once"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsxs)(ft.a,{container:!0,spacing:0,justify:"center",alignItems:"center",className:i.root,children:[Object(x.jsx)(ft.a,{item:!0,xs:5,children:E("Visible Callbacks",p)}),Object(x.jsx)(ft.a,{item:!0,xs:1,children:Object(x.jsxs)(ft.a,{container:!0,direction:"column",alignItems:"center",children:[Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:i.button,onClick:function(){w(k.concat(p)),m([])},disabled:0===p.length,"aria-label":"move all right",children:"\u226b"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:i.button,onClick:function(){w(k.concat(C)),m(cd(p,C)),l(cd(o,C))},disabled:0===C.length,"aria-label":"move selected right",children:">"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:i.button,onClick:function(){m(p.concat(S)),w(cd(k,S)),l(cd(o,S))},disabled:0===S.length,"aria-label":"move selected left",children:"<"}),Object(x.jsx)(b.a,{variant:"outlined",size:"small",className:i.button,onClick:function(){m(p.concat(k)),w([])},disabled:0===k.length,"aria-label":"move all left",children:"\u226a"})]})}),Object(x.jsx)(ft.a,{item:!0,xs:5,children:E("Callbacks To Hide",k)})]})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:a,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){if(0!==k.length)for(var e=0;e<k.length;e++)P({variables:{callback_id:k[e].id}});else a()},variant:"contained",color:"secondary",children:"Hide"})]})]})}var ld=Object(be.a)(nd||(nd=Object(_.a)(["\nsubscription CallbacksSubscription ($callback_id: Int!){\n  callback_by_pk(id: $callback_id) {\n    id\n    last_checkin\n  }\n}\n "]))),dd=function(e){var t,a,n,i,r=e.rowData,c=e.onOpenTab,o=e.toggleLock,l=e.updateDescription,d=s.a.useRef(null),j=Object(ee.a)(),p=s.a.useState(!1),m=Object(u.a)(p,2),h=m[0],f=m[1],g=s.a.useState(!1),y=Object(u.a)(g,2),_=y[0],k=y[1],w=s.a.useState(!1),C=Object(u.a)(w,2),S=C[0],D=C[1],I=s.a.useState(!1),$=Object(u.a)(I,2),P=$[0],A=$[1],E=s.a.useRef({parameters:"",ui_feature:"callback_table:exit"}),L=s.a.useState(!1),F=Object(u.a)(L,2),N=F[0],q=F[1],R=s.a.useState(!1),B=Object(u.a)(R,2),M=B[0],z=B[1],W=function(e){c("interact"===e?{tabType:e,tabID:r.id+e,callbackID:r.id}:"processBrowser"===e?{tabType:e,tabID:r.host,callbackID:r.id}:{tabType:e,tabID:r.id+e,callbackID:r.id})},H=function(e){d.current&&d.current.contains(e.target)||k(!1)},U=Object(pe.a)($l,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Hiding callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e)}}),G=Object(u.a)(U,1)[0],K=[{name:"Hide Callback",icon:Object(x.jsx)(vs.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),G({variables:{callback_id:r.id}})}},{name:"Hide Multiple",icon:Object(x.jsx)(vs.a,{style:{paddingRight:"5px"}}),click:function(e){z(!0)}},{name:"Exit Callback",icon:Object(x.jsx)(Mt.a,{icon:zt.B,style:{cursor:"pointer",marginRight:"10px"}}),click:function(e){E.current={parameters:"",ui_feature:"callback_table:exit",getConfirmation:!0},A(!0)}},{name:"Task Multiple",icon:Object(x.jsx)(Mt.a,{icon:zt.z,style:{cursor:"pointer",marginRight:"10px"}}),click:function(e){q(!0)}},{name:"File Browser",icon:Object(x.jsx)(Mt.a,{icon:zt.v,style:{cursor:"pointer",marginRight:"10px"}}),click:function(e){e.stopPropagation(),W("fileBrowser")}},{name:"Process Browser",icon:Object(x.jsx)(Ul.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),W("processBrowser")}},{name:r.locked?"Unlock (Locked by "+r.locked_operator.username+")":"Lock Callback",icon:r.locked?Object(x.jsx)(Uc.a,{style:{paddingRight:"5px"}}):Object(x.jsx)(Mc.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),o({id:r.id,locked:r.locked})}},{name:"Edit Description",icon:Object(x.jsx)(ki.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),D(!0)}},{name:"Expand Callback",icon:Object(x.jsx)(Kl.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),window.open("/new/callbacks/"+r.id,"_blank").focus()}},{name:"View Metadata",icon:Object(x.jsx)(On.a,{style:{paddingRight:"5px"}}),click:function(e){e.stopPropagation(),f(!0)}}];return Object(x.jsxs)("div",{children:[Object(x.jsxs)(Je.a,{variant:"contained",color:r.integrity_level>2?"secondary":"primary",ref:d,"aria-label":"split button",children:[Object(x.jsxs)(b.a,{style:{padding:"0 10px 0 10px"},onClick:function(e){e.stopPropagation(),W("interact")},children:[r.locked?Object(x.jsx)(Mc.a,{fontSize:"large",style:{marginRight:"10px"}}):Object(x.jsx)(Ml.a,{fontSize:"large",style:{marginRight:"10px"}}),r.id]}),Object(x.jsx)(b.a,{style:{margin:0,padding:0},"aria-controls":_?"split-button-menu":void 0,"aria-expanded":_?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),k((function(e){return!e}))},children:Object(x.jsx)(Ze.a,{})})]}),Object(x.jsx)(tt.a,{open:_,anchorEl:d.current,role:void 0,transition:!0,style:{zIndex:200},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===a?"top left":"top center",anchorOrigin:"bottom right"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===j.palette.type?j.palette.primary.dark:j.palette.primary.light,color:"white"},elevation:5,children:Object(x.jsx)(Xe.a,{onClickAway:H,children:Object(x.jsx)(nt.a,{id:"split-button-menu",children:K.map((function(e,t){return Object(x.jsxs)(at.a,{onClick:function(e){return function(e,t){K[t].click(e),k(!1)}(e,t)},children:[e.icon,e.name]},e.name)}))})})})}))}}),P&&Object(x.jsx)(ks.a,{ui_feature:(null===(t=E.current)||void 0===t?void 0:t.ui_feature)||" ",callback_id:r.id,parameters:(null===(a=E.current)||void 0===a?void 0:a.parameters)||"",openDialog:(null===(n=E.current)||void 0===n?void 0:n.openDialog)||!1,getConfirmation:(null===(i=E.current)||void 0===i?void 0:i.getConfirmation)||!1,onTasked:function(){return A(!1)}}),h&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:h,onClose:function(){f(!1)},innerDialog:Object(x.jsx)(Jl,{onClose:function(){f(!1)},callback_id:r.id})}),S&&Object(x.jsx)(Y.a,{fullWidth:!0,open:S,onClose:function(){D(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Callback's Description",onClose:function(){D(!1)},value:r.description,onSubmit:function(e){l({description:e,id:r.id})}})}),N&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:N,onClose:function(){q(!1)},innerDialog:Object(x.jsx)(ad,{onClose:function(){q(!1)}})}),M&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:M,onClose:function(){z(!1)},innerDialog:Object(x.jsx)(sd,{onClose:function(){z(!1)}})})]})},ud=function(e){var t=e.cellData;return Object(x.jsx)("div",{children:t})},bd=function(e){var t=e.rowData,a=e.parentMountedRef,n=s.a.useState(""),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState(-1),l=Object(u.a)(o,2),d=l[0],b=l[1],j=s.a.useRef(!0);return Object(Me.a)(ld,{variables:{callback_id:t.id},fetchPolicy:"network-only",onSubscriptionData:function(e){var t=e.subscriptionData;if(!j.current||!a.current)return null;b(t.data.callback_by_pk.last_checkin)}}),Object(Z.c)((function(){if(!j.current||!a.current)return null;c(-1!==d?Object(Z.a)(d):"Loading...")}),1e3,j,a),s.a.useEffect((function(){return function(){j.current=!1}}),[]),Object(x.jsx)("div",{children:r})},jd=function(e){var t=e.rowData;return Object(x.jsx)(kt.a,{title:t.payload.payloadtype.ptype,children:Object(x.jsx)("img",{style:{width:"35px",height:"35px"},src:"/static/"+t.payload.payloadtype.ptype+".svg"})})},pd=function(e){var t=e.rowData,a=e.initialCallbackGraphEdges,n=Object(ee.a)(),i=s.a.useState(n.palette.success.main),r=Object(u.a)(i,2),c=r[0],l=r[1],d=s.a.useState(!0),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState(!0),h=Object(u.a)(m,2),f=h[0],O=h[1],g=s.a.useState(!1),_=Object(u.a)(g,2),k=_[0],w=_[1],C=s.a.useState([]),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useState([]),$=Object(u.a)(T,2),P=$[0],A=$[1],E=function(e){e.stopPropagation(),w(!0)};return Object(o.useEffect)((function(){var e=P.filter((function(e){return!e.c2profile.is_p2p&&e.source.id===t.id&&e.destination.id===t.id})).length;e>0&&!f?O(!0):0===e&&f&&O(!1)}),[P]),Object(o.useEffect)((function(){var e=function(e){for(var n=(null===a||void 0===a?void 0:a.filter((function(a){return(a.source.id===t.id||a.destination.id===t.id)&&(!e||null===a.end_timestamp)})))||[],i=!0;i;){var r=(null===a||void 0===a?void 0:a.reduce((function(t,a){return t.includes(a)?Object(y.a)(t):t.filter((function(t){return(t.source.id===a.source.id||t.source.id===a.destination.id||t.destination.id===a.source.id)&&(!e||null===a.end_timestamp)})).length>0?[].concat(Object(y.a)(t),[a]):Object(y.a)(t)}),Object(y.a)(n)))||[];i=r.length>n,n=Object(y.a)(r)}return n},n=e(!0),i=e(!1);D.length!==n.length&&I(n),P.length!==i.length&&A(i)}),[a,t.id]),Object(o.useEffect)((function(){0===D.filter((function(e){return!e.c2profile.is_p2p&&null===e.end_timestamp})).length?(l(n.palette.error.main),p(!1)):(l(n.palette.success.main),p(!0))}),[D,n.palette.success.main,n.palette.error.main]),Object(o.useEffect)((function(){}),[j]),Object(x.jsxs)("div",{children:[f?Object(x.jsx)(Qe.a,{onClick:E,style:{color:c,cursor:"pointer"}}):Object(x.jsx)(Wc.a,{onClick:E,style:{color:c,cursor:"pointer"}}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:k,onClose:function(){w(!1)},innerDialog:Object(x.jsx)(Jc,Object(v.a)(Object(v.a)({onClose:function(){w(!1)}},t),{},{callbackgraphedges:j?D:P}))})]})},md=function(e){var t=e.rowData,a=e.cellData,n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],l=Object(o.useCallback)((function(){switch(t.payload.os.toLowerCase()){case"windows":return Object(x.jsx)(Mt.a,{icon:Vl.d,size:"2x",style:{cursor:"pointer"},onClick:d});case"linux":return Object(x.jsx)(Mt.a,{icon:Vl.c,size:"2x",style:{cursor:"pointer"},onClick:d});case"macos":return Object(x.jsx)(Mt.a,{icon:Vl.a,size:"2x",style:{cursor:"pointer"},onClick:d});case"chrome":return Object(x.jsx)(Mt.a,{icon:Vl.b,size:"2x",style:{cursor:"pointer"},onClick:d});default:return Object(x.jsx)(Mt.a,{icon:zt.A,size:"2x",style:{cursor:"pointer"},onClick:d})}}),[]),d=s.a.useCallback((function(){c(!0)}),[]);return Object(x.jsxs)("div",{children:[l(),r&&Object(x.jsx)(Rl.a,{onClose:function(){c(!1)},title:"Operating System Information",maxWidth:"md",fullWidth:!0,value:a,open:r})]})},hd=function(e){var t=e.rowData,a=e.cellData,n=e.updateSleepInfo,i=Object(ee.a)(),r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1];return Object(x.jsxs)("div",{children:[Object(x.jsx)(Wl.a,{onClick:function(e){e.stopPropagation(),l(!0)},style:{color:""===a?i.palette.warning.main:i.palette.info.main,cursor:"pointer"}}),o&&Object(x.jsx)(Y.a,{fullWidth:!0,open:o,onClose:function(){l(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Sleep Information",onClose:function(){l(!1)},value:a,onSubmit:function(e){n({sleep_info:e,id:t.id})}})})]})};function fd(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState({sortKey:null,sortDirection:null,sortType:null}),c=Object(u.a)(r,2),l=c[0],d=c[1],b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],h=s.a.useState(!1),f=Object(u.a)(h,2),g=f[0],_=f[1],k=s.a.useState({}),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState({}),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState({visible:["Interact","Host","Domain","User","Description","Last Checkin","Agent","C2","IP","OS"],hidden:["Arch","PID","Sleep","Process Name","External IP"]}),A=Object(u.a)(P,2),E=A[0],L=A[1],F=Object(pe.a)(Fl,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Locked callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e),O.b.warning(e)}}),N=Object(u.a)(F,1)[0],q=Object(pe.a)(Ll,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Unlocked callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e),O.b.warning(e)}}),R=Object(u.a)(q,1)[0],B=Object(pe.a)(Nl,{update:function(e,t){var a=t.data;"success"===a.updateCallback.status?O.b.success("Updated Callback"):O.b.warning(a.updateCallback.error)},onError:function(e){console.log(e),O.b.warning(e)}}),M=Object(u.a)(B,1)[0],z=Object(pe.a)(ql,{update:function(e,t){t.data;O.b.success("Updated Callback")},onError:function(e){console.log(e),O.b.warning(e)}}),W=Object(u.a)(z,1)[0],H=Object(o.useMemo)((function(){return[{key:"id",type:"number",name:"Interact",width:150},{key:"ip",type:"string",name:"IP",width:150},{key:"external_ip",type:"string",name:"External IP",width:150},{key:"host",type:"string",name:"Host",fillWidth:!0},{key:"user",type:"string",name:"User",fillWidth:!0},{key:"domain",type:"string",name:"Domain",fillWidth:!0},{key:"os",type:"string",name:"OS",width:75},{key:"architecture",type:"string",name:"Arch",width:75},{key:"pid",type:"number",name:"PID",width:75},{key:"last_checkin",type:"string",name:"Last Checkin",width:150,disableSort:!0},{key:"description",type:"string",name:"Description",width:400},{key:"sleep",type:"string",name:"Sleep",width:75,disableSort:!0},{key:"agent",type:"string",name:"Agent",width:100,disableSort:!0},{key:"c2",type:"string",name:"C2",width:75,disableSort:!0},{key:"process_name",type:"string",name:"Process Name",fillWidth:!0}].reduce((function(e,t){return E.visible.includes(t.name)||"Interact"===t.name?C[t.key]&&String(C[t.key]).length>0?[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{filtered:!0})]):[].concat(Object(y.a)(e),[Object(v.a)({},t)]):Object(y.a)(e)}),[])}),[C,E]),U=s.a.useCallback((function(){}),[]),G=[{name:"Filter Column",click:function(e){e.event;var t=e.columnIndex;H[t].disableFilterMenu?O.b.warning("Can't filter that column"):($(H[t]),m(!0))}},{name:"Show/Hide Columns",click:function(e){e.event;var t=e.columnIndex;H[t].disableFilterMenu?O.b.warning("Can't filter that column"):_(!0)}}];Object(o.useEffect)((function(){localStorage.getItem("callbacks_table_columns")}),[H]);var K=s.a.useCallback((function(e){var t=e.id;e.locked?R({variables:{callback_id:t}}):N({variables:{callback_id:t}})}),[]),V=s.a.useCallback((function(e){var t=e.id,a=e.description;M({variables:{callback_id:t,description:a}})}),[]),Q=s.a.useCallback((function(e){var t=e.id,a=e.sleep_info;W({variables:{callback_id:t,sleep_info:a}})}),[]),J=s.a.useMemo((function(){if(null===l.sortKey||null===l.sortType)return n;var e=Object(y.a)(n);return"number"===l.sortType||"size"===l.sortType||"date"===l.sortType?e.sort((function(e,t){return parseInt(e[l.sortKey])>parseInt(t[l.sortKey])?1:-1})):"string"===l.sortType&&e.sort((function(e,t){return e[l.sortKey].toLowerCase()>t[l.sortKey].toLowerCase()?1:-1})),"DESC"===l.sortDirection&&e.reverse(),e}),[n,l]),Z=s.a.useMemo((function(){return J.reduce((function(t,a){return function(e){for(var t=0,a=Object.entries(C);t<a.length;t++){var n=Object(u.a)(a[t],2),i=n[0],r=n[1];if("agent"===i){if(!String(e.payload.payloadtype.ptype).toLowerCase().includes(r))return!0}else if(!String(e[i]).toLowerCase().includes(r))return!0}return!1}(a)?Object(y.a)(t):[].concat(Object(y.a)(t),[H.map((function(t){switch(t.name){case"Interact":return Object(x.jsx)(dd,{rowData:a,onOpenTab:e.onOpenTab,toggleLock:K,updateDescription:V});case"IP":return Object(x.jsx)(ud,{rowData:a,cellData:a.ip});case"External IP":return Object(x.jsx)(ud,{rowData:a,cellData:a.external_ip});case"Host":return Object(x.jsx)(ud,{rowData:a,cellData:a.host});case"User":return Object(x.jsx)(ud,{rowData:a,cellData:a.user});case"Domain":return Object(x.jsx)(ud,{rowData:a,cellData:a.domain});case"OS":return Object(x.jsx)(md,{rowData:a,cellData:a.os});case"Arch":return Object(x.jsx)(ud,{rowData:a,cellData:a.architecture});case"PID":return Object(x.jsx)(ud,{rowData:a,cellData:a.pid});case"Last Checkin":return Object(x.jsx)(bd,{rowData:a,cellData:a.id,parentMountedRef:e.parentMountedRef});case"Description":return Object(x.jsx)(ud,{rowData:a,cellData:a.description});case"Sleep":return Object(x.jsx)(hd,{rowData:a,cellData:a.sleep_info,updateSleepInfo:Q});case"Agent":return Object(x.jsx)(jd,{rowData:a,cellData:a.payload.payloadtype.ptype});case"C2":return Object(x.jsx)(pd,{rowData:a,initialCallbackGraphEdges:e.callbackgraphedges});case"Process Name":return Object(x.jsx)(ud,{rowData:a,cellData:a.process_name})}}))])}),[])}),[J,e.onTaskRowAction,C,E,e.callbackgraphedges,e.onOpenTab,K]),X=H.findIndex((function(e){return e.key===l.sortKey}));return s.a.useEffect((function(){i(Object(y.a)(e.callbacks))}),[e.callbacks]),Object(x.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Object(x.jsx)(es.a,{columns:H,sortIndicatorIndex:X,sortDirection:l.sortDirection,items:Z,rowHeight:40,onClickHeader:function(e,t){var a=H[t];a.disableSort||(a.key||d({sortKey:null,sortType:null,sortDirection:"ASC"}),l.sortKey===a.key?"ASC"===l.sortDirection?d(Object(v.a)(Object(v.a)({},l),{},{sortDirection:"DESC"})):d({sortKey:null,sortType:null,sortDirection:"ASC"}):d({sortKey:a.key,sortType:a.type,sortDirection:"ASC"}))},onDoubleClickRow:U,contextMenuOptions:G}),p&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"xs",open:p,onClose:function(){m(!1)},innerDialog:Object(x.jsx)(ts,{selectedColumn:T,filterOptions:C,onSubmit:function(e){S(e)},onClose:function(){m(!1)}})}),g&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:g,onClose:function(){_(!1)},innerDialog:Object(x.jsx)(cs,{onClose:function(){_(!1)},onSubmit:function(e){var t=e.left,a=e.right;L({visible:a,hidden:t})},right:E.visible,rightTitle:"Show these columns",leftTitle:"Hidden Columns",left:E.hidden,dialogTitle:"Edit which columns are shown"})})]})}var Od,xd=a(505),gd=a(222),yd=Object(be.a)(Od||(Od=Object(_.a)(["\nquery getP2PProfilesAndCallbacks($operation_id: Int!){\n  c2profile(where: {is_p2p: {_eq: true}}) {\n    callbackc2profiles(where: {callback: {operation_id: {_eq: $operation_id}}}) {\n      id\n      callback {\n        id\n        description\n      }\n    }\n    name\n    id\n  }\n}\n"]))),vd=Object(Se.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120,width:"97%"},selectEmpty:{marginTop:e.spacing(2)}}}));function _d(e){var t=vd(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState([]),l=Object(u.a)(c,2),d=l[0],j=l[1],p=s.a.useState(""),m=Object(u.a)(p,2),O=m[0],g=m[1],y=s.a.useState(""),v=Object(u.a)(y,2),_=v[0],k=v[1],w=Object(o.useRef)(null),C=Object(f.a)(h.b),S=Object(je.a)(yd,{variables:{operation_id:C.user.current_operation_id},onCompleted:function(t){var a=t.c2profile.filter((function(t){var a=!1;return e.source.callbackc2profiles.forEach((function(e){e.c2profile.name===t.name&&(a=!0)})),a}));if(j(a),a.length>0){k(a[0]);var n=a[0].callbackc2profiles.filter((function(t){return t.callback.id!==e.source.id}));r(n),n.length>0&&g(n[0])}},fetchPolicy:"network-only"}),D=S.loading,I=S.error;return D?Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}}):I?(console.error(I),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{children:["Manually Add Edge From Callback ",e.source.id]}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsxs)(s.a.Fragment,{children:["Manually add an edge from Callback ",e.source.id," to another callback via a P2P C2 Profile they both share.",Object(x.jsx)("br",{}),Object(x.jsxs)(mt.a,{className:t.formControl,children:[Object(x.jsx)($t.a,{id:"demo-dialog-select-label-profile",children:"Profile"}),Object(x.jsxs)(ht.a,{labelId:"demo-dialog-select-label-profile",id:"demo-dialog-select",value:_,onChange:function(e){k(e.target.value)},style:{minWidth:"30%"},children:[Object(x.jsx)(at.a,{value:"",children:Object(x.jsx)("em",{children:"None"})}),d.map((function(e){return Object(x.jsx)(at.a,{value:e,children:e.name},"profile:"+e.id)}))]})]}),Object(x.jsx)("br",{}),Object(x.jsxs)(mt.a,{className:t.formControl,children:[Object(x.jsx)($t.a,{ref:w,children:"Destination"}),Object(x.jsxs)(ht.a,{labelId:"demo-dialog-select-label-destination",id:"demo-dialog-select-destination",value:O,onChange:function(e){g(e.target.value)},input:Object(x.jsx)(Ot.a,{}),children:[Object(x.jsx)(at.a,{value:"",children:Object(x.jsx)("em",{children:"None"})}),i.map((function(e){return Object(x.jsxs)(at.a,{value:e,children:[e.callback.id," (",e.callback.description,")"]},"callback:"+e.callback.id)}))]})]})]})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){e.onSubmit(e.source.id,_,O.callback),e.onClose()},variant:"contained",style:{backgroundColor:Tr.a.palette.success.main},children:"Add"})]})]})}var kd,wd,Cd,Sd=a(218),Dd=Object(be.a)(kd||(kd=Object(_.a)(['\nquery loadedLinkCommandsQuery ($callback_id: Int!){\n  loadedcommands(where: {callback_id: {_eq: $callback_id}, command: {supported_ui_features: {_ilike: "graph_view:link"}, deleted: {_eq: false}}}) {\n    command {\n        id\n        cmd\n        help_cmd\n        description\n        needs_admin\n    }\n  }\n}\n'])));function Id(e){var t=e.onOpenTab,a=e.callbackgraphedges,n=Object(ee.a)(),i=Object(o.useRef)(null),r=s.a.useRef(null),c=s.a.useState(!1),l=Object(u.a)(c,2),d=l[0],j=l[1],p=Object(o.useState)(!0),m=Object(u.a)(p,2),h=m[0],f=m[1],g=s.a.useState([]),_=Object(u.a)(g,2),k=_[0],w=_[1],C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],$=s.a.useState(!1),P=Object(u.a)($,2),A=P[0],E=P[1],L=Object(o.useState)(),F=Object(u.a)(L,2),N=F[0],q=F[1],R=Object(o.useState)(),B=Object(u.a)(R,2),M=B[0],z=B[1],W=Object(o.useState)(!1),H=Object(u.a)(W,2),U=H[0],G=H[1],K=Object(o.useState)(!1),V=Object(u.a)(K,2),Q=V[0],J=V[1],Z=Object(o.useState)([]),X=Object(u.a)(Z,2),te=X[0],ae=X[1],ne=Object(o.useState)(null),ie=Object(u.a)(ne,2),re=ie[0],ce=ie[1],oe=Object(pt.a)(Dd,{fetchPolicy:"network-only",onCompleted:function(e){if(1===e.loadedcommands.length)q(e.loadedcommands[0].command),I(!0);else if(0===e.loadedcommands.length)O.b.warning("No commands loaded that are 'link' commands");else{var t=e.loadedcommands.map((function(e){return Object(v.a)(Object(v.a)({},e),{},{display:e.command.cmd})}));w(t),q(t[0].command),E(!0)}}}),se=Object(u.a)(oe,1)[0],le=Object(pe.a)(no.c,{update:function(e,t){var a=t.data;"error"===a.createTask.status?O.b.error(a.createTask.error):O.b.success("task created")}}),de=Object(u.a)(le,1)[0],ue=s.a.useState({rankDir:"BT",label_components:["id","user"],packet_flow_view:!0,include_disconnected:!0,show_all_nodes:!1}),be=Object(u.a)(ue,2),je=be[0],me=be[1],he=Object(pe.a)($l,{update:function(e,t){t.data}}),fe=Object(u.a)(he,1)[0],Oe=Object(pe.a)(Al,{update:function(e,t){t.data}}),xe=Object(u.a)(Oe,1)[0],ge=Object(pe.a)(El,{update:function(e,t){t.data}}),ye=Object(u.a)(ge,1)[0],ve=Object(o.useMemo)((function(){return{mouseover:function(e,t,a){},mouseout:function(e,t,a){},click:function(e,t,a){},contextmenu:[{title:"Hide Callback",action:function(e,t){fe({variables:{callback_id:t.node.id}})}},{title:"Interact",action:function(e,a){t({tabType:"interact",tabID:a.node.id+"interact",callbackID:a.node.id})}},{title:"Manually Remove Edge",action:function(e,t){var a=function(e,t){return e.nodeEdges(t)}(e,t.node.id).reduce((function(t,a){var n=e.edge(a.v,a.w,a.name);return null===n.end_timestamp?1===n.direction?je.packet_flow_view?[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},n),{},{display:a.v+" --\x3e "+a.name+" --\x3e "+a.w})]):[].concat(Object(y.a)(t),[Object(v.a)(Object(v.a)({},n),{},{display:a.w+" --\x3e "+a.name+" --\x3e "+a.v})]):Object(y.a)(t)}),[]);ae(a),G(!0)}},{title:"Manually Add Edge",action:function(e,t){ce(t.node),J(!0)}},{title:"Task Callback for Edge",action:function(e,t){w([]),q(null),z(null),se({variables:{callback_id:t.node.id}}),z(t.node)}}]}}),[se,fe,je,t]),_e=[{name:je.include_disconnected?"Show Only Active Edges":"Show All Edges",click:function(){var e=Object(v.a)(Object(v.a)({},je),{},{include_disconnected:!je.include_disconnected});Zc(Object(y.a)(a),i,!0,e,ve,n),me(e)}},{name:je.show_all_nodes?"Hide inactive callbacks":"Show All Callbacks",click:function(){var e=Object(v.a)(Object(v.a)({},je),{},{show_all_nodes:!je.show_all_nodes});Zc(Object(y.a)(a),i,!0,e,ve,n),me(e)}},{name:"Autosize",click:function(){Zc(Object(y.a)(a),i,!0,je,ve,n)}},{name:"LR"===je.rankDir?"Change Layout to Top-Bottom":"Change Layout to Left-Right",click:function(){if("LR"===je.rankDir){var e=Object(v.a)(Object(v.a)({},je),{},{rankDir:"BT"});Zc(Object(y.a)(a),i,!0,e,ve,n),me(e)}else{var t=Object(v.a)(Object(v.a)({},je),{},{rankDir:"LR"});Zc(Object(y.a)(a),i,!0,t,ve,n),me(t)}}},{name:je.packet_flow_view?"View Connection Directions":"View Egress Routes",click:function(){var e=Object(v.a)(Object(v.a)({},je),{},{packet_flow_view:!je.packet_flow_view});Zc(Object(y.a)(a),i,!0,e,ve,n),me(e)}},{name:"Download Graph",click:function(){Object(xd.saveSvgAsPng)(document.getElementById("callbacksgraph"),"diagram.png")}}],ke=function(e){r.current&&r.current.contains(e.target)||j(!1)};return Object(o.useEffect)((function(){var e=Object(y.a)(a);Zc(e,i,h,je,ve,n),f(!1)}),[a,h,je,n]),Object(x.jsxs)("div",{style:{maxWidth:"100%",overflow:"auto",height:"100%"},children:[Object(x.jsx)(Je.a,{variant:"contained",ref:r,"aria-label":"split button",style:{marginTop:"10px"},color:"primary",children:Object(x.jsxs)(b.a,{size:"small",color:"primary","aria-controls":d?"split-button-menu":void 0,"aria-expanded":d?"true":void 0,"aria-haspopup":"menu",onClick:function(e){e.stopPropagation(),j((function(e){return!e}))},children:["Actions ",Object(x.jsx)(Ze.a,{})]})}),function(){var e="";return e+=je.include_disconnected?"Showing All Edges, ":"Showing Only Active Edges, ",e+=je.show_all_nodes?"Showing All Callbacks, ":"Showing Active Callbacks, ",e+="Layout: "+je.rankDir+", ",e+=je.packet_flow_view?"Showing Egress Routes":"Showing Connections Paths"}(),Object(x.jsx)(tt.a,{open:d,anchorEl:r.current,role:void 0,transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,a=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===n.palette.type?n.palette.primary.dark:n.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:ke,children:Object(x.jsx)(nt.a,{id:"split-button-menu",children:_e.map((function(e,t){return Object(x.jsx)(at.a,{onClick:function(e){return function(e,t){_e[t].click(),j(!1)}(0,t)},children:e.name},e.name)}))})})})}))}}),U&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:U,onClose:function(){G(!1)},innerDialog:Object(x.jsx)(gd.a,{onClose:function(){G(!1)},identifier:"edge_id",display:"display",onSubmit:function(e){""!==e?xe({variables:{edge_id:e.edge_id,end_timestamp:(new Date).toISOString()}}):O.b.warning("No edge selected")},options:te,title:"Manually Remove Edge",action:"remove"})}),Q&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:Q,onClose:function(){J(!1)},innerDialog:Object(x.jsx)(_d,{onClose:function(){J(!1)},onSubmit:function(e,t,a){""!==t&&""!==a?ye({variables:{source_id:e,profile_id:t.id,destination_id:a.id}}):O.b.warning("Profile or Destination Callback not provided")},source:re})}),D&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:D,onClose:function(){I(!1)},innerDialog:Object(x.jsx)(Sd.a,{command:N,callback:M,onSubmit:function(e,t,a){I(!1),de({variables:{callback_id:M.id,command:e,params:t,files:a}})},onClose:function(){I(!1)}})}),A&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:A,onClose:function(){E(!1)},innerDialog:Object(x.jsx)(gd.a,{onClose:function(){E(!1)},onSubmit:function(e){q(e.command),I(!0)},options:k,title:"Select Link Command",action:"select",display:"display",identifier:"display"})}),Object(x.jsx)("svg",{id:"callbacksgraph",ref:i,width:"100%",height:"90%"})]})}var Td=Object(be.a)(wd||(wd=Object(_.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callback(where: {active: {_eq: true}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    architecture\n    description\n    domain\n    external_ip\n    host\n    id\n    integrity_level\n    ip\n    locked\n    locked_operator {\n      username\n    }\n    extra_info\n    sleep_info\n    pid\n    os\n    user\n    agent_callback_id\n    operation_id\n    process_name\n    payload {\n      os\n      payloadtype {\n        ptype\n        id\n      }\n      tag\n      id\n    }\n  }\n}\n "]))),$d=Object(be.a)(Cd||(Cd=Object(_.a)(["\nsubscription CallbacksSubscription ($operation_id: Int!){\n  callbackgraphedge(where: {operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    id\n    end_timestamp\n    direction\n    destination {\n      active\n      id\n      operation_id\n      user\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    source {\n      active\n      id\n      user\n      operation_id\n      host\n      payload {\n        payloadtype {\n          ptype\n          id\n        }\n      }\n      callbackc2profiles {\n        c2profile {\n          name\n        }\n      }\n    }\n    c2profile {\n      id\n      is_p2p\n      name\n    }\n  }\n}\n "])));function Pd(e){var t,a,n=e.onOpenTab,i=e.topDisplay,r=e.heights,c=Object(f.a)(h.b),o=Object(ee.a)(),l=s.a.useState([]),d=Object(u.a)(l,2),b=d[0],j=d[1],p=s.a.useState([]),m=Object(u.a)(p,2),O=m[0],g=m[1],y=s.a.useRef(!0);Object(Me.a)(Td,{variables:{operation_id:(null===c||void 0===c||null===(t=c.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;y.current&&j(t.data.callback)}}),Object(Me.a)($d,{variables:{operation_id:(null===c||void 0===c||null===(a=c.user)||void 0===a?void 0:a.current_operation_id)||0},fetchPolicy:"network-only",shouldResubscribe:!0,onSubscriptionData:function(e){var t=e.subscriptionData;y.current&&g(t.data.callbackgraphedge)}});var v=function(e){for(var t=e.tabType,a=e.tabID,i=e.callbackID,r=0;r<b.length;r++)if(b[r].id===i){var c={tabID:a,tabType:t,callbackID:i,payloadtype:b[r].payload.payloadtype.ptype,payloadtype_id:b[r].payload.payloadtype.id,operation_id:b[r].operation_id,payloadDescription:b[r].payload.tag,callbackDescription:b[r].description,host:b[r].host,os:b[r].payload.os};n(c)}};return s.a.useEffect((function(){return function(){y.current=!1}}),[]),Object(x.jsx)("div",{style:{height:"100%",width:"100%"},children:"graph"===i?Object(x.jsx)(Id,{maxHeight:"100%",topHeight:r.top,onOpenTab:v,callbacks:b,callbackgraphedges:O},"callbacksgraph"):Object(x.jsxs)("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"column"},children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:o.pageHeader.main,color:o.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",width:"100%"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:o.pageHeaderColor},children:"Active Callbacks"})}),Object(x.jsx)(fd,{onOpenTab:v,callbacks:b,callbackgraphedges:O,parentMountedRef:y},"callbackstable")]})})}var Ad=Object(Se.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{bottom:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{top:e.spacing(2),right:e.spacing(2)}},tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function Ed(){var e=s.a.useState("table"),t=Object(u.a)(e,2),a=t[0],n=t[1],i=s.a.useState([]),r=Object(u.a)(i,2),c=r[0],l=r[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState({top:"30%",bottom:"68%"}),h=Object(u.a)(m,2),f=h[0],O=h[1];Object(o.useEffect)((function(){var e=localStorage.getItem("openTabs");if(void 0!==e&&null!==e)try{var t=JSON.parse(e);l(t);var a=localStorage.getItem("clickedTab");void 0!==a&&null!==a&&p(a)}catch(r){console.log("failed to parse oldTabs",r)}var n=localStorage.getItem("heights");if(void 0!==n&&null!==n)try{var i=JSON.parse(n);O(i)}catch(r){console.log("failed to parse oldHeights",r)}}),[]);var g=s.a.useCallback((function(){p("")}),[]),_=s.a.useCallback((function(e){O(e),localStorage.setItem("heights",JSON.stringify(e))}),[]);return Object(x.jsx)("div",{style:{maxWidth:"100%",height:"100%",display:"flex",flexDirection:"column"},children:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(Rd,{setTopDisplay:n,heights:f,onSubmitHeights:_}),Object(x.jsx)("div",{style:{flexGrow:1,flexBasis:f.top,height:f.top},children:Object(x.jsx)(Pd,{topDisplay:a,onOpenTab:function(e){var t=!1;if(c.forEach((function(a){a.tabID===e.tabID&&(t=!0)})),!t){var a=[].concat(Object(y.a)(c),[Object(v.a)({},e)]);localStorage.setItem("openTabs",JSON.stringify(a)),l(a)}localStorage.setItem("clickedTab",e.tabID),p(e.tabID)},heights:f})}),Object(x.jsx)("div",{style:{flexGrow:1,flexBasis:f.bottom,height:f.bottom},children:Object(x.jsx)(bl,{onCloseTab:function(e){var t=e.tabID,a=(e.index,c.filter((function(e){return e.tabID!==t})));localStorage.setItem("openTabs",JSON.stringify(a)),l(a)},onEditTabDescription:function(e,t){var a=c.map((function(a){return a.tabID===e.tabID?Object(v.a)(Object(v.a)({},a),{},{customDescription:t}):Object(v.a)({},a)}));l(a),localStorage.setItem("openTabs",JSON.stringify(a))},clearSelectedTab:g,tabHeight:f.bottom,maxHeight:f.bottom,clickedTabId:j,openTabs:c},"callbackstabs")})]})})}function Ld(e){var t=e.setTopDisplay,a=e.onSubmitHeights,n=e.heights,i=s.a.useState(!1),r=Object(u.a)(i,2),c=r[0],o=r[1],l=Ad(),d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useMemo((function(){return[{icon:Object(x.jsx)(Sl.a,{}),name:"Table layout",onClick:function(){t("table")}},{icon:Object(x.jsx)(Ni.a,{}),name:"Graph layout",onClick:function(){t("graph")}},{icon:Object(x.jsx)(wl.a,{}),name:"Adjust Top/Bottom Size",onClick:function(){p(!0),o(!1)}}]}),[]);return Object(x.jsxs)(s.a.Fragment,{children:[j&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:j,onClose:function(){p(!1),o(!1)},innerDialog:Object(x.jsx)(Dl,{onClose:function(){p(!1),o(!1)},heights:n,onSubmit:function(e){o(!1),a(e)}})}),Object(x.jsx)(yl.a,{ariaLabel:"SpeedDial example",className:l.speedDial,icon:Object(x.jsx)(vl.a,{}),onClose:function(){o(!1)},onOpen:function(){o(!0)},FabProps:{color:"secondary"},open:c,style:{marginTop:"35px"},direction:"down",children:m.map((function(e){return Object(x.jsx)(_l.a,{arrow:!0,TooltipClasses:{tooltip:l.tooltip,arrow:l.arrow},icon:e.icon,tooltipTitle:e.name,onClick:e.onClick},e.name)}))})]})}var Fd,Nd,qd,Rd=s.a.memo(Ld),Bd=a(213),Md=a(508),zd=a.n(Md),Wd=a(829),Hd=a(72),Ud=a.n(Hd),Gd=a(855),Kd=20,Vd=Object(be.a)(Fd||(Fd=Object(_.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_escape: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, responses: {response_escape: {_ilike: $search}}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),no.d),Qd=Object(be.a)(Nd||(Nd=Object(_.a)(["\n","\nquery parametersQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, original_params: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),no.d),Jd=Object(be.a)(qd||(qd=Object(_.a)(["\n","\nquery responseQuery($operation_id: Int!, $search: String!, $offset: Int!, $fetchLimit: Int!, $status: String!) {\n    task_aggregate(distinct_on: id, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      aggregate {\n        count(columns: id)\n      }\n    }\n    task(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: asc}, where: {status: {_ilike: $status}, parent_task_id: {_is_null: true}, comment: {_ilike: $search}, callback: {operation_id: {_eq: $operation_id}}}) {\n      ...taskData\n    }\n  }\n"])),no.d);function Yd(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"Tasks",iconComponent:Object(x.jsx)(zd.a,{})},e))}var Zd,Xd,eu,tu=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Output"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Output","Parameters","Comment"],p=s.a.useState(""),m=Object(u.a)(p,2),h=m[0],f=m[1],O=function(t,a,n,r){var c=n||l,o=a||i,s=r||h;switch(e.changeSearchParam("search",o),e.changeSearchParam("taskStatus",s),c){case"Output":e.onOutputSearch({search:o,offset:0,taskStatus:s});break;case"Parameters":e.onParameterSearch({search:o,offset:0,taskStatus:s});break;case"Comment":e.onCommentSearch({search:o,offset:0,taskStatus:s})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Output",i="";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Output"),e.onChangeSearchField("Output"),e.changeSearchParam("searchField","Output")),t.has("taskStatus")&&(f(t.get("taskStatus")),e.onChangeTaskStatus(t.get("taskStatus")),i=t.get("taskStatus")),O(0,a,n,i)}}),[e.value,e.index]),Object(x.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(e,t,a){r(t)},onEnter:O,name:"Search...",InputProps:{endAdornment:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(bo.a,{title:"Search",children:Object(x.jsx)(E.a,{onClick:O,children:Object(x.jsx)(Ud.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(x.jsxs)(ft.a,{item:!0,xs:3,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search Task's"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(x.jsx)(ft.a,{item:!0,xs:2,children:Object(x.jsx)(j.a,{placeholder:"Filter Task Status...",value:h,onChange:function(e,t,a){f(t)},onEnter:O,name:"Filter Task Status..."})})]})},au=function(e){var t=s.a.useState({task:[]}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Output"),g=Object(u.a)(m,2),y=g[0],_=g[1],k=s.a.useState(""),w=Object(u.a)(k,2),C=w[0],S=w[1],D=Object(f.a)(h.b),I=function(e){O.b.dismiss(),l(e.task_aggregate.aggregate.count),i({task:e.task})},T=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},$=Object(pt.a)(Vd,{fetchPolicy:"no-cache",onCompleted:I,onError:T}),P=Object(u.a)($,1)[0],A=Object(pt.a)(Qd,{fetchPolicy:"no-cache",onCompleted:I,onError:T}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(Jd,{fetchPolicy:"no-cache",onCompleted:I,onError:T}),N=Object(u.a)(F,1)[0],q=function(e){var t=e.search,a=e.offset,n=e.taskStatus;O.b.info("Searching...",{persist:!0}),p(t);var i=t;""===t&&(i="_");var r=n;""===r&&(r="_"),P({variables:{operation_id:D.user.current_operation_id,offset:a,fetchLimit:Kd,search:"%"+i+"%",status:"%"+r+"%"}})},R=function(e){var t=e.search,a=e.offset,n=e.taskStatus;O.b.info("Searching...",{persist:!0}),p(t);var i=t;""===t&&(i="_");var r=n;""===r&&(r="_"),E({variables:{operation_id:D.user.current_operation_id,offset:a,fetchLimit:Kd,search:"%"+i+"%",status:"%"+r+"%"}})},B=function(e){var t=e.search,a=e.offset,n=e.taskStatus;O.b.info("Searching...",{persist:!0});var i=t;console.log("search",t),""===t&&(i="_");var r=n;""===r&&(r="_"),p(t),N({variables:{operation_id:D.user.current_operation_id,offset:a,fetchLimit:Kd,search:"%"+i+"%",status:"%"+r+"%"}})};return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)(tu,{onChangeSearchField:function(e){switch(_(e),e){case"Output":q({search:j,offset:0,taskStatus:C});break;case"Parameters":R({search:j,offset:0,taskStatus:C});break;case"Comment":B({search:j,offset:0,taskStatus:C})}},onOutputSearch:q,value:e.value,index:e.index,onChangeTaskStatus:function(e){S(e)},onParameterSearch:R,onCommentSearch:B,changeSearchParam:e.changeSearchParam}),Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.task.length>0?n.task.map((function(e){return Object(x.jsx)(Bd.a,{task:e,command_id:null==e.command?0:e.command.id},"taskinteractdisplay"+e.id)})):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(o/Kd),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Output":q({search:j,offset:0,taskStatus:C});break;case"Parameters":R({search:j,offset:0,taskStatus:C});break;case"Comment":B({search:j,offset:0,taskStatus:C})}else switch(y){case"Output":q({search:j,offset:(t-1)*Kd,taskStatus:C});break;case"Parameters":R({search:j,offset:(t-1)*Kd,taskStatus:C});break;case"Comment":B({search:j,offset:(t-1)*Kd,taskStatus:C})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},nu=a(308),iu=a.n(nu),ru=Object(Se.a)((function(e){return{root:Object(jt.a)({},e.breakpoints.up("sm"),{minWidth:"344px !important"}),typography:{fontWeight:"bold"},actionRoot:{padding:"8px 8px 8px 16px"},icons:{marginLeft:"auto",float:"right"},expand:{padding:"8px 8px",transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},collapse:{padding:16},checkIcon:{fontSize:20,color:"#b3b3b3",paddingRight:4},button:{padding:0,textTransform:"none"}}})),cu=s.a.forwardRef((function(e,t){var a=Object(ee.a)(),n=ru(a),i=Object(qa.c)().closeSnackbar,r=Object(o.useState)(!0),c=Object(u.a)(r,2),s=c[0],l=c[1];return Object(x.jsx)(qa.a,{ref:t,className:n.root,children:Object(x.jsxs)(Ie.a,{style:{backgroundColor:a.palette.success.main},children:[Object(x.jsxs)(Ba.a,{classes:{root:n.actionRoot},children:[Object(x.jsx)(L.a,{variant:"subtitle2",className:n.typography,children:e.title}),Object(x.jsxs)("div",{className:n.icons,children:[Object(x.jsx)(E.a,{"aria-label":"Show more",className:Object(Ra.default)(n.expand,Object(jt.a)({},n.expandOpen,s)),onClick:function(){l(!s)},children:Object(x.jsx)(Ha.a,{})}),Object(x.jsx)(E.a,{className:n.expand,onClick:function(){i(e.id)},children:Object(x.jsx)(za.a,{})})]})]}),Object(x.jsx)(A.a,{in:s,timeout:"auto",unmountOnExit:!0,children:Object(x.jsxs)(T.a,{className:n.collapse,children:[Object(x.jsx)(L.a,{gutterBottom:!0,children:e.innerText}),Object(x.jsxs)(b.a,{size:"small",className:n.button,download:!0,href:e.downloadLink,children:[Object(x.jsx)(Ga.a,{className:n.checkIcon}),"Download now"]})]})})]})})})),ou=a(358),su=a.n(ou),lu=a(296),du=Object(be.a)(Zd||(Zd=Object(_.a)(["\nmutation downloadBulkMutation($files: [String!]!){\n    download_bulk(files: $files){\n        status\n        error\n        file_id\n    }\n}\n"]))),uu=Object(be.a)(Xd||(Xd=Object(_.a)(["\nmutation updateFileMutation($file_id: Int!){\n    deleteFile(file_id: $file_id) {\n        status\n        error\n        file_ids\n    }\n}\n"]))),bu=Object(be.a)(eu||(eu=Object(_.a)(["\nmutation updateCommentMutation($file_id: Int!, $comment: String!){\n    update_filemeta_by_pk(pk_columns: {id: $file_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function ju(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=function(e,t){i(Object(v.a)(Object(v.a)({},n),{},Object(jt.a)({},e,t)))};Object(o.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.id,!1))}),{});i(t),d(Object(y.a)(e.files))}),[e.files]);var p=Object(pe.a)(du,{onCompleted:function(e){O.b.dismiss(),"success"===e.download_bulk.status?O.b.success("",{persist:!0,content:function(t){return Object(x.jsx)(cu,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):O.b.error(e.error)},onError:function(e){console.log(e),O.b.error("Failed to zip up files")}}),m=Object(u.a)(p,1)[0],h=function(e){var t=e.file_ids,a=l.map((function(e){return t.includes(e.id)?Object(v.a)(Object(v.a)({},e),{},{deleted:!0}):Object(v.a)({},e)}));d(a)},f=function(e){var t=e.id,a=e.comment,n=l.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{comment:a}):Object(v.a)({},e)}));d(n)};return Object(x.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(x.jsxs)(b.a,{size:"small",onClick:function(){O.b.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var r=Object(u.a)(i[a],2),c=r[0];if(r[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(c)&&t.push(e.files[o].agent_file_id)}m({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(x.jsx)(su.a,{}),"Zip & Download Selected"]}),Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"}}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(x.jsx)(C.a,{children:"File"}),Object(x.jsx)(C.a,{children:"Time"}),Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:"Comment"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"More"})]})}),Object(x.jsx)(w.a,{children:l.map((function(e){return Object(x.jsx)(pu,Object(v.a)({onToggleSelection:j,onEditComment:f,selected:n,onDelete:h},e),"file"+e.id)}))})]})]})}function pu(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(f.a)(h.b),g=Object(ee.a)(),y=Object(pe.a)(uu,{onCompleted:function(t){O.b.dismiss(),e.onDelete(t.deleteFile)},onError:function(e){console.log(e),O.b.error("Failed to delete file")}}),v=Object(u.a)(y,1)[0],_=Object(pe.a)(bu,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),F=Object(u.a)(_,1)[0];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(Oa.a,{onClose:function(){i(!1)},onSubmit:function(){v({variables:{file_id:e.id}})},open:n}),Object(x.jsx)(C.a,{children:e.deleted?null:Object(x.jsx)(kt.a,{title:"Toggle to download multiple files at once",children:Object(x.jsx)($.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(x.jsx)(C.a,{children:e.deleted?null:Object(x.jsx)(E.a,{size:"small",onClick:function(){i(!0)},style:{color:g.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})})}),Object(x.jsx)(C.a,{children:e.deleted?Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(x.jsxs)(L.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,m.user.view_utc_time)})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(x.jsxs)(C.a,{children:[e.comment,Object(x.jsx)(E.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(x.jsx)(ki.a,{})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit File Comment",onSubmit:function(t){F({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(E.a,{size:"small","aria-label":"expand row",onClick:function(){return l(!o)},children:o?Object(x.jsx)(R.a,{className:"mythicElement"}):Object(x.jsx)(N.a,{className:"mythicElement"})})})]}),o?Object(x.jsx)(I.a,{children:Object(x.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(x.jsx)(A.a,{in:o,children:Object(x.jsx)(P.a,{margin:1,children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"16rem"},children:"md5"}),Object(x.jsx)(C.a,{style:{width:"20rem"},children:"sha1"}),Object(x.jsx)(C.a,{style:{width:"20rem"},children:"UUID"}),Object(x.jsx)(C.a,{children:"Operator"}),Object(x.jsx)(C.a,{style:{width:"6rem"},children:"Task"}),Object(x.jsx)(C.a,{children:"Task Comment"}),Object(x.jsx)(C.a,{children:"Command"})]})}),Object(x.jsx)(w.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(x.jsx)(C.a,{children:null===e.task?null:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(x.jsx)(C.a,{children:null!==e.task?Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(x.jsx)(C.a,{children:null===e.task?null:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function mu(e){var t=s.a.useState({}),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),l=c[0],d=c[1],j=function(e,t){i(Object(v.a)(Object(v.a)({},n),{},Object(jt.a)({},e,t)))};Object(o.useEffect)((function(){var t=e.files.reduce((function(e,t){return Object(v.a)(Object(v.a)({},e),{},Object(jt.a)({},t.id,!1))}),{});i(t),d(Object(y.a)(e.files))}),[e.files]);var p=Object(pe.a)(du,{onCompleted:function(e){O.b.dismiss(),"success"===e.download_bulk.status?O.b.success("",{persist:!0,content:function(t){return Object(x.jsx)(cu,{id:t,title:"Download Zip File",innerText:"Filenames are random UUIDs, so a JSON file is included with a mapping of UUID to real filename",downloadLink:window.location.origin+"/api/v1.4/files/download/"+e.download_bulk.file_id})}}):O.b.error(e.error)},onError:function(e){console.log(e),O.b.error("Failed to zip up files")}}),m=Object(u.a)(p,1)[0],h=function(e){var t=e.file_ids,a=l.map((function(e){return t.includes(e.id)?Object(v.a)(Object(v.a)({},e),{},{deleted:!0}):Object(v.a)({},e)}));d(a)},f=function(e){var t=e.id,a=e.comment,n=l.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{comment:a}):Object(v.a)({},e)}));d(n)};return Object(x.jsxs)(S.a,{component:T.a,className:"mythicElement",children:[Object(x.jsxs)(b.a,{size:"small",onClick:function(){O.b.info("Zipping up files...");for(var t=[],a=0,i=Object.entries(n);a<i.length;a++){var r=Object(u.a)(i[a],2),c=r[0];if(r[1])for(var o=0;o<e.files.length;o++)e.files[o].id===parseInt(c)&&t.push(e.files[o].agent_file_id)}m({variables:{files:t}})},style:{float:"right"},color:"primary",variant:"contained",children:[Object(x.jsx)(su.a,{}),"Zip & Download Selected"]}),Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"}}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(x.jsx)(C.a,{children:"Source"}),Object(x.jsx)(C.a,{children:"Destination"}),Object(x.jsx)(C.a,{children:"Time"}),Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:"Comment"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"More"})]})}),Object(x.jsx)(w.a,{children:l.map((function(e){return Object(x.jsx)(hu,Object(v.a)({onToggleSelection:j,onEditComment:f,selected:n,onDelete:h},e),"file"+e.id)}))})]})]})}function hu(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),b=Object(u.a)(d,2),j=b[0],p=b[1],m=Object(f.a)(h.b),g=Object(ee.a)(),y=Object(pe.a)(uu,{onCompleted:function(t){O.b.dismiss(),e.onDelete(t.deleteFile)},onError:function(e){console.log(e),O.b.error("Failed to delete file")}}),v=Object(u.a)(y,1)[0],_=Object(pe.a)(bu,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),F=Object(u.a)(_,1)[0];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(Oa.a,{onClose:function(){i(!1)},onSubmit:function(){v({variables:{file_id:e.id}})},open:n}),Object(x.jsx)(C.a,{children:e.deleted?null:Object(x.jsx)(kt.a,{title:"Toggle to download multiple files at once",children:Object(x.jsx)($.a,{checked:void 0!==e.selected[e.id]&&e.selected[e.id],onChange:function(t){e.onToggleSelection(e.id,t.target.checked)},color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"select_multiple"})})}),Object(x.jsx)(C.a,{children:e.deleted?null:Object(x.jsx)(E.a,{size:"small",onClick:function(){i(!0)},style:{color:g.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",download:!0,underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.filename_text})}),Object(x.jsx)(C.a,{style:{wordBreak:"break-all"},children:e.deleted?Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text}):e.complete?Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:window.location.origin+"/api/v1.4/files/download/"+e.agent_file_id,children:e.full_remote_path_text}):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.full_remote_path_text})," ",Object(x.jsxs)(L.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]})]})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,m.user.view_utc_time)})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(x.jsxs)(C.a,{children:[e.comment,Object(x.jsx)(E.a,{onClick:function(){return p(!0)},size:"small",style:{display:"inline-block"},children:Object(x.jsx)(ki.a,{})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit File Comment",onSubmit:function(t){F({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(E.a,{size:"small","aria-label":"expand row",onClick:function(){return l(!o)},children:o?Object(x.jsx)(R.a,{className:"mythicElement"}):Object(x.jsx)(N.a,{className:"mythicElement"})})})]}),o?Object(x.jsx)(I.a,{children:Object(x.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:Object(x.jsx)(A.a,{in:o,children:Object(x.jsx)(P.a,{margin:1,children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"md5"}),Object(x.jsx)(C.a,{children:"sha1"}),Object(x.jsx)(C.a,{children:"UUID"}),Object(x.jsx)(C.a,{children:"Operator"}),Object(x.jsx)(C.a,{style:{width:"6rem"},children:"Task"}),Object(x.jsx)(C.a,{children:"Task Comment"}),Object(x.jsx)(C.a,{children:"Command"})]})}),Object(x.jsx)(w.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(x.jsx)(C.a,{children:null===e.task?null:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(x.jsx)(C.a,{children:null!==e.task?Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(x.jsx)(C.a,{children:null===e.task?null:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}function fu(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.files))}),[e.files]);var r=function(e){var t=e.id,a=e.comment,r=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{comment:a}):Object(v.a)({},e)}));i(r)},c=n.map((function(e){return e.agent_file_id}));return Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"400px"},children:"Thumbnail"}),Object(x.jsx)(C.a,{children:"Filename"}),Object(x.jsx)(C.a,{children:"Time"}),Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:"Comment"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"More"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e,t){return Object(x.jsx)(Ou,Object(v.a)(Object(v.a)({onEditComment:r},e),{},{index:t,imageRefs:c}),"file"+e.id)}))})]})})}function Ou(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(f.a)(h.b),c=s.a.useState(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],b=s.a.useState(!1),j=Object(u.a)(b,2),p=j[0],m=j[1],g=Object(pe.a)(bu,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filemeta_by_pk)}}),y=Object(u.a)(g,1)[0];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsxs)(C.a,{children:[Object(x.jsx)("img",{onClick:function(){return d(!0)},src:"/api/v1.4/files/screencaptures/"+e.agent_file_id,style:{width:"350px",cursor:"pointer"}}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"xl",open:l,onClose:function(){d(!1)},innerDialog:Object(x.jsx)(lu.a,{images:e.imageRefs,startIndex:e.index,onClose:function(){d(!1)}})}),e.chunks_received<e.total_chunks?Object(x.jsxs)(L.a,{color:"secondary",style:{wordBreak:"break-all"},children:[e.chunks_received," / ",e.total_chunks," Chunks Received"]}):null]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.filename_text})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,r.user.view_utc_time)})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host})}),Object(x.jsxs)(C.a,{children:[e.comment,Object(x.jsx)(E.a,{onClick:function(){return m(!0)},size:"small",style:{display:"inline-block"},children:Object(x.jsx)(ki.a,{})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit File Comment",onSubmit:function(t){y({variables:{file_id:e.id,comment:t}})},value:e.comment,onClose:function(){m(!1)}})})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(E.a,{size:"small","aria-label":"expand row",onClick:function(){return i(!n)},children:n?Object(x.jsx)(R.a,{className:"mythicElement"}):Object(x.jsx)(N.a,{className:"mythicElement"})})})]}),n?Object(x.jsx)(I.a,{children:Object(x.jsx)(C.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(x.jsx)(A.a,{in:n,children:Object(x.jsx)(P.a,{margin:1,children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"99%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"md5"}),Object(x.jsx)(C.a,{children:"sha1"}),Object(x.jsx)(C.a,{children:"UUID"}),Object(x.jsx)(C.a,{children:"Operator"}),Object(x.jsx)(C.a,{style:{width:"6rem"},children:"Task"}),Object(x.jsx)(C.a,{children:"Task Comment"}),Object(x.jsx)(C.a,{children:"Command"})]})}),Object(x.jsx)(w.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.md5})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.sha1})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.agent_file_id})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.operator.username})}),Object(x.jsx)(C.a,{children:null===e.task?null:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(x.jsx)(C.a,{children:null!==e.task?Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.comment}):null}),Object(x.jsx)(C.a,{children:null===e.task?null:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})})]})})]})})})})})}):null]})}var xu,gu,yu,vu,_u,ku,wu,Cu,Su,Du,Iu,Tu,$u,Pu,Au=a(509),Eu=a.n(Au),Lu=Object(be.a)(xu||(xu=Object(_.a)(["\nmutation updateCommentMutation($filebrowserobj_id: Int!, $comment: String!){\n    update_filebrowserobj_by_pk(pk_columns: {id: $filebrowserobj_id}, _set: {comment: $comment}) {\n        comment\n        id\n    }\n}\n"])));function Fu(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.files))}),[e.files]);var r=function(e){var t=e.id,a=e.comment,r=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{comment:a}):Object(v.a)({},e)}));i(r)};return Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{tableLayout:"fixed",maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Host / Path"}),Object(x.jsx)(C.a,{children:"Modify Time"}),Object(x.jsx)(C.a,{children:"Comment"}),Object(x.jsx)(C.a,{style:{width:"7rem"},children:"Permissions"}),Object(x.jsx)(C.a,{style:{width:"7rem"},children:"Downloads"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsx)(Nu,Object(v.a)({onEditComment:r},e),"file"+e.id)}))})]})})}function Nu(e){var t=s.a.useState(!1),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(!1),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],m=j[1],h=Object(pe.a)(Lu,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_filebrowserobj_by_pk)}}),f=Object(u.a)(h,1)[0];return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:n,onClose:function(){i(!1)},innerDialog:Object(x.jsx)(Y.c,{title:"View Permissions Data",leftColumn:"Permission",rightColumn:"Value",value:e.permissions,onClose:function(){i(!1)}})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:o,onClose:function(){l(!1)},innerDialog:Object(x.jsx)(Ho,{title:"Download History",value:e.filemeta,onClose:function(){l(!1)}})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:p,onClose:function(){m(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit File Browser Comment",onSubmit:function(t){f({variables:{filebrowserobj_id:e.id,comment:t}})},value:e.comment,onClose:function(){m(!1)}})}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.host}),Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",textDecoration:e.deleted?"strike-through":""},children:e.full_path_text})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.modify_time})}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(E.a,{onClick:function(){return m(!0)},size:"small",style:{display:"inline-block"},children:Object(x.jsx)(ki.a,{})}),Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{color:"primary",variant:"outlined",onClick:function(){return i(!0)},children:Object(x.jsx)(Eu.a,{})})}),Object(x.jsx)(C.a,{children:e.filemeta.length>0?Object(x.jsx)(kt.a,{title:"View Download History and Download Files",children:Object(x.jsx)(b.a,{color:"primary",variant:"contained",onClick:function(){return l(!0)},children:Object(x.jsx)(Go.a,{})})}):null})]})})}var qu=Object(be.a)(gu||(gu=Object(_.a)(["\nfragment filemetaData on filemeta{\n    agent_file_id\n    chunk_size\n    chunks_received\n    complete\n    deleted\n    filename_text\n    full_remote_path_text\n    host\n    id\n    is_download_from_agent\n    is_payload\n    is_screenshot\n    md5\n    operator {\n        id\n        username\n    }\n    comment\n    sha1\n    timestamp\n    total_chunks\n    task {\n        id\n        comment\n        command {\n            cmd\n            id\n        }\n    }\n}\n"]))),Ru=Object(be.a)(yu||(yu=Object(_.a)(["\nfragment filebrowserData on filebrowserobj{\n    comment\n    deleted\n    full_path_text\n    host\n    id\n    is_file\n    modify_time\n    permissions\n    size\n    filemeta {\n        id\n        agent_file_id\n        chunks_received\n        complete\n        total_chunks\n        timestamp\n        task {\n            id\n            comment\n        }\n    }\n}\n"]))),Bu=20,Mu=Object(be.a)(vu||(vu=Object(_.a)(["\n","\nquery filenameFileMetaUploadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),zu=Object(be.a)(_u||(_u=Object(_.a)(["\n","\nquery filenameFileMetaDownloadQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),Wu=Object(be.a)(ku||(ku=Object(_.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {full_path_text: {_ilike: $filename}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, full_path_text: {_ilike: $filename}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),Ru),Hu=Object(be.a)(wu||(wu=Object(_.a)(["\n","\nquery hashFileMetaUploadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),Uu=Object(be.a)(Cu||(Cu=Object(_.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),Gu=Object(be.a)(Su||(Su=Object(_.a)(["\n","\nquery commentFileMetaUploadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: false}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),Ku=Object(be.a)(Du||(Du=Object(_.a)(["\n","\nquery hashFileMetaDownloadQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: false}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),Vu=Object(be.a)(Iu||(Iu=Object(_.a)(["\n","\nquery filenameFileBrowserQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filebrowserobj_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    filebrowserobj(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...filebrowserData\n    }\n  }\n"])),Ru),Qu=Object(be.a)(Tu||(Tu=Object(_.a)(["\n","\nquery filenameFileMetaScreenshotQuery($operation_id: Int!, $filename: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true},task_id: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{filename_text: {_ilike: $filename}}, {full_remote_path_text: {_ilike: $filename}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),Ju=Object(be.a)($u||($u=Object(_.a)(["\n","\nquery hashFileMetaScreenshotQuery($operation_id: Int!, $hash: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, _and: [{_or: [{md5: {_ilike: $hash}}, {sha1: {_ilike: $hash}}]}, {_or: [{task_id: {_is_null: false}}, {is_payload: {_eq: false}}]}], operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),qu),Yu=Object(be.a)(Pu||(Pu=Object(_.a)(["\n","\nquery commentFileMetaScreenshotQuery($operation_id: Int!, $comment: String!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    filemeta_aggregate(distinct_on: id, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      aggregate {\n        count\n      }\n    }\n    filemeta(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}, is_download_from_agent: {_eq: true}, is_screenshot: {_eq: true}}) {\n      ...filemetaData\n    }\n  }\n"])),qu);function Zu(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"Files",iconComponent:Object(x.jsx)(iu.a,{})},e))}var Xu,eb,tb,ab,nb,ib=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1],p=s.a.useState("Filename"),m=Object(u.a)(p,2),h=m[0],f=m[1],g=["Filename","Hash","Comment"],y=s.a.useState("Downloads"),v=Object(u.a)(y,2),_=v[0],k=v[1],w=["Uploads","Downloads","FileBrowser","Screenshots"],C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],T=function(t,a,n,r,c){var o=r||h,s=a||l,d=n||i,u=c||_;switch(e.changeSearchParam("host",d),e.changeSearchParam("search",s),o){case"Filename":e.onFilenameSearch({search:s,searchHost:d,offset:0,adjustedSearchLocation:u});break;case"Hash":e.onHashSearch({search:s,searchHost:d,offset:0,adjustedSearchLocation:u});break;case"Comment":e.onCommentSearch({search:s,searchHost:d,offset:0,adjustedSearchLocation:u})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="",i="Filename",c="Downloads";t.has("search")&&(d(t.get("search")),a=t.get("search")),t.has("searchField")&&g.includes(t.get("searchField"))?(f(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),i=t.get("searchField")):(f("Filename"),e.onChangeSearchField("Filename"),e.changeSearchParam("searchField","Filename")),t.has("location")&&w.includes(t.get("location"))&&(k(t.get("location")),c=t.get("location"),e.onChangeSearchLocation(t.get("location"))),t.has("host")&&(r(t.get("host")),n=t.get("host")),I(!D),T(0,a,n,i,c)}}),[e.value,e.index]),Object(x.jsxs)(ft.a,{container:!0,spacing:1,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(x.jsx)(ft.a,{item:!0,xs:2,children:Object(x.jsx)(j.a,{placeholder:"Host Name Search...",value:i,onChange:function(e,t,a){r(t)},onEnter:T,name:"Host Name Search..."})}),Object(x.jsx)(ft.a,{item:!0,xs:3,children:Object(x.jsx)(j.a,{placeholder:"Search...",value:l,onChange:function(e,t,a){d(t)},onEnter:T,name:"Search...",InputProps:{endAdornment:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(bo.a,{title:"Search",children:Object(x.jsx)(E.a,{onClick:T,children:Object(x.jsx)(Ud.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(x.jsxs)(ft.a,{item:!0,xs:2,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search File's"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:h,onChange:function(t){f(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:g.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(x.jsxs)(ft.a,{item:!0,xs:2,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search Location"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:_,onChange:function(t){k(t.target.value),e.onChangeSearchLocation(t.target.value),e.changeSearchParam("location",t.target.value)},children:w.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchlocopt"+e)}))})]}),Object(x.jsx)(ft.a,{item:!0,xs:2,children:Object(x.jsxs)(b.a,{variant:"contained",color:"primary",component:"label",children:["Host File in Mythic ",Object(x.jsx)("input",{onChange:function(e){!function(e){try{var t=new XMLHttpRequest,a=new FormData;t.open("POST",window.location.origin+"/api/v1.4/files/manual",!0),t.setRequestHeader("Authorization","Bearer "+localStorage.getItem("access_token")),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status)try{var e=JSON.parse(t.responseText);"success"===e.status?O.b.success("Successfuly hosted file! Now searchable on the 'Uploads' search"):O.b.error("Failed to host file! "+e.error)}catch(n){O.b.error("Failed to process response from upload: "+n),console.log(n)}else 4!==t.readyState||302!==t.status&&405!==t.status?4===t.readyState&&(console.log("httpGetAsync Error with data: "+a),O.b.error("Mythic hit an error trying to hos the file: "+t.status+": "+t.statusText)):(console.log("httpGetAsync was 302 or 405 from url "),O.b.error("Got HTTP 302 or 405 when trying to host file"))},a.append("upload_file",e),t.send(a)}catch(n){O.b.error("HTTP Browser error trying to upload file: "+n.toString()),console.error("HTTP Browser error: "+n.toString())}}(e.target.files[0])},type:"file",hidden:!0})]})})]})},rb=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState([]),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(0),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState(""),g=Object(u.a)(m,2),y=g[0],_=g[1],k=s.a.useState(""),w=Object(u.a)(k,2),C=w[0],S=w[1],D=s.a.useState("Filename"),I=Object(u.a)(D,2),T=I[0],$=I[1],P=s.a.useState("Downloads"),A=Object(u.a)(P,2),E=A[0],F=A[1],N=Object(f.a)(h.b),q=function(e){O.b.dismiss(),p(e.filemeta_aggregate.aggregate.count),l([]),i(e.filemeta)},R=function(e){O.b.dismiss(),p(e.filebrowserobj_aggregate.aggregate.count),l(e.filebrowserobj),i([])},B=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},M=Object(pt.a)(Mu,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),z=Object(u.a)(M,1)[0],W=Object(pt.a)(zu,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),H=Object(u.a)(W,1)[0],U=Object(pt.a)(Wu,{fetchPolicy:"no-cache",onCompleted:R,onError:B}),G=Object(u.a)(U,1)[0],K=Object(pt.a)(Qu,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),V=Object(u.a)(K,1)[0],Q=Object(pt.a)(Hu,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),J=Object(u.a)(Q,1)[0],Y=Object(pt.a)(Uu,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),Z=Object(u.a)(Y,1)[0],X=Object(pt.a)(Ju,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),ee=Object(u.a)(X,1)[0],te=Object(pt.a)(Gu,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),ae=Object(u.a)(te,1)[0],ne=Object(pt.a)(Ku,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),ie=Object(u.a)(ne,1)[0],re=Object(pt.a)(Vu,{fetchPolicy:"no-cache",onCompleted:R,onError:B}),ce=Object(u.a)(re,1)[0],oe=Object(pt.a)(Yu,{fetchPolicy:"no-cache",onCompleted:q,onError:B}),se=Object(u.a)(oe,1)[0],le=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;O.b.info("Searching...",{persist:!0}),_(t),S(a),"FileBrowser"===i?G({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,filename:"%"+t+"%",host:"%"+a+"%"}}):"Uploads"===i?z({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,filename:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===i?H({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,filename:"%"+t+"%",host:"%"+a+"%"}}):V({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,filename:"%"+t+"%",host:"%"+a+"%"}})},de=function(e){var t=e.search,a=e.searchHost,n=e.offset,r=e.adjustedSearchLocation;O.b.info("Searching...",{persist:!0}),_(t),S(a),"FileBrowser"===r?(O.b.dismiss(),O.b.warning("FileBrowser doesn't currently track file hashes"),p(0),l([]),i([])):"Uploads"===r?J({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,hash:"%"+t+"%",host:"%"+a+"%"}}):"Downloads"===r?Z({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,hash:"%"+t+"%",host:"%"+a+"%"}}):ee({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,hash:"%"+t+"%",host:"%"+a+"%"}})},ue=function(e){var t=e.search,a=e.searchHost,n=e.offset,i=e.adjustedSearchLocation;O.b.info("Searching...",{persist:!0});var r=t;""===t&&(r="_"),_(r),S(a),"FileBrowser"===i?ce({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,comment:"%"+r+"%",host:"%"+a+"%"}}):"Uploads"===i?ae({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,comment:"%"+r+"%",host:"%"+a+"%"}}):"Downloads"===i?ie({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,comment:"%"+r+"%",host:"%"+a+"%"}}):se({variables:{operation_id:N.user.current_operation_id,offset:n,fetchLimit:Bu,comment:"%"+r+"%",host:"%"+a+"%"}})};return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)(ib,{onChangeSearchField:function(e){switch($(e),e){case"Filename":le({search:y,searchHost:C,offset:0,adjustedSearchLocation:E});break;case"Hash":de({search:y,searchHost:C,offset:0,adjustedSearchLocation:E});break;case"Comments":ue({search:y,searchHost:C,offset:0,adjustedSearchLocation:E})}},onFilenameSearch:le,value:e.value,index:e.index,queryParams:e.queryParams,onHashSearch:de,onCommentSearch:ue,onChangeSearchLocation:function(e){switch(F(e),T){case"Filename":le({search:y,searchHost:C,offset:0,adjustedSearchLocation:e});break;case"Hash":de({search:y,searchHost:C,offset:0,adjustedSearchLocation:e});break;case"Comments":ue({search:y,searchHost:C,offset:0,adjustedSearchLocation:e})}},changeSearchParam:e.changeSearchParam}),Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?"Uploads"===E?Object(x.jsx)(mu,{files:n}):"Downloads"===E?Object(x.jsx)(ju,{files:n}):Object(x.jsx)(fu,{files:n}):o.length>0?Object(x.jsx)(Fu,{files:o}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(j/Bu),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(T){case"Filename":le({search:y,searchHost:C,offset:0});break;case"Hash":de({search:y,searchHost:C,offset:0});break;case"Comments":ue({search:y,searchHost:C,offset:0})}else switch(T){case"Filename":le({search:y,searchHost:C,offset:(t-1)*Bu});break;case"Hash":de({search:y,searchHost:C,offset:(t-1)*Bu});break;case"Comments":ue({search:y,searchHost:C,offset:(t-1)*Bu})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",j]})]})]}))},cb=a(309),ob=a.n(cb),sb=Object(be.a)(Xu||(Xu=Object(_.a)(["\nmutation updateCommentMutation($credential_id: Int!, $comment: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {comment: $comment}) {\n        comment\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),lb=Object(be.a)(eb||(eb=Object(_.a)(["\nmutation updateAccountMutation($credential_id: Int!, $account: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {account: $account}) {\n        account\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),db=Object(be.a)(tb||(tb=Object(_.a)(["\nmutation updateAccountMutation($credential_id: Int!, $realm: String!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {realm: $realm}) {\n        realm\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),ub=Object(be.a)(ab||(ab=Object(_.a)(["\nmutation updateAccountMutation($credential_id: Int!, $credential: bytea!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {credential_raw: $credential}) {\n        credential_text\n        id\n        operator {\n            username\n        }\n    }\n}\n"]))),bb=Object(be.a)(nb||(nb=Object(_.a)(["\nmutation updateAccountMutation($credential_id: Int!, $deleted: Boolean!){\n    update_credential_by_pk(pk_columns: {id: $credential_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n        operator {\n            username\n        }\n    }\n}\n"])));function jb(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.credentials))}),[e.credentials]);var r=function(e){var t=e.id,a=e.comment,r=e.operator,c=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{comment:a,operator:r}):Object(v.a)({},e)}));i(c)},c=function(e){var t=e.id,a=e.account,r=e.operator,c=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{account:a,operator:r}):Object(v.a)({},e)}));i(c)},l=function(e){var t=e.id,a=e.realm,r=e.operator,c=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{realm:a,operator:r}):Object(v.a)({},e)}));i(c)},d=function(e){var t=e.id,a=e.credential_text,r=e.operator,c=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{credential_text:a,operator:r}):Object(v.a)({},e)}));i(c)},b=function(e){var t=e.id,a=e.deleted,r=e.operator,c=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{deleted:a,operator:r}):Object(v.a)({},e)}));i(c)};return Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"4rem"},children:"Delete"}),Object(x.jsx)(C.a,{style:{width:"4rem"},children:"Edit"}),Object(x.jsx)(C.a,{children:"Account"}),Object(x.jsx)(C.a,{children:"Realm"}),Object(x.jsx)(C.a,{children:"Credential"}),Object(x.jsx)(C.a,{style:{width:"20rem"},children:"Comment"}),Object(x.jsx)(C.a,{style:{width:"15rem"},children:"Timestamp"}),Object(x.jsx)(C.a,{children:"Task / Operator"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Type"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsx)(pb,Object(v.a)({onEditComment:r,onEditAccount:c,onEditRealm:l,onEditCredential:d,onEditDeleted:b},e),"cred"+e.id)}))})]})})}function pb(e){var t,a=Object(f.a)(h.b),n=Object(ee.a)(),i=s.a.useState(!1),r=Object(u.a)(i,2),c=r[0],o=r[1],l=s.a.useState(!1),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState(!1),g=Object(u.a)(m,2),y=g[0],_=g[1],k=s.a.useState(!1),w=Object(u.a)(k,2),S=w[0],D=w[1],$=s.a.useState(!1),P=Object(u.a)($,2),A=P[0],F=P[1],N=s.a.useRef(null),q=s.a.useState(!1),R=Object(u.a)(q,2),B=R[0],z=R[1],W=e.credential_text.length>200?e.credential_text.slice(0,200)+"...":e.credential_text,H=Object(pe.a)(sb,{onCompleted:function(t){O.b.success("updated comment"),e.onEditComment(t.update_credential_by_pk)}}),U=Object(u.a)(H,1)[0],G=Object(pe.a)(lb,{onCompleted:function(t){O.b.success("updated account"),e.onEditAccount(t.update_credential_by_pk)}}),K=Object(u.a)(G,1)[0],V=Object(pe.a)(db,{onCompleted:function(t){O.b.success("updated realm"),e.onEditRealm(t.update_credential_by_pk)}}),Q=Object(u.a)(V,1)[0],J=Object(pe.a)(ub,{onCompleted:function(t){O.b.success("updated credential"),e.onEditCredential(t.update_credential_by_pk)}}),X=Object(u.a)(J,1)[0],te=Object(pe.a)(bb,{onCompleted:function(t){O.b.success("updated deleted status"),e.onEditDeleted(t.update_credential_by_pk)}}),ae=Object(u.a)(te,1)[0],ne=[{name:"Edit Account",click:function(e){e.stopPropagation(),_(!0)}},{name:"Edit Realm",click:function(e){D(!0)}},{name:"Edit Credential",click:function(e){F(!0)}},{name:"Edit Comment",click:function(e){p(!0)}}],ie=function(e){N.current&&N.current.contains(e.target)||z(!1)};return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(Oa.a,{onClose:function(){o(!1)},onSubmit:function(){ae({variables:{credential_id:e.id,deleted:!e.deleted}})},open:c,acceptText:e.deleted?"Restore":"Remove"}),j&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Credential Comment",onSubmit:function(t){U({variables:{credential_id:e.id,comment:t}})},value:e.comment,onClose:function(){p(!1)}})}),y&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:y,onClose:function(){_(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Credential Account",onSubmit:function(t){K({variables:{credential_id:e.id,account:t}})},value:e.account,onClose:function(){_(!1)}})}),S&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:S,onClose:function(){D(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Credential Realm",onSubmit:function(t){Q({variables:{credential_id:e.id,realm:t}})},value:e.realm,onClose:function(){D(!1)}})}),A&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:A,onClose:function(){F(!1)},innerDialog:Object(x.jsx)(Y.b,{title:"Edit Credential Credential",onSubmit:function(t){X({variables:{credential_id:e.id,credential:t}})},value:e.credential_text,onClose:function(){F(!1)}})}),Object(x.jsxs)(C.a,{children:[e.deleted?Object(x.jsx)(kt.a,{title:"Restore Credential for use in Tasking",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){o(!0)},style:{color:n.palette.success.main},variant:"contained",children:Object(x.jsx)(gc.a,{})})}):Object(x.jsx)(kt.a,{title:"Delete Credential so it can't be used in Tasking",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){o(!0)},style:{color:n.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})})})," "]}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(b.a,{size:"small",variant:"contained",color:"primary",ref:N,onClick:function(){return z(!0)},children:"Edit"}),Object(x.jsx)(tt.a,{open:B,anchorEl:N.current,role:void 0,transition:!0,style:{zIndex:4},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(x.jsx)(T.a,{variant:"outlined",style:{backgroundColor:"dark"===n.palette.type?n.palette.primary.dark:n.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:ie,children:Object(x.jsx)(nt.a,{id:"split-button-menu",children:ne.map((function(e,t){return Object(x.jsx)(at.a,{onClick:function(e){return function(e,t){ne[t].click(e),z(!1)}(e,t)},children:e.name},e.name+t)}))})})})}))}})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.account})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.realm})}),Object(x.jsx)(C.a,{children:e.credential_text.length>64?Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(kt.a,{title:"Copy to clipboard",children:Object(x.jsx)(E.a,{onClick:function(){return t=e.credential_text,void(Object(Xo.a)(t)?O.b.success("Copied text!"):O.b.error("Failed to copy text"));var t},size:"small",children:Object(x.jsx)(Mt.a,{icon:zt.f})})}),Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",maxWidth:"40rem"},children:W})]}):Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",maxWidth:"40rem"},children:W})})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.comment})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:Object(Z.b)(e.timestamp,(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.view_utc_time)||!1)})}),Object(x.jsx)(C.a,{children:null!==e.task_id?Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"/new/task/"+e.task_id,children:e.task_id}):e.operator.username}),Object(x.jsx)(C.a,{children:e.type})]})})}var mb,hb,fb,Ob,xb,gb,yb=a(176),vb=Object(be.a)(mb||(mb=Object(_.a)(["\nfragment credentialData on credential{\n    account\n    comment\n    credential_text\n    id\n    realm\n    type\n    task_id\n    timestamp\n    deleted\n    operator {\n        username\n    }\n}\n"]))),_b=20,kb=Object(be.a)(hb||(hb=Object(_.a)(["\n","\nquery accountQuery($operation_id: Int!, $account: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {account: {_ilike: $account}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),vb),wb=Object(be.a)(fb||(fb=Object(_.a)(["\n","\nquery accountQuery($operation_id: Int!, $realm: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {realm: {_ilike: $realm}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),vb),Cb=Object(be.a)(Ob||(Ob=Object(_.a)(["\n","\nquery accountQuery($operation_id: Int!, $credential: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {credential_text: {_ilike: $credential}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),vb),Sb=Object(be.a)(xb||(xb=Object(_.a)(["\n","\nquery accountQuery($operation_id: Int!, $comment: String!, $offset: Int!, $fetchLimit: Int!) {\n    credential_aggregate(distinct_on: id, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    credential(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {comment: {_ilike: $comment}, operation_id: {_eq: $operation_id}}) {\n      ...credentialData\n    }\n  }\n"])),vb),Db=Object(be.a)(gb||(gb=Object(_.a)(["\n","\nmutation createCredential($comment: String!, $account: String!, $realm: String!, $type: String!, $credential: bytea!) {\n    insert_credential_one(object: {account: $account, credential_raw: $credential, comment: $comment, realm: $realm, type: $type}) {\n      id\n    }\n  }\n"])),vb);function Ib(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"Credentials",iconComponent:Object(x.jsx)(ob.a,{})},e))}var Tb,$b,Pb,Ab,Eb,Lb,Fb,Nb=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Account"),o=Object(u.a)(c,2),l=o[0],d=o[1],p=["Account","Realm","Comment","Credential"],m=s.a.useState(!1),h=Object(u.a)(m,2),f=h[0],g=h[1],y=Object(pe.a)(Db,{fetchPolicy:"no-cache",onCompleted:function(e){O.b.success("Successfully created new credential")},onError:function(e){O.b.error("Failed to create credential"),console.log(e)}}),v=Object(u.a)(y,1)[0],_=function(t,a,n){var r=n||l,c=a||i;switch(e.changeSearchParam("search",c),r){case"Account":e.onAccountSearch({search:c,offset:0});break;case"Realm":e.onRealmSearch({search:c,offset:0});break;case"Comment":e.onCommentSearch({search:c,offset:0});break;case"Credential":e.onCredentialSearch({search:c,offset:0});break;case"Type":e.OnTypeSearch({search:c,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Account";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&p.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Account"),e.onChangeSearchField("Account"),e.changeSearchParam("searchField","Account")),_(0,a,n)}}),[e.value,e.index]),Object(x.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(x.jsx)(ft.a,{item:!0,xs:5,children:Object(x.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(e,t,a){r(t)},onEnter:_,name:"Search...",InputProps:{endAdornment:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(bo.a,{title:"Search",children:Object(x.jsx)(E.a,{onClick:_,children:Object(x.jsx)(Ud.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(x.jsxs)(ft.a,{item:!0,xs:2,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search Credential's"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:p.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchopt"+e)}))})]}),Object(x.jsxs)(ft.a,{item:!0,xs:2,children:[Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:f,onClose:function(){g(!1)},innerDialog:Object(x.jsx)(yb.a,{onSubmit:function(e){var t=e.type,a=e.account,n=e.realm,i=e.comment,r=e.credential;v({variables:{type:t,account:a,realm:n,comment:i,credential:r}})},onClose:function(){g(!1)}})}),Object(x.jsx)(b.a,{size:"small",color:"primary",onClick:function(){g(!0)},variant:"contained",children:"New Credential"})]})]})},qb=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Account"),g=Object(u.a)(m,2),y=g[0],_=g[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.credential_aggregate.aggregate.count),i(e.credential)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(kb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(wb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(Cb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(Sb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:_b,account:"%"+t+"%"}})},N=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:_b,realm:"%"+t+"%"}})},q=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:_b,credential:"%"+t+"%"}})},R=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:_b,comment:"%"+n+"%"}})};return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)(Nb,{onChangeSearchField:function(e){switch(_(e),e){case"Account":F({search:j,offset:0});break;case"Realm":N({search:j,offset:0});break;case"Credential":q({search:j,offset:0});break;case"Comment":R({search:j,offset:0})}},onAccountSearch:F,value:e.value,index:e.index,onRealmSearch:N,onCredentialSearch:q,onCommentSearch:R,changeSearchParam:e.changeSearchParam}),Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(x.jsx)(jb,{credentials:n}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(o/_b),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Account":F({search:j,offset:0});break;case"Realm":N({search:j,offset:0});break;case"Credential":q({search:j,offset:0});break;case"Comment":R({search:j,offset:0})}else switch(y){case"Account":F({search:j,offset:(t-1)*_b});break;case"Realm":N({search:j,offset:(t-1)*_b});break;case"Credential":q({search:j,offset:(t-1)*_b});break;case"Comment":R({search:j,offset:(t-1)*_b})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))};function Rb(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(o.useEffect)((function(){for(var t=e.keylogs.reduce((function(e,t){return void 0===e[t.user]?e[t.user]=Object(jt.a)({},t.task.callback.host,Object(jt.a)({},t.window,[Object(v.a)({},t)])):"undefined"===e[t.user][t.task.callback.host]?e[t.user][t.task.callback.host]=Object(jt.a)({},t.window,[Object(v.a)({},t)]):void 0===e[t.user][t.task.callback.host][t.window]?e[t.user][t.task.callback.host][t.window]=[Object(v.a)({},t)]:e[t.user][t.task.callback.host][t.window].push(Object(v.a)({},t)),Object(v.a)({},e)}),{}),a=[],n=0,r=Object.entries(t);n<r.length;n++){for(var c=Object(u.a)(r[n],2),o=c[0],s=c[1],l=[],d=0,b=Object.entries(s);d<b.length;d++){for(var j=Object(u.a)(b[d],2),p=j[0],m=j[1],h=[],f=0,O=Object.entries(m);f<O.length;f++){var x=Object(u.a)(O[f],2),g=x[0],y=x[1];h.push({name:g,value:y.reverse()})}l.push({name:p,value:h.reverse()})}a.push({name:o,value:l.reverse()})}console.log(a),i([].concat(a))}),[e.keylogs]),Object(x.jsx)(ft.a,{container:!0,spacing:0,direction:"row",columns:12,children:n.map((function(e){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(ft.a,{item:!0,xs:2,style:{borderBottom:"2px solid grey"},children:e.name}),Object(x.jsx)(ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:"2px solid grey"},children:e.value.map((function(t,a){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(ft.a,{item:!0,xs:2,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.name}),Object(x.jsx)(ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:a+1!==e.value.length?"2px solid grey":""},children:t.value.map((function(a,n){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(ft.a,{item:!0,xs:2,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:[" ",a.name," "]}),Object(x.jsx)(ft.a,{container:!0,item:!0,spacing:0,xs:10,style:{borderBottom:n+1!==t.value.length?"2px solid grey":""},children:Object(x.jsx)(ft.a,{item:!0,xs:12,children:a.value.map((function(n,i){return Object(x.jsx)("span",{children:n.keystrokes_text},e.name+t.name+a.name+i)}))})})]},e.name+t.name+a.name)}))})]},e.name+t.name)}))})]},e.name)}))})}var Bb=Object(be.a)(Tb||(Tb=Object(_.a)(["\nfragment keylogData on keylog{\n    keystrokes_text\n    task {\n        id\n        callback {\n            host\n            id\n        }\n    }\n    user\n    window\n    timestamp\n    id\n}\n"]))),Mb=200,zb=Object(be.a)($b||($b=Object(_.a)(["\n","\nquery keylogQuery($operation_id: Int!, $keylog: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {keystrokes_text: {_ilike: $keylog}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Bb),Wb=Object(be.a)(Pb||(Pb=Object(_.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: user, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: user, offset: $offset, order_by: {user: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Bb),Hb=Object(be.a)(Ab||(Ab=Object(_.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {user: {_ilike: $user}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Bb),Ub=Object(be.a)(Eb||(Eb=Object(_.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Bb),Gb=Object(be.a)(Lb||(Lb=Object(_.a)(["\n","\nquery programQuery($operation_id: Int!, $program: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: window, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: window, offset: $offset, order_by: {window: desc}, where: {window: {_ilike: $program}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Bb),Kb=Object(be.a)(Fb||(Fb=Object(_.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    keylog_aggregate(distinct_on: id, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    keylog(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {host: {_ilike: $host}}}, operation_id: {_eq: $operation_id}}) {\n      ...keylogData\n    }\n  }\n"])),Bb);function Vb(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"Keylogs",iconComponent:Object(x.jsx)(Ml.a,{})},e))}var Qb,Jb,Yb,Zb,Xb=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Keystroke"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Keystroke","User","Program","Host"],p=function(t,a,n){var r=n||l,c=a||i;switch(e.changeSearchParam("search",c),r){case"Keystroke":e.onKeylogSearch({search:c,offset:0});break;case"User":e.onUserSearch({search:c,offset:0});break;case"Program":e.onProgramSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Keystroke";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Keystroke"),e.onChangeSearchField("Keystroke"),e.changeSearchParam("searchField","Keystroke")),p(0,a,n)}}),[e.value,e.index]),Object(x.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(e,t,a){r(t)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(bo.a,{title:"Search",children:Object(x.jsx)(E.a,{onClick:p,children:Object(x.jsx)(Ud.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(x.jsxs)(ft.a,{item:!0,xs:2,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search Keylog's"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchopt"+e)}))})]})]})},ej=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Keystroke"),g=Object(u.a)(m,2),y=g[0],_=g[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(zb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(Hb,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(Wb,{fetchPolicy:"no-cache",onCompleted:function(e){O.b.dismiss(),0===e.keylog_aggregate.aggregate.count?O.b.info("No Results"):O.b.success("Showing One Entry for Each Unique User"),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),P=Object(u.a)($,1)[0],A=Object(pt.a)(Ub,{fetchPolicy:"no-cache",onCompleted:w,onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(Gb,{fetchPolicy:"no-cache",onCompleted:function(e){O.b.dismiss(),0===e.keylog_aggregate.aggregate.count?O.b.info("No Results"):O.b.success("Showing One Entry for Each Unique Program"),l(e.keylog_aggregate.aggregate.count),i(e.keylog)},onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),N=Object(u.a)(F,1)[0],q=Object(pt.a)(Kb,{fetchPolicy:"no-cache",onCompleted:w,onError:function(e){O.b.error("Failed to fetch data for search"),console.log(e)}}),R=Object(u.a)(q,1)[0],B=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Mb,keylog:"%"+n+"%"}})},M=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),""===t?P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Mb,user:"%_%"}}):T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Mb,user:"%"+t+"%"}})},z=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t),""===t?N({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Mb,program:"%_%"}}):E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Mb,program:"%"+t+"%"}})},W=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),R({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Mb,host:"%"+n+"%"}})};return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)(Xb,{onChangeSearchField:function(e){switch(_(e),i([]),e){case"Keystroke":B({search:j,offset:0});break;case"User":M({search:j,offset:0});break;case"Program":z({search:j,offset:0});break;case"Host":W({search:j,offset:0})}},onKeylogSearch:B,value:e.value,index:e.index,onUserSearch:M,onProgramSearch:z,onHostSearch:W,changeSearchParam:e.changeSearchParam}),Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(x.jsx)(Rb,{keylogs:n}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(o/Mb),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Keystroke":B({search:j,offset:0});break;case"User":M({search:j,offset:0});break;case"Program":z({search:j,offset:0});break;case"Host":W({search:j,offset:0})}else switch(y){case"Keystroke":B({search:j,offset:(t-1)*Mb});break;case"User":M({search:j,offset:(t-1)*Mb});break;case"Program":z({search:j,offset:(t-1)*Mb});break;case"Host":W({search:j,offset:(t-1)*Mb})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},tj=a(215),aj=a.n(tj),nj=a(298),ij=Object(be.a)(Qb||(Qb=Object(_.a)(["\nmutation updateComment ($token_id: Int!, $description: String) {\n  update_token_by_pk(pk_columns: {id: $token_id}, _set: {description: $description}) {\n    description\n    id\n  }\n}\n"]))),rj=Object(be.a)(Jb||(Jb=Object(_.a)(["\nquery getCommentQuery ($token_id: Int!) {\n  token_by_pk(id: $token_id) {\n    description\n    id\n  }\n}\n"])));function cj(e){var t=Object(o.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(je.a)(rj,{variables:{token_id:e.token_id},onCompleted:function(e){i(e.token_by_pk.description)},fetchPolicy:"network-only"});var r=Object(pe.a)(ij,{onCompleted:function(t){console.log("udpated"),e.onClose()},onError:function(t){console.error(t),e.onClose()}}),c=Object(u.a)(r,1)[0],l=function(){c({variables:{token_id:e.token_id,description:n}})};return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Edit Token Description"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(j.a,{autoFocus:!0,onEnter:l,onChange:function(e,t,a){i(t)},value:n})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:l,variant:"contained",color:"secondary",children:"Submit"})]})]})}var oj,sj,lj,dj,uj,bj=Object(be.a)(Yb||(Yb=Object(_.a)(["\nmutation updateCredentialDeletedMutation($token_id: Int!, $deleted: Boolean!){\n    update_token_by_pk(pk_columns: {id: $token_id}, _set: {deleted: $deleted}) {\n        deleted\n        id\n    }\n}\n"]))),jj=Object(be.a)(Zb||(Zb=Object(_.a)(["\nmutation updateCallbacksOfDeletedTokenMutation($token_id: Int!, $deleted: Boolean!){\n    update_callbacktoken(where: {token_id: {_eq: $token_id}}, _set: {deleted: $deleted}) {\n        affected_rows\n    }\n}\n"])));function pj(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.tokens))}),[e.credentials]);var r=function(e){var t=e.id,a=e.deleted,r=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{deleted:a}):Object(v.a)({},e)}));i(r)};return Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Delete"}),Object(x.jsx)(C.a,{children:"User"}),Object(x.jsx)(C.a,{children:"Groups"}),Object(x.jsx)(C.a,{children:"TokenId"}),Object(x.jsx)(C.a,{children:"Logon Session"}),Object(x.jsx)(C.a,{children:"Description"}),Object(x.jsx)(C.a,{children:"Task"}),Object(x.jsx)(C.a,{children:"Callbacks With Handles"}),Object(x.jsx)(C.a,{children:"Host"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsx)(mj,Object(v.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function mj(e){var t,a=Object(ee.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState(!1),l=Object(u.a)(o,2),d=l[0],b=l[1],j=s.a.useState(!1),p=Object(u.a)(j,2),m=p[0],h=p[1],f=Object(pe.a)(jj,{onCompleted:function(e){O.b.success("Removed token from callback")},onError:function(e){O.b.error("Operation not allowed")}}),g=Object(u.a)(f,1)[0],y=Object(pe.a)(bj,{onCompleted:function(t){O.b.success("Updated deleted status"),null===e.callbacktokens||e.deleted||g({variables:{token_id:e.id,deleted:!0}}),e.onEditDeleted(t.update_token_by_pk)},onError:function(e){O.b.error("Operation not allowed")}}),v=Object(u.a)(y,1)[0];return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(Oa.a,{onClose:function(){c(!1)},onSubmit:function(){v({variables:{token_id:e.id,deleted:!e.deleted}})},open:r,acceptText:e.deleted?"Restore":"Remove"}),Object(x.jsxs)(C.a,{children:[e.deleted?Object(x.jsx)(kt.a,{title:"Restore Token for use in Tasking",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(x.jsx)(gc.a,{})})}):Object(x.jsx)(kt.a,{title:"Delete Token so it can't be used in Tasking",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})})})," "]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.User})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.Groups})}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.TokenId}),Object(x.jsx)(kt.a,{title:"View Token Information",children:Object(x.jsx)(E.a,{size:"small",color:"primary",onClick:function(){b(!0)},children:Object(x.jsx)(aj.a,{})})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:d,onClose:function(){b(!1)},innerDialog:Object(x.jsx)(nj.a,{token_id:e.id,onClose:function(){b(!1)}})})]}),Object(x.jsx)(C.a,{children:null===e.logonsession?Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:"No Logon Session Data"}):Object(x.jsxs)(s.a.Fragment,{children:[e.logonsession.LogonId," ",null!==e.logonsession.LogonType?" ("+e.logonsession.LogonType+")":null]})}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description}),Object(x.jsx)(E.a,{onClick:function(){return h(!0)},size:"small",children:Object(x.jsx)(ki.a,{})}),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:m,onClose:function(){h(!1)},innerDialog:Object(x.jsx)(cj,{token_id:e.id,onClose:function(){h(!1)}})})]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(x.jsx)(C.a,{children:(null===(t=e.callbacktokens)||void 0===t?void 0:t.map((function(e){return e.callback_id})))||null}),Object(x.jsx)(C.a,{children:e.host})]})})}var hj=Object(be.a)(oj||(oj=Object(_.a)(["\nfragment tokenData on token{\n    id\n    User\n    Groups\n    TokenId\n    logonsession {\n        LogonType\n        UserName\n        LogonDomain\n        id\n        LogonId\n        authenticationpackages(where: {deleted: {_eq: false}}) {\n            Name\n            id\n        }\n    }\n    task {\n        id\n    }\n    host\n    deleted\n    description\n    callbacktokens(where: {deleted: {_eq: false}}) {\n        callback_id\n        id\n    }\n}\n"]))),fj=20,Oj=Object(be.a)(sj||(sj=Object(_.a)(["\n","\nquery usergroupQuery($operation_id: Int!, $name: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{Groups: {_ilike: $name}}, {User: {_ilike: $name}}, {logonsession: {UserName: {_ilike: $name}}}]}) {\n      ...tokenData\n    }\n}\n"])),hj),xj=Object(be.a)(lj||(lj=Object(_.a)(["\n","\nquery sidQuery($operation_id: Int!, $sid: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback: {operation_id: {_eq: $operation_id}}}, _or: [{AppContainerSid: {_ilike: $sid}}, {LogonSid: {_ilike: $sid}}, {Owner: {_ilike: sid}}, {PrimaryGroup: {_ilike: sid}}, {DefaultDacl: {_ilike: sid}}]}) {\n      ...tokenData\n    }\n}\n"])),hj),gj=Object(be.a)(dj||(dj=Object(_.a)(["\n","\nquery logontypeQuery($operation_id: Int!, $logontype: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {logonsession: {LogonType: { _ilike: $logontype}}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n  }\n"])),hj),yj=Object(be.a)(uj||(uj=Object(_.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    token_aggregate(distinct_on: id, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      aggregate {\n        count\n      }\n    }\n    token(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n      ...tokenData\n    }\n}\n"])),hj);function vj(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"Tokens",iconComponent:Object(x.jsx)(aj.a,{})},e))}var _j,kj,wj,Cj,Sj,Dj,Ij=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("User/Group"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["User/Group","SID","LogonType","Host"],p=function(t,a,n){var r=n||l,c=a||i;switch(e.changeSearchParam("search",c),r){case"User/Group":e.onUserGroupSearch({search:c,offset:0});break;case"SID":e.onSIDSearch({search:c,offset:0});break;case"LogonType":e.onLogonTypeSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User/Group";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User/Group"),e.onChangeSearchField("User/Group"),e.changeSearchParam("searchField","User/Group")),p(0,a,n)}}),[e.value,e.index]),Object(x.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(e,t,a){r(t)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(bo.a,{title:"Search",children:Object(x.jsx)(E.a,{onClick:p,children:Object(x.jsx)(Ud.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(x.jsxs)(ft.a,{item:!0,xs:2,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search Tokens by"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchopt"+e)}))})]})]})},Tj=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("User/Group"),g=Object(u.a)(m,2),y=g[0],_=g[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.token_aggregate.aggregate.count),i(e.token)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(Oj,{fetchPolicy:"network-only",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(xj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(gj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(yj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:fj,name:"%"+n+"%"}})},N=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:fj,logontype:"%"+n+"%"}})},q=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:fj,host:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:fj,sid:"%"+n+"%"}})};return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)(Ij,{onChangeSearchField:function(e){switch(_(e),i([]),e){case"User/Group":F({search:j,offset:0});break;case"SID":R({search:j,offset:0});break;case"LogonType":N({search:j,offset:0});break;case"Host":q({search:j,offset:0})}},onUserGroupSearch:F,value:e.value,index:e.index,onLogonTypeSearch:N,onHostSearch:q,onSIDSearch:R,changeSearchParam:e.changeSearchParam}),Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(x.jsx)(pj,{tokens:n}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(o/fj),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"User/Group":F({search:j,offset:0});break;case"SID":R({search:j,offset:0});break;case"LogonType":N({search:j,offset:0});break;case"Host":q({search:j,offset:0})}else switch(y){case"User/Group":F({search:j,offset:(t-1)*fj});break;case"SID":R({search:j,offset:(t-1)*fj});break;case"LogonType":N({search:j,offset:(t-1)*fj});break;case"Host":q({search:j,offset:(t-1)*fj})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},$j=a(241),Pj=a.n($j);function Aj(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.callbacks))}),[e.callbacks]);var r=function(e){var t=e.id,a=e.active,r=n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{active:a}):Object(v.a)({},e)}));i(r)};return Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"auto"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Hide"}),Object(x.jsx)(C.a,{children:"User"}),Object(x.jsx)(C.a,{children:"Domain"}),Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:"Description"}),Object(x.jsx)(C.a,{children:"IP"}),Object(x.jsx)(C.a,{children:"ID"}),Object(x.jsx)(C.a,{children:"Checkin Times"}),Object(x.jsx)(C.a,{children:"Details"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsx)(Ej,Object(v.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function Ej(e){var t=Object(f.a)(h.b),a=Object(ee.a)(),n=s.a.useState(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],o=s.a.useState(!1),l=Object(u.a)(o,2),d=l[0],b=l[1],j=Object(pe.a)(Pl,{onCompleted:function(t){O.b.success("Updated active status"),e.onEditDeleted({id:e.id,active:!e.active})},onError:function(e){O.b.error("Operation not allowed")}}),p=Object(u.a)(j,1)[0];return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(Oa.a,{onClose:function(){c(!1)},onSubmit:function(){p({variables:{callback_id:e.id,active:!e.active}})},open:r,acceptText:e.active?"Hide":"Restore"}),Object(x.jsxs)(C.a,{children:[e.active?Object(x.jsx)(kt.a,{title:"Hide Callback so it can't be used in Tasking",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})})}):Object(x.jsx)(kt.a,{title:"Restore Callback for Tasking",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){c(!0)},style:{color:a.palette.success.main},variant:"contained",children:Object(x.jsx)(gc.a,{})})})," "]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(x.jsx)(C.a,{children:e.host}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(x.jsx)(C.a,{children:e.ip}),Object(x.jsx)(C.a,{children:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})}),Object(x.jsxs)(C.a,{children:[Object(x.jsxs)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Initial: ",Object(Z.b)(e.init_callback,t.user.view_utc_time)]}),Object(x.jsxs)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:["Latest: ",Object(Z.b)(e.last_checkin,t.user.view_utc_time)]})]}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(On.a,{onClick:function(){return b(!0)},style:{color:a.palette.info.main}}),d&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"lg",open:d,onClose:function(){b(!1)},innerDialog:Object(x.jsx)(Jl,{onClose:function(){b(!1)},callback_id:e.id})})]})]})})}var Lj=Object(be.a)(_j||(_j=Object(_.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n}\n"]))),Fj=50,Nj=Object(be.a)(kj||(kj=Object(_.a)(["\n","\nquery userQuery($operation_id: Int!, $user: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, user: {_ilike: $user}}) {\n      ...callbackData\n    }\n}\n"])),Lj),qj=Object(be.a)(wj||(wj=Object(_.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Lj),Rj=Object(be.a)(Cj||(Cj=Object(_.a)(["\n","\nquery domainQuery($operation_id: Int!, $domain: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {domain: {_ilike: $domain}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Lj),Bj=Object(be.a)(Sj||(Sj=Object(_.a)(["\n","\nquery domainQuery($operation_id: Int!, $description: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {description: {_ilike: $description}, operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Lj),Mj=Object(be.a)(Dj||(Dj=Object(_.a)(["\n","\nquery domainQuery($operation_id: Int!, $ip: String!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {_or: [{ip: {_ilike: $ip}}, {external_ip: {_ilike: $ip}}], operation_id: {_eq: $operation_id}}) {\n      ...callbackData\n    }\n}\n"])),Lj);function zj(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"Callbacks",iconComponent:Object(x.jsx)(Pj.a,{})},e))}var Wj,Hj,Uj,Gj,Kj,Vj,Qj,Jj=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("User"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["User","Domain","Host","Description","IP"],p=function(t,a,n){var r=n||l,c=a||i;switch(e.changeSearchParam("search",c),r){case"User":e.onUserSearch({search:c,offset:0});break;case"Domain":e.onDomainSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0});break;case"Description":e.onDescriptionSearch({search:c,offset:0});break;case"IP":e.onIPSearch({search:c,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="User";t.has("search")&&(r(t.get("search")),a=t.get("search")),console.log(t.get("searchField")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("User"),e.onChangeSearchField("User"),e.changeSearchParam("searchField","User")),p(0,a,n)}}),[e.value,e.index]),Object(x.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(e,t,a){r(t)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(bo.a,{title:"Search",children:Object(x.jsx)(E.a,{onClick:p,children:Object(x.jsx)(Ud.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(x.jsxs)(ft.a,{item:!0,xs:6,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search Callbacks by"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchopt"+e)}))})]})]})},Yj=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("User"),g=Object(u.a)(m,2),y=g[0],_=g[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.callback_aggregate.aggregate.count),i(e.callback)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(Nj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(Rj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(Bj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(qj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(Mj,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),N=Object(u.a)(F,1)[0],q=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Fj,user:"%"+n+"%"}})},R=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Fj,domain:"%"+n+"%"}})},B=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Fj,host:"%"+n+"%"}})},M=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Fj,description:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),N({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:Fj,ip:"%"+n+"%"}})};return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)(Jj,{onChangeSearchField:function(e){switch(_(e),e){case"User":q({search:j,offset:0});break;case"Domain":R({search:j,offset:0});break;case"Description":M({search:j,offset:0});break;case"Host":B({search:j,offset:0});break;case"IP":z({search:j,offset:0})}},onUserSearch:q,onIPSearch:z,value:e.value,index:e.index,onDomainSearch:R,onHostSearch:B,onDescriptionSearch:M,changeSearchParam:e.changeSearchParam}),Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(x.jsx)(Aj,{callbacks:n}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"5px",paddingBottom:"5px"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(o/Fj),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"User":q({search:j,offset:0});break;case"Domain":R({search:j,offset:0});break;case"Description":M({search:j,offset:0});break;case"Host":B({search:j,offset:0});break;case"IP":z({search:j,offset:0})}else switch(y){case"User":q({search:j,offset:(t-1)*Fj});break;case"Domain":R({search:j,offset:(t-1)*Fj});break;case"Description":M({search:j,offset:(t-1)*Fj});break;case"Host":B({search:j,offset:(t-1)*Fj});break;case"IP":z({search:j,offset:(t-1)*Fj})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},Zj=a(310),Xj=a.n(Zj);function ep(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];return Object(o.useEffect)((function(){i(Object(y.a)(e.artifacts))}),[e.artifacts]),Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{},children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Type"}),Object(x.jsx)(C.a,{children:"Command"}),Object(x.jsx)(C.a,{children:"Task"}),Object(x.jsx)(C.a,{children:"Callback"}),Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:"Artifact"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsx)(tp,Object(v.a)({},e),"cred"+e.id)}))})]})})}function tp(e){return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.artifact.name})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.task.command.cmd})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/task/"+e.task.id,children:e.task.id})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.task.callback_id,children:e.task.callback_id})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.host})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.artifact_instance_text})})]})})}var ap=Object(be.a)(Wj||(Wj=Object(_.a)(["\nfragment artifactData on taskartifact{\n    id\n    artifact_instance_text\n    host\n    id\n    timestamp\n    artifact {\n        name\n        description\n    }\n    task {\n        id\n        callback_id\n        command {\n            cmd\n        }\n    }\n}\n"]))),np=100,ip=Object(be.a)(Hj||(Hj=Object(_.a)(["\n","\nquery artifactQuery($operation_id: Int!, $artifact: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, artifact_instance_text: {_ilike: $artifact}}) {\n      ...artifactData\n    }\n}\n"])),ap),rp=Object(be.a)(Uj||(Uj=Object(_.a)(["\n","\nquery hostQuery($operation_id: Int!, $host: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {host: {_ilike: $host}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),ap),cp=Object(be.a)(Gj||(Gj=Object(_.a)(["\n","\nquery commandQuery($operation_id: Int!, $command: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {command: {cmd: {_ilike: $command}}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),ap),op=Object(be.a)(Kj||(Kj=Object(_.a)(["\n","\nquery typeQuery($operation_id: Int!, $type: String!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {artifact: {name: {_ilike: $type}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),ap),sp=Object(be.a)(Vj||(Vj=Object(_.a)(["\n","\nquery taskQuery($operation_id: Int!, $task_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task_id: {_eq: $task_id}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),ap),lp=Object(be.a)(Qj||(Qj=Object(_.a)(["\n","\nquery taskQuery($operation_id: Int!, $callback_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    taskartifact_aggregate(distinct_on: id, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}){\n      aggregate {\n        count\n      }\n    }\n    taskartifact(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {task: {callback_id: {_eq: $callback_id}}, operation_id: {_eq: $operation_id}}) {\n      ...artifactData\n    }\n}\n"])),ap);function dp(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"Artifacts",iconComponent:Object(x.jsx)(Xj.a,{})},e))}var up,bp,jp,pp=function(e){var t=Object(ee.a)(),a=s.a.useState(""),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState("Artifact"),o=Object(u.a)(c,2),l=o[0],d=o[1],b=["Artifact","Command","Host","Type","Task","Callback"],p=function(t,a,n){var r=n||l,c=a||i;switch(e.changeSearchParam("search",c),r){case"Artifact":e.onArtifactSearch({search:c,offset:0});break;case"Command":e.onCommandSearch({search:c,offset:0});break;case"Host":e.onHostSearch({search:c,offset:0});break;case"Type":e.onTypeSearch({search:c,offset:0});break;case"Task":e.onTaskSearch({search:c,offset:0});break;case"Callback":e.onCallbackSearch({search:c,offset:0})}};return s.a.useEffect((function(){if(e.value===e.index){var t=new URLSearchParams(window.location.search),a="",n="Artifact";t.has("search")&&(r(t.get("search")),a=t.get("search")),t.has("searchField")&&b.includes(t.get("searchField"))?(d(t.get("searchField")),e.onChangeSearchField(t.get("searchField")),n=t.get("searchField")):(d("Artifact"),e.onChangeSearchField("Artifact"),e.changeSearchParam("searchField","Artifact")),p(0,a,n)}}),[e.value,e.index]),Object(x.jsxs)(ft.a,{container:!0,spacing:2,style:{paddingTop:"10px",paddingLeft:"10px",maxWidth:"100%"},children:[Object(x.jsx)(ft.a,{item:!0,xs:6,children:Object(x.jsx)(j.a,{placeholder:"Search...",value:i,onChange:function(e,t,a){r(t)},onEnter:p,name:"Search...",InputProps:{endAdornment:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(bo.a,{title:"Search",children:Object(x.jsx)(E.a,{onClick:p,children:Object(x.jsx)(Ud.a,{style:{color:t.palette.info.main}})})})}),style:{padding:0}}})}),Object(x.jsxs)(ft.a,{item:!0,xs:6,children:[Object(x.jsx)(Wd.a,{component:"legend",children:"Search Artifacts by"}),Object(x.jsx)(ht.a,{style:{marginBottom:"10px",width:"15rem",marginTop:"5px"},value:l,onChange:function(t){d(t.target.value),e.onChangeSearchField(t.target.value),e.changeSearchParam("searchField",t.target.value)},children:b.map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"searchopt"+e)}))})]})]})},mp=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),o=c[0],l=c[1],d=s.a.useState(""),b=Object(u.a)(d,2),j=b[0],p=b[1],m=s.a.useState("Artifact"),g=Object(u.a)(m,2),y=g[0],_=g[1],k=Object(f.a)(h.b),w=function(e){O.b.dismiss(),l(e.taskartifact_aggregate.aggregate.count),i(e.taskartifact)},C=function(e){O.b.dismiss(),O.b.error("Failed to fetch data for search"),console.log(e)},S=Object(pt.a)(ip,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),D=Object(u.a)(S,1)[0],I=Object(pt.a)(cp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),T=Object(u.a)(I,1)[0],$=Object(pt.a)(op,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),P=Object(u.a)($,1)[0],A=Object(pt.a)(rp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),E=Object(u.a)(A,1)[0],F=Object(pt.a)(sp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),N=Object(u.a)(F,1)[0],q=Object(pt.a)(lp,{fetchPolicy:"no-cache",onCompleted:w,onError:C}),R=Object(u.a)(q,1)[0],B=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),D({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:np,artifact:"%"+n+"%"}})},M=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),T({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:np,command:"%"+n+"%"}})},z=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),E({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:np,host:"%"+n+"%"}})},W=function(e){var t=e.search,a=e.offset;O.b.info("Searching...",{persist:!0}),p(t);var n=t;""===n&&(n="_"),P({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:np,type:"%"+n+"%"}})},H=function(e){var t=e.search,a=e.offset;""!==t?(O.b.info("Searching...",{persist:!0}),p(t),N({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:np,task_id:parseInt(t)}})):O.b.warning("Must specify a task number")},U=function(e){var t=e.search,a=e.offset;""!==t?(O.b.info("Searching...",{persist:!0}),p(t),R({variables:{operation_id:k.user.current_operation_id,offset:a,fetchLimit:np,callback_id:t}})):O.b.warning("Must specify a callback number")};return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)(pp,{onChangeSearchField:function(e){switch(_(e),e){case"Artifact":B({search:j,offset:0});break;case"Command":M({search:j,offset:0});break;case"Type":W({search:j,offset:0});break;case"Host":z({search:j,offset:0});break;case"Task":H({search:j,offset:0});break;case"Callback":U({search:j,offset:0})}},onArtifactSearch:B,onTaskSearch:H,value:e.value,index:e.index,onCommandSearch:M,onHostSearch:z,onTypeSearch:W,onCallbackSearch:U,changeSearchParam:e.changeSearchParam}),Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(x.jsx)(ep,{artifacts:n}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"5px",paddingBottom:"10px"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(o/np),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){if(1===t)switch(y){case"Artifact":B({search:j,offset:0});break;case"Command":M({search:j,offset:0});break;case"Type":W({search:j,offset:0});break;case"Host":z({search:j,offset:0});break;case"Task":H({search:j,offset:0});break;case"Callback":U({search:j,offset:0})}else switch(y){case"Artifact":B({search:j,offset:(t-1)*np});break;case"Command":M({search:j,offset:(t-1)*np});break;case"Type":W({search:j,offset:(t-1)*np});break;case"Host":z({search:j,offset:(t-1)*np});break;case"Task":H({search:j,offset:(t-1)*np});break;case"Callback":U({search:j,offset:(t-1)*np})}},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",o]})]})]}))},hp=Object(be.a)(up||(up=Object(_.a)(["\nmutation StopSocksMutation($callback_id: Int!){\n    stop_socks(callback_id: $callback_id){\n        status\n        error\n    }\n}\n"])));function fp(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1];Object(o.useEffect)((function(){i(Object(y.a)(e.callbacks))}),[e.callbacks]);var r=function(e){var t=e.id,a=(e.active,n.map((function(e){return e.id===t?Object(v.a)(Object(v.a)({},e),{},{port:null}):Object(v.a)({},e)})));i(a)};return Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",style:{height:"calc(78vh)"},children:Object(x.jsxs)(k.a,{stickyHeader:!0,size:"small",style:{maxWidth:"100%",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Stop"}),Object(x.jsx)(C.a,{children:"User"}),Object(x.jsx)(C.a,{children:"Domain"}),Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:"Description"}),Object(x.jsx)(C.a,{children:"ID"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsx)(Op,Object(v.a)({onEditDeleted:r},e),"cred"+e.id)}))})]})})}function Op(e){var t=Object(ee.a)(),a=s.a.useState(!1),n=Object(u.a)(a,2),i=n[0],r=n[1],c=Object(pe.a)(hp,{onCompleted:function(t){O.b.success("Stopped Socks on that Port"),e.onEditDeleted({id:e.id})},onError:function(e){O.b.error("Operation not allowed")}}),o=Object(u.a)(c,1)[0];return Object(x.jsx)(s.a.Fragment,{children:Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(Oa.a,{onClose:function(){r(!1)},onSubmit:function(){o({variables:{callback_id:e.id}})},open:i,acceptText:"Stop Socks"}),Object(x.jsxs)(C.a,{children:[e.port?Object(x.jsx)(bo.a,{title:"Stop Socks Port on Mythic Server",children:Object(x.jsx)(E.a,{size:"small",onClick:function(){r(!0)},style:{color:t.palette.error.main},variant:"contained",children:Object(x.jsx)(M.a,{})})}):null," "]}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.user})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all"},children:e.domain})}),Object(x.jsx)(C.a,{children:e.host}),Object(x.jsx)(C.a,{children:Object(x.jsx)(L.a,{variant:"body2",style:{wordBreak:"break-all",display:"inline-block"},children:e.description})}),Object(x.jsx)(C.a,{children:Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},color:"textPrimary",underline:"always",target:"_blank",href:"/new/callbacks/"+e.id,children:e.id})})]})})}var xp=Object(be.a)(bp||(bp=Object(_.a)(["\nfragment callbackData on callback{\n    user\n    host\n    description\n    domain\n    id\n    integrity_level\n    ip\n    process_name\n    active\n    init_callback\n    last_checkin\n    port\n}\n"]))),gp=Object(be.a)(jp||(jp=Object(_.a)(["\n","\nquery userQuery($operation_id: Int!, $offset: Int!, $fetchLimit: Int!) {\n    callback_aggregate(distinct_on: id, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      aggregate {\n        count\n      }\n    }\n    callback(limit: $fetchLimit, distinct_on: id, offset: $offset, order_by: {id: desc}, where: {operation_id: {_eq: $operation_id}, port: {_is_null: false}}) {\n      ...callbackData\n    }\n}\n"])),xp);function yp(e){return Object(x.jsx)(yo.a,Object(v.a)({label:"SOCKS",iconComponent:Object(x.jsx)(Mt.a,{icon:zt.C,size:"lg"})},e))}var vp=function(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=s.a.useState(0),c=Object(u.a)(r,2),l=c[0],d=c[1],b=Object(f.a)(h.b),j=Object(pt.a)(gp,{fetchPolicy:"network-only",onCompleted:function(e){O.b.dismiss(),0===e.callback_aggregate.aggregate.count&&O.b.info("No Socks Running"),d(e.callback_aggregate.aggregate.count),i(e.callback)},onError:function(e){O.b.error("Failed to fetch data for socks"),console.log(e)}}),p=Object(u.a)(j,1)[0];Object(o.useEffect)((function(){e.value===e.index&&p({variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}})}),[e.value,e.index]);return Object(x.jsxs)(yo.c,Object(v.a)(Object(v.a)({},e),{},{children:[Object(x.jsx)("div",{style:{overflowY:"auto",flexGrow:1},children:n.length>0?Object(x.jsx)(fp,{callbacks:n}):Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:"50%",top:"50%"},children:"No Search Results"})}),Object(x.jsxs)("div",{style:{background:"transparent",display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(x.jsx)(Gd.a,{count:Math.ceil(l/20),variant:"outlined",color:"primary",boundaryCount:1,siblingCount:1,onChange:function(e,t){p(1===t?{variables:{offset:0,operation_id:b.user.current_operation_id,fetchLimit:20}}:{variables:{offset:20*(t-1),operation_id:b.user.current_operation_id,fetchLimit:20}})},showFirstButton:!0,showLastButton:!0,style:{padding:"20px"}}),Object(x.jsxs)(L.a,{style:{paddingLeft:"10px"},children:["Total Results: ",l]})]})]}))},_p=Object(Se.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper}}}));function kp(e){var t=_p(),a=["callbacks","tasks","files","credentials","keylogs","artifacts","tokens","socks"],n=new URLSearchParams(window.location.search),i=n.get("tab"),r=a.findIndex((function(e){return e===i})),c=-1===r?0:r,o=function(t,a){n.set(t,a);var i=window.location.pathname+"?"+n.toString();e.history.push(i)};return Object(x.jsxs)("div",{className:t.root,style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(x.jsx)(xo.a,{position:"static",color:"default",children:Object(x.jsx)(go.a,{value:c,onChange:function(t,i){n.set("tab",a[i]);var r=window.location.pathname+"?"+n.toString();e.history.push(r)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:a.map((function(e,t){switch(e){case"tasks":return Object(x.jsx)(Yd,{},"taskstab");case"files":return Object(x.jsx)(Zu,{},"filestab");case"credentials":return Object(x.jsx)(Ib,{},"credentialstab");case"keylogs":return Object(x.jsx)(Vb,{},"keylogstab");case"tokens":return Object(x.jsx)(vj,{},"tokenstab");case"callbacks":return Object(x.jsx)(zj,{},"callbackstab");case"artifacts":return Object(x.jsx)(dp,{},"artifactstab");case"socks":return Object(x.jsx)(yp,{},"sockstab");default:return null}}))})}),a.map((function(e,t){switch(e){case"tasks":return Object(x.jsx)(au,{index:t,value:c,changeSearchParam:o},"taskspanel");case"callbacks":return Object(x.jsx)(Yj,{index:t,value:c,changeSearchParam:o},"callbackspanel");case"files":return Object(x.jsx)(rb,{index:t,value:c,changeSearchParam:o},"filespanel");case"credentials":return Object(x.jsx)(qb,{index:t,value:c,changeSearchParam:o},"credentialspanel");case"keylogs":return Object(x.jsx)(ej,{index:t,value:c,changeSearchParam:o},"keylogspanel");case"tokens":return Object(x.jsx)(Tj,{index:t,value:c,changeSearchParam:o},"tokenspanel");case"artifacts":return Object(x.jsx)(mp,{index:t,value:c,changeSearchParam:o},"artifactspanel");case"socks":return Object(x.jsx)(vp,{index:t,value:c,changeSearchParam:o},"sockspanel");default:return null}}))]})}var wp,Cp,Sp=a(903),Dp=a(511),Ip=a.n(Dp),Tp=a(514),$p=a.n(Tp),Pp=a(911),Ap=a(516),Ep=a.n(Ap),Lp=a(517),Fp=a.n(Lp),Np=a(520),qp=a.n(Np),Rp=a(510),Bp=a.n(Rp),Mp=Object(be.a)(wp||(wp=Object(_.a)(['\nsubscription MySubscription($operation_id: Int!) {\n  operationeventlog_aggregate(where: {deleted: {_eq: false}, level: {_eq: "warning"}, resolved: {_eq: false}, operation_id: {_eq: $operation_id}}) {\n    aggregate{\n        count\n    }\n  }\n}\n ']))),zp=Object(Se.a)((function(e){return{tooltip:{backgroundColor:e.palette.background.contrast,color:e.palette.text.contrast,boxShadow:e.shadows[1],fontSize:13},arrow:{color:e.palette.background.contrast}}}));function Wp(e){var t,a=Object(f.a)(h.b),n=zp(),i=Object(Me.a)(Mp,{variables:{operation_id:(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.current_operation_id)||0},onError:function(e){O.b.error("Mythic encountered an error getting event log messages: "+e.toString()),console.error(e)}}),r=i.loading,c=i.error,o=i.data;return Object(x.jsx)(E.a,{color:"inherit",component:la.b,to:"/new/EventFeed",style:{float:"right"},children:Object(x.jsx)(bo.a,{title:"Event Feed",arrow:!0,classes:{tooltip:n.tooltip,arrow:n.arrow},children:r?Object(x.jsx)(Pe.a,{color:"secondary",badgeContent:0,children:Object(x.jsx)(oa.a,{size:20,thickness:4})}):c?Object(x.jsx)(Pe.a,{color:"secondary",badgeContent:0,children:Object(x.jsx)(qo.a,{})}):Object(x.jsx)(Pe.a,{badgeContent:o.operationeventlog_aggregate.aggregate.count,color:"error",children:Object(x.jsx)(Bp.a,{})})})})}var Hp=Object(be.a)(Cp||(Cp=Object(_.a)(["\nsubscription EventFeedNotificationSubscription($fromNow: timestamp!, $operation_id: Int!) {\n  operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}, operation_id: {_eq: $operation_id}}, order_by: {id: desc}) {\n    operator {\n        username\n    }\n    message\n    level\n    resolved\n    source\n  }\n}\n "])));function Up(e){var t,a=Object(f.a)(h.b),n=s.a.useRef((new Date).toISOString()),i=Object(Me.a)(Hp,{variables:{fromNow:n.current,operation_id:(null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onError:function(e){O.b.warning("Failed to get event notifications")}}),r=i.loading,c=i.error,l=i.data;return Object(o.useEffect)((function(){if(!r&&!c&&l&&l.operationeventlog.length>0){if("debug"===l.operationeventlog[0].source)return;if(l.operationeventlog[0].resolved)return;if(l.operationeventlog[0].operator){var e=l.operationeventlog[0].operator.username+":"+l.operationeventlog[0].message;O.b.toast(e,l.operationeventlog[0].level,{autoHideDuration:2e3})}else l.operationeventlog[0].operator||O.b.toast(l.operationeventlog[0].message,l.operationeventlog[0].level,{autoHideDuration:3e3})}else c&&(console.error(c),O.b.warning("Mythic encountered an error getting operational event stream",{autoHideDuration:2e3}))}),[r,l,c,a.user]),null}var Gp,Kp=a(515),Vp=a.n(Kp),Qp=["title","titleId"];function Jp(){return(Jp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Yp(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Zp(e,t){var a=e.title,n=e.titleId,i=Yp(e,Qp);return o.createElement("svg",Jp({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"80px",height:"66px",viewBox:"0 0 80 66",enableBackground:"new 0 0 80 66",xmlSpace:"preserve",ref:t,"aria-labelledby":n},i),a?o.createElement("title",{id:n},a):null,Gp||(Gp=o.createElement("image",{id:"image0",width:80,height:66,x:0,y:0,href:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABCCAYAAADAD1E9AAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAA CXBIWXMAAC4jAAAuIwF4pT92AAAAAW9yTlQBz6J3mgAAJBNJREFUeNrtnHmUHFd97z+/e6uql9k0 I41leZG1L9MaLR7JeMMeYyDGduwQkCAsTgwBAu+FlxwekDxMmBDgASEJO4hgjDHbk4JZYgwOCRov eJ2xZNmjfbMlaxstM+qZ6e6quvf3/uhuebRhY3iBd05+59Q56pqqunW/97d+768E/4miYACGpl7e uobu4D9z7P/vRVluAY5mF08bjBa/sXquCuh/yfNIHTyAg+GS7xzkwlnV8/+lhc8rSlfYU9O0A/kL 7zxgFn2ier4Q/bbf7XdalOV2K7My9d/7sxfesd8s2vHbfq/fWVEQBaN0B6vguMnunNY9Ya9d+LMj LNbDLDyveu1/me5xqYLWFeo40AAGm5bOffaci3ueDReVR1ii+8LFy6rXd4W/7Xf+TYq82BsVzAYK QYGBuH5uX+OSdkp6nce/UZXLz/Vh9lni2Ib28inJuscGKETjr689R3rptt1AP0WhC+iHHOXj71Yi q130OwH/2wbsNyLjTVDB7GbhNbtN5x17pPPwEIt1iEVaYonukc6+vdklFwAMjAsaCrKG7mB8dH4h sqanJ/hdS31+JQ3U6vUi4Pc3LjwrHeNt6vWmHGaOBUooIVARBZF/ONevf6+AKl2h0J8ArGK5hdWs AAewna4WE7rpQVJucRe0WX/eBGu2Hw79YGmSd36yNAexP7ZrZ5mhRzrhAEAfhEsh+W2D9ysBWAMP Ad1tFv13VD8xQU1+VDwV1ThCokCEEvoLCXjP+cn6R6qT7QqX1sBbQ3dwFb0pwC4KV3kx7wKutNAe KkhgIGOQksd6xTSFaPEw/mVLqPz+1aPp/Q9/K7jzm399PhxRsFJbhN+mvGBz6KXbCugus+CjE735 nKrmD5OOOvU0Y6IK/omK6vKpuv7y85P1j/TV8r86eFoDby9d+e0s+E4W+/NmNa8V1fZUNRlD47HU VcZG48qId/EwPj5ajpOj5NLhzXvidPBwvmXm9LeXmb1he/PiZQKu7gL01/Dlv668oIHrJvi07Xxb m7dfOURaUbBt2GCoQbaLas8Fo098sz6ZfrqCOnDwnOZtZUm7Ibl/EsHcQdIUiDNIPotBzfHBSNRT RknRVCIxuTg2whZSzqOx+SyOHCsPuabGWfOLjx7eyqzMbLZVlOVWWP2frpHPC2B98jsyC+dK7DcC qCp5sVLJysenjq37XyKidaChPxXQ58DHCHilx2yVf3m8Te2iI+JGUc23iJWi1S14fiBnZTdp6kI9 VFmkxlys6MImNYFTT7k1+JYsPP9bfvMB44+OfURSzm6ZZGadfWD96IkLjYwf+7cuCtJTM/MdsuCe QRbpNhZU9ppFurPpwpufu64rPJMZ1VmXrRT+6QiLdAuF0S0U9GnTqTsaF3/gTGNvb148e1O28+NH 7GLdYhb8z/r5TZMv/Ket4YI3AwxQmLqBwhc2NSz6+ObswpcC9PwuRem+WtK7LVh4zT4W6nYWlA/K It3VvOSWKiizMr/shesVyWY6522Rgm6Wgm6mkOwxC3VH24Vvq183QCGqH30nJdobmxf97SYpPACw feKSl+9vvPQsgIEZl099SjqKu8JO3di4uGdT2+Lle+ma9DsFYj3n2ioL7nmWTt3JAt1mFmw4+e91 TT25jKuDsZnCP+6nUzfSMbKPTt2WXXh7DeDodLxgD5itzMrUtXqDLfzrQKYwa0O285Ynmxa+9cnc gtdtiTp1gyns2XPRqydubl68bHtr19QXMT8Zf/CbDEZ1IDZGnZ1bqWrOflmo28NFNwPsZ2FDzxlW evx5BdlIx+btFHSADt0khXR38+LZ1b/98rKuvgADYcdLNuYXXf8Ec6c/aToOPSnzKxuY//XdXJJ7 bpyeX6p1PWBWgV1Dd1BN4k8PloKpJ/m/VnQfKFQrhy3M/fABWaibpaO0Sxbo5uzCnj44PvE1EAxA 4+Y53ZM2ZDqv3RIWFsNzlccG5s8eoCMZYL7bSUE30HHfySD/Mjm58lAwe+nKP/f7zGDUF6HvDAv1 4HmX5B5h3sRHmDdxgELbzmnd2ZPH6nueRT4tK6IgDAwkAH5ay42lXWMoGpbw2ljmQy5a8JaBOL5D 2dIVdHbPwphs8MT+c72VYmB4KcAww7UcTc4OIYghthBJ3m5iDK6ny/bQ/7y1bTWCVyP5quPJc//Y GrqDQXpVaon5ybIKbDvdspTe4+nU2sz82b4iL1H0EkQWsnf4AjCNoJTwWnrm4EifdGxDdU2M/lDY 9CT0+/HFwAsCcBtEs6GygRnvyux6dOEY850iFuBYoC6K/fmNmP9lP/RRSoeOkP3xQwwhX2+8qPld 5z/0UEnB9DM5hT14vEUsioIKkglSxl6I7p0IIsAKcArytyBXnQG46thdtjrhXvronCe41yFc52IW N2FCCySqxKr46psBYL22RZipFnnZEP7vHqXjRyn2lqX0P6lg/hboOYnQOAXAu2uJ6Tq4KnPx7C/o K9+Cfn616JESBAEYbJljLlnW4YIjR71+YVV2FL7cwe538lDVpITetK/mQ02YGY7TFFVjYoRkKJn3 q8F3CpjKaXK9VSy3BTZYYSCGfv9YtnMGcfpRfLqiCWNSVUoow6QJ1TpaaxScqdm/JiK+jFcgEIga kRtGSG54SOa+X/zmT9YXaDwrdIJ/6aMrvJZtlY0XXzPNEvzIXlggHhpK/ZHdRhsiNFU09hC0WPfY 7qj8uU9lHY1k58/+OMBOurN1k7qLfgeQJrolVd1nIBgh9SJctfGsiy5ZSn/SN86XvVhZxXK7ikK0 gtWuwEC8c1p39tGg8DdaTjY1efN6j5ohfFLEl1O0DBJkMPkmCRomSJBtMUHUZIKoSWymGZPLKnmn zjp8MkwapyitGnziQeatrFtDzzjcjjvfesWxc1p3dmTX/vUNE7KzR4eKibI9lFwnlBwgqvX7BLQp SBtHfDAm+qVO99S7+ugKu8ZVInXfsdYU/nmCmj89ihvLqeRLWdmdOWfC5YUdDzxTDQDdFtoVViug Z6omnks1lksvg9JNrzs+VmtXixup3ITz72lVc8GwOrwQA4KqzWFMJMIonlR0lyjrxcpmacscJLAV LSXZdLgyXY25osGbQuqVCpqAWpC0FRsdxX35Uja+cxXYOpskJ6vlelnwswliXj7kkwrGZHRyFvaV qKm8BAgpqtXJqCJCI1ZKefOWhaNP3DYAUQekdae/AtzazPzZPmaLKChUskimbGRII/sXS8vrbz8J JNNPlx1PqEKVVN1Bv19xEgPzaENhsa/ozeL1j5rUtMfqKYsm1YITm1djnYHE8pA1cqd4u6bt3IkD 03f1ls+k1Q9NWHKDK8afbnQ6fQSfUM064laCaNi4913qN/59XTlkfP24ziz4Uqs3f3aUtIKQUSPg PIhQu7Ai1uwUp/PGgehFMQGGtD37J0sG+2+vAlEt7usD9Zn572z19otHcV4hDiCbw1AUP+Atd0jG 3NMwjQ2FgRMZ69OZ7LRoYJ5TfaV4XW49lzRgGFVPIpoqOAGTVROGYigb32ubgg9dOPTkfeOf0wPm SroNQBNFKdKk3bRrnZAYKCyPDm/b8K9NFX1lUXwCahVMgCCBufDSZMPaPrpCqWvfOlP4YIPKh+uI SzVoplUwNGnTIFc0/quxYWZTylXH8CnPBSEHahujiNKE8FNLDva/F6q5YIGBuK6JjzD//S2Yj5fw JGgZkCwmkxXDsHg8bEN4SoSNzvKMzUdF3xSKJK7BHy5PUefniGcR6PwWrKQKIzivSCyIAQ2yGBNh GMFtiaz50IVu4Lt1wK6ny+6g3y8HXw8cp1kjuZtZ0bVsqwD0BvPXNKR0j+ITAW3ARGOi916hm7qp Kl9VHreF+yZ5+9JDmnhA1EilwUu2ukKWQevul8bodoYrX03QuGb+luPlnHpFtZXADgW6Jp+X1xaO DRwZoBB1MJD8bbXc8w/bwmvF+5Ut2LYxPDG+DKSo5jOIicQgVP2Jr/Hfte0+VCFBKaN4tCSI92g2 wtgMQoySivZbYz6/zHXcUdMm6TuJXnthwakQrWAg/llrV0s0PLrFes5KUAdKg1ibWr3m0nTTPdID pgf8PZMXNkw6lHwXxyvymEzJco9X/0P18jKLbgpasw+WRyrfbEpoq8fwSo2zq4FoVERRkiZMVDR6 UIxdflH65H09YK7s7jb0wlX0pvfT2RqZ+K+ccnMTtl2AMTwpJKjUCFg1PBfkaqmLqKICZDKIyWJI UcbQA8ZwV8bwjQvTjcdN9eSg9qvK3czKXMu2yr3ZjjfmK/rNojoH4hoxUQm980o2vUbG+yuAvuyC R9rLXHTUsnKxe+rP6g97WObfNV3D63aH6TZNOapKhOX8vJe2snpSUSe1vWEgjpRIBeJQ3n9JvPGT 9QkB1LXhfjpbA5vcgJcbVLnYIufka5h5OCHJNYBBUIFRPB7daYV7ReyPMy789yWsG6qbYB9dwa8D 3OnkP8y8J7NeFpTExxYiD8da1c0SqPqHHvBruruD/H0HNjRhZpu2aNm8Q2v7FMzaSUvO1lH33mwQ 3Fkqjqhe0LxY89kJfuOhkJxt0cTd3JhKc4xSEfWCGF+NxEGLWooTwh/lr+34k4Xf/vbRVSy3y4F+ dpgTWetCY0QyX61dKKrzVZmm0CyKVSERI8NGeVrEbLCGda1JZePsmp+q3t8dNFGUX9VUn0/q6d1/ BHM/0OTMR4bVJYqaPMYaeFU9jZHVYFaAe5h5X74gyL7j6Fm2q2Nv/+NrmJa9il3lxyZ3zogPlD9i zm18Xf7Z3SblELnJF1I+MPo/4saoRWO/xHudk00plPGeqlP3Cq7J2HCkyRzR4eTPL2fTt+vF/2ow M+gyL3bPdxXYo3SZVmb4Ff+P6Pw6gP/eWLgqGHU/r6gHiJvERono/wygntBV1T2g4c93+9Gj5mg4 E3j8KnaVH2TuNcmB5O6JjXkZfHYtlSuuTcy5Z8uR73xN7Dld/83tLeZEbIXArCkFvpRNZWkJ70As gjnmXWyH07YGCb51v86dL2z+YA+YD4GXWsVSX8QZdBmAIk06SK8uB10N0k63NFEUgHGR1EG/U/rN 8/Ub3kuv7/l1Nuaj6EC5NOaME+sF9YDzTDw+aI31EKE/wfPXd5eqjUH3h/O6bGp+Io2WweLGUst7 P5DNdnaEQfskBjMh/usr52TOX4rZPUqa+FkuY/51TP2wddLiRL1WXVekCBX1TCG65T4zL3uF3/Te 5RSiVXS4FayuVxSOGqCnSu8pZ/roCos01RiZ3ucFZxWFaAMD6YsBMvVxqIr1aFXbBNQgJ6xaTRPr u2oVAJNwW9BgGSk+XWm4/tU5n4nYc9MbaXjtm2n5g2vZ9/WVzuwbgYzxQcWHLnEXY2QP0FJTazXV 0u9QYvj5vqxuNTYaW1tcPKHAuiEYYBWFaDkDyQt1+mvoDu6l19f9XR9d4RAj8731BVWZJl5zABIE Ra9staFb//Lylh0ram0lK+kK3/ECfeUggwbAl3VBI4YRSV299giRA6clIusJ8H1m/jubvfniMeNi 9S60Myf6ePvDYphtHFtp/9+f4th9DxH/5HuYpgIUUwTURHanS/xUVAMDmEwwCPpgEvtA8ZNAQlWa xMjq5iVX9Czt/0qta6HK4dXfo5t2XQ20MygAWyjKPvpdXYP+LZh7maT6BkVeATq7QSy2FsXrK5Gg jOIrwGNi9BtPu6avv4P+pD7WmWixk4G+2859MOu4ZAxNQSWLsXmk+xQA65XJPZMXNmQOVjZHKudW 8GSNxfoK5UmN+LJ3QdcFNmybQGXHHtwTOyHMI6kqqkLGljVrheE4oyKISCJewxzmOBflUCIxFAO/ i3zwyahlwndf+swDR1+IVvwsmPd73ukHQuSlGQwxnriaXDtUfNWQ6kaFMWAzGKwIRdwOY8z7rnGb vlddtEJ0lKy2MsNTW6xBBs1RsloH767MvE/lK/qeMXyqggSIVfSZV2k0+xQA67Vrr5n31y3efGwY lxiRBCsbNWOOKdodjO4W87rXuNzcmfbwh/8GE8wF1apnrZbIUvcHSA0xAUUd481UVUMkzIqhaPUw gb3HGelVa54yiezPFaaUx8bGCHcczbtQztNK2qHw6lzKK1BlDO+pkgv1klRUTqH3a29W3buOVIIQ YUz89zNnN/zl1fvWPn2mhfphw4LJJo4/nUvl9WPqHCJWVSsTCDIp+sGr2fyREwbrqeWD97d0trpi ss16bfOhqM2Fe+Ji5RjGbKYhfECbg1tkz9q21o990sdDx8zQJz+CnbQQDtUIjrxVP5aIiKm+fh3E 4yLHf6rgRcUFEOawqEBJPIlqSbImJlU08dlITCaL4FQZwTmqm/kn+PAThlCtrxumivLxaA/4JmxQ DHyJjP2cj5PvhhdM2eNarNrdh1rccNqhibtOlTc0qmkq4pxUy9ZyBpN16I5rieYLA/EJANZ93380 FD7eMpq+fxiNRSQSBKNKCwGHiR+yhcnf1IGHv2Aue5m2v+tm2f3Gd2Dy56BjMWQjKBcxjS24kXSc Bsopk9RxM1JRp1plUoDghDpOBFe9ulbmEVYfW4tSp9GeOngYSRCKeSdtJfE4iIFIIbZKlMdUK5tA hgiMauwbc0oYqFTLSyExaKhQCZAMoBODYOklycbHV9IVnrCHu5gnkn9vWLBQYndHpT0rGnvjnRcv 4ET9mLjKRILplcHiI27ebA3W3jujYcXr00o+Zyp9/4aZPovk0Hqa3/w6ggXTKa27B2mZglYcKlK1 7tNojFaRMghWBPGCqqh3gnpBvVbvVAjqnbA67qh7Oz3pAFUB6wNzb2r5gfN6SaOaIMbHCoEHXwGn otZ6zUrqc6jaWLyviKYqqCjiUdeAiRLRUrMNX355uvHheoAxddNdSn+yEkLS5BuZpCzJgScSn1RE A4NWY4PxKmYMcOglprmxDyAZGvL5hQVSwGeq6zHhZVdQGavuHGnqahSznjrB+r9r2qSqOFVRVeMV q7XDg1UwKtXsuX4891vxqrX3HPdvwKlqJtZrXKottiG38Jj4+xvFRpGIQRQVRVWTVDROhdihiao4 VcQrQYgEjQRhLPS2Zxo7rkw33jc+OhuAOrE4PTv/9Y2VZFF5Rnt81kc/EZrL5uDSQ2hzhEdURSxW 8JDXcmXMA/HBQTKT2/GA27SP3NW/T9DWSnnVQ8D5aKIn7ATVJ+j15ElXc5M6p38qUCdefwJQOu75 9f6C6n2iAmPi3EQvb/MjY295tW69YljdWyvqN0dqbIOaMIcNM2qiSCXKYsM8JsxjAkAd3CdWXnO9 br3qkvK6XX0n5ZAnlj+TGqake/aQv+hKSgcPEf9iPRK140dTF4AFOTRmvMHJqCvHzQGQDA2Ty1Ub BDxPE86+kTRJSNlKEM3Fez+uUDzJ5E7jt07n1E6bXdd9ayDV+Bu7uivgpMcIIAdwaQv2L3/M3H+7 js1fW0Xhm5BcXUJfKWgHRiYJYkT1mAo7A+SxZs+al7N1Q20TQdbQbcfvM58CoDs4OslkpjL03V4c O7HMRlOv4rEqQpgxt5Uq6ftzmLWlcnyJADZJDMYcr41UwJUrVToqNFCuuX8ZP7dfAaRTQK6vhEIu QEspniLGtqDOj3uSGd/sZhRcBcUF8gFSflqrSn5SO04s7sa9TA+YKXTZd9CfnC7pNgCD9FYDovMz 0ooDAgnOWQxG1HvVSIR8Nvjr0dQtzogImF0+SS8bBSQIAxfHtfEvoLRxO25sDOFs/GipaoKcbHYn mtx4s6sex33TCff5Wp7uFTQKcKUYUBouvRB1Hjm/GZk9CZk5EVoiVNNxz9dgDOes18vvaVpwPcA3 WNhwuj6ZVWBXUYhWVrts/S8r+wLgeMO3ep2TAN6KZ+9IAqJ5TJQY+lzqi5NTc82RQB92vjw1l23I HAUXtLbY5FgRB0Rzz2ast5ehmRdgF8wkfWonomEVFTlVx/Qkuz7VpE9SQan6UAktPjJovIspt3yY Qw88QsoO/O7n/GgI2GlL0CMl9FgMiAho4j2V0cqngLtuYv1oD5huTuzVWQEeBl4QPRbUS7efZgqz 0jiePYZqzplMJAHHtGb81myKnVvmsWDZk6YyKxNYFIjaJ3Fs565qdlqOESYzdOt3EDMJkTzq/Sno nJgLnr4v6GSzxwjqEkxrHm3LUdrez7x//AzFAwcZ6v0xLRe/nKZLuzSc3C5pqczQLx6l+LMfVYGc uhj/zBCIDSqqcaOXuXcGsz/5h+nW93VQCKrdDC+OvTZfocsCOJfOasFmQxHxkdw5Eum7nGFbhCAT s5s1MusBJAxSscHZ6bESBsREESNrn8QC/uAoKgINZ+G9e85cFTxy/NBxB5yav+n49EbAq8e7MjJj IqkqI9v7mf/ZLyITJrD3Ex8l2zo/ToeKcenQYR+Xy3HjnNlJR89fsfjHPyG4/JWUn1mHXjCBVBO8 aDhM6nH63h9l5rxqBQPx3eO+6fuVAazb93Xp5p8eEfcXPpDDbRMa3ndtZfOXpDVzW4NYdN/oWOn6 zs8cFYf3Pu+sZP1o1S2kpTLp4WGUyfiyx6vgxxwqpg6SesTrGYDyosd95AnpDYpa0Mgg7Tlkejul Hf34oY10feu7hOdM0U1v+eM0YDq5lCizaW9U/sZX7bEP3RLteMPrwr7L/iAtPrtXF//DR2h+483E T6/DTJ+I1nYcYlVGEr/6rpbOGdeyrbLqRX49erzDFOBGv/UzNkmX7D88UvhBOKcvPVp+136tkA/t gytWr3aj6nekSTpZ47TEhCwpkBSL2LMn4ThQddw1z1YDzFsjYsBUS7UTQRqvoePTG5oCaAnR1OPK T1MaHKC883HOefd7WPbzXh2L42Tta19NM1MD05YlLiZ3udamD9iZy97uFr303XRe1tsgLcFTb38r G7/0VTfnLTcRdl5KvHMtem4zTl2QGJLAa8PwSOnnPy1c0raCgfjFgDie0pfVFMLfY2A3jt3f05mX TdHofaWc+cvLSwMPAzj4VOr4pEH6k3ICIMPrN9AwZyZFwGTt8cCgio9EjEb239NKujijMimGFPS0 BIDWeuxVPa64+Xgtm1t2FVN+70rOWrYUctlk0+o7ZeRLnw1b2jrwGfut/L7KXaORmV46Gl+lR0vt iu4zjH0uOefs708+96rP7P/6V2zQ3OTm/s177OPLHyTzbBEm5uBwKawYG2cdFxzafOiBNe3dF101 2DtyG9OyN7Or/ALxO9WDj/+a6Ad23u9nm+wz1wwNPFEPNt8PZ/+5wbwuSZLLNB94P7bbTPiTmxjb spP4wT4kPwnGHICLEJsKm8Km6CPlYuV2q9i0SnqZk0mFaqmsYpsiclcsoGH+HBqmTdXMxDbS1LmD /Y8z/OlPBRFgZ190f26s8qEjzx5bmop5f4uaiSlVJiJAMAqj6CeCXOYxM63pX4Y3PsyMj37CZdon 2Q1vfysBzdjJ56MHSqhQyavJVEI2TJzY1H3t/rWDK+kKW0/Th/OCAKybdC/dtg5kT43mOg4icy5C /CMJJKgPoCx25rmk2wdBbI3OVBRJJmDCUSu3uow8mBtzt45WW0LseN5Oqry/U6/etGTJXlbATJpA Uhwx5fuesHp4YzWazujqzzfm//d16+//HsAdZuZwozfNRVxJkLCaPZI0YrPGyO1lY76SppXu6Jym jw7vXc+0v/lwnJ18VvT0p79KZWsflgsQsSgkWZWwYhjUXHDTzaObf1qf9xSw0MV4Jvx5AazLyTv7 NQAV0P/DzB+2E9xw0LoyYLwrBcZmRZ3Wt0rrIyQt2LCSMW8qO3dDUyorjuETVMPjtLGIy6qxph5x 2Qe1NtaY1iSaM6s3f277F65bc/cP649dVShE5Y2VR63XRc9ptbpmAhsE5rNHfJo0Yt7zGj8r+zW7 5Y9apjTeVtzzBE1/9MfxhMULZfipDUHxPx4Rt7eIWAtOY4tEVoTY6Lex5qNvibdtGI/H6T7kecFd 6HUG4tvMmRcY/2ObC98Rj5bf1kKwwlkoi5KmHhU8SI0lVoNiMhgS9KkoF72tVIofkloxp+AjxGog T6F8xqnvRk2LZE0SNEX7o+b8460TW+698pGfba2/x2dnzcq8e9u2yqrC8mhsy9qNUaIzYqn1rGBt YMwdx9RVJqj500YbXHl1rdXjVqbfYM5r+mK0Z/25MInoDdeD8+lo/4Am2w4YsZFRpw68aZDAjKkj YddPDPwgKFz+yO6BB57sOb5zeWLMe16pmzDAd+zMR9ucXXbE+D0mE/yFw0VU/B+o15cipj2EIKTK /ZVRvGGfUabk1ZAj6DwQJq9oScw/HsPFChEoBvEzco1TLy098eyZxq/Xoz10Bz30pl/LzTxfKrrJ ePIOkhwShtbcNYovNTmzPBfYa16VbrpnJV3hPvq1B9KVkM/OXvrmZNvhNyS68yVNnJsxzU0kx8pV Og5URZxRX8ksviDbMmuqHdn+DKW1DyBndXz/LQef+sOTNfEFfWpQp7u+aWd9ocGZZYOko9ZzHuX0 X5zX/2by4cAkGhdnM+EsaYyuqGTkbaWs+TrWEKjs0HzwJiuGkSB9603Jtn8asv7hDBIpmnhIchjz bFJ6D8Bna18/9UCwikK0hu6gZ1w92lHbZpRM5hVZL/kUjQMIjTUPFPH5vOM4eKsoRFXQSasWxNgf b+1b+ae688qJL//9OTHmDaPHxr6cWNvnMMUAK3mCICtRQ+WJZ+3gjqfH8i9dFmdedSPu4FOvvvsl V3cArGb5qS2+Z5J6m9c37MzXN3jznTGt9wVqKUBy+eoa/MWNbP3Myffedk7nvOzB0rf+KN3WdWsw 65UZuOPsyW0du+PR0Bwu78GrVSEJVEIVtrxJzy8IvekqltvTtWrU+wy/+ZJXNVcGtm+0I/E5KZAP 7EDs1QWehWcFUfcr0033fpZZmXeP652pa/KVdJvTdSncmp97jo99wad+ieTMErVcHY48017Guem3 fDAZ+tm92eSRn//lTfDpNRBcRbV38pcCWPd738rOmeHKboOFjIfUoy6PyThh7/lh+HuXxRufAmQV mA10S11LVjAQ/2uuMNWWKqVr2TZ4WzhjmbX2hpbmzOePHIvfmS/7D43WTDlCyAf2ytekW+8708Z3 HcCv2hnfyzv+sIjzjVG0P/FqSX3r9DB78ZXJhrX1RX8+tzSlVsaebqxbmdTkpp33edm17qbo6usq 7Z0dmd2f/vvH3wFdPMdGnhnA8XZ+u8x4LKdmaQlfVjRsJrCp6H3LWhpvnD60buhMyed4IMZPaiWE jVM7G0t7RrZbT2sKlSZMJkE/8WZ2/FUPBD21FT7ZEv7ZzHx33stnirg0H4apCW02GYv3Ls42Xbak vG7X6TTv+aT67Um3hUEzhazWfSbAl9o7VgeDu19rL76oYvYezgTP7Lj2TRz7yQl7IlrVHttT9Ymi IJ9jVgRwu5nxD03YpWPiR1XINom1GP3CCt125fShdUN9dIVnytxr/ue4Nq6kK1xVy6ve+MyTRzWy d2eqi5kmKA59We1W3/McTye3MS27goH4y+GcRer1MyN4FSTNpJp1Y3H/Fa0TOl4seDUt0h560x4G 4nfQn3SAfoOFDQCMpH+fNpxN8eG1pvLMUUaDSe+pza3apd8zLsLWzaTW+aS3N81/dTgS31lWH0dI pEAz8vYb2f7PcGLV8nwy/tOAuny1ae6/ZIvpa8aqLcORgdGzCRZez5YdJ9+3sqsr1CeOPhWmOqeM 960SGC+sfpPfvuJkbf915OT3/Hx+1oUylva7SNQnXgKFRoLL/4Ttv1hJVxjUwftaMPPSxvPadqzY 9dh+gFub59/kRir/nKj3kdgIkScavXn7jWx5tAeCamvaCwOvp9Z7eCtzmzzpMpnevF2Plq90Q5U/ GEFdrXWXRrENEzPGf6x8dntbrnHWn5W2PbQC3FfbL5yVPDF0h3XMqQiasUEs3v7dm/yWj/0mwYMq ufxpps8NQtvw35Ntj7tU3x0I+NhXvKjmJcghvhvPL/ZRFvkChcYspXsmYS89FOiIivbh/JxWDc4Z 1ZQsBpsLv/2a0qY3Vlfo+R306Vb0S0zrFszPWjBBKYSMg8T76k66AgbaovBN++Jkcs7LP2CFUcs6 RdOsk6WRUyooYmR46fkTlyx6+tGd1G79TfyHPMvBrgb3j+aCv2tWe0tZPLFQavSSS2rf1GUx2MDe c/PczA0yMBArSBCF5bkk2jZI+gtJNW/gfIWhIZKnAaPiozma/QBAtVt14AUzFSfJxeCfPobfQyIN MaS1BnyMSONZQeaDN5Y3fv+LZvqqMfRJdVrEMcmAxGh/jIwqnNtqw88uevrRnfXA9Zv6Qno1uFVg 93ouHMGtF2XMog0lzKiCVSQtCW3nNuY+JgNPxqsoRMJA/H8BtvEYyTM8EcEAAADoZVhJZk1NACoA AAAIAAcBEgADAAAAAQABAAABGgAFAAAAAQAAAGIBGwAFAAAAAQAAAGoBKAADAAAAAQACAAABMQAC AAAAJAAAAHIBMgACAAAAFAAAAJaHaQAEAAAAAQAAAKoAAAAAAAABLAAAAAEAAAEsAAAAAUFkb2Jl IElsbHVzdHJhdG9yIENDIDIzLjAgKFdpbmRvd3MpADIwMjA6MDI6MTMgMDI6MTA6MDMAAAOQBAAC AAAAFAAAANSgAgAEAAAAAQAAAFCgAwAEAAAAAQAAAEIAAAAAMjAyMDowMjoxMyAwOToxMDowMgB/ /K2cAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTEwLTI3VDE3OjE4OjU4KzAwOjAwCRQNHwAAACV0 RVh0ZGF0ZTptb2RpZnkAMjAyMC0xMC0yN1QxNzoxODo1OCswMDowMHhJtaMAAAAhdEVYdGV4aWY6 RGF0ZVRpbWUAMjAyMDowMjoxMyAwMjoxMDowM+QYGrMAAAAqdEVYdGV4aWY6RGF0ZVRpbWVEaWdp dGl6ZWQAMjAyMDowMjoxMyAwOToxMDowMhsP+NkAAAATdEVYdGV4aWY6RXhpZk9mZnNldAAxNzDS Dd5MAAAAF3RFWHRleGlmOlBpeGVsWERpbWVuc2lvbgA4MIVW3/AAAAAXdEVYdGV4aWY6UGl4ZWxZ RGltZW5zaW9uADY2LyCOzgAAADF0RVh0ZXhpZjpTb2Z0d2FyZQBBZG9iZSBJbGx1c3RyYXRvciBD QyAyMy4wIChXaW5kb3dzKV8EztAAAAAASUVORK5CYII="})))}var Xp=o.forwardRef(Zp),em=(a.p,a(518)),tm=a.n(em),am=a(912),nm=a(246),im=a.n(nm),rm=a(519),cm=a.n(rm),om=a(513),sm=a.n(om),lm=a(317),dm=a.n(lm),um=a(521),bm=a.n(um),jm=a(522),pm=a.n(jm),mm=a(512),hm=a.n(mm),fm=a(299),Om=a.n(fm),xm=240,gm=Object(Se.a)((function(e){return{root:{width:"100%"},title:{flexGrow:1},hide:{display:"none"},drawer:{width:xm,flexShrink:0},drawerPaper:{width:xm},drawerHeader:Object(v.a)(Object(v.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),appBar:{width:"100%",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{maxWidth:"calc(100% - ".concat(xm,"px)"),marginLeft:xm,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},nested:{paddingLeft:e.spacing(4)},mythicElement:{}}}));function ym(e){var t,a,n,i,r=Object(ee.a)(),c=gm(r),o=s.a.useRef(null),l=s.a.useRef(null),d=s.a.useState(!1),j=Object(u.a)(d,2),p=j[0],O=j[1],g=s.a.useState(!1),y=Object(u.a)(g,2),v=y[0],_=y[1],k=Object(f.a)(h.b),w=Object(f.a)(h.c),C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],T=s.a.useState(!1),P=Object(u.a)(T,2),F=P[0],N=P[1],q=s.a.useState(!1),R=Object(u.a)(q,2),B=R[0],M=R[1],z=s.a.useState(!1),W=Object(u.a)(z,2),H=W[0],U=W[1],G=function(){Object(h.c)(!1)},K=function(e){O(!1)},V=function(e){_(!1)};return Object(x.jsxs)(s.a.Fragment,{children:[(null===k||void 0===k||null===(t=k.user)||void 0===t?void 0:t.current_operation_id)?Object(x.jsx)(Up,{}):null,Object(x.jsx)(xo.a,{className:Object(Ra.default)(c.appBar,Object(jt.a)({},c.appBarShift,w)),children:(null===k||void 0===k?void 0:k.loggedIn)?Object(x.jsxs)(Sp.a,{variant:"dense",children:[Object(x.jsx)(E.a,{edge:"start",className:Object(Ra.default)(c.menuButton,w&&c.hide),color:"inherit","aria-label":"menu",onClick:function(){Object(h.c)(!0)},children:Object(x.jsx)(Ip.a,{})}),Object(x.jsxs)("div",{style:{width:"100%"},children:[Object(x.jsx)(kt.a,{title:"C2 Profiles and Payload Types",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/payloadtypes",color:"inherit",children:Object(x.jsx)(hm.a,{className:"mythicElement"})})}),Object(x.jsx)(kt.a,{title:"Payloads",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/payloads",color:"inherit",children:Object(x.jsx)(Mt.a,{icon:zt.a})})}),Object(x.jsx)(kt.a,{title:"Search Operation",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/search",color:"inherit",children:Object(x.jsx)(Ud.a,{className:"mythicElement"})})}),Object(x.jsx)(kt.a,{title:"Files",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/search?searchField=Filename&tab=files&location=Downloads",color:"inherit",children:Object(x.jsx)(iu.a,{className:"mythicElement"})})}),Object(x.jsx)(kt.a,{title:"Artifacts",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/search?searchField=Artifact&tab=artifacts",color:"inherit",children:Object(x.jsx)(Xj.a,{className:"mythicElement"})})}),Object(x.jsx)(kt.a,{title:"SOCKS",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/search?tab=socks",color:"inherit",children:Object(x.jsx)(Mt.a,{icon:zt.C})})}),Object(x.jsx)(kt.a,{title:"Screenshots",arrow:!0,children:Object(x.jsx)(E.a,{component:la.b,to:"/new/search?searchField=Filename&tab=files&location=Screenshots",color:"inherit",children:Object(x.jsx)(Mt.a,{icon:zt.d})})}),Object(x.jsx)(kt.a,{title:"Credentials",arrow:!0,children:Object(x.jsx)(E.a,{component:la.b,to:"/new/search?searchField=Account&tab=credentials",color:"inherit",children:Object(x.jsx)(ob.a,{className:"mythicElement"})})}),Object(x.jsx)(kt.a,{title:"Active Callbacks",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/callbacks",color:"inherit",children:Object(x.jsx)(Pj.a,{className:"mythicElement"})})}),Object(x.jsx)(kt.a,{title:"Reporting",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/reporting",color:"inherit",children:Object(x.jsx)(Mt.a,{icon:zt.t})})}),Object(x.jsx)(kt.a,{title:"MITRE ATT&CK",children:Object(x.jsx)(E.a,{component:la.b,to:"/new/mitre",color:"inherit",children:Object(x.jsx)(sm.a,{className:"mythicElement"})})}),Object(x.jsx)(b.a,{style:{display:"inline-flex",alignItems:"center",paddingRight:"10px",color:"white"},component:la.b,to:"/new/operations",children:Object(x.jsx)(L.a,{children:(null===k||void 0===k||null===(a=k.user)||void 0===a?void 0:a.current_operation)||"No Operation Set"})}),Object(x.jsxs)(Nn.a,{id:"menu-appbar",nodeRef:o,anchorEl:function(){return o.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:p,onClose:K,MenuListProps:{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"}},children:[Object(x.jsx)(at.a,{component:la.b,to:"/new/settings",onClick:K,name:"settings",children:"User Management"}),Object(x.jsx)(at.a,{component:la.b,to:"/new/login",onClick:function(){Object(h.c)(!1),console.log("clicked logout, calling FailedRefresh"),Object(h.a)()},children:"Logout"})]}),Object(x.jsxs)("div",{style:{display:"inline-flex",justifyContent:"flex-end",float:"right"},children:[Object(x.jsx)(E.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){O(!0)},ref:o,color:"inherit",style:{float:"right"},children:Object(x.jsx)(kt.a,{title:"Settings or Logout",children:Object(x.jsx)($p.a,{})})}),Object(x.jsx)(E.a,{"aria-label":"documentation links","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){_(!0)},ref:l,color:"inherit",style:{float:"right"},children:Object(x.jsx)(kt.a,{title:"Help Documentation",children:Object(x.jsx)(Vp.a,{})})}),Object(x.jsxs)(Nn.a,{id:"menu-appbar",nodeRef:l,anchorEl:function(){return l.current},anchorOrigin:{vertical:"bottom",horizontal:"right"},getContentAnchorEl:null,transformOrigin:{vertical:"top",horizontal:"center"},open:v,onClose:V,MenuListProps:{style:{backgroundColor:"dark"===r.palette.type?r.palette.primary.dark:r.palette.primary.light,color:"white"}},children:[Object(x.jsx)(at.a,{component:la.b,target:"_blank",to:"/docs/agents",onClick:V,children:"Agent Documentation"}),Object(x.jsx)(at.a,{component:la.b,target:"_blank",to:"/docs/wrappers",onClick:V,children:"Wrapper Documentation"}),Object(x.jsx)(at.a,{component:la.b,target:"_blank",to:"/docs/c2-profiles",onClick:V,children:"C2 Profile Documentation"}),Object(x.jsx)(at.a,{component:la.b,to:{pathname:"https://docs.mythic-c2.net"},target:"_blank",onClick:V,children:"Mythic Documentation"})]}),Object(x.jsx)(Wp,{}),(null===k||void 0===k||null===(n=k.user)||void 0===n?void 0:n.username)?Object(x.jsx)(L.a,{style:{display:"flex",alignItems:"center",paddingRight:"10px"},children:null===k||void 0===k||null===(i=k.user)||void 0===i?void 0:i.username}):Object(x.jsx)(m.a,{to:"/new/login"})]})]})]}):null}),Object(x.jsxs)(Pp.a,{className:c.drawer,anchor:"left",open:w,classes:{paper:c.drawerPaper},onEscapeKeyDown:G,children:[Object(x.jsxs)("div",{className:c.drawerHeader,role:"presentation",children:[Object(x.jsx)(Xp,{style:{width:"90%"}}),"v",Lh,Object(x.jsx)(E.a,{onClick:G,children:"ltr"===r.direction?Object(x.jsx)(Ep.a,{className:"mythicElement"}):Object(x.jsx)(Fp.a,{className:"mythicElement"})})]}),Object(x.jsx)(wa.a,{}),Object(x.jsx)(xa.a,{subheader:Object(x.jsx)(am.a,{component:"div",id:"nested-list-subheader",children:"Home"}),children:Object(x.jsxs)(ga.a,{button:!0,component:la.b,to:"/new",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(tm.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"Home"})]},"home")}),Object(x.jsx)(wa.a,{}),Object(x.jsxs)(xa.a,{subheader:Object(x.jsx)(am.a,{component:"div",id:"nested-list-subheader",children:"Global Configurations"}),children:[Object(x.jsxs)(ga.a,{button:!0,onClick:function(){I(!D)},children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(cm.a,{})}),Object(x.jsx)(va.a,{children:"Services"}),D?Object(x.jsx)(im.a,{}):Object(x.jsx)(Ha.a,{})]}),Object(x.jsx)(A.a,{in:D,unmountOnExit:!0,children:Object(x.jsxs)(xa.a,{component:"div",disablePadding:!0,children:[Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/payloadtypes",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(qp.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"Payload Types"})]},"payloadtypes"),Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/c2profiles",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(Qe.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"C2 Profiles"})]},"c2profiles")]})}),Object(x.jsxs)(ga.a,{button:!0,onClick:function(){N(!F)},children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(dm.a,{})}),Object(x.jsx)(va.a,{children:"Create"}),F?Object(x.jsx)(im.a,{}):Object(x.jsx)(Ha.a,{})]}),Object(x.jsx)(A.a,{in:F,unmountOnExit:!0,children:Object(x.jsxs)(xa.a,{component:"div",disablePadding:!0,children:[Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/createpayload",onClick:G,state:{from:"TopAppBar"},children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(dm.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"Create Payload"})]},"createpayload"),Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/createwrapper",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(dm.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"Create Wrapped Payload"})]},"createwrapper")]})}),Object(x.jsxs)(ga.a,{button:!0,onClick:function(){M(!B)},children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(bm.a,{})}),Object(x.jsx)(va.a,{children:"Operations"}),B?Object(x.jsx)(im.a,{}):Object(x.jsx)(Ha.a,{})]}),Object(x.jsx)(A.a,{in:B,unmountOnExit:!0,children:Object(x.jsxs)(xa.a,{component:"div",disablePadding:!0,children:[Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/operations",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(ki.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"Modify Operations"})]},"modifyoperations"),Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/browserscripts",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(Om.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"BrowserScripts"})]},"browserscripts")]})})]}),Object(x.jsx)(wa.a,{}),Object(x.jsxs)(xa.a,{subheader:Object(x.jsx)(am.a,{component:"div",id:"nested-list-subheader",children:"Operational Views"}),children:[Object(x.jsxs)(ga.a,{button:!0,onClick:function(){U(!H)},children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(pm.a,{})}),Object(x.jsx)(va.a,{children:"Operational Data"}),H?Object(x.jsx)(im.a,{}):Object(x.jsx)(Ha.a,{})]}),Object(x.jsx)(A.a,{in:H,unmountOnExit:!0,children:Object(x.jsxs)(xa.a,{component:"div",disablePadding:!0,children:[Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/payloads",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(Mt.a,{icon:zt.a,size:"lg"})}),Object(x.jsx)(va.a,{primary:"Payloads"})]},"payloads"),Object(x.jsxs)(ga.a,{button:!0,className:c.nested,component:la.b,to:"/new/search",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(Ud.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"Search"})]},"search")]})}),Object(x.jsxs)(ga.a,{button:!0,component:la.b,to:"/new/callbacks",onClick:G,children:[Object(x.jsx)(ya.a,{children:Object(x.jsx)(Pj.a,{className:"mythicElement"})}),Object(x.jsx)(va.a,{primary:"Active Callbacks"})]},"callbacks")]}),Object(x.jsxs)(ga.a,{children:[Object(x.jsx)($.a,{checked:"dark"===e.theme,onChange:e.toggleTheme,color:"primary",inputProps:{"aria-label":"primary checkbox"},name:"darkMode"}),Object(x.jsx)("div",{style:{display:"inline-block"},children:" Enable Dark Mode "})]}),Object(x.jsxs)(ga.a,{children:["UI Version: ",Fh]})]})]})}var vm;function _m(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t.taskartifacts))}),[]);t.sort((function(e,t){return e.task_id>t.task_id?1:t.task_id>e.task_id?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Artifact Tasks"})}),Object(x.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Task ID"}),Object(x.jsx)(C.a,{children:"Artifact Type"}),Object(x.jsx)(C.a,{children:"Host"}),Object(x.jsx)(C.a,{children:"Artifact"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:e.task_id}),Object(x.jsx)(C.a,{children:e.artifact.name}),Object(x.jsx)(C.a,{children:e.host}),Object(x.jsx)(C.a,{children:e.artifact_instance_text})]},"artifact"+e.id)}))})]})})})]})}function km(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){var a=t.attacktasks.reduce((function(t,a){return e.find((function(e){return e.attack.t_num===a.attack.t_num}))?Object(y.a)(t):[].concat(Object(y.a)(t),[a])}),[]);return[].concat(Object(y.a)(e),Object(y.a)(a))}),[]);t.sort((function(e,t){return e.attack.t_num>t.attack.t_num?1:t.attack.t_num>e.attack.t_num?-1:0})),i(t)}),[e.tasks]),0===n.length?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"MITRE ATT&CK Mappings"})}),Object(x.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Technique ID"}),Object(x.jsx)(C.a,{children:"Technique"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:e.attack.t_num}),Object(x.jsx)(C.a,{children:e.attack.name})]},"attack"+e.attack.id)}))})]})})})]})}function wm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t.filemeta))}),[]);i(t),t.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0}))}),[e.tasks]),0===n.length?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Files / Screenshots"})}),Object(x.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Filename"}),Object(x.jsx)(C.a,{children:"Type"}),Object(x.jsx)(C.a,{children:"Remote Path"}),Object(x.jsx)(C.a,{children:"Comment"}),Object(x.jsx)(C.a,{children:"Hashes"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:!e.deleted&&e.complete?Object(x.jsx)(oo.a,{href:window.origin+"/api/v1.4/files/download/"+e.agent_file_id,style:{textDecoration:"underline",color:"inherit"},children:e.filename_text}):e.complete?e.filename_text:e.filename_text+" ("+e.chunks_received+"/"+e.total_chunks+")"}),Object(x.jsx)(C.a,{children:e.is_screenshot?"Screenshot":e.is_payload?"Payload":e.is_download_from_agent?"Download":"Upload"}),Object(x.jsx)(C.a,{children:""===e.full_remote_path_text?"":e.host+":"+e.full_remote_path_text}),Object(x.jsx)(C.a,{children:e.comment}),Object(x.jsxs)(C.a,{children:["MD5:",Object(x.jsx)("br",{}),e.md5,Object(x.jsx)("br",{}),"SHA1:",Object(x.jsx)("br",{}),e.sha1]})]},"file"+e.id)}))})]})})})]})}function Cm(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(ee.a)();return Object(o.useEffect)((function(){var t=e.tasks.reduce((function(e,t){return[].concat(Object(y.a)(e),Object(y.a)(t.credentials))}),[]);i(t)}),[e.tasks]),0===n.length?null:Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:r.pageHeader.main,color:r.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Credentials"})}),Object(x.jsx)(T.a,{elevation:5,style:{position:"relative",backgroundColor:r.body},variant:"elevation",children:Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Task"}),Object(x.jsx)(C.a,{children:"Type"}),Object(x.jsx)(C.a,{children:"Realm"}),Object(x.jsx)(C.a,{children:"Account"}),Object(x.jsx)(C.a,{children:"Credentials"}),Object(x.jsx)(C.a,{children:"Comment"})]})}),Object(x.jsx)(w.a,{children:n.map((function(e){return Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:e.task_id}),Object(x.jsx)(C.a,{children:e.type}),Object(x.jsx)(C.a,{children:e.realm}),Object(x.jsx)(C.a,{children:e.account}),Object(x.jsx)(C.a,{children:e.credential_text}),Object(x.jsx)(C.a,{children:e.comment})]},"cred"+e.id)}))})]})})})]})}var Sm,Dm,Im,Tm,$m,Pm=Object(be.a)(vm||(vm=Object(_.a)(["\nquery taskMetadataQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}) {\n      credentials {\n        account\n        comment\n        credential_text\n        id\n        realm\n        type\n        task_id\n      }\n      filemeta {\n        agent_file_id\n        complete\n        deleted\n        filename_text\n        full_remote_path_text\n        host\n        id\n        comment\n        total_chunks\n        chunks_received\n        is_download_from_agent\n        is_payload\n        is_screenshot\n        md5\n        sha1\n        task {\n            comment\n            id\n        }\n      }\n      taskartifacts {\n        artifact_instance_text\n        host\n        task_id\n        artifact{\n            id\n            name\n        }\n        id\n      }\n      tokens {\n        TokenId\n        id\n        host\n      }\n      attacktasks(distinct_on: attack_id) {\n        attack {\n          name\n          os\n          id\n          t_num\n          tactic\n        }\n        id\n      }\n      id\n    }\n  }"])));function Am(e){var t=s.a.useState([]),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(pt.a)(Pm,{onCompleted:function(e){i(e.task)},onError:function(e){console.log("error!",e)}}),c=Object(u.a)(r,1)[0];return Object(o.useEffect)((function(){c({variables:{task_range:e.taskIDs}})}),[e.taskIDs,c]),Object(x.jsxs)("div",{style:{marginTop:"10px",marginRight:"5px"},children:[Object(x.jsx)(_m,{tasks:n}),Object(x.jsx)(km,{tasks:n}),Object(x.jsx)(wm,{tasks:n}),Object(x.jsx)(Cm,{tasks:n})]})}function Em(e){var t=Object(o.useState)(0),a=Object(u.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)([]),c=Object(u.a)(r,2),l=c[0],d=c[1],p=Object(o.useState)(10),m=Object(u.a)(p,2),h=m[0],f=m[1],O=Object(o.useState)(10),g=Object(u.a)(O,2),y=g[0],v=g[1],_=Object(o.useState)("all"),k=Object(u.a)(_,2),w=k[0],C=k[1],S=Object(o.useState)(""),D=Object(u.a)(S,2),I=D[0],T=D[1],$=Object(o.useRef)(null);return Object(o.useEffect)((function(){d(e.taskOptions),e.taskOptions.length>0&&i(e.taskOptions[0])}),[e.tasks,e.taskOptions]),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{id:"form-dialog-title",children:"Add More Tasks to View"}),Object(x.jsxs)(G.a,{dividers:!0,children:[Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(mt.a,{style:{width:"100%"},children:[Object(x.jsx)($t.a,{ref:$,children:"View More Tasks Around Task:"}),Object(x.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:n,onChange:function(e){i(e.target.value)},input:Object(x.jsx)(Ot.a,{}),children:l.map((function(e){return Object(x.jsx)(at.a,{value:e,children:e},"selectiontask:"+e)}))})]}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{})]}),Object(x.jsx)(j.a,{type:"number",value:h,onChange:function(e,t,a){return f(t)},name:"Number of tasks before"}),Object(x.jsx)(j.a,{type:"number",value:y,onChange:function(e,t,a){return v(t)},name:"Number of tasks after"}),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(mt.a,{style:{width:"100%"},children:[Object(x.jsx)($t.a,{ref:$,children:"Search Type"}),Object(x.jsx)(ht.a,{labelId:"demo-dialog-select-label",id:"demo-dialog-select",value:w,onChange:function(e){C(e.target.value)},input:Object(x.jsx)(Ot.a,{}),children:[{type:"all",text:"All Callbacks"},{type:"callback",text:"This Callack"},{type:"operator",text:"All callbacks but limited by operator"}].map((function(e){return Object(x.jsx)(at.a,{value:e.type,children:e.text},"selectiontype:"+e.type)}))})]}),Object(x.jsx)("br",{}),Object(x.jsx)("br",{})]}),"operator"===w?Object(x.jsx)(j.a,{multiline:!1,onChange:function(e,t,a){T(t)},value:I,name:"Operator Username"}):null]}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){e.submitFetchTasks({taskSelected:n,beforeCount:parseInt(h),afterCount:parseInt(y),search:"operator"===w?I:w}),e.onClose()},variant:"contained",color:"secondary",children:"Fetch Tasks"})]})]})}var Lm=Object(be.a)(Sm||(Sm=Object(_.a)(["\nfragment TaskData on task {\n    comment\n    callback_id\n    commentOperator{\n        username\n    }\n    completed\n    id\n    operator{\n        username\n    }\n    display_params\n    original_params\n    command_name\n    status\n    timestamp\n    command {\n        cmd\n        id\n    }\n    callback {\n        id\n        host\n        user\n        integrity_level\n        domain\n    }\n    responses_aggregate{\n        aggregate{\n            count\n        }\n    }\n    parent_task_id\n    opsec_pre_blocked\n    opsec_pre_bypassed\n    opsec_post_blocked\n    opsec_post_bypassed\n    tasks {\n        id\n    }\n    token {\n        id\n    }\n}\n"]))),Fm=Object(be.a)(Dm||(Dm=Object(_.a)(["\n","\nquery tasksQuery($task_range: [Int!]) {\n    task(where: {id: {_in: $task_range}}, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Lm),Nm=Object(be.a)(Im||(Im=Object(_.a)(["\n","\nquery tasksAcrossAllCallbacks($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, order_by: {id: desc}, limit: $beforeCount) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Lm),qm=Object(be.a)(Tm||(Tm=Object(_.a)(["\n","\nquery tasksAcrossACallbacks($callback_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!){\n    before: task(where: {callback:{id: {_eq: $operation_id}}, id:{_lt: $baseTask}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{id: {_eq: $operation_id}}, id:{_gt: $baseTask}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Lm),Rm=Object(be.a)($m||($m=Object(_.a)(["\n","\nquery tasksAcrossAllCallbacksByOperator($operation_id: Int!, $baseTask: Int!, $beforeCount: Int!, $afterCount: Int!, $operator: String!){\n    before: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_lt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $beforeCount, order_by: {id: desc}) {\n        ...TaskData\n    }\n    after: task(where: {callback:{operation_id: {_eq: $operation_id}}, id:{_gt: $baseTask}, operator: {username: {_eq: $operator}}}, limit: $afterCount, order_by: {id: asc}) {\n        ...TaskData\n    }\n}"])),Lm);function Bm(e){var t=Object(f.a)(h.b),a=Object(m.h)().taskId,n=s.a.useState([]),i=Object(u.a)(n,2),r=i[0],c=i[1],l=s.a.useState([]),d=Object(u.a)(l,2),j=d[0],p=d[1],g=s.a.useState([]),_=Object(u.a)(g,2),k=_[0],w=_[1],C=s.a.useState(!1),S=Object(u.a)(C,2),D=S[0],I=S[1],P=s.a.useState(!1),A=Object(u.a)(P,2),E=A[0],F=A[1],N=Object(ee.a)(),q=function(e){var t=e.filter((function(e){return null===e.parent_task_id})),a=[],n=-1;0===t.length&&(t=Object(y.a)(e));var i=k.reduce((function(e,t){return"task"===t.type&&null===t.parent_task_id?e.find((function(e){return e.id===t.id}))?Object(y.a)(e):[].concat(Object(y.a)(e),[Object(v.a)(Object(v.a)({},t),{},{checked:!1})]):Object(y.a)(e)}),Object(y.a)(t));i.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0})),i.forEach((function(e){e.callback.id!==n&&a.push(Object(v.a)(Object(v.a)({type:"callback"},e.callback),{},{checked:!1})),n=e.callback.id,a.push(Object(v.a)(Object(v.a)({type:"task"},e),{},{checked:!1}))})),w(a);var o=e.reduce((function(e,t){var a=t.tasks.filter((function(t){return!e.includes(t.id)})).map((function(e){return e.id}));return e.includes(t.id)?[].concat(Object(y.a)(e),Object(y.a)(a)):[].concat(Object(y.a)(e),[t.id],Object(y.a)(a))}),Object(y.a)(r));c(o)},R=Object(pt.a)(Nm,{onCompleted:function(e){O.b.success("Successfully fetched tasks"),q([].concat(Object(y.a)(e.before),Object(y.a)(e.after)))}}),B=Object(u.a)(R,1)[0],M=Object(pt.a)(qm,{onCompleted:function(e){O.b.success("Successfully fetched tasks"),q([].concat(Object(y.a)(e.before),Object(y.a)(e.after)))}}),z=Object(u.a)(M,1)[0],W=Object(pt.a)(Rm,{onCompleted:function(e){O.b.success("Successfully fetched tasks"),q([].concat(Object(y.a)(e.before),Object(y.a)(e.after)))}}),H=Object(u.a)(W,1)[0],U=Object(pt.a)(Fm,{onCompleted:function(e){q(e.task)}}),G=Object(u.a)(U,1)[0],K=function(e){var t=k.map((function(t){return"task"===t.type&&"task"+t.id===e.target.name?Object(v.a)(Object(v.a)({},t),{},{checked:e.target.checked}):Object(v.a)({},t)}));w(t)};return Object(o.useEffect)((function(){if(window.location.pathname.includes("/new/tasks/by_range")){var e=new URLSearchParams(window.location.search);if(e.has("tasks")){console.log(e.get("tasks"));var t=function(e){for(var t=[],a=e.split(","),n=0;n<a.length;n++)a[n].includes("-")?function(){var e=a[n].split("-");e=e.map((function(e){return parseInt(e)})),t.push.apply(t,Object(y.a)(Object(y.a)(Array(e[1]-e[0]+1).keys()).map((function(t){return t+e[0]}))))}():t.push(parseInt(a[n]));return t.sort((function(e,t){return e-t})),t}(e.get("tasks"));G({variables:{task_range:t}})}else O.b.warning("URL Query missing '?tasks=' with a range of tasks")}else G({variables:{task_range:[parseInt(a)]}})}),[G,a]),Object(x.jsxs)("div",{style:{marginTop:"10px",maxHeight:"calc(94vh)",width:"100%",marginBottom:"10px"},children:[Object(x.jsxs)(T.a,{elevation:5,style:{backgroundColor:N.pageHeader.main,color:N.pageHeaderText.main,marginBottom:"5px",marginTop:"10px",marginRight:"5px"},variant:"elevation",children:[Object(x.jsx)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Task View"}),Object(x.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:N.palette.success.main},onClick:function(){var e=function(e){e.sort((function(e,t){return e-t}));for(var t,a,n=[],i=0;i<e.length;i++){for(a=t=e[i];e[i+1]-e[i]===1;)a=e[i+1],i++;n.push(t===a?t+"":t+"-"+a)}return n.join(",")}(Object(y.a)(r));Object(Xo.a)(window.origin+"/new/tasks/by_range?tasks="+e),O.b.success("Copied link to clipboard!")},children:"Get Shareable link"}),Object(x.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:N.palette.warning.main},onClick:function(){I(!D);var e=k.filter((function(e){return!e.checked}));w(e);var t=e.reduce((function(e,t){return"task"===t.type?[].concat(Object(y.a)(e),[t.id]):Object(y.a)(e)}),[]);c(t)},children:"Remove Tasks From View"}),Object(x.jsx)(b.a,{variant:"contained",color:"primary",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px"},onClick:function(e){e.stopPropagation(),O.b.warning("Not implemented yet")},children:"Add Tags To All"})]}),k.map((function(e){return"task"===e.type?Object(x.jsxs)(ft.a,{container:!0,alignItems:"stretch",style:{marginRight:"5px"},children:[Object(x.jsx)(ft.a,{item:!0,style:{display:"inline-flex",width:D?"96%":"100%"},children:Object(x.jsx)(Bd.a,{task:e,command_id:null===e.command?0:e.command.id})}),Object(x.jsx)(ft.a,{item:!0,style:{display:"inline-flex"},children:D?Object(x.jsx)($.a,{checked:e.checked,onChange:K,name:"task"+e.id,inputProps:{"aria-label":"checkbox",color:N.palette.error.main}}):null})]},"taskdisplay:"+e.id):Object(x.jsxs)(T.a,{elevation:5,style:{marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(x.jsxs)(L.a,{variant:"h4",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:[""===e.domain?null:e.domain+"\\",e.user,e.integrity_level>2?"*":null,"@",e.host," (",e.id,")"]}),Object(x.jsx)(b.a,{variant:"contained",size:"small",style:{display:"inline-block",float:"right",marginTop:"5px",marginRight:"10px",backgroundColor:N.palette.info.main},onClick:function(){!function(e){var t=k.reduce((function(t,a){return"task"===a.type&&a.callback.id===e?[].concat(Object(y.a)(t),[a.id]):Object(y.a)(t)}),[]);p(t),F(!0)}(e.id)},children:"Include More Tasks"})]},"taskdisplayforcallback:"+e.id)})),Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:E,onClose:function(){F(!1)},innerDialog:Object(x.jsx)(Em,{submitFetchTasks:function(e){var a=e.taskSelected,n=e.beforeCount,i=e.afterCount,r=e.search;switch(O.b.info("Searching for tasks..."),r){case"all":B({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i}});break;case"callback":z({variables:{}});break;default:H({variables:{operation_id:t.user.current_operation_id,baseTask:a,beforeCount:n,afterCount:i,operator:r}})}},taskOptions:j,onClose:function(){F(!1)}})}),Object(x.jsx)(Am,{taskIDs:r})]})}var Mm,zm,Wm,Hm,Um=a(360),Gm=a(913),Km=a(523),Vm=Object(Km.a)(Mm||(Mm=Object(_.a)(["\nbody {\n    margin: 0\n}\nhtml, body, #root {\n    height: 100%;\n}\n.MuiAccordionDetails-root{\n\n    padding-bottom: 0;\n    padding-top: 0;\n}\n.MuiAccordionSummary-content.Mui-expanded{\n    margin: 0px 0px 0px 0px !important;\n    min-height: unset;\n}\n.MuiAccordionSummary-root.Mui-expanded{\n    min-height: unset;\n}\n// placeholder/helper text for input boxes\n.MuiFormLabel-root {\n    background: transparent;\n}\n.MuiTableCell-head {\n\n    font-weight: bold;\n}\n.MuiSelect-select.MuiSelect-select{\n    padding-left: 10px\n}\n.ReactVirtualized__Table__row {\n    &:hover,\n    &--hovered {\n        background-color: "," !important;\n        color: "," !important;\n        \n    }\n}\n.menuEntry {\n  cursor: pointer;\n}\n\ntspan {\n  font-size: 15px;\n  stroke: none;\n}\n\n.ReactVirtualized__Table__headerTruncatedText {\n\n  }\n.ReactVirtualized__Table__headerColumn {\n\n    padding: 0;\n  }\n.MuiTab-root {\n    max-width: unset;\n}\n.MuiSpeedDialAction-staticTooltipLabel {\n    white-space: nowrap;\n    max-width: none;\n}\n.MuiTreeItem-root.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label{\n    background-color: transparent;\n}\n.MuiTreeItem-root.Mui-selected:hover > .MuiTreeItem-content .MuiTreeItem-label{\n    background-color: transparent;\n}\n.MuiTreeItem-root:hover > .MuiTreeItem-content .MuiTreeItem-label {\n    background-color: transparent;\n}\n.MuiAppBar-root{\n    z-index: 1\n}\n.ace-monokai .ace_invalid {\n    color: #F8F8F0;\n    background-color: #52524d;\n}\n"])),(function(e){return e.theme.tableHover}),(function(e){return e.theme.palette.text.primary})),Qm=a(914),Jm=Object(be.a)(zm||(zm=Object(_.a)(["\nmutation generateReportMutation($outputFormat: String!, $includeMITREPerTask: Boolean!, $includeMITREOverall: Boolean!, $excludedUsers: String!, $excludedHosts: String!, $excludedIDs: String!, $includeOutput: Boolean!){\n    generateReport(outputFormat: $outputFormat, includeMITREPerTask: $includeMITREPerTask, includeMITREOverall: $includeMITREOverall, excludedUsers: $excludedUsers, excludedHosts: $excludedHosts, excludedIDs: $excludedIDs, includeOutput: $includeOutput){\n        status\n        error\n    }\n}\n"]))),Ym=Object(be.a)(Wm||(Wm=Object(_.a)(['\nsubscription generatedReportEventSubscription($fromNow: timestamp!, $operation_id: Int!){\n    operationeventlog(limit: 1, where: {deleted: {_eq: false}, timestamp: {_gte: $fromNow}, operation_id: {_eq: $operation_id}, source: {_eq: "generated_report"}}, order_by: {id: desc}) {\n        operator {\n            username\n        }\n        message\n        level\n      }\n}\n'])));function Zm(e){var t,a=Object(ee.a)(),n=Object(f.a)(h.b),i=s.a.useRef((new Date).toISOString()),r=s.a.useState("pdf"),c=Object(u.a)(r,2),l=c[0],d=c[1],p=s.a.useState(!1),m=Object(u.a)(p,2),g=m[0],y=m[1],v=s.a.useState(!1),_=Object(u.a)(v,2),P=_[0],A=_[1],E=s.a.useState(!1),L=Object(u.a)(E,2),F=L[0],N=L[1],q=s.a.useState(""),R=Object(u.a)(q,2),B=R[0],M=R[1],z=s.a.useState(""),W=Object(u.a)(z,2),H=W[0],U=W[1],G=s.a.useState(""),K=Object(u.a)(G,2),V=K[0],Q=K[1],J=Object(pe.a)(Jm,{onCompleted:function(e){"success"===e.generateReport.status?(O.b.info("Generating report..."),O.b.info("Final reports are always available via the 'Uploads' tab within 'Search'")):O.b.error(e.generateReport.error)},onError:function(e){O.b.error(e)}}),Y=Object(u.a)(J,1)[0],Z=Object(Me.a)(Ym,{variables:{fromNow:i.current,operation_id:(null===n||void 0===n||null===(t=n.user)||void 0===t?void 0:t.current_operation_id)||0},fetchPolicy:"no-cache",onError:function(e){O.b.warning("Failed to get notifications for generated payloads")}}).data;return Object(o.useEffect)((function(){var e;if((null===Z||void 0===Z||null===(e=Z.operationeventlog)||void 0===e?void 0:e.length)>0){var t=Z.operationeventlog[0].message.split(":").pop().trim();O.b.success("",{persist:!0,content:function(e){return Object(x.jsx)(cu,{id:e,title:"Download Generated Report",downloadLink:window.location.origin+"/api/v1.4/files/download/"+t})}})}}),[Z]),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(S.a,{component:T.a,className:"mythicElement",children:Object(x.jsxs)(k.a,{size:"small",style:{tableLayout:"fixed",maxWidth:"calc(100vw)",overflow:"scroll"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"25rem"},children:"Report Option"}),Object(x.jsx)(C.a,{children:"Selected Values"})]})}),Object(x.jsxs)(w.a,{children:[Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Output Format"}),Object(x.jsx)(C.a,{children:Object(x.jsx)(ht.a,{autoFocus:!0,style:{width:"100%",marginBottom:"10px"},value:l,label:"Select an Output Format",onChange:function(e){d(e.target.value),"json"!==e.target.value&&N(!1)},children:["pdf","latex","json"].map((function(e,t){return Object(x.jsx)(at.a,{value:e,children:e},"outputformat"+t)}))})})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Include MITRE ATT&CK Coverage Per Task"}),Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:g,onChange:function(e){return y(!g)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Include MITRE ATT&CK Coverage Overview"}),Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:P,onChange:function(e){return A(!P)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),"json"===l&&Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Include Command Output"}),Object(x.jsx)(C.a,{children:Object(x.jsx)($.a,{checked:F,onChange:function(e){return N(!F)},inputProps:{"aria-label":"primary checkbox"},name:"active"})})]}),Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:"Exclude Callbacks With Matching Values"}),Object(x.jsx)(C.a,{children:Object(x.jsx)(k.a,{children:Object(x.jsxs)(w.a,{children:[Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"10rem"},children:"Exclude Users"}),Object(x.jsx)(C.a,{children:Object(x.jsx)(j.a,{onChange:function(e,t,a){U(t)},value:H,name:"Excluded Usernames"})})]}),Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Exclude Hosts"}),Object(x.jsx)(C.a,{children:Object(x.jsx)(j.a,{onChange:function(e,t,a){M(t)},value:B,name:"Excluded Hostnames"})})]}),Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Exclude IDs"}),Object(x.jsx)(C.a,{children:Object(x.jsx)(j.a,{onChange:function(e,t,a){Q(t)},value:V,name:"Excluded Callback IDs"})})]})]})})})]})]})]})}),Object(x.jsx)(b.a,{variant:"contained",style:{marginTop:"10px",backgroundColor:a.palette.success.main,color:"white"},onClick:function(){Y({variables:{outputFormat:l,includeMITREOverall:P,includeMITREPerTask:g,includeOutput:F,excludedUsers:H,excludedHosts:B,excludedIDs:V}})},children:"Generate"})]})}function Xm(){var e=Object(ee.a)();return Object(x.jsxs)("div",{style:{maxHeight:"calc(96vh)",margin:"10px"},children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:e.pageHeader.main,color:e.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"Mythic Report Generation"})}),Object(x.jsx)(Zm,{})]})}function eh(e){var t=e.entry,a=e.showCountGrouping,n=e.onClose,i=s.a.useState([]),r=Object(u.a)(i,2),c=r[0],o=r[1],l=s.a.useState([]),d=Object(u.a)(l,2),j=d[0],p=d[1];return s.a.useEffect((function(){switch(a){case"":break;case"command":var e=t.commands.reduce((function(e,t){return t.payloadtype.ptype in e?e[t.payloadtype.ptype].push(t.cmd):e[t.payloadtype.ptype]=[t.cmd],Object(v.a)({},e)}),{});o(Object.entries(e));break;case"task":var n=t.tasks.reduce((function(e,t){return t.callback.payload.payloadtype.ptype in e?e[t.callback.payload.payloadtype.ptype].push({id:t.id,command:t.command_name+" "+t.display_params,comment:t.comment,callback_id:t.callback.id}):e[t.callback.payload.payloadtype.ptype]=[{id:t.id,command:t.command_name+" "+t.display_params,comment:t.comment,callback_id:t.callback.id}],Object(v.a)({},e)}),{});p(Object.entries(n))}}),[t,a]),Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsxs)(V.a,{id:"form-dialog-title",children:[t.name," - ",Object(x.jsx)(oo.a,{style:{wordBreak:"break-all"},underline:"always",target:"_blank",href:"https://attack.mitre.org/techniques/"+t.t_num.replace(".","/"),children:t.t_num})]}),Object(x.jsx)(G.a,{dividers:!0,children:"command"===a?Object(x.jsx)(th,{commands:c}):Object(x.jsx)(ah,{tasks:j})}),Object(x.jsx)(U.a,{children:Object(x.jsx)(b.a,{onClick:n,variant:"contained",color:"secondary",children:"Close"})})]})}function th(e){var t=e.commands,a=(Object(f.a)(h.b),Object(ee.a)());return Object(x.jsx)(s.a.Fragment,{children:t.map((function(e){return Object(x.jsxs)("div",{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:e[0]})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{children:"Command"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Documentation"})]})}),Object(x.jsx)(w.a,{children:e[1].map((function(t){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:t}),Object(x.jsx)(C.a,{children:Object(x.jsx)(b.a,{variant:"contained",color:"primary",target:"_blank",href:"/docs/agents/"+e[0]+"/commands/"+t,children:"Docs"})})]},"command"+t)}))})]})]},"agent"+e[0])}))})}function ah(e){var t=e.tasks,a=(Object(f.a)(h.b),Object(ee.a)());return Object(x.jsx)(s.a.Fragment,{children:t.map((function(e){return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(T.a,{elevation:5,style:{backgroundColor:a.pageHeader.main,color:a.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:Object(x.jsx)(L.a,{variant:"h6",style:{textAlign:"left",display:"inline-block",marginLeft:"20px",color:a.pageHeaderColor},children:e[0]})}),Object(x.jsxs)(k.a,{size:"small","aria-label":"details",style:{overflowWrap:"break-word"},children:[Object(x.jsx)(D.a,{children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Callback"}),Object(x.jsx)(C.a,{style:{width:"5rem"},children:"Task"}),Object(x.jsx)(C.a,{children:"Command"}),Object(x.jsx)(C.a,{children:"Comment"})]})}),Object(x.jsx)(w.a,{children:e[1].map((function(e){return Object(x.jsxs)(I.a,{hover:!0,children:[Object(x.jsx)(C.a,{children:Object(x.jsx)("a",{href:"/new/callbacks/"+e.callback_id,target:"_blank",children:e.callback_id})}),Object(x.jsx)(C.a,{children:Object(x.jsx)("a",{href:"/new/task/"+e.id,target:"_blank",children:e.id})}),Object(x.jsx)(C.a,{children:e.command}),Object(x.jsx)(C.a,{children:e.comment})]})}))})]})]})}))})}function nh(e){var t,a=e.row,n=e.showCountGrouping,i=s.a.useState({}),r=Object(u.a)(i,2),c=r[0],o=r[1],l=s.a.useState(!1),d=Object(u.a)(l,2),j=d[0],p=d[1];return s.a.useEffect((function(){switch(n){case"":o({});break;case"command":a.commands.length>0?o({color:"white",backgroundColor:"rgb(188, 58, 36)"}):o({});break;case"task":a.tasks.length>0?o({color:"white",backgroundColor:"rgb(188, 58, 36)"}):o({})}}),[a.commands,a.tasks,n]),Object(x.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(null===a||void 0===a||null===(t=a.t_num)||void 0===t?void 0:t.includes("."))?Object(x.jsx)(P.a,{width:"50px",height:"1px",style:{border:"1px dashed grey"}}):null,Object(x.jsx)(b.a,{style:Object(v.a)({width:"100%",justifyContent:"flex-start"},c),variant:"outlined",onClick:function(){return p(!0)},children:a.name}),j?Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"md",open:j,onClose:function(){p(!1)},innerDialog:Object(x.jsx)(eh,{entry:a,showCountGrouping:n,onClose:function(){p(!1)}})}):null]})}function ih(e){var t=e.column,a=e.showCountGrouping,n=Object(ee.a)(),i=s.a.useState(0),r=Object(u.a)(i,2),c=r[0],o=r[1],l=s.a.useState(0),d=Object(u.a)(l,2),b=d[0],j=d[1];return s.a.useEffect((function(){var e;switch(a){case"":j((null===t||void 0===t||null===(e=t.rows)||void 0===e?void 0:e.length)||0),o(0);break;case"command":o(t.commands);var n=t.rows.reduce((function(e,t){return t.commands.length>0?e+1:e}),0);j(n);break;case"task":o(t.tasks);var i=t.rows.reduce((function(e,t){return t.tasks.length>0?e+1:e}),0);j(i)}}),[t.commands,t.rows,t.tasks,a]),Object(x.jsxs)("div",{style:{display:"flex",flexDirection:"column",paddingRight:"15px"},children:[Object(x.jsxs)(P.a,{height:"100px",width:"100%",style:{backgroundColor:n.tableHover},children:[Object(x.jsx)("h2",{style:{margin:0,textAlign:"center"},children:Object(x.jsx)("b",{children:t.tactic})}),Object(x.jsxs)("p",{style:{textAlign:"center",margin:0},children:[b," techniques"]}),""===a?null:Object(x.jsxs)("p",{style:{textAlign:"center",margin:0},children:[c," ",a,"s"]})]}),Object(x.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:t.rows.map((function(e,t){return Object(x.jsx)(nh,{row:e,showCountGrouping:a},"row"+t)}))})]})}var rh,ch,oh,sh,lh,dh=Object(be.a)(Hm||(Hm=Object(_.a)(["\nquery getAllPayloadTypes{\n  payloadtype(where: {wrapper: {_eq: false}}, order_by: {ptype: asc}) {\n    ptype\n  }\n}\n"]))),uh=Object(Se.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120,width:"97%"}}}));function bh(e){var t=uh(),a=s.a.useState([]),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState(""),o=Object(u.a)(c,2),l=o[0],d=o[1],j=Object(je.a)(dh,{onCompleted:function(e){var t=e.payloadtype.map((function(e){return e.ptype}));t.length>0&&d(t[0]),r(t)},fetchPolicy:"network-only"}),p=j.loading,m=j.error;return p?Object(x.jsx)(Ae.a,{style:{marginTop:"10px"}}):m?(console.error(m),Object(x.jsx)("div",{children:"Error!"})):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(V.a,{children:"Select a Payload Type to Filter On"}),Object(x.jsx)(G.a,{dividers:!0,children:Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(mt.a,{className:t.formControl,children:Object(x.jsxs)(ht.a,{labelId:"demo-dialog-select-label-profile",id:"demo-dialog-select",value:l,onChange:function(e){d(e.target.value)},style:{minWidth:"30%"},children:[Object(x.jsx)(at.a,{value:"",children:"None"}),i.map((function(e){return Object(x.jsx)(at.a,{value:e,children:e},e)}))]})})})}),Object(x.jsxs)(U.a,{children:[Object(x.jsx)(b.a,{onClick:e.onClose,variant:"contained",color:"primary",children:"Close"}),Object(x.jsx)(b.a,{onClick:function(){""!==l?(e.onSubmit(l),e.onClose()):e.onClose()},variant:"contained",style:{backgroundColor:Tr.a.palette.success.main},children:"Select"})]})]})}function jh(e){var t=e.entries,a=e.onGetCommands,n=e.onGetTasks,i=e.onGetCommandsFiltered,r=e.onGetTasksFiltered,c=Object(ee.a)(),o=s.a.useRef(null),l=s.a.useState(!1),d=Object(u.a)(l,2),j=d[0],p=d[1],m=s.a.useState(""),h=Object(u.a)(m,2),f=h[0],O=h[1],g=s.a.useState(!1),y=Object(u.a)(g,2),_=y[0],k=y[1],w=s.a.useState(!1),C=Object(u.a)(w,2),S=C[0],D=C[1],I=s.a.useState(!1),$=Object(u.a)(I,2),P=$[0],A=$[1],E=s.a.useState(!1),F=Object(u.a)(E,2),N=F[0],q=F[1],R=[{name:"Fetch All Commands Mapped to MITRE",click:function(){k(!0),O("command"),p(!1),a()}},{name:"Fetch All Issued Tasks Mapped to MITRE",click:function(){O("task"),p(!1),n()}},{name:"Fetch Command Mappings by Payload Type",click:function(){p(!1),q(!0)}},{name:"Fetch Task Mappings by Payload Type",click:function(){p(!1),A(!0)}},{name:"Export Highlighted to ATT&CK Navigator",click:function(){p(!1),B()}},{name:"View MITRE License",click:function(){D(!0),p(!1)}}];s.a.useEffect((function(){k(!1)}),[t]);var B=function(){var e={name:"layer",versions:{attack:"10",navigator:"4.5.5",layer:"4.3"},domain:"enterprise-attack",description:"",filters:{platforms:["Linux","macOS","Windows","Azure AD","Office 365","SaaS","IaaS","Google Workspace","PRE","Network","Containers"]},sorting:0,layout:{layout:"side",aggregateFunction:"average",showID:!1,showName:!0,showAggregateScores:!1,countUnscored:!1},hideDisabled:!1,techniques:[],gradient:{colors:["#ff6666ff","#ffe766ff","#8ec843ff"],minValue:0,maxValue:100},legendItems:[],metadata:[],links:[],showTacticRowBackground:!1,tacticRowBackground:"#dddddd",selectTechniquesAcrossTactics:!0,selectSubtechniquesWithParent:!1};for(var a in t)for(var n=0;n<t[a].rows.length;n++)switch(f){case"":break;case"command":t[a].rows[n].commands.length>0&&e.techniques.push({techniqueID:t[a].rows[n].t_num,tactic:a.replace(" ","-").toLowerCase(),color:"#bc3b24",enabled:!0,comment:"",metadata:[],links:[],showSubtechniques:!0});break;case"task":t[a].rows[n].tasks.length>0&&e.techniques.push({techniqueID:t[a].rows[n].t_num,tactic:a.replace(" ","-").toLowerCase(),color:"#bc3b24",enabled:!0,comment:"",metadata:[],links:[],showSubtechniques:!0})}var i=new Blob([JSON.stringify(e,null,2)],{type:"application/octet-stream"}),r=document.getElementById("download_config");if(null!==r)r.href=URL.createObjectURL(i),r.download="attack_navigator.json",r.click();else{var c=document.createElement("a");c.id="download_config",c.href=URL.createObjectURL(i),c.download="attack_navigator.json",document.body.appendChild(c),c.click()}};return Object(x.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[Object(x.jsxs)(T.a,{elevation:5,style:{backgroundColor:c.pageHeader.main,color:c.pageHeaderText.main,marginBottom:"5px",marginTop:"10px"},variant:"elevation",children:[Object(x.jsx)(L.a,{variant:"h3",style:{textAlign:"left",display:"inline-block",marginLeft:"20px"},children:"MITRE ATT&CK Mappings"}),Object(x.jsx)(Je.a,{variant:"contained",ref:o,"aria-label":"split button",style:{marginRight:"10px",marginTop:"10px",float:"right"},color:"primary",children:Object(x.jsxs)(b.a,{size:"small",color:"primary","aria-controls":j?"split-button-menu":void 0,"aria-expanded":j?"true":void 0,"aria-haspopup":"menu",onClick:function(){return p(!j)},children:["Actions ",Object(x.jsx)(Ze.a,{})]})}),Object(x.jsx)(tt.a,{open:j,anchorEl:o.current,role:void 0,transition:!0,style:{zIndex:10},children:function(e){var t=e.TransitionProps,a=e.placement;return Object(x.jsx)(et.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom"===a?"center top":"center bottom"},children:Object(x.jsx)(T.a,{style:{backgroundColor:"dark"===c.palette.type?c.palette.primary.dark:c.palette.primary.light,color:"white"},children:Object(x.jsx)(Xe.a,{onClickAway:function(){return p(!1)},children:Object(x.jsx)(nt.a,{id:"split-button-menu",children:R.map((function(e,t){return Object(x.jsx)(at.a,{onClick:function(e){return function(e,t){R[t].click(e)}(e,t)},children:e.name},e.name)}))})})})}))}})]}),Object(x.jsxs)("div",{style:{display:"flex",flexGrow:1,overflow:"auto"},children:[Object(x.jsx)(_s.a,{open:_,style:{zIndex:2,position:"absolute"},invisible:!1,children:Object(x.jsx)(oa.a,{color:"inherit"})}),S&&Object(x.jsx)(Rl.a,{onClose:function(){D(!1)},title:"MITRE ATT&CK Usage License",maxWidth:"md",fullWidth:!0,value:"The MITRE Corporation (MITRE) hereby grants you a non-exclusive, royalty-free license to use ATT&CK\xae for research, development, and commercial purposes. Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.\n    \n\xa9 2021 The MITRE Corporation. This work is reproduced and distributed with the permission of The MITRE Corporation.",open:S}),P&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:P,onClose:function(){A(!1)},innerDialog:Object(x.jsx)(bh,{onClose:function(){A(!1)},onSubmit:function(e){k(!0),O("task"),r(e)}})}),N&&Object(x.jsx)(Y.a,{fullWidth:!0,maxWidth:"sm",open:N,onClose:function(){q(!1)},innerDialog:Object(x.jsx)(bh,{onClose:function(){q(!1)},onSubmit:function(e){k(!0),O("command"),i(e)}})}),["Reconnaissance","Resource Development","Initial Access","Execution","Persistence","Privilege Escalation","Defense Evasion","Credential Access","Discovery","Lateral Movement","Collection","Command And Control","Exfiltration","Impact"].map((function(e){return Object(x.jsx)(ih,{column:t[e],showCountGrouping:f},e)}))]})]})}var ph=Object(be.a)(rh||(rh=Object(_.a)(["\nquery GetMitreAttack {\n  attack(order_by: {t_num: asc}){\n    id\n    name\n    t_num\n    os\n    tactic\n  }\n}\n"]))),mh=Object(be.a)(ch||(ch=Object(_.a)(["\nquery GetMitreTaskAttack($operation_id: Int!) {\n  attacktask(where: {task: {callback: {operation_id: {_eq: $operation_id}}}}) {\n    attack_id\n    task {\n      id\n      command_name\n      comment\n      display_params\n      callback {\n        id\n        payload {\n          payloadtype {\n            ptype\n          }\n        }\n      }\n    }\n  }\n}\n"]))),hh=Object(be.a)(oh||(oh=Object(_.a)(["\nquery GetMitreTaskAttack($operation_id: Int!, $payload_type: String!) {\n  attacktask(where: {task: {callback: {operation_id: {_eq: $operation_id}, payload: {payloadtype: {ptype: {_eq: $payload_type}}}}}}) {\n    attack_id\n    task {\n      id\n      command_name\n      comment\n      display_params\n      callback {\n        id\n        payload {\n          payloadtype {\n            ptype\n          }\n        }\n      }\n    }\n  }\n}\n"]))),fh=Object(be.a)(sh||(sh=Object(_.a)(["\nquery GetMitreCommandAttack{\n  attackcommand {\n    attack_id\n    command {\n      cmd\n      payloadtype {\n        ptype\n      }\n    }\n  }\n}\n"]))),Oh=Object(be.a)(lh||(lh=Object(_.a)(["\nquery GetMitreCommandAttack($payload_type: String!){\n  attackcommand(where: {command: {payloadtype: {ptype: {_eq: $payload_type}}}}) {\n    attack_id\n    command {\n      cmd\n      payloadtype {\n        ptype\n      }\n    }\n  }\n}\n"])));function xh(e){var t=Object(f.a)(h.b),a=s.a.useState(!0),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useState({Reconnaissance:{rows:[],tactic:"Reconnaissance",commands:0,tasks:0},"Resource Development":{rows:[],tactic:"Resource Development",commands:0,tasks:0},"Initial Access":{rows:[],tactic:"Initial Access",commands:0,tasks:0},Execution:{rows:[],tactic:"Execution",commands:0,tasks:0},Persistence:{rows:[],tactic:"Persistence",commands:0,tasks:0},"Privilege Escalation":{rows:[],tactic:"Privilege Escalation",commands:0,tasks:0},"Defense Evasion":{rows:[],tactic:"Defense Evasion",commands:0,tasks:0},"Credential Access":{rows:[],tactic:"Credential Access",commands:0,tasks:0},Discovery:{rows:[],tactic:"Discovery",commands:0,tasks:0},"Lateral Movement":{rows:[],tactic:"Lateral Movement",commands:0,tasks:0},Collection:{rows:[],tactic:"Collection",commands:0,tasks:0},"Command And Control":{rows:[],tactic:"Command And Control",commands:0,tasks:0},Exfiltration:{rows:[],tactic:"Exfiltration",commands:0,tasks:0},Impact:{rows:[],tactic:"Impact",commands:0,tasks:0}}),o=Object(u.a)(c,2),l=o[0],d=o[1],b=Object(pt.a)(fh,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){var t=Object(y.a)(e.attackcommand),a=Object(v.a)({},l),n=function(e){for(var n=0,i=function(i){a[e].rows[i].commands=[],t=t.filter((function(t){return t.attack_id!==a[e].rows[i].id||(a[e].rows[i].commands.push(Object(v.a)({},t.command)),!1)})),n+=a[e].rows[i].commands.length},r=0;r<a[e].rows.length;r++)i(r);a[e].commands=n};for(var i in a)n(i);d(a)}}),j=Object(u.a)(b,1)[0],p=Object(pt.a)(Oh,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){var t=Object(y.a)(e.attackcommand),a=Object(v.a)({},l),n=function(e){for(var n=0,i=function(i){a[e].rows[i].commands=[],t=t.filter((function(t){return t.attack_id!==a[e].rows[i].id||(a[e].rows[i].commands.push(Object(v.a)({},t.command)),!1)})),n+=a[e].rows[i].commands.length},r=0;r<a[e].rows.length;r++)i(r);a[e].commands=n};for(var i in a)n(i);d(a)}}),m=Object(u.a)(p,1)[0],g=Object(pt.a)(mh,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){var t=Object(y.a)(e.attacktask),a=Object(v.a)({},l),n=function(e){for(var n=0,i=function(i){a[e].rows[i].tasks=[],t=t.filter((function(t){return t.attack_id!==a[e].rows[i].id||(a[e].rows[i].tasks.push(Object(v.a)({},t.task)),!1)})),n+=a[e].rows[i].tasks.length},r=0;r<a[e].rows.length;r++)i(r);a[e].tasks=n};for(var i in a)n(i);d(a)}}),_=Object(u.a)(g,1)[0],k=Object(pt.a)(hh,{onError:function(e){console.error(e)},fetchPolicy:"network-only",onCompleted:function(e){var t=Object(y.a)(e.attacktask),a=Object(v.a)({},l),n=function(e){for(var n=0,i=function(i){a[e].rows[i].tasks=[],t=t.filter((function(t){return t.attack_id!==a[e].rows[i].id||(a[e].rows[i].tasks.push(Object(v.a)({},t.task)),!1)})),n+=a[e].rows[i].tasks.length},r=0;r<a[e].rows.length;r++)i(r);a[e].tasks=n};for(var i in a)n(i);d(a)}}),w=Object(u.a)(k,1)[0];Object(je.a)(ph,{fetchPolicy:"no-cache",onCompleted:function(e){var t=e.attack.reduce((function(e,t){for(var a=Object(v.a)(Object(v.a)({},t),{},{os:JSON.parse(t.os),tactic:JSON.parse(t.tactic),commands:[],tasks:[]}),n=Object(v.a)({},e),i=0;i<a.tactic.length;i++)n[a.tactic[i]]?n[a.tactic[i]].rows.push(a):n[a.tactic[i]]={rows:[a],tactic:a.tactic[i],commands:0,tasks:0};return Object(v.a)({},n)}),{});d(t),r(!1)},onError:function(e){O.b.error("Failed to fetch MITRE data: "+e.toString())}});return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(_s.a,{open:i,style:{zIndex:2,position:"absolute"},invisible:!1,children:Object(x.jsx)(oa.a,{color:"inherit",disableShrink:!0})}),Object(x.jsx)(jh,{entries:l,onGetCommands:j,onGetTasks:function(){var e;_({variables:{operation_id:(null===t||void 0===t||null===(e=t.user)||void 0===e?void 0:e.current_operation_id)||0}})},onGetTasksFiltered:function(e){var a;w({variables:{operation_id:(null===t||void 0===t||null===(a=t.user)||void 0===a?void 0:a.current_operation_id)||0,payload_type:e}})},onGetCommandsFiltered:function(e){m({variables:{payload_type:e}})}})]})}function gh(e){var t=Object(f.a)(h.b),a=function(){var e=Object(o.useState)("light"),t=Object(u.a)(e,2),a=t[0],n=t[1],i=Object(o.useState)(!1),r=Object(u.a)(i,2),c=r[0],s=r[1],l=function(e){window.localStorage.setItem("theme",e),n(e)};return Object(o.useEffect)((function(){var e=window.localStorage.getItem("theme");e?n(e):l("light"),s(!0)}),[]),[a,function(){l("light"===a?"dark":"light")},c]}(),n=Object(u.a)(a,2),i=n[0],r=n[1],c=s.a.useMemo((function(){return Object(Um.a)({palette:{primary:{main:"#7f93c0"},secondary:{main:"#a791c3"},error:{main:"#f44336"},warning:{main:"#ff9800"},info:{main:"#2196f3"},disabled:{main:"rgba(0, 0, 0, 0.38)"},type:i,background:{default:"dark"===i?"rgb(37, 41, 51)":"#ffffff",paper:"dark"===i?"rgb(50, 60, 69)":"#ffffff",contrast:"dark"===i?"#ffffff":"rgb(37, 41, 51)"},text:{primary:"dark"===i?"#fff":"#000",secondary:"dark"===i?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.54)",contrast:"dark"===i?"#000":"#fff"},textBackgroundColor:"dark"===i?"#74828b":"#d9dbdc",textBackgroundColorMythic:"dark"===i?"#436b9f":"#aadcf5",textBackgroundColorSuccess:"dark"===i?"#09a21a":"#70e373",textBackgroundColorError:"dark"===i?"#9f1616":"#f19da3",graphGroup:"dark"===i?"#394c5d":"#d3d7e8"},folderColor:"#f1d592",tableHeader:"#484848",tableBorder:"dark"===i?"rgba(81,81,81,1)":"rgba(224,224,224,1)",tableHover:"dark"===i?"rgba(85,88,93)":"rgba(245, 245, 245)",pageHeader:{main:"#827E80"},pageHeaderText:{main:"white"}})}),[i]);return Object(x.jsxs)(Gm.a,{theme:c,children:[Object(x.jsx)(Vm,{theme:c}),Object(x.jsx)(Qm.a,{}),Object(x.jsxs)(qa.b,{maxSnack:5,anchorOrigin:{vertical:"top",horizontal:"center"},children:[Object(x.jsx)(O.a,{}),Object(x.jsxs)("div",{style:{maxHeight:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[Object(x.jsx)("div",{style:{minHeight:"54px",flexGrow:0},children:t.loggedIn&&void 0!==t.user&&null!==t.user?Object(x.jsx)(ym,{theme:i,toggleTheme:r}):null}),Object(x.jsx)("div",{style:{margin:"0px 16px 0px 16px",flexGrow:1,display:"flex",flexDirection:"column",height:"calc(100% - 54px)",maxHeight:"calc(100% - 54px)"},children:Object(x.jsxs)(m.d,{children:[Object(x.jsx)(Oo,{exact:!0,path:"/new",component:mo}),Object(x.jsx)(m.b,{exact:!0,path:"/new/login",component:g}),Object(x.jsx)(Oo,{exact:!0,path:"/new/settings",component:we}),Object(x.jsx)(Oo,{exact:!0,path:"/new/payloadtypes",component:aa}),Object(x.jsx)(Oo,{exact:!0,path:"/new/eventfeed",component:fi}),Object(x.jsx)(Oo,{exact:!0,path:"/new/createpayload",component:tn}),Object(x.jsx)(Oo,{exact:!0,path:"/new/createwrapper",component:Pn}),Object(x.jsx)(Oo,{exact:!0,path:"/new/payloads",component:Rc}),Object(x.jsx)(Oo,{exact:!0,path:"/new/c2profiles",component:aa}),Object(x.jsx)(Oo,{exact:!0,path:"/new/services/",component:aa}),Object(x.jsx)(Oo,{exact:!0,path:"/new/callbacks",component:Ed}),Object(x.jsx)(Oo,{path:"/new/search",component:kp}),Object(x.jsx)(Oo,{exact:!0,path:"/new/browserscripts",component:zr}),Object(x.jsx)(Oo,{exact:!0,path:"/new/task/:taskId",component:Bm}),Object(x.jsx)(Oo,{exact:!0,path:"/new/tasks/by_range",component:Bm}),Object(x.jsx)(Oo,{exact:!0,path:"/new/operations",component:fr}),Object(x.jsx)(Oo,{exact:!0,path:"/new/callbacks/:callbackId",component:ro}),Object(x.jsx)(Oo,{exact:!0,path:"/new/reporting",component:Xm}),Object(x.jsx)(Oo,{exact:!0,path:"/new/mitre",component:xh})]})})]})]})]})}var yh=a(826),vh=a(917),_h=a(14),kh=a(349),wh=a(824),Ch=a(530),Sh=a(529),Dh=a(920),Ih=a(242),Th=a(177),$h=a(528),Ph=a(351),Ah=a.n(Ph),Eh=a(359),Lh="2.3.7",Fh="0.0.21",Nh=!1,qh=new yh.a({typePolicies:{Query:{fields:{operationeventlog:{},callback:{}}}}}),Rh=new Dh.a({delay:{initial:20,max:300,jitter:!0},attempts:{max:2,retryIf:function(e,t){return!!e}}}),Bh=new vh.a({uri:window.location.origin+"/graphql/",options:{reconnect:!0,connectionParams:{headers:{Authorization:function(){return"Bearer ".concat(localStorage.getItem("access_token"))}}}}}),Mh=function(){var e=localStorage.getItem("access_token");if(e){var t=Object(Eh.a)(e);return!(Date.now()>1e3*t.exp)}return!1},zh=Object($h.a)(function(){var e=Object(c.a)(r.a.mark((function e(t,a){var n,i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.headers;case 1:if(!Nh){e.next=6;break}return e.next=4,new Promise((function(e){return setTimeout(e,1e3)}));case 4:e.next=1;break;case 6:if(!(n=localStorage.getItem("access_token"))){e.next=26;break}if(i=Object(Eh.a)(n),c=1e3*i.exp-Date.now(),72e5,!(c<72e5)&&Mh()){e.next=24;break}return console.log("token is at its half life or less, try to get a new token"),e.next=15,Hh();case 15:if(!e.sent){e.next=20;break}return e.abrupt("return",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});case 20:console.log("update failed!"),Object(h.a)();case 22:e.next=24;break;case 24:e.next=28;break;case 26:console.log("no access token"),Object(h.a)();case 28:return e.abrupt("return",{Authorization:"Bearer ".concat(localStorage.getItem("access_token")),headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});case 29:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Wh=Object(Sh.a)((function(e){var t=e.graphQLErrors,a=e.networkError;console.log("errors?");try{if(t){console.log("[graphQLError]",t);var i,r=Object(n.a)(t);try{for(r.s();!(i=r.n()).done;){var c=i.value;switch(c.extensions.code){case"forbidden":O.b.error(c.message);break;case"access-denied":case"start-failed":console.log("got start-failed error in graphql"),console.log("would have asked for new token, but auth link will handle it");case"validation-failed":return void console.log(c);default:console.log(c),O.b.error(c.message)}}}catch(c){r.e(c)}finally{r.f()}}if(a){if(console.log("[Network error]",a),void 0===a.extensions)return O.b.error("Failed to connect to Mythic, please refresh"),Object(h.a)(),Qh(),void(window.location="/new/login");switch(a.extensions.code){case"access-denied":O.b.warning("Access Denied");break;case"start-failed":console.log("got start-failed error in network"),Object(h.a)(),Qh(),window.location="/new/login";break;default:console.log(a)}}}catch(o){return O.b.error("Failed to connect to Mythic, please refresh"),console.log(o),Qh(),void(window.location="/new/login")}})),Hh=function(){var e=Object(c.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nh=!0,t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:localStorage.getItem("refresh_token"),access_token:localStorage.getItem("access_Token")})},e.next=4,fetch("/refresh",t);case 4:return a=e.sent,n=a.json().then((function(e){return console.log(e),"access_token"in e?(Object(h.e)(e),console.log("successfully got new access_token"),Nh=!1,!0):(console.log("calling FailedRefresh from GetNewToken call"),Object(h.a)(),Nh=!1,!1)})).catch((function(e){return console.log("Error trying to get json response in GetNewToken",e),console.log(a),Object(h.a)(),Nh=!1,!1})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Uh=new Ih.SubscriptionClient("https:"===window.location.protocol?"wss://"+window.location.host+"/graphql/":"ws://"+window.location.host+"/graphql/",{reconnect:!0,reconnectionAttempts:10,connectionParams:function(){return{Authorization:"Bearer ".concat(localStorage.getItem("access_token")),headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}}}),Gh=new Ch.a(Uh),Kh=Object(_h.split)((function(e){var t=e.query,a=Object(Th.e)(t);return"OperationDefinition"===a.kind&&"subscription"===a.operation}),Gh,Bh),Vh=new kh.a({link:Object(_h.from)([zh,Wh,Rh,zh.concat(Kh)]),cache:qh});function Qh(){var e=Object.assign({},Uh.operations);Uh.close(!0),Uh.connect(),Object.keys(e).forEach((function(t){Uh.sendMessage(t,Ah.a.GQL_START,e[t].options)}))}null!==localStorage.getItem("access_token")&&(Mh(localStorage.getItem("access_token"))?null!==localStorage.getItem("user")&&Object(h.b)({loggedIn:!0,access_token:localStorage.getItem("access_token"),refresh_token:localStorage.getItem("refresh_token"),user:JSON.parse(localStorage.getItem("user"))}):(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"))),d.a.render(Object(x.jsx)(s.a.StrictMode,{children:Object(x.jsx)(wh.a,{client:Vh,children:Object(x.jsx)(la.a,{children:Object(x.jsx)(gh,{},"App")})})}),document.getElementById("root"))}},[[825,1,2]]]);
//# sourceMappingURL=main.dd67dd52.chunk.js.map